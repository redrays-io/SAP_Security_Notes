1937544 - Unauthorized modification of displayed content in User Self Service

**Symptom**

User Self Service can be abused by an attacker, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

**Other Terms**

Reflected cross-site scripting, XSS, User Self Service, User Request, SAP NetWeaver Gateway

**Reason and Prerequisites**

The OData service `USERREQUESTMANAGEMENT` does not sufficiently restrict malicious entries in user names, resulting in a reflected cross-site scripting issue. A reflected XSS attack can be used to non-permanently deface or modify displayed content from a website.

Reflected XSS can be used to steal another user's authentication information, such as data relating to their current session. An attacker who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**

Implement this note. After implementation, only the following characters are allowed in the user name: alphabets, numbers, dot (.), underscore (_), @.

**Software Components**

- **IW_BEP**: Version 200
- **SAP_GWFND**: Version 740

**Support Package**

- **IW_BEP 200**
  - Support Package: [SAPK-20008INIWBEP](https://me.sap.com/supportpackage/SAPK-20008INIWBEP)
- **SAP_GWFND 740**
  - Support Package: [SAPK-74006INSAPGWFND](https://me.sap.com/supportpackage/SAPK-74006INSAPGWFND)

**Correction Instructions**

*SAP_GWFND*

1. Go to transaction SE91.
2. Enter `/IWBEP/CM_MGW_URM` in the Message class name text field and click "Change".
3. Add the Message short text against:
   - Message 027: "UserName contains invalid characters"
   - Message 028: "FirstName contains invalid characters"
   - Message 029: "Last Name contains invalid characters"
4. Save the changes.

*IW_BEP*

1. Go to transaction SE91.
2. Enter `/IWBEP/CM_MGW_URM` in the Message class name text field and click "Change".
3. Add the Message short text against:
   - Message 027: "UserName contains invalid characters"
   - Message 028: "FirstName contains invalid characters"
   - Message 029: "Last Name contains invalid characters"
4. Save the changes.

**Additional Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011446502017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001937544?language=en-US&token=266DFA612B38C1D7247E9BCE322BF7FA)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001937544)

*Note: For links without a full domain, the base address is `https://me.sap.com/`.*

Credits to [RedRays](https://redrays.io) for support to provided information.