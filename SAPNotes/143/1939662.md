1939662 - Unauthorized use of application functions in SAP Portal Site Management by OpenText XX-PART-OPT-PSM

## Symptom

### Issue 1: Cross-Site Request Forgery

An attacker can execute functions in SAP Portal Site Management Server by OpenText without authentication and authorization.

### Issue 2: Potential Information Disclosure

An attacker can discover information relating to session variables of users authenticated to Management Server, which could be used to specialize attacks against SAP Portal Site Management Server (OpenText).

### Issue 3: Directory Traversal in SAP Portal Site Management

Potential directory traversal in the SAP Portal Site Management by OpenText.

## Reason and Prerequisites

### Issue 1: Cross-Site Request Forgery

SAP Portal Site Management Server (OpenText) executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The attacker may use a cross-site scripting attack or present a link to the victim.

### Issue 2: Potential Information Disclosure

Information such as session variables of users authenticated to Management Server can be discovered if an agent can monitor traffic between client browser and application server, and if they have detailed access to other authenticated users' requests. This information may be used by an attacker to gain unwanted access to Management Server.

### Issue 3: Directory Traversal

The file system path is disclosed to authenticated users of Management Server when a file is uploaded through Asset Manager. The file system path could assist a bad actor to gain unwanted access to the system if:

- They have specific access to the Windows Server where Management Server is installed
- They have access rights to the disclosed system path directories.

## Solution

The issues described in this note are resolved in:

- [Web Site Management 11.1 Hotfix 4](https://knowledge.opentext.com/knowledge/cs.dll/Open/38098927)

Customers running Management Server 10.1 need to upgrade to version 11.1 to deploy the patch. For more information on upgrading, refer to the [Web Site Management Server Installation Guide](https://me.sap.com/knowledge/cs.dll/Open/35157463) or contact Customer Support.

Customers running SAP Portal Site Management by OpenText need to complete the following steps:

1. Upgrade Management Server and Delivery Server to version 11.1. Installation files are available [here](https://knowledge.opentext.com/knowledge/cs.dll/Open/38284201).
2. Upgrade PSM Portal Manager to version 10.0 SP3. Installation files are available [here](https://knowledge.opentext.com/knowledge/cs.dll/Open/38284201).
3. Deploy [Web Site Management 11.1 Hotfix 4](https://knowledge.opentext.com/knowledge/cs.dll/Open/38098927). For details on the hotfix, see the respective [Release Notes](https://knowledge.opentext.com/knowledge/cs.dll/Open/41254310).

**Note:** OpenText recommends that customers check the security settings of their environment and Management Server deployment. It is a best practice to ensure that Management Server is not accessible by the public. Only administrators and authors of a website should have access to Management Server. The visibility and access to the server system should be restricted. For more information, refer to the [OpenText Web Site Management System Overview Guide](http://app.mktg.opentext.com/e/er?s=459&lid=14002&elq=5251f086269d4c05970a7d92c1cdb2b9).

*Please also note that the solution refers to the OpenText Knowledge Center, which requires registration. For more information on the SAP OpenText Software and Support Lifecycle please refer to [SAP Note 1791874](https://me.sap.com/notes/1791874).*

*Credits to [redrays.io](https://redrays.io) for support to provided information.*