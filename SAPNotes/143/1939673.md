1939673 - Potential information disclosure relating to planning or consolidation transaction data

---

## Description

An attacker can discover information relating to planning or consolidation transaction data in BPC NW. This information could be used to allow the attacker to specialize their attacks against planning or consolidation.

**CVSS Information**

- **CVSS Base Score:** 3.5
- **CVSS Base Vector:** AV:N/AC:M/AU:S/C:P/I:N/A:N

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/).

## Reason and Prerequisites

This is caused by a program error. It is only relevant for BPC NW release 10 or 10.1. Information disclosure may happen only if you have already granted an attacker necessary BW authorizations (e.g., S_RS_COMP) to access the BW objects which are generated by BPC.

## Solution

Apply the program correction instructions of this note or upgrade to the corresponding support package, so that characteristics for newly secured dimensions are automatically marked to be authorization relevant.

**For existing secure dimensions, you need to manually use transaction RSA1 or RSD1 to mark the corresponding characteristics.**

## Correction Instructions

Assign an additional authorization, i.e., S_RSEC, to the BPC service user as follows:

1. Start transaction **PFCG**.
2. Enter "**SAP_BPC_SERVICE**" for the Role field, and then click the **Change** button next to the Role field.
3. Switch to the **Authorizations** tab page, click the **Change** button with the annotation "Change Authorization Data" in the frame "Maintain Authorization Data and Generate Profiles".
4. Click **OK** on the Information popup.
5. Go to the **Edit** menu, and select **Edit → Insert authorization(s) → Manual input**.
6. On the "Manual selection of authorizations" popup, enter "**S_RSEC**" for the Authorization Object field, and click **OK**.
7. Expand the tree to the newly inserted node (with yellow icon), i.e., expand **SAP_BPC_SERVICE > Business Information Warehouse > Infrastructure of the Analysis Authorizations**:

   a) Click the change button for "**Activity**", select the following values, and then save:
      - 01 Create or generate
      - 02 Change
      - 03 Display
      - 06 Delete

   b) Click the change button for "**Object Type Infrastructure Ana**", select value "**IOBJ**" and then save.

   c) Click the change button for "**Infrastructure Analysis Author**", enter "**/CPMB/***" for the 'From' column of the first row, and then save.

8. Select the menu item **Authorizations → Save** to save the authorizations.
9. Select the menu item **Authorizations → Generate** to generate the profile.

## Support Packages

- **CPMBPC 800:** [SAPK-80012INCPMBPC](https://me.sap.com/supportpackage/SAPK-80012INCPMBPC)
- **CPMBPC 801:** [SAPK-80105INCPMBPC](https://me.sap.com/supportpackage/SAPK-80105INCPMBPC)
- **CPMBPC 810:** [SAPK-81001INCPMBPC](https://me.sap.com/supportpackage/SAPK-81001INCPMBPC)

## Validity

Applicable to the following software components:

- **CPMBPC:** 800, 801, 810

## References

This document is causing side effects with:

- [2155874 - Error: "Node [XX, XX]: Leaf '' already exists as child of node" when copying environment](https://me.sap.com/notes/0002155874)

## Attachments

None.

*Credits to [redrays.io](https://redrays.io) for support to provided information.*