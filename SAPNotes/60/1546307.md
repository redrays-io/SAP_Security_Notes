1546307 - Unauthorized modification of displayed content in tc~sec~vsi

**Symptom**

J2EE component `tc~sec~vsi~app` can be abused by a malicious user, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

**CVSS Information**

- **CVSS Base Score:** 4.3
- **CVSS Base Vector:** AV:N/AC:M/AU:N/C:N/I:P/A:N

_SAP is providing this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into consideration your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding the applicability or priority of this SAP security note._

**Other Terms**

- Reflected cross-site scripting (XSS)
- `tc~sec~vsi~app`

**Reason and Prerequisites**

Pages `VsiTestScan` and `VsiTestServlet` within `tc~sec~vsi~app` do not sufficiently encode output parameters, resulting in a reflected cross-site scripting issue. A reflected XSS attack can be used to non-permanently deface or modify displayed content from a website.

Reflected XSS can be used to steal another user's authentication information, such as data relating to their current session. A malicious user who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**

You have the following options:

1. **Un-Deploy the J2EE application `tc~sec~vsi~app`** because it is not needed for productive systems, but only for test purposes.
2. **Install the patches** mentioned in this note in the appropriate Support Package (SP) Patch Level.

**Affected Software Components**

- **SAP-JEE**
  - Versions: 6.40
  - Versions: 7.00 to 7.02
- **SAP_JTECHS**
  - Versions: 6.40
  - Versions: 7.00 to 7.02
  - Version: 6.42
- **SERVERCORE**
  - Versions: 7.10 to 7.31
- **J2EE-APPS**
  - Versions: 7.00 to 7.30

**Support Package Patches**

- **J2EE ENGINE APPLICATIONS 7.20**
  - SP004 Patch 000007: [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200013040&support_package=SP004&patch_level=000007)
- **J2EE ENGINE APPLICATIONS 7.11**
  - SP004 Patch 000012: [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006975&support_package=SP004&patch_level=000012)
- **SAP JAVA TECH SERVICES 7.02**
  - SP004 Patch 000016: [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012532&support_package=SP004&patch_level=000016)
- **J2EE ENGINE APPLICATIONS 7.30**
  - SP003 Patch 000000: [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014992&support_package=SP003&patch_level=000000)
- _... (additional patches can be listed similarly)_

_For a complete list of Support Package Patches, visit the [Support Package Patches](https://me.sap.com/supportpackagepatches) section._

**References**

- This document refers to [SAP Note 1589119](https://me.sap.com/notes/1589119): SAP NetWeaver AS Java 7.02 (EhP2) SP08 - List of corrections.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017157932017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001546307?language=en-US&token=2E069172592E772C48FB53216657B005)

**Available Languages**

- Japanese: [Japanese Translation](https://me.sap.com/notes/0001546307/J)
- Deutsch: [Deutsch Translation](https://me.sap.com/notes/0001546307/D)
- Português (Machine Translation): [Português](https://me.sap.com/notes/0001546307/P)
- Español (Machine Translation): [Español](https://me.sap.com/notes/0001546307/S)
- Français (Machine Translation): [Français](https://me.sap.com/notes/0001546307/F)
- Italiano (Machine Translation): [Italiano](https://me.sap.com/notes/0001546307/I)
- Русский (Machine Translation): [Русский](https://me.sap.com/notes/0001546307/R)
- 中文 (Machine Translation): [中文](https://me.sap.com/notes/0001546307/1)
- 한국어 (Machine Translation): [한국어](https://me.sap.com/notes/0001546307/3)

**Credits**

Credits to [Redrays](https://redrays.io) for supporting the information provided.