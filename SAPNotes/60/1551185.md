1551185 - Potential disclosure of persisted data in Hedge Management

**SAP Note Number**: 1551185  
**Type**: SAP Security Note  
**Version**: 2  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer  
**Released On**: 08.03.2011  
**Component**: Financial Services > Bank Analyzer > Processes & Methods > Hedge Processes

### Description

**Symptom**  
A malicious user can exploit Hedge Management and use specially crafted inputs to modify database commands, resulting in the retrieval of additional information persisted by the system.

**Other Terms**  
SQL injection, database, Hedge Management, Hedge Accounting Workplace (HAW)

**Reason and Prerequisites**  
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve data from the database.

**Solution**  
Please implement the attached correction instructions or the corresponding support package.

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009192402017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001551185?language=en-US&token=8AE48F2632F393DA40A8DE0250B958D1)
- [Share by Email](https://me.sap.com/sharebyemail/1551185)
- [Open in New Window](https://me.sap.com/opennewwindow/1551185)

### Support Packages

- **FSAPPL 200**: [SAPKISC315](https://me.sap.com/supportpackage/SAPKISC315)
- **FSAPPL 300**: [SAPK-30008INFSAPPL](https://me.sap.com/supportpackage/SAPK-30008INFSAPPL)
- **BANK-ALYZE 42**: [SAPKIBAM15](https://me.sap.com/supportpackage/SAPKIBAM15)
- **BANK-ALYZE 50**: [SAPKIBAL23](https://me.sap.com/supportpackage/SAPKIBAL23)

### Correction Instructions

- **FSAPPL**: 2 Correction Instructions [Link](https://me.sap.com/corrins/0001551185/1534)
- **BANK-ALYZE**: 2 Correction Instructions [Link](https://me.sap.com/corrins/0001551185/189)

### Manual Activities

Use transaction SE37 to enhance the signature of the function modules `/BA1HM/AH_M_DB_HI_CUST_CHECK` and `/BA1HM/AH_M_API_HI_CUST_CHECK` by the importing parameter `I_TAB_SELOPT` of type `DDSHSELOPS` and mark the importing parameter `I_WHERE_CLAUSE` as optional.

*Credits to [Redrays](https://redrays.io) for support to provided information.*