SAP Security Note 1838451: Untrusted XML Input Parsing Possible in Pipeline Service

---

**Title:** 1838451 - Untrusted XML input parsing possible in Pipeline Service

**Number:** 1838451  
**Type:** SAP Security Note  
**Version:** 5  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 13.08.2013  
**Component:** Enterprise Portal > Enterprise Portal - Knowledge Management and Collaboration > Content Management

### Description

#### Symptom
A malicious user can modify an XML-based request to include XML content that is then parsed locally. This could allow a malicious user to perform a denial of service (DoS) on the parsing system, disclose local data returned in the response to the malicious request, or access further network-located resources accessible from the parsing system.

**CVSS Information**  
**CVSS Base Score:** 4.0  
**CVSS Base Vector:** AV:N/AC:L/AU:S/C:P/I:N/A:N

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/securitynotes/).

#### Other Terms
XXE, XML eXternal Entity, information disclosure, denial of service, DoS, Pipeline Service

#### Reason and Prerequisites
The problem is caused by a program error in Pipeline Service due to the incorrect use of an XML parser. By default, the parser opens external entities referenced within an XML input, which can then lead to malicious content being parsed. This malicious content can reference internal resources, such as files. These internal resources can be disclosed in the response to the request or used to perform a denial of service attack on the parsing system, rendering application content temporarily unavailable.

### Solution

**A.)** For more information about the affected releases, see the "SP Patch Level" section of this SAP note.  
For more information about the SP Stack schedule and updates, visit the [SP Stacks maintenance schedule](http://service.sap.com/sp-stacks).

**B.)** Possible workaround before the release of the mentioned deliveries:  
There is no workaround possible.

**IMPORTANT:** Before applying this note, apply SAP note [1835125](https://me.sap.com/notes/1835125).

### References

- [1841791 - KMC in SAP NetWeaver 7.0 SP29](https://me.sap.com/notes/1841791)
- [1835125 - Untrusted XML input parsing possible in sapxmltoolkit](https://me.sap.com/notes/1835125)

### Validity

**Software Components:**

- **KMC-BC:** 7.00 - 7.02, 7.30, 7.31, 7.40
- **EP-CM:** 6.0_640

### Support Package Patches

- [KMC BASE COMPONENTS 7.31 SP004 Patch 000010](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014362&support_package=SP004&patch_level=000010)
- [KMC BASE COMPONENTS 7.40 SP004 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019641&support_package=SP004&patch_level=000000)
- [KMC BASE COMPONENTS 7.31 SP003 Patch 000010](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014362&support_package=SP003&patch_level=000010)
- [KMC BASE COMPONENTS 7.40 SP003 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019641&support_package=SP003&patch_level=000000)
- [KMC BASE COMPONENTS 7.30 SP005 Patch 000025](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015119&support_package=SP005&patch_level=000025)
- ... *(additional patches can be listed similarly)*

### CVSS

**CVSS Score:** 4.0  
**CVSS Vector:** AV:N/AC:L/AU:S/C:P/I:N/A:N

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017624972017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001838451?language=en-US&token=CA66CDDDF8C283D6FC1083E08F6CBF26)
- Share by Email
- Open in New Window

### Credits

Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.

---