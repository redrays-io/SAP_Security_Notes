Unauthorized Modification of Content in ERP Print Preview (SAP Note 1652708)

**SAP Security Note 1652708: Unauthorized Modification of Content in ERP Print Preview**

**Release Date:** May 8, 2012  
**Version:** 6  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Component:** Customer Relationship Management > Business Transactions > CRM UI for ERP Sales Documents (CRM-BTX-ERP)  

### Description
A vulnerability exists in the CRM WebClient UI's print preview functionality for ERP sales orders, quotations, and contracts. An attacker can exploit this to modify displayed application content without authorization and potentially steal authentication information from legitimate users.

### Vulnerability Details
- **Type:** Reflected Cross-Site Scripting (XSS)
- **Affected Software Components:** BBPCRM versions 700, 701, 702, 712
- **Impact:** 
  - Unauthorized modification of displayed content
  - Theft of user authentication information
  - Potential impersonation of users, including administrators

### Reason
The SICF handler for print preview in CRM WebClient UI does not sufficiently encode the PDF output string, leading to a reflected XSS vulnerability.

### Solution
- **Implement the recommended source code corrections for your release.**
- **Alternative:** If the print preview functionality is not used in your business scenario, deactivate the SICF service `/default_host/sap/crm/erp_pdf_print`.

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009814602017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001652708?language=en-US&token=6D83FF8F8D48D06AFA927E33C8EFE7D5)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001652708) *(visible to authorized users)*
- [Show Changes](https://me.sap.com/sap/support/notes/compare/0001652708) *(if applicable)*

### Prerequisites
Ensure that the following prerequisite SAP Note is implemented:
- **SAP Note 1413354:** Printing ERP Documents in CRM ([Link](https://me.sap.com/notes/1413354))

### Support Packages
- BBPCRM 700: [SAPKU70011](https://me.sap.com/supportpackage/SAPKU70011)
- BBPCRM 701: [SAPKU70108](https://me.sap.com/supportpackage/SAPKU70108)
- BBPCRM 702: [SAPKU70203](https://me.sap.com/supportpackage/SAPKU70203)

For more details, visit the [SAP Security Notes](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*