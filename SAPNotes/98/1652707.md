SAP Security Note 1652707 - Unauthorized modification of content in order print preview

## Description

### Symptom
The print preview of CRM order documents in the CRM WebClient UI can be abused by an attacker, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

### Reason and Prerequisites
The SICF handler for print preview of one order documents (e.g., sales orders, quotations) within the CRM WebClient UI does not sufficiently encode the PDF output string, resulting in a reflected cross-site scripting (XSS) issue. A reflected XSS attack can be used to non-permanently deface or modify displayed content from a website. It can also be used to steal another user's authentication information, such as data related to their current session. An attacker who gains access to this data may impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

### Solution
Implement the source code corrections for your release. If the print preview is not used in your business scenario, you might want to deactivate the SICF service `/default_host/sap/crm/crm_pdf_print` as an alternative.

### Affected Software Components
- BBPCRM 600
- BBPCRM 700
- BBPCRM 701
- BBPCRM 702
- BBPCRM 712

### Support Package Information
- **BBPCRM 600:** [SAPKU60012](https://me.sap.com/supportpackage/SAPKU60012)
- **BBPCRM 700:** [SAPKU70012](https://me.sap.com/supportpackage/SAPKU70012)
- **BBPCRM 701:** [SAPKU70109](https://me.sap.com/supportpackage/SAPKU70109)
- **BBPCRM 702:** [SAPKU70203](https://me.sap.com/supportpackage/SAPKU70203)

### Additional Information
- **Release Status:** Released for Customer
- **Priority:** Correction with high priority
- **Released On:** 08.05.2012
- **Component:** CRM-BF-ACI
- **Category:** Program error

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009814592017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001652707?language=en-US&token=2B0EA4F5FFBE64650EFDE02DD0D4B161)
- Share by Email
- Open in New Window

### Prerequisites
Refer to the following SAP Notes:
- [1341008](https://me.sap.com/notes/1341008) - Preview for Actions Processing Smartforms (BBPCRM 600/700)
- [1343636](https://me.sap.com/notes/1343636) - Actions Smartforms PDF Preview: Empty Popup displayed (BBPCRM 600/700)
- [1584925](https://me.sap.com/notes/1584925) - Message "Do you want to save this file? Name .pdf" (BBPCRM 600 to 701)

### CVSS
No CVSS score provided.

**Credits to [https://redrays.io](https://redrays.io) for support to provided information.**