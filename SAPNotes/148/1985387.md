1985387 - Potential Information Disclosure Relating to SAP Solution Manager

**Symptom**

An attacker can discover information related to usernames and passwords associated with SAP Solution Manager. This information could be exploited to tailor attacks specifically against your SAP Solution Manager environment.

**Solution**

If you have installed Diagnostics Agents using an SAP-provided installer (such as sapinst, Software Provisioning Manager [SWPM], or standalone Diagnostics Agent installers for versions 7.10, 7.11, 7.2, 7.3) **earlier than Software Provisioning Manager 1.0 SP5**, you must take the following actions:

1. **Change Passwords:**
   - Update the password for the user that manages the connection between your SAP Solution Manager system and the Diagnostics Agents. Typically, this user is either `SMD_ADMIN` or `SMD_AGT`.
   - Refer to [SAP Note 2119627](https://me.sap.com/notes/2119627) for detailed instructions on changing the Diagnostics Agent connection user password.

2. **Remove Temporary Files:**
   - It is recommended to delete any temporary files generated by previous installations to prevent potential information leakage.

**Relevance**

This security issue affects environments running any SAP Solution Manager releases and service packs (SPs). The vulnerability stems from the installer version used for setting up the Diagnostics Agent and **cannot be resolved by merely applying a new SAP Solution Manager SP**.

**Recommended Procedure**

1. **Change the Diagnostics Agent Connection User Password:**
   - Ensure your SAP Solution Manager is updated to version 7.10 SP5 or higher.
   - Switch to "Certificate Based Authentication" if available.
   - Change the password of the Diagnostics Agent connection user as detailed in [SAP Note 2119627](https://me.sap.com/notes/2119627).

2. **Delete Installer Log Files:**
   - **Windows:** Remove directories like `C:\Program Files\sapinst_instdir` or those created in the `%TEMP%` directory.
   - **Linux/UNIX:** Delete directories such as `/tmp/sapinst_instdir` or those in directories defined by `TEMP`, `TMP`, or `TMPDIR` environment variables.
   - Ensure all old installer log directories, including those with timestamps or additional prefixes/suffixes, are deleted to eliminate any stored usernames and passwords.

**Additional References**

- [SAP Note 1858920](https://me.sap.com/notes/1858920): Diagnostics Agent installation with Software Provisioning Manager.
- [SAP Note 2119627](https://me.sap.com/notes/2119627): Change the Password for the Diagnostics Agent Connection User in SAP Solution Manager.

For more detailed instructions and download links, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*