1981048 - HTTP Cookies Without HttpOnly Flag Set may lead to Cross Site Scripting Issues

**Symptom**

The BI 4.0 application does not set the HttpOnly flag on cookies. This may increase the probability of successful cross-site scripting attacks.

**CVSS Information**

- **CVSS Base Score:** 4.3
- **CVSS Base Vector:** AV:N/AC:M/AU:N/C:N/I:P/A:N

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/).

**Reason and Prerequisites**

The HttpOnly flag makes it more difficult to perform a scripting attack to access a user's cookie. However, until recently, it also prevented a Java applet from accessing the cookie, which is required for the Webi Intelligence Java viewer.

The issue, originally a limitation of JRE, is linked below:

[Sun Bug 7077220](http://bugs.sun.com/bugdatabase/view_bug.do;jsessionid=ea1bceb15af9e1fffffffc9c87ae3fcb481f?bug_id=7077220)

**Solution**

A number of solutions are available to customers:

- **BI4 Customers:** Upgrade to BI4.1 or Edge 4.1, which includes Tomcat7. Tomcat7 will enable HttpOnly by default.
- **XIR3 Customers:** Install SP6 or later, which includes Tomcat7.
- **Manual Update:** Customers can manually update their Tomcat configuration or other web application servers to always enable HttpOnly.

**Downloads**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017813642017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001981048?language=en-US&token=DA986320DC391133D8A270ED58FC5F07)

**More Information**

For additional details and support, visit [SAP Support](https://me.sap.com/).

*Credits to [Red Rays](https://redrays.io) for providing the information.*