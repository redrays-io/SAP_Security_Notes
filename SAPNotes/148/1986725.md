SAP Security Note 1986725 - Potential Denial-of-Service Attack Against SAP Start Service and SAP Host Agent

**Symptom**

An attacker can remotely exploit SAP Start Service and SAP Host Agent, potentially rendering them unavailable.

**CVSS Information**
- **Base Score:** 7.1
- **Vector:** AV:N/AC:M/AU:N/C:N/I:N/A:C

**Description**

The issue is caused by a resource exhaustion condition. An attacker can launch a number of specifically crafted HTTP or HTTPS requests that prolong sending of the request over an extended period. Both HTTP headers and POST bodies can be manipulated to consume a disproportionate amount of the process's resources, potentially leading to a denial of service (DoS).

**Solution**

To mitigate this vulnerability, follow the recommended steps:

1. **Restrict Access to Essential Ports:**
   - Expose only the necessary ports in untrusted networks that need user access.
   - Typically, SAP Start Service and SAP Host Agent should only be accessible within the datacenter.
   - Restrict access to ports `5<NN>13`, `5<NN>14`, `1128`, and `1129` to the datacenter network. (Replace `<NN>` with your instance number)

2. **Use SAP Web Dispatcher for Additional Protection:**
   - If you need to expose these ports to untrusted networks, implement SAP Web Dispatcher to safeguard against DoS attacks.
   - SAP Web Dispatcher provides mechanisms to counteract such attacks as described in [SAP Note 1966655](https://me.sap.com/notes/1966655) and [SAP Note 1981955](https://me.sap.com/notes/1981955).

   **Configuration Steps:**
   1. **Install SAP Web Dispatcher** on the host you intend to protect.
   2. **Configure Server Ports:**
      - Open server ports on the externally visible IP address.
   3. **Activate DoS Protection:**
      - Enable DoS protection on the server ports as per [SAP Note 1981955](https://me.sap.com/notes/1981955).
   4. **Route Requests to Localhost:**
      - Use the `EXTSERV` directive in the `wdisp/system` parameter to direct requests to the respective SAP Start Service and SAP Host Agent HTTP(S) ports on the localhost IP address.
   5. **Configure SAP Start Service and SAP Host Agent:**
      - Ensure they listen only on the localhost IP address by setting the parameter `service/hostname = localhost`.

   **Example Configuration:**

   *Web Dispatcher Profile:*
   ```plaintext
   # Start service in instance 86
   icm/server_port_50 = PROT=HTTP, HOST=$(SAPLOCALHOST), PORT=5<NN>13, MIN_RECEIVE_RATE=min_rate=10
   wdisp/system_50 = SID=WDP, EXTSRV=http://localhost:5<NN>13, SRCSRV=*:5<NN>13
   ```

   *Instance Profile (used by SAP Start Service):*
   ```plaintext
   service/hostname = localhost
   ```

**Additional Information**

- **Available Languages:** This security note is available in multiple languages, including German, Japanese, Portuguese, Spanish, French, Italian, Russian, Chinese, and Korean.
- **References:** This document refers to [SAP Note 1981955](https://me.sap.com/notes/1981955) and is referenced by [SAP Note 2062508](https://me.sap.com/notes/2062508).

For more details, visit the [SAP Security Notes](https://me.sap.com/securitynotes/) page.

**Credits**

Information supported by [Redrays.io](https://redrays.io).