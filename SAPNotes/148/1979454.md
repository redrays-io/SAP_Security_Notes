1979454 - Missing authorization check in Batch Input Recorder

## Symptom

An authenticated user can use functions of Batch Input Recorder to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**  
CVSS Base Score: 6.5  
CVSS Base Vector: AV:N/AC:L/AU:S/C:P/I:P/A:P

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/).

## Reason and Prerequisites

Batch Input Recorder does not contain authorization checks for checking an authenticated user’s authorization to access some of its functions. This may result in undesired system behavior.

## Solution

Please apply the Support Package mentioned in this SAP Note or the correction instruction.

By the correction, an authorization check for **S_BDC_MONI** is introduced in transaction **SHDB**. The performance of this authorization check depends on the system profile parameter `'bdc/shdb/auth_check'`. Set the value of this system profile parameter to `'TRUE'` to enable the newly introduced authorization check.

### Correction Instructions

1. **Add fixed values to domain BDCAKTIVI**:
   - Call transaction **SE11** and change the domain **BDCAKTIVI** (in original language German!).
   - On the "Value Range" tab page, add the following fixed values with the corresponding short descriptions in addition to the existing ones:
     - RANA Aufzeichnungen analysieren.
     - RCRE Aufzeichnungen erstellen.
     - RCSP Aus Aufzeichnungen eine Mappe, Programm o.ä. anlegen.
     - RDEL Aufzeichnungen löschen.
     - REDI Aufzeichnungen ändern.
     - REXP Aufzeichnungen exportieren.
     - RIMP Aufzeichnungen importieren.
     - RONL Aufzeichnungen abspielen.
     - RREC Transaktionen aufzeichnen.
     - ORAN Eigene Aufzeichnungen analysieren.
     - ORCS Aus eigenen Aufzeichnungen eine Mappe, Programm o.ä. anlegen.
     - ORDE Eigene Aufzeichnungen löschen.
     - ORED Eigene Aufzeichnungen ändern.
     - OREX Eigene Aufzeichnungen exportieren.
     - ORIM Eigene Aufzeichnungen importieren.
     - ORON Eigene Aufzeichnungen abspielen.
     - ORRE Eigene Transaktionen aufzeichnen.
   - Save and activate the changes.

2. **Create new messages MS 660 - 668 without a long text**:
   - Call transaction **SE91** (in original language German!).
   - Enter "MS" for the message class and "660" for the message number. Then choose "Change" (F6).
   - Enter the following message short text for message 660:  
     `"Keine Berechtigung zum Anlegen der Aufzeichnung &"`
   - Mark the checkbox "Self-Explanatory" in this row.
   - Choose the "Save" icon (Ctrl+S).
   - Choose "Back" (F3).
   - Repeat the process for message numbers **661** to **668** with corresponding texts.

### Manual Activities

You have to perform this manual activity separately in each system into which you transport the Note for implementation.

The execution of this authorization check depends on the system profile parameter `'bdc/shdb/auth_check'`. Set the value of this system profile parameter to `'TRUE'` to enable the newly introduced authorization check.

## References

- **Referenced by:**  
  - [Prerequisite Note missing for Note 2941667](https://me.sap.com/notes/2983159)

## Support Package Information

Ensure you apply the relevant Support Package for your SAP_BASIS version. You can find the Support Packages [here](https://me.sap.com/supportpackage/SAPKB70032).

---

*Credits to [https://redrays.io](https://redrays.io) for support provided information.*