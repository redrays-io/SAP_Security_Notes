1669901 - Unauthorized use of application functions in personalization

**SAP Note/KBA**: 1669901  
**Type**: SAP Security Note  
**Version**: 1  
**Priority**: Correction with medium priority  
**Release Status**: Released for Customer  
**Released On**: 13.03.2012  
**Component**: Enterprise Portal > SAP Enterprise Portal (On Premise) > Personalization of iViews / Pages  

### Description
An attacker can execute functions in Portal personalization functionality without authentication and authorization.

**Other Terms**:  
- Cross-site request forgery (XSRF)  
- EP-PIN-PERS

### Reason and Prerequisites
**Reason**:  
Portal personalization executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user’s browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The attacker may use a cross-site scripting attack or present a malicious link to the victim.

**Prerequisites**:
1. Using SAP NW Portal in releases lower than:
   - SAP NW Portal 7.00 SP27
   - SAP NW Portal 7.01 SP12
   - SAP NW Portal 7.02 SP12
   - SAP NW Portal 7.30 SP7
   - SAP NW Portal 7.31 SP3
2. XSRF protection is enabled in the J2EE engine

### Solution
Implement the XSRF protection implemented in the HTMLB framework by Portal personalization functionalities. Portal personalization functionality implemented in Web Dynpro Java is XSRF safe due to the protection in the Web Dynpro Java runtime framework. Refer to [SAP Note 1327872](https://me.sap.com/notes/1327872).

To apply the solution, apply the relevant patch from the "SP Patch Level" tab. Available patches:

- [EP RUNTIME 7.31 SP003 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP003&patch_level=000000)
- [PORTAL 7.01 SP012 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010804&support_package=SP012&patch_level=000000)
- [PORTAL 7.02 SP012 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012489&support_package=SP012&patch_level=000000)
- [EP RUNTIME 7.30 SP007 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015108&support_package=SP007&patch_level=000000)
- [PORTAL 7.00 SP027 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200007801&support_package=SP027&patch_level=000000)

### References
- [Central Note for Portal Platform in SAP NW7.0 EhP2 SP12](https://me.sap.com/notes/1670202)
- [Central Note for Portal Platform in SAP NW7.0 EhP1 SP12](https://me.sap.com/notes/1659047)
- [Central Note for Portal Platform in SAP NW7.0 SP27](https://me.sap.com/notes/1653046)
- [Central Note for NetWeaver 7.31 SP03 EP / EPC](https://me.sap.com/notes/1652471)
- [Central Note for NetWeaver 7.30 SP07 EP / EPC](https://me.sap.com/notes/1630284)

### Available Languages
- [Deutsch](https://me.sap.com/notes/0001669901/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0001669901/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001669901/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001669901/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001669901/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001669901/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001669901/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001669901/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001669901/3)

### Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017367252017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001669901?language=en-US&token=035FA662D018A98C80B52DE295574FE1)

*Credits: [RedRays.io](https://redrays.io) for support to provided information.*