SAP Security Note 1670220 - Unauthorized Modification of ITS in IS-HER-CM

**SAP Security Note 1670220 - Unauthorized Modification of ITS in IS-HER-CM**

**Description:**
A cross-site scripting (XSS) vulnerability in IS-HER-CM allows malicious users to modify displayed application content without authorization and potentially steal authentication information from other legitimate users. This can lead to user impersonation and full compromise of application security if an administrator is impersonated.

**Symptom:**
IS-HER-CM can be abused by a malicious user, allowing modification of application content and potential theft of authentication data.

**Reason and Prerequisites:**
The ITS Service `PIQCMADM_DE` within IS-HER-CM does not sufficiently encode OUTPUT parameters, resulting in an XSS issue.

**Solution:**
Apply this security note or import the changes via the relevant support package.

**Manual Correction Instructions:**
1. Go to transaction **SICF**.
2. Enter the service name as `PIQCMADM_DE` and click on **Execute** (F8).
3. Double-click on the service node.
4. Go to change mode and click on the button **GUI Configuration** in the **Service data** tab.
5. Add the following parameters with the values:
   - `~auto_html_escaping = 1`
   - `~new_xss_functions = 1`
   - *(For kernel release >= 7.20:)* `~auto_html_escaping=1`

**Validity:**
Applicable to the following software components and versions:
- **IS-PS-CA:** 600, 602, 603, 604, 605, 606, 616

**Support Packages:**
- **IS-PS-CA 600:** [SAPK-60022INISPSCA](https://me.sap.com/supportpackage/SAPK-60022INISPSCA)
- **IS-PS-CA 602:** [SAPK-60212INISPSCA](https://me.sap.com/supportpackage/SAPK-60212INISPSCA)
- **IS-PS-CA 603:** [SAPK-60311INISPSCA](https://me.sap.com/supportpackage/SAPK-60311INISPSCA)
- **IS-PS-CA 604:** [SAPK-60412INISPSCA](https://me.sap.com/supportpackage/SAPK-60412INISPSCA)
- **IS-PS-CA 605:** [SAPK-60509INISPSCA](https://me.sap.com/supportpackage/SAPK-60509INISPSCA)
- **IS-PS-CA 606:** [SAPK-60604INISPSCA](https://me.sap.com/supportpackage/SAPK-60604INISPSCA)

**References:**
- [ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)
- [ITS: Automatically Escape Context Fields in Output](https://me.sap.com/notes/1488500)

For more details, visit the SAP Notes page: [https://me.sap.com/notes/1670220](https://me.sap.com/notes/1670220)

_Credits to [Redrays](https://redrays.io) for support in providing this information._