SAP Security Note 1668224 - Delete SOHMBEANS

**Release Date:** September 11, 2012  
**Priority:** HotNews  
**Status:** Released for Customer  
**Component:** Basis Components > NetWeaver Administrator Tool (NWA) > Administration Assistant  
**CVSS Base Score:** 7.5 (AV:N/AC:M/AU:S/C:P/I:P/A:C)

### Description
An authenticated user can execute `AA_EXECUTE_OS_COMMAND`, which should be restricted as it enables OS command execution. This vulnerability may lead to privilege escalation.

### Impact
- **CVSS Base Score:** 7.5  
- **Vector:** AV:N/AC:M/AU:S/C:P/I:P/A:C  
- **External Reporting:** Yes

### Solution
The `AA_EXECUTE_OS_COMMAND` function is obsolete and has been deleted from the relevant codelines. This will not impact any existing functionality.  
**Action Required:** Apply the Support Packages as described in [SAP Note 1660315](https://me.sap.com/notes/1660315) to implement the fix.

### Manual Activities
To remove the deprecated function modules, classes, and interfaces, follow these steps:

1. Go to transaction **SE80**.
2. Choose **Package** and select **SOHMBEANS**.
3. Delete all Function Modules, Classes, and Interfaces within the package.
4. Right-click on the **SOHMBEANS** package, select **Other Functions**, then choose **Rebuild Object List**.

**Objects to be deleted:**
- REPS CREATE_MISSING_OBJECTS
- REPS SAPLAA_FUNCTIONMODULES
- INTF IF_AAMESSAGE_MANAGEMENT
- INTF IF_AA_ADS_CHECKCONFIGURATION
- INTF IF_AA_CANCELLED_JOBS
- INTF IF_AA_CANCELWORKPROCESS
- INTF IF_AA_FILESYSINFO
- INTF IF_AA_MAXDB_ADD_DATA_VOLUME
- INTF IF_AA_MAXDB_MISSING_OBJECTS
- INTF IF_AA_MAXDB_STRUCT_CHECK
- INTF IF_AA_MAXDB_USERTASKS
- INTF IF_AA_OS_FREESPACE
- INTF IF_AA_TREX_QUEUES
- INTF IF_AA_TREX_SERVICES
- INTF IF_AA_TREX_TRACE_FILES
- INTF IF_AA_USERLOGOUT
- INTF IF_OHABAPENQ
- INTF IF_OHABAPSYSLOG
- INTF IF_OHJOBSCHEDULER
- INTF IF_USERDISTRIBUTIONLIST
- REPT CREATE_MISSING_OBJECTS
- REPT SAPLAA_FUNCTIONMODULES
- DOCU RECREATE_MISSING_OBJECTS
- DOCU RESAPLAA_FUNCTIONMODULES

### References
- [1660315 - Delete code from SOHMBEANS](https://me.sap.com/notes/1660315)

### Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009904972017)  
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001668224?language=en-US&token=1004BF5810B936A4F4231E488D41E4E1)

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*