1670098 - Unauthorized modification of BSP in Webdocuments

**SAP Security Note 1670098 Overview**

**Title:** Unauthorized modification of BSP in Webdocuments

**Number:** 1670098  
**Type:** SAP Security Note  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 08.05.2012  
**Component:** [CA-DMS - Cross-Application Components > Document management](https://me.sap.com/servicessupport/knowledge/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'CA-DMS*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)  
**Version:** 2  
**Language:** English  
**Recency:** New

### Description

The BSP application **Webdocuments** can be exploited by malicious users, allowing unauthorized modification of displayed application content and potentially obtaining authentication information from other legitimate users.

**Affected BSP Pages:**
- DOCUMENT_CHANGE.HTM
- DOCUMENT_CREATE.HTM
- DOCUMENT_RESULTLIST.HTM
- DOCUMENT_SEARCH.HTM
- TEMP_INDEX.HTM
- LEFT_DISPLAY.HTM
- VERSIONEN.HTM

These pages within Webdocuments [CA-DMS](https://me.sap.com/servicessupport/knowledge/mynotes/0001670098) do not sufficiently encode OUTPUT parameters, resulting in a cross-site scripting (XSS) vulnerability. This can be exploited to steal another user's authentication information, enabling impersonation and unauthorized access with the same user privileges. If an administrator is impersonated, the application's security could be fully compromised.

**Required OSS Notes Based on Release:**
- 1420256
- 1505976
- 1509753

### Solution

Apply **SAP Note 1670098** directly or import the necessary changes via the relevant support package. Ensure that all prerequisite notes are also applied based on your current release version.

**Download Options:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009915682017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001670098?language=en-US&token=C0C334BE8EB063E3982472DCBEAEEA39)

### Prerequisites

Ensure the following OSS Notes are applied before implementing this security note:
- [1420256 - Unauthorized modification of displayed content in Webdocs](https://me.sap.com/servicessupport/knowledge/mynotes/0001420256)
- [1505976 - Webdocs: Unauthorized Content Modification & Session Handling](https://me.sap.com/servicessupport/knowledge/mynotes/0001505976)
- [1509753 - Webdocs:XSRF Protection for BSP Application WebDocuments](https://me.sap.com/servicessupport/knowledge/mynotes/0001509753)

### Support Package Information

This note is applicable to the following software component versions:

- **EA-APPL 110**
  - Support Package: [SAPKGPAA34](https://me.sap.com/supportpackage/SAPKGPAA34)
- **EA-APPL 200**
  - Support Package: [SAPKGPAB23](https://me.sap.com/supportpackage/SAPKGPAB23)
- **EA-APPL 500**
  - Support Package: [SAPKGPAC27](https://me.sap.com/supportpackage/SAPKGPAC27)
- **EA-APPL 600**
  - Support Package: [SAPKGPAD22](https://me.sap.com/supportpackage/SAPKGPAD22)
- **EA-APPL 602**
  - Support Package: [SAPK-60212INEAAPPL](https://me.sap.com/supportpackage/SAPK-60212INEAAPPL)
- **EA-APPL 603**
  - Support Package: [SAPK-60311INEAAPPL](https://me.sap.com/supportpackage/SAPK-60311INEAAPPL)
- **EA-APPL 604**
  - Support Package: [SAPK-60412INEAAPPL](https://me.sap.com/supportpackage/SAPK-60412INEAAPPL)
- **EA-APPL 605**
  - Support Package: [SAPK-60509INEAAPPL](https://me.sap.com/supportpackage/SAPK-60509INEAAPPL)
- **EA-APPL 606**
  - Support Packages:
    - [SAPK-60604INEAAPPL](https://me.sap.com/supportpackage/SAPK-60604INEAAPPL)
    - [SAPK-60603INEAAPPL](https://me.sap.com/supportpackage/SAPK-60603INEAAPPL)

### References

- [1678243 - Unauthorized modification of BSP in Webdocuments (2)](https://me.sap.com/servicessupport/knowledge/mynotes/0001678243)
- [1582870 - ABAP XSS Escaping Support](https://me.sap.com/servicessupport/knowledge/mynotes/0001582870)
- [1582867 - Security options (XSS) for ESCAPE](https://me.sap.com/servicessupport/knowledge/mynotes/0001582867)
- [1509753 - Webdocs:XSRF Protection for BSP Application WebDocuments](https://me.sap.com/servicessupport/knowledge/mynotes/0001509753)
- [1505976 - Webdocs: Unauthorized Content Modification & Session Handling](https://me.sap.com/servicessupport/knowledge/mynotes/0001505976)
- [1420256 - Unauthorized modification of displayed content in Webdocs](https://me.sap.com/servicessupport/knowledge/mynotes/0001420256)

### CVSS Information

- **CVSS Score:** 0
- **CVSS Vector:** Not Provided

### Rating

This document currently has no ratings or reviews.

**Credits:** Special thanks to [RedRays](https://redrays.io) for supporting the provision of this information.