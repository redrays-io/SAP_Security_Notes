1683397 - Unauthorized modification of displayed content in PPM-PRO

**SAP Security Note 1683397 - Unauthorized modification of displayed content in PPM-PRO**

**Description**

**Symptom**

PPM-PRO can be abused by an attacker, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

**Other Terms**

Reflected cross-site scripting, XSS, PPM-PRO

**Reason and Prerequisites**

The classes `CL_EDMS_UTILS_UI_BSP`, `CL_DPR_URL_UTILS`, `CL_DPR_UI_LOG_DOCUMENTS`, `CL_DPR_UI_SERVICES`, `CL_DPR_R3DMS_UTILS`, `CL_DPR_FIN_GECCO_OLR3_SERVICES`, and `CL_PRP_SETTINGS` within PPM-PRO do not sufficiently encode input and output parameters, resulting in a reflected cross-site scripting issue. A reflected cross-site scripting attack can be used to non-permanently deface or modify displayed content from a website.

Reflected cross-site scripting can be used to steal another user's authentication information, such as data relating to their current session. An attacker who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**

Implement the correction instructions provided in this SAP Note.

**Correction Instructions**

To address the vulnerabilities outlined in this note, apply the following correction instructions:

- **Software Component:** CPRXRPM
  - [Implement Correction Instructions](https://me.sap.com/corrins/0001683397/381)

**Supported Software Components**

This SAP Note is applicable to the following software component versions:

- **CPRXRPM** 400
- **CPRXRPM** 450_700
- **CPRXRPM** 500_702

**Support Packages**

Ensure that the relevant support packages are applied:

- [SAPK-40021INCPRXRPM](https://me.sap.com/supportpackage/SAPK-40021INCPRXRPM) for CPRXRPM 400
- [SAPK-45014INCPRXRPM](https://me.sap.com/supportpackage/SAPK-45014INCPRXRPM) for CPRXRPM 450_700
- [SAPK-50008INCPRXRPM](https://me.sap.com/supportpackage/SAPK-50008INCPRXRPM) for CPRXRPM 500_702

**Preconditions**

Before implementing this SAP Note, ensure the following prerequisites are met by applying the respective SAP Notes:

1. [SAP Note 1063489](https://me.sap.com/notes/1063489) - Correction for Note 883420: URL for sending e-mails (PPM-PRO-RES)
2. [SAP Note 1631426](https://me.sap.com/notes/1631426) - Termination when the ad-hoc cost estimate is called (PPM-PRO-EXT-FIN)
3. [SAP Note 1654529](https://me.sap.com/notes/1654529) - Navigation to the ad hoc estimate is not working (PPM-PRO-EXT-FIN)
4. [SAP Note 1550882](https://me.sap.com/notes/1550882) - Create service methods (PPM-PRO)
5. [SAP Note 1433491](https://me.sap.com/notes/1433491) - Function module DPR_API_UI_GET_URL and cProjects language (PPM-PRO-EXT-API)
6. [SAP Note 1486305](https://me.sap.com/notes/1486305) - Document storage - 2 (PPM-PRO-DOC)
7. [SAP Note 1490392](https://me.sap.com/notes/1490392) - Document storage - 3 (PPM-PRO-DOC)
8. [SAP Note 1500374](https://me.sap.com/notes/1500374) - Documents: URL is not processed correctly (PPM-PRO-DOC)

**Additional Information**

- **Release Status:** Released for Customer
- **Released On:** May 8, 2012
- **Priority:** Correction with high priority
- **Category:** Program error

**Downloads**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009998802017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001683397?language=en-US&token=EED2BAA26390B0CFE70631BA5DC5CD16)

**Credits**

Special thanks to [Redrays.io](https://redrays.io) for their support in providing this information.