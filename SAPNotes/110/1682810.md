1682810 - Unauthorized use of application functions in SLC-REG

**Symptom**
An attacker can execute functions in SLC-REG without authentication and authorization.

**Other Terms**
Cross-site request forgery, XSRF, SLC-REG

**Reason and Prerequisites**
SLC-REG executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The attacker may use a cross-site scripting attack to do this, or they may present a link to the victim.

**Solution**
Implement the following correction instructions manually or import the relevant Support Package.

### Manual Activities

#### 1. Adapt SICF settings of service "ROS_EXT_2":
- Log on to the development client of your SLC system.
- Go to transaction `SICF`.
- Enter `ROS_EXT_2` in the "Service Name" field and press "Execute".
- In the details of service `ROS_EXT_2`, navigate to the "Service Data" tab.
- Enter the value `SLCBSPR2` in the "SAP Authoriz." field.
- Save the changed SICF service `ROS_EXT_2`.
- Test the service `ROS_EXT_2` by right-clicking on it and selecting "Test Service".
- Transport the adapted SICF service `ROS_EXT_2` through your system landscape.

#### 2. Adapt PFCG role for initial Supplier user
- Log on to the customizing client of your SLC system.
- Go to transaction `PFCG`.
- Enter role `/SRMSMC/SUPPLIER_INITIAL` and press "Change".
- Navigate to the "Authorizations" tab.
- Press "Change Authorization Data".
- Press "Manual entry of authorization objects".
- Enter authorization object `S_ICF` and press "Continue (Enter)".
- Enter the following attributes for authorization object `S_ICF`:
  - `ICF_FIELD = "SERVICE"`
  - `ICF_VALUE = "SLCBSPR2"`
- Press "Save".
- Press "Generate".
- Press "Back (F3)".
- Press "Save" to save the PFCG role `/SRMSMC/SUPPLIER_INITIAL`.
- Transport the adapted PFCG role `/SRMSMC/SUPPLIER_INITIAL` through your system landscape.
- **Remark:** If you have changed the role for the initial Supplier user, adapt the corresponding PFCG role using function module `/SRMSMC/EXT_ROLE_GET_TAD_ROLES`.

#### 3. Adapt PFCG roles for the "Supplier Data Maintenance"
- Adapt the following PFCG roles as described in step 2:
  - `/SRMSMC/EMPLOYEE_ADMINISTRATOR`
  - `/SRMSMC/QUALIFICATION_EXPERT`
  - `/SRMSMC/SUPPLIER_MASTER_DATA`
- **Remark:** If you have changed the roles for "Supplier Data Maintenance," adapt the corresponding PFCG roles using function module `/SRMSMC/EXT_ROLE_GET_ADM_ROLES`.

### Additional Steps
- Ensure the BSP application `/SRMSMC/ROS_EXT_2` is properly configured and activated.
- Verify all changes in your system landscape to ensure the security measures are effective.

For more detailed instructions and downloads, refer to the [SAP Note 1682810](https://me.sap.com/note/1682810).

---

_Credits to [redrays.io](https://redrays.io) for supporting the provision of this information._