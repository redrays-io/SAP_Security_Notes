SAP Security Note 2379342 - Cross-Site Scripting (XSS) vulnerability in backup function of SAP HANA cockpit

**Description**

The backup function in the SAP HANA cockpit does not sufficiently encode user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability.

**Symptom**

Some well-known impacts of XSS vulnerabilities are:
- Temporary defacement or modification of displayed content from a website.
- Stealing authentication information of the user, such as data relating to their current session.
- Impersonating the user and accessing all information with the same rights as the target user.

**CVSS Information**

- **CVSS v3 Base Score:** 3.5 / 10
- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** Low (L)
- **User Interaction:** Required (R)
- **Scope:** Unchanged (U)
- **Impact on Confidentiality:** None (N)
- **Impact on Integrity:** Low (L)
- **Impact on Availability:** None (N)

_SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note._

**Reason and Prerequisites**

Limiting factors for this potential vulnerability:
- Only users with a backup role (e.g., `sap.hana.backup.roles::Operator`) can be attacked.
- A potential attacker needs to bypass the CSRF (Cross-Site Request Forgery) protection of the application.

**Solution**

Encoding of user-controlled inputs for the backup function in HANA cockpit has been improved. The fix is included in:
- **Revision 122.02** for SAP HANA SPS12
- **Revision 112.07** for SAP HANA SPS11

_Update to these or later versions._

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018417692017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002379342?language=en-US&token=7CBAF3867F354E79E4D7B3C457BD698A)

**References**

_No references available._

**Validity**

- **Software Component:** HDB
- **From:** 1.00
- **To:** 1.00

**Support Package Patches**

- **SAP HANA DATABASE 1.00**
  - **SP122 Patch Level 000002:** [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP122&patch_level=000002)
  - **SP112 Patch Level 000007:** [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP112&patch_level=000007)

**Credits**

Thanks to [RedRays](https://redrays.io) for supporting the provision of this information.