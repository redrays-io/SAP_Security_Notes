SAP Security Note 2393937 - VMC Authority Check

**Type:** SAP Security Note  
**Version:** 2  
**Released On:** 12.11.2019  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Component:** Application Platform > Pricing and Condition Technique > Pricing

## Description

This security note addresses missing authorization checks in SAP Internet Pricing and Configurator (IPC), Version AP 7.00 and higher. Specifically, IPC does not perform necessary authorization checks for authenticated users, potentially allowing escalation of privileges.

### Impacts of Missing Authorization Checks

- **Abuse Functionality:** Restricted functionalities could be exploited by unauthorized user groups.
- **Data Manipulation:** Risk of reading, modifying, or deleting restricted data.

## Reason and Prerequisites

Remote calls to RFC function modules are protected by the S_RFC authorization object by default. However, these checks might not suffice for certain RFC function modules. Activating the new switchable authorization checks is necessary for enhanced security.

## Solution

### Implementing New Switchable Authorization Checks

1. **Support Package Installation:**
   - Available from AP 7.00 SP25 to SP34 as a patch.
   - Available in standard for AP 7.00 SP35 and AP 7.50 SP06.
   - [Download Support Packages](https://me.sap.com/supportpackage/SAPKNA7035)

2. **Activation of Authorization Checks:**
   - Use transaction **SACF** to activate the new authorization scenario.
   - Detailed instructions are provided in the manual correction instructions within the note.
   - [Download for SNOTE](https://notesdownloads.sap.com/note/0040000002022542019)
   - [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002393937?language=en-US&token=46552C2A330657E12DC423C96A253B61)

3. **Update Roles:**
   - Ensure that all roles using AP Engines have the IPC authorization object added.
   - [Edit Note](https://me.sap.com/sap/support/notes/edit/0002393937)

## CVSS

- **Score:** 7.1
- **Vector:** CVSS:3.0/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:H

## References

- [Note 2368820 - Signal 11 while using Java_com_sap_vmc_sec_auth_JTSAuthority_checkPermission](https://me.sap.com/notes/2368820)
- [Note 2316425 - Architectural change](https://me.sap.com/notes/2316425)
- [Note 2216306 - S_RFC check and profile parameter auth/rfc_authority_check](https://me.sap.com/notes/2216306)
- [Note 2008727 - Securing Remote Function Calls (RFC)](https://me.sap.com/notes/2008727)
- [Note 1995667 - SACF: Navigation error](https://me.sap.com/notes/1995667)
- [Note 1922808 - SACF | FAQ | Supplementary information about the application](https://me.sap.com/notes/1922808)

## Supported Software Components

- **SAP_AP:** Versions 700 and 750
- **SAPAPIPCJ:** Version 700

## Support Package Patches

Multiple patches are available for SAP AP IPC JAVA 7.00, ranging from SP025 to SP035. [View All Patches](https://me.sap.com/supportpackage/SAPKNA7035)

## Attachments

- [IPC.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001338602016&iv_version=0002&iv_guid=6EAE8B28C5091ED6BED2EAA5EDD840C8) (447 bytes)

---

*Credits: Special thanks to [Redrays](https://redrays.io) for supporting the provision of this information.*