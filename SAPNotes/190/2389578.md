2389578 - Directory Traversal vulnerability in File Interface in SAP Netweaver

**Description**

**Symptom**

The File Interface allows an attacker to exploit insufficient validation of path information provided by users. Characters representing "traverse to parent directory" are passed through to the file APIs.

Some well-known impacts of Directory Traversal vulnerability are:
- Attacker could read content of arbitrary files on the remote server and expose sensitive data
- Attacker could overwrite, delete, or corrupt arbitrary files on the remote server

**CVSS Information**

**CVSS v3 Base Score:** 5.0 / 10  
**CVSS v3 Base Vector:**

| Key                           | Value          |
|-------------------------------|----------------|
| AV : Attack Vector            | Network (N)    |
| AC : Attack Complexity        | High (H)       |
| PR : Privileges Required      | Low (L)        |
| UI : User Interaction         | None (N)       |
| S : Scope                     | Unchanged (U)  |
| C : Impact to Confidentiality | Low (L)        |
| I : Impact to Integrity       | Low (L)        |
| A : Impact to Availability    | Low (L)        |

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).

**Reason and Prerequisites**

The function modules `FILE_VALIDATE_NAME` and `FILE_GET_NAME_AND_VALIDATE` do not work properly if they are called for Unix and MS Windows intermixed within the same internal mode. For example, if `FILE_VALIDATE_NAME` is first called with the parameter `OPERATING_SYSTEM = 'Windows NT'`, then with `OPERATING_SYSTEM = 'Linux'`, and then with `OPERATING_SYSTEM = 'Windows NT'` again, the function module does not properly determine whether the file name is admissible.

Similarly, the method `IS_SUBPATH_OF` of the class `CL_FS_PATH` does not work properly if it is called for Unix and MS Windows intermixed within the same internal mode.

**Solution**

This SAP Note provides a correction for the class `CL_FS_PATH` so that its method `IS_SUBPATH_OF` and the function modules `FILE_VALIDATE_NAME` and `FILE_GET_NAME_AND_VALIDATE` work as expected.

Please implement the Support Package mentioned in this SAP Note or apply the correction instruction.

**Affected Components**

- **SAP_BASIS** versions:
  - 700 to 702
  - 710 to 711
  - 730
  - 731
  - 740
  - 750 to 751

**Support Package**

Refer to the following Support Packages for your SAP_BASIS version:
- [SAPKB70034](https://me.sap.com/supportpackage/SAPKB70034)
- [SAPKB70119](https://me.sap.com/supportpackage/SAPKB70119)
- [SAPKB70219](https://me.sap.com/supportpackage/SAPKB70219)
- [SAPKB71022](https://me.sap.com/supportpackage/SAPKB71022)
- [SAPKB71117](https://me.sap.com/supportpackage/SAPKB71117)
- [SAPKB73017](https://me.sap.com/supportpackage/SAPKB73017)
- [SAPKB73120](https://me.sap.com/supportpackage/SAPKB73120)
- [SAPKB74017](https://me.sap.com/supportpackage/SAPKB74017)
- [SAPK-75007INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75007INSAPBASIS)
- [SAPK-75102INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75102INSAPBASIS)

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000014085552017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002389578?language=en-US&token=FBBD3EBE81C11DD297EB646E1987E303)

**Additional Information**

**Attributes**
- Externally Reported: Yes

**References**
- Referenced by [2387279 - Wrong value in CL_FS_PATH=>SEPARATOR](https://me.sap.com/notes/2387279)

For more details, visit the [SAP Security Notes](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for supporting the provided information.*