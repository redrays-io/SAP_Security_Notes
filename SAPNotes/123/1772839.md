1772839 - Potential disclosure of persisted data in BC-SRV-ADR

### Symptom

An attacker can exploit address master data and use specially crafted inputs to modify database commands, resulting in the retrieval of additional information persisted by the system.

### Other Terms

SQL injection, database, BC-SRV-ADR

### Reason and Prerequisites

The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by an attacker. The manipulated SQL statement can then be used to retrieve data from the database.

### Solution

Implement the code corrections in this note.

### Affected Software Components

- **SAP_BASIS**:
  - From 46C to 46C
  - From 620 to 640
  - From 700 to 702
  - From 710 to 730
  - From 731 to 731
  - From 740 to 740

### Support Packages

- [SAPKB46C65](https://me.sap.com/supportpackage/SAPKB46C65) for SAP_BASIS 46C
- [SAPKB62073](https://me.sap.com/supportpackage/SAPKB62073) for SAP_BASIS 620
- [SAPKB62074](https://me.sap.com/supportpackage/SAPKB62074) for SAP_BASIS 620
- [SAPKB64031](https://me.sap.com/supportpackage/SAPKB64031) for SAP_BASIS 640
- [SAPKB64032](https://me.sap.com/supportpackage/SAPKB64032) for SAP_BASIS 640
- [SAPKB70028](https://me.sap.com/supportpackage/SAPKB70028) for SAP_BASIS 700
- [SAPKB70029](https://me.sap.com/supportpackage/SAPKB70029) for SAP_BASIS 700
- [SAPKB70114](https://me.sap.com/supportpackage/SAPKB70114) for SAP_BASIS 701
- [SAPKB70113](https://me.sap.com/supportpackage/SAPKB70113) for SAP_BASIS 701
- [SAPKB70213](https://me.sap.com/supportpackage/SAPKB70213) for SAP_BASIS 702
- [SAPKB71017](https://me.sap.com/supportpackage/SAPKB71017) for SAP_BASIS 710
- [SAPKB71016](https://me.sap.com/supportpackage/SAPKB71016) for SAP_BASIS 710
- [SAPKB71111](https://me.sap.com/supportpackage/SAPKB71111) for SAP_BASIS 711
- [SAPKB72008](https://me.sap.com/supportpackage/SAPKB72008) for SAP_BASIS 720
- [SAPKB73009](https://me.sap.com/supportpackage/SAPKB73009) for SAP_BASIS 730
- [SAPKB73107](https://me.sap.com/supportpackage/SAPKB73107) for SAP_BASIS 731
- [SAPKB73106](https://me.sap.com/supportpackage/SAPKB73106) for SAP_BASIS 731
- [SAPKB74001](https://me.sap.com/supportpackage/SAPKB74001) for SAP_BASIS 740

### Correction Instructions

There are 12 correction instructions available. Additionally, there is 1 manual activity required.

#### Manual Activities

```plaintext
------------------------------------------------------------------------
|Manual Pre-Implement.                                                              |
------------------------------------------------------------------------
|VALID FOR                                                                                   |
|Software Component   SAP_BASIS                                                                 |
| Release 46C          Until SAPKB46C64                                                          |
| Release 620          Until SAPKB62072                                                          |
| Release 640          Until SAPKB64030                                                          |
| Release 700          SAPKB70004 - SAPKB70027                                                 |
| Release 710          Until SAPKB71015                                                          |
| Release 711          SAPKB71101 - SAPKB71110                                                 |
| Release 701          Until SAPKB70112                                                          |
| Release 702          SAPKB70201 - SAPKB70212                                                 |
| Release 730          SAPKB73001 - SAPKB73008                                                 |
| Release 720          SAPKB72002 - SAPKB72007                                                 |
| Release 731          SAPKB73101 - SAPKB73105                                                 |
| Release 740          w/o Support Packages                                                    |
------------------------------------------------------------------------

You need to follow these manual steps that are mentioned below:

Creation of AM 560 message.

1. Go to transaction 'SE91'.
2. Enter the message class as 'AM' and choose subobjects as 'messages'.
3. Now enter '560' in number field and click on 'change'.
4. Here you need to maintain the text in 'English' (If the log on language is English)
   "Entry is Invalid".
5. The text in German language is "Eintrag ist nicht g√ºltig". Use this text if you are maintaining the data either in the 'original language' or if your logon language is 'German'.
6. Save and activate the changes made.
```

### References

- [Compare Versions](https://me.sap.com/notesLatestChanges/0001772839/E/diff)
- [Correction Instructions](https://me.sap.com/corrins/0001772839/41)

Credits to [https://redrays.io](https://redrays.io) for support to provided information.