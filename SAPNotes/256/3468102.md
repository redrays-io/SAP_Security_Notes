SAP Security Note 3468102: CVE-2024-41732 Improper Access Control in SAP Netweaver Application Server ABAP

**Header Data**
- **SAP Note/KBA:** 3468102
- **Type:** SAP Security Note
- **Version:** 10
- **Recency:** New
- **Language:** English
- **Master Language:** English
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Release Status:** Released for Customer
- **Released On:** 13.08.2024
- **Component:** Basis Components > Frontend Services (SAP Note 1322184) > Netweaver Business Client > Runtime

**Description**
### Symptom
SAP NetWeaver Application Server ABAP allows an unauthenticated attacker to craft a URL link that could bypass allowlist controls. Depending on the web applications provided by this server, the attacker might inject CSS code or links into the web application that could allow the attacker to read or modify information. There is no impact on the availability of the application.

### Other Terms
- CSS Code Injection
- CSS File Injection
- [CVE-2024-41732](https://www.cve.org/CVERecord?id=CVE-2024-41732)

### Solution
The allowlist check causing this potential attack was improved to properly distinguish between relative and absolute URLs.

Please implement the correction assigned to this SAP Note in your Application Server ABAP.

**Attributes**
- **Externally Reported:** Yes

**CVSS**
- **CVSS Score:** 4.7
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N)

  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

**Solution Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000919822024)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003468102?language=en-US&token=6C9DC1CC89719B0BD870D09DA270197D)
- [Share by Email](https://me.sap.com/notes/0003468102/share)
- [Open in New Window](https://me.sap.com/notes/0003468102/open)
  
**Support Packages**
- **SAP_BASIS 700:** [SAPKB70042](https://me.sap.com/supportpackage/SAPKB70042)
- **SAP_BASIS 701:** [SAPKB70127](https://me.sap.com/supportpackage/SAPKB70127)
- **SAP_BASIS 702:** [SAPKB70227](https://me.sap.com/supportpackage/SAPKB70227)
- **SAP_BASIS 731:** [SAPKB73135](https://me.sap.com/supportpackage/SAPKB73135)
- **SAP_UI 754:** [SAPK-75416INSAPUI](https://me.sap.com/supportpackage/SAPK-75416INSAPUI)
- **SAP_UI 755:** [SAPK-75513INSAPUI](https://me.sap.com/supportpackage/SAPK-75513INSAPUI)
- **SAP_UI 756:** [SAPK-75610INSAPUI](https://me.sap.com/supportpackage/SAPK-75610INSAPUI)
- **SAP_UI 757:** [SAPK-75707INSAPUI](https://me.sap.com/supportpackage/SAPK-75707INSAPUI)
- **SAP_UI 758:** [SAPK-75802INSAPUI](https://me.sap.com/supportpackage/SAPK-75802INSAPUI)
- **SAP_BASIS 912:** [SAPK-91201INSAPBASIS](https://me.sap.com/supportpackage/SAPK-91201INSAPBASIS)

**Correction Instructions**
- **SAP_UI:** [Correction 15108](https://me.sap.com/corrins/0003468102/15108)
- **SAP_BASIS:** [Correction 41](https://me.sap.com/corrins/0003468102/41)

**Prerequisites**
- **SAP_BASIS 700 to 731:**
  - [SAP NWBC ABAP Runtime Patch 62](https://me.sap.com/notes/2653653)
  - [SAP NWBC ABAP Runtime Patch 74](https://me.sap.com/notes/2963391)
  - [SAP NWBC ABAP Runtime Patch 77](https://me.sap.com/notes/3065048)
  - [SAP NWBC ABAP Runtime Patch 87](https://me.sap.com/notes/3421170)
- **SAP_UI 750 to 755:**
  - [SAP NWBC ABAP Runtime Patch 74](https://me.sap.com/notes/2963391)
- **SAP_UI 753 to 756:**
  - [SAP NWBC ABAP Runtime Patch 77](https://me.sap.com/notes/3065048)
- **SAP_UI 754 to 758:**
  - [SAP NWBC ABAP Runtime Patch 87](https://me.sap.com/notes/3421170)

For more details, visit the official [SAP Security Notes](https://me.sap.com/notes/3468102).

*Credits to [RedRays](https://redrays.io) for supporting the information provided.*