3469791 - [CVE-2024-54198] Information Disclosure Vulnerability through Remote Function Call (RFC) in SAP NetWeaver Application Server ABAP

## Description

### Symptom
In certain conditions, SAP NetWeaver Application Server ABAP allows an authenticated attacker to craft a Remote Function Call (RFC) request to restricted destinations, which can be used to expose credentials for a remote service. These credentials can then be further exploited to completely compromise the remote service, potentially resulting in a significant impact on the confidentiality, integrity, and availability of the application.

### Other Terms
Information Exposure, Information Leak, Remote function call, RFC, [CVE-2024-54198](https://www.cve.org/CVERecord?id=CVE-2024-54198)

### Reason and Prerequisites
The vulnerability arises due to improper access control and insufficient restriction on RFC Destinations.

## Solution
This correction is initially delivered with the kernel patch level listed in the **[Support Package Patches](https://me.sap.com/notes/2083594)** section of this SAP Note. All subsequent kernel patch levels also contain the correction. Keep in mind that only the latest kernel patch level is available for download; however, it contains all previously delivered corrections. As a result, you can download and install the latest available kernel patch at any time to implement this correction.

This correction is delivered with the following kernel archives:
- dw.sar

**Follow the SAP recommendations on how to select and install the kernel patch:**
1. Apply the latest **SP Stack Kernel** if it contains the correction (PL of correction is smaller or equal to the PL of the latest SP Stack Kernel). For the list of current SP Stack Kernels, see [SAP Note 2083594](https://me.sap.com/notes/2083594) (SAP Kernel Versions and SAP Kernel Patch Levels).
2. Otherwise, the next **SP Stack Kernel** will deliver the correction. Apply the **hotfix** only if you require the correction on short notice.
3. If corrections are not available for any kernel releases that are out of maintenance, please upgrade to the corresponding downward compatible kernel (**DCK**), see [SAP Note 2083594](https://me.sap.com/notes/2083594) for more information.
4. Review the **[regression note](https://me.sap.com/notes/1802333)** for the target patch level before installing the patch. For details, see [SAP Note 1802333](https://me.sap.com/notes/1802333) (Finding information about regressions in the SAP kernel).
5. For instructions on how to download and install kernel patches, see [SAP Note 19466](https://me.sap.com/notes/19466) (Downloading SAP kernel patches).

The paper [Update Strategy for the Kernel of the Application Server ABAP in On Premise Landscapes](https://support.sap.com/deployment-strategies-kernel-abap.pdf) provides detailed SAP recommendations.

In case of problems, consider [SAP Note 3520232](https://me.sap.com/notes/3520232).

## Workaround
Please assess the workaround applicability for your SAP landscape prior to implementation. Note that this workaround is a temporary fix and is not a permanent solution. SAP strongly recommends you apply the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.

Specifying the following profile parameter will completely deactivate the legacy dynamic destination:

```
rfc/dynamic_dest_api_only = 1
```

**Attention:** Consider the workaround may have a bigger impact on existing applications than applying the Kernel patch. All applications which make use of the legacy dynamic destination will fail. Also in this case, [SAP Note 3520232](https://me.sap.com/notes/3520232) could provide solutions.

## CVSS
**CVSS Score:** 8.5  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/application?vector=CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H)

| Metric                   | Value           |
|--------------------------|-----------------|
| **Attack Vector (AV)**   | Network (N)     |
| **Attack Complexity (AC)** | High (H)       |
| **Privileges Required (PR)** | Low (L)        |
| **User Interaction (UI)** | None (N)        |
| **Scope (S)**            | Changed (C)     |
| **Confidentiality Impact (C)** | High (H)    |
| **Integrity Impact (I)** | High (H)        |
| **Availability Impact (A)** | High (H)     |

## Available Languages
- [日本語](https://me.sap.com/notes/0003469791/J)
- [Deutsch](https://me.sap.com/notes/0003469791/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0003469791/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003469791/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003469791/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003469791/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003469791/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003469791/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003469791/3)

## References
### This document refers to
- [3520232 - FAQ for Note 3469791](https://me.sap.com/notes/3520232)
- [3520232 - FAQ for Note 3469791](https://me.sap.com/notes/3520232)

### This document is causing side effects
- [3527924 - None Unicode System: Error RFC Send Back Samesystem](https://me.sap.com/notes/0003527924)

## Software Components Affected
- KRNL64NUC: 7.22 to 7.22
- KRNL64NUC: 7.22EXT to 7.22EXT
- KRNL64UC: 7.22 to 7.22
- KRNL64UC: 7.22EXT to 7.22EXT
- KRNL64UC: 7.53 to 7.53
- KERNEL: 7.22 to 7.22
- KERNEL: 7.53 to 7.53
- KERNEL: 7.77 to 7.77
- KERNEL: 7.89 to 7.89
- KERNEL: 7.54 to 7.54
- KERNEL: 7.93 to 7.93

## Support Package Patches
- [SAP KERNEL 7.89 64-BIT UNICODE SP254](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200015809&V=MAINT)
- [SAP KERNEL 7.93 64-BIT UNICODE SP112](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200018813&V=MAINT)
- [SAP KERNEL 7.77 64-BIT UNICODE SP660](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010526&V=MAINT)
- ... *(additional patches listed similarly)*

For the complete list of support package patches, refer to the [Support Package Patches](https://me.sap.com/notes/3469791) section of this SAP Note.

*Credits to [Redrays](https://redrays.io) for supporting the provision of this information.*