3469958 - [CVE-2024-37171] Server-Side Request Forgery (SSRF) in SAP Transportation Management (Collaboration Portal)

**Header Data**
- **SAP Note/KBA**: 3469958
- **Type**: SAP Security Note
- **Version**: 9
- **Recency**: New
- **Language**: English
- **Master Language**: English
- **Category**: Program error
- **Priority**: Correction with medium priority
- **Release Status**: Released for Customer
- **Released On**: 08.07.2024
- **Component**: SAPTMUI - Collaboration Portal

**Title**
3469958 - [CVE-2024-37171] Server-Side Request Forgery (SSRF) in SAP Transportation Management (Collaboration Portal)

**Description**

### Symptom
SAP Transportation Management (Collaboration Portal) allows an attacker with non-administrative privileges to send a crafted request from a vulnerable web application. This will trigger the application handler to send a request to an unintended service, which may reveal information about that service. The information obtained could be used to target internal systems behind firewalls that are normally inaccessible to an attacker from the external network, resulting in a Server-Side Request Forgery vulnerability. There is no effect on the integrity or availability of the application.

### Other Terms
Server-Side Request Forgery, SSRF, Information exposure, [CVE-2024-37171](https://www.cve.org/CVERecord?id=CVE-2024-37171)

### Reason and Prerequisites
Untrusted input was used to construct the target URL of a request.

### Solution
The implementation of the service handler was hardened: untrusted input is no longer considered by internal logic.

Implement the attached correction instructions or install the corresponding [Support Package](https://me.sap.com/supportpackage/SAPK-14017INSAPTMUI).

**CVSS**
- **Score**: 5.0
- **Vector**: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N

  | Key                      | Value                |
  |--------------------------|----------------------|
  | Attack Vector (AV)       | Network (N)          |
  | Attack Complexity (AC)   | Low (L)              |
  | Privileges Required (PR) | Low (L)              |
  | User Interaction (UI)    | None (N)             |
  | Scope (S)                | Changed (C)          |
  | Confidentiality Impact (C)| Low (L)             |
  | Integrity Impact (I)     | None (N)             |
  | Availability Impact (A)  | None (N)             |

**Supported Software Components**
| Software Component | From | To  |
|--------------------|------|-----|
| SAPTMUI            | 140  | 140 |
| SAPTMUI            | 150  | 150 |
| SAPTMUI            | 160  | 160 |
| SAPTMUI            | 170  | 170 |

**Support Package**
| Software Component Version | Support Package          | URL                                                      |
|----------------------------|--------------------------|----------------------------------------------------------|
| SAPTMUI 140                | SAPK-14017INSAPTMUI      | [Download](https://me.sap.com/supportpackage/SAPK-14017INSAPTMUI) |
| SAPTMUI 150                | SAPK-15019INSAPTMUI      | [Download](https://me.sap.com/supportpackage/SAPK-15019INSAPTMUI) |
| SAPTMUI 160                | SAPK-16015INSAPTMUI      | [Download](https://me.sap.com/supportpackage/SAPK-16015INSAPTMUI) |
| SAPTMUI 170                | SAPK-17012INSAPTMUI      | [Download](https://me.sap.com/supportpackage/SAPK-17012INSAPTMUI) |

**Correction Instructions**
| Software Component | Number of Correction Instructions | URL                                                            |
|--------------------|-----------------------------------|----------------------------------------------------------------|
| SAPTMUI            | 4                                 | [Correction Instructions](https://me.sap.com/corrins/0003469958/15598) |

**CVSS Vector Details**
- **Attack Vector (AV)**: Network (N)
- **Attack Complexity (AC)**: Low (L)
- **Privileges Required (PR)**: Low (L)
- **User Interaction (UI)**: None (N)
- **Scope (S)**: Changed (C)
- **Confidentiality Impact (C)**: Low (L)
- **Integrity Impact (I)**: None (N)
- **Availability Impact (A)**: None (N)

**Additional Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000782422024)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003469958?language=en-US&token=09BDE632077B0841A2C008CA7AAAB444)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0003469958) *(Visible to authorized users)*
- [Show Changes](https://me.sap.com/notes/0003469958/compare) *(Available when applicable)*

_Credits to [https://redrays.io](https://redrays.io) for support to provided information._