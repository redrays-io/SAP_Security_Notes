3471450 - [CVE-2024-41733] Information Disclosure Vulnerability in SAP Commerce

## Symptom
In SAP Commerce, valid user accounts can be identified during the customer registration and login processes. This allows a potential attacker to determine if a specific email is associated with an account. However, this does not grant access to any customer data beyond confirming the existence of the email address. The impact on confidentiality is low, with no impact on integrity or availability.

## Other Terms
- Enumeration attack
- Account enumeration
- [CVE-2024-41733](https://www.cve.org/CVERecord?id=CVE-2024-41733)

## Reason and Prerequisites
SAP Commerce in the affected versions allows the identification of whether a given email is already used for an account during self-service registration and, in some cases, during the login process. This occurs due to specific responses sent during these processes. While access to personal data is not gained, the information may be restricted to the visited site if isolated sites are used. A prerequisite for this vulnerability is that user self-service registration is active.

## Solution
SAP Commerce (Cloud) addresses this vulnerability by introducing two improvements:

1. **Secure Registration**: Always indicates success upon registration.
2. **Log in with One-Time Verification Code**: Adds a one-time verification code to the login process, delivered via the provided email address.

Due to compatibility considerations, these improvements are controlled by the following flags, which are disabled by default:
- `toggle.secure.customer.registration.enabled`
- `otp.customer.login.enabled`

**To fix the vulnerability, set the above flags to `true` and follow the documentation below to activate the features:**

### For 2211:
- [Activating User Enumeration Prevention in Customer Registration Flow](https://me.sap.com/help/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/16b4c4fd6b184b4aaa332c7db407d4c3.html)
- [Activating Customer Login with Verification Token](https://me.sap.com/help/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/f68df6d24bc44369a7faea9d62734f49.html)

### For 2205:
- [Patch Upgrade Notes](https://me.sap.com/help/SAP_COMMERCE/p18f6a711d07462b80137df6ed533eee.html?version=2205)

**The following patches include these improvements:**
- [SAP Commerce Patch Release 2205.26](https://me.sap.com/help/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?version=2205)
- [SAP Commerce Cloud Update Release 2211.24](https://me.sap.com/help/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/f9b65161e1e645249542e59f42f64a7b.html?locale=en-US)

**Software Downloads:**
- [SAP Commerce Cloud in the Public Cloud](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=73555000100800001224&V=MAINT&TA=ACTUAL/SAP%20COMMERCE%20CLOUD%20V2)
- [SAP Commerce On-Premise](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL&PAGE=SEARCH/SAP%20COMMERCE)

For information about installing patches, see [About Update Releases](https://me.sap.com/help/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/8c25978386691014b4abdd61376acd24.html?locale=en-US). After installing a SAP Commerce Cloud patch, rebuild and redeploy the updated version.

## CVSS
**Score:** 5.3  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N  
- **Attack Vector:** Network  
- **Attack Complexity:** Low  
- **Privileges Required:** None  
- **User Interaction:** None  
- **Scope:** Unchanged  
- **Confidentiality Impact:** Low  
- **Integrity Impact:** None  
- **Availability Impact:** None

## Workaround
None

---

Credits to [RedRays](https://redrays.io) for support in providing this information.