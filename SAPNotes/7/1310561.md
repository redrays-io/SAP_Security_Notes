SAP Security Note 1310561 - SAP J2EE Engine Session Fixation Protection

---

**SAP Note 1310561: SAP J2EE Engine Session Fixation Protection**

**Type:** SAP Security Note  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 13.12.2010  
**Component:** Basis Components > NetWeaver Application Server Java > Web Container, HTTP, JavaMail, Servlets

### **Description**

**Symptom**

A session fixation vulnerability in the SAP J2EE Engine can be exploited to gain access to authenticated user sessions. This allows an attacker to trick a user into using a session ID known to the attacker, providing unauthorized access when the user authenticates using that session ID.

**Other Terms**

- Session fixation
- Session hijacking
- `SessionIdRegenerationEnabled`
- Security session not found

**Reason and Prerequisites**

A session fixation vulnerability allows an attacker to trick a user into using a valid session ID known by the attacker. If the user authenticates with this session ID, the attacker gains access based on it. This vulnerability can affect any users, including administrators and regular users.

To prevent this vulnerability, it is strongly recommended to enable the `SessionIdRegenerationEnabled` property of the Web Container. Although this property is present in earlier service packs of the Engine, the session fixation protection handling has been significantly improved in the latest version of the Engine.

### **Solution**

1. **Upgrade to the Latest Version of the Engine**
   - **Note:** This fix depends on the fix from [SAP Note 1175239](https://me.sap.com/notes/1175239) and requires applying the respective patch `SAPJEECOR.SCA`.

2. **Enable Session Fixation Protection Mechanism**
   - The session fixation protection mechanism is enabled by default in:
     - 7.11 SP06 and later
     - All service packs (SPs) of 7.20 and 7.30

   - **For Other Versions, Follow These Steps:**
     1. Open Configtool.
     2. Navigate to `cluster-data` → `Global server configuration` → `services` → `servlet_jsp`.
     3. Click on the `SessionIdRegenerationEnabled` property.
     4. In the Value field, type `true`.
     5. Press the `Set` button in the top-right corner.
     6. Press the `Save` button (diskette icon) in the top-left corner.
     7. Confirm all popups.
     8. Restart the server nodes for changes to take effect.

### **Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016739812017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001310561?language=en-US&token=CA2A996824B2C6D47483EEB5CE4BC507)

### **Attachments**

- [reloginPortalWebDynpro.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000213602009&iv_version=0006&iv_guid=C7A26A75A23A9740A63683E13CF7B739)
- [640_SP25_patch.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000213602009&iv_version=0006&iv_guid=ED0FB905850DA142B745961E4E6AAE59)
- [640_SP24_patch.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000213602009&iv_version=0006&iv_guid=6C88CE7D495F76439B83EA65CD624CEA)

### **References**

This document refers to:

- [SAP Note 1787413: User session lost when switching between Web applications](https://me.sap.com/notes/1787413)
- [SAP Note 1538719: Single Sign-On Configuration for SAP (X)MII](https://me.sap.com/notes/1538719)
- [SAP Note 1538139: HTTP session not found after cancelled request in FPN](https://me.sap.com/notes/1538139)
- [SAP Note 1521197: Update #1 to Security Note 1517094](https://me.sap.com/notes/1521197)
- [SAP Note 1517094: CRM-IC: Session Access Token](https://me.sap.com/notes/1517094)
- [SAP Note 1503236: Application configuration due to J2EE security settings](https://me.sap.com/notes/1503236)
- [SAP Note 1501922: The recall of the B2C application does not work](https://me.sap.com/notes/1501922)
- [SAP Note 1501919: Start.jsp enhancements](https://me.sap.com/notes/1501919)
- [SAP Note 1492234: No SessionIDRegeneration in CRM Web Channel B2C/B2B Scenario](https://me.sap.com/notes/1492234)
- [SAP Note 1464914: JSESSIONID cookie value is unexpectedly changed by the server](https://me.sap.com/notes/1464914)
- [SAP Note 1449940: Browsing Web Shop via HTTP with SessionIDRegenerationEnabled](https://me.sap.com/notes/1449940)
- [SAP Note 1417679: Session Fixation Attack Detection](https://me.sap.com/notes/1417679)
- [SAP Note 1175239: XSS attacks protection](https://me.sap.com/notes/1175239)

### **Credits**

Thanks to [RedRays](https://redrays.io) for support in providing this information.