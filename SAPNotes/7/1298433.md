1298433 - Bypassing security in reginfo & secinfo

**SAP Security Note 1298433 - Bypassing Security in reginfo & secinfo**

**Overview**
This security note addresses a critical vulnerability in SAP systems where the settings for the files `reginfo` and `secinfo` can be bypassed. As a result, unauthorized programs may gain the ability to communicate with the SAP gateway, potentially compromising system security.

**Affected Versions**
- **Kernel Releases:** 31I-45B
- **SAP Components:** BC-CST-GW

**Symptoms**
- Unauthorized programs can communicate with the SAP gateway by bypassing `reginfo` and `secinfo` settings.
- This affects kernel release 701 and certain other releases as detailed in the note.

**Cause**
A program error in the kernel allows the bypassing of security settings in `reginfo` and `secinfo` files. For security reasons, detailed information about the error is not disclosed.

**Solution**

**Workaround:**
If immediate correction is not feasible, enhance system protection by:
- Implementing a firewall to restrict connections to the SAP gateway to only trusted hosts.
- Ensuring all connections to the gateway from remote hosts are secured using Secure Network Communication (SNC). This can be achieved by:
  - Using connections between two SAProuters secured via SNC for the WAN segment.
  - Utilizing a Virtual Private Network (VPN) tunnel to secure the WAN segment.

**Error Correction:**
1. **Apply Kernel Patch:**
   - Update to the highest relevant kernel patch as specified in the "Support Package" section of the note.
2. **Set Instance Profile Parameter:**
   - Configure the parameter `gw/reg_no_conn_info` in the instance profile to activate enhanced security.
   - **Caution:** Setting this parameter may impose restrictions on manageability if programs connect via SAProuter or a proxy server, as machine addresses are now validated against entries in the `reg_info` file.
   - For detailed instructions, refer to [Note 1444282](https://me.sap.com/notes/1444282).

**Patch Levels Required for Kernel Releases 31I-45B:**
- **31I:** SP Patch 784
- **40B:** SP Patch 1073
- **45B:** SP Patch 1004

For information on downloading Kernel Releases 31I-45B, see [Note 52505: Support after end of mainstream/extended maintenance](https://me.sap.com/notes/52505).

**Additional Information:**
- From Kernel Release 710 onwards, enhanced security is active by default.
- Patches include improvements for monitoring in transaction SMGW.
- Dynamic parameter changes can be made using the function module `TH_CHANGE_PARAMETER` if necessary.

**References:**
- [Note 1649912: Update 1 for Security Note 1298433](https://me.sap.com/notes/1649912)
- [Note 1444282: gw/reg_no_conn_info settings](https://me.sap.com/notes/1444282)
- Additional related notes can be found within the SAP Security Note 1298433 documentation.

For more detailed information, download the [SNOTE file](https://notesdownloads.sap.com/note/0040000016716602017) or view the [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001298433?language=en-US&token=B1AD2FCC3FF1CA4C40A1C09C6C9AF08C).

*Credits to [Redrays](https://redrays.io) for support in providing this information.*