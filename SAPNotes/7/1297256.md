1297256 - Security Note: Security Issues in Enterprise Service Builder

---

**Symptom**

1. Several cross site scripting (XSS) vulnerabilities have been discovered in administrative Web interfaces of PI.

2. Some servlets allow bypassing http-only cookie security.

3. Some Exchange Profile parameters are saved as plain text in NWA.

4. Reading and overwriting files using various administrative XI tools is possible.

5. The password is contained in clear text in the HTML source code.

**Other Terms**

cross site scripting, XI, admin pages, DocuBaseServlet, http cookie, Password visible, reading and overwriting files, XI tools, Exchange Profile, etc.

**Reason and Prerequisites**

- **Problem Description:**
  1. XI administrative tools exhibit several possibilities for script injection attacks via URL parameters.
  
  2. The Web interface of the servlet DocuBaseServlet returns a stack trace as well as all HTTP headers including cookie values.
  
  3. In ESR, JEE application parameters can be set in NWA. Some parameters are not saved as desired in NWA.
  
  4. Users having access to some services are able to read any file in the local file system, which is accessible by the SAP system user.
  
  5. Any user having access to the exchange profile settings is able to retrieve the authentication credentials for all defined technical users.

**Solution**

**Why should customers apply the patch?**
This patch fixes the security issues mentioned with ESR, which could cause potential security threats such as XI administrative tools exhibiting several possibilities for script injection attacks via URL parameters.

**Affected Versions:**
- SAP NetWeaver 2004
- SAP NetWeaver 2004S
- SAP NetWeaver PI 7.1
- SAP EHP1 for SAP PI NetWeaver 7.1

**Fixed Versions:**
All affected versions are fixed with the following support package levels:
- NW04 SP23
- NW04S SP18
- SAP NetWeaver 7.0 EHP1 SP02
- SAP NetWeaver PI 7.1 SP7
- SAP EHP1 for SAP NetWeaver PI 7.1 SP1

**How to Apply the Patch:**
You can download the fixed versions from the [Service Marketplace](https://me.sap.com/servicessupport). Navigate to:
1. Downloads
2. SAP Support Package
3. Enter by Application Group
4. SAP NetWeaver
5. Select the desired Release and SCA.

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016714212017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001297256?language=en-US&token=FB6C6B9F1801DCE961AE39D8E24CEAA1)

For more details, refer to the [full SAP Note 1297256](https://me.sap.com/notes/1297256).

---

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*