2444321 - Missing certificate verification in CommonCryptoLib

**Symptom**

The CommonCryptoLib function `SsfVerifyEx` does not always sufficiently check the trust of the provided certificate with the configured PSE. Without the certificate check, the function does not recognize if the data to be verified was signed by an unauthenticated or unauthorized person or system.

**CVSS Information**

- **CVSS v3 Base Score:** 7.0 / 10
- **CVSS v3 Base Vector:**
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** Low (L)

*SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note.*

**Other Terms**

CCL, SSF, VERIFY_XML, SXML, CL_SEC_SXML_DSIGNATURE

**Reason and Prerequisites**

Missing certificate verification in `SsfVerifyEx` due to a programming error in CommonCryptoLib 8. SAP developed applications don't use the vulnerable function. However, for custom-developed functions, it is possible to call CommonCryptoLib directly via the following ABAP functions:
- Function module `SSFW_KRN_VERIFY` of SSFW function group
- Method `VERIFY_XML` of SAP class `CL_SEC_SXML_DSIGNATURE`

The vulnerability exists only if a non-SAP developed function calls one of these ABAP functions. In such cases, an update of CommonCryptoLib is recommended.

**Solution**

To fix the issue, download and install CommonCryptoLib **8.5.10** (or higher). It can be found in SAP software downloads (support packages and patches) by searching for "CommonCryptoLib 8".

This update corrects the `SsfVerifyEx` function in CommonCryptoLib to perform the missing signer certificate check.

**Warning:** Updating CommonCryptoLib will cause verification errors if the affected function is used but the PSE configured for the verification does not contain the required trusted certificate.

**References**

- [Fixes in CommonCryptoLib 8.5.10](https://me.sap.com/notes/2427966)

**Support Package Patches**

- **CommonCryptoLib 8**
  - **Support Package:** SP085
  - **Patch Level:** 008510
  - [Download Patch SP085 - 008510](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200022586&support_package=SP085&patch_level=008510)

For more details, visit the [SAP Support Portal](https://me.sap.com/notes/0002444321).

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*