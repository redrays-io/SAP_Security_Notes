2450979 - SQL Injection vulnerability in SAP CRM WebClient User Interface

---

### Symptom
*Program **CRM_THTMLB_UI_SEARCH** allows an attacker to execute crafted database queries, exposing the backend database.*

Some well-known impacts of SQL Injection vulnerability are:
- Read sensitive data, modify or delete data from the database
- Execute admin-level operations on the database

### CVSS Information
**CVSS v3 Base Score:** 6.3 / 10  
**CVSS v3 Base Vector:**

| Metric                       | Value              |
|------------------------------|--------------------|
| Attack Vector (AV)           | Network (N)        |
| Attack Complexity (AC)       | Low (L)            |
| Privileges Required (PR)     | Low (L)            |
| User Interaction (UI)        | None (N)           |
| Scope (S)                    | Unchanged (U)      |
| Confidentiality Impact (C)   | Low (L)            |
| Integrity Impact (I)         | Low (L)            |
| Availability Impact (A)      | Low (L)            |

*SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://support.sap.com/securitynotes](https://support.sap.com/securitynotes).*

### Other Terms
Injection attack, blind SQL injection, database vulnerabilities

### Reason and Prerequisites
**Reason:** User inputs were not encoded against SQL Injections.

### Solution
User-input search strings are now secured prior to being used for SQL queries.

Please implement the attached [Correction Instructions](https://me.sap.com/corrins/0002450979/6555) or the mentioned [Support Package](https://me.sap.com/supportpackage/SAPK-60022INCRMUIF).

### Support Package
- **CRMUIF 600:** [SAPK-60022INCRMUIF](https://me.sap.com/supportpackage/SAPK-60022INCRMUIF)
- **WEBCUIF 700:** [SAPK-70020INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70020INWEBCUIF)
- **WEBCUIF 701:** [SAPK-70117INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70117INWEBCUIF)
- **WEBCUIF 730:** [SAPK-73012INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73012INWEBCUIF)
- **WEBCUIF 731:** [SAPK-73120INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73120INWEBCUIF)
- **WEBCUIF 746:** [SAPK-74612INWEBCUIF](https://me.sap.com/supportpackage/SAPK-74612INWEBCUIF)
- **WEBCUIF 747:** [SAPK-74715INWEBCUIF](https://me.sap.com/supportpackage/SAPK-74715INWEBCUIF)
- **WEBCUIF 748:** [SAPK-74808INWEBCUIF](https://me.sap.com/supportpackage/SAPK-74808INWEBCUIF)
- **WEBCUIF 800:** [SAPK-80005INWEBCUIF](https://me.sap.com/supportpackage/SAPK-80005INWEBCUIF)
- **WEBCUIF 801:** [SAPK-80103INWEBCUIF](https://me.sap.com/supportpackage/SAPK-80103INWEBCUIF)

### Correction Instructions
- **WEBCUIF:** [Correction Instructions 6555](https://me.sap.com/corrins/0002450979/6555) (5 Instructions)
- **CRMUIF:** [Correction Instructions 4415](https://me.sap.com/corrins/0002450979/4415) (1 Instruction)

### Prerequisites
Ensure the following SAP Notes are applied before implementing this security note:
- **WEBCUIF 700:** [1769421](https://me.sap.com/notes/1769421) - WEBCUIF: minor error in report CRM_THTMLB_UI_SEARCH
- **WEBCUIF 701:** [1769421](https://me.sap.com/notes/1769421) - WEBCUIF: minor error in report CRM_THTMLB_UI_SEARCH
- **WEBCUIF 731:** [1769421](https://me.sap.com/notes/1769421) - WEBCUIF: minor error in report CRM_THTMLB_UI_SEARCH

For more details, visit the [SAP Security Notes](https://me.sap.com/notes/2450979).

---

*Credits to [Redrays](https://redrays.io) for support in providing this information.*