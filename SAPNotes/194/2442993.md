2442993 - Malicious SAP Host Agent Shutdown without Authentication

### Symptom

An attacker can craft a specific SOAP request without authentication that causes a shutdown of the SAP Host Agent.

**CVSS Information**

CVSS v3 Base Score: 7.5 / 10  
CVSS v3 Base Vector:

| Key                                         | Value          |
|---------------------------------------------|----------------|
| AV : Attack Vector (Related exploit range)  | Network (N)    |
| AC : Attack Complexity (Required attack complexity) | Low (L)        |
| PR : Privileges Required (Level of privileges needed to exploit) | None (N)       |
| UI : User Interaction (Required user participation) | None (N)       |
| S : Scope (Change in scope due to impact caused to components beyond the vulnerable component) | Unchanged (U) |
| C : Impact to Confidentiality               | None (N)       |
| I : Impact to Integrity                     | None (N)       |
| A : Impact to Availability                  | High (H)       |

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://support.sap.com/securitynotes](https://support.sap.com/securitynotes).

### Other Terms

Broken authentication, HAN-DB

### Reason and Prerequisites

Affected are all SAP Host Agent versions up to 7.21 PL24.

### Solution

The issue is caused by a program error which is fixed with SAP Host Agent version 7.21 PL25.

Please upgrade SAP Host Agent to at least version 7.21 PL25. Please note, we always recommend to upgrade to the latest available version.

Follow the procedure described in [Note 1031096](https://me.sap.com/notes/1031096).

The SAP Host Agent in SAP HANA has been updated with revision 122.10 (for SAP HANA1.00 SPS12), revision 2.02 (for SAP HANA2.0 SPS00), and revision 12 (for SAP HANA2.0 SPS01). Update to these or later versions.

### References

- **This document refers to**: [1031096 - Installing Package SAPHOSTAGENT](https://me.sap.com/notes/1031096)
  
### Software Components

- **HDB**: From 1.00 To 1.00
- **HDB**: From 2.00 To 2.00
- **SAPHOSTAGENT**: From 7.21 To 7.21+

### Support Package Patches

- **SAP HOST AGENT 7.21 SP025 Patch Level 000000**: [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200018473&support_package=SP025&patch_level=000000)
- **SAP HANA DATABASE 2.0 SP002 Patch Level 000002**: [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200005327&support_package=SP002&patch_level=000002)
- **SAP HANA DATABASE 2.0 SP012 Patch Level 000000**: [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200005327&support_package=SP012&patch_level=000000)
- **SAP HANA DATABASE 1.00 SP122 Patch Level 000010**: [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP122&patch_level=000010)

Credits to [https://redrays.io](https://redrays.io) for support in providing this information.