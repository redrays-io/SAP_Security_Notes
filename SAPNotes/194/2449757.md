2449757 - [CVE-2017-16689] Additional Authentication check in Trusted RFC on same system

**Header Data**
- **SAP Note/KBA:** 2449757
- **Type:** SAP Security Note
- **Version:** 7
- **Recency:** New
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 12.12.2017
- **Component:** Basis Components > Middleware > RFC

**Description**

### Symptom
A Trusted RFC connection can be established to a different client or a different user on the same system, although no explicit Trusted/Trusting Relation to the same system has been defined via transaction SMT1.

**CVSS Information**
- **CVSS v3 Base Score:** 7.6 / 10
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).

### Other Terms
- **S_RFCACL SMT1**
- **CVE:** [CVE-2017-16689](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16689)

### Reason and Prerequisites
Trusted RFC does not require a Trusted/Trusting Relation from the system to itself. A system always trusts itself. The trust relationship maintained in SMT1 is used as a secure way to identify remote trusted systems. For calls on the same system, this is not necessary as the RFC infrastructure always knows that a call came from the same system in a secure way.

Client and user switches with RFC calls can be controlled with appropriate S_RFCACL authorizations in the receiving client. However, especially in scenarios with a central user management, one may want to specify uniform S_RFCACL authorizations for all or many systems and allow or deny local Trusted RFCs via Trusted/Trusting relationships.

### Solution
A new profile parameter is introduced with the kernel patch of this SAP Note:

- **rfc/selftrust** (Possible values: 0 or 1)

  - **Value 1 (Default):** This is the previous behavior before the kernel patch. The system trusts itself without an explicit Trusted/Trusting Relation, and the secure use of Trusted/Trusting in the same system is solely defined via S_RFCACL authorizations.
  
  - **Value 0:** A Trusted RFC connection can only be established to a different client or a different user on the same system if an explicit Trusted/Trusting Relation to the own system is defined via transaction [SMT1](https://me.sap.com/servicessupport/SMT1).

**References**
- This document is referenced by:
  - [3020304 - FAQs: Parameter rfc/selftrust](https://me.sap.com/notes/3020304)

**Support Package Patches**
- **SAP KERNEL 7.49 64-BIT UNICODE**
  - [SP310 Patch 000310](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004760&V=MAINT)
- *(Additional support packages listed in the original note)*

**Side Effects**
- **This document is causing side effects:**
  - [2614667 - Parameter rfc/selftrust is not working](https://me.sap.com/notes/2614667)

*For more details, visit the [SAP Support Portal](https://me.sap.com/).*

*Credits: [redrays.io](https://redrays.io) for supporting the provision of this information.*