3149805 - [CVE-2022-26101] Cross-Site Scripting (XSS) vulnerability in SAP Fiori launchpad

## Overview
**SAP Note Number:** 3149805  
**Type:** SAP Security Note  
**Version:** 14  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** March 22, 2022  
**Component:** CA-FLP-FE-COR (SAP Fiori Launchpad Frontend Core and Services)  

## Description

### Symptom
Due to insufficient input sanitization, the SAP Fiori launchpad allows an unauthenticated attacker to manipulate the `Sap-theme` URL parameter and inject HTML code. If a user clicks on a specially crafted link provided by the attacker, the attacker can:
- Hijack user privileges to exfiltrate data.
- Conduct CSRF attacks to manipulate data.
  
This results in limited confidentiality impact and complete compromise of the application's integrity.

### Other Terms
- **XSS:** Cross-Site Scripting
- **CSS:** Cascading Style Sheets
- **CVE:** [CVE-2022-26101](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26101)

## Impact
- **CVSS Score:** 8.2  
- **CVSS Vector:** `CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:N`

**CVSS Metrics:**
- **Attack Vector (AV):** Network
- **Attack Complexity (AC):** Low
- **Privileges Required (PR):** None
- **User Interaction (UI):** Required
- **Scope (S):** Changed
- **Confidentiality Impact (C):** Low
- **Integrity Impact (I):** High
- **Availability Impact (A):** None

## Solution
The URL parameters are now properly encoded to prevent XSS attacks. SAP recommends installing the solution by applying a Support Package. If an earlier installation is necessary, use the Note Assistant to implement the correction instructions. More information about the Note Assistant can be found on the [Note Assistant](https://me.sap.com/service.sap.com/note-assistant).

For SAP_UI versions 7.53 SP01-04, no correction instructions are required as the issue does not affect these versions. There is no available workaround.

For additional information, refer to [KBA 3157089](https://me.sap.com/notes/3157089).

## References
- [CVE-2022-26101](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26101)
- [KBA 3157089: Cross-Site scripting vulnerability in SAP Fiori launchpad: FAQ](https://me.sap.com/notes/3157089)

## Validity
**Affected Software Components:**
- **SAP_UI:** Versions 753 to 756
- **SAP_BASIS:** Version 787

**Support Packages:**
- [SAP_UI 754 Support Package](https://me.sap.com/supportpackage/SAPK-75409INSAPUI)
- [SAP_UI 755 Support Package](https://me.sap.com/supportpackage/SAPK-75506INSAPUI)
- [SAP_UI 756 Support Package](https://me.sap.com/supportpackage/SAPK-75603INSAPUI)
- [SAP_BASIS 787 Support Package](https://me.sap.com/supportpackage/SAPK-78704INSAPBASIS)

## Credits
Information supported by [RedRays.io](https://redrays.io).