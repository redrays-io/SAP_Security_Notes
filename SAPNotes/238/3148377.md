SAP Security Note 3148377 - CVE-2022-28217 Missing XML Validation Vulnerability in SAP NW EP WPC

## Description

### Symptom
Some part of SAP NetWeaver (EP Web Page Composer) does not sufficiently validate an XML document accepted from an untrusted source, which allows an adversary to exploit unprotected XML parking at endpoints, and a possibility to conduct SSRF attacks that could compromise the systemâ€™s availability by causing the system to crash.

### Other Terms
XXE, XML input parsing, [CVE-2022-28217](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE-2022-28217)

### Reason and Prerequisites
Additional information is not needed in order to exploit this vulnerability.

### Solution
The vulnerability is fixed with modifications in the SAP NW EP WPC. This fix can be applied in the patches listed in the **Support Package Patches** section below.

## CVSS Score

- **Score:** 6.5
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H)

  - **Attack Vector:** Network (N)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** Low (L)
  - **User Interaction:** None (N)
  - **Scope:** Unchanged (U)
  - **Confidentiality Impact:** None (N)
  - **Integrity Impact:** None (N)
  - **Availability Impact:** High (H)

## Affected Versions

- EP Web Page Composer 7.20
- EP Web Page Composer 7.30
- EP Web Page Composer 7.31
- EP Web Page Composer 7.40
- EP Web Page Composer 7.50

## Solution

Apply the following Support Package Patches to resolve the vulnerability:

- **EP WEB PAGE COMPOSER 7.30 SP021 Patch 000001**  
  [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015109&support_package=SP021&patch_level=000001)

- **EP WEB PAGE COMPOSER 7.50 SP022 Patch 000001**  
  [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001468&support_package=SP022&patch_level=000001)

- **EP WEB PAGE COMPOSER 7.50 SP023 Patch 000001**  
  [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001468&support_package=SP023&patch_level=000001)

- **EP WEB PAGE COMPOSER 7.40 SP023 Patch 000001**  
  [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019830&support_package=SP023&patch_level=000001)

- **EP WEB PAGE COMPOSER 7.50 SP024 Patch 000000**  
  [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001468&support_package=SP024&patch_level=000000)

- **EP WEB PAGE COMPOSER 7.31 SP028 Patch 000001**  
  [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017819&support_package=SP028&patch_level=000001)

## Additional Resources

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000479412022)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003148377?language=en-US&token=6C1CB26D4093F511309C70A45584AAEC)
- [Share by Email](https://me.sap.com/notes/0003148377/share)
- [Open in New Window](https://me.sap.com/notes/0003148377)

## References

This document is referenced by:

- [3144513 - Central Note: SAP NetWeaver 7.5 SP24 - Enterprise Portal](https://me.sap.com/notes/3144513)

## Credits

Thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.