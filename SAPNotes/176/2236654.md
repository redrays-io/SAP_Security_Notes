SAP Security Note 2236654 - XXE Vulnerability in CRM-MKT-MPL-CA

**Symptom**

A malicious user can modify an XML-based request to include XML content that is then parsed locally. This could allow a malicious user to perform a denial of service (DoS) on the parsing system, disclose local data in the response, or access further network-located resources from the parsing system.

**Other Terms**

- XXE (XML External Entity)
- Information Disclosure
- Denial of Service (DoS)

**Reason and Prerequisites**

The issue is caused by a program error in CRM-MKT-MPL-CA due to incorrect use of an XML parser. By default, the parser opens external entities referenced within XML input, allowing malicious content to be parsed. This can lead to the disclosure of internal resources or a DoS attack.

**Solution**

This SAP Note contains the JAR file with the latest version of the Campaign Automation Java applet. Follow the manual instructions below to implement the solution.

**Manual Correction Steps**

1. **Download the Attached File**
   - Download the `sapca.jar` file to your local system: [sapca.jar](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900001880332015&iv_version=0002&iv_guid=559BDCF42F64A3409630EAB243AE4157)

2. **Access BSP Application**
   - Open transaction SE80 in your SAP system.
   - Choose 'BSP Application' from the dropdown list and open BSP Application `CRM_UIU_CA2`.

3. **Upload the JAR File**
   - Expand the 'MIMEs' folder.
   - Right-click on the file `sapca.jar` and select 'Upload/Download' → 'Upload and Replace'.
   - In the file chooser dialog, select the downloaded `sapca.jar` file and upload it to the system.

**Support Package**

Apply the relevant support package for your software component version:

- **BBPCRM 600**: [SAPKU60017](https://me.sap.com/supportpackage/SAPKU60017)
- **BBPCRM 700**: [SAPKU70018](https://me.sap.com/supportpackage/SAPKU70018)
- **BBPCRM 701**: [SAPKU70115](https://me.sap.com/supportpackage/SAPKU70115)
- **BBPCRM 702**: [SAPKU70217](https://me.sap.com/supportpackage/SAPKU70217)
- **BBPCRM 712**: [SAPKU71210](https://me.sap.com/supportpackage/SAPKU71210)
- **BBPCRM 713**: [SAPKU71311](https://me.sap.com/supportpackage/SAPKU71311)

**Attachments**

- [sapca.jar](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900001880332015&iv_version=0002&iv_guid=559BDCF42F64A3409630EAB243AE4157) (1.865 MB)

**Translations**

Available machine translations:

- [Deutsch](https://me.sap.com/notes/0002236654/D)
- [日本語](https://me.sap.com/notes/0002236654/J)
- [Português](https://me.sap.com/notes/0002236654/P)
- [Español](https://me.sap.com/notes/0002236654/S)
- [Français](https://me.sap.com/notes/0002236654/F)
- [Italiano](https://me.sap.com/notes/0002236654/I)
- [Русский](https://me.sap.com/notes/0002236654/R)
- [中文](https://me.sap.com/notes/0002236654/1)
- [한국어](https://me.sap.com/notes/0002236654/3)

**Credits**

Credits to [RedRays](https://redrays.io) for support to provided information.