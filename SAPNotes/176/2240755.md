2240755 - Missing authorization check in SAP ASE

**Symptom**

An authenticated user can use functions of SAP ASE XPServer to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**

- **CVSS Base Score:** 6.0 / 10
- **Attack Vector (AV):** Network (N)
- **Access Complexity (AC):** Medium (M)
- **Authentication (Au):** Single (S)
- **Impact to Confidentiality (C):** Partial (P)
- **Impact to Integrity (I):** Partial (P)
- **Impact to Availability (A):** Partial (P)

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://support.sap.com/securitynotes](https://support.sap.com/securitynotes).

**Reason and Prerequisites**

SAP ASE does not contain authorization checks for verifying an authenticated user's authorization to access some of the XPServer functions. This may result in some authenticated users obtaining access to execute arbitrary commands on the SAP ASE host machine.

**Solution**

This issue has been fixed in the following ASE versions:

- SAP ASE 15.7 SP136
- SAP ASE Cluster Edition 15.7 SP136
- SAP ASE 16.0 SP02 PL01 HF1

Install the fixed SAP ASE versions most appropriate for your production environments.

Alternatively, you can mitigate the vulnerability by disabling XPServer using the commands below:

1. Log in as 'sa' and execute the following commands. Replace `<sa_password>` with the password for the 'sa' login and `<SERVERNAME>` with your ASE server name.

    ```sh
    isql -Usa -P<sa_password> -S <SERVERNAME>
    1> shutdown <SERVERNAME>_XP
    2> go
    1> sp_dropserver <SERVERNAME>_XP
    2> go
    ```

**Note:** As normal practice, all releases subsequent to the published fixed releases will inherit the fixes described in this security note.

For more details, refer to the [full SAP Security Note 2240755](https://me.sap.com/notes/2240755).

*Credits to [https://redrays.io](https://redrays.io) for supporting the provided information.*