2241978 - Log injection and missing size restriction in SAP HANA Extended Application Services Classic (XS)

**Symptom**

A potential attacker can perform malicious calls to the debug functions of the SAP HANA Extended Application Services Classic (XS).

**CVSS Information**

- **CVSS Base Score:** 5.0 / 10
- **CVSS Base Vector:**
  | Key                          | Value       |
  |------------------------------|-------------|
  | AV : Access Vector           | Network (N) |
  | AC : Access Complexity       | Low (L)     |
  | Au : Authentication          | None (N)    |
  | C : Confidentiality Impact   | None (N)    |
  | I : Integrity Impact         | Partial (P) |
  | A : Availability Impact      | None (N)    |

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://me.sap.com/support/securitynotes).*

**Other Terms**

log injection, SAP HANA, trace, XS classic model

**Reason and Prerequisites**

An unauthenticated attacker might be able to create specially crafted HTTP requests to the SAP HANA Extended Application Services Classic debug function. This can lead to forged additional entries in the trace files of the XS process and consume disk space of the HANA system. Additionally, specially crafted HTTP requests can consume available memory buffers and lead to a crash of the XS process, which will be restarted automatically by the SAP HANA system. Existing data cannot be changed or read by this vulnerability.

**Solution**

- **Update:** The debug function has been improved with SAP HANA revision 102.02 for SPS10 or later. Update to this or a later version. SPS 11 is not affected.

- **Workaround:** 
  - Use the internal HANA Web Dispatcher to block debugger requests by adding the following parameter in the `webdispatcher.ini` configuration section `[profile]`:
    ```
    icm/HTTP/auth_1 = PREFIX=/sap/hana/xs/debugger, PERMFILE=/dev/null
    ```
  - Alternatively, block access to the URLs `/sap/hana/xs/debugger/*` at the network layer (e.g., with a firewall or reverse proxy).

*Please note that applying the workaround will disable debugging of SAP HANA Extended Application Services (XS), including XS debugging via SAP HANA Studio.*

**Download and Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018205752017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002241978?language=en-US&token=4AB29EFB9F13CEBD5DA3E2B8662C3F5E)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002241978)

**Translations Available**

Available in multiple languages:
- [Deutsch](https://me.sap.com/notes/0002241978/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002241978/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002241978/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002241978/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002241978/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002241978/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002241978/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002241978/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002241978/3)

*For more details, visit the [SAP Security Notes](https://me.sap.com/support/securitynotes).*

*Credits to [redrays.io](https://redrays.io) for supporting the information.*