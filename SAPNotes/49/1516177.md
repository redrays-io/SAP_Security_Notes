1516177 - XSRFJava:Adopt API-PSI Utility Customer E-Services

**Symptom**

A malicious user can trigger functionality in SAP_UCES without authentication and authorization.

**Other Terms**

Cross-Site Request Forgery, XSRF, SAP_UCES, UCES, Utility Customer E-Services, FSCM_BD, BD, BillerDirect

**Reason and Prerequisites**

SAP_UCES executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a specific URL and parameters, the function is executed with the user's rights. Additionally, attackers may use Cross Site Scripting (XSS) to trigger the exploit or present a clickable link to the victim.

**Solution**

Please refer to [SAP Note 1509214](https://me.sap.com/notes/1509214). All instructions provided in that note for FSCM_BD also apply to SAP_UCES. Specifically, replace "bd" with "bdisu" for SAP_UCES and ensure that changes to JSP files in the `isuExtensions` folder are implemented.

**Affected Software Components**

- SAP-UCES 1.0
- SAP-UCES 6.0
- SAP-UCES 6.02
- SAP-UCES 6.04
- SAP-UCES 6.05

**References**

- [SAP Note 1597549 - Unauthorized modification of displayed content in FSCM_BD](https://me.sap.com/notes/1597549)
- [SAP Note 1509214 - Unauthorized usage of application functionality in FSCM_BD](https://me.sap.com/notes/1509214)
- [SAP Note 1450166 - Unauthorized usage of application functionality](https://me.sap.com/notes/1450166)

**Download for SNOTE**

[Download SAP Note 1516177](https://notesdownloads.sap.com/note/0040000017107802017)

**PDF Version**

[Print SAP Note 1516177](https://me.sap.com/sap/support/sfm/notes/print/0001516177?language=en-US&token=76703BCFDA87C99A1E1554B740D9A2BF)

**Available Languages**

- [Japanese](https://me.sap.com/notes/0001516177/J)
- [Deutsch](https://me.sap.com/notes/0001516177/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0001516177/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001516177/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001516177/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001516177/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001516177/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001516177/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001516177/3)

**Credit**

Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.