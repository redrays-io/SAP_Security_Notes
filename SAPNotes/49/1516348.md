1516348 - XSRF Vulnerability in Digital Asset Management

## SAP Note Details

- **SAP Note/KBA Number:** 1516348
- **Type:** SAP Security Note
- **Version:** 8
- **Recency:** Updated
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 23.03.2012
- **Component:** Customer Relationship Management > Marketing > Digital Asset Management (CRM-MKT-DAM)
- **Supported Releases:** CRM 5.0, 5.2, 6.0 (CRM2007), 7.0, 7.01

## Description

A Cross-Site Request Forgery (XSRF) vulnerability has been identified in the Digital Asset Management BSP applications. A malicious user can exploit this vulnerability to trigger specific functionalities without proper authentication and authorization. This can be achieved by tricking an authenticated user's browser into making unintended requests, potentially leading to unauthorized actions being performed with the user's privileges.

**Affected BSP Applications:**
- CRM_DAM_APPLOG
- CRM_DAM_AQ
- CRM_DAM_AT_ADM
- CRM_DAM_CONFIRM
- CRM_DAM_FR_AQ
- CRM_DAM_IR_AQ
- CRM_DAM_LINK_BO
- CRM_DAM_LI_ADM
- CRM_DAM_LI_AQ
- CRM_DAM_MT_ADM
- CRM_DAM_PRD_AQ
- CRM_DAM_SNGL_UL
- CRM_DAM_TAX_ADM
- CRM_DAM_VAL_HLP

## Solution

### Prerequisites

1. **Refer to SAP Note 1520324** for additional information and instructions. The corrections from this note must be implemented before applying SAP Note 1516348.

### Implementation Steps

#### For CRM Releases 5.0, 5.2, 6.0 (CRM2007), and 7.0:

1. **Implement Correction Instructions:**
   - This will create the report `BSP_XSRF_PARAM_CRM_DAM_BSP` in your system.
   
2. **Execute the Report:**
   - Run `BSP_XSRF_PARAM_CRM_DAM_BSP` and provide a transport request number when prompted.
   - This will populate the `BSPTEMPXSRFSTORE` database table with the necessary entries for the affected BSP applications.

#### For CRM Release 7.01:

1. **Manual Post-Implementation:**
   - After implementing the correction instructions, manually activate the XSRF Protection checkbox within the following BSP Applications:
     - CRM_DAM_APPLOG
     - CRM_DAM_AQ
     - CRM_DAM_AT_ADM
     - CRM_DAM_CONFIRM
     - CRM_DAM_FR_AQ
     - CRM_DAM_IR_AQ
     - CRM_DAM_LINK_BO
     - CRM_DAM_LI_ADM
     - CRM_DAM_LI_AQ
     - CRM_DAM_MT_ADM
     - CRM_DAM_PRD_AQ
     - CRM_DAM_SNGL_UL
     - CRM_DAM_TAX_ADM
     - CRM_DAM_VAL_HLP

   - The XSRF Protection checkbox can be found within the Properties tab of each BSP application.

**Caution:** These manual steps must be performed separately in each system after importing the Note.

## Additional Information

- **Attachments:**
  - [ZBSP_XSRF_PARAM_CRM_DAM_BSP.txt](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000450512010&iv_version=0008&iv_guid=64AD3712F304D14CA2F25E95C2E9450F)

- **References:**
  - [SAP Note 1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)

- **Support Packages:**
  - CRM 500: [SAPKU50018](https://me.sap.com/supportpackage/SAPKU50018)
  - CRM 520: [SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011)
  - CRM 600: [SAPKU60009](https://me.sap.com/supportpackage/SAPKU60009)
  - CRM 700: [SAPKU70009](https://me.sap.com/supportpackage/SAPKU70009)
  - CRM 701: [SAPKU70104](https://me.sap.com/supportpackage/SAPKU70104), [SAPKU70103](https://me.sap.com/supportpackage/SAPKU70103)

## Download and Print

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008989842017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001516348?language=en-US&token=0DAD3A3AC2104205ED21AFB939C53440)

## Credits

Information provided with support from [redrays.io](https://redrays.io).