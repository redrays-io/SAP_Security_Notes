1665973 - Unauthorized modification of displayed content in SRM-EBP-WFL

**SAP Note 1665973 - Unauthorized Modification of Displayed Content in SRM-EBP-WFL**

**Type:** SAP Security Note  
**Version:** 4  
**Status:** Released for Customer  
**Released On:** 08.05.2012  
**Component:** Supplier Relationship Management > SRM > Workflow (SRM-EBP-WFL)  
**Priority:** Correction with High Priority  
**Language:** English  
**Recency:** New  

### Symptom
The SRM component SRM-EBP-WFL includes the internet ITS service BBPWI, which must be secured against Cross-Site Scripting (XSS) attacks. The existing and new dynpro variables used by the service need to be HTML encoded to prevent unauthorized modification of displayed content.

### Reason and Prerequisites
The ITS Service BBPWI for the SRM-EBP-WFL component does not sufficiently encode output parameters, leading to a vulnerability that allows for XSS attacks. An attacker exploiting this vulnerability can steal user authentication information, potentially impersonating users and compromising the security of the application, including administrative accounts.

### Solution
**For SRM_SERVER 550:**
1. Implement the relevant support package or follow the correction instructions.
2. Execute the report `SRM_ITS_XSS_PARAM` to add the new SICF-GUI parameters that control encoding behavior for the Internet Services mentioned in the note.

**For SRM_SERVER 500:**
1. Implement the relevant support package or follow the correction instructions.
2. Set the ITS parameters `~AUTO_HTML_ESCAPING = 1` and `~NEW_XSS_FUNCTIONS = 1` to enable encoding.

**Note:** The protections offered by this note require the implementation of SAP Notes [1621946](https://me.sap.com/notes/1621946) and [1488500](https://me.sap.com/notes/1488500).

### Download Links
- [Download for SNOTE](https://me.sap.com/note/0040000009892742017)
- [PDF Version](https://me.sap.com/support/sfm/notes/print/0001665973?language=en-US&token=9BF4377A65650A4FE922D003AD94E302)

### References
- [SAP Note 1621946 - ITS: Updated XSS-Escaping Functions](https://me.sap.com/notes/1621946)
- [SAP Note 1488500 - ITS: Automatically Escape Context Fields in Output](https://me.sap.com/notes/1488500)

### Support Packages
- **SRM_SERVER 500:** [SAPKIBKS18](https://me.sap.com/supportpackage/SAPKIBKS18)
- **SRM_SERVER 550:** [SAPKIBKT21](https://me.sap.com/supportpackage/SAPKIBKT21), [SAPKIBKT20](https://me.sap.com/supportpackage/SAPKIBKT20)

### Correction Instructions
- **Software Component:** SRM_SERVER  
  **Number of Correction Instructions:** 3  
  [View Correction Instructions](https://me.sap.com/corrins/0001665973/551)

### Manual Activities
Upon installation of this note, the report `SRM_ITS_XSS_PARAM` is created. Please run this report to add the new SICF-GUI parameters that control encoding behavior for the Internet Services specified in the note.

### CVSS
- **CVSS Score:** 0
- **CVSS Vector:** Not Provided

### Validity
- **Software Component:** SRM_SERVER  
  **From:** 500  
  **To:** 500  
- **Software Component:** SRM_SERVER  
  **From:** 550  
  **To:** 550  

### Available Languages
- Japanese
- Deutsch
- Português (Machine Translation)
- Español (Machine Translation)
- Français (Machine Translation)
- Italiano (Machine Translation)
- Русский (Machine Translation)
- 中文 (Machine Translation)
- 한국어 (Machine Translation)

---

*Credits to [RedRays](https://redrays.io) for supporting the information provided.*