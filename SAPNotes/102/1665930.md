1665930 - Unauthorized modification of displayed content in FIN-BA

## Overview

**SAP Note Number:** 1665930  
**Type:** SAP Security Note  
**Version:** 4  
**Released On:** May 21, 2013  
**Component:** Business Analytics (FIN-BA)  
**Priority:** Correction with high priority  
**Status:** Released for Customer

## Description

### Symptom
FIN-BA can be exploited by an attacker to modify displayed application content without authorization. This vulnerability may allow the attacker to obtain authentication information from other legitimate users.

### Affected Components
- **Software Component:** SEM-BW
- **Versions Affected:** 400, 600, 602, 603, 604, 605, 634, 700, 736, 747

### Reason
The `UAB_COST_ENGINE` BSP application does not sufficiently encode input parameters, leading to a reflected cross-site scripting (XSS) vulnerability. An attacker can exploit this to deface or modify website content temporarily or steal user authentication information, potentially compromising the entire application's security if administrative credentials are obtained.

## Solution

### Apply Correction
Implement the attached correction or apply the corresponding support package relevant to your system's version. You can download the correction for SNOTE [here](https://notesdownloads.sap.com/note/0040000009892522017) or view the PDF version [here](https://me.sap.com/sap/support/sfm/notes/print/0001665930?language=en-US&token=6B1D1672A1AE7A603C938BD2387240F0).

### Manual Activities
1. **Delete the `UAB_COST_ENGINE` Service:**
   - Open transaction `SICF`.
   - Locate the service `UAB_COST_ENGINE`.
   - Delete the service via the context menu.

2. **Enable XSRF Protection:**
   - Navigate to the `UAB_COST_ENGINE` BSP application using transaction `SE80`.
   - In the Properties tab, set 'XSRF Protection' to 'X'.
   - Activate and save the changes.

## Support Package Information

Ensure that you apply the correct support package for your systemâ€™s version:
- **SEM-BW 400:** [SAPKGS4029](https://me.sap.com/supportpackage/SAPKGS4029)
- **SEM-BW 600:** [SAPKGS6021](https://me.sap.com/supportpackage/SAPKGS6021)
- ... *(additional support packages as listed in the original note)*

## References

- [Update 1 to Security Note 1665930](https://me.sap.com/notes/1864086)

## Additional Information

- **Attachments:** [XSSlibraryAdaptation.pdf](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000640082011&iv_version=0004&iv_guid=45C5F71C1C5F4A47AB964F1E4263DAB8)

For more details, visit the official SAP support portal: [https://me.sap.com/](https://me.sap.com/)

*Credits to [RedRays](https://redrays.io) for support in providing this information.*