1664632 - Unauthorized modification of ITS in QM

**SAP Security Note 1664632 - Unauthorized modification of ITS in QM**

### **Header Data**
- **SAP Note/KBA:** 1664632
- **Type:** SAP Security Note
- **Version:** 1
- **Recency:** New
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 08.05.2012
- **Component:** Quality Management (QM)

### **Description**
**Symptom**

The Application Component QM is vulnerable to abuse by malicious users, allowing unauthorized modification of displayed application content and potential access to authentication information from other legitimate users.

**Other Terms**

Cross-site scripting, XSS, QM

**Reason and Prerequisites**

ITS Services (including QISR, QISRW, TS_TS20000780H, QMW1, QC40, QC40A, QC42, QEW01) within the Application Component QM do not sufficiently encode OUTPUT parameters. This results in a cross-site scripting (XSS) vulnerability.

Cross-site scripting can be exploited to steal another user's authentication information, such as session data. A malicious user with access to this data may impersonate the user and access information with the same privileges as the target user. If an administrator is impersonated, the security of the entire application may be compromised.

### **Solution**
Apply this SAP Note or import the changes via the relevant support package. 
**Important:** The corrections in this note only provide protection if the corrections in SAP Notes [1621946](https://me.sap.com/notes/1621946) and [1488500](https://me.sap.com/notes/1488500) are also implemented.

### **Support Packages**
Ensure you apply the relevant support packages for your software component versions:
- **SAP_APPL 500:** [SAPKH50027](https://me.sap.com/supportpackage/SAPKH50027)
- **SAP_APPL 600:** [SAPKH60022](https://me.sap.com/supportpackage/SAPKH60022)
- **SAP_APPL 602:** [SAPKH60212](https://me.sap.com/supportpackage/SAPKH60212)
- **SAP_APPL 603:** [SAPKH60311](https://me.sap.com/supportpackage/SAPKH60311)
- **SAP_APPL 604:** [SAPKH60412](https://me.sap.com/supportpackage/SAPKH60412)
- **SAP_APPL 605:** [SAPKH60508](https://me.sap.com/supportpackage/SAPKH60508)
- **SAP_APPL 606:** [SAPKH60603](https://me.sap.com/supportpackage/SAPKH60603)

### **Correction Instructions**
Execute the report `ITS_XSS_PARAM_QM` and specify a corresponding transport request number when prompted. This report will add service parameters for the adapted ITS services, which can be maintained via the GUI configuration pushbutton for a service within transaction SICF.

### **References**
- [SAP Note 1621946 - ITS: updated XSS-escaping functions](https://me.sap.com/notes/1621946)
- [SAP Note 1488500 - ITS: automatically escape context fields in output](https://me.sap.com/notes/1488500)

### **Downloads**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009884812017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001664632?language=en-US&token=02714974E46282BA9187721577CAA8F9)

---

*Credits to [RedRays.io](https://redrays.io) for support and information.*