SAP Security Note 2342473 - Directory Traversal Vulnerability in Profile Maintenance

### Symptom

*The Profile Maintenance Function Modules* allow an attacker to exploit insufficient validation of path information provided by users, thus characters representing ‘traverse to parent directory’ are passed through to the file access APIs.

Some well-known impacts of Directory Traversal vulnerability are:

- Attacker could read content of arbitrary files on the remote server and expose sensitive data
- Attacker could overwrite, delete, or corrupt arbitrary files on the remote server

### Other Terms

Path traversal, directory climbing

### Reason and Prerequisites

*The profile maintenance function modules did not properly check the passed filename argument.*

### Solution

*The function modules now check that only files are accessed which are located in the directory specified with the profile parameter DIR_PROFILE.*

*Install the latest Support Package containing the fix or implement the attached correction instruction.*

- **Note 1 for NetWeaver 7.00, 7.01, 7.10, and 711:** There is no separate correction instruction due to complex dependencies. So the mentioned Support Package shall be applied.
- **Note 2 for NetWeaver 7.00, 7.01, 7.10, and 7.11:** If you use Kernel 7.20 with patch level smaller than 43 (instead of the DCK), you have to install a kernel with a newer version. Otherwise, the correction will have no effect.

### Affected Components

- **Component:** Basis Components > Computer Center Management System (CCMS) > Configuration > Profile Maintenance
- **Software Components:**
  - SAP_BASIS 700 to 752
  - SAP_BASIS 710 to 751

### References

- [This document refers to SAP Note 2347825](https://me.sap.com/notes/2347825) - DP: Downport of class CL_PATH_CHECKER
- [This document is referenced by SAP Note 2157878](https://me.sap.com/notes/2157878) - Cannot import profile via RZ10
- [This document is referenced by SAP Note 2408109](https://me.sap.com/notes/2408109) - RZ10: Profile import not possible

### CVSS

- **CVSS Score:** 0
- **CVSS Vector:** Not Available

### Support Packages

Ensure you apply the relevant Support Package for your SAP_BASIS version:

- [SAPKB70034](https://me.sap.com/supportpackage/SAPKB70034) for SAP_BASIS 700
- [SAPKB71022](https://me.sap.com/supportpackage/SAPKB71022) for SAP_BASIS 710
- [SAPKB71117](https://me.sap.com/supportpackage/SAPKB71117) for SAP_BASIS 711
- [SAPKB70119](https://me.sap.com/supportpackage/SAPKB70119) for SAP_BASIS 701
- ... *(and others as listed in the SupportPackage section of the note)*

### Correction Instructions

- **Number of Correction Instructions:** 6
- [View Correction Instructions](https://me.sap.com/corrins/0002342473/41)

### Manual Activities

```
------------------------------------------------------------------------
|Manual Activity                                                 |
------------------------------------------------------------------------
|VALID FOR                                                    SAP_BASIS|
| Release 700          From SAPKB70034                         |
| Release 710          From SAPKB71022                         |
| Release 711          From SAPKB71117                         |
| Release 701          From SAPKB70119                         |
------------------------------------------------------------------------

**Caution:** You have to perform this manual activity separately in each system into which you transport the Note for implementation.

If you are using a kernel with release 720, and a patch level smaller than 43, you have to install a kernel with a newer version. Otherwise, the correction will have no effect.
```

### Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000013839412017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002342473?language=en-US&token=5A8ADFF8C863EE925EB2327EAFD21970)

Credits to [https://redrays.io](https://redrays.io) for support to provided information.