SAP Security Note 2351486 - Information disclosure in SAP HANA cockpit for offline administration

---

**SAP Security Note 2351486** - *Information disclosure in SAP HANA cockpit for offline administration*

**Type:** SAP Security Note  
**Version:** 4  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 13.12.2016  
**Component:** SAP HANA Cockpit (HAN-CPT)  
**Category:** Program error  
**Language:** English  

### Symptom

A remotely authenticated attacker using the SAP HANA cockpit for offline administration can read files from the server file system with `<sid>adm` credentials.

**CVSS Information**  
- **Base Score:** 4.9 / 10  
- **Vector:**  
  - **Attack Vector (AV):** Network (N)  
  - **Attack Complexity (AC):** Low (L)  
  - **Privileges Required (PR):** High (H)  
  - **User Interaction (UI):** None (N)  
  - **Scope (S):** Unchanged (U)  
  - **Confidentiality Impact (C):** High (H)  
  - **Integrity Impact (I):** None (N)  
  - **Availability Impact (A):** None (N)  

### Reason and Prerequisites

The SAP HANA cockpit for offline administration allows access to selected administrative functions of the SAP HANA system. A prerequisite for access is knowing the username and password of the operating system user of the SAP HANA system (`<sid>adm` user).

A specially crafted request can allow a user/attacker to display the content of other files on the server.

### Solution

The trace viewer function of the SAP HANA cockpit for offline administration has been limited to files in the trace folders. Other files are no longer displayed. 

Additionally, some error messages have been improved to contain only relevant information.

These improvements are included in:
- **SAP HANA Revision 112.06 (for SPS11)**
- **SAP HANA Revision 122.02 (for SPS12)**

**Update to these or later revisions.**

**Additional Recommendations:**
- The `<sid>adm` user is a highly privileged account with access to all server-local resources. Ensure that only administrators know these credentials.
- Restrict access to the SAP HANA cockpit for offline administration to trusted administrators only.

### Affected Components

- **Software Component:** HDB  
  **From:** 1.00  
  **To:** 1.00

### Support Package Patches

- **SAP HANA DATABASE 1.00**  
  - **SP122 Patch Level 000002:** [https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP122&patch_level=000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP122&patch_level=000002)  
  - **SP112 Patch Level 000006:** [https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP112&patch_level=000006](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP112&patch_level=000006)

### References

_No references listed._

---

For more details, visit the [SAP Security Notes](https://me.sap.com/sap/support/sfm/notes/0002351486?language=en-US&token=7B199B6D08D76E6BCD4010F8FA9F6218).

Credits: [Redrays.io](https://redrays.io) for support to provided information.