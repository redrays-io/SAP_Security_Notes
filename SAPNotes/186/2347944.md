2347944 - Information disclosure in the CCMS agent of SAP HANA

**Symptom**

SAP HANA installs the SAP Host Agent, containing the SAP CCMS (Computer Center Management System) agent component. This agent enables central system monitoring. The CCMS web method `GetAgentConfig` is used in CCMS central monitoring to test the configuration of CCMS agents running on a monitored system.

A remote unauthenticated attacker can find out the host name and the version of the CCMS agent. Note that no data of (or about) the SAP HANA database or any other HANA components is disclosed.

**CVSS Information**

- **CVSS v3 Base Score:** 5.3 / 10
- **CVSS v3 Base Vector:**
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** None (N)

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://support.sap.com/securitynotes](https://support.sap.com/securitynotes).

**Reason and Prerequisites**

Potential attackers need network access to port 1128 of the SAP HANA system to contact the CCMS agent.

**Solution**

SAP Host Agent 7.21 patch level 16 introduces authentication for the method `GetAgentConfig`. The SAP Host Agent of the SAP HANA system can be updated independently of the other system components. Update to patch level 16 or higher of SAP Host Agent 7.21.

SAP HANA revision 112.05 (for SPS11) and SAP HANA revision 122 (for SPS12) contain this SAP Host Agent version by default.

Find more information about the improvement in SAP Note [2306739](https://me.sap.com/notes/2306739).

**References**

- [Optimization of authorization concept of SAPCCMS web method GetAgentConfig](https://me.sap.com/notes/2306739)

**Support Package Patches**

- **SAP HANA DATABASE 1.00 SP122 Patch Level 000000:** [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP122&patch_level=000000)
- **SAP HANA DATABASE 1.00 SP112 Patch Level 000005:** [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP112&patch_level=000005)

For more details and to access the full SAP security note, visit [https://me.sap.com/notes/2347944](https://me.sap.com/notes/2347944).

*Supported by [RedRays.io](https://redrays.io) for providing the information.*