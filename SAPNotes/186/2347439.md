2347439 - Missing XML Validation vulnerability in SAP Netweaver Visual Composer

---

**SAP Security Note 2347439: Missing XML Validation Vulnerability in SAP Netweaver Visual Composer**

**Details:**
- **Type:** SAP Security Note
- **Version:** 8
- **Recency:** New
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** January 10, 2017
- **Component:** Enterprise Portal > Visual Composer
- **Title:** Missing XML Validation vulnerability in SAP Netweaver Visual Composer

**Description:**
A malicious user can modify an XML-based request to include XML content that is then parsed locally. This could allow a malicious user to perform a denial of service (DoS) on the parsing system, disclose local data returned in the response to the malicious request, or access further network-located resources accessible from the parsing system.

Visual Composer flex.broker does not sufficiently validate an XML document accepted from an untrusted source.

**Impacts include:**
- Arbitrary file retrieval from the server
- Denial-of-service conditions in successful exploits

**CVSS Information:**
- **CVSS v3 Base Score:** 6.4 / 10
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** High (H)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** High (H)

**Reason and Prerequisites:**
- **Reason:** The issue is caused by a program error in flex.broker due to incorrect use of an XML parser. By default, the parser opens external entities referenced within an XML input, which can lead to malicious content being parsed. These internal resources can be disclosed in the response to the request or used to perform a denial of service attack on the parsing system, rendering application content temporarily unavailable.
- **Prerequisites:** Running Visual Composer iViews created in 04s versions.

**Solution:**
This issue was resolved by adding a set of features to the DocumentBuildFactory object to prevent malicious code parsing.

Under the "SP Patchlevel" tab within this note, you can check for the appropriate SP Patchlevel fixing this issue.

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018373122017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002347439?language=en-US&token=101534798C9EC8458519650501C52CD0)

**Support Package Patches:**
- **VISUAL COMPOSER 7.0 RT 7.40**
  - [SP013 Patch Level 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019805&support_package=SP013&patch_level=000003)
  - [SP014 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019805&support_package=SP014&patch_level=000002)
  - [SP015 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019805&support_package=SP015&patch_level=000000)
- **VISUAL COMPOSER 7.0 RT 7.30**
  - [SP016 Patch Level 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015959&support_package=SP016&patch_level=000001)
  - [SP017 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015959&support_package=SP017&patch_level=000000)
- **VISUAL COMPOSER FRAMEWORK 7.01**
  - [SP018 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200007194&support_package=SP018&patch_level=000002)
- **VISUAL COMPOSER 7.0 RT 7.31**
  - [SP018 Patch Level 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017826&support_package=SP018&patch_level=000003)
  - [SP019 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017826&support_package=SP019&patch_level=000002)
  - [SP020 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017826&support_package=SP020&patch_level=000000)
- **VISUAL COMPOSER FRAMEWORK 7.00**
  - [SP033 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200008402&support_package=SP033&patch_level=000002)
  - [SP034 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200008402&support_package=SP034&patch_level=000000)

**References:**
This document is referenced by:
- [2332246 - Collective Note: SAP NetWeaver 7.30 SP17 - Enterprise Portal](https://me.sap.com/notes/2332246)
- [2463671 - Central Note for NetWeaver 7.31 SP20 Enterprise Portal](https://me.sap.com/notes/2463671)

**Credits:**  
Credits to [redrays.io](https://redrays.io) for support in providing the information.