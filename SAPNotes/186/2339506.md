SAP Security Note 2339506 - Whitelist based Clickjacking Framing Protection in Utility Customer E-Services

```markdown
## Overview

**SAP Note:** 2339506  
**Title:** Whitelist based Clickjacking Framing Protection in Utility Customer E-Services  
**Type:** SAP Security Note  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 12.07.2016  
**Component:** Industry-Specific Components > Utilities > Customer Service > Internet Self Services

## Symptom

Utility Customer E-Services running on JSP technology is not protected against Clickjacking attacks.

## Other Terms

UI redressing attack, Clickjacking, Framing Protection, Framing, IFrame, UI redressing, Clickjacking Whitelist, X-FRAME-OPTIONS, AS JAVA, JSP, Biller Direct, UCES

## Reason and Prerequisites

Clickjacking is an UI-redressing attack where an attacker tricks a user into clicking on something different than what the user perceives. This attack exploits standard HTML functionalities without relying on application code vulnerabilities.

For more details, refer to [OWASP Clickjacking](https://www.owasp.org/index.php/Clickjacking).

**Prerequisites:**
1. [SAP Note 2170590](https://me.sap.com/notes/2170590) - Enable and configure ClickJacking solution in SAP NetWeaver Java Server.
2. [SAP Note 2263656](https://me.sap.com/notes/2263656) - Enable the ClickJacking protection in HTMLB Java.

## Solution

Standard protection measures against Clickjacking (X-FRAME-OPTIONS header) are not suitable for common NetWeaver integration scenarios. Therefore, SAP provides a whitelist-based framework for NetWeaver technologies. This framework and its implementation are detailed in [SAP Note 2319727](https://me.sap.com/notes/2319727).

This SAP Note offers the solution for Utility Customer E-Services (UCES).

**Manual Steps to Activate Clickjacking Protection:**

1. **Open XCM:**
   Navigate to `http(s)://your_server:your_server_port/bdisu/admin/xcm/init.do`

2. **Navigate to Security Settings:**
   Follow the path:
   ```
   General Application Settings → Customer → Application_security → application_security_config
   ```

3. **Configure Clickjacking Settings:**
   - **clickjacking.active**  
     The main switch to activate or deactivate clickjacking protection.
   
   - **clickjacking.whiteList**  
     A comma-separated list of hosts for a whitelist. The value `$AUTO` will be replaced with the host where this application is running. An empty value will prompt the clickjacking service to use the whitelist configured in the Clickjacking configuration of SAP NetWeaver Administrator.

4. **Save Configuration:**
   Click on **Save Configuration** to apply the changes.

5. **Test Configuration:**
   Use the **XCM Clickjacking protection test** to verify that all prerequisites are met. The protection will only be available in the application if the test is successful.

**Note:** If you have custom applications based on JSP technology running on SAP NW JAVA, follow the attached [document](https://me.sap.com/notes/2339506) to adapt the impacted custom applications.

## Attachments

- [How_to_Adopt_SAP_Clickjacking_Protection_for_Java_Server_Pages_(JSPs).pdf](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000861522016&iv_version=0001&iv_guid=6CAE8B3EA6731ED6918A22B514C2C0BF) (860 KB)

## References

- [SAP Note 2339167](https://me.sap.com/notes/0002339167)

## Validity

Applicable to the following SAP-UCES versions:
- 6.02
- 6.04
- 6.05
- 6.35

## Support Package Patches

- **SAP UCES 6.05**  
  Support Package: SP016  
  Patch Level: 000000

## Corrections Info

- **Manual Activities Required:** Yes  
  - Number of Correction Instructions: 0  
  - State: Error

## Correction Instructions

Refer to the **Manual Activities** section above for detailed instructions.

---

_Credits to [RedRays](https://redrays.io) for support in providing this information._