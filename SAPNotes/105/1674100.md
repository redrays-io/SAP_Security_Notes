1674100 - Unauthorized modification in ITS-Service in SRM-EBP-PRC

**SAP Security Note 1674100**

**Type:** SAP Security Note  
**Version:** 5  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 08.05.2012  
**Component:** Supplier Relationship Management > SRM > Procurement Card

### Description

**Symptom:**  
SRM-EBP-PRC can be abused by a malicious user, allowing them to modify displayed application content without authorization and potentially obtain authentication information from other legitimate users.

**Other Terms:**  
Cross-site scripting (XSS), SRM-EBP-PRC

**Reason and Prerequisites:**  
ITS Service `TS_TS10007947H` within SRM-EBP-PRC does not sufficiently encode output parameters, resulting in a cross-site scripting vulnerability. This can be exploited to steal another user's authentication information or impersonate an administrator, compromising the application's security.

### Solution

Apply this note or import the changes via the relevant support package. Ensure that the corrections from notes [1621946](https://me.sap.com/notes/1621946) and [1488500](https://me.sap.com/notes/1488500) are also implemented for full protection.

**Manual Activities:**  
1. Go to transaction SICF.  
2. Open Service Path `/sap/bc/gui/sap/its/ts_ts10007947h/`.  
3. Double-click on service `ts_ts10007947h`.  
4. Click on 'GUI Configuration'.  
5. Add service parameter name `~auto_html_escaping` with value `1`.  
6. Add service parameter name `~new_xss_functions` with value `1`.

### Affected Software Components

- **SRM_SERVER:** Versions 500, 550, 600, 700, 701, 702

### Support Packages

- **SRM_SERVER 500:** [SAPKIBKS18](https://me.sap.com/supportpackage/SAPKIBKS18)
- **SRM_SERVER 550:** [SAPKIBKT20](https://me.sap.com/supportpackage/SAPKIBKT20)
- **SRM_SERVER 600:** [SAPKIBKU06](https://me.sap.com/supportpackage/SAPKIBKU06)
- **SRM_SERVER 700:** [SAPKIBKV12](https://me.sap.com/supportpackage/SAPKIBKV12)
- **SRM_SERVER 701:** [SAPK-70108INSRMSRV](https://me.sap.com/supportpackage/SAPK-70108INSRMSRV)
- **SRM_SERVER 702:** [SAPK-70203INSRMSRV](https://me.sap.com/supportpackage/SAPK-70203INSRMSRV)

### References

- [1621946 - ITS: updated XSS-escaping functions](https://me.sap.com/notes/1621946)
- [1488500 - ITS: automatically escape context fields in output](https://me.sap.com/notes/1488500)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*