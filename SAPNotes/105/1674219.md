1674219 - Unauthorized Modification in ITS-Services of ISR

**Title:** Unauthorized Modification in ITS-Services of ISR

**SAP Note Number:** 1674219  
**Type:** SAP Security Note  
**Version:** 1  
**Released On:** May 8, 2012  
**Priority:** Correction with High Priority  
**Status:** Released for Customer  
**Components Affected:**  
- Controlling > Overhead Cost Controlling (CO-OM)  
- Controlling > Overhead Cost Controlling > Cost Center Accounting (CO-OM-CCA)  
- Financial Accounting > General Ledger Accounting (FI-GL)  
- Quality Management (QM)

### **Symptom**
A vulnerability exists in the ITS-Services of the "Internal Service Request (ISR)" tool within the above components. A malicious user can exploit this flaw to:
- Modify displayed application content without authorization.
- Potentially obtain authentication information from other legitimate users.

This issue stems from insufficient encoding of OUTPUT parameters, leading to Cross-Site Scripting (XSS) vulnerabilities in the following ITS services:
- SPS1D
- SPS2D
- SR63D
- SRGEN
- SR00
- SRPH
- SR_LIBRARY
- SR61
- SR62
- SRK1
- SRK2
- SRK3
- SOR1
- SH01
- SH02
- SR01
- SR12
- SR12_START
- SR31
- SR71_ERP
- SR41
- SR42

### **Impact**
Exploiting this vulnerability allows attackers to:
- Steal authentication information, such as session data.
- Impersonate users, potentially with administrative privileges, compromising application security.

### **Solution**
To mitigate this vulnerability, apply SAP Note **1674219** or import the necessary changes via the relevant support package. Ensure that the corrections from SAP Notes [1621946](https://me.sap.com/notes/1621946) and [1488500](https://me.sap.com/notes/1488500) are also implemented, as they provide essential foundational fixes required for this correction to be effective.

**Download for SNOTE:** [Download SAP Note 1674219](https://notesdownloads.sap.com/note/0040000009940942017)  
**PDF Version:** [Print SAP Note 1674219](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001674219?language=en-US&token=97995FECD467542A0D276FD31CC9A9FD)

### **Support Packages**
Ensure that the appropriate support packages are applied based on your system version:
- **SAP_APPL 600:** SAPKH60022
- **SAP_APPL 602:** SAPKH60212
- **SAP_APPL 603:** SAPKH60311
- **SAP_APPL 604:** SAPKH60412
- **SAP_APPL 605:** SAPKH60509
- **SAP_APPL 606:** SAPKH60603

Links to support packages can be found [here](https://me.sap.com/supportpackage/SAPKH60022).

### **Manual Correction Instructions**
After importing the note, perform the following manual post-implementation step in each system:

1. Run the report `RITS_XSS_PARAM_ISR`.

**Caution:** This step must be executed manually and separately in each system after importing the note.

### **Prerequisites**
- **Software Components:** SAP_APPL versions 600 to 606.
- **Related Notes:** Ensure SAP Notes [1621946](https://me.sap.com/notes/1621946) and [1488500](https://me.sap.com/notes/1488500) are implemented prior to applying this note.

### **References**
- [SAP Note 1621946](https://me.sap.com/notes/1621946) - ITS: Updated XSS-Escaping Functions
- [SAP Note 1488500](https://me.sap.com/notes/1488500) - ITS: Automatically Escape Context Fields in Output

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for supporting the information provided.*