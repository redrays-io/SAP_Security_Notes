SAP Security Note 916398 - HTTP Access Control for Message Server

**SAP Note:** [916398](https://me.sap.com/notes/916398)  
**Type:** SAP Security Note  
**Version:** 5  
**Released On:** 18.03.2014  
**Component:** Basis Components > Client/Server Technology > Message Service

### Symptom
The customer wants to allow or reject certain URL prefixes of an HTTP inquiry.

### Reason and Prerequisites
Access control can be managed using the `ms/permission_table` parameter. If the parameter is not specified or if the file does not exist, no access control is carried out. If the file exists but contains no data, all accesses will be rejected with HTTP return code 403 (FORBIDDEN).

### Solution
You can specify a file with access authorizations by using the `ms/permission_table` parameter. The file should have the following syntax:

```
[P|D|S] url-prefix
```

- **P** (permit): Access allowed
- **D** (deny): Access forbidden
- **S** (secure): Access allowed only for HTTPS

**Sample File:**
```
# Message server test permission table
P     /sap/bc/test.cgi
P     /sap/bc/cachetest
P     /sap/bc/public/*
P     /sap/bc/ping
S     /sap/bc/secure/*
D     /sap/bc/*
D     *
```

Entries are checked in sequence, and the system allows or rejects access based on the matching entries.

### Available Downloads
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016304052017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0000916398?language=en-US&token=CBF347AE244119A0834793348E4CA0F6)

### Validity
This note is applicable to the following software components and versions:

- **KRNL32NUC:** 6.40 to 6.40EX2, 7.00 to 7.01, 7.10 to 7.20, 7.20EXT
- **KRNL32UC:** 6.40 to 6.40EX2, 7.00 to 7.01, 7.10 to 7.20, 7.20EXT
- **KRNL64NUC:** 6.40 to 6.40EX2, 7.00 to 7.01, 7.10 to 7.20, 7.20EXT
- **KRNL64UC:** 6.40 to 6.40EX2, 7.00 to 7.01, 7.10 to 7.20, 7.20EXT
- **KERNEL:** 6.40, 7.00 to 7.01, 7.10 to 7.11, 7.20+

### References
- **Refers to:** [921223 - CST Patch Collection 06 2006](https://me.sap.com/notes/921223)
- **Referenced by:** [921223 - CST Patch Collection 06 2006](https://me.sap.com/notes/921223)

### Additional Information
- **Attributes:** Externally Reported: Yes
- **CVSS Score:** 0

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits: [Red Rays](https://redrays.io) for support in providing this information.*