931251 - Security Note: Authority Check for Function Modules

**SAP Note Number:** 931251  
**Type:** SAP Security Note  
**Released On:** October 8, 2009  
**Category:** Consulting  
**Priority:** Correction with low priority  
**Status:** Released for Customer  
**Component:** Basis Components > Middleware > RFC (BC-MID-RFC)  
**Language:** English  
**Version:** 3  
**Recency:** New

### Symptom
Error message `RFC_NO_AUTHORITY`.

### Other Terms
- EUROSEC
- Security Advisory

### Reason and Prerequisites
When calling RFC functions, the authority check is performed on both the technical layer in RFC and the business layer (AUTHORITY-CHECK in ABAP). Currently, authorization checks on the technical layer are only performed for function groups (R3TR FUGR), which may pose a security risk. For functions of the function group SRFC, refer to [Note 931252](https://me.sap.com/notes/931252).

### Solution
The authority check on the technical layer has been extended to function modules. The authority object `S_RFC` can now be maintained for authority checks for:
- **Function Group**
  - `RFC_TYPE = "FUGR"`
  - `RFC_NAME = <name of the function group>`
  - `ACTVT = "16"`
- **Function Module**
  - `RFC_TYPE = "FUNC"`
  - `RFC_NAME = <name of the function module>`
  - `ACTVT = "16"`

At runtime, the first check is for the executed function group. If this check fails, a second check for the function module is executed. This behavior does not require changes during upgrades but allows for a more granular authority check to be activated as needed. Note that the authority check is performed only once with the first execution of the function module for the particular RFC session.

### Download and Additional Resources
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016072862017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0000931251?language=en-US&token=93B3B6C3B5A8E0AE022BE7141F4A0D52)

### References
- [931252 - Security Note: Authority Check for Function Group SRFC](https://me.sap.com/notes/931252)
- [1844452](https://me.sap.com/notes/1844452)
- [1718059 - New functions for the trace evaluation](https://me.sap.com/notes/1718059)
- [1640733 - PFCG: Additional S_RFC Authorization](https://me.sap.com/notes/1640733)
- [1248596 - S_RFC authorizations for sales order management](https://me.sap.com/notes/1248596)
- [1248401 - S_RFC authorization for CRM Incentives and Commission Mgmt](https://me.sap.com/notes/1248401)
- [1246841](https://me.sap.com/notes/1246841)
- [1246838 - S_RFC authorization for CRM Entitlement Management](https://me.sap.com/notes/1246838)
- [1246837 - S_RFC authorization for CRM rebate processing](https://me.sap.com/notes/1246837)
- [1246835 - S_RFC authorization for CRM billing](https://me.sap.com/notes/1246835)
- [1168772 - Minimum authorization profile for JRA](https://me.sap.com/notes/1168772)

### Side Effects
This document does not cause or solve any side effects.

**Credits:** Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.