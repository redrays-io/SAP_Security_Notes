SAP Security Note 3040210: CVE-2021-27602 Remote Code Execution Vulnerability in SAP Commerce Source Rules

**Summary**
SAP has released Security Note 3040210 addressing a critical Remote Code Execution (CVE-2021-27602) vulnerability in the Source Rules of SAP Commerce. This vulnerability allows authorized users to inject malicious code, potentially compromising the confidentiality, integrity, and availability of the application.

**Details**
The vulnerability exists in the SAP Commerce Backoffice application, where authorized users can create source rules that are translated into Drools rules when published. An attacker with the necessary authorization can exploit this by injecting malicious code into the source rules, enabling remote code execution.

**Affected Systems**
- **On-Premise Installations** of SAP Commerce
- **SAP Commerce Cloud** in the Public Cloud

**CVSS Score**
- **Base Score:** 9.9
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H

**Solution**
SAP recommends applying the following patch releases to mitigate this vulnerability:

- [SAP Commerce Cloud Patch Release 1808.36](https://me.sap.com/browse/PATCH-8843)
- [SAP Commerce Cloud Patch Release 1811.34](https://me.sap.com/browse/PATCH-8844)
- [SAP Commerce Cloud Patch Release 1905.26](https://me.sap.com/browse/PATCH-8845)
- [SAP Commerce Cloud Patch Release 2005.10](https://me.sap.com/browse/PATCH-8846)
- [SAP Commerce Cloud Patch Release 2011.5](https://me.sap.com/browse/PATCH-8847)

These patches are available in the [SAP Support Portal](https://me.sap.com/).

**Workaround**
If applying the patch releases immediately is not feasible, SAP provides a workaround to adjust permissions related to the `SourceRule` type:

1. **Review and Adjust Permissions:**
   - Navigate to **System > Types** in the SAP Commerce Backoffice.
   - For each relevant type (`SourceRule` and its super-types, sub-types, and related types), ensure that only trusted principals have `create` and `change` permissions.
   - Deny these permissions for all untrusted principals to prevent unauthorized code injection.

2. **Implement Permission Changes:**
   - Access the **Permissions Management** for each type.
   - Cycle the `create` and `change` permissions to `denied` for untrusted user groups.

**References**
- [CVE-2021-27602 Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27602)
- [SAP Security Note 3014121](https://me.sap.com/notes/3014121) – Related Remote Code Execution Vulnerability
- [FAQ KBA](https://me.sap.com/notes/3040931) – Understanding the Relationship Between Security Notes

**Additional Information**
For comprehensive guidance on installing patches and understanding potential side effects, refer to the [About Patch Releases](https://help.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/2011/en-US/8c25978386691014b4abdd61376acd24.html) documentation.

**Credits**
Credits to [Redrays](https://redrays.io) for supporting the provision of this information.