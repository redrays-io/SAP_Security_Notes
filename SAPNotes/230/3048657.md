SAP Security Note 3048657: CVE-2021-33678 Code Injection Vulnerability in SAP NetWeaver AS ABAP

**Symptom**
A function module of SAP NetWeaver AS ABAP (Reconciliation Framework) allows a high-privileged attacker to inject code that can be executed by the application. An attacker could delete critical information and render the SAP system completely unavailable.

**Other Terms**
- **CVE:** [CVE-2021-33678](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33678)
- **Types:** Command Injection, OS command injection

**Reason and Prerequisites**
The vulnerability arises from the misuse of a specific function by passing malicious SQL commands to the module, leading to the generation of a potentially malicious report that can be easily executed. This issue occurs only when the function module is executed standalone, and the user must have the relevant authorization to execute the function module.

**Solution**
To address this issue, implement the additional validation for all input data of the affected function to prevent malicious input from being passed to the database. Ensure that you apply the Support Packages and Patches referenced in this SAP Note.

**CVSS Information**
- **Score:** 6.5
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H
  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** High
  - **User Interaction:** None
  - **Scope:** Unchanged
  - **Confidentiality Impact:** None
  - **Integrity Impact:** High
  - **Availability Impact:** High

**Affected Software Components**
- **SAP_ABA:** Versions 700 to 75F

**Support Packages**
Refer to the [Support Package list](https://me.sap.com/supportpackage/SAPKA70039) for detailed information on the necessary patches for each software component version.

**Download and Resources**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000994712021)
- [PDF Version](https://me.sap.com/userapps.support.sap.com/sap/support/sfm/notes/print/0003048657?language=en-US&token=E0A19B0706104A0DBFB192443288A1FF)

For more information, visit the [SAP Support Portal](https://me.sap.com/servicessupport/knowledge).

*Credits: Thanks to [Red Rays](https://redrays.io) for supporting the provision of this information.*