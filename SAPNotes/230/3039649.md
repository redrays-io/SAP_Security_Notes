3039649 - [CVE-2021-27608] Unquoted Search Path in SAPSetup

**SAP Security Note 3039649 - [CVE-2021-27608] Unquoted Search Path in SAPSetup**

**Type:** SAP Security Note  
**Version:** 6  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** April 13, 2021  
**Component:** BC-FES-INS

### Description

#### Symptom
An unquoted service path in SAPSetup could lead to privilege escalation during the installation process that is performed when an executable file is registered. This could further lead to complete compromise of confidentiality, integrity, and availability.

#### Other Terms
- SAPSetup
- NwSapSetup
- Privilege escalation
- [CVE-2021-27608](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27608)

#### Reason and Prerequisites
Privilege escalation due to an unquoted path in SAPSetup requires:
- Rights to copy a file directly into the root of the drive where the Windows OS is installed.
- Automatic Workstation Update service installed (for updates) or executing the installer from an installation server with local security handling.
- Knowledge that software will be installed/updated/uninstalled which registers an exe-server.
- An installer that installs/uninstalls/updates from/into `C:\Program Files` or `C:\Program Files (x86)`.

### Solution
**Fix:** Creation of a new process is now with a quoted path to the executable.

**How to consume:**  
Update NwSapSetup to version **9.0.107.0** or higher from [Software downloads](https://me.sap.com/#/softwarecenter/template/products/%20_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200016672&V=MAINT&TA=ACTUAL&PAGE=SEARCH/SAPSETUP%209.0) available in the SAP Support Portal.

There is no impact on functionality after the fix.

### CVSS
- **Score:** 7.5  
- **Vector:** CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H

### References
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000540042021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003039649?language=en-US&token=4E905A4EBE07F051AB64605B3712FD39)

---

*Credits to [Red Rays](https://redrays.io) for support to provided information.*