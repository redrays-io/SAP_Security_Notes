3035472 - [Multiple CVEs] Improper Input Validation in SAP 3D Visual Enterprise Viewer

**Symptom**

This SAP security note addresses improper input validation when the following file formats are opened in **SAP 3D Visual Enterprise Viewer**.

When a user opens manipulated files received from untrusted sources in SAP 3D Visual Enterprise Viewer, the application crashes and becomes temporarily unavailable to the user until the application is restarted.

The file format details along with their relevant CVE information can be found below.

**Improper Input Validation**

- Autodesk 3D Studio for MS-DOS (.3ds, 3ds.x3d) - [CVE-2021-27596](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27596)
- Windows Bitmap (.bmp, 2d.x3d) - [CVE-2021-27594](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27594)
- Graphics Interchange Format (.gif, 2d.x3d) - [CVE-2021-27593](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27593)
- Portable Document Format (.pdf, PDFView.x3d) - [CVE-2021-27595](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27595)

**Other Terms**

Improper Input Validation, SAP 3D Visual Enterprise Viewer

**Reason and Prerequisites**

Insufficient input validation occurs when the above-mentioned file formats are opened in SAP 3D Visual Enterprise Viewer.

**Solution**

This issue is fixed in the patch listed in the "Support Packages & Patches" section below. Fixes for all 4 linked CVE-IDs are included in the same Support Package Patch level.

- The support for Rhinoceros 3D Model was removed as it is not critical for the application.
- SketchUp (.skp) and Universal 3D (.u3d) are executed in a protected environment (i.e., Sandbox.exe), so the main application does not crash.
- The following file formats have been fixed with additional validation when they are opened in SAP 3D Visual Enterprise Viewer:
  - Autodesk 3D Studio for MS-DOS (.3ds, 3ds.x3d)
  - Windows Bitmap (.bmp, 2d.x3d)
  - Graphics Interchange Format (.gif, 2d.x3d)
  - Portable Document Format (.pdf, PDFView.x3d)

The SAP Note [3034457](https://me.sap.com/notes/3034457) provides release information about SAP 3D Visual Enterprise Viewer 9.0 FP10 MP3.

**Support Package Patches**

- **Software Component Version:** VE_VIEWER_COMPLETE 9.0
- **Support Package:** SP010
- **Patch Level:** 000003
- [Download Patch](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73555000100200003543&support_package=SP010&patch_level=000003)

For more details, you can access the SAP Note here:
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000390222021)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003035472?language=en-US&token=EDD50C0BF374B39111FDC33C1603A5B7)

---

*Credits to [Redrays.io](https://redrays.io) for supporting the information provided.*