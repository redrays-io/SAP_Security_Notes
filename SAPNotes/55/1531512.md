SAP Security Note 1531512 - Unauthorized usage of ME_SWP services

**Symptom**

A malicious user can trigger functionalities in the Supplier Workplace services without authentication and authorization. The user can perform actions for which they have no authorization.

The following services can be affected and have now been protected:

- ME_SWP_ALERT
- ME_SWP_SRI
- ME_SWP_IV
- ME_SWP_PDI
- ME_SWP_PH
- ME_SWP_CO
- ME_SWP
- ME_SWP_GUI

**Other Terms**

Cross-Site Request Forgery, XSRF, ITS, SWP services, ME_SWP

**Reason and Prerequisites**

SWP services execute certain functions through their respective referencing URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the user. If present, the attacker may use a Cross Site Scripting attack to trigger the exploit or use an approach in which a link to click is presented to the victim.

**Solution**

Manual Steps for customers on EHP5 release:

1. **Start transaction SICF.**
2. **Process the following steps for each service mentioned above:**
    - Enter the name and the service and execute SICF (You will find the services in SICF under the path `/sap/bc/gui/sap/its/<service>`).
    - Double click on the service name in the tree and switch to the change mode.
    - Choose the GUI configuration.
    - Add the parameter `~XSRFCHECK` with value `1`.
    - Save the settings.

**Note the following:**

1. Refer to [note 1481392](https://me.sap.com/notes/0001481392) for additional information and instructions. The corrections from note 1481392 are a prerequisite for implementation of this note.
2. Implement the correction instructions of this note. This will also create the report `ITS_XSRF_PARAM_604_1` in your system.
3. Execute the report `ITS_XSRF_PARAM_604_1` and specify a corresponding transport request number when requested. The report will add service parameters for the adapted ITS services (maintained via the GUI configuration pushbutton for a service within transaction SICF).

Please note that against each release, the report will appear with the prefix `ITS_XSRF_PARAM_...` based on which release it is being applied for.

[Download for SNOTE](https://notesdownloads.sap.com/note/0040000009083232017)

[PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001531512?language=en-US&token=0209584B012E985CAA619E1C73281AE5)

---

*Credits to [Redrays.io](https://redrays.io) for support and information provided.*