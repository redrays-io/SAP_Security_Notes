2806403 - [CVE-2019-0370] Multiple Vulnerabilities in SAP Financial Consolidation

## Symptom

The SAP security note addresses several vulnerabilities identified in SAP Financial Consolidation. The vulnerability details along with their CVE relevant information are outlined below.

### 1. XPath Injection

SAP Financial Consolidation legacy web enables malicious users to use crafted input to break out of the data context in which their input appears and interfere with the structure of the surrounding query.

- [CVE-2019-0370](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0370)
- **CVSS Score:** 5.4  
  **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N

**Impact:**
- Exploitation of an XPath injection flaw to read sensitive application data or interfere with application logic.

### 2. Cross Site Scripting (XSS)

The SAP Financial Consolidation legacy web client does not sufficiently encode user-controlled inputs, resulting in a reflected Cross-Site Scripting (XSS) vulnerability.

- [CVE-2019-0369](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0369)
- **CVSS Score:** 5.4  
  **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N

**Impact:**
- Deface or modify content displayed on the website.
- Steal user authentication information.
- Impersonate users and access information with the same privileges as the target user.

## Solution

- **XPath Injection:** All user inputs are now escaped to prevent malicious XPath commands.
- **XSS Vulnerability:** User file uploads are escaped and sanitized to prevent the execution of malicious scripts in the browser.
- **Update Required:** Upgrade your SAP Financial Consolidation server installation to a support package, patch, or release where the issues are resolved. Refer to the [Support Packages & Patches](https://me.sap.com/servicessupport/knowledge) section for details and available patches.

### Support Package Patches

- **SBOP FINANCIAL CONS. 10.1**
  - [SP009](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73555000100200000713&support_package=SP009&patch_level=000000)
  - [SP008](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73555000100200000713&support_package=SP008&patch_level=000002)
  
- **SBOP FINANCIAL CONS. 10.0**
  - [SP019](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200012578&support_package=SP019&patch_level=000010)
  - SP020 (No URL provided)

## References

- [SAP Note 2806403](https://me.sap.com/notes/2806403)
- [CVE-2019-0370 Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0370)
- [CVE-2019-0369 Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0369)

## Credits

Credits to [redrays.io](https://redrays.io) for support in providing this information.