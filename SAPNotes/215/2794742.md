2794742 - [CVE-2019-0340] Multiple Security Vulnerabilities in SAP Enable Now

## Symptom

This note addresses multiple vulnerabilities in SAP Enable Now. The vulnerabilities as well as their solutions are:

### Missing XML Validation Vulnerability

SAP Enable Now does not sufficiently validate an XML document accepted from an untrusted source.

- [CVE-2019-0340](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0340)
- **CVSS Score:** 6.4; CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:L

**Impacts:**
- Arbitrary file retrieval from the server
- Denial-of-service conditions in successful exploits

### Missing HttpOnly Flag

The session cookie `JSESSIONID` does not have the HttpOnly flag set.

- [CVE-2019-0341](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0341)
- **CVSS Score:** 6.1; CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

## Reason and Prerequisites

The XML processors used in the manager were weak and could be exploited by attackers to extract data, execute a remote request from the server, or perform a DoS attack. Every XML upload interface was vulnerable, even with DKP export (e.g., `entity.xml`).

## Solution

Fixed with the SAP Enable Now release 1902:

1. **XEE:** The XML Parser has been hardened as per OWASP suggestions.
2. **HttpOnly Flag:** Defined for the `JSESSIONID` cookie.

### Action for On-Premise Customers

Please upgrade your installed SAP Enable Now instance to version 1902 or higher.

- [Manager Download for On-Premise Customers](https://me.sap.com/servicessupport/knowledge)
- [Release Notes & Upgrade Guide for On-Premise Customers](https://me.sap.com/help.sap.com/viewer/p/SAP_ENABLE_NOW)

### No Action for Cloud Customers

All SAP Enable Now Cloud tenants are already upgraded and include these fixes.

- To get an overview of the Cloud upgrade notifications for SAP Enable Now, use the [Cloud Availability Center](https://me.sap.com/cacv2/) and choose the product "SAP Enable Now".
- General information about SAP Cloud Platform security can be found on [SAP Secure Cloud Storage](https://www.sap.com/germany/about/cloud-trust-center/secure-cloud-storage.html).

## References

- [SAP Note 2794742](https://me.sap.com/notes/0002794742)

## Credits

Credits to [redrays.io](https://redrays.io) for providing the information.