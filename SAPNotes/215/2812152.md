2812152 - Update 1 to Security Note 2643447

**SAP Security Note**: *2812152 - Update 1 to Security Note 2643447*

### Symptom
This SAP Security Note corrects SAP Security NoteÂ 2643447.

### Other Terms
Path traversal, backtracking, directory climbing, ABAP Server File Interface

### Reason and Prerequisites
If SAP Note 2643447 has been implemented in a system that has an SAP_BASIS Support Package lower than:

- SAP_BASIS 700 SAPKB70034
- SAP_BASIS 701 SAPKB70119
- SAP_BASIS 702 SAPKB70219
- SAP_BASIS 710 SAPKB71022
- SAP_BASIS 711 SAPKB71117
- SAP_BASIS 730 SAPKB73017
- SAP_BASIS 731 SAPKB73120
- SAP_BASIS 740 SAPKB74017
- SAP_BASIS 750 SAPK-75007INSAPBASIS
- SAP_BASIS 751 SAPK-75102INSAPBASIS

and at a later point in time a Support Package update or upgrade is done, this update/upgrade aborts with a syntax error in `CL_FS_PATH`.

The problem does not occur in SAP_BASIS 752 and later.

### Solution
Implement the correction instructions of this SAP Note, at the latest before any update/upgrade is done.

The correction instructions remove the optional parameters that were introduced for the case 2.d) of SAP Note 2643447. (These optional parameters were introduced for the methods `IS_EQUAL`, `IS_SUBPATH_OF`, and `GET_PATH_NAME` of the class `CL_FS_PATH`.) There is no change for the other cases mentioned in SAP Note 2643447.

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001232812019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002812152?language=en-US&token=45A203577DD15B4436C07EB092534874)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002812152)
- [Show Changes](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC-ABA-LA*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

### CVSS
- **Score**: 4.3
- **Vector**: [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/v3.0/vector-string)

### References
- [SAP Note 2643447 - Directory Traversal vulnerability in ABAP Server File Interface](https://me.sap.com/notes/2643447)
- [SAP Note 2805129 - Problems with SAP Note 2643447 when installing a support package](https://me.sap.com/notes/2805129)
- [SAP Note 2805704 - Update to SAP Note 2812152](https://me.sap.com/notes/2805704)

*For more information, visit [SAP Support Portal](https://me.sap.com/).*

---

*Credits to [Redrays](https://redrays.io) for support in providing the information.*