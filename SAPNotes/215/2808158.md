2808158 - [CVE-2019-0330] OS Command Injection vulnerability in SAP Diagnostics Agent

---

**SAP Note:** [2808158](https://me.sap.com/notes/2808158)  
**Type:** SAP Security Note  
**Version:** 7  
**Recency:** Updated  
**Language:** English  
**Category:** Program error  
**Priority:** HotNews  
**Status:** Released for Customer  
**Released On:** 12.11.2019  
**Component:** SV-SMG-DIA-SRV-AGT  

### Description

**UPDATE 12th November 2019:** The SAP security note [2839864](https://me.sap.com/notes/2839864) replaces the corrections provided in this security note.

**UPDATE 10th September 2019:** The SAP security note [2823733](https://me.sap.com/notes/2823733) replaces the corrections provided in this security note.

The OS Command Plugin in the transaction `GPA_ADMIN` and the OSCommand Console allow an attacker to inject code that can be executed by the application. An attacker could thereby control the behavior of the application.

**Impacts of Code Injection Vulnerability:**
- Unauthorized execution of commands
- Sensitive information disclosure
- Denial of Service

**Other Terms:** Command Injection, OS command injection GPA_ADMIN, [CVE-2019-0330](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0330)

### Solution

Customers should implement the corrections provided in [SAP Note 2823733](https://me.sap.com/notes/2823733) for a complete fix.

### CVSS Details

**Score:** 9.1  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** High (H)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

### Corrections and Support Packages

- [Support Package SP005 Patch Level 000010](https://me.sap.com/support/swdc/notes?cvnr=67838200100200023942&support_package=SP005&patch_level=000010)
- [Support Package SP009 Patch Level 000000](https://me.sap.com/support/swdc/notes?cvnr=67838200100200023942&support_package=SP009&patch_level=000000)
- [Support Package SP008 Patch Level 000008](https://me.sap.com/support/swdc/notes?cvnr=67838200100200023942&support_package=SP008&patch_level=000008)
- [Support Package SP007 Patch Level 000011](https://me.sap.com/support/swdc/notes?cvnr=67838200100200023942&support_package=SP007&patch_level=000011)
- [Support Package SP006 Patch Level 000009](https://me.sap.com/support/swdc/notes?cvnr=67838200100200023942&support_package=SP006&patch_level=000009)

### References

**This document refers to:**
- [2823733 - Update 1 to Security Note 2808158: [CVE-2019-0330] OS Command Injection vulnerability in SAP Diagnostics Agent](https://me.sap.com/notes/2823733)
- [2808421 - LM-SERVICE 7.20 SP 6 Patch 9](https://me.sap.com/notes/2808421)
- [2808411 - LM-SERVICE 7.20 SP 7 Patch 11](https://me.sap.com/notes/2808411)
- [2808394 - LM-SERVICE 7.20 SP 5 Patch 10](https://me.sap.com/notes/2808394)
- [2808329 - LM-SERVICE 7.20 SP 8 Patch 8](https://me.sap.com/notes/2808329)

**This document is referenced by:**
- [2823733 - Update 1 to Security Note 2808158: [CVE-2019-0330] OS Command Injection vulnerability in SAP Diagnostics Agent](https://me.sap.com/notes/2823733)
- [2808421 - LM-SERVICE 7.20 SP 6 Patch 9](https://me.sap.com/notes/2808421)
- [2808411 - LM-SERVICE 7.20 SP 7 Patch 11](https://me.sap.com/notes/2808411)
- [2808329 - LM-SERVICE 7.20 SP 8 Patch 8](https://me.sap.com/notes/2808329)

### Side Effects

**This document is causing side effects:**
- [2823733 - Update 1 to Security Note 2808158: [CVE-2019-0330] OS Command Injection vulnerability in SAP Diagnostics Agent](https://me.sap.com/notes/2823733)

---

Credits to [redrays.io](https://redrays.io) for support to provided information.