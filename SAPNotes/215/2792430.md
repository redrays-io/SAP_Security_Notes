2792430 - [CVE-2019-0381] Binary Planting vulnerability in SAP SQL Anywhere, SAP IQ and SAP Dynamic Tiering

**Symptom**
*SAP SQL Anywhere, SAP IQ and SAP Dynamic Tiering* (the software) use a file search algorithm that can result in the inadvertent access of files located in directories outside of the paths specified by the user.

**Impacts of this Binary Planting vulnerability include:**
- Attacker could read content of arbitrary files on the system and expose sensitive data
- Attacker could overwrite, delete, or corrupt arbitrary files on the system
- Privilege elevation
- DLL hijacking

**Other Terms**
Path traversal, backtracking, directory climbing, [CVE-2019-0381](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0381)

**Reason and Prerequisites**
The attacker must already have access to the system being attacked to install rogue files.

**Solution**
The algorithm that SAP SQL Anywhere, SAP IQ, and SAP HANA Dynamic Tiering software uses to search for files such as shared libraries has been revised. This change is included in a software update affecting components like the database server, administration utilities, and client applications using the provided software APIs.

The revised file search algorithm now limits the directories searched to known locations, reducing the risk of accessing unintended directories. Significant changes include:
- Verification of absolute paths without allowing drive-relative paths on Windows
- Restriction to specific directories like the current module's directory and the executable's directory
- Defined search paths based on environment variables and OS-specific library paths
- Enhanced security measures to prevent searching unauthorized directories such as System32 on Windows unless specified in the PATH

**Software Versions Fixed**
This issue has been fixed in the following software versions:
- SAP HANA Dynamic Tiering 1.0 SP001 PL26
- SAP HANA Dynamic Tiering 2.0 SP024 PL10
- SAP HANA Dynamic Tiering 2.0 SP037 PL02
- SAP HANA Dynamic Tiering 2.0 SP041 PL00
- SAP IQ 16.0 SP11 PL23
- SAP IQ 16.1 SP02 PL16
- SAP IQ 16.1 SP03 PL05
- SAP IQ 16.1 SP04 PL01
- SAP SQL Anywhere 17.0 SP0 PL46

**CVSS Score**
- **Score:** 7.8
- **Vector:** CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  - **Attack Vector:** Local (L)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** Low (L)
  - **User Interaction:** None (N)
  - **Scope:** Unchanged (U)
  - **Confidentiality Impact:** High (H)
  - **Integrity Impact:** High (H)
  - **Availability Impact:** High (H)

**Available Languages**
- [Deutsch](https://me.sap.com/notes/0002792430/D)
- [日本語](https://me.sap.com/notes/0002792430/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002792430/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002792430/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002792430/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002792430/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002792430/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002792430/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002792430/3)

**Download and Print**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001803332019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002792430?language=en-US&token=202556C2C71CC61BB7A0831DD3DEACF9)

For more details, visit the [SAP Support Portal](https://me.sap.com/notes/0002792430).

Credits to [redrays.io](https://redrays.io) for support in providing this information.