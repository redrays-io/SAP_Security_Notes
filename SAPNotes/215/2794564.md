SAP Security Note 2794564 - Missing Authorization Check in SAP Solution Manager (Focused Build RFCs)

# SAP Security Note 2794564 - Missing Authorization Check in SAP Solution Manager (Focused Build RFCs)

**Type:** SAP Security Note  
**Version:** 4  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 07.10.2019  
**Component:** [Service > SAP Solution Manager > Focused Build & Focused Insights (ST-OST)](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'SV-SMG-OST*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

## Description

### Symptom
Some RFC enabled Function Modules in Focused Build do not perform necessary authorization checks for an authenticated user, resulting in escalation of privileges.

### Reason and Prerequisites
- Most function modules have the "RFC enabled" flag activated even though it is not necessary.
- Missing authority check on Function Modules that must be called from external systems.

### Solution
The solution includes the following:
- Introduced a check to forbid external calls for most of the Function Modules.
- Added an explicit authority check for Function Modules called by external systems.
- To implement the fix, please follow the [correction instructions](https://me.sap.com/corrins/0002794564/18246).
- No impact on existing applications.

The new authority checks are related to objects already included in the roles assigned to relevant users, hence no configuration changes are required post implementation of the note.

## CVSS

**Score:** 6.3  
**Vector:** `CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L`

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

## Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001803372019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002794564?language=en-US&token=6E48CBE0BA05F033B59D2B56B85ECDB1)
- Share by Email
- Open in New Window

## Correction Instructions

- [Implement Correction Instructions](https://me.sap.com/corrins/0002794564/18246)

## Preconditions

- **Software Component:** ST-OST  
  **Valid From:** 200  
  **Valid To:** 200  
  **SAP Note/KBA:** [2528301](https://me.sap.com/notes/2528301) - Focused Build - Owner of target transport is not changed back when Repack fails  
  **Component:** SV-SMG-OST
- **Software Component:** ST-OST  
  **Valid From:** 200  
  **Valid To:** 200  
  **SAP Note/KBA:** [2535031](https://me.sap.com/notes/2535031) - Focused Build - Objects might be deleted from executing Repack with option "Add Directory Locks"  
  **Component:** SV-SMG-OST
- *(Additional preconditions listed in the full note)*

---

*Credits to [RedRays.io](https://redrays.io) for supporting the provision of this information.*