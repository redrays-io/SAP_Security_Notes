SAP Security Note 2941170: XSS Vulnerabilities in SAPUI5â€™s Modified jQuery

---

**Title:**  
2941170 - Cross-Site Scripting (XSS) vulnerabilities in modified jQuery bundled with SAPUI5

**Description:**  
This security note addresses Cross-Site Scripting (XSS) vulnerabilities present in the modified version of jQuery bundled with SAPUI5. These vulnerabilities allow the execution of untrusted code when HTML from untrusted sources is passed to jQuery's DOM manipulation methods (e.g., `html`, `append`). This can occur even if the content is sanitized beforehand.

**Impact:**  
An attacker exploiting these XSS vulnerabilities could affect:
- **Confidentiality:** Theft of user authentication information, including session data, leading to user impersonation and unauthorized access.
- **Integrity:** Defacing or modifying displayed content on a website.

**Affected Components:**  
The following SAPUI5 versions are affected and require updates:
- **1.38.47 or higher**
- **1.44.50 or higher**
- **1.52.45 or higher**
- **1.60.29 or higher**
- **1.71.23 or higher**
- **1.78.5 or higher**
- **1.80.2 or higher**
- **1.81.0 or higher**

**Solution:**  
To mitigate these vulnerabilities, upgrade to the specified SAPUI5 versions listed above. Additionally, review and adapt any custom application or library code that interacts with HTML directly to ensure compliance with HTML5 standards, particularly regarding the proper closing of HTML tags.

**Manual Activities:**  
After applying the necessary patches, perform the following manual activities:
1. **Install the Latest UI5 Patch:** Refer to the specific notes for your SAP_UI release (e.g., [Note 2482210](https://me.sap.com/notes/2482210)) to install the newest UI5 patches.
2. **Review Code for Self-Closing Tags:** Ensure that all non-void HTML elements are properly closed in your custom controls and HTML content to prevent inconsistencies caused by the jQuery update.
3. **Enable Test Mode for Verification:** Add the URL parameter `sap-ui-xx-self-closing-check=true` to your application's URL to enable test mode, which logs errors and displays alerts for improperly closed tags.

**CVSS Score:**  
**6.1** (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**References:**  
- [CVE-2020-11022](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11022)
- [CVE-2020-11023](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11023)
- [SAP Note 2944336](https://me.sap.com/notes/2944336)
- [GitHub Correction Instructions](https://github.com/SAP/openui5/blob/master/docs/self_closing_tags_fix_instructions.md)

**Side Effects:**  
Applying the patches may cause incompatibilities with existing custom code that relies on the previous behavior of jQuery's DOM manipulation methods. It is crucial to thoroughly test applications after applying these updates.

**Credits:**  
Credits to [https://redrays.io](https://redrays.io) for support and providing the necessary information.

---