2938650 - [CVE-2020-26836] Open Redirect in SAP Solution Manager (Trace Analysis)

## Description

### Symptom
Under certain circumstances, an attacker might be able to steal a cookie from the application E2E Trace Analysis in SAP Solution Manager 7.2. The attacker can forge a URL and steal this cookie. This may impact the confidentiality of the service.

### Other Terms
SAP Solution Manager 7.2; E2E Trace Analysis, [CVE-2020-26836](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26836)

### Reason and Prerequisites

**Prerequisites:**
1. An attacker controls a web server running on the **same host** as Solution Manager but is listening on a **different port**.
2. The attacker must convince the victim to:
   - Authenticate against the Solution Manager ABAP and J2EE stack first.
   - Afterwards, call a certain URL provided by the attacker in the same browser tab/window.

If prerequisites #1 and #2 are fulfilled, the attacker would be able to steal the Cookie of the Solution Manager J2EE stack.

### Solution
The fix avoids the redirect to unknown URLs. The application will only send requests to URLs that belong to Solution Manager itself.

## CVSS

**CVSS Score:** 3.4  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** High (H)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** None (N)
- **Availability Impact (A):** None (N)

## Affected Software Components

- **Software Component:** ST
  - **From:** 720
  - **To:** 720

## Correction Instructions

- **Software Component:** ST
  - **Number of Correction Instructions:** 18
  - **[View Instructions](https://me.sap.com/corrins/0002938650/162)**

## Available Languages

- [Deutsch](https://me.sap.com/notes/0002938650/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002938650/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002938650/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002938650/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002938650/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002938650/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002938650/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002938650/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002938650/3)

## Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000002070342020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002938650?language=en-US&token=A9361D37E636214F486497BA7122748C)

## References
_No references are provided._

## Attributes

- **Externally Reported:** Yes

## Credits
Credits to [redrays.io](https://redrays.io) for support to provided information.