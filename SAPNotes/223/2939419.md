2939419 - [CVE-2020-6370] Cross-Site Scripting (XSS) vulnerability in SAP NetWeaver (DI Design Time Repository)

## Symptom

SAP NetWeaver Design Time Repository (DTR) does not sufficiently encode user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability.

### Impacts

- **Defacement:** Non-permanently deface or modify displayed content from a website.
- **Session Hijacking:** Steal authentication information of the user, such as data relating to their current session.
- **Impersonation:** Impersonate the user and access all information with the same rights as the target user.

## CVSS Details

- **Score:** 4.8
- **Vector:** `CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N`
  
  | Metric                     | Value              |
  |----------------------------|--------------------|
  | Attack Vector (AV)         | Network (N)        |
  | Attack Complexity (AC)     | Low (L)            |
  | Privileges Required (PR)   | High (H)            |
  | User Interaction (UI)      | Required (R)       |
  | Scope (S)                  | Changed (C)        |
  | Confidentiality Impact (C) | Low (L)            |
  | Integrity Impact (I)       | Low (L)            |
  | Availability Impact (A)    | None (N)           |

## Solution

1. **URL Encoding:** The URL parameters are now properly encoded to prevent a successful XSS attack.
2. **Apply Patches:** Implement the Support Packages and Patches referenced by this SAP Note.

## Affected Software Components

- **Component:** DI_DTR
- **Versions:** 7.11, 7.30, 7.31, 7.40, 7.50

## Support Package Patches

| Software Component Version             | Support Package | Patch Level | [URL](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001544&support_package=SP014&patch_level=000001) |
|----------------------------------------|-----------------|-------------|------------------------------------------------------------------------------------------------------------------------------------------------|
| DI DESIGN TIME REPOSITORY 7.50         | SP014           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001544&support_package=SP014&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.50         | SP015           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001544&support_package=SP015&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.50         | SP016           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001544&support_package=SP016&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.50         | SP017           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001544&support_package=SP017&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.50         | SP018           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001544&support_package=SP018&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.30         | SP018           | 000002      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200014959&support_package=SP018&patch_level=000002)                       |
| DI DESIGN TIME REPOSITORY 7.30         | SP019           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200014959&support_package=SP019&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.11         | SP019           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200007051&support_package=SP019&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.50         | SP019           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001544&support_package=SP019&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.40         | SP019           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019723&support_package=SP019&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.40         | SP020           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019723&support_package=SP020&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.30         | SP020           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200014959&support_package=SP020&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.11         | SP020           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200007051&support_package=SP020&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.50         | SP020           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001544&support_package=SP020&patch_level=000000)                       |
| DI DESIGN TIME REPOSITORY 7.40         | SP021           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019723&support_package=SP021&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.11         | SP021           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200007051&support_package=SP021&patch_level=000000)                       |
| DI DESIGN TIME REPOSITORY 7.30         | SP021           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200014959&support_package=SP021&patch_level=000000)                       |
| DI DESIGN TIME REPOSITORY 7.40         | SP022           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019723&support_package=SP022&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.40         | SP023           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019723&support_package=SP023&patch_level=000000)                       |
| DI DESIGN TIME REPOSITORY 7.31         | SP024           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014205&support_package=SP024&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.31         | SP025           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014205&support_package=SP025&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.31         | SP026           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014205&support_package=SP026&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.31         | SP027           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014205&support_package=SP027&patch_level=000001)                       |
| DI DESIGN TIME REPOSITORY 7.31         | SP028           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014205&support_package=SP028&patch_level=000000)                       |

## References

- [SAP Note 2939419](https://notesdownloads.sap.com/note/0040000001714302020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002939419?language=en-US&token=197DCD51925F7F511751D993C75A12C2)

---

*Credits to [https://redrays.io](https://redrays.io) for support in providing this information.*