SAP Security Note 2927373: Information Disclosure in SAP NetWeaver

**Title**
---
**SAP Note/KBA:** 2927373  
**Type:** SAP Security Note  
**Version:** 3  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with low priority  
**Status:** Released for Customer  
**Released On:** 13.07.2020  
**Component:** Basis Components > Computer Center Management System (CCMS) > CCMS Monitoring & Alerting > Operating System Monitoring Tool

**Description**
---
### Symptom
Under certain conditions, SAP NetWeaver (ABAP Server) and ABAP Platform allow an attacker with admin privileges to access certain files which should otherwise be restricted.

**Impacts of Information Disclosure:**
- Loss of information and system configuration confidentiality
- Information gathering for further exploits and attacks

### Reason and Prerequisites
Transaction AL11 enables administrators to access the file system conveniently from within the SAP system. Using the search functionality introduced with ABAP 7.31, some directories or files that are secured from access via transaction AL11 may be displayed for selection. Additionally, the file download feature can be used to download files that should not be accessible.

### Solution
Apply the correction provided in this SAP Note to implement consistent protection for search and download functionalities, similar to direct navigation.

**Details:**
- **ABAP 7.31 to ABAP 7.53:** Introduced a blacklist and implemented consistent protection.
- **ABAP 7.54:** Continued implementation of consistent protection.

**Action Required:**
Please implement the Support Package mentioned in this SAP Note or follow the respective correction instructions.

**Support Package**
---
- [SAPKB73128](https://me.sap.com/supportpackage/SAPKB73128) for SAP_BASIS 731
- [SAPKB74024](https://me.sap.com/supportpackage/SAPKB74024) for SAP_BASIS 740
- [SAPK-75019INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75019INSAPBASIS) for SAP_BASIS 750
- [SAPK-75111INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75111INSAPBASIS) for SAP_BASIS 751
- [SAPK-75207INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75207INSAPBASIS) for SAP_BASIS 752
- [SAPK-75305INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75305INSAPBASIS) for SAP_BASIS 753
- [SAPK-75403INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75403INSAPBASIS) for SAP_BASIS 754

**Correction Instructions**
---
Follow the [Correction Instructions](https://me.sap.com/corrins/0002927373/41) provided in this SAP Note to apply the necessary changes.

**CVSS**
---
- **Score:** 2.7
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N

**Impact Breakdown:**
- **Attack Vector:** Network
- **Attack Complexity:** Low
- **Privileges Required:** High
- **User Interaction:** None
- **Scope:** Unchanged
- **Confidentiality Impact:** Low
- **Integrity Impact:** None
- **Availability Impact:** None

**Additional Information**
---
- **Available Languages:** German, Japanese, Portuguese, Spanish, French, Italian, Russian, Chinese, Korean
- **Download for SNOTE:** [Download](https://notesdownloads.sap.com/note/0040000001168002020)
- **PDF Version:** [View PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002927373?language=en-US&token=943DBABFB94AEDDDC939A43567C84D17)
- **Share by Email:** Available through the Actions menu on the SAP Support Portal.
- **Open in New Window:** Available through the Actions menu on the SAP Support Portal.

**Prerequisites**
---
Ensure that the following SAP Notes are applied as prerequisites before implementing this security note:
- [1655068](https://me.sap.com/notes/1655068) AL11: Displaying non-UTF8 files in the Unicode system
- [1800943](https://me.sap.com/notes/1800943) AL11: Downloading file content from the list file display takes a long time
- [2227755](https://me.sap.com/notes/2227755) AL11: Search issues in files
- [2239558](https://me.sap.com/notes/2239558) AL11: No truncation of user names longer than 8 characters
- [2559146](https://me.sap.com/notes/2559146) AL11: Performance improvement when refreshing folder

**Manual Activities**
---
In transaction SE91, create a new message with class S1 and number 878 with the text 'Access to this file or directory is not allowed'.

**Credits**
---
Support provided by [RedRays](https://redrays.io).