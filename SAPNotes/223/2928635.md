SAP Security Note 2928635 - [CVE-2020-6284] Cross-Site Scripting (XSS) in SAP NetWeaver (Knowledge Management)

**Description**

**Symptom**

**UPDATE 27th October 2020**: This note has been re-released with updated 'Correction instruction' information for the release NetWeaver 7.50 SP12.

SAP NetWeaver Knowledge Management (KM) allows the automatic execution of script content in a stored file due to inadequate filtering with the accessing user’s privileges. If the accessing user has administrative privileges, then the execution of the script content could result in complete compromise of system confidentiality, integrity, and availability.

**Other Terms**

XSS, stored XSS, [CVE-2020-6284](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6284)

**Reason and Prerequisites**

- **Reason:** The stored file is automatically executed without checking for authorization.
- **Prerequisite:** The malicious attack file has been previously uploaded.

**Solution**

Malicious resource execution in SAP NetWeaver Knowledge Management is fixed now. 

For more information about the affected releases, see the "Support Packages & Patches" section of this SAP Note.

For more information about the SP Stack schedule and updates, visit: [SAP Support](https://me.sap.com) → Release, Upgrade and Maintenance Information → Schedules for Support Packages and Stacks Maintenance.

To know more, refer to the KBA [2932212](https://me.sap.com/notes/2932212).

**CVSS**

- **CVSS Score:** 9.0
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H)

  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** High (H)

**Validity**

- **Software Components:**
  - KMC-CM from 7.30 to 7.50

**Support Package Patches**

- Multiple patches available for KMC CONTENT MANAGEMENT 7.30 and 7.50. Refer to the [Support Package Patches](https://me.sap.com/notes/2928635) section for specific URLs and patch levels.

**Manual Activities**

```
-------------------------------------------------------------------------
|Manual Activity                                                          |
-------------------------------------------------------------------------
|VALID FOR                                                            KMC CONTENT MANAGEMENT...|
| Release 7.30       All Support Package Levels                          |
| Release 7.31       All Support Package Levels                          |
| Release 7.40       All Support Package Levels                          |
| Release 7.50       All Support Package Levels                          |
-------------------------------------------------------------------------

**Caution:** You have to perform this manual activity separately in each system into which you transport the Note for implementation.

Check if option **Force Text Download** is enabled. For more information visit: [SAP Help](https://help.sap.com/doc/saphelp_nw74/7.4.16/en-us/95/c3744f7143426e8f99c362244e0b55/content.htm?no_cache=true). If the option is disabled, please enable it.
```

**References**

- [Files cannot be opened on portal from SAP KM - Note 2964558](https://me.sap.com/notes/2964558)
- [Q&A for SAP Security Note 2928635 - Note 2957979](https://me.sap.com/notes/2957979)
- [Security measures to protect malicious file uploading and opening in KM - Note 2932212](https://me.sap.com/notes/2932212)
- [Central Note: SAP NetWeaver 7.5 SP20 EP Core (Application Platform) - Note 2993476](https://me.sap.com/notes/2993476)
- [Central Note for NetWeaver 7.31 SP28 Enterprise Portal - Note 2968177](https://me.sap.com/notes/2968177)
- [Central Note: SAP NetWeaver 7.5 SP19 EP Core (Application Platform) - Note 2925000](https://me.sap.com/notes/2925000)

**Credits**

Supported by [Redrays.io](https://redrays.io) for providing the information.