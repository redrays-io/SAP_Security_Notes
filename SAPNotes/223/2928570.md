2928570 - 'Ghostcat' Apache Tomcat AJP Vulnerability in SAP Liquidity Management for Banking

# Symptom

Due to the Apache Tomcat AJP Vulnerability codenamed 'Ghostcat' ([CVE-2020-1938](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938)), SAP Liquidity Management for Banking could allow remote code execution under some circumstances.

# Other Terms

Liquidity Management Suite; LMS; Banking; Cash Flow Management; Payment Flow Control; Collateral Management; [CVE-2020-1938](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938).

# Reason and Prerequisites

Lean Java Server uses Tomcat internally.

# Solution

**We recommend our customers to not use the AJP port. The steps to disable the AJP connector in LJS are as follows:**

1. Edit your LJS `<Install_Base>/applicationserver/config_master/org.eclipse.gemini.web.tomcat/default-server.xml` and find the following entry:
   ```xml
   <Connector port="31509" protocol="AJP/1.3" redirectPort="31543" server="SAP" />
   ```
   *(The ports and server could be different)*

2. Delete the entry or comment it out:
   ```xml
   <!-- <Connector port="31509" protocol="AJP/1.3" redirectPort="31543" server="SAP" /> -->
   ```

3. Restart the server.

**However, if you need to use the AJP port, please configure the AJP connector with a requiredSecret as shown below. Ensure that `YOUR_TOMCAT_AJP_SECRET` is a value of high security level. Please refer to the [Tomcat documentation](https://me.sap.com/) for more information.**
```xml
<Connector port="31509" protocol="AJP/1.3" redirectPort="31543" server="SAP" address="YOUR_TOMCAT_IP_ADDRESS" requiredSecret="YOUR_TOMCAT_AJP_SECRET" />
```

# CVSS

**CVSS Score:** 9.8  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://me.sap.com/)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

# Attributes

- **Number:** 2928570
- **Type:** SAP Security Note
- **Version:** 7
- **Recency:** New
- **Language:** English
- **Category:** Installation information
- **Priority:** HotNews
- **Status:** Released for Customer
- **Released On:** 09.06.2020
- **Component:** Financial Services > Liquidity Management Suite

# References

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000960152020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002928570?language=en-US&token=042AC2BFAFCAFCA607319C63CFB4A952)

# Validity

- **Software Component:** SAP_CASH_FLOW_MANAGEMENT
- **Version:** 6.2

# Credit

Information supported by [Redrays.io](https://redrays.io).