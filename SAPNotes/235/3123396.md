SAP Security Note 3123396: CVE-2022-22536 - Critical Vulnerability in SAP NetWeaver, Content Server, and Web Dispatcher

**Description**

This SAP Security Note addresses a critical vulnerability identified as CVE-2022-22536 affecting SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server 7.53, and SAP Web Dispatcher. The vulnerability allows unauthenticated attackers to perform request smuggling and request concatenation, potentially leading to the complete compromise of Confidentiality, Integrity, and Availability of the affected systems.

**Symptom**

An unauthenticated attacker can prepend a victim's request with arbitrary data, enabling the execution of functions impersonating the victim or poisoning intermediary web caches.

**Affected Components**

- SAP NetWeaver Application Server ABAP
- SAP NetWeaver Application Server Java
- ABAP Platform
- SAP Content Server 7.53
- SAP Web Dispatcher

**Reason and Prerequisites**

The vulnerability exists when HTTP(S) clients access the SAP application server or SAP Web Dispatcher through an HTTP gateway that terminates TLS and processes HTTP requests. Scenarios where the vulnerability is present include:

1. HTTP client → SAP Web Dispatcher → SAP application server
2. HTTP client → SAP Web Dispatcher 1 → SAP Web Dispatcher 2 → SAP application server
3. HTTP client → 3rd party HTTP gateway → SAP Web Dispatcher → SAP application server
4. HTTP client → 3rd party HTTP gateway → SAP application server

**Solution**

**Workaround**

Implementing the workaround is a temporary measure. SAP strongly advises applying the provided patches as soon as possible and removing the workaround once patching is complete. Refer to [SAP Note 3137885](https://me.sap.com/notes/3137885) and [KBA 3148968](https://me.sap.com/notes/3148968) for detailed instructions.

**Correction**

Apply the following patches to resolve the vulnerability completely:

- **SAP Web Dispatcher:** Follow the instructions in [SAP Note 908097](https://me.sap.com/notes/908097) to download and install the recommended version.
- **SAP Kernel:** 
  1. Apply the latest SP Stack Kernel as per [SAP Note 2083594](https://me.sap.com/notes/2083594).
  2. If necessary, apply the hotfix following [SAP Note 19466](https://me.sap.com/notes/19466).
  3. Review the regression note [SAP Note 1802333](https://me.sap.com/notes/1802333) before installation.

For detailed patch levels and downloads, refer to the **Support Package Patches** section in the original security note.

**References**

- [CVE-2022-22536](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE-2022-22536)
- [SAP Note 3138881](https://me.sap.com/notes/3138881)
- [SAP Note 3127829](https://me.sap.com/notes/3127829)
- [SAP Note 3147927](https://me.sap.com/notes/3147927)

**CVSS**

- **Score:** 10.0
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**Rating**

This document has not yet been rated. Please consider providing your feedback.

---

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*