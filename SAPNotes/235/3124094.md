3124094 - [CVE-2021-44232] Directory Traversal Vulnerability in SAF-T Framework

## Overview

A **Directory Traversal vulnerability (CVE-2021-44232)** has been identified in the **SAF-T Framework Transaction SAFTN_G** within SAP systems. This vulnerability allows an attacker to exploit insufficient validation of path information provided by a normal user, leading to full server directory access. While the attacker can view the entire filesystem structure, they cannot overwrite, delete, or corrupt arbitrary files on the server.

## Impact

- **CVSS Score:** 7.7 (High)
- **Attack Vector:** Network
- **Confidentiality Impact:** High
- **Integrity Impact:** None
- **Availability Impact:** None

## Affected Components

- **SAP_APPL:** Versions 600, 602, 603, 604, 605, 606
- **SAP_FIN:** Versions 617, 618, 720, 730
- **S4CORE:** Versions 101, 102, 103, 104, 105, 106

## Solution

The following measures have been implemented to mitigate this vulnerability:

1. **Removal of F4 Search Help:** The F4 search help for the **File Name** field in transaction **SAFTN_G** has been removed to prevent unauthorized path access.

2. **Safe File Name Entry Options:**
   - **Option 1:** Manually enter the full path and file name (e.g., `/tmp/saft.xml`) in the **File Name** field.
   - **Option 2:** Assign a Physical Path to Logical File Path `"SAFTN_FILE_PATH"` and assign a Physical File Name to Logical File Name `"SAFTN_FILE_NAME"` using the **FILE** transaction in advance.
   - **Option 3:** Assign a Physical Path to Logical File Path `"SAFTN_FILE_PATH"` in advance. In transaction **SAFTN_G**, enter only the file name without the path (e.g., `saft.xml`).

For detailed instructions, refer to the [SAP Note 3124094](https://me.sap.com/notes/3124094).

## Additional Information

- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer on 14.12.2021

## References

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001790212021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003124094?language=en-US&token=14E27BB863878843D2B87B6D765401CB)
- [SAP Support Portal](https://me.sap.com/notes/3124094)

**Credits:** Information provided with support from [Redrays.io](https://redrays.io).