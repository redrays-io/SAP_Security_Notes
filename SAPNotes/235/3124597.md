3124597 - [CVE-2022-22529] Cross-Site Scripting (XSS) vulnerability in SAP Enterprise Threat Detection

**SAP Security Note 3124597 - [CVE-2022-22529] Cross-Site Scripting (XSS) vulnerability in SAP Enterprise Threat Detection**

**Description**

SAP Enterprise Threat Detection (ETD) does not sufficiently encode user-controlled inputs, which may allow an unauthorized attacker to exploit an XSS vulnerability. The UIs in ETD utilize SAP UI5 standard controls, and the UI5 framework provides automated output encoding for these controls. This output encoding prevents stored malicious user input from being executed when reflected in the UI.

**Other Terms**
- XSS
- Reflected XSS
- [CVE-2022-22529](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22529)

**Reason and Prerequisites**

User-controlled inputs were not properly encoded when creating a new investigation, allowing XSS payloads to be reflected in the response.

**Solution**

The XSS vulnerability has been fixed by implementing output encoding for user-controlled inputs. The fix is available through the Support Packages and Patches referenced in this SAP Security Note.

**CVSS**

- **Score:** 6.1
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS%3A3.0%2FAV%3AN%2FAC%3AL%2FPR%3AN%2FUI%3AR%2FS%3AC%2FC%3AL%2FI%3AL%2FA%3AN)

**Affected Software Components**

- **Component:** SAP Enterprise Threat Detection (BC-SEC-ETD)
- **Released On:** 11.01.2022

**Support Package Patches**

- **ENTERPRISE THREAT DETECT 2.0 SP004 Patch Level 000004:** [More Info](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200007823&support_package=SP004&patch_level=000004)
- **ENTERPRISE THREAT DETECT 2.0 SP003 Patch Level 000006:** [More Info](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200007823&support_package=SP003&patch_level=000006)
- **ENTERPRISE THREAT DETECT 2.0 SP002 Patch Level 000008:** [More Info](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200007823&support_package=SP002&patch_level=000008)

**Download and References**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000020202022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003124597?language=en-US&token=7EAC37235BAAD401C60C28FBE30A1357)

**Additional Information**

- **Externally Reported:** Yes

**Translations**

Available in various languages:
- [Deutsch](https://me.sap.com/notes/0003124597/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0003124597/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003124597/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003124597/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003124597/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003124597/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003124597/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003124597/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003124597/3)

**Credits**

Supported by [RedRays.io](https://redrays.io) for providing information.