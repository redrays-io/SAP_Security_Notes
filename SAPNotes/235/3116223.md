3116223 - [CVE-2022-22543] Denial of service (DOS) in SAP NetWeaver Application Server for ABAP (Kernel) and ABAP Platform (Kernel)

**Symptom**

**UPDATE 22nd March 2022:** This note has been re-released with updated 'Support Packages & Patches' information. Kernel 7.22 has been updated with Emergency SP Stack Kernel PL1101 information.

SAP NetWeaver Application Server for ABAP (Kernel) and ABAP Platform (Kernel) does not sufficiently validate sap-passport information, which could lead to a Denial of Service attack. This allows an unauthorized remote user to provoke a breakdown of the SAP Web Dispatcher or Kernel work process. The crashed process can be restarted immediately, and other processes are not affected.

**Other Terms**

- DoS
- DDoS
- Distributed Denial of Service
- Uncontrolled Resource Consumption
- Resource Exhaustion
- [CVE-2022-22543](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22543)

**Reason and Prerequisites**

Extended Passport (EPP) does not validate internal addresses correctly, which may cause a crash in the receiver process.

**Solution**

The EPP deserializer in the SAP Kernel has been hardened.

**There is no workaround.**

Please implement the Support Package for SAP Kernel mentioned in this SAP Note.

**CVSS Score**

- **Score:** 3.7
- **Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L](https://nvd.nist.gov/vuln-metrics/cvss)

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000153152022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003116223?language=en-US&token=B44CE057227BC21404847D44A0962E06)

**Support Package Patches**

| Software Component Version              | Support Package | Patch Level | URL                                                                                                                                                                                                                               |
|-----------------------------------------|------------------|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SAP KERNEL 7.86 64-BIT UNICODE          | SP012            | 000012      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200015678&V=MAINT)                                        |
| SAP KERNEL 7.87 64-BIT UNICODE          | SP001            | 000001      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200016628&V=MAINT)                                        |
| SAP KERNEL 7.81 64-BIT UNICODE          | SP223            | 000223      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200012830&V=MAINT)                                        |
| SAP KERNEL 7.85 64-BIT UNICODE          | SP065            | 000065      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200013971&V=MAINT)                                        |
| SAP KERNEL 7.22_EX2 64-BIT              | SP1115           | 001115      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010235&V=MAINT)                                        |
| SAP KERNEL 7.22_EX2 64-BIT UC           | SP1115           | 001115      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010236&V=MAINT)                                        |
| SAP KERNEL 7.22 64-BIT                   | SP1115           | 001115      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001793&V=MAINT)                                        |
| SAP KERNEL 7.22 64-BIT UNICODE           | SP1115           | 001115      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001794&V=MAINT)                                        |
| SAP KERNEL 7.22 EXT 64-BIT               | SP1115           | 001115      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001797&V=MAINT)                                        |
| SAP KERNEL 7.22 EXT 64-BIT UC            | SP1115           | 001115      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001798&V=MAINT)                                        |
| SAP KERNEL 7.77 64-BIT UNICODE           | SP425            | 000425      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010526&V=MAINT)                                        |
| SAP KERNEL 7.53 64-BIT UNICODE           | SP911            | 000911      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200005858&V=MAINT)                                        |
| SAP KERNEL 7.53 64-BIT                   | SP911            | 000911      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200006207&V=MAINT)                                        |
| SAP KERNEL 8.04 64-BIT UNICODE           | SP206            | 000206      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200018078&V=MAINT)                                        |
| SAP KERNEL 7.49 64-BIT UNICODE           | SP1033           | 001033      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004760&V=MAINT)                                        |
| SAP KERNEL 7.49 64-BIT                   | SP1033           | 001033      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004791&V=MAINT)                                        |
| SAP KERNEL 7.22 64-BIT                   | SP1101           | 001101      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001793&V=MAINT)                                        |
| SAP KERNEL 7.22 64-BIT UNICODE           | SP1101           | 001101      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001794&V=MAINT)                                        |
| SAP KERNEL 7.22 EXT 64-BIT               | SP1101           | 001101      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001797&V=MAINT)                                        |
| SAP KERNEL 7.22 EXT 64-BIT UC            | SP1101           | 001101      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001798&V=MAINT)                                        |
| SAP KERNEL 7.22_EX2 64-BIT                | SP1101           | 001101      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010235&V=MAINT)                                        |
| SAP KERNEL 7.22_EX2 64-BIT UC             | SP1101           | 001101      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010236&V=MAINT)                                        |

**Affected Software Components**

| Software Component | From | To |
|--------------------|------|----|
| KRNL64NUC          | 7.22 | 7.22 |
| KRNL64NUC          | 7.22EXT | 7.22EXT |
| KRNL64NUC          | 7.49 | 7.49 |
| KRNL64UC           | 8.04 | 8.04 |
| KRNL64UC           | 7.22 | 7.22 |
| KRNL64UC           | 7.22EXT | 7.22EXT |
| KRNL64UC           | 7.49 | 7.49 |
| KRNL64UC           | 7.53 | 7.53 |
| KERNEL             | 7.22 | 7.22 |
| KERNEL             | 8.04 | 8.04 |
| KERNEL             | 7.49 | 7.49 |
| KERNEL             | 7.53 | 7.53 |
| KERNEL             | 7.77 | 7.77 |
| KERNEL             | 7.81 | 7.81 |
| KERNEL             | 7.85 | 7.85 |
| KERNEL             | 7.86 | 7.86 |
| KERNEL             | 7.87 | 7.87 |

**Translations Available**

- [Deutsch (Machine Translation)](https://me.sap.com/notes/0003116223/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0003116223/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003116223/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003116223/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003116223/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003116223/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003116223/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003116223/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003116223/3)

**Credits**

Credits to [redrays.io](https://redrays.io) for support to provided information.