3114134 - [CVE-2021-42064] SQL Injection vulnerability in SAP Commerce

### Description

A SQL Injection vulnerability (CVE-2021-42064) exists in SAP Commerce when it is configured to use an Oracle database. Specifically, if a query is created using the flexible search Java API with a parameterized "in" clause that accepts more than 1000 values, an attacker can execute crafted database queries, potentially exposing the backend database.

The issue can affect any extension using the flexible search API with an "in" clause containing partially untrusted input, as well as some internal components of the platform when using an Oracle database.

### Impact

This vulnerability allows for injection attacks, including blind SQL injection, which can lead to unauthorized access to confidential data, integrity manipulation, and availability disruption of the affected system.

### Affected Systems

Any SAP Commerce installation using an Oracle database is impacted.

### Solution

SAP Commerce addresses this vulnerability by properly escaping any value passed to parameterized "in" clauses when handling flexible search queries with more than 1000 values.

The following patch releases address this vulnerability:

- [SAP Commerce Cloud Patch Release 2105.2](https://cxjira.sap.com/browse/PATCH-9929)
- [SAP Commerce Cloud Patch Release 2011.12](https://cxjira.sap.com/browse/PATCH-9949)
- [SAP Commerce Cloud Patch Release 2005.17](https://cxjira.sap.com/browse/PATCH-9948)
- [SAP Commerce Cloud Patch Release 1905.33](https://cxjira.sap.com/browse/PATCH-9947)

Software Downloads for these or later patches are available in the SAP Support Portal. For information about installing patches, see [About Patch Releases](https://help.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/2105/en-US/8c25978386691014b4abdd61376acd24.html).

### CVSS Details

- **CVSS Score:** 8.8
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** Low
  - **User Interaction:** None
  - **Scope:** Unchanged
  - **Confidentiality Impact:** High
  - **Integrity Impact:** High
  - **Availability Impact:** High

### References

- [CVE-2021-42064](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42064)

### Credits

Credits to [redrays.io](https://redrays.io) for support in providing this information.