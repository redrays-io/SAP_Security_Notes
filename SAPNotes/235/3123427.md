3123427 - [CVE-2022-22532] HTTP Request Smuggling in SAP NetWeaver Application Server Java

## Description

**Update 22nd March 2022:** This note has been re-released with updated 'Support Packages & Patches' information. Kernel 7.22 has been updated with Emergency SP Stack Kernel PL1101 information.

SAP NetWeaver Application Server Java is vulnerable to HTTP request smuggling.

An unauthenticated attacker could submit a crafted HTTP server request which triggers improper shared memory buffer handling. This could allow the malicious payload to be executed and hence execute functions that could impersonate the victim or even steal the victim's logon session.

- [CVE-2022-22532](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22532)
- **CVSS Score:** **8.1**; CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

Due to improper error handling, an attacker could submit multiple HTTP server requests resulting in errors, such that it consumes the memory buffer. This could result in system shutdown rendering the system unavailable.

- [CVE-2022-22533](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22533)
- **CVSS Score:** **7.5**; CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

## CVSS

- **Score:** 8.1
- **Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)

## Solution

These vulnerabilities have been fixed by proper memory handling for HTTP pipeline requests.

The correction is contained in all patch levels that are **equal to or higher** than the patch level listed in the "**Support Package Patches**" section of this SAP Note for the desired kernel release.

### Support Package Patches

- [SAP KERNEL 7.22_EX2 64-BIT - SP1115 Patch 001115](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010235&V=MAINT)
- [SAP KERNEL 7.22_EX2 64-BIT UC - SP1115 Patch 001115](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010236&V=MAINT)
- [SAP KERNEL 7.22 64-BIT - SP1115 Patch 001115](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001793&V=MAINT)
- [SAP KERNEL 7.22 64-BIT UNICODE - SP1115 Patch 001115](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001794&V=MAINT)
- [SAP KERNEL 7.22 EXT 64-BIT - SP1115 Patch 001115](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001797&V=MAINT)
- [SAP KERNEL 7.22 EXT 64-BIT UC - SP1115 Patch 001115](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001798&V=MAINT)
- [SAP KERNEL 7.53 64-BIT UNICODE - SP914 Patch 000914](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200005858&V=MAINT)
- [SAP KERNEL 7.53 64-BIT - SP914 Patch 000914](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200006207&V=MAINT)
- [SAP KERNEL 7.49 64-BIT UNICODE - SP1036 Patch 001036](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004760&V=MAINT)
- [SAP KERNEL 7.49 64-BIT - SP1036 Patch 001036](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004791&V=MAINT)
- [SAP KERNEL 7.22 64-BIT - SP1101 Patch 001101](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001793&V=MAINT)
- [SAP KERNEL 7.22 64-BIT UNICODE - SP1101 Patch 001101](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001794&V=MAINT)
- [SAP KERNEL 7.22 EXT 64-BIT - SP1101 Patch 001101](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001797&V=MAINT)
- [SAP KERNEL 7.22 EXT 64-BIT UC - SP1101 Patch 001101](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001798&V=MAINT)
- [SAP KERNEL 7.22_EX2 64-BIT - SP1101 Patch 001101](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010235&V=MAINT)
- [SAP KERNEL 7.22_EX2 64-BIT UC - SP1101 Patch 001101](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010236&V=MAINT)

## How to Access the SAP Note

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000153182022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003123427?language=en-US&token=88A45E8703D0A9642D08867F6375714F)

*Credits to [redrays.io](https://redrays.io) for supporting the provided information.*