2697573 - [CVE-2019-0238] XSS Vulnerability in SAP Commerce

**Description**

SAP Commerce, previously known as SAP Hybris Commerce, contains a Cross-Site Scripting (XSS) vulnerability due to insufficient encoding of user-controlled inputs. This vulnerability allows attackers to:

- Deface or modify website content temporarily.
- Steal user authentication information, such as session data.
- Impersonate users and access information with the same privileges.

**Impact**

The vulnerability affects all versions of SAP Hybris Commerce before 6.7, specifically installations using a B2B Accelerator storefront. The affected component is the "Import Saved Cart" page located at `/en/USD/import/csv/saved-cart`. Installations that have removed this page are not impacted. Additionally, versions 6.7 and later may be affected if they run a storefront based on the `b2baccelerator` template before version 6.7.

**Solution**

1. **Upgrade Recommendation:**
   - Upgrade to SAP Hybris Commerce 6.7 or later.
   - Use the updated version to create a customized B2B Accelerator storefront.

2. **Manual Fix (if upgrading is not feasible):**
   - Locate `acc.csv-import.js` in your project:
     - Default installation path: `<HYBRIS_HOME>/hybris/bin/ext-template/yacceleratorstorefront/web/webroot/WEB-INF/_ui-src/responsive/lib/ybase-0.1.0/js/acc.csv-import.js`
     - Customized storefront example: `<HYBRIS_HOME>/hybris/bin/custom/myb2baccelerator/myb2bacceleratorstorefront/web/webroot/WEB-INF/_ui-src/responsive/lib/ybase-0.1.0/js/acc.csv-import.js`
   - Replace the `changeFileUploadAppearance` function with the provided secure implementation.
   - Rebuild and deploy your SAP Hybris Commerce project.

For detailed correction instructions, visit [SAP Hybris Commerce Documentation](https://me.sap.com/help).

**CVSS Details**

- **Score:** 6.1
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** None
  - **User Interaction:** Required
  - **Scope:** Changed
  - **Confidentiality Impact:** Low
  - **Integrity Impact:** Low
  - **Availability Impact:** None

**Additional Information**

- **Release Date:** January 8, 2019
- **Component:** CEC-COM-CPS-WEB (Customer Engagement and Commerce > SAP Commerce > Store frontend, Web CMS, Accelerators)
- **Support Package:** Not specified
- **References:** [CVE-2019-0238](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0238)

For more details, visit the [SAP Security Note 2697573](https://me.sap.com/notes/2697573).

**Credits**

Special thanks to [RedRays.io](https://redrays.io) for supporting the provision of this information.