2699726 - [CVE-2018-2475] Missing network isolation in Gardener

**SAP Security Note 2699726 - [CVE-2018-2475] Missing Network Isolation in Gardener**

**Type:** SAP Security Note  
**Released On:** 31.10.2018  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Component:** Basis Components > SAP Cloud Platform > Kubernetes in SAP Cloud Platform

### Description

**Symptom:**

This SAP security note is only relevant for SAP's outbound Open Source project Gardener.

SAP consumes Gardener as inbound to provide Kubernetes clusters for several SAP products. SAP is responsible for all (security) updates of all Gardener instances and all Gardener managed Kubernetes clusters at SAP. This security note applies only to Gardener stakeholders in the Open Source Community who operate their own Gardener installations, no matter if these stakeholders are SAP customers or not. It is not relevant for SAP Cloud Platform Neo environment and SAP Cloud Platform Cloud Foundry environment.

More information about Gardener can be found in this [Kubernetes Blog](https://kubernetes.io/blog/2018/05/17/gardener/).

Following the Gardener architecture, the Kubernetes apiserver of a Gardener managed shoot cluster resides in the corresponding seed cluster. Due to missing network isolation, a shoot's apiserver can access services/endpoints in the private network of its corresponding seed cluster. Combined with other minor Kubernetes security issues, the missing network isolation theoretically can lead to the compromise of other shoot or seed clusters in the Gardener context. The issue is rated high due to the high impact of a potential exploitation in the Gardener context.

### CVSS Information

**CVSS v3 Base Score:** 8.5 / 10  
**CVSS v3 Base Vector:**

- **Attack Vector:** Network (N)
- **Attack Complexity:** High (H)
- **Privileges Required:** Low (L)
- **User Interaction:** None (N)
- **Scope:** Changed (C)
- **Confidentiality Impact:** High (H)
- **Integrity Impact:** High (H)
- **Availability Impact:** High (H)

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/securitynotes).

### Reason and Prerequisites

In the Gardener context, missing network isolation can enable an attacker who is an admin in a shoot cluster to compromise the corresponding seed cluster or other shoot clusters which are controlled by this seed cluster.

### Solution

Please update to Gardener release **0.12.4** or higher. More information about the solution can be found in the corresponding announcement in the [Gardener community](https://groups.google.com/forum/#!forum/gardener) for [CVE-2018-2475](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2475). SAP consumes Gardener as inbound in the SAP Software Component Version (SCV) **SAP CP KUBERNETES INDUSTRY 1.0**.

### References

- [CVE-2018-2475](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2475)

### Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001962402018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002699726?language=en-US&token=3A5FCE39D4EB37B20FF47E6CF47D393A)

### Compare Versions

- [Show Changes](https://me.sap.com/notesLatestChanges/0002699726/E/diff)

### Available Translations

- [Deutsch](https://me.sap.com/notes/0002699726/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002699726/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002699726/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002699726/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002699726/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002699726/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002699726/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002699726/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002699726/3)

*Credits to [RedRays](https://redrays.io) for support in providing this information.*