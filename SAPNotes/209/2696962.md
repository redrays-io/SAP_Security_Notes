SAP Security Note 2696962 - Denial of Service (DoS) vulnerability in SAPFoundation / database

**SAP Security Note 2696962 - Denial of Service (DoS) Vulnerability in SAPFoundation / Database**

**Symptom**

SQLite is vulnerable to a local denial-of-service (DoS) attack. Exploiting this vulnerability can lead to a DoS condition, and other attacks may also be possible. Specifically, SQLite versions **3.7.10 through 3.22.0** are affected.

**Reason and Prerequisites**

The **SAP Cloud Platform SDK for iOS 2.0 SP02 and 3.0** incorporate a version of SQLite that contains this vulnerability, which can be exploited to cause a null pointer dereference error through certain SQL queries.

Since SQLite is an indirect dependency via SQLCipher, and SQLCipher does not offer a version where this issue is resolved, simply patching the SDK does not eliminate the vulnerability. While the SDK and the Foundation Framework do not directly use the vulnerable SQL statements, applications built on the SDK can exploit this vulnerability through the `executeStatements` function of the `SecureDatabaseStore`, allowing the execution of unvalidated statements.

**Solution**

To fully mitigate this vulnerability, applications should implement the following measures:

- **Avoid Using 'CREATE TABLE AS':** Do not execute `'CREATE TABLE AS'` via `executeStatements`. Instead, create an empty table using `'CREATE TABLE'` and insert data using separate statements.
  
- **Restrict `executeStatements` Usage:** If `executeStatements` is used, ensure that it does not allow execution of statements from external sources without proper validation.

**Affected Software Components**

- **Software Component:** HCP_SDK_FOR_IOS
  - **Versions:** 1.0, 2.0, 3.0+

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001963642018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002696962?language=en-US&token=29D3C7DC3997787EE67ED66320CCB146)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002696962)

**Additional Information**

- **Type:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 09.10.2018

For more details, visit [SAP Support](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*