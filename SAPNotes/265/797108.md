SAP Security Note 797108 - Virus scan interface (NW-VSI): Changes and releases

**Description**

You want to use the virus scan interface productively in your own applications to integrate external certified virus scan solutions and to check your own data transfer (files, mails, and so on).

You want to use the virus scan interface productively within SAP applications to check the external file upload to your system.

**Other Terms**

CL_VSI, virus scan server, VSI, virus, virus scan provider, VSA, file upload, virus scan, virus scan interface

**Reason and Prerequisites**

**Prerequisites**
- You are using an SAP R/3 Enterprise system or an SAP NetWeaver'04 (or higher) system.
- You already have an external, SAP certified anti-virus security solution (see [Note 786179](https://me.sap.com/notes/786179)).
- You are using the latest version of VSI.

**Solution**

If you do not yet have an external scan product, you will find more information on the SAP Service Marketplace under:

&nbsp;&nbsp;&nbsp;&nbsp;[Security Partners](https://me.sap.com/securitypartners)  
&nbsp;&nbsp;&nbsp;&nbsp;â†’ Partner for Virus Scan Interface (NW-VSI)

For more information, see [Note 786179](https://me.sap.com/notes/786179).

The interface 'Virus-Scan-Interface' is known as NW-VSI externally and as VSI internally. Currently, VSI Version 1.7 is supported.

SAP supports VSI in the following components (executables):
- **Virus Scan Server (vscan_rfc)**: See [Note 782963](https://me.sap.com/notes/782963)
- **AS ABAP (disp+work)**
- **AS JAVA (jlaunch or jstart)**

If problems occur with VSI in one of these components, send an OSS message to BC-SEC-VIR with the version details from the component. This can be determined using the option `-v`, for example:
```
jlaunch -v
vscan_rfc -v
```

These components are available from Kernel 6.40 and are detailed in the following notes:
- [Note 1058031](https://me.sap.com/notes/1058031) for 620 with 640 Kernel
- [Note 1058032](https://me.sap.com/notes/1058032) for 640 Kernel
- [Note 1058033](https://me.sap.com/notes/1058033) for 700 or 710 Kernel
- [Note 1058033](https://me.sap.com/notes/1058033) for 710 Kernel

Use [Note 817623](https://me.sap.com/notes/817623) to integrate NW-VSI into your SAP environments using external AV products.

**References**

This document refers to:
- [996008 - Virus check for data archiving](https://me.sap.com/notes/996008)
- [817623 - Frequent questions about VSI in SAP applications](https://me.sap.com/notes/817623)
- [807989 - Problem analysis: Virus scan during file upload](https://me.sap.com/notes/807989)
- [803637 - Virus check added to gui_upload](https://me.sap.com/notes/803637)
- [786179 - Data security products: Use in the antivirus area](https://me.sap.com/notes/786179)
- [782963 - SAP Note about usage of Virus Scan Server for NW-VSI](https://me.sap.com/notes/782963)
- [639486 - Anti-virus protection within SAP applications (BC-SEC-VIR)](https://me.sap.com/notes/639486)

**Referenced by**

This document is referenced by:
- [2569738 - SFP Adobe Form activation error](https://me.sap.com/notes/2569738)
- [786179 - Data security products: Use in the antivirus area](https://me.sap.com/notes/786179)
- [817623 - Frequent questions about VSI in SAP applications](https://me.sap.com/notes/817623)
- [639486 - Anti-virus protection within SAP applications (BC-SEC-VIR)](https://me.sap.com/notes/639486)
- [1873145 - Security update for stock pool upload](https://me.sap.com/notes/1873145)
- [1671303 - Virus scans in Web service messages (payload and attachments)](https://me.sap.com/notes/1671303)
- [803637 - Virus check added to gui_upload](https://me.sap.com/notes/803637)
- [782963 - SAP Note about usage of Virus Scan Server for NW-VSI](https://me.sap.com/notes/782963)
- [1522258 - Virus Scan Interface 720: Corrections](https://me.sap.com/notes/1522258)
- [1056884 - Error when creating virus scan profiles](https://me.sap.com/notes/1056884)
- [1058033 - Virus Scan Interface 700: Corrections](https://me.sap.com/notes/1058033)
- [1155653 - Virus scan interface 710: Corrections](https://me.sap.com/notes/1155653)
- [1058032 - Virus Scan Interface 640: Corrections](https://me.sap.com/notes/1058032)
- [1058031 - Virus Scan Interface 620: Corrections](https://me.sap.com/notes/1058031)
- [807989 - Problem analysis: Virus scan during file upload](https://me.sap.com/notes/807989)
- [996008 - Virus check for data archiving](https://me.sap.com/notes/996008)

**Software Components**

| Software Component | From | To     |
|--------------------|------|--------|
| SAP_BASIS          | 620  | 640+   |
| SAP_BASIS          | 700  | 700    |

**Support Package**

| Software Component Version | Support Package | URL                                                                 |
|----------------------------|-----------------|---------------------------------------------------------------------|
| SAP_BASIS 620              | SAPKB62063      | [Link](https://me.sap.com/supportpackage/SAPKB62063)                 |
| SAP_BASIS 640              | SAPKB64012      | [Link](https://me.sap.com/supportpackage/SAPKB64012)                 |
| SAP_BASIS 640              | SAPKB64011      | [Link](https://me.sap.com/supportpackage/SAPKB64011)                 |
| SAP_BASIS 700              | SAPKB70008      | [Link](https://me.sap.com/supportpackage/SAPKB70008)                 |
| SAP_BASIS 700              | SAPKB70011      | [Link](https://me.sap.com/supportpackage/SAPKB70011)                 |

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*