830528 - RFC logon: Security problems

## Symptom

- **RFC Logon Without Password:** You can perform an RFC logon without a password. *(This is possible only if you are using an RFC library Version 6.40.)*

- **Failed Logon Attempts Not Counted:** The password logon failed counter does not increase when logon attempts fail after previous RFC system calls. *(These are functions of the function module group SRFC.)*

## Reason and Prerequisites

This issue is caused by an error in the kernel and specific versions of the RFC Library:

- **librfc_14** (file version 6403.3.58.4600)
- **librfc_15** (file version 6403.3.59.4606)
- **librfc_16** (file version 6403.3.61.4620)
- **librfc_17** (file version 6403.3.62.4629)
- **librfc_18** (file version 6403.3.64.4641)

## Solution

**Update to a New Kernel:**

- **Basis Release 3.x:**
  - Kernel 3.1I as of patch number 782.
  - See [Note 102445](https://me.sap.com/notes/102445).

- **Basis Release 4.0x:**
  - Kernel 4.0B as of patch number 1070.
  - See [Note 102461](https://me.sap.com/notes/102461).

- **Basis Release 4.5x:**
  - Kernel 4.5B as of patch number 1003.
  - See [Note 149682](https://me.sap.com/notes/149682).

- **Basis Release 4.6x:**
  - Kernel 4.6D as of patch number 2042.
  - See [Note 318846](https://me.sap.com/notes/318846).

- **Basis Release 6.x:**
  - Kernel 6.20 as of patch number 1881 *(only for releases lower than 6.40)*, or
  - Kernel 6.40 as of patch number 69.
  - See [Note 502999](https://me.sap.com/notes/502999) or [Note 664679](https://me.sap.com/notes/664679).

- **Basis Release 7.0 (without Enhancement Packages):**
  - Kernel 7.00 as of patch number 2.
  - Or a downward-compatible kernel.

- **Basis Release 7.01 (and higher):**
  - No corrections required.

## Additional Information

**Component:** [BC-MID-RFC](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC-MID-RFC*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

**Release Date:** 19.02.2010

**Priority:** Correction with high priority

**Status:** Released for Customer

**References:**

- [Note 774406](https://me.sap.com/notes/774406) - SM20: "RFC/CPIC login failed, Reason=1, Type=S"
- [Note 664679](https://me.sap.com/notes/664679) - Installing 6.40 kernel in SAP WEB AS 6.10/6.20
- [Note 318846](https://me.sap.com/notes/318846) - Installing the 4.6D kernel in 4.6A/B/C SAP systems
- [Note 19466](https://me.sap.com/notes/19466) - Downloading SAP kernel patches

## Downloads

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000015869302017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0000830528?language=en-US&token=FAA194119C908CC43C06D2131F047437)

---

*Credits to [Red Rays](https://redrays.io) for supporting the provision of this information.*