782567 - Cross Site Scripting (XSS)

**SAP Security Note 782567 - Cross Site Scripting (XSS)**

**Description**
This security note addresses a Cross Site Scripting (XSS) vulnerability in SAP E-Recruiting BSP pages. If executable HTML or JavaScript is entered in certain fields, the browser may execute this code during output, potentially leading to security-critical issues.

**Symptoms**
- Executable HTML or JavaScript can be output on E-Recruiting BSP pages.
- Browser executes the injected code at output.

**Prerequisites**
- Valid in connection with Basis Note [822881](https://me.sap.com/notes/822881).
- Do not implement this note in combination with Basis Note [705187](https://me.sap.com/notes/705187) (XSS). If Basis Note 705187 is already implemented, it must be deimplemented before applying this note.

**Solution**
Implement HTML encoding for all fields at output to prevent the execution of HTML and JavaScript in the browser. This ensures that user inputs containing HTML or JavaScript do not cause unwanted or security-critical responses.

**Correction Instructions for E-Recruiting 2.00 (SAP WebAS 6.20):**
1. Start Transaction SE24 and open the `CL_HRRCF_BSP_EXT_APPLICATION` class in change mode.
2. Navigate to the `IF_BSP_ELEMENT~DO_AT_BEGINNING` method.
3. Insert the following source code within the method to enable encoding:
    ```abap
    method if_bsp_element~do_at_beginning.
      " Author: AS
      set extended check off."XDP
      data html type string.
      data enclosing_out type ref to if_bsp_writer.
      create object content.
      content->design = 'DESIGN2002'.

      " New line to prevent XSS
      content->forceEncode = 'ENABLED'.

      m_page_context->element_process( element = content ).
    endmethod.
    ```

**Correction Instructions for E-Recruiting 3.00 (SAP WebAS 6.40):**
1. Start Transaction SE24 and open the `CL_HRRCF_BSP_EXT_APPLICATION` class in change mode.
2. Navigate to the `IF_BSP_ELEMENT~DO_AT_BEGINNING` method.
3. Insert the following source code within the method to enable encoding:
    ```abap
    method if_bsp_element~do_at_beginning.
      " Author: AS
      set extended check off."XDP
      data html type string.
      data enclosing_out type ref to if_bsp_writer.
      create object content.
      content->design = 'DESIGN2003'.
      content->sessionmanagement = 'DEFAULT'.

      " New line to prevent XSS
      content->forceEncode = 'ENABLED'.

      m_page_context->element_process( element = content ).
    endmethod.
    ```

**Valid Software Components**
- **ERECRUIT**: Versions 200 and 300.

**Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000015775152017)
- [PDF Version](https://me.sap.com/userapps.support.sap.com/sap/support/sfm/notes/print/0000782567?language=en-US&token=0FB000FB77085F1CDCA3567026089BA3)
- Share by Email
- Open in New Window

**References**
- [SAP Note 1061439](https://me.sap.com/notes/1061439) - Cross Site Scripting (XSS), encoding user entries
- [SAP Note 822881](https://me.sap.com/notes/822881) - XSS Support for BSP-Extensions HTMLB, XHTMLB and PHTMLB
- [SAP Note 788771](https://me.sap.com/notes/788771) - “ ”- special characters in titles of search result table
- [SAP Note 711701](https://me.sap.com/notes/711701) - Composite SAP note: Security in E-Recruiting

**Translations**
Available in multiple languages, including:
- [Deutsch (Origin)](https://me.sap.com/notes/0000782567/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0000782567/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0000782567/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0000782567/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0000782567/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0000782567/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0000782567/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0000782567/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0000782567/3)

_For more details, visit the [SAP Support Portal](https://me.sap.com/)._

*Information supported by [RedRays](https://redrays.io) for provided information.*