822881 - XSS Support for BSP-Extensions HTMLB, XHTMLB and PHTMLB

## SAP Security Note 822881 â€“ XSS Support for BSP-Extensions HTMLB, XHTMLB and PHTMLB

**Type:** SAP Security Note  
**Status:** Released for Customer  
**Released On:** 08.10.2009  
**Component:** Business Server Pages (BC-BSP)  
**Priority:** Correction with medium priority  
**Recency:** New  
**Version:** 2  
**Language:** English

### Description

#### Symptom
XSS Support for BSP-Extensions HTMLB, XHTMLB and PHTMLB.

#### Reason and Prerequisites
This note provides information on whether the BSP-Extensions HTMLB, XHTMLB, and PHTMLB are vulnerable to Cross Site Scripting (XSS) attacks and how to protect these extensions against such attacks.

#### Solution
All BSP-Extensions that accept input parameters via HTTP requests, dynamically generate HTML based on these inputs, and return the content as a response to the client (browser) are potentially vulnerable to XSS attacks.

To protect the BSP-Extensions HTMLB, XHTMLB, and PHTMLB against XSS attacks, use the following attribute on the HTMLB content tag:

```html
<htmlb:content forceEncode="ENABLED">
  ...
</htmlb:content>
```

This protection is available in SAP_BASIS versions 620SP50, 640SP12, and 700. For SAP_BASIS 640SP11, you can apply this note manually.

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000004446592017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0000822881?language=en-US&token=106CF5FE30A6F5037588DF4441C2DE70)
- Share by Email
- Open in New Window

### References
This document refers to:
- [1607299 - Unauthorized modification of displayed content in PI Demo](https://me.sap.com/notes/1607299)
- [1565781 - Buyer: Sec. note for cross-site scripting & BSP applications](https://me.sap.com/notes/1565781)
- [1411659 - Security fixes for SRM SUS, Vendor Evaluation, SRM ROS](https://me.sap.com/notes/1411659)
- [1259414 - Cross Site Scripting: PCUI Stored JavaScript Vulnerability](https://me.sap.com/notes/1259414)
- [920404 - Java script error due to '\"' in project description](https://me.sap.com/notes/920404)
- [891232 - BSP Security Relevant Changes](https://me.sap.com/notes/891232)
- [887168 - BSP Page Directive <%@page forceEncode="html"%> & <%html=%>](https://me.sap.com/notes/887168)
- [782567 - Cross Site Scripting (XSS)](https://me.sap.com/notes/782567)

This document is referenced by:
- [1899606 - Checkman - Implementing the corrections contained in SAP Note 822881](https://me.sap.com/notes/1899606)
- [920404 - Java script error due to '\"' in project description](https://me.sap.com/notes/920404)

### Side Effects
This document is causing side effects:
- [914891 - Tooltip for project objects is not displayed any longer](https://me.sap.com/notes/914891)

### CVSS
**Score:** 0  
*No CVSS vector provided.*

Credits to [redrays.io](https://redrays.io) for support to provided information.