1599075 - Unauthorized use of application functions in CRM-MD-BP-PCU

**Description**

**Symptom**  
A malicious user can trigger functionality in CRM-MD-BP-PCU without authentication and authorization.

**Other Terms**  
Cross-site request forgery, XSRF, CRM-MD-BP-PCU.

**Reason and Prerequisites**  
CRM-MD-BP-PCU executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The malicious user may use a cross-site scripting attack to do this, or they may present a link to the victim.

**Solution**  
For the stateless BSP application: `CRM_PRN_ACC_OV`

1. Refer to [Note 1520324](https://me.sap.com/notes/1520324) and [Note 1551982](https://me.sap.com/notes/1551982) for additional information and instructions. The corrections from these notes are prerequisites for implementing this note.
2. Implement the correction instructions of this note. This will also create the report `BSP_XSRF_PARAM_CRM_MD_BP_PCU`.
3. Execute the report `BSP_XSRF_PARAM_CRM_MD_BP_PCU` and specify a corresponding transport request number when prompted. This report will activate XSRF protection for the BSP applications adapted by this note.

**Support Packages**

| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| BBPCRM 400                 | SAPKU40018      | [SAPKU40018](https://me.sap.com/supportpackage/SAPKU40018) |
| BBPCRM 500                 | SAPKU50020      | [SAPKU50020](https://me.sap.com/supportpackage/SAPKU50020) |
| BBPCRM 520                 | SAPKU52011      | [SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011) |
| BBPCRM 600                 | SAPKU60011      | [SAPKU60011](https://me.sap.com/supportpackage/SAPKU60011) |
| BBPCRM 700                 | SAPKU70011      | [SAPKU70011](https://me.sap.com/supportpackage/SAPKU70011) |
| BBPCRM 701                 | SAPKU70107      | [SAPKU70107](https://me.sap.com/supportpackage/SAPKU70107) |

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009493262017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001599075?language=en-US&token=E96FBC26306F360FA73D90EF866101ED)

**Available Translations**

- [Deutsch](https://me.sap.com/notes/0001599075/D)
- [日本語](https://me.sap.com/notes/0001599075/J)
- [Português](https://me.sap.com/notes/0001599075/P) (Machine Translation)
- [Español](https://me.sap.com/notes/0001599075/S) (Machine Translation)
- [Français](https://me.sap.com/notes/0001599075/F) (Machine Translation)
- [Italiano](https://me.sap.com/notes/0001599075/I) (Machine Translation)
- [Русский](https://me.sap.com/notes/0001599075/R) (Machine Translation)
- [中文](https://me.sap.com/notes/0001599075/1) (Machine Translation)
- [한국어](https://me.sap.com/notes/0001599075/3) (Machine Translation)

**Credits**  
Information provided with support from [redrays.io](https://redrays.io).