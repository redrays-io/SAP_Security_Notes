1599094 - HCM: Directory traversal in PT-TL

**Symptom**

PT-TL contains a vulnerability through which a malicious user can potentially read arbitrary files on the remote server, possibly disclosing confidential information.  
PT-TL contains a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

**Other Terms**

Directory traversal, PT-TL

**Reason and Prerequisites**

PT-TL fails to correctly validate the path that is used to reference a file that is read from the remote server. As a result, a malicious user can potentially direct the program to an arbitrary other file in the system, disclosing its contents.  
PT-TL fails to correctly validate the path to which a user-submitted file is written. As a result, a malicious user can potentially overwrite data in the remote system.

**Solution**

For additional information and instructions, see [Note 1497003](https://me.sap.com/notes/1497003). The corrections from Note 1497003 are a prerequisite for implementing this note.

The following logical file names have been created to enable the validation of physical file names:

- **HR_XX_DIR_RPTEDO00**: RPTEDO00
- **HR_XX_DIR_RPTEUP00**: RPTEUP00
- **HR_XX_DIR_RPTEUP10**: RPTEUP10
- **HR_XX_DIR_RPTEZL00**: RPTEZL00
- **HR_XX_DIR_RPTX2010**: RPTX2010
- **HR_XX_DIR_RPWI0000**: RPWI0000

**Manual Activities**

```
<P>
...
```
*Content truncated for brevity. Refer to the full note for detailed manual instructions.*

**References**

- This document refers to [Note 1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003).

**Validity**

- **Software Component**: SAP_HR
  - From: 30F To: 30F
  - From: 31H To: 31I
  - From: 40B To: 40B
  - From: 45B To: 45B
  - From: 46B To: 46B
  - From: 46C To: 46C
- **Software Component**: SAP_HRRXX
  - From: 470 To: 470
  - From: 500 To: 500
  - From: 600 To: 600
  - From: 604 To: 604

**Support Package**

- [SAPKE40BH1 for SAP_HR 40B](https://me.sap.com/supportpackage/SAPKE40BH1)
- [SAPKE45BF5 for SAP_HR 45B](https://me.sap.com/supportpackage/SAPKE45BF5)
- [SAPKE46CH7 for SAP_HR 46C](https://me.sap.com/supportpackage/SAPKE46CH7)
- [SAPK-470C2INSAPHRRXX for SAP_HRRXX 470](https://me.sap.com/supportpackage/SAPK-470C2INSAPHRRXX)
- [SAPK-50088INSAPHRRXX for SAP_HRRXX 500](https://me.sap.com/supportpackage/SAPK-50088INSAPHRRXX)
- [SAPK-60071INSAPHRRXX for SAP_HRRXX 600](https://me.sap.com/supportpackage/SAPK-60071INSAPHRRXX)
- [SAPK-60437INSAPHRRXX for SAP_HRRXX 604](https://me.sap.com/supportpackage/SAPK-60437INSAPHRRXX)

**Correction Instructions**

1. Call transaction `FILE`.
2. In the tree on the left-hand side, double-click "Logical File Path Definition".
3. Choose "New Entries".
4. Create the required logical file paths as listed in the solution section.
5. Save your entries.
6. Repeat the process for "Logical File Name Definition, Cross-Client".
7. Assign physical paths to each logical path using transaction `FILE` or transaction `SF01`.

For detailed steps, refer to the full note on [me.sap.com](https://me.sap.com/notes/1599094).

**Preconditions**

- [Note 1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003) must be applied for the affected software components.

**CVSS**

- **CVSS Score**: 0
- **CVSS Vector**: Not available

**Rating**

- **Rated Helpful**: 0 people
- **Quality Rating**: 0.0/5

*No side effects reported.*

---

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*