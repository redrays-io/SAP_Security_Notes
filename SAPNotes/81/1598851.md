SAP Security Note 1598851 - Directory Traversal in PY-FR-IE

**SAP Security Note 1598851 - Directory Traversal in PY-FR-IE**

**Type:** SAP Security Note  
**Version:** 2  
**Priority:** Correction with High Priority  
**Status:** Released for Customer  
**Released On:** 08.11.2011  
**Component:** Payroll > France > Interface to External Payroll Systems

### **Symptom**
The PY-FR-IE component contains a vulnerability that allows a malicious user to perform directory traversal, potentially writing arbitrary files on the remote server. This can lead to data corruption or alteration of system behavior.

**Impacted Programs:**
- RPB015FI
- RPB435FI
- RPB436FI
- RPDADVFI
- RPDDICFI
- RPDOWNFI
- RPFEDMFI
- RPIJSSFI
- RPLOADFI
- RPRP55FI
- RPRP56FI
- RPRP58FI
- RPSENDFI
- RPTEDIFI
- RPTMSEFI
- RPTVLOFI

### **Reason and Prerequisites**
The vulnerability exists because PY-FR-IE fails to properly validate the file path, allowing malicious users to overwrite data on the remote system.

### **Solution**
Implement the HR Support Packages listed below or follow the correction instructions provided in this note. After applying the corrections, only file paths defined in the TEDC customizing will be accepted.

**Support Packages:**
- [SAPKE46CH8](https://me.sap.com/supportpackage/SAPKE46CH8) for SAP_HR 46C
- [SAPKE46CI1](https://me.sap.com/supportpackage/SAPKE46CI1) for SAP_HR 46C
- [SAPK-470C3INSAPHRCFR](https://me.sap.com/supportpackage/SAPK-470C3INSAPHRCFR) for SAP_HRCFR 470
- [SAPK-470C6INSAPHRCFR](https://me.sap.com/supportpackage/SAPK-470C6INSAPHRCFR) for SAP_HRCFR 470
- [SAPK-50089INSAPHRCFR](https://me.sap.com/supportpackage/SAPK-50089INSAPHRCFR) for SAP_HRCFR 500
- [SAPK-50092INSAPHRCFR](https://me.sap.com/supportpackage/SAPK-50092INSAPHRCFR) for SAP_HRCFR 500
- [SAPK-60072INSAPHRCFR](https://me.sap.com/supportpackage/SAPK-60072INSAPHRCFR) for SAP_HRCFR 600
- [SAPK-60075INSAPHRCFR](https://me.sap.com/supportpackage/SAPK-60075INSAPHRCFR) for SAP_HRCFR 600
- [SAPK-60438INSAPHRCFR](https://me.sap.com/supportpackage/SAPK-60438INSAPHRCFR) for SAP_HRCFR 604
- [SAPK-60441INSAPHRCFR](https://me.sap.com/supportpackage/SAPK-60441INSAPHRCFR) for SAP_HRCFR 604

**Correction Instructions:**
- [SAP_HRCFR Correction Instructions](https://me.sap.com/corrins/0001598851/6484)
- [SAP_HR Correction Instructions](https://me.sap.com/corrins/0001598851/2)

**Manual Activities:**
1. In transaction `SE37`, create function module `HR_P06I_CHECK_PATH`:
   - In function group `P06I`
   - Description: 'Vérifie que le répertoire est autorisé'
   - With `IMPORTING` parameter `IV_FILE` of type `C`.

2. Repeat for each applicable software component as per the correction instructions.

For detailed information, please refer to the [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001598851?language=en-US&token=2B96C74C615D75AF6FD6FE2F707889D2) or [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009491902017).

### **Affected Languages**
Available machine translations:
- [Deutsch](https://me.sap.com/notes/0001598851/D)
- [日本語](https://me.sap.com/notes/0001598851/J)
- [Português](https://me.sap.com/notes/0001598851/P)
- [Español](https://me.sap.com/notes/0001598851/S)
- [Français](https://me.sap.com/notes/0001598851/F)
- [Italiano](https://me.sap.com/notes/0001598851/I)
- [Русский](https://me.sap.com/notes/0001598851/R)
- [中文](https://me.sap.com/notes/0001598851/1)
- [한국어](https://me.sap.com/notes/0001598851/3)

For more information, visit the [SAP Support](https://me.sap.com/support/).

*Credits to [redrays.io](https://redrays.io) for providing the information.*