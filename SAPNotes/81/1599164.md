SAP Security Note 1599164 - Directory Traversal in FI-FM

---

**SAP Note Details**

- **Number:** 1599164
- **Type:** SAP Security Note
- **Released On:** August 9, 2011
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer

**Description**

This security note addresses potential directory traversal vulnerabilities in the FI-FM component of SAP Financial Accounting. Specifically, the vulnerabilities allow a malicious user to:

1. **Read Arbitrary Files:** Potentially disclose confidential information by reading arbitrary files on the remote server.
2. **Write Arbitrary Files:** Potentially corrupt data or alter system behavior by writing arbitrary files on the remote server.

**Reason and Prerequisites**

The vulnerabilities exist in the programs specified in the correction instructions. To implement the corrections from this note, it is required to first apply [Note 1497003](https://me.sap.com/notes/1497003), which provides additional information and prerequisite corrections.

**Solution**

1. **Apply Prerequisite Corrections:** Ensure that all corrections from [Note 1497003](https://me.sap.com/notes/1497003) are implemented.
2. **Validate File Names and Paths:**
   - **Logical File Names:** `FM_RFFMMDBI_FILE`
     - Programs using this logical file name: `RFFMMDBI81` and `RFFMMDBI85`
   - **Logical File Path:** `FM_RFFMMDBI_PATH`

For detailed instructions, refer to the correction instructions provided in this note.

**Affected Components**

- **SAP_APPL Versions:** 470, 500, 600, 602, 603, 604, 605

**References**

- **Referenced Note:** [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Downloads**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009493852017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001599164?language=en-US&token=EF95423FD388BF5E3596F3223614FB7A)

**Prerequisites**

Before applying this note, ensure the following notes are implemented based on your SAP_APPL version:

- **SAP_APPL 470:** [Note 569217](https://me.sap.com/notes/569217)
- **SAP_APPL 500 & 600:** [Note 1026492](https://me.sap.com/notes/1026492)
- **SAP_BASIS Versions 620 to 710:** [Note 1497003](https://me.sap.com/notes/1497003)

**Credits**

Information supported by [RedRays.io](https://redrays.io).