SAP Security Note 1597489 - Unauthorized Use of Application Functions in SCM-EWM-RF

**Description**

### Symptom
An attacker can execute functions in SCM-EWM without authentication and authorization.

### Other Terms
Cross-site request forgery (XSRF), SCM-EWM

### Reason and Prerequisites
SCM-EWM executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The attacker may use a cross-site scripting attack to do this, or they may present a link to the victim.

### Solution
**Prerequisites:**
- [SAP Note 1481392](https://me.sap.com/notes/1481392) is a prerequisite for implementing this SAP Note.
- [SAP Note 1571684](https://me.sap.com/notes/1571684) is also required.

**Manual Activities:**

1. **Add Additional Parameters to the ICF Service RFUI:**
   - Start transaction **SICF** (Maintain Services).
   - Check whether the hierarchy type is prepopulated with **SERVICE**.
   - Enter **RFUI** in the "Service Name" field.
   - Choose **Execute** (or press the F8 key).
   - Open the service setting by double-clicking the service.
   - Choose **GUI Configuration**.
   - Enter the following data at the end of the parameter list:
     - **Parameter Name:** `~XSRFCHECK`
       **Value:** `1`
     - **Parameter Name:** `~OKCODE_PERMIT`
       **Value:** `ENT, F1, F2, F3, F4, F5, F6, F7, F8, F9, F10, F11, F12, CSF1`
   - Choose **Enter**.
   - Save your changes.

2. **Regenerate and Publish HTML Templates:**
   - Use the report **SIAC_REGENERATE_TEMPLATES**.
   - Start the report using transaction **SA38** (ABAP: Program Execution).
   - Enter the name of the service `/SCWM/RFUI` and the subject `99`, then choose **Execute** (or press the F8 key).
   - Select the suitable generating style **Mobile Devices (Preserving Layout)** (MOBILE).
   - Ensure the **Publish Automatically (Internal)** field is set.
   - Verify that all templates are selected.
   - Choose **Regenerate** (or press the F8 key).

**Valid For:**
- **Software Component:** SCMEWM
  - **Releases:** 510, 700, 701, 702

**References**
- [SAP Note 1571684 - Protect against cross-site request forgery for ITSmobile Services](https://me.sap.com/notes/1571684)
- [SAP Note 1481392 - Cross Site Request Forgery Protection for ITS](https://me.sap.com/notes/1481392)

*Credits to [Redrays.io](https://redrays.io) for supporting information.*