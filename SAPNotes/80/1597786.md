1597786 - Potential directory traversal - Finland (FOTV)

**SAP Security Note 1597786: Potential Directory Traversal in Finland (FOTV)**

**Description**

### Symptom
Potential Directory Traversal in the following component:
- XX-CSC-FI

### Other Terms
Path traversal, FOT_VAT_DECL_FI, FI_FOT_VAT_DECL_FI_PATH, FI_FOT_VAT_DECL_FI_FILE

### Reason and Prerequisites
1. The programs contained in the correction instructions contain vulnerabilities through which a malicious user can potentially read arbitrary files on the remote server, possibly disclosing confidential information.
2. Some of the programs contained in the correction instructions contain a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

### Solution
Please refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The corrections from Note 1497003 are a prerequisite for the implementation of this note.

**Logical File Names Used in this Solution**
- FI_FOT_VAT_DECL_FI_FILE : Class CL_IM_FOT_VAT_DECL_FI

**Logical File Paths Used in this Solution**
- The logical file name mentioned above uses the logical file path FI_FOT_VAT_DECL_FI_PATH.
- The application CL_IM_FOT_VAT_DECL_FI is passing an additional parameter parameter_1 (sy-cprog ) to the Function Module FILE_VALIDATE_NAME. This will allow a customer to insert the parameter while configuring the physical paths for the Logical File Name FI_FOT_VAT_DECL_FI_FILE.

**Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009485292017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001597786?language=en-US&token=6041D290AD4770F7291905E24F388004)
- [Edit](https://me.sap.com/sap/support/notes/edit/0001597786) *(Not visible)*
- [Show Changes](https://me.sap.com/notes/0001597786/compare) *(URL empty)*
- [Share by Email](https://me.sap.com/notes/0001597786/share)
- [Open in New Window](https://me.sap.com/notes/0001597786/open)

**References**
- **This document refers to:** [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Prerequisites**
- [1446802 - Finland 2010 VAT Declaration](https://me.sap.com/notes/1446802) for components across various SAP_APPL versions.
- [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003) for SAP_BASIS versions 46C to 710.

**Validity**
Applicable to the following SAP_APPL components:
- 46C, 470, 500, 600, 602, 603, 604, 605

**Support Package**
Relevant Support Packages include:
- [SAPKH46C63](https://me.sap.com/supportpackage/SAPKH46C63)
- [SAPKH47037](https://me.sap.com/supportpackage/SAPKH47037)
- [SAPKH50026](https://me.sap.com/supportpackage/SAPKH50026)
- [SAPKH60021](https://me.sap.com/supportpackage/SAPKH60021)
- [SAPKH60211](https://me.sap.com/supportpackage/SAPKH60211)
- [SAPKH60310](https://me.sap.com/supportpackage/SAPKH60310)
- [SAPKH60411](https://me.sap.com/supportpackage/SAPKH60411)
- [SAPKH60506](https://me.sap.com/supportpackage/SAPKH60506)

**Correction Instructions**
8 Correction Instructions available for [SAP_APPL](https://me.sap.com/corrins/0001597786/1).

**CVSS**
- CVSS Score: 0
- CVSS Vector: Not available

**Rating**
Currently not rated. Be the first to rate this document!

**Side Effects**
No known side effects.

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*