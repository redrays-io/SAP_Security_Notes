1598285 - Directory Traversal in Payroll Belgium PY-BE

## Overview

**SAP Note Number:** 1598285  
**Type:** SAP Security Note  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** August 9, 2011  
**Component:** Payroll > Belgium (PY-BE)  
**Language:** English

## Symptom

The Payroll Belgium (PY-BE) module contains a vulnerability that allows a malicious user to perform directory traversal, potentially writing arbitrary files on the remote server. This can lead to data corruption or alteration of system behavior. Additionally, improperly maintained filenames can cause short dumps in specific cases.

## Reason and Prerequisites

In Payroll Belgium, the system fails to correctly validate the path where a user-submitted file is written. This oversight enables a malicious user to overwrite data on the remote system.

## Solution

Please refer to [SAP Note 1497003](https://me.sap.com/notes/1497003) for additional information.

### Logical File Configuration

1. **Create Logical File Path `HR_BE_FILE_PATH_DOWN`:**
   - Navigate to IMG activity **"Cross-Client Maintenance of File Names and Paths"** (`SAP NetWeaver -> Application Server -> System administration -> Platform-Independent File Names`) or use transaction `FILE`.
   - Insert a new entry `HR_BE_FILE_PATH_DOWN` in the "Logical File Path Definition" node.
   - Save the entry.
   - Double-click on "Assignment of Physical Paths to Logical Path" for the new entry.
   - Maintain entries according to your operating system and the desired physical path.

2. **Create Logical File Name `HR_BE_DOWNLOAD_FILE_PD`:**
   - Navigate to IMG activity **"Cross-Client Maintenance of File Names and Paths"** (`SAP NetWeaver -> Application Server -> System administration -> Platform-Independent File Names`) or use transaction `FILE`.
   - Insert a new entry `HR_BE_DOWNLOAD_FILE_PD` in the "Logical File Name Definition, Cross-Client" node.
   - Maintain the following values:
     - **Logical File:** `HR_BE_DOWNLOAD_FILE_PD`
     - **Name:** File created via Pensioners Declaration (download)
     - **Data Format:** DIR
     - **Applicat. Area:** HR
     - **Logical Path:** `HR_BE_FILE_PATH_DOWN`

## Affected Software Components

- **SAP_HR:** 46B, 46C
- **SAP_HRCBE:** 470, 500, 600, 604

## Support Packages

- **SAP_HR 46C:** [SAPKE46CH7](https://me.sap.com/supportpackage/SAPKE46CH7)
- **SAP_HRCBE 470:** [SAPK-470C2INSAPHRCBE](https://me.sap.com/supportpackage/SAPK-470C2INSAPHRCBE)
- **SAP_HRCBE 500:** [SAPK-50088INSAPHRCBE](https://me.sap.com/supportpackage/SAPK-50088INSAPHRCBE)
- **SAP_HRCBE 600:** [SAPK-60071INSAPHRCBE](https://me.sap.com/supportpackage/SAPK-60071INSAPHRCBE)
- **SAP_HRCBE 604:** [SAPK-60437INSAPHRCBE](https://me.sap.com/supportpackage/SAPK-60437INSAPHRCBE)

## Correction Instructions

- **SAP_HRCBE:**
  - 4 Correction Instructions  
  - [View Corrections](https://me.sap.com/corrins/0001598285/6477)
  
- **SAP_HR:**
  - 2 Correction Instructions  
  - [View Corrections](https://me.sap.com/corrins/0001598285/2)

## References

- **Related Note:** [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

## Available Translations

This note is available in the following languages:

- [Deutsch (D)](https://me.sap.com/notes/0001598285/D)
- [日本語 (J)](https://me.sap.com/notes/0001598285/J)
- [Português (P) - Machine Translation](https://me.sap.com/notes/0001598285/P)
- [Español (S) - Machine Translation](https://me.sap.com/notes/0001598285/S)
- [Français (F) - Machine Translation](https://me.sap.com/notes/0001598285/F)
- [Italiano (I) - Machine Translation](https://me.sap.com/notes/0001598285/I)
- [Русский (R) - Machine Translation](https://me.sap.com/notes/0001598285/R)
- [中文 (1) - Machine Translation](https://me.sap.com/notes/0001598285/1)
- [한국어 (3) - Machine Translation](https://me.sap.com/notes/0001598285/3)

## Rating

This document has not been rated yet. Feel free to share your feedback!

## Side Effects

This document does not solve any known side effects and is not causing any side effects.

---

*Credits to [Redrays](https://redrays.io) for support and information provided.*