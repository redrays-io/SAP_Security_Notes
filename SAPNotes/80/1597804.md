1597804 - Unauthorized modification of displayed content

**Description**

Web Channel applications can be abused by a malicious user, allowing them to modify displayed application content without authorization and potentially obtain authentication information from other legitimate users.

**Symptom**

Pages within Web Channel applications do not sufficiently encode output parameters, resulting in a reflected cross-site scripting (XSS) issue. A reflected XSS attack can be used to non-permanently deface or modify displayed content on a website. Additionally, it can be used to steal another user's authentication information, such as data relating to their current session. A malicious user who gains access to this data may impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

**Affected Components and Versions**

- **SAP-CRMISA:** 4.0_640
- **SAP-CRMJAV:** 5.0, 6.0, 700, 701, 730
- **SAP-CRMWEB:** 5.0, 6.0, 700, 701, 730
- **SAP-SHRWEB:** 5.0, 6.0, 700, 701, 730
- **SAP-SHRJAV:** 5.0, 6.0, 700, 701, 730
- **SAP-CRMAPP:** 5.0, 6.0, 700, 701, 730
- **SAP-SHRAPP:** 5.0, 6.0, 700, 701, 730

**Reason and Prerequisites**

The issue arises because Web Channel application pages do not properly encode output parameters, making them susceptible to reflected XSS attacks.

**Solution**

This note contains Java correction(s) for E-Commerce and Web Channel. Apply the Support Package patch level attached to this note.

For more information about applying Java patches, refer to [Note 877887](https://me.sap.com/notes/877887). See [Note 1546959](https://me.sap.com/notes/1546959) for information about the patch strategy.

**Additional Information**

If you are using Internet Service B2B/B2C or Claims and Returns web applications, do not allow the upload of HTML or JavaScript documents. Maintain the attachment component configuration in the application configurations of the web applications within the Extended Configuration Management (XCM) accordingly. Do not use the document types `text/html` and `text/javascript` for the parameter `attachments_upload_file_type_filter`.

**References**

- [Patch strategies for SAP E-Commerce solutions (1546959)](https://me.sap.com/notes/1546959)
- [Installing Patches for CRM Java Components and FSCM BD (877887)](https://me.sap.com/notes/877887)

**Attachments**

_No attachments available._

**Support Package Patches**

A comprehensive list of support package patches is available [here](https://me.sap.com/note/1597804).

**Side Effects**

This document is causing side effects in [Log files not accessible from CRM-ISA admin logging page (1702925)](https://me.sap.com/notes/1702925).

---
*Credits to [RedRays.io](https://redrays.io) for support and provided information.*