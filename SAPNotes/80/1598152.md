1598152 - Directory Traversal in Payroll Belgium PY-BE

**Symptom**
The Payroll Belgium component contains a vulnerability that allows a malicious user to perform directory traversal, potentially reading arbitrary files and disclosing confidential information.

**Affected Component**
- **Component:** Payroll Belgium (PY-BE)
- **SAP Components:** SAP_HR (various releases), SAP_HRCBE
- **Software Versions:** 
  - SAP_HR: 46B, 46C
  - SAP_HRCBE: 470, 500, 600, 604

**Description**
In Payroll Belgium, the system fails to correctly validate the file path used to reference files read from the remote server. This flaw enables a malicious user to manipulate the program to access arbitrary files on the system, leading to potential disclosure of sensitive information.

**Solution**
To address this vulnerability, implement the necessary corrections using the Note Assistant or by importing the relevant Support Package into your SAP system.

**Steps to Apply Corrections Manually:**
1. **Create Logical File Path `HR_BE_FILE_PATH`:**
   - Navigate to IMG Activity: `Cross-Client Maintenance of File Names and Paths` (SAP NetWeaver → Application Server → System Administration → Platform-Independent File Names) or use transaction `FILE`.
   - Insert a new entry `HR_BE_FILE_PATH` in the "Logical File Path Definition" node.
   - Save the entry.
   - Double-click on "Assignment of Physical Paths to Logical Path" and maintain entries according to your operating system and the desired physical path.

2. **Create Logical File Name `HR_BE_UPLOAD_FILE_DMFA`:**
   - Within the same IMG activity or transaction `FILE`, insert a new entry `HR_BE_UPLOAD_FILE_DMFA` in the "Logical File Name Definition, Cross-Client" node.
   - Maintain the following values:
     - **Name:** File for uploading in DMFA Report
     - **Data Format:** DIR
     - **Application Area:** HR
     - **Logical Path:** HR_BE_FILE_PATH
   - Save the changes.

**References**
- [SAP Note 1497003](https://me.sap.com/notes/1497003) - Potential directory traversals in applications

**Download and Documentation**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009487572017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001598152?language=en-US&token=469126D48971B5EE1E07CFD65DEAEB54)

For more detailed instructions and support, visit [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for providing the information.*