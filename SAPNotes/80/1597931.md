SAP Security Note 1597931 - XSRF Protection for the stateless BSP application

---

### Description

A malicious user can execute functions in the SRM application without proper authentication and authorization.

**Other Terms:**  
Cross-site request forgery, SRM Applications, BSP pages.

**Reason and Prerequisites:**  
SRM applications execute certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a specific URL and parameters, the function is executed with the user's rights. This can be achieved through a cross-site scripting attack or by presenting a deceptive link to the victim.

### Solution

Import the corresponding Support Package (SP) or follow the correction instructions provided in this note. After applying the correction instructions, follow the manual steps outlined below.

### Actions

- **Download for SNOTE:** [Download](https://notesdownloads.sap.com/note/0040000009486082017)
- **PDF Version:** [Print PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001597931?language=en-US&token=27A533B0C2976819A1E95D5484105FB6)
- **Show Changes:** [Compare Versions](https://me.sap.com/notesLatestChanges/0001597931/E/diff)
- **Share by Email**
- **Open in New Window**

### Manual Actions

#### Manual Pre-Implementation

**Valid For:**
- **Software Component:** SRM_SERVER
  - **Release 550:** Until SAPKIBKT19
  - **Release 500:** Until SAPKIBKS17
  - **Release 600:** SAPKIBKU03 - SAPKIBKU05
  - **Release 700:** SAPKIBKV01 - SAPKIBKV11

**Steps:**
1. Navigate to SE80.
2. Select the BSP application from the dropdown.
3. For each relevant BSP application, go to the Properties tab and mark the XSRF protection flag as 'X'.

**Caution:** Perform this manual activity separately in each system where the note is transported for implementation.

#### Detailed Manual Activities
1. Navigate to SE80 and select the BSP application.
2. Select the application `/SAPSRM/BSP_DHTML_APPLE` and press Enter.
3. In the Properties tab of the BSP application, check the 'XSRF Protection' flag and activate the changes.
4. Repeat the above steps for the following applications:
   - `/SAPSRM/BSP_JAVA_APPLET`
   - `/SAPSRM/CALL_SIG_CTRL`
   - `SRMSUS_SELFREG`

### Valid For

**Software Components:**
- SRM_SERVER (Versions 500, 550, 600, 700, 701)

### Support Packages

- **SRM_SERVER 500:** [SAPKIBKS18](https://me.sap.com/supportpackage/SAPKIBKS18)
- **SRM_SERVER 550:** [SAPKIBKT20](https://me.sap.com/supportpackage/SAPKIBKT20)
- **SRM_SERVER 600:** [SAPKIBKU06](https://me.sap.com/supportpackage/SAPKIBKU06)
- **SRM_SERVER 700:** [SAPKIBKV12](https://me.sap.com/supportpackage/SAPKIBKV12)
- **SRM_SERVER 701:** [SAPK-70106INSRMSRV](https://me.sap.com/supportpackage/SAPK-70106INSRMSRV)

### References

- **This document refers to:**  
  - [SAP Note 1639703 - Supplier self-registration leads to system termination](https://me.sap.com/notes/1639703)

- **This document is referenced by:**  
  - [SAP Note 1639703 - Supplier self-registration leads to system termination](https://me.sap.com/notes/1639703)

### Preconditions

Ensure the following SAP Notes are applied based on your SRM_SERVER release:

- **Release 550:**
  - [1003820 - Supplier cannot be registered](https://me.sap.com/notes/1003820)
  - [1411659 - Security fixes for SRM SUS, Vendor Evaluation, SRM ROS](https://me.sap.com/notes/1411659)
  - [1579382 - Incomplete error messages during self-registration](https://me.sap.com/notes/1579382)

- **Release 600:**
  - [996030 - Need to relogin to srmsus_selfreg service when using aliases](https://me.sap.com/notes/996030)
  - [1355050 - Validation of login/password in Supplier Self Registration](https://me.sap.com/notes/1355050)

- **Release 700:**
  - [1355050 - Validation of login/password in Supplier Self Registration](https://me.sap.com/notes/1355050)

---

*Supported by [redrays.io](https://redrays.io) for providing the information.*