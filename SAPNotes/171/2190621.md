2190621 - SAP Netweaver SAL incorrect logging of addresses

**SAP Security Note 2190621 - SAP Netweaver SAL incorrect logging of addresses**

**Symptom:**
Incorrect logging of IP addresses in Security Audit Logging (SAL). Specifically, the system logs the terminal IP address instead of the last routed (peer) IP address, which can lead to inaccurate audit trails.

**CVSS Information:**
- **CVSS v3 Base Score:** 4.3/10
- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** Low (L)
- **User Interaction:** None (N)
- **Scope:** Unchanged (U)
- **Confidentiality Impact:** None (N)
- **Integrity Impact:** Low (L)
- **Availability Impact:** None (N)

**Reason and Prerequisites:**
In network environments that include proxies or NAT routers, SAL incorrectly logs the client's terminal IP address instead of the router's IP address. Since the router's IP address cannot be manipulated by the client, it provides a more reliable source for auditing purposes.

**Solution:**
Introduce a new profile parameter `rsau/log_peer_address`. 
- **Default Value:** `0` (no change in behavior)
- **Recommended Value:** `1` (logs the last routed IP address instead of the terminal IP address)

**Steps to Implement:**
1. **Set the Profile Parameter:**
   - Add or update the parameter `rsau/log_peer_address` to `1` in your system profile.
   - Note: Setting this parameter may cause warnings in transaction RZ10. These warnings can be safely ignored, and the parameter can be maintained.

2. **Apply the Kernel Patch:**
   - Download and apply the kernel patch referenced in this SAP Note to ensure the solution is fully implemented.
   - **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000018123092017](https://notesdownloads.sap.com/note/0040000018123092017)
   - **PDF Version:** [View PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002190621?language=en-US&token=7BF8B62311A8DCAAE34E35F058FC35C9)

**Support Packages and Patches:**
Applicable to various SAP Kernel versions. Refer to the [Support Package](https://me.sap.com/supportpackage/SAPKB74013) for detailed information on supported versions and available patches.

**References:**
- This document is referenced by:
  - [SAL audit log read returns one entry too less](https://me.sap.com/notes/0002284509)
  - [SAL | Corrupt characters at end of terminal address](https://me.sap.com/notes/0002236232)
  - [DP: Logon lasts long](https://me.sap.com/notes/0002282136)

**Additional Actions:**
- **Favorite/Unmark as Favorite:** Easily mark this note as a favorite for quick access.
- **Share by Email:** Share this security note with your team via email.
- **Open in New Window:** View the note in a new browser window for better navigation.
- **Show Changes:** [Show Changes](https://me.sap.com/notesLatestChanges/0002190621/E/diff)

For more detailed information and updates, visit the official SAP Support Portal.

*Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.*