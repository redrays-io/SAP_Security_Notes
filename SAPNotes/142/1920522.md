SAP Security Note 1920522 - Unauthorized modification of stored content in SCM-BAS-UIF

**Symptom**

SNC UI Framework can be abused by an attacker, allowing them to modify application content, persist the modified content without authorization, and potentially obtain authentication information from other legitimate users.

**Other Terms**

Stored cross-site scripting, XSS, SCM-BAS-UIF

**Reason and Prerequisites**

Certain parts of the UI Framework do not sufficiently encode input parameters, resulting in a stored cross-site scripting issue.

- **Impact**:
  - Permanently modify displayed content on a website.
  - Embed content that is rendered automatically without targeting individual victims.
  - Steal another user's authentication information, such as session data.
  - Impersonate users to access information with the same rights.
  - Compromise the security of the application if an administrator is impersonated.

**Solution**

Implement the attached source code correction.

**Correction Instructions**

1. **For SCMSNC Releases 700, 701, 702, and 712:**

   - Log in to the SNC system in English and perform the following steps:
     1. Start transaction `SPRO`.
     2. Navigate to `SAP NetWeaver -> Application Server -> System Administration -> Virus Scan Interface`.
     3. Execute `Define Virus Scan Profiles`.
     4. Select `Create New Entries`.
     
     **Create Scan Profile:**
     - **Scan Profile**: `/SCA/DM_BRANDING/UPLOAD_FILE`
     - **Profile Text**: `Profile for scanning Branding Image Uploads in SCM SNC`
     - Check `Evaluate Profile Configuration Parameters`.
     - Check `Use Reference`.
     
     **Profile Configuration:**
     1. Double-click on `Profile configuration`.
     2. Select `Create New Entries`.
     3. Add the following entries:
        - `CUST_ACTIVE_CONTENT 1`
        - `CUST_CHECK_MIME_TYPE 1`
     
     **MIME-Types:**
     1. Double-click on `MIME-Types`.
     2. Select `Create New Entries`.
     3. Add the following entry:
        - `image/*`
     
     4. Save and exit.

   - **Additional Scan Profiles:**
     1. Select `Virus Scan Profile` from the tree component on the left.
     2. Enter edit mode and create the following entries:
        - **Scan Profile**: `/SCA/DM_MFGC/UPLOAD_FILE`
          - **Profile Text**: `Profile for Scanning Attachment Uploads to Work Orders in SCM SNC`
          - Check `Ref. Profile`.
          - **Link**: All steps successful.
          - Check `Evaluate Profile Configuration Parameters`.
        - **Scan Profile**: `/SCA/DM_MYS/UPLOAD_FILE`
          - **Profile Text**: `Profile for Scanning Attachment Uploads to Quick View Microblog in SCM SNC`
          - Check `Ref. Profile`.
          - **Link**: All steps successful.
          - Check `Evaluate Profile Configuration Parameters`.
     3. Press Save.

**Download and Print**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000019176822017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001920522?language=en-US&token=6A7901D36D045B0EA8D9692D093D3350)

**Credits**

Special thanks to [Redrays](https://redrays.io) for supporting the provision of this information.