1917054 - Untrusted XML input parsing possible in CRM-BTX-GWI

## Description

**Symptom**

A malicious user can modify an XML-based request to include XML content that is then parsed locally. This could allow a malicious user to perform a denial of service (DoS) on the parsing system, or disclose local data that is then returned in the response to the malicious request, or access further network-located resources that are accessible from the parsing system.

**CVSS Information**

- **CVSS Base Score:** 5.0
- **CVSS Base Vector:** AV:N/AC:L/AU:N/C:P/I:N/A:N

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/).

**Other Terms**

XXE, XML External Entity, information disclosure, denial of service, DoS, CRM-BTX-GWI

**Reason and Prerequisites**

The problem is caused by a program error in CRM-BTX-GWI due to the incorrect use of an XML parser. By default, the parser opens external entities referenced within an XML input, which can then lead to malicious content being parsed. This malicious content can reference internal resources, such as files. These internal resources can be disclosed in the response to the request, or can be used to perform a denial of service attack on the parsing system, rendering application content temporarily unavailable.

**Prerequisite:** SAP Note [1712860](https://me.sap.com/notes/1712860) should be implemented before this.

## Solution

Implement the correction provided in this security note.

## Software Components Affected

| Software Component | From | To |
|---------------------|------|----|
| BBPCRM              | 600  | 600 |
| BBPCRM              | 700  | 700 |
| BBPCRM              | 701  | 701 |
| BBPCRM              | 702  | 702 |
| BBPCRM              | 712  | 712 |
| BBPCRM              | 713  | 713 |

## Support Package

| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| BBPCRM 600                 | SAPKU60015      | [SAPKU60015](https://me.sap.com/supportpackage/SAPKU60015) |
| BBPCRM 700                 | SAPKU70015      | [SAPKU70015](https://me.sap.com/supportpackage/SAPKU70015) |
| BBPCRM 701                 | SAPKU70112      | [SAPKU70112](https://me.sap.com/supportpackage/SAPKU70112) |
| BBPCRM 702                 | SAPKU70210      | [SAPKU70210](https://me.sap.com/supportpackage/SAPKU70210) |
| BBPCRM 712                 | SAPKU71205      | [SAPKU71205](https://me.sap.com/supportpackage/SAPKU71205) |
| BBPCRM 713                 | SAPKU71302      | [SAPKU71302](https://me.sap.com/supportpackage/SAPKU71302) |

## Correction Instructions

| Software Component | Number of Correction Instructions | URL |
|--------------------|-----------------------------------|-----|
| BBPCRM             | 5                                 | [Correction Instructions](https://me.sap.com/corrins/0001917054/63) |

## Translations

Available in the following languages:

- [日本語](https://me.sap.com/notes/0001917054/J) (Human Translation)
- [Deutsch](https://me.sap.com/notes/0001917054/D) (Human Translation)
- [Português](https://me.sap.com/notes/0001917054/P) (Machine Translation)
- [Español](https://me.sap.com/notes/0001917054/S) (Machine Translation)
- [Français](https://me.sap.com/notes/0001917054/F) (Machine Translation)
- [Italiano](https://me.sap.com/notes/0001917054/I) (Machine Translation)
- [Русский](https://me.sap.com/notes/0001917054/R) (Machine Translation)
- [中文](https://me.sap.com/notes/0001917054/1) (Machine Translation)
- [한국어](https://me.sap.com/notes/0001917054/3) (Machine Translation)

## References

This document does not reference or is referenced by other SAP Notes or KBAs.

## Validity

This security note is valid for the following software components:

- **BBPCRM** versions 600, 700, 701, 702, 712, 713

## Download and Print

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011320212017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001917054?language=en-US&token=A0110A1E538E7D9CC3CC3A9441E7AF4A)

## Rating

*This document has not been rated yet.*

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*