2028904 - Cross-Frame Scripting protection in SAP ABAP HTTP logon application

**SAP Security Note 2028904** addresses a vulnerability in the standard SAP logon application related to cross-frame scripting (XFS). Below are the key details:

### Description

The standard SAP logon application can be exploited by an attacker to access data entered by legitimate users across different pages of the logon application. This vulnerability leverages browser weaknesses, allowing unauthorized data access despite the Web AS ABAP not being directly vulnerable to XFS attacks. Implementing additional defenses is recommended to mitigate such risks, especially if browser vulnerabilities have not been fully resolved.

### CVSS Information

- **CVSS v3 Base Score:** 5.4 / 10
- **Vector:**
  - **Attack Vector:** Network (N)
  - **Attack Complexity:** High (H)
  - **Privileges Required:** None (N)
  - **User Interaction:** None (N)
  - **Scope:** Changed (C)
  - **Confidentiality Impact:** Low (L)
  - **Integrity Impact:** Low (L)
  - **Availability Impact:** None (N)

*Note:* The CVSS score provides an estimate of the risk but does not account for specific system configurations or environments.

### Affected Components

- **Component:** BC-MID-ICF-LGN
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** 26.11.2018

### Solution

1. **Apply Correction Instructions:**
   - Follow the attached manual correction instructions or import the corresponding support package available [here](https://me.sap.com/corrins/0002028904/41).

2. **Manual Activities:**
   - **Deactivate Default Framebust Script:**
     1. **Create New Data Element:**
        - Go to transaction code **SE11**.
        - Enter `ICFFRAMEBUSTOFF` as the data type and click **Create**.
        - Provide a short description: "Deactivate Default Frame Busting Script".
        - Set the Data Type to **CHAR** with a length of **1**.
        - Define the field labels accordingly and save and activate the data element.
     2. **Modify Structure:**
        - In transaction **SE11**, enter `ICFSYSLOGPARAMS` as the data type and click **Change**.
        - Add a new field `NODEFAULTFRAMEBUST` at the end of the structure using the newly created data element.
        - Save and activate the structure.
     3. **Configure SICF:**
        - Go to transaction **SICF**.
        - Open the relevant service or external alias.
        - Navigate to **System Login** settings.
        - Uncheck "Deactivate Default framebust" and save the changes.

*By implementing these steps, manual user login is deactivated for the corresponding service or external alias when accessed within a frame.*

### Supported Software Versions

This security note applies to various releases of the SAP_BASIS component, including:
- **6.40**
- **7.00**
- **7.01**
- **7.02**
- **7.10**
- **7.11**
- **7.20**
- **7.30**
- **7.31**
- **7.40**
- **7.50**
- **7.51 to 7.53+**

Specific support packages required for each version are detailed in the [Support Package section](https://me.sap.com/supportpackage/SAPKB64032).

### Prerequisites

- The service must be accessed without valid login credentials (e.g., no SSO ticket, no client certificate).
- The service should be configured to display the login page when no valid credentials are available.

### References

- **Referenced by:** [SAP Note 2756227 - SERVICE details not provided in note 2028904](https://me.sap.com/notes/2756227)

### Additional Information

- **Available Languages:** This note is available in multiple languages including Deutsch, Japanese, Português, Español, Français, Italiano, Русский, 中文, and 한국어. Access translations [here](https://me.sap.com/notes/0002028904/D).

### Download Links

- **Download for SNOTE:** [Download](https://me.sap.com/notes/0040000012061222017)
- **PDF Version:** [PDF](https://me.sap.com/sap/support/sfm/notes/print/0002028904?language=en-US&token=D1E6D65FDEB241E48C8AED1DA53F88D3)

---

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*