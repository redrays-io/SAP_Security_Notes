1591480 - Directory traversal in component FI-CA

## Description

**SAP Note/KBA:** 1591480  
**Type:** SAP Security Note  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 08.11.2011  
**Component:** FI-CA (Miscellaneous > Project-based solutions > Finance > obsolete: Please use Component FI-CA instead)  
**Version:** 3  
**Language:** English  

### Symptom

Potential directory traversal in the following components:

- FI-CA

### Reason and Prerequisites

The programs specified in the correction instructions contain vulnerabilities through which a malicious user can potentially read arbitrary files on the remote server, possibly disclosing confidential information.

Some of the programs specified in the correction instructions contain a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

### Solution

Implement the correction instructions relevant for your release.  
For additional information and instructions, see [Note 1497003](https://me.sap.com/notes/1497003). The corrections from Note 1497003 are a prerequisite for implementing this note.

**Logical file names used in this solution:**

- FI-CA-DTA-NAME
- FI-CA-CHECKS-EXTRACT

**Recommendations for setting up logical file names:**

To avoid maintaining a high number of logical file names, some of the programs share the same logical file name.  
Using the same logical file name for various programs creates dependencies among these programs. To securely separate data created by different users and different programs, try to create a directory structure that reflects the user name and/or program name, and use this information when setting up the physical path and file names for the logical file paths and file names.

**Programs that use these logical file names:**

- RFKKCHK01
- SAPFKPY3

## Affected Software Components

- FI-CA versions: 451, 461, 462, 463, 464, 471, 472, 600, 602, 603, 604, 605

## Support Packages

- FI-CA 464: [SAPKIPC635](https://me.sap.com/supportpackage/SAPKIPC635)
- FI-CA 471: [SAPKIPC727](https://me.sap.com/supportpackage/SAPKIPC727)
- FI-CA 472: [SAPKIPC821](https://me.sap.com/supportpackage/SAPKIPC821)
- FI-CA 600: [SAPK-60020INFICA](https://me.sap.com/supportpackage/SAPK-60020INFICA)
- FI-CA 602: [SAPK-60210INFICA](https://me.sap.com/supportpackage/SAPK-60210INFICA)
- FI-CA 603: [SAPK-60309INFICA](https://me.sap.com/supportpackage/SAPK-60309INFICA)
- FI-CA 604: [SAPK-60410INFICA](https://me.sap.com/supportpackage/SAPK-60410INFICA)
- FI-CA 605: [SAPK-60505INFICA](https://me.sap.com/supportpackage/SAPK-60505INFICA)

## Correction Instructions

- **FI-CA:** 7 correction instructions  
  [View Corrections](https://me.sap.com/corrins/0001591480/36)

## Prerequisites

Before applying this note, ensure the following notes are implemented:

- [Note 534245](https://me.sap.com/notes/534245): CR: Positive Payment interface - callup point 249 (Applicable to components FI-CA in versions 463, 464)
- [Note 1064779](https://me.sap.com/notes/1064779): PMF: Use alternative code page (FI-CA 600)
- [Note 1487491](https://me.sap.com/notes/1487491): CR: Reporting file FPCHX with voided checks only (FI-CA 600, 602, 604, 605)
- [Note 1501267](https://me.sap.com/notes/1501267): PMF: SEPA obstructive CR/LF for XML (FI-CA 600, 602, 604, 605)
- [Note 1538956](https://me.sap.com/notes/1538956): CR: FPCHX reporting file with name in case of repayments (FI-CA 600-605)

## References

- [Note 1624291: Syntax error when implementing a security note](https://me.sap.com/notes/1624291)

## Side Effects

This document is causing side effects with [Note 2375156: Message SG807 in transaction FDTA for FI-CA files](https://me.sap.com/notes/2375156).

## Additional Information

- **Download for SNOTE:** [Download](https://notesdownloads.sap.com/note/0040000009448202017)
- **PDF Version:** [Print](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001591480?language=en-US&token=8CC267624671FA747EA57E1C30C96EEB)
- **Edit Note:** [Edit](https://me.sap.com/sap/support/notes/edit/0001591480)
- **Share by Email**

## Available Languages

- Origin: Deutsch (Origin)  
  [View](https://me.sap.com/notes/0001591480/D)
- Japanese  
  [View](https://me.sap.com/notes/0001591480/J)
- Portuguese: Machine Translation  
  [View](https://me.sap.com/notes/0001591480/P)
- Spanish: Machine Translation  
  [View](https://me.sap.com/notes/0001591480/S)
- French: Machine Translation  
  [View](https://me.sap.com/notes/0001591480/F)
- Italian: Machine Translation  
  [View](https://me.sap.com/notes/0001591480/I)
- Russian: Machine Translation  
  [View](https://me.sap.com/notes/0001591480/R)
- Chinese: Machine Translation  
  [View](https://me.sap.com/notes/0001591480/1)
- Korean: Machine Translation  
  [View](https://me.sap.com/notes/0001591480/3)

*Credits: Information supported by [Redrays.io](https://redrays.io)*