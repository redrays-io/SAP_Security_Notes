SAP Security Note 1592264: Unauthorized modification of stored content in BTF-Editor

**Overview**
  
**SAP Note Number:** 1592264  
**Type:** SAP Security Note  
**Version:** 9  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** December 13, 2011  
**Component:** BC-SRV-BTF (Basis Services > Basis Services/Communication Interfaces > Business Text Framework)  
**Language:** English

**Description**

The BTF-Editor is vulnerable to abuse by malicious users, allowing unauthorized modification of application content. This can lead to the persistence of malicious content and potential theft of authentication information from legitimate users through stored cross-site scripting (XSS) attacks. If exploited, attackers can impersonate users, including administrators, potentially compromising the entire application's security.

**Affected Systems**

- **Software Component:** SAP_BASIS
- **Versions:** 620 through 731

**Impact**

- Unauthorized modification of stored content
- Persistent XSS vulnerabilities
- Potential theft of user authentication information
- Full compromise of application security if admin accounts are targeted

**Solution**

To mitigate this vulnerability, apply the necessary corrections as outlined in SAP Note 1592264. The solution involves implementing filter enhancements in the BTF-Editor to sanitize input and prevent malicious content from being stored and executed.

**Steps to Resolve:**

1. **Ensure Kernel Version:**
   - A kernel with version **6.40 or higher** must be installed. The filter functionality will not work with kernel version 6.20.

2. **Apply Support Packages:**
   - Install the appropriate support packages for your SAP_BASIS component version. Refer to the [Support Package](https://me.sap.com/supportpackage/SAPKB1592264) section below for specific packages.

3. **Import Correction Instructions:**
   - Import the correction instructions contained in [Note 1628569](https://me.sap.com/notes/1628569). This step is crucial and must be completed before performing the manual activities.

4. **Manual Activities:**
   - **Edit BSP Extension:**
     - Navigate to transaction **SE80**.
     - Choose **Workbench > Edit Object > Web Objects**.
     - Select **BSP Extension** and enter **btf**.
     - Add the following attributes to the **editor** node:
       - `filterBasedOnWhiteList` (Default: FALSE)
       - `filterReplaceDocumentOnError` (Default: TRUE)
       - `filterReplacementText` (Default: "")
   - **Update Classes:**
     - Use transaction **SE24** to modify classes `CL_BTF_BSP_MVC` and `CL_BTF_BSP_EDITOR` as per the instructions in the note.
   - **Activate Changes:**
     - After making the necessary changes, ensure all modifications are saved and activated.

For detailed step-by-step instructions, refer to the full SAP Note [1592264](https://me.sap.com/notes/1592264).

**Support Package Information**

Ensure that the relevant support packages are applied to your system based on your SAP_BASIS version:

- **SAP_BASIS 620:** [SAPKB62071](https://me.sap.com/supportpackage/SAPKB62071)
- **SAP_BASIS 640:** [SAPKB64029](https://me.sap.com/supportpackage/SAPKB64029)
- **SAP_BASIS 700:** [SAPKB70026](https://me.sap.com/supportpackage/SAPKB70026)
- **SAP_BASIS 701:** [SAPKB70111](https://me.sap.com/supportpackage/SAPKB70111)
- **SAP_BASIS 702:** [SAPKB70211](https://me.sap.com/supportpackage/SAPKB70211), [SAPKB70210](https://me.sap.com/supportpackage/SAPKB70210)
- **SAP_BASIS 710:** [SAPKB71013](https://me.sap.com/supportpackage/SAPKB71013), [SAPKB71014](https://me.sap.com/supportpackage/SAPKB71014)
- **SAP_BASIS 711:** [SAPKB71108](https://me.sap.com/supportpackage/SAPKB71108), [SAPKB71109](https://me.sap.com/supportpackage/SAPKB71109)
- **SAP_BASIS 720:** [SAPKB72006](https://me.sap.com/supportpackage/SAPKB72006), [SAPKB72007](https://me.sap.com/supportpackage/SAPKB72007)
- **SAP_BASIS 730:** [SAPKB73005](https://me.sap.com/supportpackage/SAPKB73005), [SAPKB73007](https://me.sap.com/supportpackage/SAPKB73007)
- **SAP_BASIS 731:** [SAPKB73102](https://me.sap.com/supportpackage/SAPKB73102), [SAPKB73101](https://me.sap.com/supportpackage/SAPKB73101)

**Additional Information**

- **Download for SNOTE:** [Download SNOTE](https://notesdownloads.sap.com/note/0040000009452862017)
- **PDF Version:** [PDF Download](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001592264?language=en-US&token=A21AA59F729FA170E034515C177A426E)
- **Edit Note:** [Edit Note](https://me.sap.com/sap/support/notes/edit/0001592264)
- **References:**  
  - [Note 1628569: BTF-Editor: Required correction for note 1592264](https://me.sap.com/notes/1628569)

**Translations Available:**

- Japanese, German, Portuguese, Spanish, French, Italian, Russian, Chinese, Korean (Machine Translations)

**Credits**

Thanks to [RedRays.io](https://redrays.io) for support in providing this information.