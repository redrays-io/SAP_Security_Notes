SAP Security Note 1591939 - IS-H NL: Directory/Path Traversal

**Description**

### Symptom
XX-CSC-NL-IS-H contains a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behaviour.

### Other Terms
Directory traversal, XX-CSC-NL-IS-H

### Reason and Prerequisites
XX-CSC-NL-IS-H fails to correctly validate the path to which a user-submitted file is written. As a result, a malicious user can potentially overwrite data in the remote system.

### Solution
For additional information and instructions, see [Note 1497003](https://me.sap.com/notes/1497003). The corrections from Note 1497003 are a prerequisite for implementing this note.

**Logical file names used in this solution**
The following logical file names have been used to enable the validation of the physical files:
- CL_ISH_NL_CINV_VIEWER
- CL_ISH_NL_FILE
- RNNLDIS_CZ_V5
- RNNLGGZ_DIS_V04
- RNU_NL_LOAD_DBC_COMP

To avoid maintaining a high number of logical file names, some of the programs share the same logical file name. Using the same logical file name for various programs creates dependencies among these programs. To securely separate data created by different users and different programs, try to create a directory structure that reflects the user name and/or program name, and use this information when setting up the physical path and file names for the logical file paths and file names.

**Affected Software Components**
- **IS-H:** Versions 472, 600, 602, 603, 604, 605

**Support Packages**
- **IS-H 472:** [SAPKIPHF45](https://me.sap.com/supportpackage/SAPKIPHF45)
- **IS-H 600:** [SAPK-60029INISH](https://me.sap.com/supportpackage/SAPK-60029INISH)
- **IS-H 602:** [SAPK-60218INISH](https://me.sap.com/supportpackage/SAPK-60218INISH)
- **IS-H 603:** [SAPK-60317INISH](https://me.sap.com/supportpackage/SAPK-60317INISH)
- **IS-H 604:** [SAPK-60417INISH](https://me.sap.com/supportpackage/SAPK-60417INISH)
- **IS-H 605:** [SAPK-60509INISH](https://me.sap.com/supportpackage/SAPK-60509INISH)

**Preconditions**
This note requires the following prerequisite notes:
- [Note 1625856](https://me.sap.com/notes/1625856) - IS-H NL: Various fixes GGZ DIS (Applicable to versions 600, 603, 605)
- [Note 1767513](https://me.sap.com/notes/1767513) - IS-H NL: LEGAL Requirements 2012-02 (Applicable to versions 604, 605)

**Download**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009451122017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001591939?language=en-US&token=CD82E097B98E4B809C03EBBDA693A79C)

For more details and updates, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays.io](https://redrays.io) for supporting the information provided.*