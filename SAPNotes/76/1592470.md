SAP Security Note 1592470: Directory Traversal Vulnerability in Site Master Import/Export

---

### SAP Security Note 1592470: Directory Traversal in Site Master Import/Export

**Type:** SAP Security Note  
**Priority:** Correction with high priority  
**Release Status:** Released for Customer  
**Released On:** 08.11.2011  
**Component:** IS-R-BD-SIT  
**Languages Available:** English, Deutsch (Origin), 日本語, Português, Español, Français, Italiano, Русский, 中文, 한국어

#### **Symptom**
A potential directory traversal vulnerability exists in the site master import/export functionality (IS-R-BD-SIT).

#### **Reason and Prerequisites**
The programs specified in the correction instructions contain vulnerabilities that allow a malicious user to:
- **Read Arbitrary Files:** Potentially disclose confidential information by reading arbitrary files on the remote server.
- **Write Arbitrary Files:** Possibly corrupt data or alter system behavior by writing arbitrary files on the remote server.

**Prerequisite:**  
Implement the corrections from [Note 1497003](https://me.sap.com/notes/1497003). These corrections are essential before applying this note.

#### **Solution**
1. **Apply Prerequisite Corrections:**
   - Ensure [Note 1497003](https://me.sap.com/notes/1497003) is implemented.

2. **Configure Logical File Names:**
   - **Logical File Name:** `ISR_BD_SITE_IMP_EXP_FILE`
     - **Purpose:** Enables validation of physical file names.
     - **Programs Using This Logical File Name:**
       - `RWBTRAEX`
       - `RWBTRAIM`

3. **Recommendations for Setting Up Logical File Names:**
   - **Directory Structure:** Create a directory structure that includes the user name and/or program name to securely separate data.
   - **Physical File Names:** Use predefined parameters for physical file names as documented in transaction FILE (F1 help for the physical path).

4. **Resulting File Path for Validation:**
   - **Path:** `/usr/sap/PRD/SYS/global/load`
   - **Default File Name:** `/usr/sap/PRD/SYS/global/load/BTRA`
   - **Behavior Without Physical Path Maintenance:** Defaults to `/usr/sap/trans/tmp/BTRA` with no file path check, allowing arbitrary paths.

#### **References**
- [Potential directory traversals in applications (Note 1497003)](https://me.sap.com/notes/1497003)

#### **Support Package**
Ensure that the relevant Support Packages are applied as specified in the note:

| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| SAP_APPL 40B               | SAPKH40B89      | [Link](https://me.sap.com/supportpackage/SAPKH40B89) |
| SAP_APPL 45B               | SAPKH45B67      | [Link](https://me.sap.com/supportpackage/SAPKH45B67) |
| SAP_APPL 46B               | SAPKH46B62      | [Link](https://me.sap.com/supportpackage/SAPKH46B62) |
| SAP_APPL 46C               | SAPKH46C63      | [Link](https://me.sap.com/supportpackage/SAPKH46C63) |
| SAP_APPL 470               | SAPKH47037      | [Link](https://me.sap.com/supportpackage/SAPKH47037) |
| SAP_APPL 500               | SAPKH50026      | [Link](https://me.sap.com/supportpackage/SAPKH50026) |
| SAP_APPL 600               | SAPKH60020      | [Link](https://me.sap.com/supportpackage/SAPKH60020) |
| SAP_APPL 602               | SAPKH60210      | [Link](https://me.sap.com/supportpackage/SAPKH60210) |
| SAP_APPL 603               | SAPKH60309      | [Link](https://me.sap.com/supportpackage/SAPKH60309) |
| SAP_APPL 604               | SAPKH60410      | [Link](https://me.sap.com/supportpackage/SAPKH60410) |
| SAP_APPL 605               | SAPKH60506      | [Link](https://me.sap.com/supportpackage/SAPKH60506) |

For detailed instructions and additional information, refer to the [SAP Support Portal](https://me.sap.com/notes/1592470).

---

*Credits to [redrays.io](https://redrays.io) for support to provided information.*