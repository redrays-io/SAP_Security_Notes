3503138 - [CVE-2025-0059] Information Disclosure Vulnerability in SAP NetWeaver Application Server ABAP (SAP GUI for HTML)

## Symptom

Applications based on SAP GUI for HTML in SAP NetWeaver Application Server ABAP store user input in the local browser storage to improve usability. An attacker with administrative privileges or access to the victimâ€™s user directory on the Operating System level can read this data. Depending on the user input in transactions, the disclosed data could range from non-critical to highly sensitive information, causing a high impact on the confidentiality of the application.

## Reason and Prerequisites

Accessing the input history requires strong authorizations on the client PC or server where the attacked user is working. Typically, administrative authorizations are needed, or the user must be tricked into providing access. Additionally, the input history is only stored if not deactivated by the respective application.

## Solution

SAP plans to release a suitable solution by encrypting the data stored on the client. Until this solution is released for your version of Application Server ABAP, SAP recommends reducing the risk with the following workaround.

This note will be updated once SAP releases functionality allowing encryption of the input history on the client-side.

### Workaround

Please assess the applicability of this workaround for your SAP landscape before implementation. Note that this workaround is a temporary fix and not a permanent solution.

Given the potential risk associated with storing history data on clients, it is advisable to either reduce the data retention time or deactivate the input history entirely. However, deactivating input history could diminish the user experience.

The input history can be configured for SAP GUI for HTML by adding or changing the following options for the service:

- **Disable the input history**: `~sap-disableinputhistory = 1` (see [SAP Note 2156174](https://me.sap.com/notes/2156174))
- **Reduce the retention time of the data entered by the user**: `~data_aging_default` (see [SAP Note 2660665](https://me.sap.com/notes/2660665))
- **Remove the ability to change the retention time for end users**: `~data_aging_readonly = 1` (see [SAP Note 2660665](https://me.sap.com/notes/2660665))

Additionally, some potential attack paths can be countered with general encryption of the hard drive or disk at the operating system level. This reduces the risk further, but OS-level encryption alone is not sufficient to completely mitigate the issue.

## Frequently Asked Questions (FAQs)

For questions and answers, please refer to [SAP FAQ Note 3558867](https://me.sap.com/notes/3558867).

## CVSS

- **CVSS Score**: 6.0
- **CVSS Vector**: CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N

### CVSS Metrics

- **Attack Vector (AV)**: Local (L)
- **Attack Complexity (AC)**: Low (L)
- **Privileges Required (PR)**: High (H)
- **User Interaction (UI)**: None (N)
- **Scope (S)**: Changed (C)
- **Confidentiality Impact (C)**: High (H)
- **Integrity Impact (I)**: None (N)
- **Availability Impact (A)**: None (N)

## Additional Information

- **Type**: SAP Security Note
- **Version**: 11
- **Recency**: New
- **Category**: Program error
- **Priority**: Correction with medium priority
- **Status**: Released for Customer
- **Released On**: 14.01.2025
- **Component**: Basis Components > Frontend Services  (SAP Note 1322184) > SAP GUI for HTML

## References

This document is referenced by [SAP Note 3558867](https://me.sap.com/notes/3558867) titled "Frequently Asked Questions regarding release of security notes 3472837, 3502459 and 3503138".

**Credits:** Thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.