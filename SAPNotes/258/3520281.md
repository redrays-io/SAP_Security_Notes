SAP Security Note 3520281: [CVE-2024-47590] XSS Vulnerability in SAP Web Dispatcher

**Summary**
A critical Cross-Site Scripting (XSS) vulnerability (CVE-2024-47590) has been identified in SAP Web Dispatcher. An unauthenticated attacker can exploit this vulnerability to execute arbitrary code on the server, fully compromising confidentiality, integrity, and availability. This affects several versions of SAP Web Dispatcher and SAP Kernel.

**Description**
An unauthenticated attacker can create a malicious link and trick an authenticated user into clicking it. This can lead to the execution of arbitrary code on the server through XSS (Cross-Site Scripting) or SSRF (Server-Side Request Forgery) attacks. The impact includes severe risks to confidentiality, integrity, and availability of the affected systems.

**CVSS Score**
- **Score:** 8.8
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss)

**Affected Software Components**
- **WEBDISP:** Versions 7.77, 7.89, 7.93
- **KERNEL:** Versions 7.77, 7.89, 7.93, 9.12, 9.13

**Solution**
1. **Update URL Parameters:** The URL parameters are now properly encoded to prevent XSS attacks.
2. **Apply Support Packages and Patches:** Implement the support packages and patches referenced in this SAP Security Note.

**Support Package Patches**
- **SAP KERNEL 7.93 64-BIT UNICODE:** [SP122 Patch 000122](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200018813&V=MAINT)
- **SAP WEB DISPATCHER 7.93:** [SP123 Patch 000123](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200020812&support_package=SP123&patch_level=000123)
- *(Additional patches available at [SAP Support](https://me.sap.com/))*

**Workarounds**
*Note: These are temporary fixes. SAP strongly recommends applying the official patches.*

1. **Disable the Administration UI by Removing Affected Files**
   - Delete the content of the directory `/usr/sap/<SID>/<INSTANCE>/data/icmandir/admin/`.
   
2. **Disable the Administration UI by Changing Profile Parameters**
   - Remove all `icm/HTTP/admin_x` parameters from the DEFAULT and instance profiles.
   - Set profile parameter `icm/HTTP/admin_0=` to an empty value.
   - Restart the Web Dispatcher.
   
3. **Remove the Administrative Role for All Users**
   - Replace the `admin` role with the `monitor` role for all users.

**Prerequisites**
- SAP Web Dispatcher with the administration UI enabled.
- Systems where users have authorization to use the administration UI are vulnerable.

**References**
- [FAQ for SAP Security Note 3520281](https://me.sap.com/notes/3526389)
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001268372024)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003520281?language=en-US&token=8B61ACB1118E534DCC25977539251915)

**Side Effects**
Implementing the corrections outlined in this note may affect related functionalities as referenced in SAP Notes [3556689](https://me.sap.com/notes/0003556689) and [3574006](https://me.sap.com/notes/0003574006).

**Credits**
Information supported by [RedRays](https://redrays.io).