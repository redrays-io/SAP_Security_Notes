3507545 - [CVE-2024-45278] Cross-Site Scripting (XSS) vulnerability in SAP Commerce Backoffice

## Description

**Symptom**

SAP Commerce Backoffice does not sufficiently encode user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability. After successful exploitation, an attacker can cause limited impact on the confidentiality and integrity of the application.

**Other Terms**

XSS, Stored XSS, [CVE-2024-45278](https://www.cve.org/CVERecord?id=CVE-2024-45278)

**Reason and Prerequisites**

When a user uploads an image in SAP Commerce Backoffice, there is an intermediate step during uploading. The image is stored as a temporary file with the URL. The user could directly review the uploaded image using the URL, where Content Security Policy (CSP) is not protected against XSS.

## Solution

SAP Commerce Backoffice sets a strict CSP to disable scripts when directly reviewing temporarily uploaded images.

The following patches contain the improvements:

- [SAP Commerce Cloud Patch Release 2205.29](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?locale=en-US&version=2205)
- [SAP Commerce Cloud Update Release 2211.28](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/f9b65161e1e645249542e59f42f64a7b.html?version=v2211)

The Software Downloads of these or later patches are available in the SAP Support Portal:

- [Software Downloads for SAP Commerce Cloud in the Public Cloud](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=73555000100800001224&V=MAINT&TA=ACTUAL/SAP%20COMMERCE%20CLOUD%20V2) for the customers of SAP Commerce Cloud in the Public Cloud.
- [Software Downloads for SAP Commerce On-Premise](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/%20_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL&PAGE=SEARCH/SAP%20COMMERCE) for customers who use SAP Commerce on-premise.

For information about installing patches, see [About Patch Releases](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/8c25978386691014b4abdd61376acd24.html?locale=en-US). After installing a SAP Commerce Cloud patch, customers need to rebuild and redeploy the updated SAP Commerce Cloud version.

- Customers of **SAP Commerce Cloud in Public Cloud** should follow these [build](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/79763857d2264a189cb577fc90de0fea.html) and [deploy](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/72e126a98eb14b668709be9946070e5c.html) instructions.
- Customers of **SAP Commerce On-Premise** should follow these [build and deploy instructions](https://help.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/LATEST/en-US/8bb0ad2786691014b930c18dd4cd7851.html).

## CVSS Score

**CVSS v3.0 Score:** 5.4  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N

### Metrics Breakdown

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

## Affected Software Components

- **HY_COM**: 2205
- **COM_CLOUD**: 2211

## Available Languages

- [Deutsch (Machine Translation)](https://me.sap.com/notes/0003507545/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0003507545/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003507545/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003507545/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003507545/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003507545/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003507545/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003507545/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003507545/3)

## References

- [Software Downloads](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=73555000100800001224&V=MAINT&TA=ACTUAL/SAP%20COMMERCE%20CLOUD%20V2) for SAP Commerce Cloud in the Public Cloud.
- [Software Downloads](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/%20_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL&PAGE=SEARCH/SAP%20COMMERCE) for SAP Commerce On-Premise.
- [About Patch Releases](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/8c25978386691014b4abdd61376acd24.html?locale=en-US)
- [Build Instructions for Public Cloud](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/79763857d2264a189cb577fc90de0fea.html)
- [Deploy Instructions for Public Cloud](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/72e126a98eb14b668709be9946070e5c.html)
- [Build and Deploy Instructions for On-Premise](https://help.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/LATEST/en-US/8bb0ad2786691014b930c18dd4cd7851.html)

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*