2035310 - Switchable authorization check in FI-GL-GL-ACE

**Description**

**Symptom**

An authenticated user can use functions of FI-LA to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**

- **CVSS Base Score:** 3.5
- **CVSS Base Vector:** AV:N/AC:M/AU:S/C:P/I:N/A:N

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/).

**Reason and Prerequisites**

Transactions `S_XB7_96000248`, `S_XB7_96000249`, and `S_XB7_96000239` do not sufficiently check authenticated user's authorizations. When accessing the result list, the authorization is not checked on the company code level.

**Solution**

New switchable authorization scenarios are implemented with this note. The checks are delivered inactive to avoid disruptions of your current processes. The checks can be activated in transaction `SACF`. You must have implemented the switchable authorization check framework (SACF) in your system if you want to use this check. For information about the installation of the SACF workbench, see [SAP Note 1908870](https://me.sap.com/notes/1908870).

For further information about the SACF functionality, please refer to the [SAP Online Help](http://help.sap.com/saphelp_nw74/helpdata/en/a9/a721a34a4b4e2fa5c12947022c7d76/content.htm).

**Changed Authorization Scenario(s)**

The following authorization scenarios are extended with this note and can be maintained in transaction `SACF`:

- **Scenario FI_ACE_REPORT:** With this scenario, checks on authorization objects `F_ACE_DST` and `F_ACE_PST` can be activated, improving the accuracy of authorization checks for the affected transactions.

**Affected Business Processes and Roles**

Review all roles in your system that involve the aforementioned FI-LA transactions. Extend these roles by adding the authorization objects `F_ACE_DST` and `F_ACE_PST`. After updating the roles, activate the SACF scenario.

**Activation of the Switchable Authorization Check**

After technical implementation, perform the following manual activities to activate the authorization checks:

1. **Adjust Roles:** Provide users with the necessary authorizations due to the new authorization scenario.
2. **Identify Affected Users:** Use report `RSAU_SELECT_EVENTS` to identify users requiring additional authorizations. Analyze "Events (Audit Messages)" DUO and DUP.
3. **System Trace Analysis:** For authorization scenarios with status "Active" or "Logging," use system trace transactions `STAUTHTRACE` or `ST01` to analyze authorization checks.

**Prerequisites**

Ensure the following prerequisites are met before implementing this note:

- **Software Components:**
  - EA-APPL (Releases 600 to 616)
  - EA-FIN (Releases 617 to 700)
  - SAP_BASIS (Releases 700 to 740)

Refer to the [Prerequisites Section](https://me.sap.com/notes/2035310) of the SAP Note for detailed information.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000012098382017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002035310?language=en-US&token=35F6EE9D02F42F77EB85B730C484C1C1)

**Credits**

Credits to [Redrays](https://redrays.io) for supporting the provision of this information.