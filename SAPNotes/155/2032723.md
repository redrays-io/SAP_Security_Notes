2032723 - Switchable authorization checks for RFC in SRM

**Summary**

This SAP Security Note introduces new switchable authorization checks for RFC function modules in Supplier Relationship Management (SRM). The goal is to enhance the security of remote function calls by ensuring that authorizations are appropriately restricted.

**Symptom**

Previously, remote calls to RFC function modules were protected by the `S_RFC` authorization object. However, it was identified that these checks might not be sufficient to guarantee secure execution for certain RFC function modules in SRM. This note addresses this vulnerability by implementing additional authorization checks.

**Reason and Prerequisites**

Remote Function Call (RFC) function modules require stringent authorization checks to maintain system security. The existing `S_RFC` checks were found lacking in some scenarios, necessitating the introduction of switchable authorization checks. 

**Prerequisite SAP Notes:**
- [953682 - BBP_VENDOR_SYNC: Vendor replication](https://me.sap.com/notes/953682)
- [1156536 - BBP_VENDOR_GET_LIST2: Only suppliers of type company allowed](https://me.sap.com/notes/1156536)
- [1706562 - MRP file not updated if Reservation Item deleted from SRM](https://me.sap.com/notes/1706562)
- [1744486 - Preparation to connect SAP SRM to SAP ERP 2005 EhPs](https://me.sap.com/notes/1744486)
- [1947795 - SRM Shopping Cart Item Status Issue](https://me.sap.com/notes/1947795)
- [1988903 - Check whether a function module was called via external RFC](https://me.sap.com/notes/1988903)
- [1995667 - SACF: Navigation error](https://me.sap.com/notes/1995667)

**Solution**

The note provides new switchable authorization checks that are delivered inactive by default to ensure compatibility with existing processes. To activate these checks, follow the steps below:

1. **Implement Switchable Authorization Checks:**
   - New authorization scenarios are introduced and can be activated via transaction **SACF**.
   - Detailed instructions are provided in the correction instructions attached to the note.

2. **Activation Steps:**
   - **Step 1:** Upload the scenario definition using the attached `BBP_VENDOR_GET.txt` file if it doesnâ€™t already exist in SACF.
   - **Step 2:** Create a productive authorization scenario from the scenario definition and activate it.
   - **Step 3 (Optional):** Enable logging of SACF relevant audit messages in the Security Audit Log.
   - **Step 4:** Adjust roles to provide necessary authorizations based on the new scenarios.

**Authorization Scenarios Introduced:**
- **Scenario 1:** `BBP_VENDOR_GET` - For reading vendor-specific master data.
- **Scenario 2:** `PSM_MASTERDATA` - For Public Sector Management and Funds Management master data.
- **Scenario 3:** `FI_DOC_READ` - For displaying accounting documents via RFC.

**CVSS Score**

- **Score:** 6.3
- **Vector:** `CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L`

**Attachments and References**

- **Attachments:**
  - [SU22DATA.TXT](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000651082014&iv_version=0003&iv_guid=A2ADF01435B0AB4CACBE20757D7CE225)
  - [BBP_VENDOR_GET.TXT](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000651082014&iv_version=0003&iv_guid=1333E5AE3E67E64DB0863C80F83F17A9)

- **References:**
  - [2078596 - Further improvements for RFC security](https://me.sap.com/notes/2078596)

**Support Package Information**

Ensure that the appropriate support packages are applied for your SAP components. Relevant support packages for `SAP_APPL` versions 600 to 617 are listed in the note.

**Side Effects**

This document does not solve or cause any side effects.

**Credit**

Information supported by [Redrays](https://redrays.io).