2033772 - SAP Afaria Client XeService.exe unquoted path vulnerability

**Symptom**

For versions of Windows starting with Vista and Server 2008, the XeService path in the registry is not properly quoted.

**CVSS Information**

- **CVSS Base Score:** 3.5 / 10
- **CVSS Base Vector:** AV:L/AC:H/Au:S/C:P/I:P/A:P

**Reason and Prerequisites**

The XeService image path in the client registry is not quoted. Due to how Windows launches executables, an attacker could add a program called `c:\programs.exe` and cause it to launch with elevated privileges if the client is installed under Program Files.

**Solution**

**Afaria 7 SP5**

New installations of Afaria 7 SP5 are not vulnerable.

**Afaria 7 SP4 and Upgrades to SP5**

On versions of Windows starting with Vista and Server 2008, follow these steps to resolve the vulnerability:

1. Launch `regedit` on client machines.
2. Navigate to the Afaria Client Service registry key at `HKLM\SYSTEM\CurrentControlSet\services\Afaria Client Service`.
3. Open the string value `ImagePath`.
4. If the complete path is not quoted, add quotes at the beginning and end of the path.

**Additional Information**

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your system configuration or operational environment. It is not intended to replace any risk assessments you should conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/).

**References**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017897232017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002033772?language=en-US&token=26CD6B1203F51FFB43BB459BC702CE3A)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002033772/E/diff)

Credits to [redrays.io](https://redrays.io) for support to provided information.