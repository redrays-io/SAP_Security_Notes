3268093 - [CVE-2023-0017] Improper access control in SAP NetWeaver AS for Java

## Symptom
An unauthenticated attacker can attach to an open interface and make use of an open naming and directory API to access services which can be used to perform unauthorized operations affecting users and data on the current system. This could allow the attacker to have full read access for user data, to make modifications to user data and to make particular services within the system unavailable.

## Other Terms
Broken authentication, Broken authorization, Access control, Authorization error, Authorization profile, [CVE-2023-0017](https://www.cve.org/CVERecord?id=CVE-2023-0017)

## Reason and Prerequisites
Authorization checks were not done in an appropriate manner.

## Solution
This correction discontinues public access to basicadmin and adminadapter services remote objects by introducing required authentication and authorization protection.

Apply the patches according to the Software Components and Support Packages & Patches sections of this Security Note.

Instead of relying on generic authorization checks, new service actions have been introduced for the JCo RFC Provider. Only if a user has a role assigned containing those new actions, the functionality can be used by the user. Find the list of new actions below:

- **Service:** rfcengine  
  **Action name:** read  
  **Description:** Allows to read JCo RFC Provider destination configurations.
  
- **Service:** rfcengine  
  **Action name:** write  
  **Description:** Allows to create, edit and remove JCo RFC Provider destination configurations.
  
- **Service:** rfcengine  
  **Action name:** start_stop  
  **Description:** Allows to start and stop JCo RFC Provider destinations.
  
- **Service:** rfcengine  
  **Action name:** register  
  **Description:** Allows to register and unregister functions at the JCo RFC Provider service.

The predefined roles **Administrator**, **NWA_SUPERADMIN**, and **NWA_READONLY** automatically get the required actions assigned. For custom roles, please ensure to assign the actions as required for the roles, which have to be assigned to users.

## CVSS
**CVSS Score:** 9.4  
**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** Low (L)

## References
**This document is referenced by:**
- [3312483 - Diagnostics Agent Connection Error "Root exception is java.lang.securityException: User 'Guest' is not authorized." - SAP Solution Manager 7.2](https://me.sap.com/notes/3312483)

## Side Effects
**This document is causing side effects:**
- [3291811 - Portal Runtime RFC registration fails after applying security note 3268093](https://me.sap.com/notes/3291811)

## Validity
**Software Components:**

- **Software Component:** J2EE-FRMW  
  **From:** 7.50  
  **To:** 7.50

## Support Package Patches
- [J2EE ENGINE FRAMEWORK 7.50 SP019 Patch Level 000012](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001229&support_package=SP019&patch_level=000012)
- [J2EE ENGINE FRAMEWORK 7.50 SP020 Patch Level 000010](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001229&support_package=SP020&patch_level=000010)
- [J2EE ENGINE FRAMEWORK 7.50 SP021 Patch Level 000007](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001229&support_package=SP021&patch_level=000007)
- [J2EE ENGINE FRAMEWORK 7.50 SP022 Patch Level 000007](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001229&support_package=SP022&patch_level=000007)
- [J2EE ENGINE FRAMEWORK 7.50 SP023 Patch Level 000005](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001229&support_package=SP023&patch_level=000005)
- [J2EE ENGINE FRAMEWORK 7.50 SP024 Patch Level 000003](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001229&support_package=SP024&patch_level=000003)
- [J2EE ENGINE FRAMEWORK 7.50 SP025 Patch Level 000002](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001229&support_package=SP025&patch_level=000002)
- [J2EE ENGINE FRAMEWORK 7.50 SP026 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001229&support_package=SP026&patch_level=000000)
- [J2EE ENGINE FRAMEWORK 7.50 SP027 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001229&support_package=SP027&patch_level=000000)

---

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*