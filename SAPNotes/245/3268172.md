SAP Security Note 3268172 - [CVE-2022-41264] Code Injection Vulnerability in SAP BASIS

---

**Symptom**

*Update 24th January 2023*: This note has been re-released with updated 'Correction instruction' and 'Symptom' information.

Due to the unrestricted scope of the RFC function module, SAP BASIS allows an authenticated non-administrator attacker to access a system class and execute any of its public methods with parameters provided by the attacker. On successful exploitation, the attacker can have full control of the system to which the class belongs, causing high impact on the integrity of the application.

This note is also relevant if you do not use a HANA DB on your system.

**Other Terms**

ABAP Code Injection, [CVE-2022-41264](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41264)

**Reason and Prerequisites**

Unrestricted scope of the RFC function module.

**Solution**

The correction instruction of this note simply deactivates the obsolete but critical code.

The affected function module was used for just one report in BW on HANA: The consistency check RSDU_TABLE_CONSISTENCY. Once this note has been installed, the found inconsistencies can no longer be repaired in parallel. The sequential repair of inconsistent BW tables is still possible.

Since the repair of inconsistent BW tables is only necessary in exceptional cases, the inclusion of this note has no effect on any productive business processes.

**CVSS**

- **CVSS Score:** 8.8
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** High (H)

**References**

- [SAP Security Note 3268172](https://me.sap.com/notes/3268172)

**Validity**

Applicable to the following SAP_BASIS versions:

- 731
- 740
- 750 to 757
- 789 to 791

**Support Package**

Ensure you apply the appropriate Support Package for your SAP_BASIS version:

- [SAPKB73132](https://me.sap.com/supportpackage/SAPKB73132) for SAP_BASIS 731
- [SAPKB74029](https://me.sap.com/supportpackage/SAPKB74029) for SAP_BASIS 740
- [SAPK-75026INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75026INSAPBASIS) for SAP_BASIS 750
- ...and others as listed in the note.

**Solution Steps**

1. Apply the relevant Support Package for your SAP_BASIS version as listed above.
2. Follow the correction instructions provided in the note to deactivate the obsolete code.
3. Verify the applied corrections to ensure the vulnerability is mitigated.

**Additional Information**

The correction deactivates the critical code without affecting productive business processes, as the repair of inconsistent BW tables is only necessary in exceptional cases.

**Credits**

Credits to [redrays.io](https://redrays.io) for support in providing this information.

---