1572340 - Directory traversal in PSE function modules

**Description**

**Symptom**

The function modules `SSFPSE_DOWNLOAD` and `SSFPSE_UPLOAD` contain a vulnerability through which a malicious user can potentially read, write, or delete arbitrary files on the remote server, possibly corrupting data or altering system behavior.

**Other Terms**

Directory traversal, SSFPSE_DOWNLOAD, SSFPSE_UPLOAD

**Reason and Prerequisites**

The function modules `SSFPSE_DOWNLOAD` and `SSFPSE_UPLOAD` fail to correctly validate the input parameters. As a result, a malicious user can potentially direct the program to an arbitrary other file in the system.

**Solution**

The correction restricts the function modules to PSE files. In addition, usage of these function modules is restricted to administrators.

---

**Details**

- **Number:** [1572340](https://me.sap.com/notes/0001572340)
- **Type:** SAP Security Note
- **Version:** 3
- **Recency:** New
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 09.08.2011
- **Component:** Basis Components > Security - Read [KBA 2985997](https://me.sap.com/kb/2985997) for subcomponents > Secure Store and Forward

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009327442017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001572340?language=en-US&token=C38BC4CFFE6760B0236D9DA0C1CB8601)

**Supported Software Components**

- **SAP_BASIS** versions 610 to 640
- **SAP_BASIS** versions 700 to 702
- **SAP_BASIS** versions 710 to 730

**Correction Instructions**

The note provides 2 correction instructions for SAP_BASIS. You can access them [here](https://me.sap.com/corrins/0001572340/41).

**References**

This document refers to:
- [888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

---

*Credits: Thanks to [RedRays](https://redrays.io) for support in providing this information.*