1575722 - Directory traversal in BW

**SAP Security Note 1575722 - Directory traversal in BW**

- **Type:** SAP Security Note
- **Version:** 3
- **Recency:** New
- **Language:** English (Master Language: German)
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 09.08.2011
- **Component:** SAP Business Warehouse > Business Explorer > OLAP Technology > Interface to Database

### Description

BW contains a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

**Other Terms:** Directory traversal, FILE_VALIDATE_NAME, FILE_GET_NAME, FILE, BW_RSDR, LISTCUBE, FILE_NOT_FOUND, LOGICAL_FILENAME_NOT_FOUND, DIR

**Reason and Prerequisites:**  
BW fails to correctly validate the path to which a user-submitted file is written. As a result, a malicious user can potentially overwrite data in the remote system.

### Solution

1. **Support Packages:**  
   Import the relevant Support Package for your BW system version:
   - **SAP NetWeaver BW 7.00:** Import Support Package 28 ([SAPKW70028](https://me.sap.com/supportpackage/SAPKW70028))
   - **SAP NetWeaver BW 7.01:** Import Support Package 11 ([SAPKW70111](https://me.sap.com/supportpackage/SAPKW70111))
   - **SAP NetWeaver BW 7.02:** Import Support Package 10 ([SAPKW70210](https://me.sap.com/supportpackage/SAPKW70210))
   - **SAP NetWeaver BW 7.11:** Import Support Package 8 ([SAPKW71108](https://me.sap.com/supportpackage/SAPKW71108))
   - **SAP NetWeaver BW 7.30:** Import Support Package 05 ([SAPKW73005](https://me.sap.com/supportpackage/SAPKW73005))

2. **Manual Activities:**  
   After importing the Support Package, perform the following manual configurations:
   - **Transaction `/NFILE`:**
     - **Logical File Path Definition:** Add new entries for `BW_RSDR` with the name `BW DataManager`.
     - **Assignment of Physical Paths to Logical Path:**  
       - UNIX: `/tmp/<FILENAME>`
       - WINDOWS NT: `<P=DIR_TEMP>\\<FILENAME>`
   - **Logical File Name Definition, Cross-Client:**  
     Add new entries for `BW_RSDR` with:
     - **Name:** BW DataManager
     - **Physical file:** empty
     - **Data format:** DIR
     - **Applicat.area:** BW
     - **Logical path:** BW_RSDR

**Note:**  
Before implementing the corrections, ensure that you specify the return type in transaction `/NLISTCUBE`. For example, if "Store in file (appl. server)" is selected, you can specify any directory. After applying the corrections, only the specified directories (`/tmp/<FILENAME>` for UNIX and `<P=DIR_TEMP>\\<FILENAME>` for Windows NT) can be used.

### References

- [SAP Note 1600222: SAPBWNews NW BW 7.0 ABAP SP28](https://me.sap.com/notes/1600222)
- [SAP Note 1601974: SAPBWNews NW 7.01 BW ABAP SP11](https://me.sap.com/notes/1601974)
- [SAP Note 1604436: SAPBWNews NW 7.02 BW ABAP SP10](https://me.sap.com/notes/1604436)
- [SAP Note 1510977: SAPBWNews NW BW 7.11 BW ABAP SP8](https://me.sap.com/notes/1510977)
- [SAP Note 1606526: SAPBWNews NW 7.30 BW ABAP SP05](https://me.sap.com/notes/1606526)

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009349092017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001575722?language=en-US&token=CC0BA9B7023B73BA964544D1FE8D1445)
- [Edit Note](https://me.sap.com/support/notes/edit/0001575722)

*For more information and support, visit [SAP Support](https://me.sap.com/).*

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*