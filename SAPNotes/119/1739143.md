SAP Security Note 1739143 - Possible OS Command Injection on TREX/BWA Server

```markdown
**SAP Security Note 1739143 - Possible OS Command Injection on TREX/BWA Server**

**Symptom:**
An attacker can exploit TREX/BWA by using specially crafted inputs to execute OS commands on the TREX/BWA server(s). This could lead to unauthorized data retrieval or modification.

**CVSS Information:**
- **Base Score:** 6.0
- **Vector:** AV:N/AC:M/AU:S/C:P/I:P/A:P

**Reason and Prerequisites:**
The vulnerability arises from an OS command injection flaw. TREX/BWA installations connected via RFC-connection to an ABAP system can be exploited if a user has extended authorizations (e.g., developer authorizations). Such users can execute OS commands with the permissions of the TREX/BWA administration user. However, the injection is not possible through standard user interfaces, and commands cannot exceed the administration user's authorizations.

**Solution:**

***Workaround:***
1. **Restrict User Permissions:** Limit the group of users with extended authorizations on the ABAP system connected to TREX/BWA.
2. **Limit Administration User Authorizations:** Ensure that the TREX/BWA administration user (`<sid>adm`) does not have root-level access and restrict its permissions to TREX/BWA directories only.

***Patch:***
Install the necessary revisions that enforce a whitelist for OS commands. By default, the whitelist includes characters such as `a-z, A-Z, 0-9, * ? / \ % ! ' " [ ] _ - = : ~ ` and space. To enhance the whitelist, modify the `TREXRfcServer.ini` file as follows:
1. Add a new section: `[security]`
2. Add a new parameter: `whitelist`
3. Append any additional necessary characters to the existing whitelist value.
4. Restart the RFC Server.

**Download and Documentation:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017522772017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001739143?language=en-US&token=7CB272660544C7DB2CD6554316549A7B)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001739143/E/diff)

**Valid Software Components:**
- **TREX:** 7.00, 7.10, 7.25
- **BIA:** 7.00, 7.20

**Support Package Patches:**
Ensure that you apply the relevant support package patches for your software component versions:
- [BIA 7.20 SP021](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200010786&support_package=SP021&patch_level=000021)
- [TREX 7.25 SP021](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200012228&V=MAINT)
- [TREX 7.00 SP051](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004338&V=MAINT)
- Additional patches available on [SAP Support](https://me.sap.com/)

**Additional Information:**
For more details, refer to the [SAP Security Notes](https://service.sap.com/securitynotes/).

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*
```