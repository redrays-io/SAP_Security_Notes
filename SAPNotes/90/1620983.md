SAP Security Note 1620983 - Directory traversal when creating conditions (batch input)

```markdown
**SAP Security Note 1620983**

**Title**: Directory traversal when creating conditions (batch input)

**Description**:

Creating a batch input session for condition records (report RV14BTCI) contains a vulnerability through which an attacker can potentially read arbitrary files on the remote server, possibly disclosing confidential information.

**Other Terms**:
- Directory traversal
- RV14BTCI
- RVBTCI01
- RVBTCI02
- Condition technique
- Condition maintenance
- Condition records
- OPEN DATASET
- CONDITION_BATCH_ROOT
- CONDITION_BATCH_FILENAME

**Reason and Prerequisites**:

The report RV14BTCI fails to correctly validate the path that is used to reference a file that is read from the remote server. As a result, an attacker can potentially direct the program to an arbitrary other file in the system, disclosing its contents.

**Solution**:

For additional information and instructions, see [Note 1497003](https://me.sap.com/notes/1497003) and [Note 1605703](https://me.sap.com/notes/1605703). The corrections from these notes are a prerequisite for implementing this note.

**Manual Correction Steps**:

1. Call transaction `FILE`.
2. In the tree, select **Logical File Path Definition** and choose **New Entries**.
3. Enter the logical file path `CONDITION_BATCH_ROOT` with the name "Condition records - file path".
4. Save your new entry.
5. In transaction `FILE`, select **Logical File Name Definition, Cross-Client** and choose **New Entries**.
6. Enter the following values:
   - **Logical file**: `CONDITION_BATCH_FILENAME`
   - **Name**: Condition records - file name for batch file
   - **Data format**: DIR
   - **Application area**: SD
   - **Logical path**: `CONDITION_BATCH_ROOT`
7. Save your new entry.

**References**:

- [Note 1605703 - RSFILECR: Potential directory traversals in applications](https://me.sap.com/notes/1605703)
- [Note 1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Download**:

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009626532017)

**Print**:

- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001620983?language=en-US&token=44C60B8DD9EA88C8E79FE341179567C1)

**Prerequisites**:

Ensure that [Note 993499](https://me.sap.com/notes/993499) is implemented.

**Affected Software Components**:

| Software Component | From | To   |
|--------------------|------|------|
| SAP_APPL           | 31I  | 31I  |
| SAP_APPL           | 40B  | 40B  |
| SAP_APPL           | 45B  | 45B  |
| SAP_APPL           | 46B  | 46B  |
| SAP_APPL           | 46C  | 46C  |
| SAP_APPL           | 470  | 470  |
| SAP_APPL           | 500  | 500  |
| SAP_APPL           | 600  | 600  |
| SAP_APPL           | 602  | 602  |
| SAP_APPL           | 603  | 603  |
| SAP_APPL           | 604  | 604  |
| SAP_APPL           | 605  | 605  |
| SAP_APPL           | 606  | 606  |

**Support Package Information**:

Ensure that the relevant support packages for your software components are applied as listed in the note.

**Credits**:

Supported by [redrays.io](https://redrays.io) for providing the information.

```