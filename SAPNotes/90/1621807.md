1621807 - Potential directory traversal in the FRP administration

**Description**

This SAP Security Note addresses a potential directory traversal vulnerability in the FRP (Forecasting and Replenishment) administration of the Supply Chain Management (SCM) system. A malicious user could exploit this vulnerability to write arbitrary files on the remote server, potentially corrupting data or altering system behavior.

**Symptoms**

- Potential directory traversal in the FRP administration.

**Reason and Prerequisites**

The vulnerability arises because the program specified in the correction instructions does not properly validate the file path. Although the file path is determined using the system variable `<DIR_GLOBAL>` and cannot be changed in transaction `/FRE/FRP_ADMIN`, insufficient validation allows access to unauthorized directories.

**Affected Components**

- **Component:** SCM-FRE-FRP (Supply Chain Management > Forecasting and Replenishment > FRP Functions)

**Affected Versions**

- SCM 500
- SCM 510
- SCM 700
- SCM 701
- SCM 702
- SCM 712

**Solution**

The issue is mitigated by ensuring that only authorized directories are accessible during file operations in transaction `/FRE/FRP_ADMIN`. The correction ensures that before writing a file, the file path undergoes a validation process to prevent access to directories outside the intended path.

**Correction Instructions**

1. **Access Transaction SE38:**
   - Execute transaction `SE38` in your SAP system.

2. **Run the Program:**
   - Enter the program name `/FRE/SAPLFU_FRP_MID` and execute.

3. **Modify Text Elements:**
   - Select "Text elements" from the menu.
   - Choose "Change" to edit the text symbols.

4. **Update Text Symbol:**
   - Navigate to the "Text Symbols" tab.
   - Enter the following details:
     - **Number:** 022
     - **Text:** No valid FRP basic path
     - **Length:** 23
     - **Maximum Length:** 64

5. **Save and Activate:**
   - Save your changes and activate the text elements to apply the correction.

For detailed instructions, refer to the [Correction Instructions](https://me.sap.com/corrins/0001621807/418).

**Download and Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010052592017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001621807?language=en-US&token=6F90809D01ED713D9808CD8ABF8BF201)

**Additional Information**

- **Recency:** New
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 13.12.2011

For further details, visit the [SAP Support Portal](https://me.sap.com/servicessupport/knowledge).

**Credits**

Information provided with support from [RedRays](https://redrays.io).