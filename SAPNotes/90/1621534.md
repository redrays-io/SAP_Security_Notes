1621534 - Untrusted XML input parsing possible in SPML Service

**SAP Note Number**: 1621534  
**Type**: SAP Security Note  
**Version**: 4  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with high priority  
**Release Status**: Released for Customer  
**Released On**: 11.09.2012  
**Component**: Basis Components > NetWeaver Application Server Java > Security, User Management > User Management Engine  

### Description
A malicious user can modify an XML-based request to include XML content that is then parsed locally. This could allow a malicious user to perform a denial of service (DoS) on the parsing system, disclose local data returned in the response to the malicious request, or access further network-located resources accessible from the parsing system.

**CVSS Information**  
- **Base Score**: 4.9  
- **Vector**: AV:A/AC:M/AU:S/C:P/I:P/A:P  

**Other Terms**: XXE, XML eXternal Entity, information disclosure, denial of service, DoS, SPML  

### Reason and Prerequisites
The issue is caused by a program error in the SPML (Service Provisioning Markup Language) service of SAP NetWeaver Application Server Java due to the incorrect use of an XML parser. By default, the parser opens external entities referenced within an XML input, which can lead to malicious content being parsed. This malicious content can reference internal resources, such as files, which can be disclosed in the response or used to perform a denial of service attack, rendering application content temporarily unavailable.

### Solution
Apply the provided patches to your SAP NetWeaver Application Server Java.  

**Download Links**:  
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017293722017)  
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001621534?language=en-US&token=06369B63F17DDC4BE2A728FB3BE27CBC)  

### Affected Software Components
- **SAP-JEE**: 6.40  
- **SAP_JTECHS**: 6.40 to 7.02  
- **UMEADMIN**: 7.00 to 7.31  

_For a complete list of supported packages and patches, refer to the [Support Package Patches](https://me.sap.com/) section._

### Attributes
- **Externally Reported**: Yes

_Credits to [RedRays](https://redrays.io) for support in providing the information._