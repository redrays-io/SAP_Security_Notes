2777910 - [CVE-2019-0327] Unrestricted File Upload vulnerability in SAP NetWeaver AS Java (Web Container)

**SAP Note:** [2777910 - CVE-2019-0327](https://me.sap.com/notes/2777910)  
**Type:** SAP Security Note  
**Version:** 10  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 09.07.2019  
**Component:** Basis Components > NetWeaver Application Server Java > Web Container, HTTP, JavaMail, Servlets

### Symptom
AS Java Web Container allows an attacker to upload files (including script files) without proper file format validation.

Some well-known impacts of Unrestricted File Upload vulnerability are:
- Malicious file insertion or modification
- Making the website vulnerable to other attacks such as Cross-Site Scripting (XSS)

### Other Terms
Upload of untrusted files, File upload vulnerability, SAP NetWeaver AS Java (Web Container), [CVE-2019-0327](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0327)

### Reason and Prerequisites
The AS Java Web Container provides a default implementation of the PUT method of HTTP 1.1. The Web Container offers default protection for this method, allowing only the Administrator group of users to perform PUT requests. PUT method configuration is defined in the `global-web.xml` deployment descriptor.

### Solution
To disable the default Web Container HTTP 1.1 PUT method implementation, update your AS Java to a Support Package (SP) or release where the functionality is turned off. Refer to the "Support Packages & Patches" section of this SAP Note for details and available patches.

For previous releases, you can manually disable the functionality by following KBA [1975430 - How to disable PUT method for Java Engine Web Container](https://me.sap.com/notes/1975430).

**Note:** Enabling the default Web Container HTTP 1.1 PUT method implementation is not recommended. Applications requiring PUT method functionality should implement their own `doPut()` method within the servlet, ensuring proper file format validation and appropriate user authorization.  
Please refer to the Servlet 2.5 API for more details on implementing the `doPut()` method and corresponding security constraints.

### CVSS
**Score:** 5.9  
**Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:L)  
- **Attack Vector (AV):** Network (N)  
- **Attack Complexity (AC):** Low (L)  
- **Privileges Required (PR):** High (H)  
- **User Interaction (UI):** Required (R)  
- **Scope (S):** Changed (C)  
- **Confidentiality Impact (C):** Low (L)  
- **Integrity Impact (I):** Low (L)  
- **Availability Impact (A):** Low (L)

### References
- [How to disable PUT method for Java Engine Web Container](https://me.sap.com/notes/1975430)
- [Central note for SAP NetWeaver 7.31 SP26 Application Server Java](https://me.sap.com/notes/2842655)
- [Central note for SAP NetWeaver 7.31 SP25 Application Server Java](https://me.sap.com/notes/2782185)

### Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001232752019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002777910?language=en-US&token=1D03F85C09285ECB1337AF07CA52A736)

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*