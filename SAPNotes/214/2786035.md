2786035 - [CVE-2019-0344] Code Injection vulnerabilities in SAP Commerce Cloud (mediaconversion and virtualjdbc extension)

## Overview

This SAP Security Note addresses two critical Remote Code Execution (RCE) vulnerabilities identified in SAP Commerce Cloud (previously SAP Hybris Commerce). These vulnerabilities pose significant security risks, including unauthorized command execution, sensitive data disclosure, and potential denial of service.

## Vulnerabilities

### Virtualjdbc Extension
- **Description:** Allows an attacker to inject and execute arbitrary code within the application.
- **Affected Versions:** Up to including 6.3.0.28 (EOL), 6.4.0.22, 6.5.0.19, 6.6.0.16, 6.7.0.13, 1808.8, 1811.4.
- **CVE Identifier:** [CVE-2019-0344](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0344)
- **CVSS Score:** 9.0 (Critical)
  - **Vector:** CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H

### Mediaconversion Extension
- **Description:** Enables authenticated users to inject and execute code, allowing control over application behavior.
- **Affected Versions:** Up to including 6.3.0.30 (EOL), 6.4.0.24, 6.5.0.21, 6.6.0.19, 6.7.0.17, 1808.12, 1811.8, 1905.0.
- **CVE Identifier:** [CVE-2019-0343](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0343)
- **CVSS Score:** 8.0 (High)
  - **Vector:** CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H

## Affected Components
- **Component:** Customer Engagement and Commerce > SAP Commerce > SAP Commerce > Cockpits & hMC (CEC-COM-CPS-CKP)
- **Versions:** 6.4 to 6.7, 1808, 1811, 1905

## Solution

### Update to Latest Patch
- **Action:** Update to the latest patch release of SAP Commerce Cloud to fix both vulnerabilities.
- **Download Links:**
  - [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001462042019)
  - [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002786035?language=en-US&token=80C7551253829E18A50AEB52FDDDF8D3)
- **Additional Resources:** 
  - [Software Downloads for SAP Hybris Commerce](https://me.sap.com/#/softwarecenter/template/products/%20_APP=00200682500000001943&_EVENT=DISPHIER&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL)
  - [Update Procedure for SAP Commerce Cloud Patch Releases](https://help.hybris.com/1811/hcd/8c25978386691014b4abdd61376acd24.html)

**Caution:** After applying the patch, some Mediaconversion "Conversion Command" parameters may require whitelisting. Refer to the [Mediaconversion Documentation](https://me.sap.com/viewer/d0224eca81e249cb821f2cdf45a82ace/1811/en-US/8bedccfd866910149ccbb7fbabcf2349.html) for guidance.

### Alternative Solution
If updating is not feasible, you can temporarily mitigate the vulnerabilities by uninstalling the Virtualjdbc and Mediaconversion extensions. **Note:** This may affect integrations dependent on these extensions.

## Credits
Thanks to [Redrays](https://redrays.io) for supporting the provision of this information.