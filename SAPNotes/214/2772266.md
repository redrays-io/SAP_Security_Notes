2772266 - [CVE-2019-0307] Information Disclosure in Solution Manager 7.2 (Diagnostics Agent)

**SAP Security Note 2772266 Overview**

**Title:** [CVE-2019-0307] Information Disclosure in Solution Manager 7.2 (Diagnostics Agent)

**Description:**
Solution Manager 7.2 Diagnostics Agent stores several credentials unencrypted, including the SLD user connection and Solman user communication. These credentials are accessible by the Diagnostic Agent user (`<SID>adm`).

**Impacts Include:**
- Loss of information and system configuration confidentiality
- Information gathering for further exploits and attacks

**Reason and Prerequisites:**
In version 7.1, the Diagnostics Agent could be configured to use basic authentication to connect to the Solution Manager. The credentials for this technical user are stored in the `configuration/secstore.properties` file and are not deleted upon upgrade, making them readable by users with `<SID>adm` privileges.

**Solution:**
Upgrade to Support Package 9 (SP9). This update removes the mentioned users and addresses the credential storage issue.

For additional data encryption, SP9 introduces a new mechanism:
1. **Shut down the Diagnostics Agent.**
2. **Add the parameter** `smd.agent.encrypt.secstore=true` **to the** `SMDAgent/configuration/runtime.properties` **file.**
   - **If running on SAP JVM 8:**
     - Restart the Agent. The `secstore.properties` file should now be encrypted, and a `master.password` file will be created. Both files should only be readable and writable by the `<SID>adm` user.
     - If this fails, manually create a new `secstore`.
   - **If running on SAP JVM 6:**
     - Manual migration steps are required:
       1. Delete the `SMDAgent/configuration/secstore.properties` file.
       2. Use the `smdsetup.sh` script to configure all required properties.
       3. Start the SMDAgent.
       4. In Agent Administration, go to the Agents â†’ Non-authenticated Agents tab.
       5. Select your agent and click **Trust Agent**.
       6. Ensure the `secstore.properties` and `master.password` files exist and are only readable and writable by the `<SID>adm` user.

**CVSS Score:** 3.4 (Low)

**Affected Component:** Agent Framework (SV-SMG-DIA-SRV-AGT)

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001047882019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002772266?language=en-US&token=6F4B4B487E207B2D55069F7E0FDE4AF6)
- [Support Package Patch SP009](https://notesdownloads.sap.com/note/0040000001047882019)

**Credits:** Thanks to [Redrays.io](https://redrays.io) for supporting information.