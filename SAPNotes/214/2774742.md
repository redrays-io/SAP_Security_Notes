2774742 - Cross-Site Scripting (XSS) vulnerability in ABAP Server and ABAP Platform

### Symptom
ABAP Server and ABAP Platform do not sufficiently encode user-controlled inputs, resulting in Cross-Site Scripting (XSS) vulnerability.

Some well-known impacts of XSS vulnerability are:
- Non-permanently deface or modify displayed content from a website
- Steal authentication information of the user, such as data relating to their current session
- Impersonate the user and access all information with the same rights as the target user

### Other Terms
XSS, reflected XSS, CSS

### Reason and Prerequisites
Content requested from the browser application and retrieved from content management may fail to mark content correctly for the browser, and as such might be activated and executed immediately by the browser.

Previously, the content management system used the Response header parameter `<Content-Disposition>` with the value `inline` for files sent to the browser. This behavior was seen as insecure.

With this SAP Security Note, a new feature is provided that allows customers to decide between the `inline` and `attachment` label. The label to be used is configurable.

### Solution
With the correction provided, the content management system supports the response parameter `Content-Disposition` with the value `attachment` for files retrieved.

Customers may revert to the formerly used label `inline` at their own risk by following the steps below.

**ABAP Server versions 7.00 to 7.50:**
1. Execute Transaction SE11
2. Select 'Domain'
3. Enter Domain name `SDOK_PFNAM`
4. Go to the tab 'Value Range'
5. Add a new value `CNTDISP`
6. Short Description: `Content Disposition (inline or attachment)`

**ABAP Platform versions 7.51 to 7.53:**
1. Execute the Transaction SE16
2. Table Name: `SDOKPROF`
3. Maintain an entry in the table with the following Key:
   - NAME: `CNTDISP`
   - VALUE: `attachment`

**Manual Post-Implementation Steps:**
You have to perform this manual post-implementation step manually and separately in each system **after** you have imported the Note to implement.

1. Execute Transaction SE16
2. Table Name: `SDOKPROF`
3. Add an entry with:
   - NAME: `CNTDISP`
   - VALUE: `attachment`

### CVSS
**Score:** 6.1  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** None (N)
- **User Interaction:** Required (R)
- **Scope:** Changed (C)
- **Confidentiality Impact:** Low (L)
- **Integrity Impact:** Low (L)
- **Availability Impact:** None (N)

### Additional Information
- **Download for SNOTE:** [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001232742019)
- **PDF Version:** [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002774742?language=en-US&token=6080BFEFFDA947B3282F011CB52844E5)

### Validity
Applicable to the following SAP_BASIS versions:
- 700 to 753

### Support Package
Various support packages are available for different versions. Please refer to the [Support Package](https://me.sap.com/supportpackage/SAPKB2774742) for more details.

---

*Credits to [redrays.io](https://redrays.io) for support to provided information.*