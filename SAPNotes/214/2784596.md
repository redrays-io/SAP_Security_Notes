2784596 - Cross-Site Request Forgery (CSRF) vulnerability in Run Compliance Report

### Symptom
**UPDATE 8th March 2022**: This note has been re-released with updated 'Correction instruction' information. We have limited the validity of the prerequisite note 2637403 to SP0.

Run Advanced Compliance Report allows an attacker to trick an authenticated user into sending unintended requests to the web server. This vulnerability is due to insufficient CSRF protection.

**Impacts of CSRF vulnerability:**
- Attacker could take actions on behalf of an authenticated user
- Loss of non-repudiation

### Other Terms
Open redirect, cross-site redirect, cross-domain redirect, XSRF, session riding, ACR, SRF, SAP S/4HANA for advanced compliance reporting, Run Compliance Reports, Run Advanced Compliance Reports, Function imports, httpMethod, F1515, document and reporting compliance, statutory reporting

### Reason and Prerequisites
Few function imports as part of OData services were discovered to be vulnerable to CSRF.

### Solution
- Changed HTTP method types from 'GET' to 'POST' for the identified function imports.
- Proper utilization of the XSRF protection framework, ensuring correct authentication tokens are present.

**Installation Recommendations:**
SAP recommends installing solutions by applying a Support Package. If an earlier installation is necessary, use the Note Assistant to implement the correction instruction. More information about the Note Assistant can be found on the [SAP Service Marketplace](https://me.sap.com/service.sap.com/note-assistant).

### Download and Print
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001803362019)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002784596?language=en-US&token=8E8C337D908F6027B2FEB4E44B07BD3B)

### CVSS Details
**CVSS Score:** 4.2  
**Vector:** CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:L

**Metrics:**
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** High (H)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** None (N)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

### Additional Information
- **Type:** SAP Security Note
- **Version:** 3
- **Release Status:** Released for Customer
- **Released On:** 08.03.2022
- **Component:** Financial Accounting > Country/Region-Specific Localizations > Statutory Reporting > Run Time

For more details, visit the [SAP Support Portal](https://me.sap.com/notes/0002784596).

**Credits:** Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.