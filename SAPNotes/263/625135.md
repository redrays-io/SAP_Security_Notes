CRM ABAP Solution Vulnerability: Unauthorized Display of Sales Orders

**Summary**

A security vulnerability has been identified in the CRM-ISA component of SAP Internet Sales applications, specifically affecting both B2C and B2B scenarios under certain configurations. This issue allows an internet user to view all sales orders within the system, potentially exposing sensitive customer information.

**Details**

- **SAP Note Number:** [625135](https://me.sap.com/notes/625135)
- **Title:** CRM ABAP solution: Display orders of other users possible
- **Type:** SAP Security Note
- **Priority:** HotNews
- **Status:** Released for Customer
- **Released On:** October 8, 2009

**Affected Components**

- **Component:** [CRM-ISA (Customer Relationship Management > Internet Sales)](https://me.sap.com/servicessupport/knowledge)
- **Versions Impacted:**
  - BBPCRM 20B to 20C
  - BBPCRM 300 to 300
  - BBPCRM 310 to 310
  - BBPCRM 400 to 400

**Symptom**

Due to a program error, an internet user can display all sales orders in the system:

- **Java-based SAP Internet Sales Application:** Affects B2C scenario.
- **ITS-based SAP Internet Sales Application:** Affects both B2C and B2B scenarios if the `~multiinstanceservices` parameter is set to '0' in the service file (`<ITS-Instanz>\services\isas of2c.srvc` for isas of2b or global), as detailed in [Note 416209](https://me.sap.com/notes/416209).

**Cause**

The vulnerability is caused by a program error that fails to restrict access to sales documents based on the logged-in user.

**Solution**

The issue is addressed by implementing corrections that prevent the display of sales documents not belonging to the logged-in internet user. The solution is included in the following support packages:

- **CRM 2.0b:** Support Package 30 and later
- **CRM 2.0c:** Support Package 23 and later
- **CRM 3.0:** Support Package 16 and later
- **CRM 3.1:** Support Package 6 and later
- **CRM 4.0:** Support Package 2 and later

Alternatively, you can implement the attached corrections provided in the SAP Note.

**Download and Resources**

- [Download for SNOTE](https://me.sap.com/notes/0040000003243822017)
- [PDF Version](https://me.sap.com/support/sfm/notes/print/0000625135?language=en-US&token=1483A53D03824B36898555E070C4626E)

**References**

- [646140: Security Check of Internet Sales](https://me.sap.com/notes/646140)
- [624393: Sales Order of Other Users Can Be Displayed](https://me.sap.com/notes/624393)

**Further Information**

For more details and updates, visit the [SAP Support Portal](https://me.sap.com/).

---

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*