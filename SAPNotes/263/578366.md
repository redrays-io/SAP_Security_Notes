578366 - EP 5.0 Parser for Client Certificate

**SAP Note/KBA:** 578366  
**Type:** SAP Security Note  
**Version:** 2  
**Recency:** New  
**Language:** English  
**Category:** Customizing  
**Priority:** Correction with low priority  
**Status:** Released for Customer  
**Released On:** 08.10.2009  
**Component:** Enterprise Portal > SAP Enterprise Portal (On Premise) > Security > Authentication

### Title
**578366 - EP 5.0 Parser for Client Certificate**

### Description

#### Symptom
In this note, you can find additional information on how to configure the parser for client certificates in the Enterprise Portal 5.0 SP5 and higher.
See also the documentation on the Help Portal at [Enterprise Portal Administration Guide](http://help.sap.com) under User Management → Configuration of User Management and Security → Defining Parser for Client Certificates.

#### Other Terms
parser, authentication, X.509 digital certificate, client certificate

#### Reason and Prerequisites
Up to and including EP 5.0 SP4, when a user logged on to the portal with a client certificate, the client parser took the CN of the X.500 name of the certificate owner and used this as the portal user. For example, if the X.500 name of the certificate was 'CN=Smith, OU=Marketing, O=MyCompany Ltd., C=DE', this certificate would be mapped to the portal user 'Smith'.

This parser can lead to insufficient security as the CN alone is used to determine the user. It would, for example, be possible for two people to obtain a certificate with CN=Smith from two different certification authorities (CAs). In the same way, two people from different countries or even just different organizational units in the same company could obtain a certificate with CN=Smith from the same certification authority. In all cases, the users would be mapped to the portal user Smith. This could lead to unauthorized users gaining access to the Enterprise Portal.

#### Solution
As of EP 5.0 SP5, the Enterprise Portal is shipped with a new parser that solves this problem. The new parser can be configured using entries in the Windows registry to further restrict the users that are accepted by the parser.

Create the following entries in the current user management configuration in the Windows registry:

- **"Certificate Params"**: Contains value for which the parser checks in the certificate owner's name. For example, if you set the value to 'O=MyCompany', only certificate owner names with this entry, for example 'CN=Smith, OU=Marketing, O=MyCompany, C=DE' will be allowed access to the portal. A certificate with a certificate owner such as 'CN=Smith, OU=Marketing, O=Hacker Ltd., C=DE' will not be allowed access to the portal.

**Note:** The parser searches the certificate owner's name for the exact string in "Certificate Params". For this reason, you should take great care with spaces, commas, and so on. Examples of valid values for "Certificate Params" are:
- 'OU=Marketing, O=MyCompany'
- 'OU=Marketing, O=MyCompany, C=DE'

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000015335632017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0000578366?language=en-US&token=542590D9FDE8C9DD7AEB2899FE4D7E26)
- [Share by Email](https://me.sap.com/notes/0000578366/share)
- [Open in New Window](https://me.sap.com/notes/0000578366/open)

### References
- **This document refers to:**  
  - [448831 - EP 5.0: Central Note for EP-PIN-SEC (Security)](https://me.sap.com/notes/448831)

### Translations
Available in:
- [Deutsch](https://me.sap.com/notes/0000578366/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0000578366/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0000578366/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0000578366/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0000578366/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0000578366/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0000578366/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0000578366/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0000578366/3)

**Credits:** Thanks to [RedRays](https://redrays.io) for supporting the provision of this information.