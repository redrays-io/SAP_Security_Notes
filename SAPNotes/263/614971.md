614971 - GW: Changes to the ACL list of the gateway (secinfo)

**SAP Security Note 614971 Overview**

**Title:** GW: Changes to the ACL list of the gateway (secinfo)

**Description:**
In the `secinfo` file, external programs that can be started or registered on the gateway are defined. Up to Kernel Release 46D, this was managed within the `secinfo` file. However, starting from Release 6.40, the registration of external server programs is controlled using a separate `reginfo` file. 

**Key Points:**
1. **File Definitions:**
   - **secinfo:** Defines which external programs may be started.
   - **reginfo:** Controls the registration of external server programs.

2. **System Behavior:**
   - If the `reginfo` file does not exist, the system starts all external programs.
   - If the `reginfo` file exists but is empty or contains invalid lines, no external programs can be started.
   - To start an external program, a valid entry must exist in the `reginfo` file. Otherwise, the system will reject the request with an authorization error.

3. **Configuration Recommendations:**
   - **Entry Syntax:** Each line in the `reginfo` file must include `USER`, `HOST`, and `TP` (program ID).
   - **Wildcards:** Allowed for dynamic program IDs (e.g., `TP=XYZ*`).
   - **Case Sensitivity:** Keywords must be in uppercase (e.g., `HOST` is correct; `host` is incorrect).
   - **Host and User Specifications:** Detailed guidelines on specifying hostnames, IP addresses, and user names for enhanced security.

**Solution:**
Ensure all entries in the `reginfo` file adhere to the required syntax and include all necessary keywords in uppercase. Refer to [Note 1298433](https://me.sap.com/notes/1298433) for details on how lines without `USER-HOST` are treated in relevant patch levels.

**Valid From:**
- SAP_BASIS 46B to 46D+
- SAP_BASIS 620 to 640+

**Support Package Patches:**
Applicable patches are available for various SAP Kernel versions. For more details and to download the relevant patches, visit the [SAP Support Package Page](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004059&V=MAINT).

**References:**
- [Note 1503858](https://me.sap.com/notes/1503858) - Colored lines for sec(-reg) info test in SMGW
- [Note 1473017](https://me.sap.com/notes/1473017) - Uppercase/lowercase in the files reg_info and sec_info
- [Note 1425765](https://me.sap.com/notes/1425765) - Generating sec_info reg_info
- [Note 1408081](https://me.sap.com/notes/1408081) - Basic settings for reg_info and sec_info
- [Note 1298433](https://me.sap.com/notes/1298433) - Bypassing security in reginfo & secinfo
- [Note 750877](https://me.sap.com/notes/750877) - Prefix for program ID for start using BACK destination
- [Note 618516](https://me.sap.com/notes/618516) - Security-related enhancement of RFCEXEC program

**Additional Actions:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000015439572017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0000614971?language=en-US&token=A129BB0779941EFE1801E23681473395)
- [Show Changes](https://me.sap.com/notesLatestChanges/0000614971/E/diff)

For more detailed information, please refer to the full SAP Security Note [614971](https://me.sap.com/notes/614971).

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*