SAP Security Note 2216869 - Security improvement of HANA authentication

**Description**

SAP Security Note 2216869 addresses security enhancements in SAP HANA authentication handling introduced in revision 102. These improvements aim to mitigate risks associated with brute-force attacks and detailed error message disclosures.

**CVSS Information**

- **Base Score:** 4.3 / 10
- **Attack Vector:** Network (N)
- **Access Complexity:** Medium (M)
- **Authentication Required:** None (N)
- **Confidentiality Impact:** Partial (P)
- **Integrity Impact:** None (N)
- **Availability Impact:** None (N)

**Affected Components**

- **Component:** SAP HANA Security & User Management (HAN-DB-SEC)
- **Release Date:** October 13, 2015
- **Priority:** Correction with high priority
- **Status:** Released for Customer

**Solution**

Starting with SAP HANA revision 102, two new parameters have been introduced to enhance security:

1. **`password_lock_for_system_user`**
   - **Default Value:** `true`
   - **Function:** Locks the SYSTEM user account after a specified number of failed login attempts, as defined in the password policy. This prevents brute-force attacks targeting the SYSTEM user.
   - **Note:** Setting this parameter to `false` retains the old behavior, which is not recommended.

2. **`detailed_error_on_connect`**
   - **Default Value:** `false`
   - **Function:** Returns a generic "authentication failed" message for all failed login attempts, avoiding the disclosure of specific reasons like "user is locked" or "user is deactivated."
   - **Note:** Setting this parameter to `true` will enable detailed error messages, which is not recommended.

These parameters can be configured in the `[password_policy]` section of the `indexserver.ini` or `nameserver.ini` files.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018165292017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002216869?language=en-US&token=DCF46E9AFC91EABAFDD24E2E92A24192)

**References**

This document is referenced by:
- [SAP Security Note 2736167 - How to unlock/reactivate the SYSTEM user on SAP HANA?](https://me.sap.com/notes/2736167)
- [SAP Security Note 2377375 - SAP HANA 1 SPS11 Revision 112.07](https://me.sap.com/notes/2377375)
- [SAP Security Note 2354030 - SAP HANA 1 SPS11 Revision 112.06](https://me.sap.com/notes/2354030)
- *(Additional references can be added similarly)*

For more detailed information, please refer to the official [SAP Security Notes](https://me.sap.com/).

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*