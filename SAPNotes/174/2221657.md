2221657 - Code injection vulnerability in SAP Internet Communication Manager

**Symptom**

SAP Internet Communication Manager (ICM) contains code that enables the execution of arbitrary program code of the user's choice. An attacker can control system behavior or escalate privileges by executing malicious code without legitimate credentials.

**Solution**

Enable input validation for the HOST field of HTTP requests by setting the profile parameter `icm/HTTP/allow_invalid_host_header` to `FALSE` using transaction `RZ11`. This validation checks for duplicate HOST fields and syntactically incorrect values. Invalid requests are rejected with HTTP Code `400`.

The solution is delivered with the patch level mentioned in this SAP Note.

**Download and Print**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018172952017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002221657?language=en-US&token=CFB8F21F3584C388880E2E5CD8D33CF0)

**Related Notes**

- [2325470 - Allow empty Host header even when icm/HTTP/allow_invalid_host_header=FALSE](https://me.sap.com/notes/2325470)

**Additional Information**

- **Number**: 2221657
- **Type**: SAP Security Note
- **Version**: 1
- **Category**: Program error
- **Priority**: Correction with medium priority
- **Status**: Released for Customer
- **Released On**: 12.04.2016
- **Component**: Basis Components > Client/Server Technology > Internet Communication Manager

**Credits**

Information provided with support from [Redrays.io](https://redrays.io).