1659640 - Security: XSS vulnerability in SAP GUI for HTML

**Description**

**Symptom**

The Webdynpro component `HAPCN_CONSOLIDATE_UI` can be exploited by a malicious user, allowing unauthorized modification of displayed application content and the potential retrieval of authentication information from other legitimate users.

**Other Terms**

Cross-site scripting (XSS), PA-PA-CN, HAPCN_CONSOLIDATE_UI

**Reason and Prerequisites**

The Webdynpro Page (`W-MAIN`) within `HAPCN_CONSOLIDATE_UI` does not sufficiently encode output parameters, resulting in a cross-site scripting vulnerability. This can be exploited to steal another user's authentication information, such as session data. A malicious user obtaining this data may impersonate the user and access all information with the same permissions. If an administrator is impersonated, the security of the entire application may be compromised.

**Solution**

Apply this SAP Note [1659640](https://me.sap.com/notes/1659640) or import the changes via the relevant support package.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009854902017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001659640?language=en-US&token=CB3DD183768B21F2D783FB62195F9841)

**References**

- [SAP Note 1671470: BSP: Design2008 for release 7.00 and 7.01](https://me.sap.com/notes/1671470)
- [SAP Note 1582870: ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [SAP Note 1582867: Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)

**Validity**

- **Software Component:** EA-HRCCN
- **Version:** 606

**Support Package**

- **Software Component Version:** EA-HRCCN 606
- **Support Package:** [SAPK-60605INEAHRCCN](https://me.sap.com/supportpackage/SAPK-60605INEAHRCCN)

**Correction Instructions**

- **Software Component:** EA-HRCCN
- **Number of Correction Instructions:** 1
- [Correction Instruction Details](https://me.sap.com/corrins/0001659640/6467)

**CVSS**

- **CVSS Score:** 0
- **CVSS Vector:** N/A

**Rating**

This document has not been rated yet.

For more information and updates, visit the [SAP Support Portal](https://me.sap.com/).

Credits to [Redrays.io](https://redrays.io) for support in providing this information.