SAP Security Note 1659560 - Unauthorized Modification of Displayed Content in CRM-ISE-WBF

## Description

BSP applications of the component **CRM-ISE-WBF** can be exploited by malicious users to modify displayed application content without authorization. This vulnerability allows attackers to potentially obtain authentication information from legitimate users, leading to impersonation and unauthorized access to sensitive information. Specifically, the issue stems from insufficient encoding of output parameters, resulting in a Cross-Site Scripting (XSS) vulnerability.

## Affected Components

- **Component:** CRM-ISE-WBF (Customer Relationship Management > Internet Service > Web Forms)

## Solution

To address this vulnerability, apply [SAP Note 1659560](https://me.sap.com/notes/1659560) or import the necessary changes via the relevant support package. **Note 1701662** is a prerequisite for this update.

### Steps:
1. **Apply the SAP Note:**
   - [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009854272017)
   - [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001659560?language=en-US&token=1A9CFD0BF1ED0211F88E8A42C644540E)

2. **Manual Correction Instructions:**
   - Access transaction SE80.
   - Navigate to **Packages** > **WFF_FORM_GENERATOR** and display the objects.
   - Modify the following transformations:
     - `WFF_GENERATE_BSP_STYLE01`
     - `WFF_GENERATE_BSP_STYLE01_C`
     - `WFF_GENERATE_BSP_STYLE01_S`
   - In each relevant template, add `forceEncode="html"` after `page language="abap"`.
   - Replace `application->get` with `application->getu` where necessary.
   - Insert `raw` in `bspWriteHiddenParameters` as `%raw= application->insert_hidden_parameters()`.
   - Activate the transformations after making the changes.

## Prerequisites

- **SAP Note 1701662:** Ensure this note is applied before implementing SAP Note 1659560.
  - [SAP Note 1701662](https://me.sap.com/notes/1701662)

## References

- [SAP Note 1701662 - Unauthorized modification of displayed content in Web Request](https://me.sap.com/notes/1701662)
- [SAP Note 1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [SAP Note 1582867 - Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)
- [SAP Note 963724 - Web request performance optimization](https://me.sap.com/notes/963724)

## Additional Information

- **Released On:** May 8, 2012
- **Priority:** High
- **Status:** Released for Customer

For more details, visit the [SAP Support Portal](https://me.sap.com/).

---

Information provided with support from [redrays.io](https://redrays.io).