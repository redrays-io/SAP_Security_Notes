1660855 - Unauthorized modification of displayed content in CRM Email

### SAP Security Note 1660855 - Unauthorized Modification of Displayed Content in CRM Email

**Type:** SAP Security Note  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 06.02.2013  
**Component:** Customer Relationship Management > Basic Functions > Email Management

#### Symptom
CRM Email can be abused by an attacker, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users. This security note has been updated. For more detailed information, see [Security Note 1818523](https://me.sap.com/notes/1818523).

#### Other Terms
- Reflected cross-site scripting (XSS)
- One-to-One email integration
- CRM Email

#### Reason and Prerequisites
The SICF handler class `CL_CRM_SEND_SCREEN` within One-to-One email integration does not sufficiently encode input parameters, resulting in a reflected cross-site scripting issue. A reflected cross-site scripting attack can be used to non-permanently deface or modify displayed content from a website. It can also be used to steal another user's authentication information, such as data relating to their current session. An attacker who gains access to this data may impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

#### Solution
Please apply this note.  
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009862482017)  
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001660855?language=en-US&token=3E5B55A0837E16E012B63CEA41C07560)

#### References
- [Security Note 1818523](https://me.sap.com/notes/1818523)
- [SAP CRM 2005 - SP Stack 20](https://me.sap.com/notes/1669624)
- [SAP Enhancement Package 1 for SAP CRM 7.0 SP-Stack 07 - RIN](https://me.sap.com/notes/1642592)

#### Support Packages
- **BBPCRM 500**
  - [SAPKU50021](https://me.sap.com/supportpackage/SAPKU50021)
  - [SAPKU50020](https://me.sap.com/supportpackage/SAPKU50020)
- **BBPCRM 520**
  - [SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011)
- **BBPCRM 600**
  - [SAPKU60011](https://me.sap.com/supportpackage/SAPKU60011)
- **BBPCRM 700**
  - [SAPKU70011](https://me.sap.com/supportpackage/SAPKU70011)
- **BBPCRM 701**
  - [SAPKU70108](https://me.sap.com/supportpackage/SAPKU70108)
- **BBPCRM 702**
  - [SAPKU70202](https://me.sap.com/supportpackage/SAPKU70202)
  - [SAPKU70203](https://me.sap.com/supportpackage/SAPKU70203)

#### Prerequisites
Ensure the following SAP Notes are applied:
- [900816](https://me.sap.com/notes/900816): CRM-EMail: "Page contains nonsecure items" in proxy scenario
- [1051315](https://me.sap.com/notes/1051315): Email freeze in Hebrew IC Webclient
- [1368700](https://me.sap.com/notes/1368700): Escape Javascript Special Character while mail transfer
- [1505476](https://me.sap.com/notes/1505476): Error 'Object Expected' during transferring email to CRM
- [1596106](https://me.sap.com/notes/1596106): Unauthorized modification of displayed content in CRM Email
- [1659519](https://me.sap.com/notes/1659519): Unauthorized modification of displayed content in CRM Email
- [1660855](https://me.sap.com/notes/1660855): Unauthorized modification of displayed content in CRM Email
- [1227642](https://me.sap.com/notes/1227642): Missing Templates for sending emails
- [1383095](https://me.sap.com/notes/1383095): Logo in signature will not be displayed
- [1467894](https://me.sap.com/notes/1467894): Subject from Mailform Template not inserting into Email
- [1544625](https://me.sap.com/notes/1544625): Images in signature appear as Red cross in the sent email
- [1551871](https://me.sap.com/notes/1551871): Images in e-mail Signatures are lost after ending session
- [1622798](https://me.sap.com/notes/1622798): Check name not picking up Organizations

#### CVSS Score
Currently, the CVSS score is not available.

For more details, refer to the [SAP Security Note 1660855](https://me.sap.com/notes/1660855).

*Credits: [Redrays.io](https://redrays.io) for supporting the information provided.*