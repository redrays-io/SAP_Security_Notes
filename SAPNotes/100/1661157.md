1661157 - Missing authorization check in DISPATCH_SPML_REQUEST_BGRFC

**Description:**

This security note has been updated. For more detailed information, see [Security Note 1769046](https://me.sap.com/notes/1769046).

**Symptom:**

An authenticated user can use the function module `DISPATCH_SPML_REQUEST_BGRFC` to which access should be restricted. This may result in an escalation of privileges.

**Reason and Prerequisites:**

The function module `DISPATCH_SPML_REQUEST_BGRFC` does not contain authorization checks for verifying an authenticated user's authorization to access some of its functions. This may result in undesired system behavior.

**Solution:**

Apply the correction provided in this note.

**Components Affected:**

- Basis Components > Security - Read KBA 2985997 for subcomponents > User Administration > Users and Authorization administration

**Support Packages:**

- [SAP_BASIS 702 - SAPKB70212](https://me.sap.com/supportpackage/SAPKB70212)
- [SAP_BASIS 720 - SAPKB72008](https://me.sap.com/supportpackage/SAPKB72008)
- [SAP_BASIS 730 - SAPKB73008](https://me.sap.com/supportpackage/SAPKB73008)
- [SAP_BASIS 731 - SAPKB73103](https://me.sap.com/supportpackage/SAPKB73103)

**Related Notes:**

- [1769046 - Update 1 to security note 1661157](https://me.sap.com/notes/1769046)
- [1708665 - Function module with class-based exception, SNOTE](https://me.sap.com/notes/1708665)

**Download:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009864542017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001661157?language=en-US&token=B602131DAFB9F9F987C86706AF4D5F86)

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*