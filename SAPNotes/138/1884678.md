1884678 - Potential directory traversals in BPCA

## Description

### Symptom
BPCA contains a vulnerability that allows for directory traversal, enabling an attacker to potentially read arbitrary files on the remote server. This can result in the disclosure of confidential information.

**CVSS Information**
- **CVSS Base Score:** 2.3
- **CVSS Base Vector:** AV:A/AC:M/AU:S/C:P/I:N/A:N

*Note: The CVSS score is an estimate of the risk and does not account for specific system configurations or environments. Conduct your own risk assessments when determining the applicability or priority of this security note. More information is available in the [SAP Security Notes FAQ](https://me.sap.com/securitynotes/).*

### Reason and Prerequisites
BPCA fails to correctly validate the file path used to reference a file read from the remote server. As a result, an attacker can potentially direct the program to an arbitrary file in the system, disclosing its contents.

## Solution

Perform the following manual activities in each system where you transport the note for implementation:

### Create Logical File Path
1. **Check Function Module:**
   - Verify if the function module `FILE_VALIDATE_NAME` exists in the managed system. If it does not exist, you can skip the customizing steps below.

2. **Create Logical File Path:**
   - **Transaction:** `FILE`
   - **Procedure:**
     - Click on "New Entry".
     - Enter logical file path `TBOM_ATRA_FILE_LPATH` with the description "Logical path for ATRA files in TBOM recording".
     - Save to a transport request.
     - Assign physical paths to the logical path for different syntax groups:
       - **UNIX:** `/usr/sap/<SYSID>/<INSTANCE>/data/<FILENAME>`
       - **AS/400 & MACINTOSH:** Same as UNIX.
       - **WINDOWS NT & DOS:** `<F=TBOM_ATRA_NAME>\\usr\\sap\\<SYSID>\\<INSTANCE>\\data\\<FILENAME>`
     - Save the changes.

### Create Logical File Name
1. **Transaction:** `FILE`
2. **Procedure:**
   - Navigate to "Logical File Name Definition, Cross Client".
   - Click "New Entry".
   - Enter logical file `TBOM_ATRA_FILE_LNAME` with the description "Logical file name for ATRA file traced in TBOM".
   - Save to the same transport request.
   - Assign the following details:
     - **Physical File:** `<PARAM_1>`
     - **Application Area:** BC
     - **Logical Path:** `TBOM_ATRA_FILE_LPATH`
   - Save the changes.

### Additional Steps
- **Function Module Creation:**
  - If the function group `E2E_TESTING_DIALOGS` does not exist, create it in the package `E2E_TESTING` and activate it.
  - Create the function module `FILENAME_EXIT_TBOM_ATRA_NAME` in the function group `E2E_TESTING_DIALOGS` by copying the interface from `FILENAME_EXIT_EXAMPLE`.
  - Add the following ABAP code to the function module:

    ```abap
    DATA lv_current_param_value TYPE tpfet-pvalue.
    DATA lv_parameter_name TYPE tpfet-parname.

    lv_parameter_name = 'abap/atrapath'.

    CALL 'C_SAPGPARAM'
      ID 'NAME' FIELD lv_parameter_name
      ID 'VALUE' FIELD lv_current_param_value.

    output = lv_current_param_value(2).
    ```

  - Activate the function module `FILENAME_EXIT_TBOM_ATRA_NAME`.

## Validity
This note applies to the following software components:
- **ST-PI:**
  - From: 2008_1_46C to 2008_1_46C
  - From: 2008_1_620 to 2008_1_620
  - From: 2008_1_640 to 2008_1_640
  - From: 2008_1_700 to 2008_1_700
  - From: 2008_1_710 to 2008_1_710

## Support Package
- **ST-PI 2008_1_46C:** [SAPKITLRA9](https://me.sap.com/supportpackage/SAPKITLRA9)

## References
- [Potential directory traversals in applications (Note 1497003)](https://me.sap.com/notes/1497003)

For more information, visit the [SAP Security Notes](https://me.sap.com/notes/1884678).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*