SAP Security Note 1488609 - Missing Authorization Check in remote ABAP Config Access

**Overview**
- **SAP Note/KBA:** 1488609
- **Type:** SAP Security Note
- **Version:** 4
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** 14.12.2010
- **Component:** Basis Components > NetWeaver Process Integration (PI) > Integration Server

**Symptom**
An authenticated user can access remote configuration data to which access should be restricted. This can potentially result in an escalation of privileges.

**Reason and Prerequisites**
A remote-enabled function module lacks permission checks for an authenticated user's authorization to access configuration data remotely.

**Solution**

**Option 1:**
a. **Apply the corresponding Support Package to your system:**
   - 6.40 SP 27
   - 7.00 SP 23
   - 7.01 SP 8
   - 7.02 SP 6
   - 7.10 SP 11
   - 7.11 SP 6

b. **Extend the activities of the role `SAP_BC_AI_LANDSCAPE_DB_RFC` using transaction `PFCG`:**
   - Choose the "Authorizations" tab
   - Change to edit mode
   - Press the "Change Authorizations" button
   - Extend the authorization for LCR Database by the read (No.33) and administer (No.70) activities
   - Save the changes and generate the profile

c. **Activate the authority check:**
   - Run transaction `SXMB_ADM`
   - Choose "Integration Engine Configuration"
   - Press the "Specific Configuration" button
   - Switch to edit mode
   - Press the "New Entries" button and add the following setting:
     - **Category:** Runtime
     - **Parameter:** EX_PROFILE_READ_AUTH
     - **Current Value:** 1
   - Save the changes

**Option 2 (For Systems with Support Package Levels Lower Than Option 1):**
a. **Modify the system objects and apply the note:**
   1. **Change Authorization Object using transaction `SU21`:**  
      - Add activities 'read' (No.33) and 'administer' (No.70) to `S_LCRDB`.
   2. **Run transaction `SM30` to maintain table `SXMSCONFDF`:**  
      - Add entry:
        - **Category:** RUNTIME
        - **Parameter:** EX_PROFILE_READ_AUTH
        - **Value:** 0 (default value - check is deactivated)
        - **Documentation Object:** XMB_OP_RUNTIME
        - **Subparam. Dynamic:** No
   3. **Import the note corrections.**

b. **Extend the activities of the role `SAP_BC_AI_LANDSCAPE_DB_RFC` using transaction `PFCG`:**
   - Follow the same steps as in Option 1b.

c. **Activate the authority check:**
   - Follow the same steps as in Option 1c.

**Support Packages**
Apply the relevant support packages based on your SAP_BASIS version:
- [SAPKB64027](https://me.sap.com/supportpackage/SAPKB64027) for SAP_BASIS 6.40
- [SAPKB70023](https://me.sap.com/supportpackage/SAPKB70023) for SAP_BASIS 7.00
- [SAPKB70108](https://me.sap.com/supportpackage/SAPKB70108) for SAP_BASIS 7.01
- [SAPKB70205](https://me.sap.com/supportpackage/SAPKB70205) for SAP_BASIS 7.02
- [SAPKB71011](https://me.sap.com/supportpackage/SAPKB71011) for SAP_BASIS 7.10
- [SAPKB71107](https://me.sap.com/supportpackage/SAPKB71107) for SAP_BASIS 7.11
- [SAPKB73001](https://me.sap.com/supportpackage/SAPKB73001) for SAP_BASIS 7.30

**Download and Documentation**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008809622017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001488609?language=en-US&token=6658FCF2F1B020D7910B57B1F6B65B53)

**References**
- This document is referenced by [SAP Note 1321868 - Configuration Wizard: PI Upgrade](https://me.sap.com/notes/1321868)

For more detailed information, please refer to the [SAP Security Note 1488609](https://me.sap.com/notes/1488609).

*Credits:* Information provided by [Red Rays](https://redrays.io).