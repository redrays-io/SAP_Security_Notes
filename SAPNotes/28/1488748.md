1488748 - Potential disclosure of persisted data in DIMA (conditions)

**Header Data**
- **SAP Note/KBA:** 1488748
- **Type:** SAP Security Note
- **Version:** 5
- **Recency:** New
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Release Status:** Released for Customer
- **Released On:** 14.12.2010
- **Component:** Customer Relationship Management > Master Data > Condition Technique > Exchange of Condition Records and Customizing Data

**Description**

### Symptom
A malicious user can exploit DIMA condition data extraction and use specially crafted inputs to modify database commands, resulting in the retrieval of additional information persisted by the system.

### Other Terms
SQL injection, database, DIMA, Data Exchange

### Reason and Prerequisites
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement including strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve data from the database. The affected code cannot be called externally.

### Solution
The input table name should be a condition table name in the CRM system.
The solution adds a check in these function modules to ensure that this table is an active condition table in the system.

**Support Package**
- [SAPKU40018](https://me.sap.com/supportpackage/SAPKU40018) for BBPCRM 400
- [SAPKU50018](https://me.sap.com/supportpackage/SAPKU50018) for BBPCRM 500
- [SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011) for BBPCRM 520
- [SAPKU60009](https://me.sap.com/supportpackage/SAPKU60009) for BBPCRM 600
- [SAPKU70009](https://me.sap.com/supportpackage/SAPKU70009) for BBPCRM 700
- [SAPKU70102](https://me.sap.com/supportpackage/SAPKU70102) for BBPCRM 701

**Download and Print**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008810442017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001488748?language=en-US&token=2AA5CACCD8DC0354EDDF3B9C0C267AD4)

For more information, visit [SAP Support](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for supporting the provision of this information.*