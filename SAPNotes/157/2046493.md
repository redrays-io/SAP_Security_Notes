2046493 - Privilege escalation vulnerability in saposcol

## Symptom

If you are running `saposcol` with the s-bit enabled, it may result in a privilege escalation vulnerability.

### CVSS Information

**CVSS Base Score:** 6.0  
**CVSS Base Vector:**  
- **Access Vector (AV):** Network (N)  
- **Access Complexity (AC):** Medium (M)  
- **Authentication (AU):** Single (S)  
- **Confidentiality (C):** Partial (P)  
- **Integrity (I):** Partial (P)  
- **Availability (A):** Partial (P)

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/).

## Reason and Prerequisites

In the past, `saposcol` was delivered standalone and had the s-bit enabled on Unix-like platforms. You can still find advice to set the s-bit on public internet forums. This is a security risk as `saposcol` is calling other processes to get OS-related information. These processes might run with elevated privileges if the s-bit is set.

## Solution

If you are running `saposcol` with the s-bit set (you can recognize it by permission `4750` or `-rws-r-x----` in `ls -l` output), please disable it. Start `saposcol` either as root, or consider using the `SAPHOSTAGENT` package, which contains the new `saposcol` and handles its starting/stopping automatically in a safe way.

## Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017915222017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002046493?language=en-US&token=4882D079FBC4A5EB3B1F38E8E5D41FF0)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002046493) *(Note: Ensure you have the necessary permissions to access this link.)*

## References

- [How to run saposcol OS collector correctly](https://me.sap.com/notes/2180367)

## Available Translations

- [Deutsch](https://me.sap.com/notes/0002046493/D)
- [日本語](https://me.sap.com/notes/0002046493/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002046493/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002046493/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002046493/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002046493/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002046493/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002046493/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002046493/3)

*For more information and support, visit [SAP Support Portal](https://me.sap.com/).*

*Credits to [RedRays](https://redrays.io) for support and provided information.*