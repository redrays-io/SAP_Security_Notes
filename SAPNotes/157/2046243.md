2046243 - Switchable Authorization Checks for RFC in Payroll, Time Management, and ESS/MSS

**Description**

This SAP security note introduces new switchable authorization checks for RFC function modules in Payroll, Time Management, and ESS/MSS. These checks enhance system security by ensuring that remote calls to RFC function modules are protected by the authorization object `S_RFC`.

**Key Details:**

- **SAP Note Number:** 2046243
- **Type:** SAP Security Note
- **Released On:** 11.11.2014
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Component:** Personnel Management > Personnel Administration > General Parts

**Affected Business Processes and Roles:**

1. **Payroll**
   - **Scenario:** HR_PY: Authorization Check Payroll
   - **Business Process:** Reading of Payroll results.
   - **Affected RFC Function Modules:**
     - `HR_GET_CONVERSION_DATA`
     - `RP_IMPORT_GARNISHMENT_LIST`

2. **Time Management**
   - **Scenario:** HR_TIM: Authorization Check Time Management
   - **Business Process:** Reading of Time management data.
   - **Affected RFC Function Modules:**
     - `BAPI_PTMGREXTTIMESPEC_GETSTATU`
     - `HRTIM_AA_DOC_READ`
     - `HR_TIM_READ_WFM_DATE`

3. **ESS/MSS**
   - **Scenario:** HR_XSS: Authorization Check ESS/MSS
   - **Business Process:** Reading of MSS data.
   - **Affected RFC Function Modules:**
     - `RP_GET_PERNR_FROM_USERID`
     - `CRIF_GET_EMPLOYEE_FOR_USER`

**Solution**

To activate the new switchable authorization checks, follow these steps:

1. **Download the SAP Note:**
   - [Download for SNOTE](https://notesdownloads.sap.com/note/0040000012163822017)
   - [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002046243?language=en-US&token=F0B9DEF995CD852CB013C276CE573471)

2. **Implement Switchable Authorization Checks:**
   - **Step 1:** Create the authorization scenario definition in systems where they do not exist yet.
     - Use transaction `SACF` to check and upload scenario definitions (`HR_PY`, `HR_TIM`, `HR_XSS`) using the attached `.txt` files.
   - **Step 2:** Create the productive authorization scenario from the scenario definition.
     - In transaction `SACF`, transfer the scenario definition to a productive scenario and choose the initial status (`Active` or `Logging`).
   - **Step 3:** Activate logging of relevant audit messages in the Security Audit Log.
     - Ensure Security Audit Log is active in transaction `SM19` and configure the necessary filters.
   - **Step 4:** Adjust your roles to provide the necessary authorizations.
     - Use report `RSAU_SELECT_EVENTS` to identify and adjust user authorizations accordingly.

**Prerequisites**

Ensure the following SAP Notes are applied:

- [1988903](https://me.sap.com/notes/1988903): Check whether a function modules was called via external RFC
- [1995667](https://me.sap.com/notes/1995667): SACF: Navigation error
- [1893321](https://me.sap.com/notes/1893321): Exception Handling in RP_GET_PERNR_FROM_USERID

**Support Packages**

The security note is applicable to the following software components and support package versions:

- **SAP_HRRXX**
  - 600, 604, 608
- **SAP_HRGXX**
  - 600, 604, 608

For more details and to download the relevant support packages, visit [Support Package Information](https://me.sap.com/supportpackage/SAPK-600B4INSAPHRRXX).

**Attachments**

- [HR_XSS.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000927572014&iv_version=0001&iv_guid=3AAF336FD38B4542B3F5982836AB544B)
- [HR_TIM.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000927572014&iv_version=0001&iv_guid=D17E246044E3414D9614EA2340902BA2)
- [HR_PY.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000927572014&iv_version=0001&iv_guid=E88B8BE44E460B488C343FDCE1C6B38C)

**References**

- [SAP Note 2078596](https://me.sap.com/notes/2078596): Further improvements for RFC security
- [SAP Note 2188986](https://me.sap.com/notes/2188986): Delivery of HR authorization scenarios

For more information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*