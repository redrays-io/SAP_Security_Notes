SAP Security Note 2066956 - Switchable authorization checks for RFC in EHS

---

**SAP Security Note 2066956 - Switchable Authorization Checks for RFC in EHS**

### Symptom
This SAP note introduces new switchable authorization checks for RFC function modules in Environment, Health & Safety (EHS). Remote calls to RFC function modules are protected by the authorization object `S_RFC`, but it was identified that `S_RFC` checks might not be sufficient for certain RFC function modules. This could potentially lead to unauthorized access if not properly managed.

### Reason and Prerequisites
The new authorization checks ensure that RFC function modules included in `S_RFC` authorizations are further secured by additional authorization objects. To implement this, activate the new switchable authorization checks via transaction `SACF` as described in the correction instructions.

### Solution
The solution involves activating the new switchable authorization checks which are delivered inactive by default to maintain compatibility. The activation process includes:

1. **Implementation of the Switchable Authorization Check**
   - Import the scenario definitions using the attached files [`EHS_IH_OH_BP.TXT`](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000885342014&iv_version=0001&iv_guid=BF8BB73CECDA144F845A7D7426044818) and [`EHS_IH_OH_HR.TXT`](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000885342014&iv_version=0001&iv_guid=FFC4EF08AD491648A7F6C8381DEB01E2) via transaction `SACF_TRANSFER`.
   - Assign the scenario definitions to the respective development packages (`CBHR`).

2. **Generating a Productive Authorization Scenario**
   - Use transaction `SACF` to convert scenario definitions to productive scenarios.
   - Choose the appropriate scenario status: `Active` or `Logging`.

3. **Activating Security Audit Logging**
   - Ensure the security audit log is active using transaction `SM19`.
   - Activate relevant message IDs (`DUO`, `DUP`, `DUQ`) in a static security audit log profile.

### New Authorization Scenarios
- **EHS_IH_OH_BP**: Scenario for Business Partner Roles
  - Adds checks against authorization object `B_BUPA_RLT` in specific function modules.
- **EHS_IH_OH_HR**: Scenario for HR Persons
  - Adds checks against authorization object `HRBASAUTH` in specific function modules.

### Affected Business Processes
- Search for business partners and determination of business partner roles.
- Search for HR persons and determination of HR persons.

### Attachments
- [EHS_IH_OH_BP.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000885342014&iv_version=0001&iv_guid=BF8BB73CECDA144F845A7D7426044818)
- [EHS_IH_OH_HR.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000885342014&iv_version=0001&iv_guid=FFC4EF08AD491648A7F6C8381DEB01E2)

### References
- [SAP Note 2078596 - Further improvements for RFC security](https://me.sap.com/notes/2078596)
- [SAP Note 2105936 - Incident/Accident Log: Incomplete display of absences](https://me.sap.com/notes/2105936)

### Validity
Applicable to **SAP_HRGXX** component versions 600, 604, 608, and 609.

### Support Packages
Refer to the [Support Package section](https://me.sap.com/supportpackage/SAPK-600B4INSAPHRGXX) for relevant support packages.

### Prerequisites
Ensure the following SAP notes are applied:
- [SAP Note 1988903](https://me.sap.com/notes/1988903)
- [SAP Note 1995667](https://me.sap.com/notes/1995667)
- [SAP Note 1905242](https://me.sap.com/notes/1905242)
- [SAP Note 1511561](https://me.sap.com/notes/1511561)
- [SAP Note 1526402](https://me.sap.com/notes/1526402)
- [SAP Note 1534362](https://me.sap.com/notes/1534362)

### Side Effects
This document may address side effects caused by [SAP Note 2105936](https://me.sap.com/notes/2105936).

### Rating
No ratings yet.

---

*Credits to [Redrays](https://redrays.io) for support in providing this information.*