2067220 - [CVE-2023-39436] Information Disclosure in SAP Supplier Relationship Management

**Symptom**

SAP Supplier Relationship Management allows an unauthorized attacker to discover information relating to SRM within Vendor Master Data for Business Partners replication functionality. This information could be used to allow the attacker to specialize their attacks against SRM.

**Other Terms**

- Information disclosure
- [CVE-2023-39436](https://www.cve.org/CVERecord?id=CVE-2023-39436)

**Reason and Prerequisites**

Information such as installed products, versions of those products, and landscape configuration data/user passwords can be discovered using Vendor Master Data for Business Partners replication functionality. This information may be used by an attacker to further target SRM.

Remote calls to RFC function modules are protected by checks on the authorization object `S_RFC`. Authorizations for `S_RFC` must be limited to the required minimum authorizations for all users to ensure system security. Many RFC function modules can be sufficiently protected using `S_RFC` authorization checks. These RFC function modules often do not perform additional functional authorization checks. Please see SAP note [2008727](https://me.sap.com/notes/2008727) for further information on RFC Security.

It was identified that `S_RFC` authorization checks might not be sufficient to ensure secure execution for RFC function modules covered by this note. Activate new switchable authorization checks and update corresponding roles if these RFC function modules are included in `S_RFC` authorizations in your system.

**Pre-requisites of this Note**

- [1995667](https://me.sap.com/notes/1995667) - SACF: Navigation error
- [1882417](https://me.sap.com/notes/1882417) - External check for Remote Function Call
- [1988903](https://me.sap.com/notes/1988903) - Check whether a function modules was called via external RFC
- [2029077](https://me.sap.com/notes/2029077) - Switchable authorization checks for RFC in FI-FM and PSM-FM
- [2008372](https://me.sap.com/notes/2008372) - SU22: Error uploading default values
- [2032723](https://me.sap.com/notes/2032723) - Switchable authorization checks for RFC in SRM

**Solution**

New switchable authorization checks have been implemented. The checks are delivered inactive to ensure compatibility with your running processes. The checks can be activated in transaction SACF as described in the attached manual correction instruction.

**New Authorization Scenarios**

- **BBP_VENDOR_GET - Scenario for Vendors & Plants**
  
  This authorization scenario is used to read via RFC the Vendor specific master data (get detail, get list): Vendor details and Plants details.

**Affected Business Processes and Roles**

Any business processes, integration scenarios, and roles that use the following RFC function modules are affected:

- `BBP_VENDOR_GET_DATA2`

**Implementation of the Switchable Authorization Check**

The switchable authorization scenario and the switchable authorization checks are provided via support package. They can be technically pre-implemented via the correction instructions below. After technical implementation via support package or correction instructions, the checks remain inactive until manual activation.

**Activation of the Switchable Authorization Check**

Follow the pre-processing activities as per SAP note [2032723](https://me.sap.com/notes/2032723) to activate the authorization checks.

**CVSS**

- **Score:** 5.8
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N)

**References**

- [2032723](https://me.sap.com/notes/2032723) - Switchable authorization checks for RFC in SRM
- [2029077](https://me.sap.com/notes/2029077) - Switchable authorization checks for RFC in FI-FM and PSM-FM
- [2008727](https://me.sap.com/notes/2008727) - Securing Remote Function Calls (RFC)
- [2008372](https://me.sap.com/notes/2008372) - SU22: Error uploading default values
- [1995667](https://me.sap.com/notes/1995667) - SACF: Navigation error
- [1988903](https://me.sap.com/notes/1988903) - Check whether a function modules was called via external RFC
- [1882417](https://me.sap.com/notes/1882417) - External check for Remote Function Call

**Credits**

Supported by [redrays.io](https://redrays.io) for providing the information.