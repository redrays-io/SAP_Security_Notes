2064048 - Switchable authorization checks for RFC in LO-SPM

## Description

### Symptom
This SAP note describes new switchable authorization checks for RFC function modules in LO-SPM.

### Other Terms
SACF, RFC, authorization, LO-SPM

### Reason and Prerequisites
Remote calls to RFC function modules are protected by checks on the authorization object `S_RFC`. Authorizations for `S_RFC` must be limited to the required minimum authorizations for all users to ensure system security. Many RFC function modules can be sufficiently protected using `S_RFC` authorization checks. These RFC function modules often do not perform additional functional authorization checks. Please see [SAP note 2008727](https://me.sap.com/notes/2008727) for further information on RFC Security.

It was identified that `S_RFC` authorization checks might not be sufficient to ensure secure execution for RFC function modules covered by this note. Activate new switchable authorization checks and update corresponding roles if these RFC function modules are included in `S_RFC` authorizations in your system.

## Solution
New switchable authorization checks have been implemented. The checks are delivered inactive to ensure compatibility with your running processes. The checks can be activated in transaction `SACF` as described in the attached manual correction instruction.

### New Authorization Scenario
The following new authorization scenarios can be maintained in transaction `SACF` after implementation of this SAP note.

**Scenario 1**
- `/SPE/LO_SPM_CRM_VL` - Delivery data access from CRM

**Affected Business Processes and Roles**
- Remote call to function module `/SPE/GET_CDLV_OF_ORDER_FOR_REP.`

**Affected RFC Function Modules**
- `/SPE/GET_CDLV_OF_ORDER_FOR_REP.`

### Implementation of the Switchable Authorization Check
The switchable authorization scenario and the switchable authorization checks are provided via support package. They can be technically pre-implemented via the correction instructions below. After technical implementation via support package or correction instructions, the checks remain inactive until manual activation.

### Activation of the Switchable Authorization Check
Follow the post-processing activities below after technical implementation to activate the authorization checks.

1. **Create the Authorization Scenario Definition:**
   - Start transaction `SACF` in the development system and check if scenario definition `/SPE/LO_SPM_CRM_VL` exists. If it exists, proceed to step 2.
   - If not, download the file [LO_SPM_CRM_VL.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000822712014&iv_version=0001&iv_guid=03E2161505F7B740AB9F9C988292F0F7) attached to this note.
   - Start transaction `SACF_TRANSFER`.
   - Select "Upload", choose "Scenario Definition", deselect "Productive Scenarios" and "Test Mode", then execute.
   - Choose the file `LO_SPM_CRM_VL.TXT` and confirm upload.
   - Assign the scenario definition `/SPE/LO_SPM_CRM_VL` to development package `/SPE/CRM_VL`.

2. **Create the Productive Authorization Scenario:**
   - Start transaction `SACF` in the development system, select "Scenario Definition", choose `/SPE/LO_SPM_CRM_VL`, and execute.
   - Double-click on the scenario definition and press the "Scenario" button to transfer it to a productive scenario.
   - Choose the initial scenario status "Active" or "Logging":
     - **Active:** Activates the authorization check and logging to Security Audit Log.
     - **Logging:** Activates logging to Security Audit Log; authorization checks always pass regardless of user authorizations.

3. **Activate Logging of Relevant Audit Messages:**
   - Ensure Security Audit Log is activated by checking in transaction `SM19`.
   - Create a new filter in the active Security Audit Log configuration.
   - Activate the new filter.

4. **Adjust Your Roles:**
   - Use report `RSAU_SELECT_EVENTS` to identify users requiring new authorizations.
   - Analyze "Events (Audit Messages)" DUO and DUP.
   - Authorization checks can also be analyzed using system trace for authorizations (`STAUTHTRACE` or `ST01`).

## Support Packages
Ensure the following support packages are applied based on your system's software component version:

- **SAP_APPL 600:** [SAPKH60027](https://me.sap.com/supportpackage/SAPKH60027)
- **SAP_APPL 602:** [SAPKH60217](https://me.sap.com/supportpackage/SAPKH60217)
- **SAP_APPL 603:** [SAPKH60316](https://me.sap.com/supportpackage/SAPKH60316)
- **SAP_APPL 604:** [SAPKH60417](https://me.sap.com/supportpackage/SAPKH60417)
- **SAP_APPL 605:** [SAPKH60514](https://me.sap.com/supportpackage/SAPKH60514)
- **SAP_APPL 606:** [SAPKH60614](https://me.sap.com/supportpackage/SAPKH60614)
- **SAP_APPL 616:** [SAPKH61609](https://me.sap.com/supportpackage/SAPKH61609)
- **SAP_APPL 617:** [SAPKH61706](https://me.sap.com/supportpackage/SAPKH61706)

## References
- [SAP Note 2078596 - Further improvements for RFC security](https://me.sap.com/notes/2078596)

## Attachments
- [LO_SPM_CRM_VL.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000822712014&iv_version=0001&iv_guid=03E2161505F7B740AB9F9C988292F0F7)

## Credits
Supported by [Redrays.io](https://redrays.io) for providing the information.