SAP Security Note 1607944 - Directory traversal in IS-H-CM

---

**Title:** Directory traversal vulnerability in IS-H-CM components

**SAP Note Number:** 1607944  
**Type:** SAP Security Note  
**Version:** 3  
**Release Date:** 13.10.2011  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Component:** IS-H-CM (Industry-Specific Components > Hospital > Communication)

### **Symptom**
There is a potential directory traversal vulnerability in the following components:
- IS-H-CM-INS
- IS-H-CM-OUT

### **Other Terms**
- **Directory traversal**
- **IS-H-CM**

### **Reason and Prerequisites**
The programs specified in the correction instructions contain vulnerabilities that allow a malicious user to:
- **Read arbitrary files** on the remote server, potentially disclosing confidential information.
- **Write arbitrary files** on the remote server, possibly corrupting data or altering system behavior.

### **Solution**
Logical file names must be validated to prevent unauthorized file access. The following logical file names have been created for validation:

- **RNC301I0**: Validation for IS-H EDI File Import Program

**Recommendations:**
- Avoid maintaining a high number of logical file names by sharing the same logical file name across various programs.
- Create a directory structure that reflects the user name and/or program name to securely separate data.

**Steps to Implement:**
1. **Call transaction FILE.**
2. **Navigate to** "Logical File Path Definition, Cross-Client."
3. **Choose** `New Entries`.
4. **Enter the following data for all file names and texts:**
   - **Logical file:** `<FILE NAME>`
   - **Name:** `<TEXT>`
   - **Data format:** `DIR`
   - **Application area:** `IS`
5. **Save your changes.**

**Example:**
- **File Name:** `RNC301I0`
- **Text:** `Validation for IS-H EDI File Import Program`

### **Affected Software Components**
- **IS-H Versions:** 463B, 471, 472, 600, 602, 603, 604, 605

### **Support Packages**
Ensure the following support packages are applied to address the vulnerability:

- **IS-H 463B:** [SAPKIPHD59](https://me.sap.com/supportpackage/SAPKIPHD59)
- **IS-H 472:** [SAPKIPHF45](https://me.sap.com/supportpackage/SAPKIPHF45)
- **IS-H 600:** [SAPK-60029INISH](https://me.sap.com/supportpackage/SAPK-60029INISH)
- **IS-H 602:** [SAPK-60218INISH](https://me.sap.com/supportpackage/SAPK-60218INISH)
- **IS-H 603:** [SAPK-60317INISH](https://me.sap.com/supportpackage/SAPK-60317INISH)
- **IS-H 604:** [SAPK-60417INISH](https://me.sap.com/supportpackage/SAPK-60417INISH)
- **IS-H 605:** [SAPK-60509INISH](https://me.sap.com/supportpackage/SAPK-60509INISH)

### **Correction Instructions**
Apply the correction instructions available here: [Correction Instructions for Note 1607944](https://me.sap.com/corrins/0001607944/6)

### **References**
- [SAP Note 1607749 - Directory traversal in IS-H, central program part](https://me.sap.com/notes/1607749)

### **Available Translations**
This document is available in the following languages:
- Japanese
- Deutsch (Origin)
- Portuguese, Español, Français, Italiano, Русский, 中文, 한국어 (Machine Translations)

### **Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009549222017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001607944?language=en-US&token=3A8C91B0D37D2CB31E541EE4CA96E9C4)

---

*Credits to [Redrays](https://redrays.io) for support in providing this information.*