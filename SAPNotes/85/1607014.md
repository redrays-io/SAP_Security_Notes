1607014 - Unauthorized use of application functions in PI Demo Example

## Description

A malicious user can execute functions in the PI Demo Example without authentication and authorization.

### Other Terms
- Cross-site request forgery (CSRF or XSRF)
- sxidemo_agcy_ui
- PI Demo Example

### Reason and Prerequisites

The PI Demo Example executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a specific URL and parameters, the function is executed with the rights of the authenticated user. This can be achieved through cross-site scripting attacks or by presenting a link to the victim.

### Solution

The PI Demo Application is not active by default and cannot be accessed unless configured, which is not allowed in productive systems. To mitigate this vulnerability:

1. **Deactivate the Demo Application**  
   In transaction `SICF`, deactivate the demo application to prevent access via URL.

2. **Implement Correction Instructions**  
   - Import the relevant support package or follow the correction instructions provided in this note.
   - Delete the user and password settings for this application in transaction `SICF`. Ensure that client information (105) is set.
   - Execute the program `BSP_XSRF_PARAM_SXIDEMO` and select the transport request when prompted. This program will make the necessary entries for the BSP application in the database table `BSPTEMPXSRFSTORE`.

**Note:**
- Refer to [Note 1520324](https://me.sap.com/notes/1520324) and [Note 1551982](https://me.sap.com/notes/1551982) for additional information and instructions. The corrections from these notes are prerequisites for implementing this note.
- Implement the correction instructions contained in this note, which will create the program `BSP_XSRF_PARAM_SXIDEMO` in your system.

### Affected Components
- **Component:** Basis Components > NetWeaver Process Integration (PI)

### Downloads
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009543392017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001607014?language=en-US&token=64257E75260D2B502EA97C20A2F5E1AF)

### Support Packages
- **SAP_BASIS 640:** [SAPKB64029](https://me.sap.com/supportpackage/SAPKB64029)
- **SAP_BASIS 700:** [SAPKB70026](https://me.sap.com/supportpackage/SAPKB70026)
- **SAP_BASIS 701:** [SAPKB70111](https://me.sap.com/supportpackage/SAPKB70111)
- **SAP_BASIS 702:** [SAPKB70210](https://me.sap.com/supportpackage/SAPKB70210)
- **SAP_BASIS 710:** [SAPKB71014](https://me.sap.com/supportpackage/SAPKB71014)
- **SAP_BASIS 711:** [SAPKB71109](https://me.sap.com/supportpackage/SAPKB71109)
- **SAP_BASIS 730:** [SAPKB73005](https://me.sap.com/supportpackage/SAPKB73005)
- **SAP_BASIS 731:** [SAPKB73101](https://me.sap.com/supportpackage/SAPKB73101)

---

Credits to [RedRays](https://redrays.io) for support in providing this information.