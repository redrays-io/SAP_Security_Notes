SAP Security Note 1578054 - Audit Trail: Potential disclosure of persisted data

**SAP Security Note 1578054** addresses a critical SQL injection vulnerability in the NetWeaver-based audit trail. Here are the key details:

### **Symptom**
A malicious user can exploit transaction **S_AUT10** by using specially crafted inputs to modify database commands. This can lead to the retrieval of additional information persisted by the system.

### **Reason and Prerequisites**
The issue arises from an SQL injection vulnerability where the code constructs an SQL statement with user-alterable strings. This manipulated SQL statement can be used to access sensitive data from the database. The prerequisite for exploitation involves analyzing table logs for database tables with non-character-type key fields, which are rarely used in the standard SAP system.

### **Solution**
To mitigate this vulnerability, you should import the relevant Support Package associated with this note. Additionally, the Support Package includes performance improvements for evaluating the audit trail (transaction **S_AUT10**). For more information, refer to [SAP Note 1641928](https://me.sap.com/notes/1641928).

**Download the Support Package for SNOTE:**  
[Download for SNOTE](https://notesdownloads.sap.com/note/0040000009363582017)

**PDF Version:**  
[PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001578054?language=en-US&token=8F6B91080D84680BB228C23ED2950D0F)

### **Support Packages**
- **SAP_BASIS 701:** [SAPKB70111](https://me.sap.com/supportpackage/SAPKB70111)
- **SAP_BASIS 702:** [SAPKB70210](https://me.sap.com/supportpackage/SAPKB70210)
- **SAP_BASIS 731:** [SAPKB73101](https://me.sap.com/supportpackage/SAPKB73101)

### **References**
- [SAP Note 1641928](https://me.sap.com/notes/1641928) - Transaction S_AUT10: Performance for packaged reading
- [SAP Note 1460757](https://me.sap.com/notes/1460757) - S_AUT10: Database selection leads to short dump

For more detailed information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for support in providing this information.*