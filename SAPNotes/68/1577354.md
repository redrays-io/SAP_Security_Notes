1577354 - Attacker could get administrative access to the database

---

## Description

A critical SQL injection vulnerability has been identified in the SAP database monitor for Microsoft SQL Server. Malicious users can exploit transactions such as `ST04`, `DBACOCKPIT`, `ST04_MSS`, `DB02`, `DB02_MSS`, `DB12`, or `DB13` by providing specially crafted inputs. This exploitation allows the execution of malicious database commands, which can lead to:

- **Data Retrieval:** Unauthorized access to sensitive information stored in the database.
- **Data Modification or Destruction:** Alteration or deletion of data, compromising data integrity.
- **Privilege Escalation:** Gaining administrative control over the database instance.

### Other Terms
- SQL Injection
- MSSQL
- ST04
- DBACOCKPIT
- DB02_MSS
- DB12_MSS
- DB13

## Affected Components

- **Software Component:** SAP_BASIS
- **Affected Versions:**
  - 620 to 640
  - 700 to 702
  - 710 to 730
- **Component Path:** Basis Components > Database Interface, Database Platforms > SQL Server in SAP NetWeaver Products (BC-DB-MSS)
- **Release Status:** Released for Customer
- **Released On:** 12.07.2011

## Solution

To address this vulnerability, follow these steps:

1. **Apply Correction Instruction:**
   - Download the correction instruction from the [Correction Instructions](https://me.sap.com/corrins/0001577354/41).
   - Implement the correction as per the provided guidelines.

2. **Create Messages in Transaction SE91:**
   - **Message 0Q 150:**
     - Go to [transaction SE91](https://me.sap.com/se91).
     - Enter message class `0Q` and message number `150`, then click "change".
     - Enter the following text and save:
       ```
       Parameter &1 contains an illegal special character
       ```
   - **Message 0Q 104:**
     - Repeat the above steps for message number `104`.
     - Enter the following text and save:
       ```
       Schema name > &1< contains an impermissible special character
       ```

3. **Manual Post-Implementation:**
   - Ensure that only trusted system administrators and personnel responsible for system tuning have access to the SQL Server database monitor transactions.
   - For systems using SAP_BASIS version 6.40 (e.g., ECC 5.0), also create message `0Q 104`.

4. **Additional Measures for Older Support Packages:**
   - If your system is on SAP_BASIS support package levels 7.0 SP12 or older, or 7.10 SP2 or older, you may need to manually apply the source code correction or restrict access to the SQL Server database monitor transactions.

## Download and Resources

- **Download for SNOTE:** [https://me.sap.com/notes/0001577354](https://notesdownloads.sap.com/note/0040000009359242017)
- **PDF Version:** [https://me.sap.com/sap/support/sfm/notes/print/0001577354?language=en-US&token=F55BE3C863637AC33478AEB74A706CAB](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001577354?language=en-US&token=F55BE3C863637AC33478AEB74A706CAB)

## Support Package Information

- **SAP_BASIS 620:** [SAPKB62070](https://me.sap.com/supportpackage/SAPKB62070)
- **SAP_BASIS 640:** [SAPKB64028](https://me.sap.com/supportpackage/SAPKB64028)
- **SAP_BASIS 700:** [SAPKB70025](https://me.sap.com/supportpackage/SAPKB70025)
- **SAP_BASIS 701:** [SAPKB70110](https://me.sap.com/supportpackage/SAPKB70110)
- **SAP_BASIS 702:** [SAPKB70208](https://me.sap.com/supportpackage/SAPKB70208)
- **SAP_BASIS 710:** [SAPKB71013](https://me.sap.com/supportpackage/SAPKB71013)
- **SAP_BASIS 711:** [SAPKB71108](https://me.sap.com/supportpackage/SAPKB71108)
- **SAP_BASIS 720:** [SAPKB72006](https://me.sap.com/supportpackage/SAPKB72006)
- **SAP_BASIS 730:** [SAPKB73003](https://me.sap.com/supportpackage/SAPKB73003)

## Preconditions

- **Software Component:** SAP_BASIS
- **Valid For Releases:**
  - 640
  - 730

## Additional Information

For further details and updates, visit the official [SAP Notes](https://me.sap.com/notes/0001577354).

---

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*