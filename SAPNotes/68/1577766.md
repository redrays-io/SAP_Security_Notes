1577766 - Unauthorized modification of displayed content in WEBCUIF

**Symptom**

WEBCUIF can be abused by an attacker, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

**Other Terms**

- Reflected cross-site scripting (XSS)
- BTF Editor

**Reason and Prerequisites**

The BTF Editor within WEBCUIF doesn't sufficiently encode the content, resulting in a reflected cross-site scripting issue. An attacker can use this vulnerability to non-permanently deface or modify displayed content from a web site. Additionally, reflected XSS can be exploited to steal another user's authentication information, such as data relating to their current session. This could allow an attacker to impersonate the user and access information with the same privileges. If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**

Implement the manual steps and the attached correction instructions or install the corresponding support package.

**Manual Steps:**

1. Log on to your CRM SYSTEM through SAP GUI.
2. Launch transaction `SE80`.
3. In the object navigator on the left, select "BSP Extension" from the "Application Hierarchy" dropdown.
4. Type `THTMLBX` and press Enter.
5. Double-click on `btf`.
6. In the main work area, select the "Attributes" tab.
7. Insert a new Attribute with the following information:
   - **Attribute:** `hideSourceView`
   - **Required:** Leave unchecked
   - **Dynamic Value Allowed:** CHECK
   - **Call By Ref.:** Leave unchecked
   - **Bindable:** Leave unchecked
   - **Typing Method:** `1 TYPE`
   - **Associated Type:** `STRING`
   - **Default Value:** `TRUE`
   - **Description:** Hide the Source View button
8. Change the default value for `filterDocumentContent` from `FALSE` to `TRUE`.
9. Save and activate using the activate button in the top toolbar.

**Download and Further Information:**

- [Download for SNOTE](https://me.sap.com/notes/0040000009361912017)
- [PDF Version](https://me.sap.com/support/sfm/notes/print/0001577766?language=en-US&token=ECD73AABE88AD03B65FBE1F0F3F0DFBC)
- [Edit Note](https://me.sap.com/support/notes/edit/0001577766)
- [Show Changes](https://me.sap.com/support/notes/compare/0001577766)
  
**References:**

- [1768871 - BTF Editor: convert css rgb color definition to hex format](https://me.sap.com/notes/1768871)

**Software Components Affected:**

- **CRMUIF:** Versions 510, 520, 600
- **WEBCUIF:** Versions 700, 701, 730, 746

**Support Packages:**

Ensure you have the appropriate support packages installed for your software component versions. For example:
- **WEBCUIF 700:** [SAPK-70011INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70011INWEBCUIF) or [SAPK-70010INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70010INWEBCUIF)

For a complete list of support packages and their URLs, visit [Support Packages](https://me.sap.com/supportpackage/).

**Credit:**
Information supported by [RedRays](https://redrays.io).