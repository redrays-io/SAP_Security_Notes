SAP Security Note 1878371: Security Audit Log Vulnerability

**Symptom**

BC-SEC-SAL contains code that permits the execution of a dedicated program code that allows the user to delete an important file.

**CVSS Information**

- **CVSS Base Score:** 4.1
- **CVSS Base Vector:** AV:L/AC:M/AU:S/C:P/I:P/A:P

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://service.sap.com/securitynotes/).

**Other Terms**

kernel function, file handling, BC-SEC-SAL

**Reason and Prerequisites**

The system contains a possibility to execute a special kernel function in an unintended way. The code is protected by an ABAP function and the kernel call authorization object, only. A developer with the authorization to code arbitrary programs and with the authorization for this kernel function can call the function in his program and harm the system.

- A valid and authenticated user is required.
- The user needs at least authorization for `S_DEVELOP` and `S_C_FUNCT`.
- The authorization object `S_C_FUNCT` is not checked when the kernel parameter `auth/system_access_check_off` is set.
- With these authorizations, the user can delete data.

**Solution**

1. **Apply the Relevant Kernel Patch**
   
   Ensure that you apply the relevant kernel patch as specified in the [Support Package Patches](#support-package-patches) section below.

2. **Review Additional Protection Measures**
   
   - Review the information provided in [SAP Note 177702](https://me.sap.com/notes/177702). This note describes how to further protect your files by assigning authorizations to access operating system files using ABAP commands.
   - In general, files of the Security Audit Log must not be read by ABAP commands. Protect them by assigning the appropriate `S_DATASET` authorizations to your users and by using `S_PATH` protection as described in [Note 177702](https://me.sap.com/notes/177702).
   - Use a dedicated folder for Security Audit Log files. Enter this directory into the `SPTH` table and enable the flags `FS_NOWRITE` and `FS_NOREAD`, thus disabling any read or write access from ABAP to this directory.
   - Configure the Security Audit Log (parameter `DIR_AUDIT`) to use this directory.

**Support Package Patches**

| Software Component Version | Support Package | Patch Level | URL |
|----------------------------|-----------------|-------------|-----|
| SAP KERNEL 7.40 64-BIT     | SP025           | 000025      | [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200022526&V=MAINT) |
| SAP KERNEL 7.40 64-BIT UNICODE | SP025       | 000025      | [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019652&V=MAINT) |
| SAP KERNEL 7.38 64-BIT     | SP032           | 000032      | [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200022123&V=MAINT) |
| SAP KERNEL 7.38 64-BIT UNICODE | SP032       | 000032      | [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019649&V=MAINT) |
| SAP KERNEL 7.21 EXT 64-BIT | SP126         | 000126      | [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200021405&V=MAINT) |
| SAP KERNEL 7.21 32-BIT     | SP126           | 000126      | [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200021235&V=MAINT) |
| ...                        | ...             | ...         | ... |

*For the full list of support package patches, please refer to the [Support Package Patches](https://me.sap.com/softwarecenter/) section of the SAP Security Note.*

**Translations**

This document is available in multiple languages, including German, Japanese, Portuguese, Spanish, French, Italian, Russian, Chinese, and Korean. Access the translations [here](https://me.sap.com/notes/0001878371).

**Additional Information**

- **Component:** Basis Components > Security - Read KBA 2985997 for subcomponents > Security Audit Log
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 08.04.2014

**Credits**

Information supported by [Redrays.io](https://redrays.io).