SAP Security Note 1881391 - MDX: XML for Analysis - known security holes

**SAP Security Note 1881391** addresses critical security vulnerabilities related to the XML for Analysis (XMLA) interface in SAP Business Warehouse (BW). Below are the key details from the note:

### **Overview**
- **Note Number:** 1881391
- **Type:** SAP Security Note
- **Released On:** July 9, 2013
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Component:** SAP Business Warehouse > Business Explorer > OLAP Technology > MDX, OLAP-BAPI, OLE DB for OLAP

### **Symptom**
SAP BW provides multiple interfaces for data access using Multidimensional Expressions (MDX):
- OLAP BAPI (Business Application Programming Interface)
- OLE DB for OLAP
- XML for Analysis (XMLA)

While most front-end tools utilize OLAP BAPIs, access via OLE DB for OLAP is less common, and XMLA usage is rare. **Security vulnerabilities exist in the XMLA interface** if the relevant security notes are not implemented, potentially allowing unauthorized access and various attacks.

### **CVSS Information**
- **Base Score:** 4.0
- **Vector:** AV:N/AC:L/AU:S/C:P/I:N/A:N

*Note:* The CVSS score provided is an estimate and does not account for specific system configurations or environments.

### **Reason and Prerequisites**
When the XMLA interface is invoked, the system processes and parses XML documents, which can be exploited through:
- MDX Security Tag Injection
- XML External Entity (XXE) attacks
- XML Bombs
- XSLT Code Injection

These vulnerabilities may be exploited if the XMLA service is activated in the Internet Communication Framework (transaction SICF), even if no applications currently utilize this interface. Products that can interact with the XMLA interface include:
- Microsoft Reporting Services (see [SAP Note 1868077](https://me.sap.com/notes/1868077))
- Oracle Business Intelligence Enterprise Edition

### **Solution**
- **Apply Security Notes 1530454 and 1597066:** These notes address and close the known security vulnerabilities.
- **Deactivate XMLA Interface:** If the XMLA interface is not in use, it is recommended to deactivate it to prevent potential attacks.
  - **Service Path:** `/default_host/sap/bw/xml/soap/`
  - **Service Name:** `xmla`
  - **Transaction Code:** SICF

For more details and to access the full security note, visit [SAP Security Note 1881391](https://me.sap.com/notes/1881391).

### **References**
- [SAP Note 1889488](https://me.sap.com/notes/1889488) - Briefing at Black Hat conference on July 31st, 2013
- [SAP Note 1868077](https://me.sap.com/notes/1868077) - MDX: Microsoft Reporting Services - problems with BW 7.30 and higher releases
- [SAP Note 1597066](https://me.sap.com/notes/1597066) - MDX: SOAP / XMLA interface and Document Type Definitions
- [SAP Note 1530454](https://me.sap.com/notes/1530454) - MDX: XML injection when an XMLA interface is used

### **Affected Software Components**
- **SAP_BW:** Versions 30A to 30B, 310, 350, 700 to 702, 711 to 730, 731, 740
- **SAP_BW_VIRTUAL_COMP:** Versions 701, 711

For more information on supported software components and patches, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*