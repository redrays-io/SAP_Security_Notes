1876343 - Missing authorization check in BC-SRV-KPR-DMS

**SAP Note Number**: 1876343  
**Type**: SAP Security Note  
**Version**: 4  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer  
**Released On**: 07.10.2013  

**Component**:  
Basis Components > Basis Services/Communication Interfaces > Knowledge Provider > Document Management Services

---

### **Description**

**Symptom**  
An unauthenticated user can use functions of BC-SRV-KPR-DMS to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**  
- **Base Score**: 6.0  
- **Base Vector**: AV:N/AC:M/AU:S/C:P/I:P/A:P  

_SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/)._

**Other Terms**  
Authorization, authorization check, BC-SRV-KPR-DMS

**Reason and Prerequisites**  
BC-SRV-KPR-DMS does not contain authorization checks for checking an authenticated user's authorization to access some of its functions. This may result in undesired system behavior.

**Solution**  
We have done the code changes. Please implement the note.

---

### **CVSS**

**CVSS Score**: 6.0  
**CVSS Vector**: AV:N/AC:M/AU:S/C:P/I:P/A:P

---

### **Affected Software Components**

| Software Component | From | To   |
|--------------------|------|------|
| SAP_BASIS          | 620  | 640  |
| SAP_BASIS          | 700  | 702  |
| SAP_BASIS          | 710  | 730  |
| SAP_BASIS          | 731  | 731  |
| SAP_BASIS          | 740  | 740  |

---

### **Support Packages**

| Software Component Version | Support Package | URL                                     |
|----------------------------|-----------------|-----------------------------------------|
| SAP_BASIS 620              | SAPKB62074      | [SAPKB62074](https://me.sap.com/supportpackage/SAPKB62074) |
| SAP_BASIS 640              | SAPKB64032      | [SAPKB64032](https://me.sap.com/supportpackage/SAPKB64032) |
| SAP_BASIS 700              | SAPKB70030      | [SAPKB70030](https://me.sap.com/supportpackage/SAPKB70030) |
| SAP_BASIS 701              | SAPKB70115      | [SAPKB70115](https://me.sap.com/supportpackage/SAPKB70115) |
| SAP_BASIS 702              | SAPKB70215      | [SAPKB70215](https://me.sap.com/supportpackage/SAPKB70215) |
| SAP_BASIS 710              | SAPKB71018      | [SAPKB71018](https://me.sap.com/supportpackage/SAPKB71018) |
| SAP_BASIS 711              | SAPKB71113      | [SAPKB71113](https://me.sap.com/supportpackage/SAPKB71113) |
| SAP_BASIS 720              | SAPKB72008      | [SAPKB72008](https://me.sap.com/supportpackage/SAPKB72008) |
| SAP_BASIS 730              | SAPKB73011      | [SAPKB73011](https://me.sap.com/supportpackage/SAPKB73011) |
| SAP_BASIS 731              | SAPKB73110      | [SAPKB73110](https://me.sap.com/supportpackage/SAPKB73110) |
| SAP_BASIS 740              | SAPKB74005      | [SAPKB74005](https://me.sap.com/supportpackage/SAPKB74005) |

---

### **Correction Instructions**

| Software Component | Number of Correction Instructions | URL                                               |
|--------------------|-----------------------------------|---------------------------------------------------|
| SAP_BASIS          | 11                                | [Correction Instructions](https://me.sap.com/corrins/0001876343/41) |

---

### **Manual Activities**

```plaintext
   <P><br/><br/>------------------------------------------------------------------------<br/>|Manual Activity&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>------------------------------------------------------------------------<br/>|VALID FOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>|Software Component&nbsp;&nbsp; SAP_BASIS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAP Basis compo...|<br/>| Release 620&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Until SAPKB62073&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>| Release 640&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Until SAPKB64031&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>| Release 700&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAPKB70004 - SAPKB70029&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>| Release 710&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Until SAPKB71017&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>| Release 711&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAPKB71101 - SAPKB71112&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>| Release 701&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Until SAPKB70114&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>| Release 702&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAPKB70201 - SAPKB70214&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>| Release 730&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAPKB73001 - SAPKB73010&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>| Release 720&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAPKB72002 - SAPKB72007&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>| Release 731&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAPKB73101 - SAPKB73109&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br/>| Release 740&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Until SAPKB74004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>------------------------------------------------------------------------<br/><br/>--> Creation of Data Element "SDOK_FNCHK".  
1. Go to transaction SE11.  
2. Click on radio button for Data Type.  
3. Enter Data type field value as SDOK_FNCHK.  
4. Click on button Create.  
5. Select Radio button Data Element and press enter.  
6. Enter Short Description as "Exit function, authorization check in Remote Calls".  
7. Enter Domain value as FUNCNAME.  
8. Click on Field Label Tab and maintain following entries.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Length&nbsp;&nbsp;Field Label  
&nbsp;&nbsp;Short&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit-Func  
&nbsp;&nbsp;Medium&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit-Function,  
&nbsp;&nbsp;Long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Authorization Check  
&nbsp;&nbsp;Heading&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Authorization Check  
9. Click on Activate to activate the data element and choose the appropriate request in the generated popup.  
10. Enter Package as SDOK.  
11. Enter.  

--> Addition of new field to table "SDOKDOCSPH".  
1. Go to transaction SE11.  
2. Click on radio button for Database Table.  
3. Enter Database table as SDOKDOCSPH.  
4. Click on Change button.  
5. Select the last row and then click on Insert Row icon.  
6. Add field "FCT_ACC_CHK", Data element "SDOK_FNCHK".  
7. Press Enter.  
8. Click on activate to activate the table and choose the appropriate request in the generated popup.  

--> Addition of new field to view and adjusting the view.  
1. Go to transaction SE54.  
2. Enter view name as V_SDOKDCSP.  
3. Click on create/change button.  
4. Select row with view field as CREA_TIME and then click on Insert Row icon.  
5. Insert values in new row as:  
&nbsp;&nbsp;View Field: FCT_ACC_CHK  
&nbsp;&nbsp;Table: SDOKDOCSPH  
&nbsp;&nbsp;Field: FCT_ACC_CHK  
6. Press Enter and then click on activate to activate the view and choose the appropriate request in the generated popup.  
7. Now be in change mode and go to Utilities -> Table  
&nbsp;&nbsp;Maintenance Generator.  
8. Now click on change or Press F7.  
9. A popup will appear then which will ask for Reason for  
&nbsp;&nbsp;Change. Select option "New field/sec. table in structure" and press enter.  
10. Once more popup will appear for Change Generation Elements. Select Option Normal Field and press Enter.

---

**Credits**: [redrays.io](https://redrays.io) for support in providing this information.