2560741 - [CVE-2018-2371] Cross-Site Scripting (XSS) Vulnerability in SAML 2.0 Service Provider of AS Java

**Symptom**

The SAML 2.0 service provider of Application Server (AS) Java does not sufficiently encode user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability.

**Impacts of XSS Vulnerability:**
- Non-permanently defacing or modifying displayed content from a website.
- Stealing user authentication information, such as data related to the current session.
- Impersonating the user and accessing all information with the same rights as the target user.

**CVSS Information**
- **CVSS v3 Base Score:** 6.1 / 10
- **Vector:** 
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

_SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes)._

**Reason and Prerequisites**

Insufficient validation of the user input in the SAML 2.0 service provider of AS Java.

**Solution**

Apply the latest patches relevant to the version of AS Java according to the "SP Patch Level" section of this note. With the described fix, the user-controlled input is sufficiently encoded.

**Download and Documentation:**
- [Download for SNOTE](https://me.sap.com/notes/0040000000279682018)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002560741?language=en-US&token=1AB234B0AB893010D73E1A10F4985F0F)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002560741)

**Support Package Patches:**
- Multiple support package patches are available for different versions of Security Extensions (7.20, 7.30, 7.31, 7.40, 7.50). For detailed patch information, visit the [Support Package Patches](https://me.sap.com/sap/support/swdc/notes) section.

**References:**
- [CVE-2018-2371](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-2371)

**References by This Document:**
- [2566930 - Collective Note: SAP NetWeaver 7.30 SP18 - NWDS Update Site standalone](https://me.sap.com/notes/2566930)
- [2567013 - Collective Note: SAP NetWeaver 7.30 SP18 - Application Server Java](https://me.sap.com/notes/2567013)
- [2637693 - Central note for SAP NetWeaver 7.31 SP23 Application Server Java](https://me.sap.com/notes/2637693)
- [2627601 - Collective Note: SAP NetWeaver 7.5 SP12 - Application Server Java (AS Java)](https://me.sap.com/notes/2627601)

For more information, visit [SAP Support Notes](https://me.sap.com/notes/0002560741).

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*