SAP Security Note 2580634 - Unrestricted File Upload Vulnerability in GRC-PC / GRC-RM

---

**SAP Security Note 2580634 - Unrestricted File Upload Vulnerability in GRC-PC / GRC-RM**

### Description

**Symptom**

*GRC-PC / GRC-RM* allows an attacker to upload any file (including script files) without proper file format validation.

Some well-known impacts of an Unrestricted File Upload vulnerability include:

- Malicious file insertion or modification
- Makes the website vulnerable to other attacks such as XSS

**Other Terms**

Upload of untrusted files, File upload vulnerability.

**Reason and Prerequisites**

SAP Note [2058231](https://me.sap.com/notes/2058231) must be applied.

### Solution

It is recommended to implement the Support Package (SP).

Follow the attached [instructions](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125800003557842017&iv_version=0002&iv_guid=6CAE8B3EAD2B1ED7B9AAD7466983C0CE).

### Correction Instructions

1. **Create Database Table GRFNDOCUMENTWT**
   
   - Run transaction `SE11` and create a new database table `GRFNDOCUMENTWT`.
   - **Short Description:** Document upload extension white table.
   - **Add the following new Fields/Types into the table:**
     - `MANDT / MANDT`
     - `SEQNR / GRFN_SEQNR`
     - `EXTENSION / W3FILEEXT`
     - `MIME_TYPE / W3CONTTYPE`
   - **Mark the following Fields as Primary Key:** `MANDT`, `SEQNR`
   - **Mark the following Fields as Initial Values:** `MANDT`, `SEQNR`
   - Go to the **Delivery and Maintenance** tab and set the delivery class to `C` (Customizing table).
   - Go to the **Attributes** tab and set **Package** to `GRFN_DOCUMENTS`.
   - Go to **Menu > Extract > Enhancement Category** and select the option **Cannot be enhanced**.
   - Enter the following technical settings:
     - **Menu > Goto > Technical settings**
     - **Data class:** APPL0
     - **Size category:** 0
     - **Buffering:** Buffering Activated
   - Check the checkbox **"Fully buffered"**.
   - Save and activate the changes.

2. **Create Database Table Maintenance View GRFNVDOCUMENTWT**
   
   - Run transaction `SE11` and create a new View named `GRFNVDOCUMENTWT`.
   - Select **Maintenance view** in the next step.
   - **Short Description:** Document upload extension white table.
   - Add table `GRFNDOCUMENTWT` in the **Table/Join Condition** tab.
   - Add the following View fields in the **Fields** tab:
     - `MANDT / GRFNDOCUMENTWT / MANDT`
     - `SEQNR / GRFNDOCUMENTWT / SEQNR`
     - `EXTENSION / GRFNDOCUMENTWT / EXTENSION`
     - `MIME_TYPE / GRFNDOCUMENTWT / MIME_TYPE`
   - Save and activate the changes.
   - Go to **Menu > Utilities > Table Maintenance Generator**.
   - Enter **Authorization Group:** SIMG.
   - Enter **Function group:** GRFNVDOCUMENTWT.
   - Enter **Package:** GRFN_DOCUMENTS.
   - Select **Maintenance type:** One step.
   - Enter **Overview screen:** 1.
   - Press the **Create** button on the toolbar.

### Validity

- **Software Components:**
  - `GRCFND_A` from V1100 to V1100
  - `GRCFND_A` from V8000 to V8000

### Side Effects

This document is causing side effects in:

- [2569713 - Enable logging of changes for attachment and links related customizing tables](https://me.sap.com/notes/2569713)

### CVSS

- **CVSS Score:** 0
- **CVSS Vector:** Not provided

### Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000115422018)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002580634?language=en-US&token=70522710578B01687320C716DA35CD10)

---

Credits to [Redrays.io](https://redrays.io) for support and provided information.