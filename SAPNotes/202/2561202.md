2561202 - Command Injection through Web Intelligence Report or DataProvider export

## Symptom

Users can insert unsafe Excel commands via Web Intelligence Data or Formula into a Report that will be executed by Excel when importing the exported CSV data from a Web Intelligence Report.

## Other Terms

WebI, Command Injection, Web Intelligence Report, DataProvider export

## Reason and Prerequisites

This fix is required because Web Intelligence outputs are supposed to be trusted. The CSV output is now escaped to disable the Excel capability of transforming string data into commands when Excel reads some special characters.

Before the attacks can be performed, Excel users must manually accept running these commands.

## Solution

This issue is fixed in the patches listed in the "Support Packages & Patches" section below. The "Support Packages & Patches" section will be populated with the relevant patch levels once they are released.

For the Business Intelligence Platform maintenance schedule and strategy, see [Knowledge Base Article 2144559](https://me.sap.com/notes/2144559).

## Support Package Patches

### SBOP BI PLATFORM SERVERS 4.2
- [SP004 Patch Level 000006](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
- [SP003 Patch Level 000013](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)

### SBOP BI PLATFORM SERVERS 4.1
- [SP009 Patch Level 000009](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
- [SP008 Patch Level 000013](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
- [SP011 Patch Level 000000](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
- [SP010 Patch Level 000003](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)

### SBOP BI PLATFORM SERVERS 4.0
- [SP012 Patch Level 000006](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200013179&V=MAINT)

## CVSS

- **Score:** 6.5
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L

## References

- [BI 4.x Maintenance Strategy & Schedule (2144559)](https://me.sap.com/notes/2144559)
- [SAP Note 2708439: '-' characters gets replaced by ' -' in the csv file when exporting a report in Web Intelligence](https://me.sap.com/notes/2708439)

Credits to [Redrays.io](https://redrays.io) for support in providing this information.