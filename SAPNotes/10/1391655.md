1391655 - Authorized access to SAPFTP

**SAP Security Note 1391655: Authorized access to SAPFTP**

**Type:** SAP Security Note  
**Version:** 3  
**Released On:** 12.02.2013  
**Category:** Consulting  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Component:** Basis Components > Basis Services/Communication Interfaces > Communication Services: Mail, Fax, SMS, Telephony > File Transfer via FTP (BC-SRV-COM-FTP)

---

### **Symptom**
The settings defined for SAPFTP do not include authorization checks based on the user or the source of the request. No authorization checks are performed in the system when starting the external program SAPFTP.

**Note:** Every ABAP installation includes the external program SAPFTP. To ensure system security, authorized access to this program is necessary and can be achieved by implementing this note. These settings need to be maintained regardless of whether SAPFTP is used or not.

*This security note has been updated. For more detailed information, see [Security Note 1819543](https://me.sap.com/notes/1819543).*

### **Reason and Prerequisites**
**Prerequisite:**  
- [Note 1298433](https://me.sap.com/notes/1298433) becomes the prerequisite note, which ensures that the SAP Gateway Access Control Lists cannot be bypassed.

### **Solution**
Implement an access control list in the SAP gateway to enable a secure system that prevents unauthorized access. Follow these steps based on different usage scenarios of SAPFTP:

#### **Usage Scenarios:**
- **Scenario A:** External Program started on the same application server.
- **Scenario B:** External Program started on the Front End Machine.
- **Scenario C:** External Program started on an Explicit Host where the call is initiated from the source application server "src_as" (local system) to start SAPHTTP on target application server "trgt_as".
- **Scenario D:** When external program SAPFTP is not used.

#### **Steps to Maintain Security Settings:**

1. **Maintain the `secinfo` File:**
   - Location: `/usr/sap/<SID>/data/secinfo` (default path).
   - **For Scenarios A and B:**
     ```plaintext
     USER=<user name>, USER-HOST=local, HOST=local, TP=sapftp;
     ```
     This allows the specified user to access the SAPFTP program within the same application server or on the front-end machine.

   - **For Scenario C: Based on User:**
     - **Settings in Application server "src_as":**
       ```plaintext
       USER=<user name>, USER-HOST=local, HOST=<trgt_as>, TP=sapftp;
       ```
     - **Settings in Application server "trgt_as":**
       ```plaintext
       USER=<user name>, USER-HOST=<src_as>, HOST=local, TP=sapftp;
       ```
     This allows the specified user to access SAPFTP on "trgt_as" from "src_as".

   - **For Scenario C: Based on Source of Request:**
     - **Settings in Application server "src_as":**
       ```plaintext
       USER=*, USER-HOST=local, HOST=<trgt_as>, TP=sapftp;
       ```
     - **Settings in Application server "trgt_as":**
       ```plaintext
       USER=*, USER-HOST=<src_as>, HOST=local, TP=sapftp;
       ```
     This allows access to SAPFTP on "trgt_as" only if the request comes from "src_as".

   - **For Scenario D:**
     ```plaintext
     USER=*, USER-HOST=local, HOST=local, TP=sapftp;
     ```
     This restricts requests to the local application server only, blocking all external requests.

2. **Configure Profile Parameter:**
   - Use transaction `RZ11` to set the profile parameter `gw/sec_info` pointing to the location of the `secinfo` file.
   - Default value: `/usr/sap/<SID>/data/secinfo`

3. **Activate the Configuration File:**
   - Use transaction `SMGW`.
   - Navigate to `Goto → Expert Functions → External Security → Read Again`.

4. **Maintain Gateway Logging (If Necessary):**
   - Use transaction `SMGW`.
   - Navigate to `Goto → Expert Functions → Logging`.
   - Save and activate these settings.

5. **Repeat on All Application Servers:**
   - Repeat steps 1-4 on every application server instance of the R/3 system.

**Important:**
- Settings in the `secinfo` file are case-sensitive.
- Maintain one entry for every authorized user or application server as required.
- Security settings for SAPFTP are active only if the `secinfo` file exists with the correct entries. Refer to [Note 110612](https://me.sap.com/notes/110612) for further details.

### **References**
- [Problems with SAPFTP (93042)](https://me.sap.com/notes/93042)
- [Update 1 to security note 1391655 (1819543)](https://me.sap.com/notes/1819543)
- [Overview note: "reg_info" and "sec_info" (1305851)](https://me.sap.com/notes/1305851)
- [Bypassing security in reginfo & secinfo (1298433)](https://me.sap.com/notes/1298433)

### **Available Translations**
- [Deutsch](https://me.sap.com/notes/0001391655/D)
- [日本語](https://me.sap.com/notes/0001391655/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001391655/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001391655/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001391655/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001391655/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001391655/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001391655/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001391655/3)

---

*For more information and support, visit [me.sap.com](https://me.sap.com/).*

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*