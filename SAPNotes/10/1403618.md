1403618 - PCI Data Security in SAP POS

**SAP Note Number:** 1403618  
**Type:** SAP Security Note  
**Version:** 2  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 23.11.2009  
**Component:** IS-R-TGM-POS

### Symptom

Credit card data is being retained within the SAP POS application in plain text in a specific file within the btree database while a particular flag is set for pending transactions. This violates the Payment Card Industry (PCI) Data Security Standard, posing a security risk for retailers.

### Other Terms

- Credit Card
- POS
- Encryption
- PCI

### Solution

#### Affected Versions

- **SAP POS v1.0** (POS v9.5 and all customer branches)
- **SAP POS v2.0** (POS v10.0 and all customer branches)
- **SAP POS v2.1** (POS v10.1 and all customer branches)
- **SAP POS v2.2** (POS v10.2 and all customer branches)

#### Determining the Version

Run Manager Code 999 from the POS UI to determine the SAP POS application version.

#### Fixed Versions and Patch Levels

Core Product SAP POS v2.1 and v2.2 have been corrected and are available on the [Service Marketplace](https://me.sap.com/).

#### Obtaining Fixed Versions

Contact Active Global Support to coordinate a fix.

#### Risk if Not Patched

If the security fix is not applied and the Pending Transaction capability is used, credit card data may appear in plain text within pending transaction data files.

#### Workaround

Disable the **"Retain Detail"** option under the Pending Transaction component in the Configurator solution. Deploy this configuration change across all stores to prevent capturing customer credit card details in pending transaction data files.

#### Mitigation Options

A security update has been completed by SAP and can be obtained from Active Global Support.

#### Impact on Business Processes

The security update can be applied via the Unattended Upgrade capability. Refer to user manuals and documentation for details on the Unattended Upgrade.

#### Testing the Update

After applying the update, perform a test by enabling **"Retain Detail"** under the Pending Transaction component in the Configurator, complete a Pending Transaction, and verify that credit card details are not written to the `data.tdd` file located in the POS `\rdata` directory.

### Downloads

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016900742017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001403618?language=en-US&token=566FCC3FB1917D6BB8272C6EC379ED62)

Credits to [Red Rays](https://redrays.io) for supporting the provided information.