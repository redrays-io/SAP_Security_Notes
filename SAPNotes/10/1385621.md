1385621 - Security: XSS vulnerability in ITS 6.20

**Description**

ITS 6.20 contains a cross-site scripting (XSS) vulnerability on the login page. If a service name with specially encoded characters is selected instead of a standard service name like **WEBGUI**, the embedded JavaScript code can be executed within the context of the login page.

*Credits to Erwin Paternotte, Fox-IT BV ([https://www.fox-it.com](https://www.fox-it.com)), who reported this issue to SAP.*

**Affected Components**

- **Software Component:** BC-FES-ITS
- **Version:** 6.20
- **Valid From:** 620
- **Valid To:** 620

**Solution**

1. **Apply Patch 35:**  
   This patch is available for download from the [SAP Service Marketplace](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200005189&V=MAINT).

2. **Manual Code Correction:**  
   For ITS servers using patch level 34 or lower, and before patch 35 is available, implement the following source code corrections:

   - **Windows Path:**  
     `\Program Files\SAP\ITS\6.20\<INSTANCE>\templates\system\dm\login.html`

   - **Linux Path:**  
     `/usr/sap/its/6.20/<INSTANCE>/templates/system/dm/login.html`

   - **Steps:**
     1. After the line:
        ```html
        include( ~service="system", ~theme="dm", ~language="", ~name="its_util.html");
        ```
        add:
        ```javascript
        mywgateurl = wgateurl();
        mywgateurl = strmask(mywgateurl);
        ```
        *(Ensure that the accent grave character \` is not deleted.)*

     2. Replace all calls to `wgateURL()` with `mywgateurl.`  
        *(Again, ensure that the accent grave character \` is not deleted.)*

   - **Post-Correction:**  
     After making these changes, use the ITS administration tool to invalidate the template cache or restart the relevant ITS instance.

**References**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016870512017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001385621?language=en-US&token=CBE27EDBABDE3204615DB7FDCA6A7C85)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001385621/E/diff)

**Credits**

Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.