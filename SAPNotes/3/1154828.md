SAP Security Note 1154828 - Cross-site scripting (XSS) attack using control sequences

**Description**
This SAP Security Note addresses a Cross-site scripting (XSS) vulnerability that occurs when control sequences (e.g., TAB `&lt;=&gt;` 0x09) are inserted, potentially bypassing existing filter mechanisms. In Web Dynpro for ABAP, the standard element `sap-ep-themeroot` can be exploited to include external JavaScript (JS) code.

**Symptoms**
- Insertion of control sequences can lead to XSS attacks.
- Example: The JS statement `javascr%09ipt:alert('hallo')` is interpreted as `javascript:alert('hallo')` in Internet Explorer 6 (IE6), ignoring existing filters.

**Reason and Prerequisites**
- Affected browsers include Internet Explorer 6, Firefox 1, Netscape 8 in IE mode, and Opera 9.02.
- These browsers allow external code insertion by merging with control sequences.

**Solution**
1. **Upgrade Browsers:** 
   - Use newer browser versions (e.g., IE7, Firefox 2) where JS code cannot be executed with control sequences. This issue is recognized as a browser error, and browser vendors are expected to address it.
   - Reference: [OWASP](http://www.owasp.org)

2. **Implement Correction Instructions:** 
   - If upgrading browsers is not feasible, apply the attached correction instructions provided in the SAP Note.
   - The corrections enhance filter rules to recognize control sequences in active HTML tags, mitigating the vulnerability.
   - Note: These changes are not part of the standard SAP system and should be used as an immediate measure to protect against old browsers.

**Affected Components**
- **SAP_BASIS** versions 700 to 701 and 710 to 711.

**Download and Documentation**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000006958532017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001154828?language=en-US&token=7F4A38885672525D92D8230D47A286DC)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001154828)

**References**
- [Composite SAP Note: HCM Authorizations Documentation](https://me.sap.com/notes/1261193)
- [Composite SAP Note: XSS Documentation](https://me.sap.com/notes/1245560)
- [Stricter Check in Method CL_HTTP_UTILITY=>IS_VALID_URL](https://me.sap.com/notes/1236155)

**Correction Instructions**
- [SAP_BASIS Correction Instructions](https://me.sap.com/corrins/0001154828/41)

For more details, visit the [SAP Security Note 1154828](https://me.sap.com/notes/1154828).

---

*Credits to [RedRays](https://redrays.io) for supporting the information provided.*