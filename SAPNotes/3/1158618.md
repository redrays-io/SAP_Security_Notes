1158618 - Security note: Additional checks in dscdb6up

**SAP Security Note 1158618**  
**Type:** SAP Security Note  
**Version:** 4  
**Released On:** 08.10.2009  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Category:** Program error  
**Language:** English  

### Description

Members of the `sapsys` group can damage files of other users on UNIX by using the program `dscdb6up` incorrectly.

**Other Terms:**  
dscdb6.conf, password, DB6, UDB, LUW, DB2UDB, DB2LUW

**Reason and Prerequisites:**  
The program `dscdb6up` belongs to the group `sapsys` and has an SUID bit (`chown root:sapsys ; chmod 4750`), allowing users to change their operating system passwords, which connect them to the SAP database. Members of the `sapsys` group can exploit a gap in C-coding to overwrite other users' files with the content of the password file.

### Solution

Use a current version of the program `dscdb6up` to prevent intentional system damage.

**Patch text:** "DB6: additional security checks"

**To avoid the problem, proceed as follows:**

1. **If unsure about the current version of `dscdb6up`, remove the SUID bit:**
   ```bash
   chmod 750 dscdb6up
   ```
   Without the SUID bit, `dscdb6up` cannot change any operating system passwords.

2. **Change the passwords using operating system means.**

3. **Recreate the password file using:**
   ```bash
   dbscdb6up -create...
   ```

### Download and Resources

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016620812017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001158618?language=en-US&token=0E9C454222848B10E5B4C648B5F8B8E4)

For more details, visit the [SAP Notes](https://me.sap.com/) portal.

*Credits to [https://redrays.io](https://redrays.io) for support to provided information.*