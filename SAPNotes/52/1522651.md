1522651 - XSRF activation in ITS Services

**SAP Security Note 1522651 - XSRF Activation in ITS Services**

**Description:**

This security note addresses a Cross-Site Request Forgery (XSRF) vulnerability in the Supplier Relationship Management (SRM) system's ITS services. An attacker could exploit this vulnerability to perform unauthorized actions within the SRM system.

**Important Note:**

- On **SRM 4.0 (SRM_SERVER 500)**, the correction only works with the integrated **ITS 6.40**. External ITS 6.20 is not supported at this time.

**Affected Components:**

- **SRM_SERVER:**
  - Versions: 500, 550

- **SAP_ABA:**
  - Versions: 640, 700

**Solution:**

1. **Prerequisite:**
   - Implement the corrections from [SAP Note 1481392](https://me.sap.com/notes/1481392). This is essential before applying this security note.

2. **Implement Correction Instructions:**
   - Follow the correction instructions detailed in [Security Note 1522651](https://me.sap.com/notes/1522651). This will create the report `ITS_XSRF_PARAM_SRM` in your system.

3. **Execute the Report:**
   - Run the `ITS_XSRF_PARAM_SRM` report and provide a transport request number when prompted. This will add necessary service parameters for the adapted ITS services within transaction SICF.

4. **Post-Implementation Steps:**
   - **Option A: Apply SRM Correction via Support Package**
     - Apply the corresponding Support Package:
       - **SRM_SERVER 500:** [SAPKIBKS17](https://me.sap.com/supportpackage/SAPKIBKS17)
       - **SRM_SERVER 550:** [SAPKIBKT18](https://me.sap.com/supportpackage/SAPKIBKT18)
   
   - **Option B: Apply SRM Code Changes via SNOTE**
     - Use SNOTE to apply the SRM code changes. Ensure you have at least SRM_SERVER 500/550 SP 15. Lower SP releases might work but are not guaranteed.

   - **Additionally, update SAP_ABA:**
     - **Option A: Apply SAP_ABA Correction via Support Package**
       - **SAP_ABA 640:** [SAPKA64028](https://me.sap.com/supportpackage/SAPKA64028)
       - **SAP_ABA 700:** [SAPKA70024](https://me.sap.com/supportpackage/SAPK70024)
   
     - **Option B: Apply SAP_ABA Code Changes via SNOTE**
       - Use SNOTE to apply the SAP_ABA code changes.

**Prerequisites:**

- Ensure that [SAP Note 1481392](https://me.sap.com/notes/1481392) is implemented as it is a prerequisite for this security note.

**References:**

- [SAP Note 1536087](https://me.sap.com/notes/1536087) - Update #1 to security note 1522651
- [SAP Note 1536193](https://me.sap.com/notes/1536193) - Update #2 to security note 1522651
- [SAP Note 1518849](https://me.sap.com/notes/1518849) - SRM 5.0 SP stack 18 release

**Side Effects:**

Implementing this security note may require applying updates from [SAP Note 1536087](https://me.sap.com/notes/1536087) and [SAP Note 1536193](https://me.sap.com/notes/1536193).

**Download and Print:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009029472017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001522651?language=en-US&token=4597C77A68F93EF9F7150D8F644D2B3A)

*Thanks to [redrays.io](https://redrays.io) for support in providing this information.*