Directory Traversal Vulnerability in BC-SRV-KPR-CMS (SAP Note 1522787)

**SAP Note Number:** [1522787](https://me.sap.com/notes/1522787)

**Title:** Directory Traversal in BC-SRV-KPR-CMS

**Type:** SAP Security Note  
**Version:** 9  
**Release Date:** December 14, 2010  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Component:** [Knowledge Provider (BC-SRV-KPR)](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC-SRV-KPR*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

---

### **Description**
BC-SRV-KPR-CMS contains a vulnerability that allows a malicious user to potentially write arbitrary files on the remote server. This can lead to data corruption or alteration of system behavior.

**Symptom:**  
- Unauthorized file writing on the server.
- Possible data corruption or system behavior changes.

**Reason:**  
BC-SRV-KPR-CMS fails to correctly validate the path where a user-submitted file is written, enabling an attacker to overwrite data on the remote system.

**Prerequisite:**  
- [SAP Note 1497003](https://me.sap.com/notes/1497003) is required before implementing this note.

### **Solution**
Refer to [SAP Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The corrections from this note are necessary for the implementation of SAP Note 1522787.

**Logical File Names Used:**
- `KPRO_IMPORT_EXPORT` – Enables validation of physical file names.

### **Affected Software Components**
- **SAP_BASIS** versions: 46B, 46C, 620, 640, 700, 701, 702, 710, 711, 720, 730

### **Support Packages**
Ensure that the relevant support packages are applied for your SAP_BASIS version. [Download Support Packages](https://me.sap.com/supportpackage/SAPKB46B62) (replace the URL with the appropriate support package link based on your version).

### **References**
- [Potential directory traversals in applications (SAP Note 1497003)](https://me.sap.com/notes/1497003)
- [Directory Traversal in BC-SRV-KPR-CMS (SAP Note 1502295)](https://me.sap.com/notes/1502295)

### **Available Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009030242017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001522787?language=en-US&token=A05030A2B1203DD55DD46469FE574937)
- [Share by Email](https://me.sap.com/notes/1522787/share)
- [Open in New Window](https://me.sap.com/notes/1522787)

### **Translations Available**
- [Deutsch](https://me.sap.com/notes/1522787/D)
- [日本語](https://me.sap.com/notes/1522787/J)
- [Português](https://me.sap.com/notes/1522787/P)
- [Español](https://me.sap.com/notes/1522787/S)
- [Français](https://me.sap.com/notes/1522787/F)
- [Italiano](https://me.sap.com/notes/1522787/I)
- [Русский](https://me.sap.com/notes/1522787/R)
- [中文](https://me.sap.com/notes/1522787/1)
- [한국어](https://me.sap.com/notes/1522787/3)

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*