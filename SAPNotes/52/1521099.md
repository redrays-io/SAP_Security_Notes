SAP Security Note 1521099 - Directory Traversal in MM-PUR-VM-SET

**Summary**

SAP Security Note **1521099** addresses a directory traversal vulnerability in the component **MM-PUR-VM-SET**. This vulnerability affects reports **RWMBONF0**, **RWMBONF1**, and **RWMBONF2**, allowing malicious users to access or overwrite arbitrary files on the application server.

**Details**

- **SAP Note/KBA**: 1521099
- **Type**: SAP Security Note
- **Version**: 3
- **Recency**: New
- **Language**: English (Master Language: German)
- **Category**: Program error
- **Priority**: Correction with high priority
- **Status**: Released for Customer
- **Released On**: 14.12.2010
- **Component**: Materials Management > Purchasing > Vendor-Material Relationships and Conditions > Subsequent Settlement

**Description**

There is a potential directory traversal in the component **MM-PUR-VM-SET**. The reports **RWMBONF0** and **RWMBONF2** contain vulnerabilities that allow a malicious user to access arbitrary files. Additionally, the report **RWMBONF1** allows overwriting arbitrary files on the application server, leading to potential data deletion.

**Solution**

Refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional information. The corrections in this note are a prerequisite for implementing the solution for Note 1521099.

**Key Actions:**
- **Create Logical File Names**: Use logical file name `MM-PUR-VM-SET-MCKONAB` to validate physical file names.
- **Maintain Physical Paths**: Ensure the physical path for the logical path `MM_PUR_VM_SET_PATH` is correctly maintained using transaction FILE.
- **Update Programs**: Apply the changes to programs `RWMBONF0`, `RWMBONF1`, and `RWMBONF2` to use the validated paths.

**Prerequisites**

- **SAP Note 1497003** must be applied.
- Logical file names must be properly maintained using transaction FILE or SF01.

**Support Packages**

Applicable support packages are available for various versions of SAP_APPL, including 40B, 45B, 46B, 46C, 470, 500, 600, 602, 603, 604, and 605. Refer to the [Support Package](https://me.sap.com/supportpackage/SAPKH40B89) relevant to your system version.

**References**

- **This document refers to**: [Note 1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)
- **Related Links**:
  - [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009020012017)
  - [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001521099?language=en-US&token=C29A7CD8F83E6B1873CB6C22E4170486)

**CVSS**

- **Score**: 0
- **Vector**: Not provided

**Translations**

Available translations include Deutsch (Origin), Japanese, Portuguese, Spanish, French, Italian, Russian, Chinese, and Korean machine translations.

**Conclusion**

Applying SAP Security Note **1521099** is crucial for addressing directory traversal vulnerabilities in the **MM-PUR-VM-SET** component. Ensure all prerequisites are met and support packages are up to date to maintain system security.

*Credits to [RedRays](https://redrays.io) for support in providing this information.*