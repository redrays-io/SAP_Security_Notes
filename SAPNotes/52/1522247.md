SAP Security Note 1522247 - Unauthorized usage of application functionality in DMS

**Symptom**

A malicious user can trigger functionality in the services CVW1, CVW3, CVW3A, CVW4, CVW4A, CVWG, DVS_FAVORITE_1, SHOW_DOCS_1, CVWD, CVSE_MAINTAIN, and CVSE_SEARCH without authentication and authorization.

**Other Terms**

- Cross-Site Request Forgery (CSRF)
- XSRF
- Internal Service Request

**Reason and Prerequisites**

The services mentioned above execute certain functions by referencing specific URLs. An attacker can trick an authenticated user's browser into making a request containing a certain URL and specific parameters, causing the function to execute with the user's privileges. This can be achieved through:
- Cross-Site Scripting (XSS) attacks
- Presenting a malicious link for the victim to click

**Solution**

Implement the changes provided in this note. For release 605 of SAP_APPL, follow these steps:

1. **Start transaction SICF.**
2. **For each affected service:**
   - Enter the service name and execute SICF. You can find the services under the path `/sap/bc/gui/sap/its/<service>`.
   - Double-click the service name in the tree and switch to change mode.
   - Select the **GUI Configuration**.
   - Add the parameter `~XSRFCHECK` with the value `1`.
   - Save the settings.

**Important Notes:**

1. **Prerequisite:** Refer to [SAP Note 1481392](https://me.sap.com/notes/0001481392) for additional information and instructions. Implementing the corrections from this note is required before applying the changes in this note.
2. **Correction Instructions:** Implement the correction instructions provided in this note, which will create the report `ITS_XSRF_PARAM_DMS` in your system.
3. **Execute Report:** Run the report `ITS_XSRF_PARAM_DMS` and provide a corresponding transport request number when prompted. This report will add service parameters for the adapted ITS services, which are maintained via the GUI configuration pushbutton for a service within transaction SICF.

**Downloads:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009027012017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001522247?language=en-US&token=16083C49D13C7F5C2307CF6C5BB00C42)

**Language Translations:**
- [Japanese](https://me.sap.com/notes/0001522247/J)
- [Deutsch](https://me.sap.com/notes/0001522247/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0001522247/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001522247/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001522247/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001522247/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001522247/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001522247/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001522247/3)

**Support Packages:**
- **SAP_APPL 500:** [SAPKH50025](https://me.sap.com/supportpackage/SAPKH50025)
- **SAP_APPL 600:** [SAPKH60019](https://me.sap.com/supportpackage/SAPKH60019)
- **SAP_APPL 602:** [SAPKH60209](https://me.sap.com/supportpackage/SAPKH60209)
- **SAP_APPL 603:** [SAPKH60308](https://me.sap.com/supportpackage/SAPKH60308)
- **SAP_APPL 604:** [SAPKH60409](https://me.sap.com/supportpackage/SAPKH60409)
- **SAP_APPL 605:** [SAPKH60504](https://me.sap.com/supportpackage/SAPKH60504)

**Correction Instructions:**
- [Implement Correction Instruction 1](https://me.sap.com/corrins/0001522247/1)

*Information provided with support from [redrays.io](https://redrays.io).*