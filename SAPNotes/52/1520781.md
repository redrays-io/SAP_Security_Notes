1520781 - Potential disclosure and modification of code and data

## SAP Security Note 1520781 - Overview

**Type:** SAP Security Note  
**Version:** 5  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** HotNews  
**Status:** Released for Customer  
**Released On:** 11.01.2011  
**Component:** IS-OIL-PRA  
**Title:** 1520781 - Potential disclosure and modification of code and data  

## Description

### Symptom
PRA contains code that permits the execution of arbitrary program code of the userâ€™s choice. A malicious user can therefore control the behavior of the system or potentially escalate privileges by executing malicious code without having their own legitimate credentials.

A malicious user can exploit PRA (Production and Revenue Accounting) and use specially crafted inputs to modify database commands. This results in either the retrieval of additional information or the modification of data persisted by the system.

### Other Terms
Security Note, Security Issue, Security Problem, Vulnerability, Exploit  
IS-Oil, industry solution, IS-OIL-PRA,  
Oil and Gas Upstream, Production and Revenue Accounting, Backdoor, injection, run, credentials, SQL injection, database, PDM.

### Reason and Prerequisites
The program code contains a possibility to define and execute user-defined code that changes the behavior of the system. A valid and authenticated user is required.

Depending on the code, the user can:
- Inject and run their own code
- Obtain additional information that should not be displayed
- Modify data, delete data
- Modify the output of the system
- Create new users with higher privileges
- Perform a denial of service attack

There is also an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve additional data from the database or to modify the data.

## Solution
Applying the note will protect the application from the following vulnerabilities:
1. **Dynamic SQL Injection**
2. **Code Injection**

Hence, applying the note will prevent the PRA application from the above-mentioned security vulnerabilities.

## Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009017632017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001520781?language=en-US&token=60F8E262F285840F71E0E1F2FA09D965)

## References
- [888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)
- [1509344 - Potential disclosure and modification of persisted data](https://me.sap.com/notes/1509344)

## Valid Software Components
- **IS-OIL**: 600 to 600
- **IS-OIL**: 602 to 602
- **IS-OIL**: 603 to 603
- **IS-PRA**: 604 to 604
- **IS-PRA**: 605 to 605

## Support Packages
- **IS-OIL 600**: [SAPK-60019INISOIL](https://me.sap.com/supportpackage/SAPK-60019INISOIL)
- **IS-OIL 602**: [SAPK-60209INISOIL](https://me.sap.com/supportpackage/SAPK-60209INISOIL)
- **IS-OIL 603**: [SAPK-60308INISOIL](https://me.sap.com/supportpackage/SAPK-60308INISOIL)
- **IS-PRA 604**: [SAPK-60409INISPRA](https://me.sap.com/supportpackage/SAPK-60409INISPRA)
- **IS-PRA 605**: [SAPK-60503INISPRA](https://me.sap.com/supportpackage/SAPK-60503INISPRA)

## Correction Instructions
- **IS-PRA**: 2 Correction Instructions  
  [Link](https://me.sap.com/corrins/0001520781/6572)
- **IS-OIL**: 1 Correction Instruction  
  [Link](https://me.sap.com/corrins/0001520781/11)

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*