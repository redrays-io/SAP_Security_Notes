1900200 - Directory Traversal Vulnerability in BC-SRV-ARL

**Overview**
 
SAP has released Security Note **1900200** addressing a directory traversal vulnerability in the **BC-SRV-ARL** component. This vulnerability allows an attacker to potentially write arbitrary files on the remote server, which may lead to the disclosure of confidential information.

**Details**

- **Type:** SAP Security Note  
- **Released On:** December 10, 2013  
- **Category:** Program Error  
- **Priority:** Correction with High Priority  
- **Status:** Released for Customer  
- **Component Path:**  
  - Services & Support  
  - KBAs & Notes  
  - Basis Components > Basis Services/Communication Interfaces > ArchiveLink

**Description**

The vulnerability exists in Archivelink, where it fails to correctly validate the path to which a user-submitted file is written. Consequently, an attacker can overwrite data in the remote system.

**CVSS Information**

- **Base Score:** 4.6  
- **Vector:** AV:N/AC:H/AU:S/C:P/I:P/A:P  

*Note:* SAP provides this CVSS base score as an estimate of the risk posed by the issue. It is not intended to replace individual risk assessments.

**Affected Components**

This security note is applicable to the following software components:

- **SAP_APPL**
  - Releases: 31I, 40B, 45B
- **SAP_BASIS**
  - Releases: 46B to 46D, 620 to 640, 700 to 702, 710 to 730, 731, 740

Refer to the **Support Package** section in the original note for specific support package versions.

**Solution**

1. **Refer to Note 1497003** for additional information and instructions. The corrections from this note are prerequisites for implementing Note 1900200.
2. **Manual Pre-Implementation Steps:**
   - **Create Logical File Definitions:**
     - Go to the **FILE** transaction.
     - Create a Logical Filepath definition with the logical filepath `ARCHIVLINK_SERVERPATH_LP` and save.
     - Create a Logical Filename Definition with:
       - **Logical File:** ARCHIVLINK_SERVERPATH
       - **Data Format:** DIR
       - **Logical Path:** ARCHIVLINK_SERVERPATH_LP
     - Save the entry.
   - **Add Exception to Function Modules:**
     - Go to transaction **SE37**.
     - Open the function module `ARCHIVFILE_CLIENT_TO_SERVER`.
     - Enter **Edit** mode and navigate to the **Exceptions** tab.
     - Add the exception `NO_AUTHORIZATION` if it does not exist.
     - Save and activate the function module.
     - Repeat the same steps for the function module `ARCHIVFILE_SERVER_TO_CLIENT`.

**Prerequisites**

Ensure the following prerequisites are met before implementing this security note:

- **SAP_APPL** must have the relevant support packages installed (e.g., SAPKH31IB9 for Release 31I).
- **SAP_BASIS** must also have the appropriate support packages as listed in the support package section.

**Available Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011227562017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001900200?language=en-US&token=52C9875CCFD8DC65C3D45D131DDFE29E)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001900200/E/diff)

**Additional Information**

- **Externally Reported:** Yes
- **Translations Available:** Japanese, German, Portuguese, Spanish, French, Italian, Russian, Chinese, Korean (Machine Translations)

**Credits**

Information provided with support from [Redrays.io](https://redrays.io).