SAP Security Note 1902611 - Potential information disclosure relating to BC-SEC

**Description**

An attacker can discover information by accessing the database. This information could be used to allow the attacker to specialize their attacks against the own system or other systems.

**CVSS Information**

- **CVSS Base Score:** 2.1
- **CVSS Vector:** AV:N/AC:H/AU:S/C:P/I:N/A:N

_SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes FAQ](https://service.sap.com/securitynotes/)._

**Other Terms**

Information disclosure, SECSTORE, SecStoreDB, RSEC, RSECADMIN.

**Solution**

1. **Documentation Update**

   The documentation of the secure storage in the database has been updated to revoke the obsolete text and replace it with new information recommending the use of your own encryption key.

2. **Key Management Support**

   The administration program for the secure storage (transaction `SECSTORE`) now indicates the encryption key method currently used and offers a link to a key management tool that guides you through introducing or updating your own key.

3. **Recommendation for Key File Location and Name**

   It is recommended to set the profile parameter `rsec/securestorage/keyfile` to:
   
   ```
   $(DIR_GLOBAL)$(DIR_SEP)security$(DIR_SEP)data$(DIR_SEP)SecStoreDBKey.pse
   ```
   
   The file extension `.pse` is a deliberate choice for this text file.

**Correction Instructions**

To apply the corrections, follow these steps:

1. **Transaction SE11**
   - Open transaction `SE11`.
   - Enter the database table `RSECTAB`.
   - Choose **Change**.
   - Navigate to **Delivery and Maintenance**.
   - Update the field:
     - **Old:** Display/Maintenance Allowed with Restrictions
     - **New:** Display/Maintenance Not Allowed
   - Save and activate the changes.

2. **Assign Authorization Group**
   - Go to the menu: **Utilities > Assign Authorization Group**.
   - Select **New Entries**.
   - Table: `RSECTAB`
   - Authorization: `SPSE`
   - Save the entries.

3. **Repeat for Table RSECACTB**
   - Follow the same steps as above for table `RSECACTB`.

**Prerequisites**

Ensure the following SAP Notes are applied before implementing this security note:

- [SAP Note 1626371](https://me.sap.com/notes/1626371) - Dynamic documents: Adjustments for the SAP ACC standard v3
- [SAP Note 1867397](https://me.sap.com/notes/1867397) - Function module TH_SERVER_LIST lists only active servers
- [SAP Note 1762761](https://me.sap.com/notes/1762761) - Provisioning of function module SECSTORE_CHECK_ALL
- [SAP Note 1832061](https://me.sap.com/notes/1832061) - Quick termination in SECSTORE_CHECK_ALL for migration check
- [SAP Note 1703611](https://me.sap.com/notes/1703611) - Tx SECSTORE allows deletion of records that are still needed
- [SAP Note 1603902](https://me.sap.com/notes/1603902) - Adaption of ABAP Unit-Tests for the Secure Storage

**Affected Software Components**

- **SAP_BASIS** versions 700, 710, 711, 720, 730, 731, 740

For more details on support packages, refer to the [Support Package Downloads](https://me.sap.com/).

**References**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011241592017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001902611?language=en-US&token=66443E9D3EF695EB38400ABB44F9C527)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001902611/E/diff)

**Rate this document**

Rate the helpfulness and quality of this document to assist the SAP community.

---

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*