1785662 - Directory traversal in external billing interface

**SAP Security Note 1785662 - Directory Traversal in External Billing Interface**

**Description**

Billing via the internal billing interface (reports RVAFSS00, RVAFSS01, and RVAFSS02) contains a vulnerability that allows an attacker to potentially read arbitrary files on the remote server, potentially disclosing confidential information.

**Other Terms**

- Directory traversal
- Reports: RVAFSS00, RVAFSS01, RVAFSS02
- Billing document
- Invoice

**Reason and Prerequisites**

Reports RVAFSS00, RVAFSS01, and RVAFSS02 fail to correctly validate the file path used to reference files read from the remote server. As a result, an attacker can direct the program to arbitrary files in the system, disclosing their contents.

**Solution**

For additional information and instructions, refer to [Note 1497003](https://me.sap.com/notes/1497003) and [Note 1605703](https://me.sap.com/notes/1605703). The corrections from these notes are prerequisites for implementing this note.

**Correction Instructions**

1. **Call Transaction FILE.**
2. **Define Logical File Path:**
   - In the tree, select "Logical File Path Definition" and choose "New Entries."
   - Enter `SD_BIL_GBI_ROOT` as the logical path name with the description "File Path: External Data Transfer, Billing Documents."
   - Save the new entry.
3. **Define Logical File Name:**
   - In transaction FILE, select "Logical File Name Definition, Cross-Client" and choose "New Entries."
   - Enter the following details:
     - **Logical File:** `SD_BIL_GBI_FILE`
     - **Name:** "External Data Transfer, Billing Documents"
     - **Physical File:** `'`
     - **Data Format:** DIR
     - **Application Area:** SD
     - **Logical Path:** `SD_BIL_GBI_ROOT`
   - Save the new entry.

**Prerequisites**

- [Note 453914](https://me.sap.com/notes/453914) - General billing interface: Texts are not transferred (Valid for SAP_APPL component from 46A to 46C)

**Support Package Information**

Ensure your system is updated with the relevant support packages for the SAP_APPL component. Refer to the Support Package section in [the full note](https://me.sap.com/notes/1785662) for detailed information based on your system version.

**References**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010551212017)
- [PDF Version](https://me.sap.com/support/sfm/notes/print/0001785662?language=en-US&token=9C36BC69EFC0D5E25FFF3B83A69E13F2)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001785662/E/diff)

**Credits**

Credits to [redrays.io](https://redrays.io) for support to provided information.