1609552 - Unauthorized modification of stored content in CA-GTF-RCM

**SAP Note Number**: 1609552  
**Type**: SAP Security Note  
**Version**: 4  
**Released On**: 12.03.2012  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer  
**Component**: CA-GTF-RCM (Cross-Application Components > General Application Functions > Records and Case Management)

### **Symptom**
CA-GTF-RCM can be abused by a malicious user, allowing them to modify application content, persist the modified content without authorization, and potentially obtain authentication information from other legitimate users.

### **Other Terms**
Stored cross-site scripting, XSS, CA-GTF-RCM

### **Reason and Prerequisites**
Some BSP pages of CA-GTF-RCM result in a stored cross-site scripting issue. This vulnerability can be exploited to:

- Permanently modify displayed content from a website.
- Embed content that is rendered automatically without targeting victims individually.
- Steal another user's authentication information, such as session data.
- Impersonate users, including administrators, potentially compromising the security of the application.

### **Solution**
1. **Prerequisite**: Ensure that corrections from [SAP Note 1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870) are applied before implementing this note.

2. **Apply This Note (1609552)**:
   - **BSP Pages Affected**:
     - RMPSPB_CASE: CASE.HTM, ERROR.HTM, NO_BSP_IMP.HTM, PROCESS.HTM
     - RMPSPB_CASENOTE: ERROR.HTM, NOTES.HTM, VALIDATE.JS
     - SRMPS_BROWSER: RECORDSBROWSER.HTM
     - SRMPS_HISTORY: ERROR.HTM, HISTORY.HTM
     - SRMPS_METADATA: CHANGEMETADATA.HTM, ERROR.HTM, INITIAL.HTM, METADATA.HTM, UPDATED.HTM
     - SRMPS_SEARCH: ERROR.HTM, RESULTS1.HTM, SEARCH.HTM

3. **Steps to Correct**:
   1. Execute transaction **SE80**.
   2. Select **'BSP Application'** from the dropdown and enter the BSP application name (e.g., RMPSPB_CASE), then press **Enter**.
   3. Select the application node and click on **'Expand All'** to view the application tree structure.
   4. Navigate to the **'Views'**, **'Pages with flow logic'**, or **'Page fragments'** folder to find the BSP pages.
   5. Double-click the page to be changed and use the **'Display/Change'** button to enter change mode.
   6. Go to the **'Layout'** tab and replace the first statement:
      ```abap
      <%@page language="abap"%>
      ```
      with:
      ```abap
      <%@page language="abap" forceEncode="html"%>
      ```
   7. Save and activate the page.

### **Support Package Information**
Applicable for **Software Component**: SAP_ABA  
- **Release 640**: Up to SAPKA64029  
- **Release 700**: SAPKA70004 - SAPKA70025  
- **Release 701**: Up to SAPKA70110  
- **Release 702**: SAPKA70201 - SAPKA70209  
- **Release 710**: Up to SAPKA71014  
- **Release 711**: SAPKA71108 - SAPKA71109  
- **Release 720**: SAPKA72006 - SAPKA72007  
- **Release 730**: SAPKA73005  

For more details, visit the [Support Package section](https://me.sap.com/supportpackage/SAPKA64029).

### **References**
- [1700532 - Unauthorized modification of displayed content in CA-GTF-RCM](https://me.sap.com/notes/1700532)
- [1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)

### **Downloads**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009558692017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001609552?language=en-US&token=94BEA1C20C6DBF269AA2D45B8F20C011)

### **Corrections Information**
- **Correction Instructions**: 8 corrections available [here](https://me.sap.com/corrins/0001609552/44)
- **Manual Activities**: 2 manual activities required

**Note**: Ensure that corrections from [SAP Note 1582870](https://me.sap.com/notes/1582870) are present in your system before implementing this note.

---

*Credits: [Redrays.io](https://redrays.io) for support in providing this information.*