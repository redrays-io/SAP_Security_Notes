SAP Security Note 1609287 - Unauthorized modification of displayed content in Websurvey

**Overview**

**SAP Security Note 1609287 - Unauthorized modification of displayed content in Websurvey**

**Symptom**

Websurvey can be abused by a malicious user, allowing them to modify displayed application content without authorization and potentially obtain authentication information from other legitimate users.

**Other Terms**

- Reflected cross-site scripting (XSS)
- Websurvey

**Reason and Prerequisites**

BSP-Pages within Websurvey do not sufficiently encode INPUT and OUTPUT parameters, resulting in a reflected cross-site scripting issue. A reflected XSS attack can be used to non-permanently deface or modify displayed content on a website. Additionally, reflected XSS can be used to steal data related to the current session. A malicious user who gains access to this data may impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**

1. **Implement Prerequisite Corrections**
   
   Before implementing this note, you must apply the corrections contained in the following SAP Notes:
   
   - [SAP Note 1582870](https://me.sap.com/notes/1582870) - ABAP XSS Escaping Support
   - [SAP Note 1468513](https://me.sap.com/notes/1468513) - Unauthorized execution of functions in Web Survey

2. **Apply Correction Instructions**
   
   Implement the attached correction instructions that correspond to your release. You can download the correction instructions from the [Correction Instructions Page](https://me.sap.com/corrins/0001609287/44).

**Additional Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009556912017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001609287?language=en-US&token=17CB427D5D6F6229A091B0C2DEE47CA1)
- [Share by Email](https://me.sap.com/notes/1609287)
- [Open in New Window](https://me.sap.com/notes/1609287)

**References**

This security note refers to the following documents:

- [SAP Note 1923158](https://me.sap.com/notes/1923158) - Survey: Problems with special characters in form parameters for BSP
- [SAP Note 1582870](https://me.sap.com/notes/1582870) - ABAP XSS Escaping Support
- [SAP Note 1468513](https://me.sap.com/notes/1468513) - Unauthorized execution of functions in Web Survey

**Validity**

This note is applicable to the following SAP_ABA components:

- 620
- 640
- 700 to 702
- 710 to 711
- 730 to 731

**Support Packages**

Refer to the respective [Support Package](https://me.sap.com/supportpackage/SAPKA62071) for your software component version.

**Side Effects**

Implementing this note may cause side effects in the following document:

- [SAP Note 1876244](https://me.sap.com/notes/1876244) - SURVEY: Problems with spec. chars. in input fields for BSP

*Ensure you review all prerequisites and perform necessary backups before applying this security note.*

Credits: Thanks to [redrays.io](https://redrays.io) for support in providing this information.