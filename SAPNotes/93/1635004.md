1635004 - Directory Traversal in BC-SRV-KPR

---

**Header Data**

- **SAP Note/KBA:** 1635004
- **Type:** SAP Security Note
- **Version:** 3
- **Recency:** New
- **Language:** English
- **Master Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Release Status:** Released for Customer
- **Released On:** 10.04.2012
- **Component:** Basis Components > Basis Services/Communication Interfaces > Knowledge Provider

**Title**

1635004 - Directory Traversal in BC-SRV-KPR

**Description**

### Symptom

Read-write directory traversal in BC-SRV-KPR contains a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

### Other Terms

directory, traversal, BC-SRV-KPR.

### Reason and Prerequisites

Read-write directory traversal in BC-SRV-KPR fails to correctly validate the path a user-submitted file is written to. Through this, an attacker can potentially overwrite data on the remote system.

### Solution

Refer to [note 1497003](https://me.sap.com/notes/0001497003) for additional information and instructions. The corrections from note 1497003 are a prerequisite for implementation of this note.

**Logical File Names Used in this Solution:**

The following logical file names have been created to enable the validation of physical file names:

- `KPRO_IMPORT_EXPORT`

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009707162017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001635004?language=en-US&token=F3D39C9FB2260EB95E5D434B64769D2C)
- Share by Email
- Open in New Window

**Validity**

| Software Component | From | To |
|--------------------|------|----|
| SAP_BASIS          | 46C  | 46D |
| SAP_BASIS          | 610  | 640 |
| SAP_BASIS          | 700  | 702 |
| SAP_BASIS          | 710  | 730 |
| SAP_BASIS          | 731  | 731 |

**Support Package**

| Software Component Version | Support Package        | URL                                                                                     |
|----------------------------|------------------------|-----------------------------------------------------------------------------------------|
| SAP_BASIS 46C              | SAPKB46C64             | [SAPKB46C64](https://me.sap.com/supportpackage/SAPKB46C64)                             |
| SAP_BASIS 46D              | SAPKB46D45             | [SAPKB46D45](https://me.sap.com/supportpackage/SAPKB46D45)                             |
| SAP_BASIS 610              | SAPKB61048             | [SAPKB61048](https://me.sap.com/supportpackage/SAPKB61048)                             |
| SAP_BASIS 620              | SAPKB62072             | [SAPKB62072](https://me.sap.com/supportpackage/SAPKB62072)                             |
| SAP_BASIS 640              | SAPKB64030             | [SAPKB64030](https://me.sap.com/supportpackage/SAPKB64030)                             |
| SAP_BASIS 700              | SAPKB70027             | [SAPKB70027](https://me.sap.com/supportpackage/SAPKB70027)                             |
| SAP_BASIS 701              | SAPKB70111             | [SAPKB70111](https://me.sap.com/supportpackage/SAPKB70111)                             |
| SAP_BASIS 702              | SAPKB70211             | [SAPKB70211](https://me.sap.com/supportpackage/SAPKB70211)                             |
| SAP_BASIS 710              | SAPKB71014             | [SAPKB71014](https://me.sap.com/supportpackage/SAPKB71014)                             |
| SAP_BASIS 711              | SAPKB71109             | [SAPKB71109](https://me.sap.com/supportpackage/SAPKB71109)                             |
| SAP_BASIS 720              | SAPKB72007             | [SAPKB72007](https://me.sap.com/supportpackage/SAPKB72007)                             |
| SAP_BASIS 730              | SAPKB73007             | [SAPKB73007](https://me.sap.com/supportpackage/SAPKB73007)                             |
| SAP_BASIS 731              | SAPKB73102             | [SAPKB73102](https://me.sap.com/supportpackage/SAPKB73102)                             |
| SAP_BASIS 731              | SAPKB73101             | [SAPKB73101](https://me.sap.com/supportpackage/SAPKB73101)                             |

**Correction Instructions**

| Software Component | Number of Correction Instructions | URL                                     |
|--------------------|-----------------------------------|-----------------------------------------|
| SAP_BASIS          | 13                                | [Correction Instructions](https://me.sap.com/corrins/0001635004/41) |

**Preconditions**

| Software Component | From | To  | SAP Note/KBA | URL                                             | Title                                 | Component          |
|--------------------|------|-----|--------------|-------------------------------------------------|---------------------------------------|--------------------|
| SAP_BASIS          | 610  | 610 | 579366       | [579366](https://me.sap.com/notes/000579366)     | Content server performance            | BC-SRV-KPR-CS      |
| SAP_BASIS          | 610  | 610 | 803931       | [803931](https://me.sap.com/notes/000803931)     | AUTHORITY_CHECK_DATASET ZDATASET       | BC-SRV-KPR-CMS     |

**Side Effects**

- **This document is causing side effects:**
  - [1984057 - Update #1 to Security Note 1635004](https://me.sap.com/notes/0001984057)

**Credits**

Credits to [Redrays](https://redrays.io) for support in providing this information.