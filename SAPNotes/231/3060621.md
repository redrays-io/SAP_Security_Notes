3060621 - [CVE-2021-38150] Information disclosure in SAP Business Client

**Symptom**

When an attacker gains access to the local memory or memory dumps of a victim—potentially through social engineering attacks—SAP Business Client allows the reading of highly sensitive data, such as credentials. This vulnerability enables the attacker to compromise the corresponding backend systems for which the credentials are valid.

**Other Terms**

- Information Exposure
- Information Leak
- [CVE-2021-38150](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38150)

**Reason and Prerequisites**

This issue arises because basic authentication is used for system connections.

**Solution**

By default, providing passwords in SAP Business Client startup URLs (`sap-nwbc://`) is no longer possible. However, this functionality can be re-enabled—for example, to automate quality assurance—by setting the `IsPasswordInCommandlineAllowed` option to `true` in the administrator configuration file (`%programdata%\SAP\NWBC\NwbcOptions.xml`):

```xml
<NwbcOptions>
  <SingleOptions>
    <IsPasswordInCommandlineAllowed>true</IsPasswordInCommandlineAllowed>
  </SingleOptions>
</NwbcOptions>
```

**SAP recommends** using this workaround only for test systems with test users. If automating SAP Business Client, ensure that startup URLs containing passwords are securely stored, such as in encrypted storage solutions.

To apply the correction, install the patch mentioned in the "Support Packages & Patches" section of this note or a newer one. **SAP Business Client patches are cumulative**, meaning each new patch includes all previous fixes.

**CVSS Details**

- **Score:** 6.1
- **Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N)
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** None (N)

**Support Packages & Patches**

- **SAP Business Client 7.70**
  - [SP005 Patch 000005](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200012051&V=MAINT)
  - [SP006 Patch 000006](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200012051&V=MAINT)
  
- **SAP Business Client 7.0**
  - [SP021 Patch 000021](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200007699&V=MAINT)

**Additional Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001318422021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003060621?language=en-US&token=DBB0C05EC27700087767C3008A01C1A5)

*Credits to [Redrays](https://redrays.io) for support in providing this information.*