3058553 - [CVE-2021-33695] Multiple Vulnerabilities in SAP Cloud Connector

**SAP Security Note 3058553** addresses several critical vulnerabilities in the SAP Cloud Connector. Below are the key details:

### **Symptom**

This security note covers multiple vulnerabilities in the SAP Cloud Connector. The vulnerability details can be found below.

1. **Improper Certificate Validation**
   - **Description:** Communication with the backend is accepted without sufficient validation of the certificate.
   - **CVE:** [CVE-2021-33695](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33695)
   - **CVSS Score:** 6.8 (CVSS:3.0/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N)

2. **Cross Site Scripting**
   - **Description:** SAP Cloud Connector UI does not sufficiently encode user-controlled inputs, allowing Stored Cross-Site Scripting.
   - **CVE:** [CVE-2021-33694](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33694)
   - **CVSS Score:** 5.9 (CVSS:3.0/AV:A/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L)

3. **Code Injection via Backup Restore**
   - **Description:** An authenticated administrator can modify a backup configuration file to inject malicious codes, potentially leading to OS command execution.
   - **CVE:** [CVE-2021-33693](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33693)
   - **CVSS Score:** 5.7 (CVSS:3.0/AV:A/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:L)

4. **Code Injection via Zip Slip in Backup Import**
   - **Description:** Allows the upload of specially crafted zip files to write arbitrary files to the file system in the web server.
   - **CVE:** [CVE-2021-33692](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33692)
   - **CVSS Score:** 5.2 (CVSS:3.0/AV:A/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:L)

### **Solution**

- **Improper Certificate Validation:** Enhanced validation during backend communication.
- **Cross Site Scripting:** Improved encoding of user inputs.
- **Code Injection via Zip Slip in Backup Import:** Added checks to ensure extracted files reside within the intended directory.
- **Code Injection via Backup Restore:** Modified configuration files are no longer automatically replaced.

**Upgrade to SAP Cloud Connector 2.13.2** by downloading it from [https://tools.hana.ondemand.com/#cloud](https://tools.hana.ondemand.com/#cloud) and follow the upgrade instructions provided [here](https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/7a7cc373019b4b6eaab39b5ab7082b09.html).

### **CVSS Details**

- **Overall CVSS Score:** 6.8
- **Vector:** CVSS:3.0/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N

### **Additional Information**

- **Type:** SAP Security Note
- **Version:** 12
- **Recency:** New
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** 2021/08/10
- **Component:** Basis Components > Middleware > SAP Cloud Connector On-Demand/On-Premise Connectivity

For more details, visit the official SAP Security Notes portal: [https://me.sap.com/notes/3058553](https://me.sap.com/notes/3058553)

---

*Credits to [RedRays](https://redrays.io) for supporting the information provided.*