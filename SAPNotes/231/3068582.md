3068582 - [CVE-2021-38164] Missing Authorization check in SAP ERP Financial Accounting / RFOPENPOSTING_FR

**SAP Security Note**

**Number:** 3068582  
**Type:** SAP Security Note  
**Version:** 8  
**Recency:** Updated  
**Language:** English  
**Master Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Release Status:** Released for Customer  
**Released On:** 09.11.2021  
**Component:** Financial Accounting > Country/Region-Specific Localizations > Financials > France  
**CVSS Score:** 5.4  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N](https://www.first.org/cvss/specification-document)

---

### Symptom

**UPDATE 9th November 2021:** This note has been re-released with an updated attachment section. An updated PDF file with instructions for manual pre-implementation activity for the SU22 transaction has been added.

SAP ERP Financial Accounting allows a registered attacker to invoke certain functions that would otherwise be restricted to specific users. These functions are normally exposed over the network, and once exploited, the attacker may be able to view and modify financial accounting data that only a specific user should have access to.

### Reason and Prerequisites

This SAP Note is relevant only for France.

### Solution

The affected functions have now been enforced to properly check access restrictions.

- **Import the Support Package** specified for your release or implement the attached (manual) correction instruction.
  
  As a general rule, SAP recommends implementing the Support Package specified for your release. However, if you need to install a solution earlier, use the SAP Note Assistant to implement the correction instruction. More information about the SAP Note Assistant can be found in the [SAP Support Portal](https://me.sap.com/support).

- **Changes in Source Code:**
  
  In the source code of report `RFOPENPOSTING_FR`, additional authority checks for the authority objects `F_BKPF_BLA`, `F_BKPF_BUK`, and `F_FAGL_LDR` have been implemented.

- **Transaction SU22 Adjustments:**
  
  In transaction SU22 for transaction `FAGL_FR_03`, the authority Default Values (SAP) are maintained.

- **User Authorization:**
  
  If a user is no longer allowed to execute the report, adjust the user's assigned authorization profile accordingly.

### Available Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001318442021)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003068582?language=en-US&token=EB31DD158F351982C2AE4B72D2B56A6F)
- [Share by Email](https://me.sap.com/)
- [Open in New Window](https://me.sap.com/)
- [Show Changes](https://me.sap.com/notesLatestChanges/0003068582/E/diff)

### Attachments

- [Manual_Instructions_for_SAP_note_3068582.pdf](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125900001287992021&iv_version=0008&iv_guid=00109B36D66A1EEC908E955A06DBF6D9) (107 KB)
- [SU22_SS4CORE_SAPFIN_SAPAPPL_20211103_FAGL_FR_03.zip](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125900001287992021&iv_version=0008&iv_guid=00109B36BCB61EDC908E9700C0FB0E0D) (10 KB)

### Correction Instructions

- **SAP_FIN:** 5 Instructions  
  [View Instructions](https://me.sap.com/corrins/0003068582/15841)

- **SAP_APPL:** 7 Instructions  
  [View Instructions](https://me.sap.com/corrins/0003068582/1)

- **S4CORE:** 6 Instructions  
  [View Instructions](https://me.sap.com/corrins/0003068582/19773)

### Preconditions

- **S4CORE:**
  - Releases 100 to 105 with various SAP Notes related to RFOPENPOSTING_FR.
  
- **SAP_APPL:**
  - Releases 600 to 606 with relevant SAP Notes.
  
- **SAP_FIN:**
  - Releases 617 to 730 with corresponding SAP Notes.

### Support Package

Refer to the table below for the applicable Support Package based on your Software Component Version:

| Software Component Version | Support Package               | URL                                           |
|----------------------------|-------------------------------|-----------------------------------------------|
| S4CORE 101                 | SAPK-10111INS4CORE            | [Link](https://me.sap.com/supportpackage/SAPK-10111INS4CORE) |
| S4CORE 102                 | SAPK-10209INS4CORE            | [Link](https://me.sap.com/supportpackage/SAPK-10209INS4CORE) |
| S4CORE 103                 | SAPK-10307INS4CORE            | [Link](https://me.sap.com/supportpackage/SAPK-10307INS4CORE) |
| ...                        | ...                           | ...                                           |

*(Complete table available in the full SAP Note.)*

### References

This document does not currently refer to or is referenced by other SAP Notes or KBAs.

### Side Effects

This document does not cause or solve any side effects.

---

*For more details and the full content, please refer to the official [SAP Security Note 3068582](https://me.sap.com/notes/3068582).*

---

Credits to [redrays.io](https://redrays.io) for support to provided information.