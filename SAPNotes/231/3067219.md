SAP Security Note 3067219: Task Hijacking in SAP Fiori Client for Android

**SAP Security Note 3067219 - [CVE-2021-33699] Task Hijacking in SAP Fiori Client Native Mobile for Android**

### **Symptom**
Task Hijacking in SAP Fiori Client affects applications running on Android devices due to a misconfiguration in the `AndroidManifest.xml` related to Task Control features. This vulnerability allows attackers or malware to takeover legitimate apps and steal users' sensitive information.

### **Solution**
SAP will provide updated versions of the Kapsel SDK and Fiori Client to address this issue.

- **Standard Fiori Client Users:**
  - A new version of the Fiori Client will be released with `taskAffinity=""` set in the application manifest file.
  - **Action:** Download the latest version of the Fiori Client from the [Google Play Store](https://me.sap.com/).

- **Customized Fiori Client Users:**
  - **Cloud Build Service or WebIDE:**
    - Rebuild the customized Fiori Client using the updated Kapsel SDK once it is released.
  
  - **CLI Users:**
    - Download the latest Kapsel SDK and rebuild the customized Fiori Client.

### **Workaround**
For customers using a customized Fiori Client, apply the following temporary workaround:

- **Cloud Build Service Users:**
  - Download the project file and set `taskAffinity=""`, then rebuild the customized Fiori Client locally.

- **WebIDE Users:**
  - Modify `config.xml` in your Cordova project to set `taskAffinity=""` and perform a rebuild action from WebIDE.

- **CLI Users:**
  - Modify `taskAffinity=""` in the project and rebuild the customized Fiori Client.

*Please assess the applicability of this workaround in your SAP landscape before implementation.*

**Note:** This workaround is temporary and not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note either instead of or in addition to the workaround.

### **CVSS**
- **Score:** 7.6
- **Vector:** CVSS:3.0/AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L
  - **Attack Vector:** Adjacent (A)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** None (N)
  - **User Interaction:** Required (R)
  - **Scope:** Unchanged (U)
  - **Confidentiality Impact:** High (H)
  - **Integrity Impact:** High (H)
  - **Availability Impact:** Low (L)

### **Additional Information**
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** August 10, 2021
- **Component:** Business Mobile > SAP Fiori Client Native Mobile Application

For more details, you can view the [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003067219?language=en-US&token=0E38070F2E76A5AC3241FBF061CF0745) or download the note using [SNOTE](https://notesdownloads.sap.com/note/0040000001143732021).

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*