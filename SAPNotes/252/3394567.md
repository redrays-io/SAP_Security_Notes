3394567 - [CVE-2023-42481] Improper Access Control Vulnerability in SAP Commerce Cloud

**Symptom**
In SAP Commerce Cloud, a locked B2B user can misuse the forgotten password functionality to unblock their user account again and regain access if SAP Commerce Cloud - Composable Storefront is used as the storefront. This is due to weak access controls in place, leading to significant impacts on confidentiality and integrity.

**Other Terms**
- **Vulnerability Type:** Improper Access Control
- **Related CVE:** [CVE-2023-42481](https://www.cve.org/CVERecord?id=CVE-2023-42481)
- **Affected Component:** CEC-COM-CPS

**Reason and Prerequisites**
SAP Commerce Cloud allows B2B users with admin roles to disable users from their company, blocking them from logging in. However, if SAP Commerce Cloud - Composable Storefront is used, not all necessary checks are executed subsequently. This issue does not affect setups that utilize classic accelerator storefronts and is specific to B2B scenarios.

**Solution**
SAP Commerce Cloud addresses this vulnerability by ensuring that the `loginDisabled` flag remains `false` if the B2B user is marked as inactive during the password reset flow. Apply the following patches to resolve the issue:

- [SAP Commerce Cloud Patch Release 2205.18](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/f9b65161e1e645249542e59f42f64a7b.html?version=v2205)
- [SAP Commerce Cloud Update Release 2211.15](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/f9b65161e1e645249542e59f42f64a7b.html)

**Patch Downloads:**
- [Software Downloads for SAP Commerce Cloud in the Public Cloud](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=73555000100800001224&V=MAINT&TA=ACTUAL/SAP%20COMMERCE%20CLOUD%20V2)
- [Software Downloads for SAP Commerce On-Premise](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/%20_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL&PAGE=SEARCH/SAP%20COMMERCE)

**Installation Instructions:**
Follow the [About Patch Releases](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/8c25978386691014b4abdd61376acd24.html?locale=en-US) guide to install the patches. After installation, you need to rebuild and redeploy the updated SAP Commerce Cloud version.

**Workaround**
Before implementing the workaround, assess its applicability to your SAP landscape. This workaround is a temporary fix and not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note instead of or after implementing the workaround.

**Manual Remediation Steps:**
1. Establish a procedure during operations: Immediately after a B2B user is blocked by an admin user, adjust the ID or email of the blocked user in the backoffice. This prevents the blocked user from receiving emails to unblock their account.

**CVSS Details**
- **CVSS Score:** 8.1
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N)

**Affected Software Components:**
- HY_COM: 1905, 2005, 2105, 2011, 2205
- COM_CLOUD: 2211

For more detailed information, visit the [SAP Support Portal](https://me.sap.com/).

---

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*