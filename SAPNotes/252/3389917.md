3389917 - [CVE-2023-44487] Denial of service (DOS) in SAP Web Dispatcher, SAP NetWeaver Application server ABAP, and ABAP Platform

## Symptom
SAP Web Dispatcher, SAP NetWeaver Application Server ABAP, and ABAP Platform allow an unauthenticated user to perform a DOS attack over the network by sending a massive number of HTTP/2 requests and canceling them later. This can flood the memory and significantly impact the application's availability. Confidentiality and integrity remain unaffected.

## Reason and Prerequisites
- **Affected Components:**
  - **SAP Web Dispatcher:** 
    - Supports HTTP/2 by default since version 7.73.
    - Versions ≤ 7.54 are affected only if `icm/HTTP/support_http2` is set to TRUE.
    - Versions ≤ 7.45 are not affected as they do not support HTTP/2.
    - Not affected if `icm/HTTP/support_http2` is set to FALSE.
  - **SAP NetWeaver Application Server ABAP (ICM):**
    - Supports HTTP/2 by default since kernel 7.73.
    - Not affected if a patched SAP Web Dispatcher is in front.
    - Versions ≤ 7.54 are affected only if `icm/HTTP/support_http2` is set to TRUE.
    - Versions ≤ 7.45 are not affected as they do not support HTTP/2.
    - Not affected if `icm/HTTP/support_http2` is set to FALSE.
  - **SAP NetWeaver AS Java ICM:** Not affected as it does not support HTTP/2.

## Solution

### Workaround
Refer to [SAP Note 3390068](https://me.sap.com/notes/3390068) for details on implementing a temporary workaround. Assess its applicability to your SAP landscape before implementation. Note that this is a temporary fix and not a permanent solution. SAP recommends applying the corrections outlined in this security note either instead of or after implementing the workaround.

### Correction
The vulnerability is mitigated by rate limiting. If a massive number of HTTP/2 requests are canceled on a connection, the HTTP/2 connection will be aborted.

- **SAP Web Dispatcher (Standalone/Embedded):**
  - Apply patches using `SAPWEBDISP.SAR` for standalone or `dw.sar` / `SAPEXE.SAR` and `SAPEXEDB.SAR` for embedded deployments.
  - Follow the steps in [SAP Note 908097](https://me.sap.com/notes/908097) for recommended versions and installation.
  - Refer to [SAP Note 3115889](https://me.sap.com/notes/3115889) for differences between standalone and embedded deployments.
  - Always review the regression note [1802333](https://me.sap.com/notes/1802333) before installing any kernel patch.
  - For download and installation instructions, see [SAP Note 19466](https://me.sap.com/notes/19466).

- **SAP NetWeaver Application Server ABAP:**
  - Apply the latest SP Stack Kernel as listed in [SAP Note 2083594](https://me.sap.com/notes/2083594).
  - If necessary, apply the hotfix `dw.sar`.
  - Ensure patches are applied to supported kernel releases. Upgrade to a downward compatible kernel (DCK) if needed.
  - Review regression notes and follow installation instructions as outlined in the solution for SAP Web Dispatcher.

For detailed SAP recommendations, refer to the [Update Strategy for the Kernel of the Application Server ABAP in On Premise Landscapes](https://support.sap.com/deployment-strategies-kernel-abap.pdf).

## CVSS
- **Score:** 7.5
- **Vector:** `CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`
  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** None
  - **User Interaction:** None
  - **Scope:** Unchanged
  - **Confidentiality Impact:** None
  - **Integrity Impact:** None
  - **Availability Impact:** High

## References
- [CVE-2023-44487 Details](https://www.cve.org/CVERecord?id=CVE-2023-44487)
- [SAP Note 3389917](https://me.sap.com/notes/3389917)
- [Support Package Patches](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019168&V=MAINT)

---

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*