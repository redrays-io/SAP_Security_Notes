3399691 - Update 1 to 3350297 - [CVE-2023-36922] OS command injection vulnerability in SAP ECC and SAP S/4HANA (IS-OIL)

**SAP Note Details**
- **Number:** 3399691
- **Type:** SAP Security Note
- **Version:** 13
- **Recency:** New
- **Language:** English
- **Category:** Program error
- **Priority:** HotNews
- **Status:** Released for Customer
- **Released On:** 12.12.2023
- **Component:** IS-OIL-DS-HPM (Industry-Specific Components > Oil > Downstream > Hydrocarbon Product Management)
- **Externally Reported:** Yes

**Description**
This security note is an update to [SAP Note 3350297](https://me.sap.com/notes/3350297). The fix provided in SAP Note 3350297 was incomplete for the component IS-OIL-DS-HPM.

Due to a programming error in a function module and report, the IS-OIL component in SAP ECC and SAP S/4HANA allows an authenticated attacker to inject an arbitrary operating system command into an unprotected parameter in a common (default) extension. On successful exploitation, the attacker can read or modify system data as well as shut down the system.

**Warning:** This note is specific to IS-OIL. If IS-OIL is not active in your system, this note does not apply. If this note has been applied accidentally without IS-OIL being active, refer to [SAP Note 3349318](https://me.sap.com/notes/3349318).

**Affected Components**
- **Software Components and Versions:**
  - IS-OIL 600 to 600
  - IS-OIL 602 to 602
  - IS-OIL 603 to 603
  - IS-OIL 604 to 604
  - IS-OIL 605 to 605
  - IS-OIL 606 to 606
  - IS-OIL 617 to 617
  - IS-OIL 618 to 618
  - IS-OIL 800 to 800
  - IS-OIL 802 to 802
  - IS-OIL 803 to 803
  - IS-OIL 804 to 804
  - IS-OIL 805 to 805
  - IS-OIL 806 to 806
  - IS-OIL 807 to 807
  - IS-OIL 808 to 808

**Solution**
After installing this note:
- The "Test Selected Routines" option is unavailable in the report `ROIB_QCI_CALL_TEST`.
- Direct execution of Function Module `OIB_QCI_SERVER` is not allowed.

**Actions:**
- Apply the [correction instructions](https://me.sap.com/corrins/0003399691/11) provided in this security note.
- Alternatively, upgrade to the corresponding [Support Packages](https://me.sap.com/supportpackage/SAPK-60036INISOIL) referenced in this note.

**Prerequisites**
- SAP Note [3350297](https://me.sap.com/notes/3350297) must be installed before applying this security note.

**CVSS Score**
- **Score:** 9.1
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

**References**
- [CVE-2023-36922](https://www.cve.org/CVERecord?id=CVE-2023-36922)
- [SAP Note 3350297](https://me.sap.com/notes/3350297)
- [SAP Note 3349318](https://me.sap.com/notes/3349318)

**Side Effects**
This document solves side effects related to [SAP Note 3350297](https://me.sap.com/notes/3350297).

**Attachments**
No attachments are provided with this security note.

**Translation Availability**
This note is available in multiple languages including Deutsch, 日本語, Português, Español, Français, Italiano, Русский, 中文, and 한국어 via machine translation.

**Credits**
Credits to [RedRays.io](https://redrays.io) for supporting the information provided.