3387737 - [CVE-2024-21738] Cross-Site Scripting (XSS) vulnerability in SAP NetWeaver ABAP Application Server and ABAP Platform

## Header Data

- **SAP Note/KBA:** 3387737
- **Type:** SAP Security Note
- **Version:** 10
- **Recency:** New
- **Language:** English
- **Master Language:** English
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Release Status:** Released for Customer
- **Released On:** 09.01.2024
- **Component:** BC-SRV-COM (Basis Components > Basis Services/Communication Interfaces > Communication Services: Mail, Fax, SMS, Telephony)

## Description

### Symptom

SAP NetWeaver ABAP Application Server and ABAP Platform do not sufficiently encode user-controlled inputs, resulting in Cross-Site Scripting (XSS) vulnerability. An attacker with low privileges can cause limited impact to confidentiality of the application data after successful exploitation.

### Other Terms

XSS, stored XSS, [CVE-2024-21738](https://www.cve.org/CVERecord?id=CVE-2024-21738), CSS

### Reason and Prerequisites

If a user enters a wrong recipient during mail creation, the error information will be presented to them.

### Solution

The URL parameters are now properly encoded in the error log to prevent a successful XSS attack.

Implement the [Correction Instructions](https://me.sap.com/corrins/0003387737/41) or [Support Packages](https://me.sap.com/supportpackage/SAPKB70042) referenced in this SAP Security Note.

## CVSS

- **CVSS Score:** 4.1
- **CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N

### Detailed Metrics

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** None (N)
- **Availability Impact (A):** None (N)

## Available Languages

- [Deutsch](https://me.sap.com/notes/0003387737/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0003387737/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003387737/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003387737/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003387737/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003387737/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003387737/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003387737/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003387737/3)

## Attachments

_No attachments_

## References

### This document refers to

_No references_

### This document is referenced by

_No references_

## Software Components

- **SAP_BASIS:** 700 - 702
- **SAP_BASIS:** 731 - 731
- **SAP_BASIS:** 740 - 740
- **SAP_BASIS:** 750 - 758
- **SAP_BASIS:** 793 - 794

## Support Package

- [SAPKB70042](https://me.sap.com/supportpackage/SAPKB70042) for SAP_BASIS 700
- [SAPKB70127](https://me.sap.com/supportpackage/SAPKB70127) for SAP_BASIS 701
- [SAPKB70227](https://me.sap.com/supportpackage/SAPKB70227) for SAP_BASIS 702
- [SAPKB73134](https://me.sap.com/supportpackage/SAPKB73134) for SAP_BASIS 731
- [SAPKB74031](https://me.sap.com/supportpackage/SAPKB74031) for SAP_BASIS 740
- [SAPK-75029INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75029INSAPBASIS) for SAP_BASIS 750
- [SAPK-75118INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75118INSAPBASIS) for SAP_BASIS 751
- [SAPK-75214INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75214INSAPBASIS) for SAP_BASIS 752
- [SAPK-75312INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75312INSAPBASIS) for SAP_BASIS 753
- [SAPK-75410INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75410INSAPBASIS) for SAP_BASIS 754
- [SAPK-75508INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75508INSAPBASIS) for SAP_BASIS 755
- [SAPK-75606INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75606INSAPBASIS) for SAP_BASIS 756
- [SAPK-75704INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75704INSAPBASIS) for SAP_BASIS 757
- [SAPK-75801INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75801INSAPBASIS) for SAP_BASIS 758
- [SAPK-79310INSAPBASIS](https://me.sap.com/supportpackage/SAPK-79310INSAPBASIS) for SAP_BASIS 793
- [SAPK-79404INSAPBASIS](https://me.sap.com/supportpackage/SAPK-79404INSAPBASIS) for SAP_BASIS 794

## Correction Instructions

- [Correction Instruction 41](https://me.sap.com/corrins/0003387737/41) for SAP_BASIS

## Side Effects

### This document solves side effects

_No side effects solved_

### This document is causing side effects

_No side effects caused_

## Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000019182024)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003387737?language=en-US&token=2E793A407C8576B997AEFEA8D73E36CD)

---

*Credits: [redrays.io](https://redrays.io) for support to provide this information.*