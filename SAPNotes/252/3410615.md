3410615 - [CVE-2023-44487] Denial of Service (DoS) in SAP HANA XS Classic and XS Advanced

## Summary

**SAP Note:** [3410615](https://me.sap.com/notes/3410615) addresses a Denial of Service (DoS) vulnerability (CVE-2023-44487) in SAP HANA XS Classic and HANA XS Advanced. An unauthenticated attacker can exploit this vulnerability by sending a massive number of HTTP/2 requests and canceling them later, leading to memory flooding and significant impact on application availability. There is no impact on the confidentiality or integrity of the application.

## Affected Components

- **SAP HANA Database 2.0**
- **SAP HANA Extended Application Services Advanced (XS Advanced)**
- **SAP Web Dispatcher**

## CVSS Score

- **7.5** – [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://nvd.nist.gov/vuln/detail/CVE-2023-44487)

## Solution

### For SAP HANA Database 2.0:

Implement the following revisions:

- **SPS 05:** Revision 2.00.59.12  
  [SAP Note 3409433](https://me.sap.com/notes/3409433) – *SAP HANA 2 SPS05 Revision 059.12*

- **SPS 07:** Revision 2.00.075.00  
  [SAP Note 3401188](https://me.sap.com/notes/3401188) – *SAP HANA 2 SPS07 Revision 075.00*

### For SAP HANA Extended Application Services Advanced (XS Advanced):

- Implement XS Advanced 1.1.8  
  [SAP Note 3421625](https://me.sap.com/notes/3421625) – *SAP HANA XS Advanced Model, Release 1.1.8*

## Workaround

**Note:** This is a temporary fix. It is strongly recommended to apply the corrections outlined in the security note.

### For Web Dispatcher in SAP HANA Extended Application Services Classic (XS Classic):

- XS Classic includes Web Dispatcher 7.53 with HTTP/2 **not enabled by default**.
- Add the parameter `icm/HTTP/support_http2=FALSE` to `webdispatcher.ini` in the `[profile]` section on the SYSTEM layer.  
  *No restart is required.*

### For Web Dispatcher in SAP HANA Extended Application Services Advanced (XS Advanced):

- XS Advanced includes Web Dispatcher 7.53 with HTTP/2 **not enabled by default**.
- Add the parameter `icm/HTTP/support_http2=FALSE` to `/hana/shared/<SID>/xs/controller_data/controller/router/webdispatcher/conf/sapwebdisp.template`.  
  *The new setting becomes active after a short time or by restarting XSA.*

- If XS Advanced is accessed via an external SAP Web Dispatcher only, apply the workaround in the external Web Dispatcher.

## References

- [SAP Note 3421625](https://me.sap.com/notes/3421625) – *SAP HANA XS Advanced Model, Release 1.1.8*
- [SAP Note 3409433](https://me.sap.com/notes/3409433) – *SAP HANA 2 SPS05 Revision 059.12*
- [SAP Note 3401188](https://me.sap.com/notes/3401188) – *SAP HANA 2 SPS07 Revision 075.00*
- [FAQ for CVE-2023-44487](https://me.sap.com/notes/3390068) – *HTTP/2 Rapid Reset Attack in SAP Web Dispatcher and ICM*
- [SAP Note 3389917](https://me.sap.com/notes/3389917) – *[CVE-2023-44487] Denial of service (DoS) in SAP Web Dispatcher, SAP NetWeaver Application Server ABAP, and ABAP Platform*

## Credit

Thanks to [Red Rays](https://redrays.io) for supporting the provision of this information.