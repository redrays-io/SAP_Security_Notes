3392626 - [CVE-2024-22124] Information Disclosure Vulnerability in SAP NetWeaver Internet Communication Manager

**Overview**
A critical security vulnerability (CVE-2024-22124) has been identified in SAP NetWeaver Internet Communication Manager (ICM) and SAP Web Dispatcher. This vulnerability can allow an attacker to access sensitive information, significantly impacting confidentiality.

**Symptom**
Under specific configurations, ICM or SAP Web Dispatcher may permit unauthorized access to restricted information, leading to a high confidentiality impact.

**Reason and Prerequisites**
The vulnerability occurs when HTTP logging is configured to log cookies or all request/response headers using the profile parameters `icm/HTTP/logging_<x>` or `icm/HTTP/logging_client_<x>` with the following `LOGFORMAT` settings:

- `LOGFORMAT=SAPSMD2` (logs all request and response header fields)
- `LOGFORMAT=SAPWEBDISP2` (logs all request and response header fields)
- `LOGFORMAT= %{Cookie}i` (logs the `Cookie` request header)
- `LOGFORMAT= %{[?]}i` (logs all request headers)
- `LOGFORMAT= %{Set-Cookie}o` (logs the `Set-Cookie` response header)
- `LOGFORMAT= %{[?]}o` (logs all response headers)
- `LOGFORMAT= %{<sensitive session cookie name>}c` (logs a specific request cookie)
- `LOGFORMAT= %{<sensitive session cookie name>}C` (logs a specific response cookie)

These configurations can result in sensitive session cookies being recorded in HTTP log files.

**Solution**
SAP has released a correction that masks sensitive session cookie values in HTTP log files. To address this vulnerability, apply the latest kernel patches as outlined below:

- **Download for SNOTE**: [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000019192024)
- **PDF Version**: [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003392626?language=en-US&token=22F948CD7C9FF1A90E5DA593BD54C7D4)

**Support Package Patches**
Apply the relevant support package patches for your SAP Kernel version:

- **SAP KERNEL 7.54 64-BIT**
  - SP229 Patch Level 000229: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019167&V=MAINT)
- **SAP KERNEL 7.54 64-BIT UNICODE**
  - SP229 Patch Level 000229: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019168&V=MAINT)
- **SAP KERNEL 7.53 64-BIT UNICODE**
  - SP1233 Patch Level 001233: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200005858&V=MAINT)
- **SAP WEB DISPATCHER 7.53**
  - SP1233 Patch Level 001233: [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200005911&support_package=SP1233&patch_level=001233)
  
_For a complete list of supported patches and versions, visit the [SAP Support Portal](https://me.sap.com/notes/2083594)._

**Workaround**
As a temporary measure, avoid using the `LOGFORMAT` configurations that log sensitive session cookies. This workaround is not a permanent solution, and SAP strongly recommends applying the official corrections as described above.

**CVSS Score**
- **Base Score**: 4.1
- **Vector**: CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N

**Additional Information**
- **Released On**: January 9, 2024
- **Priority**: Correction with medium priority
- **Status**: Released for Customer

For detailed correction instructions and more information, refer to SAP Note [3392626](https://me.sap.com/notes/0003392626).

**Credits**
Thanks to [redrays.io](https://redrays.io) for supporting and providing this information.