3406244 - [CVE-2023-6542] Missing Authorization Check in SAP EMARSYS SDK ANDROID

**Symptom**

Due to lack of proper authorization checks in Emarsys SDK for Android, an attacker with local access can call a particular activity and can forward web pages and/or deep links without any validation directly from the host application. On successful attack, an attacker could navigate to arbitrary URLs including application deep links on the device. Depending on the application which is called, there can be severe confidentiality and integrity impacts.

**Other Terms**

- Missing authorization check
- Emarsys
- [CVE-2023-6542](https://www.cve.org/CVERecord?id=CVE-2023-6542)

**Reason and Prerequisites**

The attacker needs control over the victim's Android mobile device (e.g., install or control a malicious application).

**Solution**

Update the Emarsys SDK for Android to the [3.6.2 version](https://github.com/emartech/android-emarsys-sdk/releases/tag/3.6.2).

**Workaround**

Please assess the workaround applicability for your SAP landscape prior to implementation.

Note that this workaround is a temporary fix and is not a permanent solution. SAP strongly recommends you apply the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.

If you cannot apply the patch, then as an interim fix please override export activity in the application manifest file. This is a workaround and a defense in depth, but not a solution:

```xml
<activity
    tools:replace="exported"
    android:name="com.emarsys.NotificationOpenedActivity"
    android:exported="false"/>
```

**CVSS**

- **Score**: 7.1
- **Vector**: [CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N)

**Download for SNOTE**

[Download for SNOTE](https://notesdownloads.sap.com/note/0040000001499442023)

**PDF Version**

[PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003406244?language=en-US&token=12B027D888146646ED8F763E7A6E341E)

*Credits to [redrays.io](https://redrays.io) for support to provided information.*