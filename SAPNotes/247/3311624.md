SAP Security Note 3311624 - [CVE-2023-29187] DLL Hijacking vulnerability in SapSetup (Software Installation Program)

**Description**

A Windows user with basic authorization can exploit a DLL hijacking vulnerability in **SapSetup**, leading to privilege escalation and the ability to run code as an administrator on the same Windows PC. Successful exploitation depends on various preconditions beyond the attacker's control.

**Other Terms**

- Command Injection
- OS Command Injection
- Privilege Escalation
- [CVE-2023-29187](https://www.cve.org/CVERecord?id=CVE-2023-29187)

**Reason and Prerequisites**

The attack requires that **SapSetup** has been uninstalled, and a specific file remains in use.

**Solution**

Apply SAP Security Note [3311624](https://me.sap.com/notes/3311624) or the corresponding support package. The provided SapSetup patch ensures that the vulnerable DLL is loaded from a directory where only administrative users have write access.

**Downloads**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000433822023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003311624?language=en-US&token=2FFEB69F3DAD4A1609CE7F998F12403A)

**CVSS Details**

- **Score:** 6.7
- **Vector:** CVSS:3.0/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H
  - **Attack Vector (AV):** Local (L)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** High (H)

**References**

For more information, visit the [SAP Security Notes](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*