1473116 - Filtering HTTP TRACE requests in AS Java

**SAP Note 1473116: Filtering HTTP TRACE requests in AS Java**

**Type:** SAP Security Note  
**Version:** 1  
**Recency:** New  
**Language:** English  
**Category:** Consulting  
**Priority:** Correction with low priority  
**Status:** Released for Customer  
**Released On:** 08.06.2010  
**Component:** Basis Components > Client/Server Technology > Internet Communication Manager

### Description
This note addresses the need to reject HTTP TRACE requests in the Internet Communication Manager (ICM) to prevent session attacks using the TRACE method defined in RFC2616.

### Reason and Prerequisites
The TRACE method can be exploited for session attacks. To enhance security, it's essential to reject HTTP TRACE requests in ICM.

### Solution
1. **Using NW 7.20 Kernel (Patch Level 40 or Higher):**
   - The kernel automatically filters out HTTP TRACE requests for AS Java.
   - It responds with HTTP "403 Forbidden" to such requests.
   - To deactivate this filter, set the profile parameter:
     ```
     icm/HTTP/ASJava/allow_trace_method = TRUE
     ```

2. **If Kernel Doesn't Contain the Change:**
   - **Configure a Filter in ICM:**
     1. **Modify Profile File:**
        - Edit the profile file (e.g., DEFAULT.PFL) to include the modification handler:
          ```
          icm/HTTP/mod_0 = PREFIX=/,FILE=$(DIR_GLOBAL)/security/data/icm_filter_rules.txt
          ```
     2. **Create Rule File:**
        - In the specified directory, create `icm_filter_rules.txt` and add the following rule:
          ```
          If %{REQUEST_METHOD} stricmp "TRACE"
          RegForbiddenUrl ^/(.*) -
          ```
   - **Activate Changes:**
     - Restart the ICM to apply the new settings.

### References
- [1422175 - How to disable the HTTP TRACE requests](https://me.sap.com/notes/1422175)

### Valid for Software Component
- **SAP_BASIS:** Versions 710 to 720

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017038232017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001473116?language=en-US&token=E771DCCC6248DC8E0184594DE0692A23)

---

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*