1475075 - Potential disclosure or modification of data in SolMan

**SAP Note 1475075** addresses a critical SQL injection vulnerability in SAP Solution Manager (SolMan) that could allow unauthorized disclosure or modification of data.

### **Issue**
A malicious user can exploit specially crafted inputs to modify, retrieve, or delete any data within the Solution Manager. This vulnerability arises from an SQL injection weakness where SQL statements are improperly assembled from strings. Attackers can manipulate these statements to execute arbitrary SQL commands with the privileges of the logged-in database user.

### **Affected Components**
- **Component:** Service > SAP Solution Manager > Solution Manager System Landscape (SV-SMG-SYS)
- **Software Component Version:** ST 400
- **Support Package:** [SAPKITL435](https://me.sap.com/supportpackage/SAPKITL435)

### **Solution**
The vulnerability is automatically fixed in SAP Solution Manager 7.01 Support Package 25. For installations running Support Packages lower than 25, follow these steps:

1. **Create the SECURITY Log Object**
   - Use transaction `SLG0` to create a subobject `SECURITY` with the subobject text "Log for SMSY Security Handling" for the object `SMSY_LOG_OBJ`.

2. **Extend the SMSY Options**
   - **Extend the SMSY_OPTION Domain:**
     - Go to transaction `SE11` (ABAP Dictionary), select "Domain," and enter `SMSY_OPTION`.
     - Add the following new option values:
       - `SCUEXC_DIS` – Deactivation of the security check exception
       - `SCULOG_ENA` – Activation of the security check log
     - Save and activate your changes.
   
   - **Include the New Domain Values in SMSY_OPTIONS:**
     - Navigate to transaction `SM30` ("Maintain Table Views: Initial Screen").
     - Enter `SMSY_OPTIONS` and choose "Maintain."
     - Add new entries for `SCUEXC_DIS` and `SCULOG_ENA` with appropriate descriptions and settings.
     - Save the new options.

3. **Implement Correction Instructions**
   - Follow the attached correction instructions provided in the SAP Note to activate security checks and logging.
   - Post-implementation, security checks become active immediately, terminating processing if vulnerabilities are detected, and updating the application log via transaction `SLG1`.

   **Note:** Deactivating security checks will disable these protections, allowing potential attackers to access and modify data within the Solution Manager (`SMSY` transaction).

### **Additional Information**
- **Referenced Document:** [SAP Note 1552298 - Update #1 to Security Note 1475075](https://me.sap.com/notes/1552298)
- **Referenced By:** [SAP Note 1485671 - No systems displayed in Landscape Verification tool](https://me.sap.com/notes/1485671)

### **Downloads**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008726622017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001475075?language=en-US&token=5A56A016C22849C1EF808B566891650B)

### **CVSS**
- **Score:** 0

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*