SAP Security Note 1472498: Code Injection Vulnerability in Commodity Pricing

**Title:** 1472498 - Code injection vulnerability in Commodity Pricing

**Description:**
A vulnerability has been identified in the Commodity Pricing program which allows the execution of arbitrary code. This flaw enables a malicious user to control system behavior or escalate privileges by running malicious code without legitimate credentials. Additionally, it is possible to manipulate data in any database table through this program.

**Implications:**
- **Code Injection:** Unauthorized execution of arbitrary code.
- **Privilege Escalation:** Potential to gain higher privileges without proper credentials.
- **Data Manipulation:** Ability to modify, delete, or create data within database tables.
- **Denial of Service:** Possibility to disrupt system functionality.

**Solution:**
A whitelist will be implemented to ensure that only specified tables can be updated by the Commodity Pricing program after applying the correction. This restricts unauthorized table modifications and mitigates the risk of code injection.

**Correction Instructions:**

*For BBPCRM 701:*
1. **Transaction SE91:**
   - Access transaction SE91.
   - Edit the message class `CPE_CRM`.
   - Add message number `141` with the text `You are not authorized to update the table &1`.
   - Save the changes.

*For SAP_APPL (Release 603, 604, 605):*
1. **Transaction SE91:**
   - Access transaction SE91.
   - Edit the message class `CPE_ERP`.
   - Add message number `041` with the text `You are not authorized to update the table &1`.
   - Save the changes.

**Support Packages:**
- **SAP_APPL 603:** [SAPKH60307](https://me.sap.com/supportpackage/SAPKH60307)
- **SAP_APPL 604:** [SAPKH60408](https://me.sap.com/supportpackage/SAPKH60408)
- **SAP_APPL 605:** [SAPKH60502](https://me.sap.com/supportpackage/SAPKH60502)
- **BBPCRM 701:** [SAPKU70102](https://me.sap.com/supportpackage/SAPKU70102)

**Downloads:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008710342017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001472498?language=en-US&token=A88671100A97B8E63B1677ACCC56D824)

**Manual Activities:**
- Implement the manual correction instructions as outlined above to ensure the vulnerability is mitigated effectively.

For more detailed information, refer to the [SAP Security Note 1472498](https://me.sap.com/notes/0001472498).

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*