SAP Security Note 1472395 - Unauthorized Changes of Stored Contents (Agency Collections)

**SAP Note/KBA:** 1472395  
**Type:** SAP Security Note  
**Version:** 6  
**Recency:** New  
**Language:** English  
**Master Language:** German  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 09.11.2010  
**Component:** Financial Services > Collections and Disbursements (FS-CD)  
**Title:** Unauthorized changes of stored contents (agency collections)

### Symptom
This note is relevant only if you use the application component **FS-CD (software component INSURANCE)** and the BSP applications of the Italian agency collections within this application component. If you do not use these components, you are not affected by the problem and you do not have to implement this note.

By manipulating the agency collections, an attacker can change the displayed data of another user without having the relevant authorization. The attacker can also save the data that has been changed and may be able to access the authentication data of the user.

### Other Terms
Permanent cross-site scripting, agency collection, BSP, Italy, FSCDITAGCY, FSCDITAGCY_START, index.htm, XSS, cross-site scripting

### Reason and Prerequisites
Since there is no sufficient input validation using the component **FSCDITAGCY_START**, a permanent cross-site scripting may be triggered. As a result, an attacker can store manipulated content on a server. This content is displayed automatically for a victim and is interpreted by the victim's browser. This enables the attacker to obtain the information of a user. The attacker can use this information so that the application assumes that the attacker has the relevant authorization. As a result, the attacker can use the application with the authorizations of the victim. If a user with administration authorizations falls victim to an attack, all of the data of the application may be compromised.

### Solution
Implement this note or import the relevant Support Package. In addition, implement [Note 1480715](https://me.sap.com/notes/0001480715).

**Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000008709792017](https://notesdownloads.sap.com/note/0040000008709792017)  
**PDF Version:** [https://userapps.support.sap.com/sap/support/sfm/notes/print/0001472395?language=en-US&token=576FFAF3B34E996A20604AD6448E9C7B](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001472395?language=en-US&token=576FFAF3B34E996A20604AD6448E9C7B)

**Affected Software Components:**
- INSURANCE 472
- INSURANCE 600
- INSURANCE 602
- INSURANCE 603
- INSURANCE 604
- INSURANCE 605

**Support Packages Available:**
- [INSURANCE 472 - SAPKIPIN19](https://me.sap.com/supportpackage/SAPKIPIN19)
- [INSURANCE 600 - SAPK-60018ININSURANC](https://me.sap.com/supportpackage/SAPK-60018ININSURANC)
- [INSURANCE 602 - SAPK-60208ININSURANC](https://me.sap.com/supportpackage/SAPK-60208ININSURANC)
- [INSURANCE 603 - SAPK-60307ININSURANC](https://me.sap.com/supportpackage/SAPK-60307ININSURANC)
- [INSURANCE 604 - SAPK-60407ININSURANC](https://me.sap.com/supportpackage/SAPK-60407ININSURANC)
- [INSURANCE 605 - SAPK-60502ININSURANC](https://me.sap.com/supportpackage/SAPK-60502ININSURANC)

### References
- [Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

### Side Effects
This document is causing side effects with [Note 1480715](https://me.sap.com/notes/0001480715).

For more detailed information, please refer to the [Full SAP Security Note 1472395](https://me.sap.com/notes/0001472395).

*Credits to [Red Rays](https://redrays.io) for support in providing this information.*