2913293 - [CVE-2020-6254] Cross-Site Scripting (XSS) vulnerability in SAP Enterprise Threat Detection

## Symptom

SAP Enterprise Threat Detection does not sufficiently encode error pages in case of errors, resulting in a Cross-Site Scripting (XSS) vulnerability.

Some well-known impacts of XSS vulnerability are:

- Non-permanently deface or modify displayed content from a website
- Steal authentication information of the user, such as data relating to their current session
- Impersonate the user and access all information with the same rights as the target user

## Other Terms

XSS, [CVE-2020-6254](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6254), Reflected XSS, CSS

## Reason and Prerequisites

The error response pages were not properly encoded in case of errors, allowing XSS payload reflecting in the response.

## Solution

The XSS vulnerability has been fixed by output encoding of the error response pages. The fix has been made available with the Support Packages and Patches referenced by this SAP Security Note.

## Affected Components

- **BC-SEC-ETD** (SAP Enterprise Threat Detection)

## CVSS

**Score:** 6.1

**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

## Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000795662020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002913293?language=en-US&token=DC3F02A28B1DA96A59F82E5E64F86E06)

## Support Package Patches

### ENTERPRISE THREAT DETECT 2.0
- **SP000** - Patch Level: 000002 [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200007823&support_package=SP000&patch_level=000002)
- **SP001** - Patch Level: 000003 [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200007823&support_package=SP001&patch_level=000003)
- **SP002** - Patch Level: 000000 [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200007823&support_package=SP002&patch_level=000000)

### ENTERPRISE THREAT DETECT 1.0
- **SP007** - Patch Level: 000002 [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67837800100200025869&support_package=SP007&patch_level=000002)

## Available Translations

- [Deutsch (Machine Translation)](https://me.sap.com/notes/0002913293/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002913293/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002913293/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002913293/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002913293/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002913293/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002913293/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002913293/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002913293/3)

## Credits

Thanks to [Redrays.io](https://redrays.io) for support in providing this information.