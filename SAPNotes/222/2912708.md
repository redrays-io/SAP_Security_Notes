2912708 - [CVE-2020-6278] Cross-Site Scripting (XSS) vulnerability in SAP Business Objects Business Intelligence Platform (BI Launchpad and CMC)

---

**Symptom**

SAP Business Objects BI Launchpad and Central Management Console (CMC) are vulnerable to a stored Cross-Site Scripting (XSS) attack. An attacker can embed malicious scripts by uploading malformed images. These scripts execute when a victim accesses the infected files, leading to stored XSS.

**Impact**

- **Defacement:** Temporarily alter or modify website content.
- **Credential Theft:** Steal user authentication information, including session data.
- **Impersonation:** Act as the user to access information with the same privileges.

**Reason and Prerequisites**

When uploading local documents in BI Launchpad and CMC, the MIME type of the file must match its actual file type. Failure to enforce this validation can allow malicious scripts to be executed.

**Solution**

This vulnerability has been addressed in various support package patches. Administrators should apply the appropriate patches and configure the `upload.file.allowed.formats` property to enforce MIME type validation.

**Steps to Mitigate:**

1. **Apply Support Package Patches**

   Ensure that the relevant support package patches are applied to your SAP Business Objects installation. Refer to the [Support Package Patches](#support-package-patches) section below for detailed patch information.

2. **Configure MIME Type Validation**

   Edit the `global.properties` file to define allowed file formats and their corresponding MIME types. This ensures that uploaded files are validated against their MIME types.

   - **File Location:**
     ```
     <INSTALLED_APPLICATION-SERVER_DIR>\<APPLICATION_SERVER>\webapps\BOE\WEB-INF\config\default\global.properties
     ```
     *Note: In SAP BusinessObjects Business Intelligence 4.1 with the latest service patch, the `global.properties` file is located at:*
     ```
     <INSTALLED_APPLICATION-SERVER_DIR>\<APPLICATION_SERVER>\webapps\BOE\WEB-INF\internal\global.properties
     ```

   - **Configuration Example:**
     ```properties
     upload.file.allowed.formats=jpg,image/jpeg,png,image/png
     ```

   This configuration ensures that only files with the specified extensions and MIME types are accepted. If a mismatch is detected, an error message "File type doesn't match" will be displayed.

**Support Package Patches**

- **SBOP BI PLATFORM SERVERS 4.3**
  - **SP000 Patch 000000:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)

- **SBOP BI PLATFORM SERVERS 4.2**
  - **SP009 Patch 000000:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
  - **SP008 Patch 000300:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
  - **SP007 Patch 001100:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)

- **SBOP BI PLATFORM SERVERS 4.1**
  - **SP012 Patch 000600:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)

**CVSS Details**

- **Score:** 5.4 (Medium)
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** Low
  - **User Interaction:** Required
  - **Scope:** Changed
  - **Confidentiality Impact:** Low
  - **Integrity Impact:** Low
  - **Availability Impact:** None

**References**

- [SAP Note 2315665: File Types supported for upload Local document in Infoview and CMC](https://me.sap.com/notes/2315665)
- [SAP Note 2144559: BI 4.x Maintenance Strategy & Schedule](https://me.sap.com/notes/2144559)

---

*Credits: [Redrays.io](https://redrays.io) for supporting the provision of this information.*