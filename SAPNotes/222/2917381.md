SAP Security Note 2917381 - CVE-2020-6272: XSS Vulnerability in SAP Commerce Cloud

**Overview**

SAP Commerce Cloud has been identified with a Cross-Site Scripting (XSS) vulnerability, tracked as [CVE-2020-6272](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6272). This vulnerability allows authenticated and authorized content managers to inject malicious scripts into web CMS components, potentially compromising the security of web pages.

**Details**

- **Vulnerability Type:** Cross-Site Scripting (XSS)
- **CVE Identifier:** CVE-2020-6272
- **Affected Component:** Customer Engagement and Commerce (CEC-COM-CPS-WEB)
- **Affected Versions:** 
  - SAP Commerce Cloud versions before 2005
  - Specific Software Components: HY_COM versions 1808, 1811, 1905, 2005
- **CVSS Score:** 5.4 (Medium)
- **Release Date:** October 13, 2020

**Impact**

An authenticated content manager can inject and execute malicious JavaScript code within the storefront web pages they manage. This can lead to unauthorized actions, data breaches, and other security issues when affected web pages are accessed.

**Solution**

1. **Update SAP Commerce Cloud:**
   - **Accelerator Storefronts:** Upgrade to **SAP Commerce Cloud version 2005.3** or later. This version includes enhanced HTML sanitization to prevent XSS attacks.
   - **SmartEdit:** Apply the following patch releases to address the vulnerability:
     - [Patch Release 1808.29](https://me.sap.com/notes/2917381/download)
     - [Patch Release 1811.27](https://me.sap.com/notes/2917381/download)
     - [Patch Release 1905.19](https://me.sap.com/notes/2917381/download)
     - [Patch Release 2005.3](https://me.sap.com/notes/2917381/download)

   Download the relevant patches from the [SAP Support Portal](https://me.sap.com/).

2. **Configuration Adjustment (Optional):**
   - To prevent content managers from adding arbitrary JavaScript, set the following property:
     ```
     cms.components.allowUnsafeJavaScript=false
     ```
   - **Default Setting:** `false`
   - **Enabling Unsafe JavaScript:** If absolutely necessary, administrators can set this to `true`, but it is **strongly discouraged** due to security risks.

**Mitigation Steps**

- **Restrict JavaScript Editing:** Limit the ability of content managers to include or edit JavaScript within CMS components.
- **Implement Peer Reviews:** Ensure that any JavaScript code added by content managers undergoes thorough reviews to prevent malicious code execution.
- **Regular Updates:** Keep SAP Commerce Cloud and its components updated with the latest patches and security updates from SAP.

**Additional Information**

For comprehensive details, refer to the official SAP Security Note [2917381](https://me.sap.com/notes/2917381). Ensure you review all sections, including the "Symptom," "Solution," and "Backward compatibility," to fully understand the scope and remediation steps required.

**Credits**

Information provided by [redrays.io](https://redrays.io) for supporting the dissemination of this security update.