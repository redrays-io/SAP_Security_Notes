2918924 - [CVE-2020-6265] Use of Hard-coded Credentials in SAP Commerce and SAP Commerce Datahub

# Description

### Symptom
SAP Commerce and SAP Commerce Datahub allow attackers to bypass authentication and authorization configured by the system administrator by using default credentials.

**Impacts of Default Credentials:**
- Exposure of resources or functionality to unintended users.
- Possibility of arbitrary code execution.

### Other Terms
- Hard-coded Password
- Hard-coded Username
- Hard-coded Key
- Default Password
- [CVE-2020-6265](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6265)

### Reason and Prerequisites
Default passwords are associated with several default user accounts in both SAP Commerce and SAP Commerce Datahub.

# Solution

SAP Commerce releases that address this vulnerability **do not initialize default passwords upon installation**. Instead, they implement the following approaches:

1. **Admin Account:**
   - SAP Commerce no longer sets a default password for the built-in "admin" account.
   - The installer [elicits an initial password](https://help.sap.com/viewer/9433604f14ac4ed98908c6d4e7d8c1cc/2005/en-US/33d1c80541d146b9bc4df136acc1f5de.html) for the "admin" account.

2. **Other Built-in User Accounts:**
   - SAP Commerce does not set default passwords for other built-in user accounts.
   - The installer creates these accounts but leaves them inactive.
   - To enable these accounts, [set a password](https://help.sap.com/viewer/9433604f14ac4ed98908c6d4e7d8c1cc/2005/en-US/c5d463ec2fbb45b2a7aef664df42d2dc.html) on each account individually.

3. **SAP Commerce Datahub:**
   - Does not set default passwords for built-in accounts.
   - You must [provide a password](https://help.sap.com/viewer/50c996852b32456c96d3161a95544cdb/2005/en-US/0cb1c54a3f1a4779a5f2b0096e7cc5d5.html) for each account explicitly.

**Affected Releases:**
- SAP Commerce version 2005 and above.
- Patch Releases:
  - [SAP Hybris Commerce 6.7.0.30 Patch Release](https://me.sap.com/cxjira.sap.com/browse/PATCH-7599)
  - [SAP Commerce Cloud Patch Release 1808.25](https://me.sap.com/cxjira.sap.com/browse/PATCH-7600)
  - [SAP Commerce Cloud Patch Release 1811.23](https://me.sap.com/cxjira.sap.com/browse/PATCH-7601)
  - [SAP Commerce Cloud Patch Release 1905.15](https://me.sap.com/cxjira.sap.com/browse/PATCH-7602)

**Manual Corrections for Existing Installations:**
- Re-initializing SAP Commerce after installing the patch will remove default credentials but is **not recommended for production systems**.
- Alternatively, follow the instructions in the [Disabling All Default Passwords for Users](https://help.sap.com/viewer/9433604f14ac4ed98908c6d4e7d8c1cc/2005/en-US/07e594acc6544076b715407b14dfd0bb.html) guide using scripts from [SAP Note 2922193](https://me.sap.com/notes/2922193).

# CVSS Score

**Score:** 9.8

**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H  
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

# References

- [SAP Commerce - Remove all default passwords](https://me.sap.com/notes/2922193)

---

*Credits to [Redrays.io](https://redrays.io) for supporting the information provided.*