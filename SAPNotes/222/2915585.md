SAP Security Note 2915585 - CVE-2020-6243: Code Injection in SAP Adaptive Server Enterprise

## Description

**Symptom**

SAP Adaptive Server Enterprise (XP Server on Windows Platform) does not perform the necessary checks for an authenticated user while executing the extended stored procedure. Under certain conditions, the impact of this code injection is:

- Read, modify, and delete restricted data on connected servers.

**Other Terms**

Access control, Insufficient error checks, SAP ASE, XP Server, [CVE-2020-6243](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6243)

**Reason and Prerequisites**

The XP Server performs insufficient error checking for an authenticated user while executing the extended stored procedure. This vulnerability impacts only the Windows platform.

**Affected Versions:**
- SAP ASE 15.7 SP 141 HF1
- SAP ASE 15.7 SP 141 CE HF1
- SAP ASE 16.0 SP02 PL09 HF1
- SAP ASE 16.0 SP03 PL08 HF1

## Solution

This issue is fixed by placing validation checks at the appropriate places while executing the extended stored procedure.

**Fixed Versions:**
- SAP ASE 15.7 SP 141 HF1
- SAP ASE 15.7 SP 141 CE HF1
- SAP ASE 16.0 SP02 PL09 HF1
- SAP ASE 16.0 SP03 PL08 HF1

**Action Required:**
Install the above fixed SAP ASE versions if you are using the affected SAP ASE XP Server versions.

**Note:** All releases subsequent to the published fixed release inherit the fix described in this security note.

## CVSS Details

- **CVSS Score:** 8.0
- **Vector:** [CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

**Metrics:**
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** High (H)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

## References

- [How to add XP Server manually - SAP ASE](https://me.sap.com/notes/2276091)

## Additional Information

- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 12.05.2020
- **Component:** [Basis Components > Sybase Products > Sybase ASE Database Platform (non Business Suite)](https://me.sap.com/servicessupport/knowledge/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

For more details, visit the [SAP Security Notes](https://me.sap.com/notes/2915585).

*Credits to [redrays.io](https://redrays.io) for providing the information.*