1676934 - Malicious modification of SRM attachment url.

---

### Description

**Symptom**  
SRM attachments can be abused by an attacker, allowing them to modify displayed application content without authorization and potentially obtain authentication information from other legitimate users.

**Other Terms**  
SRM Attachments, Documents and Attachments, Handler class, `CL_HTTP_BBP_DOCSERVER`, SICF, DOCSERVER, Reflected cross-site scripting (XSS), SRM-EBP-CA-ATT, BBP_OUT, 1674905.

**Reason and Prerequisites**  
This problem is caused by a program error. Within SRM attachment functionality, some input and output parameters do not sufficiently encode, resulting in a reflected cross-site scripting issue. A reflected XSS attack can be used to non-permanently deface or modify displayed content from a website. Additionally, it can steal another user's authentication information, such as data relating to their current session, allowing an attacker to impersonate the user and access all information with the same rights. If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**  
Implement the attached corrections or import the corresponding support package.  
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009958342017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001676934?language=en-US&token=313E834B6849A9AE5C4D043CD326A745)

### Affected Software Components

| Software Component | From | To |
|--------------------|------|----|
| SRM_SERVER         | 500  | 500 |
| SRM_SERVER         | 550  | 550 |
| SRM_SERVER         | 600  | 600 |
| SRM_SERVER         | 700  | 700 |
| SRM_SERVER         | 701  | 701 |
| SRM_SERVER         | 702  | 702 |

### Support Packages

| Software Component Version | Support Package        | URL                                               |
|----------------------------|------------------------|---------------------------------------------------|
| SRM_SERVER 500             | SAPKIBKS18             | [Link](https://me.sap.com/supportpackage/SAPKIBKS18) |
| SRM_SERVER 550             | SAPKIBKT20             | [Link](https://me.sap.com/supportpackage/SAPKIBKT20) |
| SRM_SERVER 600             | SAPKIBKU06             | [Link](https://me.sap.com/supportpackage/SAPKIBKU06) |
| SRM_SERVER 700             | SAPKIBKV12             | [Link](https://me.sap.com/supportpackage/SAPKIBKV12) |
| SRM_SERVER 701             | SAPK-70108INSRMSRV     | [Link](https://me.sap.com/supportpackage/SAPK-70108INSRMSRV) |
| SRM_SERVER 702             | SAPK-70203INSRMSRV     | [Link](https://me.sap.com/supportpackage/SAPK-70203INSRMSRV) |

### Prerequisites

| Software Component | From | To | SAP Note/KBA | Title                                                    | Component          |
|--------------------|------|----|--------------|----------------------------------------------------------|--------------------|
| SRM_SERVER         | 500  | 500 | 1674905      | Malicious modification of displayed SRM attachments      | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 500  | 500 | 1676934      | Malicious modification of SRM attachment url.            | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 550  | 550 | 881212       | SRM5.0: Usability of the document screen                  | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 550  | 550 | 1674905      | Malicious modification of displayed SRM attachments      | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 550  | 550 | 1676934      | Malicious modification of SRM attachment url.            | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 600  | 600 | 1674905      | Malicious modification of displayed SRM attachments      | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 600  | 600 | 1676934      | Malicious modification of SRM attachment url.            | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 700  | 700 | 1674905      | Malicious modification of displayed SRM attachments      | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 700  | 700 | 1676934      | Malicious modification of SRM attachment url.            | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 701  | 701 | 1674905      | Malicious modification of displayed SRM attachments      | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 701  | 701 | 1676934      | Malicious modification of SRM attachment url.            | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 702  | 702 | 1674905      | Malicious modification of displayed SRM attachments      | SRM-EBP-CA-ATT     |
| SRM_SERVER         | 702  | 702 | 1676934      | Malicious modification of SRM attachment url.            | SRM-EBP-CA-ATT     |

### CVSS

**CVSS Score:** 0  
**CVSS Vector:** _Not Provided_

### Rating

- **Rated Helpful:** 0 people
- **Quality Rating:** 0.0 (0 votes)

### Side Effects

**This document solves side effects:**

| RefNumber | Title                                         | Url                               |
|-----------|-----------------------------------------------|-----------------------------------|
| 1674905   | Malicious modification of displayed SRM attachments | [Link](https://me.sap.com/notes/0001674905) |

**This document is causing side effects:**  
_None_

---

For more information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for support and information.*