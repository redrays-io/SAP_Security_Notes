Sap Security Note 1677810 - Unauthorized modification in ITS-Service in IS-U-WA

**Overview**

SAP Security Note [1677810](https://notesdownloads.sap.com/note/0040000009964962017) addresses a critical cross-site scripting (XSS) vulnerability in the ITS Service `EWHV_WASTE` within the `IS-U-WA` component. This vulnerability allows malicious users to modify displayed application content without authorization and potentially steal authentication information from legitimate users.

**Impact**

- **Unauthorized Modifications:** Malicious users can alter application content without proper authorization.
- **Credential Theft:** Potential for unauthorized users to obtain authentication information, enabling them to impersonate legitimate users.
- **Full Application Compromise:** If an administrator's credentials are stolen, the entire application's security can be compromised.

**Affected Components**

- **Software Component:** IS-UT
- **Versions:** 600, 602, 603, 604, 605, 606, 616

**Solution**

To mitigate this vulnerability, apply [SAP Note 1677810](https://notesdownloads.sap.com/note/0040000009964962017) along with the prerequisite notes [1621946](https://me.sap.com/notes/1621946) and [1488500](https://me.sap.com/notes/1488500).

**Steps to Apply the Fix:**

1. **Via Support Packages:**
   - Ensure that your `IS-UT` component is updated to the appropriate support package as specified in the note.
   - [Download Support Packages](https://me.sap.com/supportpackage/SAPK-60021INISUT)

2. **Manual Implementation:**
   - **Create and Activate Report:**
     - Create the report `ZITS_XSS_PARAM_EWHV_WASTE` using the source code provided in the correction instructions.
     - Activate the report in your system.
   - **Execute the Report:**
     - Run the report `ZITS_XSS_PARAM_EWHV_WASTE` in every system where the note is implemented.
     - Optionally, add the program to the corresponding transport request to automate execution upon import.

**Additional Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009964962017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001677810?language=en-US&token=E71ABEF357BCD469B113C5F64A7AF65D)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001677810/E/diff)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001677810)

**References**

- [SAP Note 1621946](https://me.sap.com/notes/1621946) - ITS: updated XSS-escaping functions
- [SAP Note 1488500](https://me.sap.com/notes/1488500) - ITS: automatically escape context fields in output

**Credits**

Information supported by [RedRays.io](https://redrays.io).