1677291 - Potential denial of service in Web Application Components

**SAP Security Note 1677291 - Potential Denial of Service in Web Application Components**

**Symptom**
An attacker can remotely exploit SAP Web Application Servers—through IC Manager, Web Dispatcher, or Message Server—rendering the servers and potentially the resources they use unavailable, resulting in a Denial of Service (DoS).

**Other Terms**
- **DoS**: Denial of Service
- **IC Manager**: Internet Communication Manager
- **Web Dispatcher**
- **Message Server**
- **Denial of Service through Hashtable Collisions**

**Reason and Prerequisites**
The issue is caused by a resource exhaustion condition. An attacker can send a specifically crafted request that causes the process to consume excessive resources. As a result, no other processes can allocate new resources, making the system unavailable. This condition can be intentionally triggered by an attacker to cause a denial of service.

**Solution**
A kernel patch is provided that introduces the profile parameter `ict/max_form_fields`, which limits the maximum number of form fields per HTTP request processed by the HTTP parser. This mitigates the vulnerability caused by hash table collision attacks. The default value of the parameter is **5000** and can be changed either dynamically via transaction **RZ11** or by editing the application server instance's start profile.

**Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017378372017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001677291?language=en-US&token=4095D1F58EEB1B1E941801A58363F777)

**Components Affected**
- Basis Components > Client/Server Technology > Message Service (BC-CST-MS)
- Basis Components > Client/Server Technology > Internet Communication Manager (BC-CST-IC)
- Basis Components > Client/Server Technology > Web Dispatcher (BC-CST-WDP)

**Supported Software Versions and Patches**
Ensure that your SAP Kernel is updated to one of the following supported versions with the corresponding support package patches:

- **SAP KERNEL 7.21 64-BIT UNICODE SP010 Patch 000010**
- **SAP KERNEL 7.20 32-BIT SP217 Patch 000217**
- **SAP KERNEL 7.11 64-BIT UNICODE SP160 Patch 000160**
- **SAP KERNEL 7.00 64-BIT UNICODE SP344 Patch 000344**
- **SAP KERNEL 6.40 64-BIT UNICODE SP405 Patch 000405**
  
_For a complete list of supported versions and patches, please refer to the [Support Package Patches](https://me.sap.com/note/0001677291) section of the security note._

**References**
- [Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)
- [ERROR ==> Number of form fields exceeds limit of 5000 (ictxxHttp2)](https://me.sap.com/notes/1765048)
- [Parameter ict/max_form_fields cannot be changed dynamically](https://me.sap.com/notes/1921052)
- [AVA@SAP: Probleme mit unvollständig gespeicherten Daten](https://me.sap.com/notes/1786552)

**Credits**
Information supported by [Redrays.io](https://redrays.io).