SAP Note 1677486 - Unauthorized modification in ITS-Service in SCM-APO-CA-COP

**Title:**  
SAP Note 1677486 - Unauthorized modification in ITS-Service in SCM-APO-CA-COP

**Description:**  
SAP SCM-APO-CA-COP has a vulnerability that allows unauthorized users to modify displayed application content. This can potentially lead to the theft of authentication information from legitimate users, enabling malicious actors to impersonate users and access sensitive information with the same privileges. If an administrator is impersonated, the security of the entire application may be compromised.

**Symptom:**  
A malicious user can exploit SCM-APO-CA-COP to modify application content without proper authorization and obtain authentication details from other users.

**Reason:**  
ITS Service components (AMON, AMON_STATIST, CLPBID, CLPPROMCAL, CLPSDP) within SCM-APO-CA-COP do not sufficiently encode output parameters, resulting in a cross-site scripting (XSS) vulnerability.

**Solution:**  
To mitigate this vulnerability, apply the manual correction instructions provided in this note or import the changes via the relevant support package. Additionally, ensure that the corrections from SAP Notes [1621946](https://me.sap.com/notes/1621946) and [1488500](https://me.sap.com/notes/1488500) are implemented, as they are prerequisites for the effectiveness of this fix.

**Manual Correction Instructions:**

1. **Enter Transaction SICF:**
   - Navigate to transaction SICF to maintain the necessary service parameters.

2. **Update Affected ITS Services:**
   - For each affected ITS service (CLPBID, CLPPROMCAL, CLPSDP), perform the following steps:
     a. Enter the service name (e.g., CLPSDP) and press **Execute** on the initial screen or **Apply** on the maintenance screen.
     b. Double-click on the service to enter the 'Create/Change service' screen and enter change mode.
     c. On the 'Service data' tab, select **GUI Configuration**.
     d. Enter the following parameters:
        - **Parameter name:** `~AUTO_HTML_ESCAPING`  
          **Value:** `1`
        - **Parameter name:** `~NEW_XSS_FUNCTIONS`  
          **Value:** `1`
     e. Select **Copy Parameter Set** to apply the changes and save the service.

**References:**
- [SAP Note 1621946 - ITS: updated XSS-escaping functions](https://me.sap.com/notes/1621946)
- [SAP Note 1488500 - ITS: automatically escape context fields in output](https://me.sap.com/notes/1488500)

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009962002017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001677486?language=en-US&token=8D9155F58881BF3573BD478BF53E2048)

**Support Packages:**
- SCM 410: [SAPKY41022](https://me.sap.com/supportpackage/SAPKY41022)
- SCM 500: [SAPKY50022](https://me.sap.com/supportpackage/SAPKY50022)
- SCM 510: [SAPKY51018](https://me.sap.com/supportpackage/SAPKY51018)
- SCM 700: [SAPKY70012](https://me.sap.com/supportpackage/SAPKY70012)
- SCM 701: [SAPKY70109](https://me.sap.com/supportpackage/SAPKY70109)
- SCM 702: [SAPKY70203](https://me.sap.com/supportpackage/SAPKY70203)

**Credits:**  
Thanks to [Redrays](https://redrays.io) for supporting and providing the information.