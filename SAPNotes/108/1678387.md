1678387 - Potential denial of service in AS Java Web container

## Overview
**SAP Note/KBA:** 1678387  
**Type:** SAP Security Note  
**Version:** 3  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 09.10.2012  
**Component:** Basis Components > NetWeaver Application Server Java > Web Container, HTTP, JavaMail, Servlets  

## Description
An attacker can remotely exploit the Web container (servlet_jsp), rendering it, and potentially the resources that are used to serve AS Java (J2EE), unavailable. This leads to a denial of service (DoS) condition.

### Symptom
After an HTTP request, one of the following errors may be observed:
- **There are too many parameters in the request. Maximum number of parameters in the request 1000 was exceeded. Check SAP note 1678387 for further information.**
- **Cannot parse the parameters of the request. Maximum number of parameters 5000 was exceeded.**

### Reason and Prerequisites
The issue is caused by a resource exhaustion condition. An attacker can send a specifically crafted request that consumes excessive resources, making the system unavailable.

## Solution
1. **Update to the latest version of AS Java (J2EE).**  
   If updating is not feasible, apply one of the patches listed in the Support Package Patch Level section of the note.

2. **Adjust the `MaxParameterCount` property:**  
   Depending on the application logic, after applying the patch, you might observe one of the error messages mentioned above. To mitigate this, increase the `MaxParameterCount` value:
   - **Recommended Maximum:** 10,000 (values higher than this are not recommended)
   - **Default Values:**
     - Versions 6.40, 7.00, 7.01, 7.02, 7.03: 1000
     - Systems 7.10, 7.10 EHP1, 7.20, 7.30 and subsequent: 5000

### Steps to Change `MaxParameterCount`
1. Open the Config tool. For systems 7.10 - 7.3x, enable Expert mode from the View menu.
2. Navigate to `cluster-data -> Global server configuration` or `template -> service -> servlet_jsp`.
3. Click on `MaxParameterCount`.
4. Enter the new value (e.g., 7000) in the Value field.
5. Select **Set Custom value** and click the **Save** button in the top-right corner.
6. Restart the cluster.

## Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017379912017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001678387?language=en-US&token=7703CB5FC5D6CA12D8F9B7F84EC71472)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001678387) *(Visible to authorized users)*
- [Share by Email](https://me.sap.com/)
- [Open in New Window](https://me.sap.com/)
  
## References
- [1880668 - Mass data input issue when using planning application](https://me.sap.com/notes/1880668)
- [1830931 - iViews Result set getting iViews Runtime Exception](https://me.sap.com/notes/1830931)

## Validity
Applicable to various versions of ENGINEAPI and SAP J2EE ENGINE CORE. Please refer to the [Support Package Patches](https://notesdownloads.sap.com/note/0040000017379912017) for detailed patch information.

## Side Effects
This document addresses side effects related to:
- [2988139 - Internal Server Error when processing large number of scrapping items](https://me.sap.com/notes/2988139)
- [1963520 - Single parameter for passing configuration data to IPC JSP UI](https://me.sap.com/notes/1963520)

## Additional Information
For more details and support, visit the [SAP Support Portal](https://me.sap.com/).

_Credits to [RedRays](https://redrays.io) for supporting information._