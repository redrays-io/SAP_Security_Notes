1641153 - Wiki application is vulnerable to CSRF attack

### Header Data
- **SAP Note/KBA**: 1641153
- **Type**: SAP Security Note
- **Version**: 1
- **Recency**: New
- **Language**: English
- **Master Language**: English
- **Category**: Program error
- **Priority**: Correction with high priority
- **Release Status**: Released for Customer
- **Released On**: 14.02.2012
- **Component**: Basis Components > Communities > Wiki

### Description

#### Symptom
An attacker can execute functions in the wiki application without authentication and authorization.

#### Other Terms
Cross-site request forgery, XSRF, Wiki

#### Reason and Prerequisites
The wiki application executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed using the rights of the authenticated user. The attacker might use a cross-site scripting attack to do this, or they might present a link to the victim.

**Prerequisites:**
- The patch from [SAP Note 1450166](https://me.sap.com/notes/1450166) must be implemented in the system.

### Solution
A.) For more information about the affected releases, see the "SP Patch Level" tab page of this SAP note.

For more information about the SP Stack schedule and updates, visit the [SP Stacks maintenance schedule](http://service.sap.com/sp-stacks).

B.) **Possible workaround before the release of mentioned deliveries:** There is no workaround possible.

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017324282017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001641153?language=en-US&token=3761D807C7977B1CAF2E3FE188679651)
- Share by Email
- Open in New Window

### References
- [1656762 - Not possible to edit a system property in wiki application](https://me.sap.com/notes/1656762)
- [1655516 - KMC release SAP NetWeaver 7.30 SP7 Add-ons](https://me.sap.com/notes/1655516)
- [1619655 - KMC for EHP1 Netweaver release 7.31 SP2 - Add-ons](https://me.sap.com/notes/1619655)
- [1450166 - Unauthorized usage of application functionality](https://me.sap.com/notes/1450166)

### Validity
- **KMC-WIKI 7.30 to 7.30**
- **KMC-WIKI 7.31 to 7.31**

### Side Effects
This document is causing side effects:
- [1716772 - Direct links do not work for users with initial password](https://me.sap.com/notes/1716772)
- [1688002 - ISO-8859-1 encoded instead of UTF-8](https://me.sap.com/notes/1688002)
- [1703280 - Cannot access a wiki page using a direct link](https://me.sap.com/notes/1703280)

*Credits: [redrays.io](https://redrays.io) for support to provided information.*