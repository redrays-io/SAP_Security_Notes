1638596 - Potential modif. or disclosure of persisted data in WFM

**SAP Note/KBA**: 1638596  
**Type**: SAP Security Note  
**Version**: 2  
**Recency**: New  
**Language**: English  
**Component**: Cross-Application Components > General Application Functions > please use CRM-WFD (Workforce Management Application)

### Description

An attacker can exploit WFM (Workforce Management) by using specially crafted inputs to modify database commands. This can result in either the retrieval of additional information or the modification of data persisted by the system.

**Affected Function Modules:**
- `WFACS_CALCSTATUSES_GET`
- `WFATM_CLEAN_TEMP_TABLES`
- `WFA_DATE_DEP_ADD`
- `WFA_DATE_DEP_ADD_HISTORY`
- `WFA_DATE_DEP_PARENT_ADD`
- `WFA_TEXT_MODIFY`

**Other Terms:** SQL injection, database, WFM

**Reason and Prerequisites:**  
The vulnerability is caused by an SQL injection flaw. The code constructs an SQL statement that includes strings controllable by an attacker. This manipulated SQL statement can be used to retrieve additional data from the database or modify existing data.

### Solution

Apply the provided corrections to prevent short dumps by encoding the input values used within the SQL statements. This issue can occur when the mentioned function modules are called within an RFC-enabled call stack.

### References

- [WFM 3.0 SP15 Collective Note (KBA 1736562)](https://me.sap.com/notes/1736562)

### Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009728412017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001638596?language=en-US&token=42E4FBA7BCAB5D5BF702FD2AF9FA36B7)

### Support Packages

- **RTLWFM 100:** [SAPK-10015INRTLWFM](https://me.sap.com/supportpackage/SAPK-10015INRTLWFM)
- **RTLWFM 310:** [SAPK-31010INRTLWFM](https://me.sap.com/supportpackage/SAPK-31010INRTLWFM)

### Correction Instructions

There are 2 Correction Instructions available: [View Corrections](https://me.sap.com/corrins/0001638596/4431)

### Prerequisites

Before applying this note, ensure you have at least SP 23 of SAP_BASIS via [Note 1487337](https://me.sap.com/notes/1487337).

---
*Credits to [redrays.io](https://redrays.io) for support in providing this information.*