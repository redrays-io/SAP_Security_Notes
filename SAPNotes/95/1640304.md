SAP Security Note 1640304 - Unauthorized modification of displayed content in SAML2

**Type:** SAP Security Note  
**Version:** 4  
**Recency:** Updated  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 20.02.2012  
**Component:** Basis Components > Security - Read KBA 2985997 for subcomponents > Authentication > SAML 2.0 for ABAP  

### Description

#### Symptom
The implementation of SAML 2.0 has an XSS vulnerability and can be abused by an attacker, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

#### Other Terms
Reflected cross-site scripting, XSS, SAML2

#### Reason and Prerequisites
**Prerequisite:**
Note [1582870](https://me.sap.com/notes/1582870) has been implemented, or a Support Package has been imported that contains this note.

**Reason:**
Components within SAML 2.0 do not sufficiently encode OUTPUT parameters, resulting in a reflected cross-site scripting issue. A reflected cross-site scripting attack can be used to non-permanently deface or modify displayed content from a website. It can also be used to steal another user's authentication information, such as data relating to their current session. An attacker who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

#### Solution
Apply the appropriate corrections.

### References
- [SAP Note 1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)

### Validity
**Software Components:**
- SAP_BASIS from 702 to 702
- SAP_BASIS from 730 to 730
- SAP_BASIS from 731 to 731

### Support Packages
- [SAPKB70211 for SAP_BASIS 702](https://me.sap.com/supportpackage/SAPKB70211)
- [SAPKB73007 for SAP_BASIS 730](https://me.sap.com/supportpackage/SAPKB73007)
- [SAPKB73102 for SAP_BASIS 731](https://me.sap.com/supportpackage/SAPKB73102)
- [SAPKB73101 for SAP_BASIS 731](https://me.sap.com/supportpackage/SAPKB73101)

### Correction Instructions
7 corrections available for SAP_BASIS  
[Apply Corrections](https://me.sap.com/corrins/0001640304/41)

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009739122017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001640304?language=en-US&token=8D2465CD89FE208A630F17FA7E2B08E8)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001640304/E/diff)

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*