1640531 - Protecting data against change to destination authorization

**Overview**

SAP Security Note **1640531** addresses a critical issue where an attacker can alter the authorization checks for destination maintenance in the target system. This vulnerability allows unauthorized changes to destination data that are essential for security, such as passwords.

**Issue Details**

- **Symptom:** 
  An attacker can modify the authorization check for destination maintenance without initializing critical security data (e.g., passwords).

- **Affected Components:**
  - **Software Component:** BC-MID-RFC (Basis Components > Middleware > RFC)
  - **Versions:** 700 to 740

**Solution**

To mitigate this vulnerability, you should:

1. **Import the Relevant Support Package:**
   Apply the appropriate Support Package corresponding to your SAP_BASIS version as listed below.

2. **Implement Correction Instructions:**
   Follow the detailed correction instructions provided in the note to manually create necessary ABAP Dictionary structures and messages.

**Support Package Information**

Ensure you apply the correct Support Package based on your SAP_BASIS version:

| Software Component Version | Support Package     | [URL](https://me.sap.com/supportpackage/SAPKB70032)             |
|----------------------------|---------------------|-----------------------------------------------------------------|
| SAP_BASIS 700              | SAPKB70032          | [Download](https://me.sap.com/supportpackage/SAPKB70032)         |
| SAP_BASIS 701              | SAPKB70117          | [Download](https://me.sap.com/supportpackage/SAPKB70117)         |
| SAP_BASIS 702              | SAPKB70217          | [Download](https://me.sap.com/supportpackage/SAPKB70217)         |
| SAP_BASIS 710              | SAPKB71019          | [Download](https://me.sap.com/supportpackage/SAPKB71019)         |
| SAP_BASIS 711              | SAPKB71114          | [Download](https://me.sap.com/supportpackage/SAPKB71114)         |
| SAP_BASIS 720              | SAPKB72008          | [Download](https://me.sap.com/supportpackage/SAPKB72008)         |
| SAP_BASIS 730              | SAPKB73010          | [Download](https://me.sap.com/supportpackage/SAPKB73010)         |
| SAP_BASIS 731              | SAPKB73104          | [Download](https://me.sap.com/supportpackage/SAPKB73104)         |
| SAP_BASIS 740              | SAPKB74010          | [Download](https://me.sap.com/supportpackage/SAPKB74010)         |

**Manual Activities**

Before implementing the automatic correction instructions, perform the following manual steps:

1. **Create ABAP Dictionary Structures:**
   - **SDEST_PROXY_CHANGE_FLAGS**
     - *Short Description:* Changes to Technical Proxy Data
     - *Package:* SRFC_DESTAPI
     - *Components:* PROXY_SERVER_CHANGED, PROXY_SERVICE_NUMBER_CHANGED
   - **SDEST_TARGET_CHANGE_FLAGS**
     - *Short Description:* Changes to Target System Data
     - *Package:* SRFC_DESTAPI
     - *Components:* SERVER_NAME_CHANGED, SAVE_AS_HOSTNAME_CHANGED, SYSTEM_IDENTIFIER_CHANGED, SYSTEM_NUMBER_CHANGED, LOAD_BALANCING_CHANGED, PATH_PREFIX_CHANGED, SERVICE_NUMBER_CHANGED

2. **Create ABAP Report Text Elements:**
   - Use transaction SE38 with program `SAPLCRFC` to add the necessary text symbols.

3. **Create Messages:**
   - Use transaction SE91 with message class `SR` to add the required messages.

**Preconditions**

Ensure that the following SAP Notes are applied before implementing this security note:

- [1453178](https://me.sap.com/notes/1453178) - Leading blank in RFC destination name
- [1494899](https://me.sap.com/notes/1494899) - CHANGE_SUPPLIED_PARAMS_ONLY indicator
- [1511584](https://me.sap.com/notes/1511584) - Syntax error in RFC_MODIFY_R3_DESTINATION
- ... *(additional preconditions listed in the note)*

**References**

- **Side Effects:** This update may cause incompatibilities with [SAP Note 2132461](https://me.sap.com/notes/2132461) - RFC/HTTP Destination API checks are incompatible.

**Additional Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009740542017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001640531?language=en-US&token=932ADC51B379E3838B00699DE550326C)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001640531/E/diff)

For more detailed information and updates, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays.io](https://redrays.io) for supporting the provision of this information.*