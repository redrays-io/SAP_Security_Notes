1641103 - Possible incorrect redirection of web site content in ICF

**Title:** 1641103 - Possible incorrect redirection of web site content in ICF

**Symptom**
The Internet Communication Framework (ICF) can be exploited for phishing attacks. An attacker can publish a URL that appears to be from a legitimate product. When a victim visits this URL, they are redirected to a malicious URL chosen by the attacker. This can deceive the victim into trusting the site and disclosing private information, such as authentication credentials.

**Impact**
- **Phishing Attacks:** Attackers can mimic legitimate pages (e.g., login pages) to harvest sensitive information.
- **Trust Exploitation:** Victims may be tricked into believing they are interacting with a trusted application.

**Solution**
Implement the source code changes as outlined in the correction instructions or import the relevant Support Package provided by SAP.

**Correction Instructions:**
1. **Update Data Types:**
   - Go to transaction `SE11`, select "Data type", and enter `HTTP_WHITELIST_ENTRY_TYPE`. Choose "Display".
   - Double-click the domain `HTTP_WHITELIST_ENTRY_TYPE` and select the "Value Range" tab.
   - Choose "Change" and add the following entries:
     - `20 Redirect URL for /sap/public/myssocntl (Note 612670)`
     - `21 Redirect URL for /sap/public/bc/icf/logoff (Note 1509851)`
   - Save and activate your entries.

2. **Update Text Elements:**
   - Use transaction `SE80` to navigate to the class `CL_HTTP_EXT_MYSSOCNTL`.
   - Go to "Text elements" and add the following:
     - **Sym:** E02
     - **Text:** Redirect is not possible.
     - **mLen:** 27
     - **dLen:** 36

   - Repeat the process for the class `CL_HTTP_EXT_LOGOFF`.
     - Note: Step 6 is not applicable for Versions 640 and 700 as the class `CL_HTTP_EXT_LOGOFF` does not exist in these versions.

**Support Package:**
You can download the necessary Support Packages from the following links:

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009744222017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001641103?language=en-US&token=A76DE0A8BF36EA9842F216A4AAF99821)

**Additional Information:**
- **Release Date:** February 14, 2012
- **Priority:** Correction with high priority
- **Component:** Basis Components > Middleware > Internet Communication Framework

For more details, visit the [SAP Support Portal](https://me.sap.com/notes/0001641103).

*Credits to [https://redrays.io](https://redrays.io) for support in providing this information.*