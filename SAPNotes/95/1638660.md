1638660 - Potential information disclosure relating to PAF Monitor

**Description**

An information disclosure vulnerability has been identified in the PAF Monitor used to monitor documents sent through SAP PI. An attacker could exploit this vulnerability to gather information about the PAF Monitor, which may help them tailor their attacks against SAP systems and applications.

**Symptoms**

- Information about the PAF Monitor being used is exposed.
- Potential attackers can discover distributed business use cases implemented via the PAF Monitor.

**Impact**

Exploiting this vulnerability allows attackers to gain insights into the SAP system's configuration, enabling more targeted and potentially more damaging attacks.

**Solution**

To mitigate this vulnerability, follow the steps below to deactivate unnecessary services or apply the relevant support packages:

1. **Deactivate Unnecessary Services:**
   
   If the `"/sap/bc/webdynpro/sap/spaf_monitoring"` service is not required, ensure it is deactivated using transaction `SICF`:

   - **Step 1:** Call transaction `SICF`.
   - **Step 2:** In the **Service Path** field, enter `/sap/bc/webdynpro/sap/spaf_monitoring`.
   - **Step 3:** Click on the **Execute** button (F8).
   - **Step 4:** For all Virtual Hosts, select (double-click) the service leaf `spaf_monitoring`.
   - **Step 5:** Click on the **Change** button (Ctrl+F1).
   - **Step 6:** In the **SAP Authoriz.** field (located on the first tab labeled 'Service Data'), enter `PAFADM`.
   - **Step 7:** Click on the **Save** button (Ctrl+S).

   Repeat the above procedure for the following service names:
   
   - `spaf_pip_browser` (BXI000287)
   - `spaf_agents_browser` (BXI000358)
   - `spaf_error_handling` (BXI000478)
   - `spaf_monitoring_msgid` (BXI000776)
   - `spaf_agents_config` (BXI000960)
   - `spaf_bpa_main`
   - `spaf_config`
   - `spaf_home`
   - `spaf_test_docs`
   
   **Note:** Do not be confused if the **Service Name** starts with `BXI` instead of `spaf_`. Alternative names are equivalent and listed above.

2. **Apply Relevant Support Packages:**
   
   Ensure that the appropriate support packages are applied based on your SAP_BASIS version:

   | Software Component Version | Support Package  | URL                                                                                      |
   |----------------------------|------------------|------------------------------------------------------------------------------------------|
   | SAP_BASIS 710              | SAPKB71014       | [https://me.sap.com/supportpackage/SAPKB71014](https://me.sap.com/supportpackage/SAPKB71014) |
   | SAP_BASIS 711              | SAPKB71109       | [https://me.sap.com/supportpackage/SAPKB71109](https://me.sap.com/supportpackage/SAPKB71109) |
   | SAP_BASIS 720              | SAPKB72007       | [https://me.sap.com/supportpackage/SAPKB72007](https://me.sap.com/supportpackage/SAPKB72007) |
   | SAP_BASIS 730              | SAPKB73007       | [https://me.sap.com/supportpackage/SAPKB73007](https://me.sap.com/supportpackage/SAPKB73007) |

**Additional Information**

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000014247832017](https://notesdownloads.sap.com/note/0040000014247832017)
- **PDF Version:** [https://userapps.support.sap.com/sap/support/sfm/notes/print/0001638660?language=en-US&token=089F66E25BED702C3493A02641963878](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001638660?language=en-US&token=089F66E25BED702C3493A02641963878)

**Credits**

Information supported by [RedRays](https://redrays.io).