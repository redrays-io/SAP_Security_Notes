2427292 - Information disclosure in SAP MMC Console

**Description**

SAP MMC console allows an attacker to gain access to the password of a hidden user. With these credentials, the attacker may be able to start or stop Java systems via the MMC Web Service.

**CVSS Information**

- **CVSS v3 Base Score:** 6.6 / 10
- **Attack Vector:** Network (N)
- **Attack Complexity:** High (H)
- **Privileges Required:** High (H)
- **User Interaction:** None (N)
- **Scope:** Unchanged (U)
- **Confidentiality Impact:** High (H)
- **Integrity Impact:** High (H)
- **Availability Impact:** High (H)

> **Note:** SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).

**Reason and Prerequisites**

To exploit this security issue, an attacker would need developer privileges to create a Java Server Page or a Java Servlet.

**Solution**

Installing the latest patch resolves this issue.

Alternatively, you can manually replace `jstart71.jar` in `$(DIR_CT_RUN)` and in your instance tree `$(DIR_INSTANCE)/j2ee/cluster` with the attached version. This version introduces an additional check for accessing secure services. You can manage the parser with a new instance profile variable, which is a semicolon-separated list of allowed contexts with the following default:

```
jstartup/service_acl = service:*; library:*; interface:*
```

To disable the checks, set the following:

```
jstartup/service_acl = *
```

If your system behaves unexpectedly after installing the new `jstart71.jar` or the kernel, check the developer traces for the following warning and adjust the instance profile parameter to revert to the old behavior by adding the name of the context to `jstartup/service_acl` or by using the wildcard:

> *** WARNING => Reject call to `<function>` for context: `<Name Of Context>` [`<List Of URL>`]

As a result, a user running programs in an application thread would fail to access protected service methods directly but would still be able to delegate requests to existing services that call these methods.

**Attachments**

- [jstart71.jar](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125800000635432017&iv_version=0004&iv_guid=6CAE8B3E8D4B1ED6BCB967D6048660CF) (170 KB, application/x-zip-compressed)

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018950302017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002427292?language=en-US&token=0E3B6408C037049D07F2FDD00630199E)

**References**

This document is referenced by the following SAP Notes:

- [2637838 - NWA "System Overview" shows grey lights and N/A status - Best Practices for Troubleshooting](https://me.sap.com/notes/2637838)
- [2637279 - /ssl shows multiple identical items in red even though SSL itself is working in AS Java](https://me.sap.com/notes/2637279)
- [2506964 - Log Viewer displays error messages](https://me.sap.com/notes/2506964)
- [2573760 - Offline deployment fails - HTTP status code 401: Unauthorized](https://me.sap.com/notes/2573760)
- [2577844 - AS Java Monitoring and Logging parametrization best practice](https://me.sap.com/notes/2577844)
- [2542492 - SUM not able to restart Java shadow instance because sapcontrol hangs](https://me.sap.com/notes/2542492)

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*