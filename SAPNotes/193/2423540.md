2423540 - URL Redirection Vulnerability in SAP NetWeaver Logon Application

**Symptom**
  
**Updated on 29th March**: This note has been updated. The fix has been down ported to the following SPs. Please refer to [note 2524134](https://me.sap.com/notes/2524134) for more details.

- **J2EE ENGINE APPLICATIONS 7.31**: SP017 & SP018
- **J2EE ENGINE APPLICATIONS 7.40**: SP012 & SP013

The *Logon Application* of AS Java allows an attacker to redirect users to a malicious site due to insufficient URL validation.

**Impacts of the URL Redirection Vulnerability:**
- Phishing attacks to steal credentials of the victim.
- Redirecting users to untrusted webpages that contain malware or similar malicious exploits.

**CVSS Information**

- **CVSS v3 Base Score**: 4.3 / 10
- **Attack Vector**: Network (N)
- **Attack Complexity**: Low (L)
- **Privileges Required**: None (N)
- **User Interaction**: Required (R)
- **Scope**: Unchanged (U)
- **Confidentiality Impact**: Low (L)
- **Integrity Impact**: None (N)
- **Availability Impact**: None (N)

_SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://support.sap.com/securitynotes](https://me.sap.com/securitynotes)._

**Reason and Prerequisites**

Insufficient URL validation in the *Logon Application* of AS Java.

**Solution**

Apply the latest patches relevant to your version of AS Java according to the "SP Patch Level" section of this note.

With the described fix, the URL is validated against some special characters, which are removed from the URL if necessary.

**Support Package Patches**

- [J2EE ENGINE APPLICATIONS 7.20 SP009 Patch 000024](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200013040&support_package=SP009&patch_level=000024)
- [J2EE ENGINE APPLICATIONS 7.50 SP009 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP009&patch_level=000000)
- [J2EE ENGINE APPLICATIONS 7.50 SP008 Patch 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP008&patch_level=000001)
- [J2EE ENGINE APPLICATIONS 7.50 SP007 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP007&patch_level=000003)
- [J2EE ENGINE APPLICATIONS 7.50 SP006 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP006&patch_level=000003)
- [J2EE ENGINE APPLICATIONS 7.40 SP014 Patch 000006](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019677&support_package=SP014&patch_level=000006)
- [J2EE ENGINE APPLICATIONS 7.40 SP015 Patch 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019677&support_package=SP015&patch_level=000002)
- [J2EE ENGINE APPLICATIONS 7.11 SP016 Patch 000004](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006975&support_package=SP016&patch_level=000004)
- [J2EE ENGINE APPLICATIONS 7.30 SP016 Patch 000007](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200014992&support_package=SP016&patch_level=000007)
- [J2EE ENGINE APPLICATIONS 7.31 SP019 Patch 000005](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014361&support_package=SP019&patch_level=000005)
- [J2EE ENGINE APPLICATIONS 7.31 SP020 Patch 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014361&support_package=SP020&patch_level=000002)
- [J2EE ENGINE APPLICATIONS 7.31 SP021 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014361&support_package=SP021&patch_level=000000)

**References**

- [Update 1 to 2423540: URL Redirection Vulnerability in SAP NetWeaver Logon Application](https://me.sap.com/notes/2524134)

For more details, visit the [SAP Security Notes](https://me.sap.com/securitynotes) page.

*Credits to [RedRays.io](https://redrays.io) for supporting the provision of this information.*