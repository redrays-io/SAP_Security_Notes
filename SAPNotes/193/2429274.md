2429274 - Switchable Authorization checks in SAP Enterprise Financial Services

**Description**

**Symptom**

**UPDATE 22nd September 2020**: This note has been re-released with updated ‘Solution’ information. We added the note [2225225](https://me.sap.com/notes/2225225) as the pre-requisite in the correction instruction of this note.

This SAP note describes new switchable authorization checks for RFC function modules in SAP Deposits Management Suite Edition/SAP Deposits Management S/4HANA Edition.

**Other Terms**

Access control, Authorization error, Authorization profile, SACF, RFC

**Reason and Prerequisites**

Remote calls to RFC function modules are by default protected by checks on the authorization object S_RFC. These checks must not be deactivated. See [SAP Note 2216306](https://me.sap.com/notes/2216306) for recommended and deprecated settings of profile parameter auth/rfc_authority_check. Authorizations for S_RFC must be limited to the required minimum authorizations for all users to ensure system security. Many RFC function modules can be sufficiently protected using S_RFC authorization checks. These RFC function modules often do not perform additional functional authorization checks.  Please see white paper "[Securing Remote Function Calls (RFC)](https://www.sap.com/documents/2015/07/e6441a8d-5b7c-0010-82c7-eda71af511fa.html)" which is also attached to [SAP note 2008727](https://me.sap.com/notes/2008727) for further information on RFC Security.

It was identified that S_RFC authorization checks might not be sufficient to ensure secure execution for RFC function modules covered by this note. Activate new switchable authorization checks and update corresponding roles if these RFC function modules are included in S_RFC authorizations in your system.

**Solution**

New switchable authorization checks have been implemented. The checks are delivered inactive to ensure compatibility with your running processes. The checks can be activated in transaction SACF as described in the attached manual correction instruction. See [note 1922808](https://me.sap.com/notes/1922808) for additional information on the switchable authorization check framework (SACF).

**Implementation of the switchable authorization check**

The switchable authorization scenario and the switchable authorization checks are provided via support package. They can be technically pre-implemented via the below correction instructions. After technical implementation via support package or correction instructions, the checks remain inactive until manual activation.

**Activation of the switchable authorization check**

SAP Update Manager (SUM) informs you after system updates to run transaction SACF_COMPARE to activate switchable authorization checks required by your business processes. Follow the manual activities below to individually activate the checks of this SAP Note.

1. **Create the authorization scenario definition in systems where they do not exist yet (transported as workbench objects in your landscape):**
    a) Download the file [BKK_MISC.txt](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125800000722422017&iv_version=0007&iv_guid=6CAE8B3E8D031ED794D1D74EBD5F40CD) attached to this note.
    
    b) Start transaction SACF_TRANSFER.
    
    c) Select the radio button "Upload", select work area "Scenario Definition", deselect work area "Productive Scenarios", deselect "Test Mode", and execute (F8).
    
    d) Choose the file BKK_MISC.txt and confirm the upload.
    
    e) Assign the scenario definition BKK_MISC to the development package FKB.

2. **Activate switchable authorization checks by creating a productive authorization scenario from the scenario definition in transaction SACF.** [SAP note 1922808](https://me.sap.com/notes/1922808) explains in section [4] how to ensure that authorized users have all required authorizations and how to activate the checks.

**Affected RFC Function Modules**
- BKK_RFC_COND_POST_DECRE_BAL_HY
- BKK_RFC_COND_VAL_DECRE_BAL_HY
- BKK_RFC_COND_VAL_DECRE_BAL
- BKK_RFC_COND_POST_DECRE_BAL
- BKK_RFC_COND_CALC_STC
- BKK_RFC_SET_STATE_ISSUED
- BKK_RFC_CHCK_ACCNT

**CVSS Score**

**CVSS v3.0:** 6.3  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L  
- **Attack Vector (AV):** Network (N)  
- **Attack Complexity (AC):** Low (L)  
- **Privileges Required (PR):** Low (L)  
- **User Interaction (UI):** None (N)  
- **Scope (S):** Unchanged (U)  
- **Confidentiality Impact (C):** Low (L)  
- **Integrity Impact (I):** Low (L)  
- **Availability Impact (A):** Low (L)

**Support Packages**

- **S4CORE 101:** [SAPK-10103INS4CORE](https://me.sap.com/supportpackage/SAPK-10103INS4CORE)
- **EA-FINSERV 600:** [SAPKGPFD31](https://me.sap.com/supportpackage/SAPKGPFD31)
- **EA-FINSERV 603:** [SAPK-60320INEAFINSRV](https://me.sap.com/supportpackage/SAPK-60320INEAFINSRV)
- **EA-FINSERV 604:** [SAPK-60421INEAFINSRV](https://me.sap.com/supportpackage/SAPK-60421INEAFINSRV)
- **EA-FINSERV 605:** [SAPK-60518INEAFINSRV](https://me.sap.com/supportpackage/SAPK-60518INEAFINSRV)
- **EA-FINSERV 606:** [SAPK-60620INEAFINSRV](https://me.sap.com/supportpackage/SAPK-60620INEAFINSRV)
- **EA-FINSERV 616:** [SAPK-61612INEAFINSRV](https://me.sap.com/supportpackage/SAPK-61612INEAFINSRV)
- **EA-FINSERV 617:** [SAPK-61715INEAFINSRV](https://me.sap.com/supportpackage/SAPK-61715INEAFINSRV)
- **EA-FINSERV 618:** [SAPK-61807INEAFINSRV](https://me.sap.com/supportpackage/SAPK-61807INEAFINSRV)
- **EA-FINSERV 800:** [SAPK-80005INEAFINSRV](https://me.sap.com/supportpackage/SAPK-80005INEAFINSRV)

**Attachments**

- [BKK_MISC.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125800000722422017&iv_version=0007&iv_guid=6CAE8B3E8D031ED794D1D74EBD5F40CD) (4 KB)

**Side Effects**

This document is causing side effects:
- [2611064: F9A25: E073(1E) 'Account does not exist'](https://me.sap.com/notes/2611064)
- [2584128: Function Module BKK_CASH_AUTHORITY_CHECK_MULT: Syntax Error Method "GET_CHECK_SETTINGS"](#)

**References**

This document is referenced by:
- [2797935: SAP BCA: Error "Cannot extend package FKB" during note implementation](https://me.sap.com/notes/2797935)

**Validity**

Applicable Software Components:
- SAPSCORE 110
- S4CORE 101
- EA-FINSERV 600, 603, 604, 605, 606, 616, 617, 618, 800

**Credits**

Information provided with support from [RedRays.io](https://redrays.io).