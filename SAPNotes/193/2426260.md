SAP Security Note 2426260 - SQL Injection Vulnerability in SAP HANA Extended Application Services

## Description
SAP has released Security Note **2426260**, addressing a SQL Injection vulnerability in SAP HANA Extended Application Services, Classic Model (XS Classic). This vulnerability allows a user to execute crafted database queries through the user profile management interface.

### Symptom
The user profile management feature permits authenticated users to modify their profiles. Due to missing input validation, an attacker can inject SQL commands to update the calling user's profile. These SQL commands are executed with the privileges of the calling user, although privilege escalation is not possible.

### CVSS Information
- **CVSS v3 Base Score:** 2.7 / 10
- **CVSS v3 Vector:**
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** High (H)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** None (N)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

_SAP provides this CVSS score as an estimate of the risk posed by the issue. It does not account for your specific system configuration or operational environment. Conduct your own risk assessments to determine the applicability and priority of this security note._

## Reason and Prerequisites
The vulnerability exists because the user profile management lacks proper input validation, allowing SQL command injection. The precondition for exploitation is that the role `sap.hana.xs.formLogin::ProfileOwner` has been granted to the user.

## Solution
The vulnerability has been fixed in the following revisions:
- **SAP HANA 1.00 SPS 12:** Revision 122.07
- **SAP HANA 2.0 SPS 00:** Revision 001

**Actions to Take:**
- **Update** your SAP HANA systems to these or later versions.
- **Workaround:** Revoke the role `sap.hana.xs.formLogin::ProfileOwner` from users. *Note: This will prevent users from setting user profile parameters directly. Instead, user profile parameters can be set using the SQL console.*

## Affected Software Components
- **HDB 1.00** 
- **HDB 2.00**

## Support Package Patches
- **SAP HANA DATABASE 2.0**
  - **Support Package:** SP001
  - **Patch Level:** 000000
  - [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200005327&support_package=SP001&patch_level=000000)
  
- **SAP HANA DATABASE 1.00**
  - **Support Package:** SP122
  - **Patch Level:** 000007
  - [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP122&patch_level=000007)

## Additional Information
- **Externally Reported:** Yes
- **Category:** Program Error
- **Priority:** Correction with Low Priority
- **Status:** Released for Customer
- **Released On:** 14.03.2017

For more details, visit the [SAP Support Portal](https://me.sap.com/sap/support/sfm/notes/0002426260?language=en-US).

---

*Credits to [Red Rays](https://redrays.io) for supporting the provision of this information.*