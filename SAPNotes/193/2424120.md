2424120 - Information disclosure in SAP HANA cockpit for offline administration

### Symptom

A remotely authenticated user of SAP HANA cockpit for offline administration can access more information than intended from the server with `<sid>adm` credentials.

### CVSS Information

**Base Score:** 4.9 / 10  
**Vector:**  
| Metric                   | Value         |
|--------------------------|---------------|
| Attack Vector (AV)       | Network (N)   |
| Attack Complexity (AC)   | Low (L)       |
| Privileges Required (PR) | High (H)      |
| User Interaction (UI)    | None (N)      |
| Scope (S)                | Unchanged (U) |
| Confidentiality Impact (C)| High (H)      |
| Integrity Impact (I)     | None (N)      |
| Availability Impact (A)  | None (N)      |

### Reason and Prerequisites

The SAP HANA cockpit for offline administration allows access to selected administrative functions of the SAP HANA system. Prerequisite for access is a successful authentication with the operating system user of the SAP HANA system (`<sid>adm` user).

The SAP HANA cockpit allows read access to trace, log, and snapshot files. With a specially crafted request, a user can display the content of other files on the server. Additionally, the communication reset function can be misused to perform a network scan.

### Solution

The viewer functions of the SAP HANA cockpit have been restricted to files in the intended folders, preventing access to other files. The communication reset function is now limited to servers and ports of the SAP HANA system. Error messages have been improved to contain only relevant information.

**Update to:**
- SAP HANA revision 122.07 (SAP HANA 1.00 SPS 12)
- SAP HANA revision 001 (SAP HANA 2.0 SPS 00)

### Additional Recommendations

- Ensure that the `<sid>adm` credentials are only known to database administrators.
- Regularly update your SAP HANA system to the latest revisions.

### Affected Components

- **Component:** SAP HANA Cockpit (HAN-CPT)

### References

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018520832017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002424120?language=en-US&token=C0E9DD59F969E84D778E032573625A43)

Credits: Supported by [Redrays](https://redrays.io).