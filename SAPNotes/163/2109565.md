2109565 - Potential information disclosure relating to IMPORT FROM statement in SAP HANA

## Description

An user or attacker can discover information from files on the HANA server.

**CVSS Information**

- **CVSS Base Score:** 3.5 / 10
- **Attack Vector (AV):** Network (N)
- **Access Complexity (AC):** Medium (M)
- **Authentication (Au):** Single (S)
- **Impact to Confidentiality (C):** Partial (P)
- **Impact to Integrity (I):** None (N)
- **Impact to Availability (A):** None (N)

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/securitynotes/).

### Other Terms

- Information disclosure
- SAP HANA
- IMPORT

### Reason and Prerequisites

Files on the HANA server's file system can be accessed by authenticated users. Users need the `IMPORT` privilege to access files on the file server, which is not granted by default to any user. The access is limited to files which can be read by the `<sid>adm` of the HANA system.

The file system path to access files on the server cannot be further restricted within HANA before revision 85.

## Solution

As of SAP HANA SPS 08 database revision 85, you can manage a restriction for the local and/or shared file accesses using two INI configuration parameters, named CSV import path filter.

### Steps to Implement the Solution

1. **Enable CSV Import Path Filter via HANA Administration Console:**
   - **File:** `indexserver.ini`
   - **Section:** `import_export`
   - **Key:** `enable_csv_import_path_filter`
   - **Value:** `true`
   
   *Note: This configuration is set to 'true' by default starting with HANA SPS 09.*

   This configuration change will immediately affect the `IMPORT FROM` command by reconfiguring it so that `IMPORT FROM` is only accessible to CSV files stored under the specified directory paths. The following three paths are accepted by default without any additional path filter setting:
   - `$DIR_INSTANCE/work`
   - `$DIR_INSTANCE/backup`
   - `$SAP_RETRIEVAL_PATH/trace`

2. **(Optional) Specify Additional File Paths:**
   - **File:** `indexserver.ini`
   - **Section:** `import_export`
   - **Key:** `csv_import_path_filter`
   - **Value:** `<absolute directory path>[;&<absolute directory path>]*`

   You can specify multiple paths separated by a semicolon (`;`) to allow additional directories.

## Attributes

- **Externally Reported:** Yes
- **Planned Release Date:** 2015-01-13

## References

This document is referenced by:

- **2876090:** [Security Restriction on Setting Error Log Option of IMPORT/EXPORT FROM Command](https://me.sap.com/notes/2876090)

## Validity

- **Software Component:** HDB
- **Version:** 1.00

## Support Package Patches

- **Software Component Version:** SAP HANA DATABASE 1.00
- **Support Package:** SP085
- **Patch Level:** 000000
- [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP085&patch_level=000000)

## Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017999572017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002109565?language=en-US&token=D5A173EE8D042A7052E447A6B4B6737B)
- [Share by Email](#)
- [Open in New Window](#)

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*