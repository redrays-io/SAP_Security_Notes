2107562 - Fixing POODLE SSLv3.0 (CVE-2014-3566) Vulnerability in Money Mobiliser Platform

**SAP Note Number:** 2107562  
**Type:** SAP Security Note  
**Version:** 4  
**Recency:** New  
**Language:** English  
**Category:** Consulting  
**Priority:** HotNews  
**Status:** Released for Customer  
**Released On:** 12.12.2014  
**Component:** Business Mobile > mCommerce > Money Mobiliser  

### Description

#### Symptom

You are using client or server components communicating with SAP Money Mobiliser Distribution with the SSLv3 protocol turned on or allowed in your configuration.

As reported in CVE-2014-3566, a so-called man-in-the-middle attack is possible, even if the newer protocol version TLS 1.0 is turned on or configured in addition to SSLv3.

#### Other Terms

Sybase 365 Money Mobiliser Platform, Sybase 365 Reporting Mobiliser, CVE-2014-3566

#### Reason and Prerequisites

The Money Mobiliser Platform consists of 3 components that utilize SSL in a Standard Platform Deployment scenario.  The components utilizing SSL are Apache HTTPD, the internal Tomcat configuration, and the embedded Jetty used by the Mobiliser OSGi container.

To configure the SSL components securely, ensure that your Money Mobiliser platform is fully operational. This ensures that SSL configurations do not disrupt overall platform functionality.

The goal of this note is to disable the SSLv3 protocol across all SSL components.

### Solution

1. **Apache HTTPD Configuration**

   - **File Location:** `/opt/sybase/httpd/conf/mobiliser_httpd_ssl.conf` on the `mob-web-1` server.
   - **Current Configuration:** `SSLProtocol all - SSLv2`
   - **Update:** Change to `SSLProtocol all -SSLv2 -SSLv3`
   
   This change disables both SSLv2 and SSLv3 protocols.

2. **Internal Tomcat Configuration**

   - **File Location:** `/opt/sybase/portal/conf/server.xml` on the `mob-aps-1` server.
   - **Connector Configuration:**  
     ```xml
     <Connector port="8442" ...>
     ```
   - **Update:** Add `sslEnabledProtocols="TLSv1.2,TLSv1.1,TLSv1"` within the `<Connector>` tags.
   
   This whitelist approach ensures only the specified TLS protocols are enabled. Future protocol support (e.g., TLSv1.3) requires manual updates.

3. **Embedded Jetty Configuration**

   - **File Location:** `/opt/sybase/money/conf/jetty.xml` on the `mob-aps-1` server.
   - **Element to Modify:**  
     ```xml
     <New id="sslContextFactory" class="org.eclipse.jetty.util.ssl.SslContextFactory">
     ```
   - **Add:**  
     ```xml
     <Set name="ExcludeProtocols">
       <Array type="java.lang.String">
         <Item>SSLv2</Item>
         <Item>SSLv3</Item>
       </Array>
     </Set>
     ```
   
   This disables SSLv2 and SSLv3 protocols for the embedded Jetty component.

4. **Restart Components**

   After updating configurations, restart all Money Mobiliser Platform components to apply changes.

5. **Testing**

   Run an SSL scan against the following ports to verify configurations:
   - **mob-web-1:** Port 443
   - **mob-aps-1:** Ports 8442/8443

**Download for SNOTE:** [Download](https://notesdownloads.sap.com/note/0040000018104392017)

**PDF Version:** [PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002107562?language=en-US&token=349A41424E87E19723CF7884AD05D9A4)

For more details or to access translations, visit [SAP Support Portal](https://me.sap.com/notes/0002107562).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*