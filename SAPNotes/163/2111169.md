2111169 - Security Vulnerabilities in ClickSoftware Applications

**SAP Security Note 2111169**

*Type:* SAP Security Note  
*Category:* Program error  
*Priority:* Correction with high priority  
*Status:* Released for Customer  
*Released On:* 13.01.2015  
*Component:* Miscellaneous > Partner solutions > Clicksoftware Technologies > SAP Workforce Scheduling and Optimization by ClickSoftware

### Symptom

Multiple security vulnerabilities have been identified in ClickSoftware applications, including:

- **Insecure file upload vulnerability in ClickMobile**
- **Privilege escalation and unauthorized access vulnerabilities in ClickMobile**
- **Privilege escalation and unauthorized access vulnerabilities in ClickSchedule web service**
- **ClickSchedule web service allows users to spoof request owner identity**

### Reason and Prerequisites

Detailed explanations for each vulnerability are provided below.

#### Insecure file upload vulnerability in ClickMobile

ClickMobile currently verifies the file extension, size, and quantity on the client side. However, after passing client-side validation, there is no control over the insertion of files into the MiddleTier DB, allowing the upload of insecure files.

#### Privilege escalation and unauthorized access vulnerabilities in ClickMobile

The ClickMobile web service lacks proper access control after the initial NTLM authentication. This omission allows mobile users to impersonate other users using only their usernames, without requiring their passwords.

#### Privilege escalation and unauthorized access vulnerabilities in ClickSchedule web service

Similarly, the ClickSchedule web service does not enforce access control post-NTLM authentication, enabling both vertical and horizontal privilege escalation.

#### ClickSchedule web service allows users to spoof request owner identity

The ClickSchedule web service accepts XML-based requests for certain scheduling actions without adequate validation. This vulnerability allows authenticated users to spoof the caller identity, potentially facilitating phishing attacks, unauthorized access, or privilege escalation.

### Solution

Follow the corrective steps outlined below to mitigate these vulnerabilities:

#### Insecure file upload vulnerability in ClickMobile

1. **Install the Security Enhancement:**
   - Download and install the **8.1.10 P2 Security Enhancement MSI** on the ClickMobile MiddleTier server.

2. **Update Configuration:**
   - Open the `Web.Config` file on the MiddleTier IIS.
   - Under the `appSettings` section, add the following keys:
     ```xml
     <add key="FileUploadPreprocessorDLLPath" value="FileUploadCheck.dll"/>
     <add key="FileUploadPreprocessorProgID" value="FileUploadCheck.Preload"/>
     ```
     - *Note:* Ensure that `FileUploadCheck.dll` is located in the `bin` folder of the ClickMobileWeb site.

3. **Restart IIS:**
   - Save the `Web.Config` file.
   - Restart the IIS process (`W3WP`).

#### Privilege escalation and unauthorized access vulnerabilities in ClickMobile

1. **Install the Security Enhancement:**
   - Download and install the **8.1.10 P2 Security Enhancement MSI** on the ClickMobile MiddleTier server.

2. **Update Configuration:**
   - Open the `Web.Config` file on the MiddleTier IIS.
   - Under the `appSettings` section, add the following key:
     ```xml
     <add key="ValidateUserInRequests" value="true"/>
     ```

3. **Restart IIS:**
   - Save the `Web.Config` file.
   - Restart the IIS process (`W3WP`).

#### Privilege escalation and unauthorized access vulnerabilities in ClickSchedule web service

1. **Install the Security Enhancement:**
   - Download and install the **8.2 Patch002 Security Enhancement MSI**.

#### ClickSchedule web service allows users to spoof request owner identity

1. **Install the Security Enhancement:**
   - Download and install the **8.2 Patch002 Security Enhancement MSI**.

### Additional Resources

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018002382017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002111169?language=en-US&token=E99356C5E421A13B69258E653C98F445)
- [View on SAP Notes](https://me.sap.com/notes/0002111169)

---

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*