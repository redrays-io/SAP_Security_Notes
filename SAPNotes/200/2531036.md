2531036 - Switchable Authorization checks for RFC BCA_DIM_RESET_TRIGGER_TABLE in Loans (FI-CAX-FS)

## Symptom
S_RFC authorization checks are not sufficient to ensure secure execution of RFC function modules covered by this SAP Note. New switchable authorization checks have been implemented for RFC function modules in FI-CAX-FS.

## Reason and Prerequisites
Remote calls to RFC function modules are by default protected by checks on the authorization object S_RFC. These checks must not be deactivated. See [SAP Note 2216306](https://me.sap.com/notes/2216306) for recommended and deprecated settings of profile parameter `auth/rfc_authority_check`. Authorization for S_RFC must be limited to the required minimum authorizations for all users to ensure system security. Many RFC function modules can be sufficiently protected using S_RFC authorization checks. These RFC function modules often do not perform additional functional authorization checks. Please see the white paper “[Securing Remote Function Calls (RFC)](https://www.sap.com/documents/2015/07/e6441a8d-5b7c-0010-82c7-eda71af511fa.html)” which is also attached to [SAP Note 2008727](https://me.sap.com/notes/2008727) for further information on RFC Security.

It was identified that S_RFC authorization checks are not sufficient to ensure secure execution of RFC function modules covered by this SAP Note. Activate new switchable authorization checks and update corresponding roles if these RFC function modules are included in S_RFC authorizations in your system.

## Solution
New switchable authorization checks have been implemented. The checks are delivered inactive to ensure compatibility with your running processes. The checks can be activated in transaction `SACF` as described in the attached manual correction instructions. See [SAP Note 1922808](https://me.sap.com/notes/1922808) for additional information on the switchable authorization check framework (SACF).

**New authorization scenario**

The following new authorization scenario can be maintained in transaction `SACF` after implementation of this SAP Note.

**Scenario:**  
`FS_TB_RESET_TRIGG` - Reset Trigger table  
Wrapper RFC for reset trigger table.

**Affected business processes and roles**
The following RFC is in application area ‘S’ (Extended FI-CA or non-industry specific FI-CA) to reset trigger tables:
- `BCA_DIM_RESET_TRIGGER_TABLE` - *Reset Trigger Table*

The activation of this scenario enables authorization checks to be carried out in this RFC.

**Affected RFC function modules**
This function module `BCA_DIM_RESET_TRIGGER_TABLE` checks the following authorizations:
- Authorization object `F_KKKO_BUK`
  - Parameter 1: `BEGRU` – Authorization group from the associated contract account
  - Parameter 2: `ACTVT` – Activity = **03 (Display)**
- Authorization object `F_KKVK_VKT`
  - Parameter 1: `VKTYP_KK` – Contract Account Category
  - Parameter 2: `ACTVT` – Activity = **03 (Display)**
- Authorization object `F_KKVK_BEG`
  - Parameter 1: `ACTVT` – Activity = **03 (Display)**
  - Parameter 2: `BUKRS` – Company Code
- Authorization object `F_KKKO_GSB`
  - Parameter 1: `ACTVT` – Activity = **03 (Display)**
  - Parameter 2: `BUKRS` – Company Code

## Implementation of the Switchable Authorization Check
The switchable authorization scenario and the switchable authorization checks are provided via support package. They can be technically pre-implemented via the following correction instructions. After technical implementation via support package or correction instructions, the checks remain inactive until manual activation.

**Activation Steps:**

1. **Create the authorization scenario definition** in systems where they do not exist yet (transported as workbench objects in your landscape):
   - Start transaction `SACF` in the development system and check if scenario definition `FS_TB_RESET_TRIGG` exists. If it exists, go to step 2.
   - If the scenario definition does not exist in `SACF`, download the file `FS_TB_RESET_TRIGG.txt` attached to this note.
   - Start transaction `SACF_TRANSFER`.
   - Select radio button "Upload", select work area "Scenario Definition", deselect work area "Productive Scenarios", deselect "Test Mode", and execute (F8).
   - Choose the file `FS_TB_RESET_TRIGG.txt` and confirm upload.
   - Assign the scenario definition `FS_TB_RESET_TRIGG` to development package `FSCR_TRBK`.

2. **Individual activation of switchable authorization checks** is done by creating productive authorization scenarios from scenario definitions in transaction `SACF`. [SAP Note 1922808](https://me.sap.com/notes/1922808) explains in section [4] how to ensure that authorized users have all required authorizations and how to activate the checks. Collective maintenance of authorization scenarios is done after system updates using transaction `SACF_COMPARE`.

## Support Packages
Ensure that the following support packages are applied to maintain system compatibility:

- FI-CAX 605: [SAPK-60517INFICAX](https://me.sap.com/supportpackage/SAPK-60517INFICAX)
- FI-CAX 606: [SAPK-60620INFICAX](https://me.sap.com/supportpackage/SAPK-60620INFICAX)
- FI-CAX 616: [SAPK-61612INFICAX](https://me.sap.com/supportpackage/SAPK-61612INFICAX)
- FI-CAX 617: [SAPK-61715INFICAX](https://me.sap.com/supportpackage/SAPK-61715INFICAX)
- FI-CAX 618: [SAPK-61809INFICAX](https://me.sap.com/supportpackage/SAPK-61809INFICAX)
- FI-CAX 800: [SAPK-80006INFICAX](https://me.sap.com/supportpackage/SAPK-80006INFICAX)
- FI-CAX 801: [SAPK-80104INFICAX](https://me.sap.com/supportpackage/SAPK-80104INFICAX)
- FI-CAX 802: [SAPK-80201INFICAX](https://me.sap.com/supportpackage/SAPK-80201INFICAX)

## CVSS
**CVSS Score:** 6.3  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L)

## Credits
Credits to [https://redrays.io](https://redrays.io) for support to provided information.