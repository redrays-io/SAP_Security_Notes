SAP Security Note 2528799: Implementing Switchable Authorization Checks for RFC in SRM

**Overview**
SAP Security Note **2528799** addresses insufficient authorization checks for RFC function modules in Supplier Relationship Management (SRM). It introduces new switchable authorization checks to enhance system security by ensuring proper authorization during remote function calls.

**Symptom**
Remote calls to RFC function modules in SRM were found to have inadequate authorization checks using the `S_RFC` authorization object. This vulnerability could allow unauthorized execution of RFC function modules, potentially compromising system security.

**Reason and Prerequisites**
The default `S_RFC` authorization checks were not sufficient for securing the execution of certain RFC function modules within SRM. To mitigate this, new switchable authorization checks are necessary. Before applying this note, ensure that the following prerequisite notes are implemented:

- [1995667 - SACF: Navigation error](https://me.sap.com/notes/1995667)
- [1882417 - External check for Remote Function Call](https://me.sap.com/notes/1882417)
- [1988903 - Check whether a function modules was called via external RFC](https://me.sap.com/notes/1988903)
- [2008372 - SU22: Error uploading default values](https://me.sap.com/notes/2008372)
- [2449051 - SACF | Documentation of scenarios](https://me.sap.com/notes/2449051)

**Solution**
The note implements new switchable authorization checks delivered inactive to maintain compatibility. These can be activated manually via transaction **SACF**. The key steps include:

1. **Upload Scenario Definitions:**
   - Use transaction `SACF_TRANSFER` to upload scenario definitions from the attached `.TXT` files.

2. **Activate Authorization Scenarios:**
   - In transaction `SACF`, transfer scenario definitions to productive scenarios and set their status to "Active" or "Logging".
   - "Active" status enables the authorization checks and logs them to the Security Audit Log.
   - "Logging" status logs the checks without enforcing them, allowing identification of required authorizations.

3. **Adjust User Roles:**
   - Update user roles to include the necessary authorizations based on the new scenarios.

4. **Activate Security Audit Logging (Optional):**
   - Ensure Security Audit Log is active in transaction `SM19`.
   - Activate relevant message IDs (`DUO`, `DUP`, `DUQ`) for detailed logging.

**Affected Business Processes and RFC Function Modules**
The implementation affects various business processes and roles that utilize the following RFC function modules:

- **Contract Management:**
  - `BBPV_CONTRACT_CREATE`
  - `BBPV_CONTRACT_TRANSFER`
  - `BBPV_CONTRACT_STATUS_GET`
  - `BBP_CTR_UPL_CONTRACT_DATA_GET`

- **Invoice Management:**
  - `BBP_ASSIGN_ITEMS_INVOICE_4X`
  - `BBP_INVOICE_READ`
  - `BBP_INVOICE_SIMULATE`

- **Material Management:**
  - `BBP_MATERIAL_READ`

- **Purchase Requisition:**
  - `BBP_RFC_CON_GETATTACH`
  - `BBP_SOURCEDETERMIN_GETSOS`
  - `BBP_SOURCEDETER_GETSOS_MULTI`
  - `BBP_REQUISITION_GETDETAIL`
  - `BBP_PREQ_FULFILLMENT`
  - `BBP_INTERPRETE_DATA`

- **Reservation Management:**
  - `BBP_RESERVATION_DELETE`
  - `BBP_RESERVATION_CREATE`

- **Vendor Management:**
  - `BBP_SCAN_VD`

- **Financial Document Display:**
  - `BBP_CALCULATE_TAX_ITEM46B`
  - `BBP_WT_GET_INFORMATION`
  - `BBP_BUDGET_READ_47A`

**Implementation Steps**
Detailed instructions are provided in the attached `.TXT` files. Key steps include:

1. **Uploading Scenario Definitions:**
   - Download and upload the relevant `.TXT` files (`BBP_CONTRACT.TXT`, `BBP_INVOICE.TXT`, etc.) using transaction `SACF_TRANSFER`.

2. **Creating Productive Scenarios:**
   - Transfer scenario definitions to productive scenarios in `SACF`.
   - Choose appropriate statuses ("Active" or "Logging") based on your security requirements.

3. **Role Adjustments:**
   - Modify user roles to incorporate the new authorization objects introduced by the scenarios.

4. **Uploading Authorization Default Values:**
   - Use transaction `SU22` to upload authorization default values from the provided `SU22DATA` files.

**CVSS Summary**
- **Score:** 6.3
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** Low
  - **User Interaction:** None
  - **Scope:** Unchanged
  - **Confidentiality Impact:** Low
  - **Integrity Impact:** Low
  - **Availability Impact:** Low

**Attachments**
- [BBP_CONTRACT.TXT](https://me.sap.com/notes/2528799/BBP_CONTRACT.TXT)
- [BBP_INVOICE.TXT](https://me.sap.com/notes/2528799/BBP_INVOICE.TXT)
- [BBP_MATERIAL.TXT](https://me.sap.com/notes/2528799/BBP_MATERIAL.TXT)
- [BBP_PUR_REQ.TXT](https://me.sap.com/notes/2528799/BBP_PUR_REQ.TXT)
- [BBP_RESERVATION.TXT](https://me.sap.com/notes/2528799/BBP_RESERVATION.TXT)
- [SU22DATA_604-600.TXT](https://me.sap.com/notes/2528799/SU22DATA_604-600.TXT)
- [SU22DATA_618-605.TXT](https://me.sap.com/notes/2528799/SU22DATA_618-605.TXT)

**References**
- [SAP Note 2777772 - Shopping cart transfer issue](https://me.sap.com/notes/2777772)
- [SAP Note 2622718 - SRM calls to back-end ECC system don't return requested data](https://me.sap.com/notes/2622718)

_For more detailed information, visit [SAP Support](https://me.sap.com/)._

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*