2531241 - Information Disclosure in LVM 2.1 and LaMa 3.0

**Symptom**

**UPDATE 14th November 2017**: This note has been re-released with updated CVSS Information and Priority.

Under certain conditions, *LVM 2.1* and *LaMa 3.0* allow an attacker with LaMa J2EE Database administrator rights to read passwords or confidential management information of managed systems. The information disclosed includes:

1. Secure parameters transferred to Custom Hooks for HANA Live Cycle Management Operations starting with the prefix `hdblcm*`.
2. Secure parameters transferred to Custom Hooks for Software Provisioning Manager Operations starting with the prefix `SAPINST_*`.

This may give an attacker the chance to connect to instances installed/modified by HANA Live Cycle Manager and/or Software Provisioning Manager since administrative passwords are part of the secure parameters.

The information is stored without encryption in the LVM/LaMa database.

*Note: Check Reasons and Prerequisites to see if the impact is relevant to your LaMa Usage Scenario.*

**CVSS Information**

- **CVSS v3 Base Score**: 9.1 / 10
- **CVSS v3 Base Vector**:
  
  | Metric                        | Value          |
  |-------------------------------|----------------|
  | Attack Vector (AV)            | Network (N)    |
  | Attack Complexity (AC)        | Low (L)        |
  | Privileges Required (PR)      | High (H)       |
  | User Interaction (UI)         | None (N)       |
  | Scope (S)                     | Changed (C)    |
  | Confidentiality Impact (C)    | High (H)       |
  | Integrity Impact (I)          | High (H)       |
  | Availability Impact (A)       | High (H)       |

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).

**Solution**

Install the referenced patch and follow the manual correction instructions.

*Note: Passwords and secure parameters might still be stored in other locations if copied before this note has been applied, such as database backups and database logs.*

SAP Landscape Management patches always only the latest Support Package. When a newer Support Package is released, the newer Support Package is recommended and should be used as the patch for older Support Packages.

**Manual Activities**

**Caution**: You have to perform this manual activity separately in each system into which you transport the Note for implementation.

Depending on your mitigation goals, you may execute all or a subset of the below-described activities. If you plan to execute the activities of Goal 2, ensure to do this before executing the steps of Goal 3.

**Goal 1: Avoid future persistence of passwords in plain text within the LVM J2EE database.**  
*Note: This does not remove existing plaintext passwords in the database.*

- Install the referenced patch.

**Goal 2: Avoid potential malicious access to involved systems where custom hooks/operations have been used.**  
*Note: The following activities show only systems for activities/logs that exist in the monitoring (c.f., Setup → Engine → Timer Settings).*

1. Navigate to Automation Studio → Design → Custom Operations Hooks and Notifications.
2. Create a list of all names where the hook type is related to either Software Provisioning Manager or HANA Live Cycle Manager.
3. Navigate to Monitoring/Logs and search for the respective names from point 2 in the action column.
4. Navigate for each finding via the link to the respective activity.
5. Note the involved systems displayed in the Activities → Systems Involved table for each provisioning operation.
6. Change the administrative passwords of the systems and their related databases. Passwords include database schema, database Administrator (source and target), and SAP `<sid>adm` users.

**Goal 3: Mitigate the existence of plaintext secure parameters in the LaMa J2EE database.**  
*Consider executing the steps of Goal 2 before following these instructions.*

1. Navigate to Automation Studio → Design → Custom Operations Hooks and Notifications.
2. Create a list of all hook names where the hook type is related to either Software Provisioning Manager or HANA Life Cycle Management.
3. Note that the following steps will remove activities from your monitoring/activities view, including the respective database entries. Entries in Monitoring/Logs will not be deleted.
4. Navigate to Monitoring/Logs and search for the respective names from point 2 in the action column.
5. Navigate for each finding via the link to the respective activity and delete it.

For more details and to download the necessary patches, visit the [SAP Support Portal](https://me.sap.com/notes/0002531241).

**References**

- [SAP Landscape Management 3.0 SP04 Patch01](https://me.sap.com/notes/2519232)
- [SAP Landscape Virtualization Management 2.1 SP10 Patch01](https://me.sap.com/notes/2502964)
- [SAP Landscape Management - Collective Security Note](https://me.sap.com/notes/2910170)

**Credits**

Supported by [RedRays.io](https://redrays.io) for providing the information.