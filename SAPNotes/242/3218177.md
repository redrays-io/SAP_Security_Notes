SAP Security Note 3218177 - CVE-2022-35294: Stored XSS Vulnerability in SAP NetWeaver Application Server ABAP

**Symptom**

An attacker with basic business user privileges could craft and upload a malicious file to SAP NetWeaver Application Server ABAP, which is then downloaded and viewed by other users resulting in a stored Cross-Site-Scripting attack. This could lead to information disclosure including stealing authentication information and impersonating the affected user.

**Other Terms**

XSS, stored XSS, xml, execute, [CVE-2022-35294](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35294)

**Reason and Prerequisites**

A user has to upload a malicious xml file with active content.

**Solution**

- This issue is fixed in the patches listed in the â€œSupport Packages & Patches" section below.
- The server adds the response header "Content-Security-Policy: sandbox" to the response of files requested from the server.
- The file is downloaded instead of opened in other cases.

**Workaround**

Please assess the workaround applicability for your SAP landscape prior to implementation. Note that this workaround is a temporary fix and is not a permanent solution. SAP strongly recommends you apply the corrections outlined in this security note, which can be done in lieu of the workaround or after the workaround is implemented.

- *Use note [2305615](https://me.sap.com/notes/2305615) together with service parameter ~webgui_updown_extension_denied to prevent xml files from opening.*

**CVSS**

**CVSS Score**: 5.4

**CVSS Vector**: `CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N`

| Key                      | Value               |
|--------------------------|---------------------|
| Attack Vector (AV)       | Network (N)         |
| Attack Complexity (AC)   | Low (L)             |
| Privileges Required (PR) | Low (L)             |
| User Interaction (UI)    | Required (R)        |
| Scope (S)                | Changed (C)         |
| Confidentiality Impact (C)| Low (L)             |
| Integrity Impact (I)     | Low (L)             |
| Availability Impact (A)  | None (N)            |

**Support Package Patches**

- [SAP KERNEL 7.54 64-BIT SP012 Patch 000012](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019167&V=MAINT)
- [SAP KERNEL 7.54 64-BIT UNICODE SP012 Patch 000012](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019168&V=MAINT)
- [SAP KERNEL 7.89 64-BIT UNICODE SP007 Patch 000007](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200015809&V=MAINT)
- [SAP KERNEL 7.22_EX2 64-BIT SP1210 Patch 001210](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010235&V=MAINT)
- [SAP KERNEL 7.22_EX2 64-BIT UC SP1210 Patch 001210](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010236&V=MAINT)
- [SAP KERNEL 7.22 64-BIT SP1210 Patch 001210](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001793&V=MAINT)
- [SAP KERNEL 7.22 64-BIT UNICODE SP1210 Patch 001210](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001794&V=MAINT)
- [SAP KERNEL 7.22 EXT 64-BIT SP1210 Patch 001210](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001797&V=MAINT)
- [SAP KERNEL 7.22 EXT 64-BIT UC SP1210 Patch 001210](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001798&V=MAINT)
- [SAP KERNEL 7.85 64-BIT UNICODE SP128 Patch 000128](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200013971&V=MAINT)
- [SAP KERNEL 7.77 64-BIT UNICODE SP500 Patch 000500](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010526&V=MAINT)
- [SAP KERNEL 7.49 64-BIT UNICODE SP1116 Patch 001116](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004760&V=MAINT)
- [SAP KERNEL 7.49 64-BIT SP1116 Patch 001116](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004791&V=MAINT)
- [SAP KERNEL 7.53 64-BIT UNICODE SP1024 Patch 001024](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200005858&V=MAINT)
- [SAP KERNEL 7.53 64-BIT SP1024 Patch 001024](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200006207&V=MAINT)
- [SAP KERNEL 7.81 64-BIT UNICODE SP254 Patch 000254](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200012830&V=MAINT)

_Credits to [RedRays](https://redrays.io) for support in providing this information._