3229820 - [CVE-2022-39799] Cross-Site Scripting (XSS) vulnerability in SAP NetWeaver AS ABAP (SAP GUI for HTML within the Fiori Launchpad)

## Symptom

An attacker with no prior authentication could craft and send a malicious script to SAP GUI for HTML within the Fiori Launchpad, resulting in a reflected cross-site scripting (XSS) attack. This vulnerability could lead to the theft of session information and allow the attacker to impersonate the affected user.

## Other Terms

- XSS, reflected XSS
- SAP GUI for HTML, webGUI
- Fiori Launchpad (FLP)
- CVE-2022-39799

## Solution

This issue is fixed in the patches listed in the **Support Packages & Patches** section below. The affected parameter is now properly encoded to prevent exploitation.

## Affected Components

- **Component**: Basis Components > Frontend Services (SAP Note 1322184) > SAP GUI for HTML
- **Software Components**: KERNEL versions 7.54, 7.77, 7.81, 7.85, 7.89

## Support Package Patches

- **SAP KERNEL 7.89 64-BIT UNICODE**
  - **Support Package**: SP012
  - **Patch Level**: 000012
  - [Download Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200015809&V=MAINT)
  
- **SAP KERNEL 7.54 64-BIT**
  - **Support Package**: SP012
  - **Patch Level**: 000012
  - [Download Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019167&V=MAINT)
  
- **SAP KERNEL 7.54 64-BIT UNICODE**
  - **Support Package**: SP012
  - **Patch Level**: 000012
  - [Download Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019168&V=MAINT)
  
- **SAP KERNEL 7.81 64-BIT UNICODE**
  - **Support Package**: SP310
  - **Patch Level**: 000310
  - [Download Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200012830&V=MAINT)
  
- **SAP KERNEL 7.85 64-BIT UNICODE**
  - **Support Package**: SP200
  - **Patch Level**: 000200
  - [Download Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200013971&V=MAINT)
  
- **SAP KERNEL 7.77 64-BIT UNICODE**
  - **Support Package**: SP512
  - **Patch Level**: 000512
  - [Download Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010526&V=MAINT)

## CVSS

- **Score**: 6.1
- **Vector**: `CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N`

### CVSS Metrics

- **Attack Vector (AV)**: Network (N)
- **Attack Complexity (AC)**: Low (L)
- **Privileges Required (PR)**: None (N)
- **User Interaction (UI)**: Required (R)
- **Scope (S)**: Changed (C)
- **Confidentiality Impact (C)**: Low (L)
- **Integrity Impact (I)**: Low (L)
- **Availability Impact (A)**: None (N)

## Additional Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001203682022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003229820?language=en-US&token=2B96DE0B2DD2415DAC19407949A35804)
- [Edit Note](https://i7p.wdf.sap.corp/sap/support/notes/edit/0003229820)

---

*Credits to [Redrays](https://redrays.io) for support in providing this information.*