3213826 - [CVE-2022-31597] Missing Authorization check in SAP S/4HANA (business partner extension for Spain/Slovakia)

---

**SAP Security Note 3213826 - [CVE-2022-31597]**

**Description:**

**Symptom**

Within SAP S/4HANA, the business partner extension for Spain/Slovakia does not perform necessary authorization checks for a low-privileged authenticated user over the network, resulting in escalation of privileges leading to low impact on confidentiality and integrity of the data.

**Other Terms**

Information Exposure, Information Leak, Access Control, Authorization Error, business partner extension Slovakia/Spain, [CVE-2022-31597](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31597)

**Reason and Prerequisites**

No check was performed during the authorization of the user.

**Solution**

The affected functions have now been enforced to properly check access restrictions.

Import the Support Package specified for your release or implement the attached (manual) correction instruction.

As a general rule, SAP recommends that you implement the Support Package specified for your release. However, if you need to install a solution earlier, use the [SAP Note Assistant](https://me.sap.com/supportpackage/SAPK-XXXXXXX) to implement the correction instruction. You can find more information about the SAP Note Assistant in the [SAP Support Portal](https://support.sap.com/en/my-support/knowledge-base/note-assistant.html).

To implement the solution, you must carry out manual activities and implement the correction instructions that are valid for your release.

**CVSS Details:**

- **Score:** 5.4
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N

  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

**Actions:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000898342022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003213826?language=en-US&token=33845DBA39929E62BEC2F6A314C260B9)

**Supported Software Components:**

- **SAPSCORE:** 127
- **S4CORE:** Versions 101 to 106

**Support Packages:**

- [SAPK-10211INS4CORE](https://me.sap.com/supportpackage/SAPK-10211INS4CORE)
- [SAPK-10309INS4CORE](https://me.sap.com/supportpackage/SAPK-10309INS4CORE)
- [SAPK-10407INS4CORE](https://me.sap.com/supportpackage/SAPK-10407INS4CORE)
- [SAPK-10505INS4CORE](https://me.sap.com/supportpackage/SAPK-10505INS4CORE)
- [SAPK-10603INS4CORE](https://me.sap.com/supportpackage/SAPK-10603INS4CORE)
- [SAPK-12712INSAPSCORE](https://me.sap.com/supportpackage/SAPK-12712INSAPSCORE)

**Credits:**

Thanks to [Redrays.io](https://redrays.io) for support to provided information.