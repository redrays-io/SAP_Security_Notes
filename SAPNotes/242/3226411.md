3226411 - [CVE-2022-35291] Privilege escalation vulnerability in SAP SuccessFactors attachment API for Mobile Application(Android & iOS)

## Symptom

**UPDATE 25th October 2022**: The attachments in the SF Mobile application have resumed for Benefit Claims with the October 2022 release (version 8.1.3). Please have your organization download the latest version of the SAP SuccessFactors iOS and Android mobile application (version 8.1.3) to re-enable this feature.

**UPDATE 13th September 2022**: The attachments in the SF Mobile application have resumed for Time Off, Timesheet, and EC Workflow with the August’22 release (version 8.0.6). Resumption of attachments for Benefit Claims in the SuccessFactors Mobile app is being planned for a subsequent release. You may reach out to your CSM/CEE with the reference ticket number “MOB-61645” to track the progress of the enhancement.

Due to misconfigured application endpoints, SAP SuccessFactors attachment APIs allow an attacker with user privileges to perform activities with admin privileges over the network. These APIs were consumed in the SF Mobile application for Time Off, Time Sheet, EC Workflow, and Benefits. On successful exploitation, the attacker can read/write attachments, compromising the confidentiality and integrity of the application.

## Other Terms

Elevated Privileges, SF Mobile App, SuccessFactors Mobile Application, [CVE-2022-35291](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35291)

## Reason and Prerequisites

Customers using attachments in Time Off, Time Sheet, EC Workflow, and Benefits modules of the SAP SF Mobile Application are impacted.

## Solution

Several measures have been taken to resolve the identified vulnerability in the most recent software update. This vulnerability impacts users who are using the iOS and Android mobile application versions released prior to V8.0.5. For this reason, the SAP SuccessFactors mobile team is releasing an immediate fix to stop the ability to download, upload, or preview attachments from the impacted SAP SF Mobile modules at this time.

**Action required:**

1. **Revoke the following permissions for non-admin users:**
    - Admin Center > Manage Permission Roles > Manage Integration Tools > OData API Attachment Export.
    - Admin Center > Manage Permission Roles > Manage Integration Tools > OData API Attachment Import.
2. Download the latest version of the SAP SuccessFactors iOS and Android mobile application (V8.0.5) to ensure your organization is not at risk of any threats from this vulnerability. There will be no service interruption.
3. Internally communicate to employees about removing attachment functionality in the SF Mobile Application.

As an alternative to using the attachment functionality, please use the [Web UI for Time Off, Time Sheet, EC Workflow, and Benefits](https://me.sap.com/).

## CVSS Details

- **CVSS Score:** 8.1
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N)

## References

- [SAP Support Notes](https://me.sap.com/notes/3226411)

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*