1341333 - Potential info. disclosure and code execution in sapdbctrl

## Description

### Symptom

An attacker can discover information relating to passwords being used by `sapdbctrl`. This information could be used to allow the attacker to specialize their attacks against passwords and `sapdbctrl`.

In addition, an attacker is enabled to inject code into the working memory that is subsequently executed by the application. An attacker can therefore control the behavior of the system, or can potentially escalate privileges by executing malicious code, without having their own legitimate credentials.

**CVSS Information**

- **CVSS Base Score:** 5.0
- **CVSS Base Vector:** AV:N/AC:L/AU:N/C:P/I:N/A:N

_SAP provides this CVSS Base Score as an estimate of the risk posed by the issue reported in this SAP Note. However, this estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note.Â For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/)._

### Other Terms

Information disclosure, credentials, execution of code, injection, `sapdbctrl`

### Reason and Prerequisites

Information such as user passwords can be discovered using `sapdbctrl`. This information may be used by an attacker to further target `sapdbctrl`.

The program code contains a possibility to define and execute user-defined code that changes the behavior of the system. A valid and authenticated user is not required. Depending on the code, the user can:

- Inject and run their own code
- Obtain additional information that should not be displayed
- Modify data, delete data
- Modify the output of the system
- Create new users with higher privileges
- Perform a denial-of-service attack

### Solution

Apply the latest SAPHOSTagent patch with at least the patch level specified on [SAP Service Marketplace](https://me.sap.com/).

This SAP Note was published originally as a functional SAP Note. If you have already implemented this SAP Note, you do not have to do anything else.

**Download Links:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016793292017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001341333?language=en-US&token=152C21C0C735953E137D204437873BBF)

## Credits

Thanks to [Redrays](https://redrays.io) for supporting and providing the information.