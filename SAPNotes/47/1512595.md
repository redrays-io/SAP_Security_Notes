1512595 - Unauthorized usage of application functionality in LSOCP

**Symptom**

An unauthorized user can trigger functionality in LSOCP on behalf of an unsuspecting authorized user.

**Other Terms**

1. Cross-Site Request Forgery,
2. CSRF
3. XSRF
4. LSO Content Player
5. LSOCP

**Reason and Prerequisites**

LSOCP (which contains Servlets/JSP pages) executes state-changing functionality via referencing URLs. In certain scenarios, it is possible for an unauthorized and unauthenticated third party to trigger this functionality on behalf of an authorized authenticated user without the latter's knowledge and/or consent.

**Solution**

XSRF attacks must be addressed within web applications. These applications must ensure that for state-changing operations they are not relying solely on credentials or tokens that are automatically submitted by browsers. A common approach is including a special token in each request, which is associated with the user session and is valid only for the session's lifetime.

The SAP NetWeaver Application Server Java (AS Java) has been enhanced with the XSRF Protection Framework. You can secure your web application with the token-based approach by adopting the framework. This note contains the adoption of the XSRF Protection Framework for LSOCP.

SAP's XSRF Protection Framework is available for specific versions of SAP NetWeaver. Please refer to [Note 1450166](https://me.sap.com/notes/1450166) for details regarding availability. To enable XSRF protection for LSOCP, please apply the above-mentioned Note prior to undertaking the steps highlighted in this Note. Furthermore, please refer to the [SAP XSRF Protection Guide](https://me.sap.com/notes/1450166) which is detailed in Note 1450166 to gain an overall understanding of the XSRF protection procedure.

Once you have reviewed the above-mentioned document, please proceed by following the detailed outlined steps specific to LSOCP.

**HOW TO ADAPT LSOCP IN A STANDARD SCENARIO**

1. XSRF protection for LSOCP uses the custom XSRF protection approach (please refer to the protection guide for details).
2. Please apply the below SPs of relevant LSOCP on SAP J2EE Web AS for the XSRF-protected version of LSOCP:
   - SP9 of LSOCP604
   - SP9 of LSOCP602
   - SP19 of LSOCP600
   - SP22 of LSOCP300
   - SP34 of LSOCP200

**References**

- [Note 1450166 - Unauthorized usage of application functionality](https://me.sap.com/notes/1450166)

For more details, visit [SAP Support](https://me.sap.com/notes/0001512595).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*