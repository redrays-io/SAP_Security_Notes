1513492 - Directory traversal in SAP Product and REACH Compliance

**Symptom**

**Read-only directory traversal**

SAP Product and REACH Compliance contains a vulnerability that allows a malicious user to potentially read arbitrary files on the remote server, potentially disclosing confidential information.

**Read-write or write directory traversal**

SAP Product and REACH Compliance contains a vulnerability that allows a malicious user to potentially write arbitrary files on the remote server, potentially corrupting data or altering system behavior.

**Reason and Prerequisites**

**Reason**

SAP Product and REACH Compliance fails to correctly validate the path used to reference a file read from the remote server. As a result, a malicious user can direct the program to an arbitrary file in the system, disclosing its contents.

Additionally, SAP Product and REACH Compliance fails to correctly validate the path to which a user-submitted file is written. This allows a malicious user to potentially overwrite data in the remote system.

**Prerequisite:**

- SAP REACH Compliance 1.1 Support Package 04 with [Note 1511315](https://me.sap.com/notes/1511315) and [Note 1497003](https://me.sap.com/notes/1497003).
- SAP Product and REACH Compliance 2.0 Support Package 01 with [Note 1511315](https://me.sap.com/notes/1511315) and [Note 1497003](https://me.sap.com/notes/1497003).

The corrections provided in both notes are prerequisites for implementing this note.

**Solution**

For essential information about the solution, see [Note 1497003](https://me.sap.com/notes/1497003).

**Logical File Names for This Correction**

To ensure that the application can access only the files within the designated directories and subdirectories, implement the following logical file names based on the logical path `SPRC_HOME_PATH`:

- `SPRC_IMPORT_DIR`: Subdirectories for import files
- `SPRC_ARCHIVE_DIR`: Subdirectory for files that have been imported
- `SPRC_ERROR_DIR`: Subdirectory for files that have not yet been imported or have been imported incorrectly

**Recommendation for Setting Up Logical File Names**

1. On the application server, define a root directory for REACH (corresponding to `SPRC_HOME_PATH`).
2. Underneath this, create the import, archive, and error subdirectories (`SPRC_IMPORT_DIR`, `SPRC_ARCHIVE_DIR`, and `SPRC_ERROR_DIR` respectively).
3. Create logical files of the type DIR.
4. If using IMDS, transfer the existing physical paths of your active IMDS system from the Customizing activity "Specify IMDS System" to the definition of the logical file paths and file names.

**Additional Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008969712017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001513492?language=en-US&token=D9324BAA717DEA7FD9BE82E3DE9907BF)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001513492)
- [Share by Email](https://me.sap.com/notes/0001513492/share)
- [Open in New Window](https://me.sap.com/notes/0001513492/open)

**Prerequisites**

- [SAP Note 1497003](https://me.sap.com/notes/1497003): Potential directory traversals in applications
- [SAP Note 1511315](https://me.sap.com/notes/1511315): Internal source code improvements

**References**

- This document refers to [Note 1497003](https://me.sap.com/notes/1497003).
- The CVSS score for this vulnerability is **0**.

**Credits**

Credits to [https://redrays.io](https://redrays.io) for support to provided information.