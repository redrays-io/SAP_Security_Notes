1494840 - Unauthorized modification of displayed content in 3.x BEX

**Symptom**

The drag&relate interface could be abused by a malicious user, who could modify displayed application content without authorization and potentially obtain authentication information from other legitimate users.

**Other Terms**

Reflected Cross-Site Scripting, XSS, 3.x BEX ABAP

**Reason and Prerequisites**

API interface within the 3.x BEX ABAP web runtime function does not sufficiently encode output parameters, resulting in a reflected cross-site scripting issue. A reflected cross-site scripting attack can be used to non-permanently deface or modify displayed content from a website.

Reflected cross-site scripting can be used to steal another user's authentication information, such as data relating to their current session. An attacker who gains access to this data could use it to impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the application's security could be fully compromised.

**Solution**

- **Deactivate SICF Service:** The SICF internet service `/default_host/sap/bw/BEx` should always be deactivated as long as no deprecated 3.x BEX functionality is used. This is applicable for most BW customers.

- **Implement Support Package:** Apply the corresponding support package to address the issue.

- **Correction Instruction:** In urgent cases, implement the corresponding correction instruction if BEX 3.1 functionality is needed.

**Download Links**

- [Download for SNOTE](https://me.sap.com/note/0040000008846702017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001494840?language=en-US&token=BCB8D2034BC49B873F73EB7D73186D7F)

**Support Packages**

- [SAPKW70025 for SAP_BW 700](https://me.sap.com/supportpackage/SAPKW70025)
- [SAPKW70108 for SAP_BW 701](https://me.sap.com/supportpackage/SAPKW70108)
- [SAPKW70205 for SAP_BW 702](https://me.sap.com/supportpackage/SAPKW70205)
- [SAPK-71121INVCBWTECH for SAP_BW_VIRTUAL_COMP 711](https://me.sap.com/supportpackage/SAPK-71121INVCBWTECH)
- [SAPKW71106 for SAP_BW 711](https://me.sap.com/supportpackage/SAPKW71106)
- [SAPKW73001 for SAP_BW 730](https://me.sap.com/supportpackage/SAPKW73001)

**Correction Instructions**

- [Correction Instruction 0001494840/30](https://me.sap.com/corrins/0001494840/30)

**Credits**

Credits to [Redrays.io](https://redrays.io) for support in providing this information.