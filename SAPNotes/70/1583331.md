1583331 - Potential disclosure of persisted data in FS-RI

---

**SAP Security Note 1583331**

**Type:** SAP Security Note  
**Version:** 5  
**Recency:** New  
**Language:** English  
**Master Language:** German  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 14.06.2011  
**Component:** Financial Services > Re-Insurance (FS-RI)

### Description

A malicious user can exploit FS-RI and use specially crafted inputs to modify database commands, resulting in the retrieval of additional information persisted by the system.

### Cause

The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve data from the database.

### Solution

**Install the following Support Packages:**

- **Release 4.71:** FSRI47162032
- **Release 4.72:** FSRI47262023
- **Release 6.0:** FSRI60070018
- **Release 6.5:** SAPK-65012INMSG
- **Release 6.6:** SAPK-66006INMSG
- **Release 6.7:** SAPK-67001INMSG

**Manual Tasks:**

After installing the support packages, perform the following manual tasks before implementing the source code corrections:

1. **Edit Text Elements:**
   - Call transaction `SE38`.
   - Enter the program name `/MSG/R_GUV_STATISTIKEN` in the "Program" field.
   - Select the subobject "Text elements" and choose "Change".
   - Update the following text elements:
     - **Sym: 129**
       - **Text:** Invalid database table in subselect.
       - **mLen:** 50
     - **Sym: 130**
       - **Text:** Selection only permitted in /MSG/ tables.
       - **mLen:** 50
     - **Sym: 131**
       - **Text:** is not a transparent table.
       - **mLen:** 50
     - **Sym: 132**
       - **Text:** Table not found in ABAP Dictionary.
       - **mLen:** 50
   - Save and activate the text elements using a suitable request.

2. **Repeat the Same Steps for `/MSG/R_GUV_STAT`:**
   - Follow the exact same steps as above using the program `/MSG/R_GUV_STAT`.

**Important:**  
As a result of these changes, saved variants of the reports `/MSG/R_GUV_STATISTIKEN` or `/MSG/R_GUV_STAT` may become invalid and no longer work.

### Downloads

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009395482017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001583331?language=en-US&token=A808BD3B60183B0906A965D0C8F666EE)

### Edit Security Note

[Edit Security Note 1583331](https://me.sap.com/sap/support/notes/edit/0001583331)

---

**Credits:**  
Thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.