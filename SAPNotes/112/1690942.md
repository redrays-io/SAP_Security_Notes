SAP Security Note 1690942: Missing Authorization Check in VIRSA and VIRSANH

**SAP Security Note 1690942 - Missing Authorization Check in VIRSA and VIRSANH**

*Released On:* 12.06.2012  
*Component:* GRC-SAC-EAM  
*Priority:* Correction with high priority  
*Status:* Released for Customer  

---

### **Symptom**

An authenticated user can use functions of VIRSA and VIRSANH to which access should be restricted. This may result in an escalation of privileges.

### **Reason and Prerequisites**

VIRSA and VIRSANH do not contain authorization checks for verifying an authenticated user's authorization to access certain functions. This may result in undesired system behavior.

### **Solution**

In the GRC SPM application, the user exit `SUSR0001` has been used to prevent the direct login of Fire Fighter IDs into the R/3 application. The include `/virsa/zvirsa_userexit` manages the prevention of FFIDs from direct login. However, this user exit can be bypassed.

To overcome this security gap, a Trusted RFC concept has been implemented in the SPM application. Benefits of Trusted RFC include that passwords are not required for logging in via RFC when an FFID logs into the system.

For trusted RFC settings, additional authorization details, and Fire Fighter Role modifications, please refer to the [attachment](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000222472012&iv_version=0003&iv_guid=3EF6948338783241BA0F846751F374E3).

---

### **References**

- [SAP Note 1738932 - Trusted RFC method in GRC Fire Fighter application](https://me.sap.com/notes/1738932)

### **Preconditions**

- [SAP Note 1681358 - AC10.0: Co-existence of 5.3 EAM messages in 10.0](https://me.sap.com/notes/1681358) (Component: GRC-SAC-EAM)
- [SAP Note 1586578 - AC 5.3 SP12 - CUA Child system FFID cannot logon - ABAP Dump](https://me.sap.com/notes/1586578) (Component: GRC-SAC-EAM)

### **Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010044762017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001690942?language=en-US&token=38EBC885DB47A0EFD20145D92102364A)

---

*Credits to [Red Rays](https://redrays.io) for support in providing this information.*