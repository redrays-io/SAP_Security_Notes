SAP Security Note 1417568 - Unauthorized Change of Contents in CERTREQ and CERTMAP

**Description**

### Symptom
An attacker can manipulate the BSP applications **CERTREQ** and **CERTMAP** to change displayed data of another user without authorization and may access the authorization data of this user.

### Reason and Prerequisites
Due to inadequate input validation in the BSP applications **CERTREQ** and **CERTMAP**, a reflected cross-site scripting (XSS) vulnerability can be triggered. This allows the content of a web page to be manipulated when a crafted link is accessed. An attacker can exploit this to steal the logon information of the current session, impersonate the victim, and access the application with the victim's privileges. If the victim has administrative rights, all application data may be compromised.

### Solution
Implement the attached corrections provided in this security note. For Release 6.40, also apply the corrections from [Note 1475840](https://me.sap.com/notes/1475840) and the kernel patch from [Note 1468542](https://me.sap.com/notes/1468542). If the BSP applications **CERTREQ** and **CERTMAP** are not required, deactivate them using transaction **SICF**. Additionally, ensure that the ITS services **CERTREQ** and **CERTMAP** are deactivated in each case.

**Affected Components**
- **SAP_BASIS** versions 6.40, 7.00 to 7.02, and 7.10 to 7.20

**Support Packages**
- [SAPKB64027](https://me.sap.com/supportpackage/SAPKB64027) for SAP_BASIS 6.40
- [SAPKB70022](https://me.sap.com/supportpackage/SAPKB70022) for SAP_BASIS 7.00
- [SAPKB70107](https://me.sap.com/supportpackage/SAPKB70107) for SAP_BASIS 7.01
- [SAPKB70203](https://me.sap.com/supportpackage/SAPKB70203) for SAP_BASIS 7.02
- [SAPKB71010](https://me.sap.com/supportpackage/SAPKB71010) for SAP_BASIS 7.10
- [SAPKB71105](https://me.sap.com/supportpackage/SAPKB71105) for SAP_BASIS 7.11
- [SAPKB72003](https://me.sap.com/supportpackage/SAPKB72003) for SAP_BASIS 7.20

**Download and Further Information**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008358682017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001417568?language=en-US&token=CBAC126151B9179BC7514F3580200C85)

**References**
- [Downporting security functions in CL_HTTP_UTILITY (Note 1475840)](https://me.sap.com/notes/1475840)
- [Collective correction for BSP application CERTREQ (Note 1142365)](https://me.sap.com/notes/1142365)

*Credits to [RedRays](https://redrays.io) for support and information provided.*