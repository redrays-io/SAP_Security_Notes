SAP Security Note 1416085: PFCG Authorization Maintenance for S_RFCACL

**SAP Security Note 1416085 - PFCG: Authorization maintenance for object S_RFCACL**

**Type:** SAP Security Note  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Release Status:** Released for Customer  
**Released On:** 07.10.2013  
**Component:** Basis Components > Security - Read [KBA 2985997](https://me.sap.com/notes/2985997) for subcomponents > Authorization > ABAP Authorization and Role Administration

### **Symptom**
Every RFC function call requires a logon to the called system. If the RFC connection is defined as trust (transaction SM59, "Logon & Security" tab), the target system checks for the requested function and the authorization object **S_RFCACL**. The user under which these checks are executed depends on the RFC connection definition.

Improper entries in the fields **RFC_SYSID**, **RFC_CLIENT**, or **RFC_USER** for **S_RFCACL** can allow logons from any system, client, or user, leading to significant security risks.

### **Reason and Prerequisites**
This issue is triggered by a missing function related to authorization checks during RFC logons.

### **Solution**
Implement the correction instructions using transaction **SNOTE** or import the relevant Support Package provided in the note.

After applying the solution:
- Full authorization assignments for **RFC_SYSID**, **RFC_CLIENT**, and **RFC_USER** remain possible but require manual intervention in transaction **PFCG**.
- An additional dialog box will alert administrators of the security risks, requiring confirmation.
- Automatic methods for assigning full authorizations are disabled to prevent unauthorized access.

### **Manual Activities**
Use transaction **SE91** to create the necessary messages in the class **S#** and define them as self-explanatory.

### **Support Package Details**
Ensure you download and apply the appropriate Support Packages for your **SAP_BASIS** version:
- [SAPKB46C66](https://me.sap.com/supportpackage/SAPKB46C66) for SAP_BASIS 46C
- [SAPKB62074](https://me.sap.com/supportpackage/SAPKB62074) for SAP_BASIS 620
- ... (include other relevant Support Package links based on your system version)

### **Additional Information**
- The profile **SAP_ALL** does not include **S_RFCACL** unless explicitly added using the customizing switch **ADD_S_RFCACL = YES** in table **PRGN_CUST**.
- This setting also applies when inserting **SAP_ALL** into a role.

For detailed instructions and downloads, please visit the [SAP Support Portal](https://me.sap.com/notes/1416085).

---

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*