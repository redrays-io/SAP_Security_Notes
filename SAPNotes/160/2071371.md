2071371 - Missing authorization check in XAP-MBA-DSD

**Symptom**

An authenticated user can use certain functions to which access should be restricted. This may result in an escalation of privileges.

**Reason and Prerequisites**

XAP-MBA-DSD does not contain authorization checks for verifying an authenticated user's authorization to access some of its functions. This may lead to undesired system behavior.

**Solution**

A call to a generic BAdI for the authorization check has been added to the following function modules:

- `/DSD/PE_CLEAN_CONDITIONS`
- `/DSD/PE_CON_SET`
- `/DSD/PE_KEY_MOD`
- `/DSD/PE_PRI_SPE`

If an active BAdI implementation exists in a customer system and triggers the exception `NO_AUTHORITY`, access to data provided by these function modules will be restricted, and an error will be returned. If no implementation exists or if the implementation does not trigger the `NO_AUTHORITY` exception, the system will execute the functions as normal.

This note also includes fixes for potential SQL Injection vulnerabilities when calling these Function Modules. It is recommended to implement this solution in your system and review the manual activities outlined below.

**Actions**

- [Download for SNOTE](https://me.sap.com/notes/2071371/download)
- [PDF Version](https://me.sap.com/notes/2071371/print?language=en-US&token=1E59D7E582E64311F6FA8DB816AADD92)
- [Share by Email](https://me.sap.com/notes/2071371/share)
- [Open in New Window](https://me.sap.com/notes/2071371)

**Manual Activities**

1. (Optional) Create your own authorization objects.
2. Implement the BAdI `/DSD/SL_FSR_CHK_AUTH` or enhance the existing implementation. For more details, refer to [Note 1230364](https://me.sap.com/notes/1230364); step 3 describes the process in detail.
3. Assign the new authorizations to your users.

**Attachments**

- [BAdIImplementationExample.txt](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000974332014&iv_version=0002&iv_guid=6BEEA45F9914FC4489F56ADEFD7DCF5D) (1.7 KB)

**References**

- [2078596 - Further improvements for RFC security](https://me.sap.com/notes/2078596)
- [1230364 - DSD enhanced authorization check](https://me.sap.com/notes/1230364)

**Supported Software Components**

- **SAP_APPL**: 603 to 617+
- **EA-APPL**: 603 to 617+

**Support Packages**

Ensure you apply the relevant support packages for your system version:

- **SAP_APPL 603**: [SAPKH60316](https://me.sap.com/supportpackage/SAPKH60316)
- **EA-APPL 603**: [SAPK-60316INEAAPPL](https://me.sap.com/supportpackage/SAPK-60316INEAAPPL)
- *(Additional support packages available for other versions)*

**Correction Instructions**

- **SAP_APPL**: 1 Correction Instruction ([Details](https://me.sap.com/corrins/0002071371/1))
- **EA-APPL**: 1 Correction Instruction ([Details](https://me.sap.com/corrins/0002071371/229))

**Caution**

You must perform the manual activities separately in each system where you transport the Note for implementation.

For more detailed information and support, visit [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*