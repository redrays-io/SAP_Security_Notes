**Switchable authorization checks for RFC in Workflow and ESS**

Hello SAP Security Community,

I wanted to share an important SAP Security Note (**2044543**) that addresses switchable authorization checks for RFC function modules in Workflow and ESS. Here's a breakdown of the key information:

### **Symptom**
This note introduces new switchable authorization checks for RFC function modules used in Workflow and ESS. Previously, remote calls to RFC function modules were protected solely by the `S_RFC` authorization object. However, it was identified that `S_RFC` checks alone might not ensure secure execution for certain RFC function modules. 

### **Reason and Prerequisites**
- **Authorization Object:** Remote calls to RFC function modules are guarded by `S_RFC`. It's crucial to limit authorizations for `S_RFC` to the necessary minimum to maintain system security.
- **Identified Issue:** Some RFC function modules that are protected by `S_RFC` do not perform additional functional authorization checks, potentially exposing security vulnerabilities.

### **Solution**
- **New Authorization Checks:** Implement new switchable authorization checks introduced in this note. These checks are initially inactive to ensure compatibility with existing processes.
- **Activation Steps:**
  1. **Technical Implementation:** Apply the support package or correction instructions provided in the note to pre-implement the checks.
  2. **Manual Activation:** Use transaction **SACF** to activate the authorization checks manually. Detailed instructions are provided in the Correction Instructions section of the note.
  
### **Affected Business Processes and RFC Function Modules**
- **Workflow:**
  - **Scenario:** `HRBAS_WF` – Authorization check for Workflow.
  - **Affected Functions:** Includes various RFC functions like `RH_GET_TASK_CLASS_LOCKFLAGS`, `RH_HRP_BIND_ACTOR_READ`, etc.
- **ESS (Employee Self-Service):**
  - **Scenario:** `HRBAS_ESS` – Authorization check for ESS.
  - **Affected Function:** `HR_ESS_GET_EMPLUSER`
  
### **Manual Activities**
To activate the switchable authorization checks, follow these steps:
1. **Create Function Group:**
   - Use transaction **SE37** to create the function group `HR_RFC_AUTH` and assign it to package `SP00_SERVICE`.
2. **Activate Authorization Scenarios:**
   - In **SACF**, ensure that scenario definitions `HRBAS_ESS` and `HRBAS_WF` exist. If not, upload the provided `.TXT` files.
   - Convert scenario definitions to productive scenarios and activate them.
3. **Configure Security Audit Log:**
   - Ensure Security Audit Log is active via transaction **SM19**.
   - Create a new filter to log relevant audit messages.
4. **Adjust User Roles:**
   - Use report **RSAU_SELECT_EVENTS** to identify users needing additional authorizations based on the new scenarios.
   - Update roles accordingly to grant the necessary permissions.

### **Attachments**
- **HRBAS_WF.TXT:** [Download](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000890702014&iv_version=0002&iv_guid=345C541EAF096F4F84639F86D668DF30)
- **HRBAS_ESS.TXT:** [Download](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000890702014&iv_version=0002&iv_guid=56653451CBB3C44E97B26F5E57D454BD)

### **References**
- **Related Note:** [2078596 - Further improvements for RFC security](https://me.sap.com/notes/2078596)
- **Referenced By:** [2148160 - Work item texts sporadically remain empty](https://me.sap.com/notes/2148160)

### **Validity**
Applicable to various versions of the **SAP_BASIS** component, including releases 700, 710, 711, 730, 731, and 740.

### **Support Packages**
Ensure you apply the relevant support packages corresponding to your SAP_BASIS version. For example:
- **SAP_BASIS 700:** [SAPKB70032](https://me.sap.com/supportpackage/SAPKB70032)
- **SAP_BASIS 740:** [SAPKB74009](https://me.sap.com/supportpackage/SAPKB74009)

For detailed instructions and additional information, please refer to the full [SAP Note 2044543](https://me.sap.com/notes/2044543).

---

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*