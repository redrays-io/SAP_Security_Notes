SAP Security Note 1509378 - Unauthorized Usage of Application Functionality in BSP ALRTPERS

### Symptom

A malicious user can trigger functionality in the Business Server Page (BSP) ALRTPERS without authentication and authorization.

### Other Terms

- Cross Site Request Forgery (XSRF)
- ALRTPERS
- BSP

### Reason and Prerequisites

The BSP ALRTPERS executes certain functions through specific URLs. An attacker can trick an authenticated userâ€™s browser into making a request with certain URLs and parameters, executing functions with the user's rights. This can be exploited via Cross Site Scripting (XSS) or by presenting a clickable link to the victim.

### Solution

1. **Apply Prerequisite Note**
   - Implement [SAP Note 1520324](https://me.sap.com/notes/1520324) which provides advance creation of XSRF information. This note is a prerequisite for implementing SAP Note 1509378.

2. **Implement Correction Instructions**
   - Use the Note Assistant or import the relevant Support Package to apply the corrections from this note. This process will create the report `BSP_XSRF_PARAM_BC_SRV_GBT_ALM` in your system.

3. **Execute the Report**
   - Run the report `BSP_XSRF_PARAM_BC_SRV_GBT_ALM` and enter a transport request if necessary. This report inserts the relevant entries for the BSP application into the `BSPTEMPXSRFSTORE` database table.

### Affected Software Components

- **SAP_BASIS** versions 620 to 730

### Support Packages

Refer to the appropriate Support Package for your SAP_BASIS version:
- [SAPKB62070](https://me.sap.com/supportpackage/SAPKB62070) for SAP_BASIS 620
- [SAPKB64028](https://me.sap.com/supportpackage/SAPKB64028) for SAP_BASIS 640
- [SAPKB70024](https://me.sap.com/supportpackage/SAPKB70024) for SAP_BASIS 700
- [SAPKB70109](https://me.sap.com/supportpackage/SAPKB70109) for SAP_BASIS 701
- [SAPKB70207](https://me.sap.com/supportpackage/SAPKB70207) and [SAPKB70206](https://me.sap.com/supportpackage/SAPKB70206) for SAP_BASIS 702
- [SAPKB71012](https://me.sap.com/supportpackage/SAPKB71012) for SAP_BASIS 710
- [SAPKB71107](https://me.sap.com/supportpackage/SAPKB71107) for SAP_BASIS 711
- [SAPKB72005](https://me.sap.com/supportpackage/SAPKB72005) for SAP_BASIS 720
- [SAPKB73003](https://me.sap.com/supportpackage/SAPKB73003) and [SAPKB73002](https://me.sap.com/supportpackage/SAPKB73002) for SAP_BASIS 730

### Additional Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008943822017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001509378?language=en-US&token=2E10B7346796FD66D612863CE671DDEB)

### Credits

Credits to [redrays.io](https://redrays.io) for support in providing this information.