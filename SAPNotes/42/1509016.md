1509016 - Unauthorized usage of application functionality in SAP_HR

**Description**

### Symptom
A malicious user can trigger functionality in SAP_HR without authentication and authorization.

### Other Terms
Cross-Site Request Forgery, XSRF, SAP_HR.

### Reason and Prerequisites
SAP_HR executes certain functions through referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the user.

If present, the attacker may use a Cross Site Scripting attack to trigger the exploit, or use an approach in which a link to click is presented to the victim.

### Solution
The correction will be delivered with a Support Package. The relationship between the Support Package and the technical name given under "Support Packages" is described in [SAP note 1232082](https://me.sap.com/notes/1232082).

Alternatively, you can implement the correction instructions:

1. Refer to [note 1481392](https://me.sap.com/notes/1481392) for additional information and instructions. The corrections from note 1481392 are a prerequisite for implementation of this note.

2. Implement the correction instructions of this note. This will also create the report `RH_XSRF_PARAM_SAP_HR_ITS` in your system.

3. Execute the report and specify a corresponding transport request number when prompted. The report will add service parameters for the adapted ITS services (maintained via the GUI configuration pushbutton for a service within transaction SICF).

**Components Affected**

- **SAP_HRGXX** from version **500** to **500**
- **SAP_HRGXX** from version **600** to **600**
- **SAP_HRGXX** from version **604** to **604**

**Support Package**

- [SAPK-50081INSAPHRGXX](https://me.sap.com/supportpackage/SAPK-50081INSAPHRGXX) for SAP_HRGXX 500
- [SAPK-60064INSAPHRGXX](https://me.sap.com/supportpackage/SAPK-60064INSAPHRGXX) for SAP_HRGXX 600
- [SAPK-60430INSAPHRGXX](https://me.sap.com/supportpackage/SAPK-60430INSAPHRGXX) for SAP_HRGXX 604

**References**

This document refers to:

- [1481392 - Cross Site Request Forgery Protection for ITS](https://me.sap.com/notes/1481392)

**Download**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008941562017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001509016?language=en-US&token=2E19FA89A3FFF4FD0D1DE82F89EAEE84)

**Available Languages**

- [日本語](https://me.sap.com/notes/0001509016/J)
- [Deutsch (Machine Translation)](https://me.sap.com/notes/0001509016/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0001509016/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001509016/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001509016/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001509016/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001509016/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001509016/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001509016/3)

**Actions**

- [Mark as Favorite](#) / [Unmark as Favorite](#)
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008941562017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001509016?language=en-US&token=2E19FA89A3FFF4FD0D1DE82F89EAEE84)
- [Share by Email](#)
- [Open in New Window](#)

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*