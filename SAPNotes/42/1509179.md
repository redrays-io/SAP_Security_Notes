1509179 - Potential directory traversals in batch input programs

# SAP Security Note 1509179

**Type:** SAP Security Note  
**Version:** 3  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 14.12.2010  
**Component:** Industry-Specific Components > Bank (IS-B)  

## Description

### Symptom
Potential directory traversals in batch input programs RJBDBTC3, RJBDBTC2, RJBDBTC1, MJBEHF01.

### Other Terms
Directory traversal, FILE_VALIDATE_NAME, FILE, VALIDATION_FAILED, RJBDBTC3, RJBDBTC2, RJBDBTC1, MJBEHF01

### Reason and Prerequisites
1. The programs contained in the correction instructions contain vulnerabilities through which a malicious user can potentially read arbitrary files on the remote server, possibly disclosing confidential information.
2. Some of the programs contained in the correction instructions contain a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

## Solution
Please refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The corrections from this note are a prerequisite for the implementation of this note.

**Logical File Names Used in this Solution**

- **In Program RJBDBTC3 (Batch Input for Derivatives):**
  - *Logical File Paths:*  
    `FTRM_AN_BATCH_INPUT_DER` - Treasury: Input file path for Batch input for Derivatives  
  - *Logical File Names:*  
    `FTRM_AN_BATCH_INPUT_DER` - Treasury: Input file name for Batch input for Derivatives

- **In Program RJBDBTC2 (Batch Input for Money Market):**
  - *Logical File Paths:*  
    `FTRM_AN_BATCH_INPUT_MM` - Treasury: Input file path for Batch input for Money Market  
  - *Logical File Names:*  
    `FTRM_AN_BATCH_INPUT_MM` - Treasury: Input file name for Batch input for Money Market

- **In Program RJBDBTC1 (Batch Input for Forex):**
  - *Logical File Paths:*  
    `FTRM_AN_BATCH_INPUT_FX` - Treasury: Input file path for Batch input for Forex  
  - *Logical File Names:*  
    `FTRM_AN_BATCH_INPUT_FX` - Treasury: Input file name for Batch input for Forex

- **In Include MJBEHF01:**
  - *Logical File Paths:*  
    `FTRM_AN_BATCH_INPUT_ERR_FILE` - Treasury: Error file path for Batch input  
  - *Logical File Names:*  
    `FTRM_AN_BATCH_INPUT_ERR_FILE` - Treasury: Error file name for Batch input

## Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008942512017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001509179?language=en-US&token=407E6EFB8FB7DA8B38E2C223FA521BE4)

## References

This document refers to:
- [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

## Correction Instructions

- **EA-FINSERV**
  - [Corrin 201](https://me.sap.com/corrins/0001509179/201)
- **BANK/CFM**
  - [Corrin 59](https://me.sap.com/corrins/0001509179/59)

---

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*