1509342 - Unauthorized modification of displayed content

**Description**

**Symptom**

By manipulating the input data of the Web Channel applications, including:
- E-Commerce B2B
- E-Commerce B2C
- E-Service Claims and Returns

a malicious user can modify data of another user without authorization and potentially obtain authentication information from other legitimate users.

**Other Terms**

Reflected Cross Site Scripting (XSS), CRM, Web Channel, ISA, B2B

**Reason and Prerequisites**

Due to inadequate output encoding by specific websites of the Web Channel applications, reflected cross-site scripting can be triggered. This vulnerability can be exploited to:
- Non-permanently deface or modify displayed content on a website.
- Steal another user's authentication information, such as session data.
- Impersonate users, gaining access to information with the same rights as the target user.
- Potentially achieve full compromise of the application's security if an administrator is impersonated.

**Solution**

This note contains Java corrections for E-Commerce and CRM Web Channel.

**Affected Components:**
- **SAP-SHRWEB**
  - Development Components:
    - `crm/isa/web/b2b`
      - Changed files: `confirm.jsp`, `organizer-content-doc-search.jsp`, `organizer-customer-doc-search.jsp`, `summarybasket2.jsp`, `showpredecessorquotations.jsp`, `showpredecessors.jsp`
    - `crm/isa/web/b2c`
      - Changed file: `orderList.inc.jsp`
    - `crm/tc/web/catalog`
      - Changed files: `ProductDetails.inc.jsp`, `productlist.block.inc.jsp`, `productlist.list.inc.jsp`
    - `crm/eservice/web/cr_b2b`
      - Changed files: `return_entry_main.jsp`, `return_status_main.jsp`

**Action Required:**
Apply the Support Package patch level specified in this note.

**Downloads:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017097002017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001509342?language=en-US&token=30086621ABDC657AF82CCD9E526479E3)

**References**

- [1777016 - Additional XSRF Protection switch in the XCM](https://me.sap.com/notes/1777016)
- [1603081 - Unauthorized modification of displayed content in ISA-AUC](https://me.sap.com/notes/1603081)
- [1601155 - Unauthorized modification of displayed content in CRM-ISA](https://me.sap.com/notes/1601155)
- [1548767 - Unauthorized use of functions in CRM Web Channel](https://me.sap.com/notes/1548767)
- [1501646 - Unauthorized use of functions in CRM Web Channel](https://me.sap.com/notes/1501646)
- [1315240 - Possible XSS vulnerability in theme functionality of WebChan](https://me.sap.com/notes/1315240)

**Support Package Patches**

- [CRM JAVA APPLICATIONS 7.0 SP008 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010450&support_package=SP008&patch_level=000003)
- [SAP SHARED JAVA COMPONENTS 7.0 SP008 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010520&support_package=SP008&patch_level=000003)
- [SAP SHARED WEB COMPONENTS 7.0 SP008 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010521&support_package=SP008&patch_level=000003)
- [CRM JAVA COMPONENTS 7.0 SP008 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010451&support_package=SP008&patch_level=000003)
- [CRM JAVA WEB COMPONENTS 7.0 SP008 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010452&support_package=SP008&patch_level=000003)
- ... *(additional patches as listed in the Support Package Patch section)*

_For the full list of support package patches, please refer to the [Support Package Patches](https://me.sap.com/notes/1509342) section of the SAP Note._

_Credits to [redrays.io](https://redrays.io) for support to provided information._