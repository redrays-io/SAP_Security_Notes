1509403 - Potential directory traversals in transaction TVDT

**SAP Security Note 1509403**

**Released On:** August 16, 2011  
**Type:** SAP Security Note  
**Version:** 8  
**Component:** [Financial Supply Chain Management > Treasury and Risk Management > Market Risk Analyzer (FIN-FSCM-TRM-MR)](https://me.sap.com/servicessupport/knowledge/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'FIN-FSCM-TRM-MR*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

### Description

**Symptom**  
Potential directory traversals in transactions TVDT using physical file names as input.

**Other Terms**  
Directory traversal, FILE_VALIDATE_NAME, FILE, VALIDATION_FAILED, TVDT

**Reason and Prerequisites**

1. The programs contained in the correction instructions have vulnerabilities that allow a malicious user to potentially read arbitrary files on the remote server, possibly disclosing confidential information.
2. Some programs contain vulnerabilities that allow a malicious user to potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

**Solution**

Refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The corrections from Note 1497003 are a prerequisite for implementing this note.

**Logical File Names Used in this Solution**

In Program RFTBFF30 (Transaction TVDT):

- **Logical File Paths:**
  - `FTRM_TCR_MARKETDATA_FF_EXPORT` - Treasury: Market Data Filefeed Export Path
  - `FTRM_TCR_MARKETDATA_FF_IMPORT` - Treasury: Market Data Filefeed Import Path

- **Logical File Names:**
  - `FTRM_TCR_MARKETDATA_FF_DERIVATIVE_PRICES_ERRORLOG_EXPORT` - Treasury: Market Data Filefeed - Exp. Deriv. Prices Errorlog
  - `FTRM_TCR_MARKETDATA_FF_DERIVATIVE_PRICES_IMPORT` - Treasury: Market Data Filefeed - Import Derivate Prices

### References

- [1509869 - Market Data Interface: Potential Directory Traversal](https://me.sap.com/notes/1509869)
- [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

### Download and Documentation

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008943962017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001509403?language=en-US&token=BDB26E225D4E8765523B48C3A251ADDF)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001509403/E/diff)

### Support Packages

This note is applicable to the following software components and versions:

- **SAP_APPL**
  - From: 46C to 46C
  - From: 470 to 470
  - From: 500 to 500
  - From: 600 to 600
  - From: 602 to 602
  - From: 603 to 603
  - From: 604 to 604
  - From: 605 to 605
- **EA-FINSERV**
  - From: 110 to 110
  - From: 200 to 200
  - From: 500 to 500
  - From: 600 to 600
  - From: 603 to 603
  - From: 604 to 604
  - From: 605 to 605
- **BANK/CFM**
  - From: 463_20 to 463_20

For detailed support package information, visit the respective [Support Package URLs](https://me.sap.com/supportpackage/SAPKGPFA32).

### Correction Instructions

Correction instructions are available for the following components:

- **SAP_APPL:** 2 Correction Instructions ([Link](https://me.sap.com/corrins/0001509403/1))
- **EA-FINSERV:** 3 Correction Instructions ([Link](https://me.sap.com/corrins/0001509403/201))
- **BANK/CFM:** 2 Correction Instructions ([Link](https://me.sap.com/corrins/0001509403/59))

### Credit

Credits to [redrays.io](https://redrays.io) for support in providing this information.