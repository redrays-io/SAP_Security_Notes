1508913 - Sales Assistant: Security Note for XSRF and BSP Applications

## Overview

SAP Security Note 1508913 addresses a Cross-Site Request Forgery (XSRF) vulnerability in the BSP applications of the "Sales Assistant" Portal Role. This vulnerability allows malicious users to execute functions in specific BSP applications without proper authentication and authorization.

## Symptom

A malicious user can trigger functionality in the BSP applications of the Portal Role "Sales Assistant" without authentication and authorization. The affected BSP applications are:

- `SLS_ASSISTANT` (Role: ERP sales assistant for portal)
- `SLS_WORKLIST` (Worklist for SalesRoles)
- `SLS_PROTECT` (Helper Page)

## Reason and Prerequisites

The three BSP applications of the Sales Assistant role execute certain functions by referencing specific URLs. An attacker can trick an authenticated user's browser into making a request with a malicious URL and parameters, executing the function with the user's rights. Potential attack approaches include:

- **Cross-Site Scripting (XSS)** to trigger the exploit.
- **Phishing links** prompting the victim to click.

## Solution

Follow these steps to address the vulnerability:

1. Refer to [SAP Note 1520324](https://me.sap.com/notes/1520324) for additional information and instructions. The corrections from this note are a prerequisite for implementing this note.
2. Implement the correction instructions of this note (1508913).
3. **Only relevant for SAP_APPL release 604 and below**:
   - Create the report `BSP_XSRF_PARAM_SD` as a local object in your system.
   - Execute the report `BSP_XSRF_PARAM_SD` and specify a transport request number when prompted. This report will populate the database table `BSPTEMPXSRFSTORE` with entries for the adapted BSP applications.

## Affected Software Components

- SAP_APPL versions 500 to 605.

## Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008940852017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001508913?language=en-US&token=6D2B359CC51C49DD294D82609841F8F8)

## References

- [SAP Note 1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)
- [SAP Note 1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)

## Support Package Information

Refer to the support packages listed in the note for compatibility and updates.

## Credits

Thanks to [RedRays.io](https://redrays.io) for supporting the provision of this information.