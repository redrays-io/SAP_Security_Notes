1509064 - Possible disclosure of data in function grp BCA_API_CN_CTRL

**Description**

**Symptom**
A malicious user can make specific entries in the function modules `BCA_API_CHECK_TABLE_VAL_EXISTS`, `BCA_API_CN_CTRL_CHCKTAB_VAL_EX`, `BCA_API_CN_CTRL_CHCKTAB_VAL_GE`, and `BCA_CHECK_TABLE_VALUE_EXISTS` in the function group `BCA_API_CN_CTRL` to disclose additional data or to change data saved in the database.

**Other Terms**
SQL injection, database, `BCA_API_CHECK_TABLE_VAL_EXISTS`, `BCA_API_CN_CTRL_CHCKTAB_VAL_EX`, `BCA_API_CN_CTRL_CHCKTAB_VAL_GE`, `BCA_CHECK_TABLE_VALUE_EXISTS`, `BCA_API_CN_CTRL`

**Reason and Prerequisites**
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement including strings that can be altered by a malicious user. The resulting complete statement can then be manipulated and used to modify data in the database or to output additional data.

**Solution**
Import the relevant Support Package for your release. Use transaction SNOTE to implement the attached correction instructions in advance.

You do not have to perform any manual tasks.

**Affected Software Components**

- **FSAPPL**: Versions 100, 200, 300
- **BANK-TRBK**: Versions 30, 40

**Support Packages**

- **FSAPPL 100**: [SAPKISC214](https://me.sap.com/supportpackage/SAPKISC214)
- **FSAPPL 200**: [SAPKISC313](https://me.sap.com/supportpackage/SAPKISC313)
- **FSAPPL 300**: [SAPK-30006INFSAPPL](https://me.sap.com/supportpackage/SAPK-30006INFSAPPL)
- **BANK-TRBK 30**: [SAPKISCC12](https://me.sap.com/supportpackage/SAPKISCC12)
- **BANK-TRBK 40**: [SAPKISC109](https://me.sap.com/supportpackage/SAPKISC109)

**Correction Instructions**

- **FSAPPL**: [Correction Instructions 1](https://me.sap.com/corrins/0001509064/1534)
- **BANK-TRBK**: [Correction Instructions 2](https://me.sap.com/corrins/0001509064/62)

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008941912017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001509064?language=en-US&token=C151F7A3AA33D045D444A85C0A524605)

**Preconditions**

- **BANK-TRBK 30**
  - [SAP Note 676362](https://me.sap.com/notes/676362): Short dump BCA_SET_PRESDATE presence method entered incorrectly
  - [SAP Note 701913](https://me.sap.com/notes/701913): CR0094 Postal bank - enhancement time-dependency: migration

For more details, refer to the full note on [SAP Support](https://me.sap.com/notes/1509064).

*Credits: [Redrays.io](https://redrays.io) for support in providing this information.*