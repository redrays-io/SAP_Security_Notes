1508981 - Unauthorized use of application functions in PA-PD-PM

**Symptom**
An attacker can execute functions in 'PA-PD-PM' without authentication and authorization.

**Other Terms**
Cross-Site Request Forgery, XSRF, HAP_DOCUMENT

**Reason and Prerequisites**
'PA-PD-PM' executes certain functions by referencing specific URLs. When an attacker tricks an authenticated userâ€™s browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The attacker may use a cross-site scripting attack to do this, or they may present a link to the victim.

**Solution**
1. For additional information and instructions, see [Note 1520324](https://me.sap.com/notes/1520324). The corrections from Note 1520324 are a prerequisite for implementing this note.
2. Implement the correction instructions provided in this note. Depending on your release, one of the following reports will be created in your system:
   - EA-HRGXX 110: BSP_XSRF_PARAM_HAP_DOC_110
   - EA-HRGXX 200: BSP_XSRF_PARAM_HAP_DOC_200
   - SAP_ABA 640: BSP_XSRF_PARAM_HAP_DOC_640
   - SAP_ABA 700: BSP_XSRF_PARAM_HAP_DOC_700
   - SAP_ABA 701: BSP_XSRF_PARAM_HAP_DOC_701
   - SAP_ABA 702: BSP_XSRF_PARAM_HAP_DOC_702
   - SAP_ABA 710: BSP_XSRF_PARAM_HAP_DOC_710
   - SAP_ABA 711: BSP_XSRF_PARAM_HAP_DOC_711
   - SAP_ABA 730: BSP_XSRF_PARAM_HAP_DOC_730
3. Execute the report and when requested, specify a relevant transport request number. The report will fill the database table `BSPTEMPXSRFSTORE` with relevant table entries for the BSP applications adapted by this note.

**Downloads**
- [Download for SNOTE](https://me.sap.com/notes/0040000008941262017)
- [PDF Version](https://me.sap.com/notes/0001508981?language=en-US&token=B126F6C9687C9F5BDD8233E990E9F80D)

**References**
- [Note 1520324: Advance creation of XSRF information](https://me.sap.com/notes/1520324)

**Additional Information**
- **Release Status:** Released for Customer
- **Released On:** 08.11.2011
- **Category:** Program error
- **Priority:** Correction with high priority

For more details and updates, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [redrays.io](https://redrays.io) for providing the information.*