SAP Note 1509214 - Unauthorized usage of application functionality in FSCM_BD

**Symptom**

An unauthorized user can trigger functionality in FSCM_BD on behalf of an unsuspecting authorized user.

**Other Terms**

Cross-Site Request Forgery, CSRF, XSRF, FSCM_BD

**Reason and Prerequisites**

FSCM_BD executes state-changing functionality via referencing URLs. In certain scenarios, it is possible for an unauthorized and unauthenticated third party to trigger this functionality on behalf of an authorized authenticated user without the latter's knowledge and/or consent.

**Solution**

XSRF attacks have to be addressed inside web applications. These applications must ensure that for state-changing operations they are not relying only on credentials or tokens that are automatically submitted by browsers. A common approach is including a special token in each request, which is associated with the user session and is valid only for the session lifetime.

The SAP NetWeaver Application Server Java (AS Java) has been enhanced with the XSRF Protection Framework. You can secure your web-application with the token-based approach by adopting the framework. This note contains the adoption of the XSRF Protection Framework for FSCM_BD.

Please refer to [SAP Note 1450166](https://me.sap.com/notes/1450166) for details regarding availability. To enable XSRF protection for FSCM_BD, apply the above-mentioned Note before following the steps outlined in this Note. Additionally, refer to the [SAP XSRF Protection Guide](https://me.sap.com/notes/1450166) to gain an overall understanding of the XSRF protection procedure.

**Download and Documentation**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017096822017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001509214?language=en-US&token=29E53CF0AB83F1F2A03CE772FA3D2E78)

**Affected Software Components**

- FSCM_BD Versions: 300, 600, 602, 604, 605

**References**

- [SAP Note 1597549 - Unauthorized modification of displayed content in FSCM_BD](https://me.sap.com/notes/1597549)
- [SAP Note 1537670 - Unauthorized usage of application functionality in FSCM_BD](https://me.sap.com/notes/1537670)
- [SAP Note 1516177 - XSRFJava: Adopt API-PSI Utility Customer E-Services](https://me.sap.com/notes/1516177)
- [SAP Note 1515190 - Composite SAP Note: Security of SAP Biller Direct](https://me.sap.com/notes/1515190)
- [SAP Note 1450166 - Unauthorized usage of application functionality](https://me.sap.com/notes/1450166)

**Credits**

Credits to [Redrays](https://redrays.io) for support in providing this information.