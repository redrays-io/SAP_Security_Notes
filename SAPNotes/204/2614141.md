2614141 - [CVE-2018-2409] Improper session management when using SAP CP Connectivity Service and Cloud Connector

## Symptom

Under certain conditions, data of some other user may be shown or modified when using an application built on top of SAP Cloud Platform.

### CVSS Information

- **CVSS v3 Base Score:** 6.3 / 10
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

*SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note.*

For more information, see the [SAP Security Notes FAQ](https://support.sap.com/securitynotes).

## Reason and Prerequisites

Data is retrieved via HTTPS from a system installed in the corporate network of the customer via the Cloud Connector. Prerequisites are:

- Uses the HTTP destination runtime of SAP Cloud Platform Connectivity in Neo.
- Uses connection pooling.
- The scenario is making use of Principal Propagation.

If these prerequisites are met, a random session may be chosen instead of the correct one for communication with the backend.

## Solution

Session handling in Cloud Connector has been fixed to avoid session mixing. The fix is available as of **SAP Cloud Connector 2.11**. You can download the fixed version from the [SAP Cloud Tools](https://tools.hana.ondemand.com/#cloud).

Upgrade your existing Cloud Connector installation with the downloaded version by following the [upgrade instructions](https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/7a7cc373019b4b6eaab39b5ab7082b09.html).

## Attributes

- **Other Components:** Basis Components > SAP Cloud Platform - NEO Environment > Neo to On-premise Connectivity service (BC-NEO-CON)
- **Externally Reported:** Yes

## Available Languages

- [Deutsch](https://me.sap.com/notes/0002614141/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002614141/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002614141/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002614141/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002614141/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002614141/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002614141/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002614141/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002614141/3)

## Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000672012018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002614141?language=en-US&token=742B937B68EFDE0119B1A42CF2E83D30)

For more detailed information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*