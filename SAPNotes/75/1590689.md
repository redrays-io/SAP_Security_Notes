1590689 - PI SEC: HTTP verb tampering issue in AF Application

**Description**

### Symptom

In the 'Adapter Framework Application', there are problems with authorization and authentication checks if certain HTTP methods are used.

An attacker can control the behavior of the system, or potentially escalate privileges by executing malicious code, without having legitimate credentials.

### Other Terms

- Verb Tampering
- HTTP method
- com.sap.aii.af.app

**Reason and Prerequisites**

1. **Do not grant** the role `SAP_ungranted_role` to any user.
2. **Ensure** SAP Note [1445998](https://me.sap.com/notes/1445998) is applied to disable `invokerservlet` (Not required for NW 7.20 SP03 and above). While Verb-Tampering and InvokerServlet problems and solutions are not prerequisites of each other, it is recommended to apply both fixes.

**Solution**

This issue is resolved with the referenced Support Packages and Patches of the Software Component **XI ADAPTER FRAMEWORK (SAP_XIAF)**.

**References**

*This document refers to:*

- [1675853 - SAP EhP1 for XI on Netweaver 7.00 SP11](https://me.sap.com/notes/1675853)
- [1666253 - NW04s XI Support Package Stack 26](https://me.sap.com/notes/1666253)
- [1664303 - SAP EHP1 FOR SAP NETWEAVER PI 7.1 SP09](https://me.sap.com/notes/1664303)
- [1664301 - SAP Netweaver for PI 7.10 Support Package 14](https://me.sap.com/notes/1664301)
- [1655997 - XI 30 Support Package Stack (SPS) 29](https://me.sap.com/notes/1655997)
- [1649430 - SAP EhP2 for Netweaver 7.00 SP10](https://me.sap.com/notes/1649430)
- [1445998 - Disabling invoker servlet](https://me.sap.com/notes/1445998)

*This document is referenced by:*

- [1675853 - SAP EhP1 for XI on Netweaver 7.00 SP11](https://me.sap.com/notes/1675853)
- [1664303 - SAP EHP1 FOR SAP NETWEAVER PI 7.1 SP09](https://me.sap.com/notes/1664303)
- [1666253 - NW04s XI Support Package Stack 26](https://me.sap.com/notes/1666253)
- [1664301 - SAP Netweaver for PI 7.10 Support Package 14](https://me.sap.com/notes/1664301)
- [1655997 - XI 30 Support Package Stack (SPS) 29](https://me.sap.com/notes/1655997)
- [1649430 - SAP EhP2 for Netweaver 7.00 SP10](https://me.sap.com/notes/1649430)

**Validity**

The note is applicable to the following software components and versions:

- **SAP_XIAF**: 3.0
- **SAP_XIAF**: 7.00 to 7.02
- **SAP_XIAF**: 7.10 to 7.11
- **SAP_XIAF**: 7.20
- **SAP_XIAF**: 7.30
- **SAP_XIAF**: 7.31

**Support Package Patches**

- [XI ADAPTER FRAMEWORK 7.30 SP004](https://me.sap.com/support/swdc/notes?cvnr=01200615320200015134&support_package=SP004&patch_level=000000)
- [XI ADAPTER FRAMEWORK 7.11 SP009](https://me.sap.com/support/swdc/notes?cvnr=01200314690200006988&support_package=SP009&patch_level=000000)
- [XI ADAPTER FRAMEWORK 7.20 SP007](https://me.sap.com/support/swdc/notes?cvnr=01200615320200013138&support_package=SP007&patch_level=000000)
- [XI ADAPTER FRAMEWORK 7.01 SP011](https://me.sap.com/support/swdc/notes?cvnr=01200314690200007188&support_package=SP011&patch_level=000000)
- [XI ADAPTER FRAMEWORK 7.02 SP010](https://me.sap.com/support/swdc/notes?cvnr=01200615320200012533&support_package=SP010&patch_level=000000)
- [XI ADAPTER FRAMEWORK 7.10 SP014](https://me.sap.com/support/swdc/notes?cvnr=01200314690200005003&support_package=SP014&patch_level=000000)
- [XI ADAPTER FRAMEWORK 7.00 SP026](https://me.sap.com/support/swdc/notes?cvnr=01200615320200007812&support_package=SP026&patch_level=000000)
- [XI ADAPTER FRAMEWORK 3.0 SP029](https://me.sap.com/support/swdc/notes?cvnr=01200615320200007232&support_package=SP029&patch_level=000000)

**Credits**

Thanks to [redrays.io](https://redrays.io) for their support and providing the information.