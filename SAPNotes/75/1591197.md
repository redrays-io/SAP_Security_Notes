1591197 - Potential modification/disclosure of data.

**SAP Security Note 1591197 - Potential Modification/Disclosure of Data**

**Symptom**
A malicious user can exploit the AFX generator and AFX Archiving engine applications by using specially crafted inputs to execute arbitrary commands. This can lead to the retrieval, modification, or removal of data persisted by the system.

**Other Terms**
- AFX_GENERATOR
- AFX_ARCHIVINGENGINE
- COMMAND INJECTION
- SQL INJECTION
- DIRECTORY TRAVERSAL

**Reason and Prerequisites**
The vulnerability arises from an injection flaw where the code constructs statements using strings that can be manipulated by a malicious user. This manipulation allows the attacker to retrieve additional information or potentially modify data.

**Solution**
A check has been implemented to ensure the validity of the trace table. To fully address the issue, please implement both the automatic and manual corrections attached to the note.

**Correction Instructions**
1. Go to transaction `SE91`.
2. Create a message with the following details:
   - **Message Class:** AFX_GENERATION
   - **Message Number:** 151
   - **Message Text:** Bad Authorization
   - **Self-explanatory:** Yes

**Software Components Affected**
- **SAP_ABA**
  - From version 700 to 702
  - From version 710 to 730

**Support Packages**
- [SAPKA70025](https://me.sap.com/supportpackage/SAPKA70025)
- [SAPKA70110](https://me.sap.com/supportpackage/SAPKA70110)
- [SAPKA70209](https://me.sap.com/supportpackage/SAPKA70209)
- [SAPKA71013](https://me.sap.com/supportpackage/SAPKA71013)
- [SAPKA71108](https://me.sap.com/supportpackage/SAPKA71108)
- [SAPKA72006](https://me.sap.com/supportpackage/SAPKA72006)
- [SAPKA73004](https://me.sap.com/supportpackage/SAPKA73004)

**Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009446002017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001591197?language=en-US&token=87BE6F169F273BCB04DFE2CCE3F8032F)

For more details, please visit the [SAP Security Note 1591197](https://me.sap.com/notes/0001591197).

*Credits to [RedRays](https://redrays.io) for supporting the information provided.*