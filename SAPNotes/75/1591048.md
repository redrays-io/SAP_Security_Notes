SAP Security Note 1591048 - QPAP: Potential modification or disclosure of persisted data

## Header Data
- **SAP Note/KBA:** 1591048
- **Type:** SAP Security Note
- **Version:** 1
- **Recency:** New
- **Language:** English
- **Master Language:** German
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 12.07.2011
- **Component:** Quality Management > Quality Inspection

## Description

### Symptom
A malicious user can exploit the function group QPAP for reading plans and use specially crafted inputs to modify database commands. This results in either the retrieval of additional information or the modification of data persisted by the system.

### Other Terms
SQL injection, database, QPAP, parameter validity

### Reason and Prerequisites
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve additional data from the database or to modify the data.

### Solution
Implement the attached corrections.

## Attributes
- **Other Components:** Quality Management > Quality Inspection > Inspection Lot Creation (QM-IM)

## References

### This document refers to
- [SAP Note 888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

## Software Components
| Software Component | From | To |
|--------------------|------|----|
| SAP_APPL           | 470  | 470 |
| SAP_APPL           | 500  | 500 |
| SAP_APPL           | 600  | 600 |
| SAP_APPL           | 602  | 602 |
| SAP_APPL           | 603  | 603 |
| SAP_APPL           | 604  | 604 |
| SAP_APPL           | 605  | 605 |

## Support Packages
| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| SAP_APPL 470               | SAPKH47036      | [Link](https://me.sap.com/supportpackage/SAPKH47036) |
| SAP_APPL 500               | SAPKH50025      | [Link](https://me.sap.com/supportpackage/SAPKH50025) |
| SAP_APPL 600               | SAPKH60020      | [Link](https://me.sap.com/supportpackage/SAPKH60020) |
| SAP_APPL 602               | SAPKH60210      | [Link](https://me.sap.com/supportpackage/SAPKH60210) |
| SAP_APPL 603               | SAPKH60309      | [Link](https://me.sap.com/supportpackage/SAPKH60309) |
| SAP_APPL 604               | SAPKH60410      | [Link](https://me.sap.com/supportpackage/SAPKH60410) |
| SAP_APPL 605               | SAPKH60505      | [Link](https://me.sap.com/supportpackage/SAPKH60505) |

## Correction Instructions
- [Correction Instruction 1](https://me.sap.com/corrins/0001591048/1)

## Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009445112017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001591048?language=en-US&token=5DE5027B9820F6DC6EBC429927E0B745)
- [Share by Email](https://me.sap.com/)
- [Open in New Window](https://me.sap.com/)

**Credits to [https://redrays.io](https://redrays.io) for support to provided information.**