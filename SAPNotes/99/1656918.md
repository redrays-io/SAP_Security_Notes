SAP Security Note 1656918 - Unauthorized modification of displayed content in UAD_xx

**Symptom**
The components UAD_xx can be abused by a malicious user allowing them to modify displayed application content without authorization and to potentially obtain authentication information from other legitimate users.

**Other Terms**
Cross Site Scripting, XSS, UAD_xx

**Reason and Prerequisites**
Pages within the components UAD_xx do not sufficiently encode output parameters, resulting in a cross-site scripting issue.

Cross-site scripting can be used to steal another user's authentication information, such as data relating to their current session. A malicious user who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user.

If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**
Please apply this note or import the changes via the relevant support package.

The changes that come with this correction will include a switch of the HTMLB-design for the following applications:

- UAD_MAIN
- UAD_REG_CONSUM
- UAD_REG_CONSUMX
- UAD_REG_CONTPER
- UAD_CHG_BUPA
- UAD_CHG_BUPAX
- UAD_CHG_ORG_CP
- UAD_CHG_CONTPER

The design defines how the application is rendered. If the application was rendered with CLASSIC or DESIGN2002, it will now use DESIGN2003. There will be no impact on the functionality of your application. Switching to the new design is necessary due to compatibility reasons that were not fulfilled by CLASSIC and DESIGN2002.

**Support Packages**
- [BBPCRM 500 - SAPKU50021](https://me.sap.com/supportpackage/SAPKU50021)
- [BBPCRM 520 - SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011)
- [BBPCRM 600 - SAPKU60012](https://me.sap.com/supportpackage/SAPKU60012)
- [BBPCRM 700 - SAPKU70011](https://me.sap.com/supportpackage/SAPKU70011)
- [BBPCRM 701 - SAPKU70108](https://me.sap.com/supportpackage/SAPKU70108)
- [BBPCRM 702 - SAPKU70203](https://me.sap.com/supportpackage/SAPKU70203)

**References**
This document refers to:
- [1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [1582867 - Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)

This document is referenced by:
- [1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [1582867 - Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)

**Download and Print**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009839602017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001656918?language=en-US&token=6D9A1C9E273DA0054216FDB6A1718E1C)

**Corrections Info**
- Number of Correction Instructions: 6
- [View Correction Instructions](https://me.sap.com/corrins/0001656918/63)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*