1658759 - Directory traversal with unauthorized modification in BW

**SAP Security Note 1658759**

**Type:** SAP Security Note  
**Version:** 3  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 08.05.2012  
**Component:** SAP Business Warehouse > Business Explorer > Enduser Technology > BEx Web ABAP Runtime

---

### **Symptom**
BW-BEX-ET-WEB contains a vulnerability that allows a malicious user to read arbitrary files. This can be exploited to modify displayed application content without authorization and potentially obtain authentication information from other legitimate users.

### **Other Terms**
- Reflected Cross-Site Scripting (XSS)
- Directory Traversal
- BW-BEX-ET-WEB

### **Reason and Prerequisites**
Pages within BW-BEX-ET-WEB fail to correctly validate the URL path used to reference a file. As a result, a malicious user can direct the program to an arbitrary file in the system, leading to reflected XSS issues. This vulnerability can be used to deface or modify displayed content, steal user authentication information, and potentially allow impersonation of users, including administrators, thereby compromising application security.

### **Solution**
Implement the correction by updating the `HTTP_WHITELIST` table as described in [SAP Note 1594641](https://me.sap.com/notes/1594641) for an entry of type 01 for Portal CSS Theme-URL. If the provided stylesheet URL is not in the whitelist, an ABAP runtime error will be generated. Customers must add the allowed URLs for the stylesheet to the `HTTP_WHITELIST` table.

**Supported Versions and Support Packages:**

- **SAP NetWeaver BW 7.00**  
  Import Support Package 29 ([SAPKW70029](https://me.sap.com/supportpackage/SAPKW70029)).

- **SAP NetWeaver BW 7.01 (EHP 1)**  
  Import Support Package 12 ([SAPKW70112](https://me.sap.com/supportpackage/SAPKW70112)).

- **SAP NetWeaver BW 7.02 (EHP 2)**  
  Import Support Package 11 ([SAPKW70211](https://me.sap.com/supportpackage/SAPKW70211)).

- **SAP NetWeaver BW 7.11**  
  Import Support Package 10 ([SAPKW71110](https://me.sap.com/supportpackage/SAPKW71110)).

- **SAP NetWeaver BW 7.30**  
  Import Support Package 7 ([SAPKW73007](https://me.sap.com/supportpackage/SAPKW73007)).

- **SAP NetWeaver BW 7.31 (EHP 3)**  
  Import Support Package 3 ([SAPKW73103](https://me.sap.com/supportpackage/SAPKW73103)).

You can implement the note immediately using the correction instructions. Before proceeding, ensure you check [SAP Note 875986](https://me.sap.com/notes/875986) for transaction SNOTE.

**Actions:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009849292017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001658759?language=en-US&token=1C253294B39D7A8C66F7DFDEBF0CA6D6)

*Credits to [RedRays](https://redrays.io) for support in providing this information.*