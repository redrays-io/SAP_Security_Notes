1655428 - Unauthorized Modification in ITS-Service in PA-PA-KR

**Description**

**Symptom**
ITS services in application component PA-PA-KR can be abused by a malicious user, allowing them to modify displayed application content without authorization and potentially obtain authentication information from other legitimate users.

**Reason and Prerequisites**
ITS Services (PZ36, PZ38, PZ70, PZ81) within application component PA-PA-KR do not sufficiently encode OUTPUT parameters, resulting in a cross-site scripting (XSS) vulnerability. 

Cross-site scripting can be used to steal another user's authentication information, such as data related to their current session. A malicious user who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**
1. **Apply this SAP Security Note**:
   - **Download for SNOTE**: [https://notesdownloads.sap.com/note/0040000009830432017](https://notesdownloads.sap.com/note/0040000009830432017)
   - **PDF Version**: [https://userapps.support.sap.com/sap/support/sfm/notes/print/0001655428?language=en-US&token=D8FFC232E3D5D20F8683BB5C2DB0D702](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001655428?language=en-US&token=D8FFC232E3D5D20F8683BB5C2DB0D702)

2. **Import the Changes via the Relevant Support Package**:
   - **Support Packages**:
     - [Support Package SAPK-60082INSAPHRCKR](https://me.sap.com/supportpackage/SAPK-60082INSAPHRCKR)
     - [Support Package SAPK-60079INSAPHRCKR](https://me.sap.com/supportpackage/SAPK-60079INSAPHRCKR)
     - [Support Package SAPK-60448INSAPHRCKR](https://me.sap.com/supportpackage/SAPK-60448INSAPHRCKR)
     - [Support Package SAPK-60445INSAPHRCKR](https://me.sap.com/supportpackage/SAPK-60445INSAPHRCKR)

3. **Implement Prerequisite Notes**:
   - **Note 1621946**: [ITS: updated XSS-escaping functions](https://me.sap.com/notes/1621946)
   - **Note 1488500**: [ITS: automatically escape context fields in output](https://me.sap.com/notes/1488500)

4. **Run Manual Activities**:
   - **Execute Report**: Run the report `RITS_XSS_PARAM_PB41` manually after applying the correction instructions to fix the issue.
   - **Create Workbench Request**: Create the workbench request in order to run the report.

**References**
- [1621946 - ITS: updated XSS-escaping functions](https://me.sap.com/notes/1621946)
- [1488500 - ITS: automatically escape context fields in output](https://me.sap.com/notes/1488500)

**Credits**
Thanks to [RedRays](https://redrays.io) for supporting the provision of this information.