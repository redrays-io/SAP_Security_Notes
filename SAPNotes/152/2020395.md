2020395 - Sapinst used static salt for password encryption on UNIX / Linux

**SAP Security Note 2020395 Overview**

**Type:** SAP Security Note  
**Version:** 2  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 12.08.2014  
**Component:** Basis Components > Installation Tools (SAP Note 1669327) > sapinst, slcb, elmbridge, elm replication service

### Symptom
The constant string "R3" is used as a cryptographic salt for all operating system users created by SAPinst when the encrypted password is stored in:
- `/etc/passwd`
- `/etc/shadow`
- `/etc/security/passwd`

This reduces the effort an attacker has to spend to crack the users' passwords by a factor of 4096.

### Reason and Prerequisites
Some of these files are readable to non-privileged users and may become targets of an attack. The salt should make dictionary attacks more difficult and must be random.

### Solution
This problem was fixed in SAPinst patch **2013.12**. Now, the salt is generated from `/dev/urandom`.

**Mitigation Steps:**
1. **Reset Passwords:** As a minimum measure, customers should reset the passwords of the affected users using OS commands. This will generate new password hashes with new salts.
2. **Change Passwords if Compromised:** If there is suspicion that password hashes may have been compromised by non-privileged users, all passwords should be changed.

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017877612017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002020395?language=en-US&token=EFCB55A9B24CEF23FACBF47F10CE009B)
- [Share by Email](https://me.sap.com/notes/0002020395/share)
- [Open in New Window](https://me.sap.com/notes/0002020395/open)

For more details, visit the [SAP Security Notes](https://me.sap.com/notes/0002020395).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*