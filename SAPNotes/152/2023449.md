2023449 - Switchable authorization checks for RFC in FI, FI-AP-AP, FI-AR-AR, FI-BL-MD-BK

---

# SAP Security Note 2023449 Overview

**Title:** [2023449 - Switchable authorization checks for RFC in FI, FI-AP-AP, FI-AR-AR, FI-BL-MD-BK](https://me.sap.com/notes/2023449)

**Type:** SAP Security Note

**Status:** Released for Customer

**Components:** Financial Accounting > Accounts Receivable > Basic Functions

**Release Date:** 11.11.2014

**Category:** Program error

**Priority:** Correction with medium priority

---

## Symptom

This SAP note describes new switchable authorization checks for RFC function modules in function modules assigned to the components FI, FI-AP-AP, FI-AR-AR, FI-BL-MD-BK.

## Reason and Prerequisites

Remote calls to RFC function modules are protected by checks on the authorization object `S_RFC`. Authorizations for `S_RFC` must be limited to the required minimum for all users to ensure system security. Many RFC function modules can be sufficiently protected using `S_RFC` authorization checks. These RFC function modules often do not perform additional functional authorization checks. Please see [SAP Note 2008727](https://me.sap.com/notes/2008727) for further information on RFC Security.

It was identified that `S_RFC` authorization checks might not be sufficient to ensure secure execution for RFC function modules covered by this note. Activate new switchable authorization checks and update corresponding roles if these RFC function modules are included in `S_RFC` authorizations in your system.

## Solution

New switchable authorization checks have been implemented. The checks are delivered inactive to ensure compatibility with your running processes. The checks can be activated in transaction `SACF` as described in the attached manual correction instructions.

### New Authorization Scenarios

The following new authorization scenarios can be maintained in transaction `SACF` after implementation of this SAP note.

#### Scenario 1: FI_AR_CM_BAPI - Authorization Check for Credit Management BAPI

Used to secure external RFC requests regarding the credit status of credit accounts. Checks the authorization object `F_KNKA_KKB` with the respective credit control area and activity.

**Affected RFC Function Modules:**

- `BAPI_CREDIT_ACCOUNT_GET_STATUS`
- `BAPI_CREDIT_ACCOUNT_REP_STATUS`

#### Scenario 2: FI_AR_CUSTOMER_BAPI - Authorization Checks in a BAPI Scenario

Used to secure external RFC requests regarding the search of customer accounts. Checks the authorization object `F_KNA1_GEN` with activity `03` (Display).

**Affected RFC Function Modules:**

- `BAPI_DEBTOR_FIND`

#### Scenario 3: FI_DOC_READ - Display of an Accounting Document (RFC)

Secures external RFC requests regarding access to an FI document. Various authorization checks are performed.

**Affected RFC Function Modules:**

- `FI_DOCUMENT_READ`

#### Scenario 4: FIWT_READ_QSTRE_SPAIN - Read HR data from QSTRE table for FI reporting (Spain)

Secures external RFC requests regarding withholding tax information for HR DTA files. Checks the authorization object `F_BKPF_BUK` with activity `03` (Display).

**Affected RFC Function Modules:**

- `BF_READ_WITHHOLDING_SPAIN`

### Implementation Steps

Follow the post-processing activities below after technical implementation to activate the authorization checks.

1. **Create the Authorization Scenario Definition:**
   - Start transaction `SACF` in the development system and check if the relevant scenario definitions exist. If they do, proceed to step 2.
   - If the scenario definitions do not exist, download the file [Note_2023449_Scenarios.txt](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000735252014&iv_version=0001&iv_guid=3BD50E5D99DF1E469D2849C46820CABC).
   - Start transaction `SACF_TRANSFER`.
   - Select the "Upload" radio button, select work area "Scenario Definition", deselect work area "Productive Scenarios", deselect "Test Mode", and execute (F8).
   - Choose the uploaded file and confirm.
   - Assign the scenario definition to development package `FBAS`.

2. **Create the Productive Authorization Scenario:**
   - Start transaction `SACF` in the development system, select "Scenario Definition", select the "Scenario Name" as described above, and execute (F8).
   - Double-click on the scenario definition and press the "Scenario" button (or press F5) to transfer to a productive scenario.
   - Choose the initial scenario status "Active" or "Logging":
     - **Active:** Activates the authorization check and logging to Security Audit Log.
     - **Logging:** Activates logging to Security Audit Log with authorization checks always passing, useful for identifying users needing authorizations.

3. **Activate Logging of Security Audit Log:**
   - Ensure Security Audit Log is activated by checking transaction `SM19` → Environment → Profile parameter.
   - Create a new filter in the active, static Security Audit Log configuration. Select the following events via "Detailed configuration":
     - **Non-Critical:**
       - DUO (Authorization check success)
       - DUP (Authorization check failed)
     - **Critical:**
       - DUQ (Active scenario changed)
   - Activate the new filter.

4. **Adjust Roles:**
   - Use report `RSAU_SELECT_EVENTS` to identify users requiring new authorizations.
   - Analyze events `DUO` and `DUP`.
   - Authorization checks for productive authorization scenarios can also be analyzed using authorization system trace (transactions `STAUTHTRACE` or `ST01`).

## References

- [SAP Note 2078596 - Further improvements for RFC security](https://me.sap.com/notes/2078596)
- [SAP Note 2114012 - During the creation of payment medium files error FIBL 514](https://me.sap.com/notes/2114012)

## Attachments

- [Note_2023449_Scenarios.txt](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000735252014&iv_version=0001&iv_guid=3BD50E5D99DF1E469D2849C46820CABC) (2 KB)

---

**Credits:** Information provided by [Redrays.io](https://redrays.io).