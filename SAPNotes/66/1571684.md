1571684 - Protect against cross-site request forgery for ITSmobile Services

**SAP Security Note Overview**
- **Number:** 1571684
- **Type:** SAP Security Note
- **Version:** 5
- **Released On:** 13.12.2011
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer

**Description**
A cross-site request forgery (CSRF) is an attack on web applications. For detailed information about this attack, see the following [Wikipedia article](http://en.wikipedia.org/wiki/XSRF).

This SAP Note describes a generic protection mechanism that should protect the ITSmobile services from attacks of this kind. You must configure each of your user-defined ITS services as described below to activate the XSRF protection for user-defined ITS services that are not among the ITS services delivered by SAP.

For more information about XSRF protection in ITS services in general, see [Note 1481392 "Cross Site Request Forgery Protection for ITS"](https://me.sap.com/notes/1481392).

**Solution**
1. Import the relevant Basis Support Packages.
2. Use transaction SICF to set the GUI parameter `~XSRFCHECK` to `"1"` (without quotation marks) in your ITSmobile services.

**Prerequisites**
- [Note 1521808 - ITS: Follow-up tasks for XSRF framework](https://me.sap.com/notes/1521808)
- [Note 1552922 - SAP GUI for HTML: Minor corrections in the spring of 2011](https://me.sap.com/notes/1552922)

**Support Packages**
- [SAPKB64028 for SAP_BASIS 640](https://me.sap.com/supportpackage/SAPKB64028)
- [SAPKB70025 for SAP_BASIS 700](https://me.sap.com/supportpackage/SAPKB70025)
- [SAPKB70110 for SAP_BASIS 701](https://me.sap.com/supportpackage/SAPKB70110)
- [SAPKB70208 for SAP_BASIS 702](https://me.sap.com/supportpackage/SAPKB70208)
- [SAPKB71013 for SAP_BASIS 710](https://me.sap.com/supportpackage/SAPKB71013)
- [SAPKB71108 for SAP_BASIS 711](https://me.sap.com/supportpackage/SAPKB71108)
- [SAPKB72006 for SAP_BASIS 720](https://me.sap.com/supportpackage/SAPKB72006)
- [SAPKB73003 for SAP_BASIS 730](https://me.sap.com/supportpackage/SAPKB73003)
- [SAPKB73004 for SAP_BASIS 730](https://me.sap.com/supportpackage/SAPKB73004)

**Download and Print**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009323362017)
- [PDF Version](https://me.sap.com/userapps/support/sap/support/sfm/notes/print/0001571684?language=en-US&token=09E4139FF42D7270A1A8E478A5AE9CE0)

**Available Languages**
- [Deutsch (Origin)](https://me.sap.com/notes/0001571684/D)
- [日本語](https://me.sap.com/notes/0001571684/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001571684/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001571684/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001571684/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001571684/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001571684/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001571684/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001571684/3)

**References**
- **This document refers to:**
  - [Note 1892083 - Further coverage for SAP Note 1571684](https://me.sap.com/notes/1892083)
  - [Note 1708362 - SAP GUI for HTML: Correction instructions for SAP Note 1571684](https://me.sap.com/notes/1708362)
  - [Note 1597489 - Unauthorized use of application functions in SCM-EWM-RF](https://me.sap.com/notes/1597489)
  - [Note 1481392 - Cross Site Request Forgery Protection for ITS](https://me.sap.com/notes/1481392)

- **This document is referenced by:**
  - [Note 2716541 - WEBGUI: cookies and parameters](https://me.sap.com/notes/2716541)
  - [Note 1892083 - Further coverage for SAP Note 1571684](https://me.sap.com/notes/1892083)
  - [Note 1708362 - SAP GUI for HTML: Correction instructions for SAP Note 1571684](https://me.sap.com/notes/1708362)

**Corrections Information**
- **Number of Correction Instructions:** 5
- [View Correction Instructions](https://me.sap.com/corrins/0001571684/41)

**Side Effects**
This document is causing side effects on:
- [Note 1648397 - ITS: fixed template recycling](https://me.sap.com/notes/1648397)

For more details and to manage your SAP Notes, visit the [SAP Support Portal](https://me.sap.com/).

*Credits: Information provided with support from [redrays.io](https://redrays.io).*