SAP Security Note 1568817: Potential Modification or Disclosure of Persistent Data in FS-BA

**Overview**

SAP Security Note [1568817](https://notesdownloads.sap.com/note/0040000009305582017) addresses a critical SQL injection vulnerability in the Bank Analyzer (FS-BA) component. This vulnerability allows malicious users to manipulate database commands, potentially leading to unauthorized data retrieval or modification.

**Symptom**

A malicious user can exploit the FS-BA-AN-FSP module using specially crafted inputs to alter database statements. This can result in the retrieval of additional information or modification of data persisted by the system.

**Affected Component**

- **Software Component:** FSAPPL (Financial Services > Bank Analyzer)
- **Version:** 300

**Reason and Prerequisites**

The issue arises from an SQL injection vulnerability where the code constructs SQL statements with input strings that can be manipulated by a malicious user. This allows the attacker to modify the SQL statement to access or alter data.

**Solution**

Please install the provided correction via the support package or using the Note Assistant.

**Support Package Information**

- **Support Package:** SAPK-30009INFSAPPL
- **URL:** [SAP Support Package](https://me.sap.com/supportpackage/SAPK-30009INFSAPPL)

**Correction Instructions**

Manual activities are required to complete the correction. Follow these steps using transaction SE91 to create specific messages:

1. **Create Message in SE91**
    - **Message Class:** /BA1/B0_CMS
    - **Message Number:** 559
    - **Short Text:** Process is not allowed in productive clients
    - **Cause:** For the sake of security, it is not allowed to run this process in productive clients.
    - **Response:** Please use a dedicated customizing client. You can thereafter transport your changes to the productive client.
    - **System Admin Action:** Save and activate the message.

2. **Create Additional Messages**
    - **Message Number:** 560
        - **Short Text:** &1 does not belong to class C or E.
        - **Cause:** The Import and Export is only allowed for tables of class C or E.
        - **System Admin Action:** Save and activate the message.
    - **Message Number:** 561
        - **Short Text:** &1 does not belong to the correct namespace.
        - **Cause:** The only allowed prefixes are /BA1/TB0, /BA1/TB1, and /BA1/TB2.
        - **System Admin Action:** Save and activate the message.

For detailed instructions, refer to the [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001568817?language=en-US&token=DFA7210D068F6031447DCD510BBC1209).

**Release Information**

- **Released On:** July 12, 2011
- **Priority:** High (Correction with high priority)
- **Status:** Released for Customer

**CVSS Information**

- **CVSS Score:** 0
- **Details:** Not provided.

**Additional Resources**

- [SAP Support Portal](https://me.sap.com/)

*Credits to [https://redrays.io](https://redrays.io) for support to provided information.*