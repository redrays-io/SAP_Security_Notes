SAP Security Note 1571325: Potential disclosure of persisted data in test code

**Description**

A malicious user can exploit a function module initially designed for testing purposes by using specially crafted inputs to modify database commands. This can result in the retrieval of additional information persisted by the system.

**CVSS Information**

- **Base Score:** 3.5
- **Vector:** AV:N/AC:M/AU:S/C:P/I:N/A:N

*SAP provides this CVSS score as an estimate of the risk posed by the issue. It does not account for your specific system configuration or operational environment. Conduct your own risk assessments to determine the applicability or priority of this security note. More information can be found in the [FAQ section](https://me.sap.com/securitynotes/) on SAP’s security notes page.*

**Reason and Prerequisites**

The issue is caused by an SQL injection vulnerability. The code constructs an SQL statement that includes strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve data from the database.

**Solution**

Apply the corresponding corrections provided in this security note. 

**Important:** On systems with BASIS releases **≤ 6.40**, manual steps must be performed in addition to the automatic note implementation.

**Manual Actions:**

1. Call the function module named in the correction instruction using transaction SE37.
2. Go to the Attributes tab and set the processing type to "Normal Function Module".

**Support Packages**

Ensure that you apply the appropriate support packages for your SAP_APPL version:

- [SAPKH46B62](https://me.sap.com/supportpackage/SAPKH46B62) for SAP_APPL 46B
- [SAPKH46C62](https://me.sap.com/supportpackage/SAPKH46C62) for SAP_APPL 46C
- [SAPKH47036](https://me.sap.com/supportpackage/SAPKH47036) for SAP_APPL 470
- [SAPKH50025](https://me.sap.com/supportpackage/SAPKH50025) for SAP_APPL 500
- [SAPKH60020](https://me.sap.com/supportpackage/SAPKH60020) for SAP_APPL 600
- [SAPKH60210](https://me.sap.com/supportpackage/SAPKH60210) for SAP_APPL 602
- [SAPKH60309](https://me.sap.com/supportpackage/SAPKH60309) for SAP_APPL 603
- [SAPKH60410](https://me.sap.com/supportpackage/SAPKH60410) for SAP_APPL 604
- [SAPKH60505](https://me.sap.com/supportpackage/SAPKH60505) for SAP_APPL 605

**Correction Instructions**

Apply the correction instruction [here](https://me.sap.com/corrins/0001571325/1).

**Prerequisites**

- **Software Component:** SAP_APPL
- **Valid From:** 46B
- **Valid To:** 605
- **SAP Note/KBA:** [1571325](https://me.sap.com/notes/1571325)
- **Title:** Potential disclosure of persisted data in test code
- **Component:** CO-PC

**Additional Information**

- **Released On:** 10.05.2011
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Category:** Program error

For more details and to download the note, visit the following links:

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009321192017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001571325?language=en-US&token=32C6B59ED3E8D6B586319607E9F53B37)

**Credits**

Information provided with support from [Red Rays](https://redrays.io).