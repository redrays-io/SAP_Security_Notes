SAP Security Note 1484692 - Protect read access to password hash value tables

**Overview**

SAP Security Note [1484692](https://me.sap.com/notes/1484692) addresses a critical vulnerability where insufficient authority checks may allow unauthorized read access to tables containing password hash values. This can potentially be exploited to perform password hash attacks.

**Details**

- **Type:** SAP Security Note
- **Priority:** Correction with High Priority
- **Status:** Released for Customer
- **Released On:** December 2, 2011
- **Affected Components:** BC-SEC-LGN (Authentication) and related components

**Symptom**

Insufficient authority checks may permit read access to tables that store password hash values. This vulnerability can be leveraged to perform password hash attacks, compromising the security of user credentials.

**Solution**

To mitigate this vulnerability, you can either install the assigned support package or implement the correction manually by following these steps:

1. **Create a New Authorization Group**

   - **Transaction:** SE54
   - **Steps:**
     1. Call transaction SE54.
     2. Set the radio button to "Authorization Groups".
     3. Press the "Create/Change" button.
     4. Create a new entry with the following values:
        - **Authorization Group (AuGr):** SPWD
        - **Description:** Password Hash Values
     5. Save the new record (a transport request is required).

2. **Assign Authorization Groups to Relevant Tables**

   - **Transaction:** SE11
   - **Steps:**
     1. Call transaction SE11 and display table `USH02`.
     2. Navigate via the menu: `Utilities` -> `Assign Authorization Group`.
     3. Change the existing value in the "Authorization" column to `SPWD`. If there is no entry, create one to assign the authority group `SPWD` to the table.
     4. Save the changes. If the message "Choose the key from the allowed namespace" appears, press Enter to continue.
     5. Repeat this step for all relevant tables listed below.

   **List of Tables/Views:**
   - USH02 (all releases)
   - USH02_ARC_TMP (release 6.20 and later)
   - USR02 (all releases)
   - USRPWDHISTORY (release 7.00 and later)
   - VUSER001 (release 4.5B and later)
   - VUSR02_PWD (release 7.10 and later)

3. **Verify Your Authorization Concept**

   Ensure that no user has generic access to tables with the authorization group `SPWD`.

   - **Report:** RSUSR002
   - **Steps:**
     1. Start the report RSUSR002.
     2. Enter authorization object `S_TABU_DIS` in the "Selection by values" frame.
     3. Add the value `SPWD` in the search field for the authorization group.
     4. Run the report to check for unauthorized access.
     5. Use SUIM reports to identify and adjust responsible roles or profiles as necessary.

**Download the Note**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008785192017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001484692?language=en-US&token=53FC7842D8FB92FBC81BC729A6D4EC85)

**References**

This document refers to:

- [1504652 - Consulting: Secure Configuration of Application Server ABAP](https://me.sap.com/notes/1504652)
- [1485029 - Protect read access to key tables](https://me.sap.com/notes/1485029)
- [1237762 - ABAP systems: Protection against password hash attacks](https://me.sap.com/notes/1237762)

**Credits**

Information provided with support from [Redrays.io](https://redrays.io).