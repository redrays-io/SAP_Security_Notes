1484089 - Code injection vulnerability in Condition Mapping Program

# Description

## Symptom
Two function modules for condition data exchange (between ERP and CRM systems) contain code that allows the execution of arbitrary program code of the user's choice. A malicious user can control the system's behavior or potentially escalate privileges by executing malicious code without legitimate credentials. The programs cannot be called externally.

## Other Terms
Backdoor, injection, run, credentials, Condition Data Exchange

## Reason and Prerequisites
The program code allows the definition and execution of user-supplied code, which changes the system's behavior. A valid and authenticated SAP CRM user is required. Depending on the injected code, the user can:
- Inject and run their own code
- Obtain additional information not intended for display
- Modify or delete data
- Alter system output
- Create new users with higher privileges
- Perform a denial of service attack

The reports were used in CRM 3.0A release but became obsolete with CRM 4.0. Report generation is no longer required.

# Solution
1. **Stop Unnecessary Report Generation:** Unnecessary report generation has been halted.
2. **Add Authorization Checks:** Authorization checks have been added to the program where report generation is still required. Only users with condition generation authorization (authority object `/SAPCND/CO` with activity `64` for generation) can execute the program to generate report `CND_MAP_DYN_GET_LIN`.

# Affected Components
- **Component:** Customer Relationship Management > Master Data > Condition Technique > Exchange of Condition Records and Customizing Data (CRM-MD-CON-IF)
- **Relevant Versions:**
  - BBPCRM 400
  - BBPCRM 500
  - BBPCRM 520
  - BBPCRM 600
  - BBPCRM 700
  - BBPCRM 701

# Support Packages
| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| BBPCRM 400                 | [SAPKU40018](https://me.sap.com/supportpackage/SAPKU40018) | [Link](https://me.sap.com/supportpackage/SAPKU40018) |
| BBPCRM 500                 | [SAPKU50018](https://me.sap.com/supportpackage/SAPKU50018) | [Link](https://me.sap.com/supportpackage/SAPKU50018) |
| BBPCRM 520                 | [SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011) | [Link](https://me.sap.com/supportpackage/SAPKU52011) |
| BBPCRM 600                 | [SAPKU60009](https://me.sap.com/supportpackage/SAPKU60009) | [Link](https://me.sap.com/supportpackage/SAPKU60009) |
| BBPCRM 700                 | [SAPKU70009](https://me.sap.com/supportpackage/SAPKU70009) | [Link](https://me.sap.com/supportpackage/SAPKU70009) |
| BBPCRM 701                 | [SAPKU70102](https://me.sap.com/supportpackage/SAPKU70102) | [Link](https://me.sap.com/supportpackage/SAPKU70102) |

# Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008781412017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001484089?language=en-US&token=0C9E2F9F50B700AE7E09A7112716AC0F)

# References
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001484089) *(Visible only to authorized users)*

# Available Translations
- [Japanese](https://me.sap.com/notes/0001484089/J)
- [Deutsch](https://me.sap.com/notes/0001484089/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0001484089/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001484089/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001484089/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001484089/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001484089/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001484089/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001484089/3)

# Credits
Information supported by [RedRays](https://redrays.io).