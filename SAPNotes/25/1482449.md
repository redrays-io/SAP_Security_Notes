1482449 - Potential disclosure and modification of persisted data

**SAP Security Note 1482449** addresses a critical SQL injection vulnerability in the IPM Mass Change database batch data loading reports within CRM 7.01. This vulnerability allows malicious users to execute arbitrary database commands to retrieve, modify, or remove persisted data.

### **Details**

- **Type:** SAP Security Note
- **Version:** 4
- **Category:** Program Error
- **Priority:** Correction with High Priority
- **Status:** Released for Customer
- **Released On:** December 14, 2010
- **Component:** Customer Relationship Management > Media > Intellectual Property Management

### **Symptom**

A malicious user can exploit the IPM Mass Change database batch data loading reports by using specially crafted inputs. This exploitation can lead to the execution of arbitrary SQL commands, enabling the retrieval, modification, or deletion of data persisted by the system.

### **Cause**

The vulnerability is caused by an SQL injection flaw. The application composes SQL statements that include user-controllable strings without proper sanitization, allowing attackers to manipulate the SQL queries.

### **Solution**

To mitigate this vulnerability, assign the affected reports to an authorization group (`MC_ADMIN`) and implement the provided correction instructions. This limits access to authorized administrators only, thereby preventing unauthorized exploitation.

### **Correction Instructions**

1. **Launch Transaction SM30:**
   - Input `TPGP` in the 'Table/View' field.
   - Click on the 'Maintain' button.
  
2. **Add Authorization Group:**
   - Add a new row with the following details:
     - **Appl:** `R`
     - **P_group:** `MC_ADMIN`
     - **Text for auth group:** `IPM Mass Change database admin`
   - Click 'Save' to apply changes.
  
3. **Update Programs:**
   - Launch transaction SE38.
   - Input `CRM_MASS_DB_DOWNLOAD` in the 'Program' field.
   - Select 'Attributes' in the radio button group 'Subobjects'.
   - Click on 'Change'.
   - Input `MC_ADMIN` in the 'Authorization Group' field.
   - Click 'Save'.
   - Repeat the above steps for the program `CRM_MASS_DB_UPLOAD`.

For detailed instructions, refer to the [Correction Instructions](https://me.sap.com/corrins/0001482449/63).

### **Download and Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008771312017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001482449?language=en-US&token=CC1D66FA817C2100C6D1F840D3D881F2)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001482449)
- [Support Package SAPKU70102](https://me.sap.com/supportpackage/SAPKU70102)

### **Credits**

Credits to [redrays.io](https://redrays.io) for support in providing this information.