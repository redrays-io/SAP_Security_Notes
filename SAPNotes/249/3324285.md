3324285 - [CVE-2023-33991] Stored Cross-Site Scripting vulnerability in SAP UI5 (Variant Management)

## Symptom

**UPDATE 27th June 2023**: This note has been re-released with updated 'Solution' information.

UI5 Variant Management does not sufficiently encode user-controlled inputs when reading data from the server, resulting in a Stored Cross-Site Scripting (Stored XSS) vulnerability. After successful exploitation, an attacker with user-level access can cause significant impact on confidentiality, modify information, and potentially cause unavailability of the application at the user level.

## Other Terms

- XSS
- Stored XSS
- CSS
- [CVE-2023-33991](https://www.cve.org/CVERecord?id=CVE-2023-33991)

## Reason and Prerequisites

- The storage used in combination with UI5 Variant Management may not prevent scripts from being stored and read.
- The frontend loads data from storage without validating for scripts.

## Solution

Invalid parameters (expressions) will now result in the expression binding being stopped and no longer executed.

### Minimum SAPUI5 Patches Containing the Fix:

| SAP_UI | SAPUI5    |
|--------|-----------|
| 750    | 1.38.61   |
| 754    | 1.71.56   |
| 755    | 1.84.34   |
| 756    | 1.96.21   |
| 757    | 1.108.13  |

SAP_UI 758 receives the fix by default.

## CVSS

**CVSS Score:** 8.2  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:L](https://www.first.org/cvss/calculator/3.0)

**Details:**

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

## Affected Software Components

| Software Component | From | To   |
|---------------------|------|------|
| SAP_UI             | 750  | 750  |
| SAP_UI             | 754  | 754  |
| SAP_UI             | 755  | 755  |
| SAP_UI             | 756  | 756  |
| SAP_UI             | 757  | 757  |
| UI_700             | 200  | 200  |

## References

- [ABAP SAPUI5 Patch Version Update](https://me.sap.com/notes/3155948)

## Additional Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000702742023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003324285?language=en-US&token=F6AE6888BBD6333BCC064F48E7B5C8A5)
- [Show Changes](https://me.sap.com/notesLatestChanges/0003324285/E/diff)

## Credits

Information provided by [RedRays](https://redrays.io).