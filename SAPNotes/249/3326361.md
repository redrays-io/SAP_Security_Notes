SAP Security Note 3326361 - Missing Authorization Check in Manage Purchase Contracts App

**Summary**

SAP has released Security Note [3326361](https://me.sap.com/notes/3326361) addressing a vulnerability identified as [CVE-2023-40625](https://www.cve.org/CVERecord?id=CVE-2023-40625). The issue pertains to missing authorization checks in the Manage Purchase Contracts App, which could allow authenticated users to perform unauthorized actions, potentially leading to privilege escalation.

**Details**

- **Vulnerability:** Missing authorization checks in the Manage Purchase Contracts App.
- **Impact:** Low impact on confidentiality and integrity, no impact on system availability.
- **CVSS Score:** 5.4 (Medium)
  - **Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N)

**Affected Components**

- **Component:** MM-FIO-PUR-SQ-CON
- **Software Components Versions:** S4CORE 102 to 107

**Solution**

1. **Implement Correction Instructions:**
   - Follow the correction instructions provided in [SAP Security Note 3326361](https://me.sap.com/notes/3326361).
   - This includes adding the necessary authorization checks to the relevant ODATA services.

2. **Apply Support Packages:**
   - Ensure that the appropriate support packages for your S4CORE version are installed. For example:
     - [S4CORE 102 - SAPK-10213INS4CORE](https://me.sap.com/supportpackage/SAPK-10213INS4CORE)
     - [S4CORE 103 - SAPK-10311INS4CORE](https://me.sap.com/supportpackage/SAPK-10311INS4CORE)
     - *(Refer to the security note for the complete list of support packages.)*

3. **Additional Note:**
   - After implementing this security note, apply [SAP Note 3364039](https://me.sap.com/notes/3364039) to resolve a backend runtime error that occurs during the creation of a purchase contract.

**Prerequisites**

Before applying Security Note 3326361, ensure the following notes are implemented:

- [2605160](https://me.sap.com/notes/2605160) - Technical extension of view models as preparation for future functional enhancements.
- [2762983](https://me.sap.com/notes/2762983) - Manage Purchase Contracts: Header and Item Notes saved duplicated.
- [2711184](https://me.sap.com/notes/2711184) - Item text is not fetched even if the text is maintained in the customizing.
- [3286873](https://me.sap.com/notes/3286873) - Change documents are not created when texts are updated from Manage Purchase Contracts Fiori App.

**References**

- [Security Note 3326361](https://me.sap.com/notes/3326361)
- [CVE-2023-40625](https://www.cve.org/CVERecord?id=CVE-2023-40625)
- [SAP Note 3364039](https://me.sap.com/notes/3364039)

**Credit**

Credits to [Redrays.io](https://redrays.io) for supporting information provided.