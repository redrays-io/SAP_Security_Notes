SAP Security Note 3327896 - [CVE-2023-40308] Memory Corruption Vulnerability in SAP CommonCryptoLib

**Symptom**
  
SAP CommonCryptoLib allows an unauthenticated attacker to craft a request, which when submitted to an open port causes a memory corruption error in a library. This in turn causes the target component to crash, making it unavailable. There is no ability to view or modify any information.

**Other Terms**

Buffer overflow, heap overflow, memory leaks, dangling pointers, null pointer dereferences, [CVE-2023-40308](https://www.cve.org/CVERecord?id=CVE-2023-40308)

**Reason and Prerequisites**

A manipulated data package with a corrupted SNC NAME ASN.1 structure can lead to a parser error and a crash of the application.

**Solution**

1. **Download and Install CommonCryptoLib 8.5.49 or Higher:**
   - Correct the issue on your system by upgrading to CommonCryptoLib version 8.5.49 or higher.

2. **Updating Components:**
   - The corrected version of CommonCryptoLib is delivered as part of various components mentioned in the **Software Components** section of this note.
   - By updating these components, the corrected version is automatically implemented.

3. **Component-Specific Instructions:**
   - **SAP NetWeaver AS ABAP & AS Java, ABAP Platform of S/4HANA On-Premise:**
     - Implement the respective kernel version, either the SP Stack Kernel or the hotfix patch via `dw_utils.sar`.
     - **Recommendation for Kernel Updates:**
       - Apply the latest SP Stack Kernel if it contains the correction. Refer to [SAP Note 2083594](https://me.sap.com/notes/2083594) for the list of current SP Stack Kernels.
       - Alternatively, apply the hotfix `dw_utils.sar` for immediate correction.

   - **SAPSSOEXT:**
     - Apply patch 18 or higher. Details available in [SAP Note 3348979](https://me.sap.com/notes/3348979).

   - **SAP Web Dispatcher:**
     - Implement at least the patch level listed in the "Support Package Patches" section for your release. Refer to [SAP Note 908097](https://me.sap.com/notes/908097).

   - **SAP Host Agent:**
     - Implement patch level 61 or higher. Refer to [SAP Note 3330927](https://me.sap.com/notes/3330927).

   - **SAP Content Server:**
     - Implement SAP Content Server 7.53 patch level 1214 or higher or SAP Content Server 7.54 patch level 200 or higher.
     - The corrected CommonCryptoLib version is also available with SAP Content Server 6.50 patch level 12 and higher. It is recommended to upgrade to SAP Content Server 7.53 or 7.54.
     - Details available in [SAP Note 719971](https://me.sap.com/notes/719971).

   - **SAP HANA Database:**
     - Implement SAP HANA Database 2.0 with the following revisions or newer:
       - SPS 05: Revision 2.00.059.10 ([SAP Note 3346036](https://me.sap.com/notes/3346036))
       - SPS 06: Revision 2.00.067.02 ([SAP Note 3332084](https://me.sap.com/notes/3332084))
       - SPS 07: Revision 2.00.071.00 ([SAP Note 3318727](https://me.sap.com/notes/3318727))

   - **SAP Extended Application Services and Runtime (XSA):**
     - Implement SP01 PL 3 or higher. Details in [SAP Note 3347041](https://me.sap.com/notes/3347041).

**No Workaround or Mitigation Available**

There is no workaround or mitigation available for this vulnerability.

**CVSS Score**

- **Score:** 7.5
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** None
  - **User Interaction:** None
  - **Scope:** Unchanged
  - **Confidentiality Impact:** None
  - **Integrity Impact:** None
  - **Availability Impact:** High

For more detailed information, please refer to the full SAP Security Note [3327896](https://me.sap.com/notes/3327896).

*Credits to [redrays.io](https://redrays.io) for supporting information.*