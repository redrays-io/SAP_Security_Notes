3324732 - [CVE-2023-31405] Log Injection vulnerability in SAP NetWeaver AS for Java (Log Viewer)

## Symptom

**UPDATE 09th January 2024:**  
This note has been re-released with minor textual changes in the 'Solution' section. There have not been any changes done which require customer action.

**UPDATE 10th October 2023:**  
The solution provided in this note is incomplete for the component ENGINEAPI 7.50. For the complete fix please implement the SAP security note [3371873](https://me.sap.com/notes/3371873)

SAP NetWeaver AS for Java allows an unauthenticated attacker to craft a request over the network which can result in unwarranted modifications to a system log without user interaction. However, this has no effect on the application's availability or confidentiality.

## Other Terms

Log Injection, Escaping symbols, [CVE-2023-31405](https://www.cve.org/CVERecord?id=CVE-2023-31405)

## Reason and Prerequisites

End of line (EOL) symbols are not escaped and input is not validated.

## Solution

- **Input Validation:** User input is validated against the default security policy of the UME and an encoding of the input is added.
- **Update Recommendation:**  
  Update AS Java to a release or SP where the problem is fixed. See the "Validity" and "Support Packages & Patches" sections of this SAP Note for details and available patches.  
  To avoid incompatibilities on the system, please check SAP Note [1974464](https://me.sap.com/notes/1974464) - Information on SCA Dependency Analysis for Java download objects

## CVSS

**CVSS Score:** 5.3  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/application)  
- **Attack Vector (AV):** Network (N)  
- **Attack Complexity (AC):** Low (L)  
- **Privileges Required (PR):** None (N)  
- **User Interaction (UI):** None (N)  
- **Scope (S):** Unchanged (U)  
- **Confidentiality Impact (C):** None (N)  
- **Integrity Impact (I):** Low (L)  
- **Availability Impact (A):** None (N)

## References

- [SAP Note 1974464 - Information on SCA Dependency Analysis for Java download objects](https://me.sap.com/notes/1974464)
- This document is referenced by [SAP Note 3371873](https://me.sap.com/notes/3371873) - Update 1 to Security Note 3324732: [CVE-2023-31405] Log Injection vulnerability in SAP NetWeaver AS for Java (Log Viewer)

## Support Package Patches

| Software Component Version                   | Support Package | Patch Level | URL                                                                                                                                                      |
|----------------------------------------------|-----------------|-------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| ENGINEAPI 7.50                               | SP028           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP028&patch_level=000000)                                    |
| J2EE ENGINE SERVERCORE 7.50                  | SP029           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP029&patch_level=000000)                                    |
| ENGINEAPI 7.50                               | SP029           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP029&patch_level=000000)                                    |
| J2EE ENGINE APPLICATIONS 7.50                 | SP029           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP029&patch_level=000000)                                    |
| J2EE ENGINE APPLICATIONS 7.50                 | SP022           | 000016      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP022&patch_level=000016)                                    |
| J2EE ENGINE APPLICATIONS 7.50                 | SP023           | 000014      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP023&patch_level=000014)                                    |
| J2EE ENGINE APPLICATIONS 7.50                 | SP025           | 000008      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP025&patch_level=000008)                                    |
| ENGINEAPI 7.50                               | SP022           | 000010      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP022&patch_level=000010)                                    |
| ENGINEAPI 7.50                               | SP023           | 000007      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP023&patch_level=000007)                                    |
| ENGINEAPI 7.50                               | SP025           | 000007      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP025&patch_level=000007)                                    |
| J2EE ENGINE SERVERCORE 7.50                  | SP022           | 000035      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP022&patch_level=000035)                                    |
| J2EE ENGINE SERVERCORE 7.50                  | SP023           | 000026      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP023&patch_level=000026)                                    |
| J2EE ENGINE SERVERCORE 7.50                  | SP025           | 000017      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP025&patch_level=000017)                                    |
| J2EE ENGINE APPLICATIONS 7.50                 | SP026           | 000003      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP026&patch_level=000003)                                    |
| J2EE ENGINE APPLICATIONS 7.50                 | SP027           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP027&patch_level=000001)                                    |
| ENGINEAPI 7.50                               | SP026           | 000006      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP026&patch_level=000006)                                    |
| J2EE ENGINE SERVERCORE 7.50                  | SP026           | 000009      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP026&patch_level=000009)                                    |
| J2EE ENGINE APPLICATIONS 7.50                 | SP021           | 000023      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP021&patch_level=000023)                                    |
| ENGINEAPI 7.50                               | SP021           | 000014      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP021&patch_level=000014)                                    |
| J2EE ENGINE SERVERCORE 7.50                  | SP021           | 000043      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP021&patch_level=000043)                                    |
| ENGINEAPI 7.50                               | SP027           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP027&patch_level=000001)                                    |
| J2EE ENGINE SERVERCORE 7.50                  | SP027           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP027&patch_level=000001)                                    |
| J2EE ENGINE APPLICATIONS 7.50                 | SP024           | 000014      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP024&patch_level=000014)                                    |
| ENGINEAPI 7.50                               | SP024           | 000006      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP024&patch_level=000006)                                    |
| J2EE ENGINE SERVERCORE 7.50                  | SP024           | 000018      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP024&patch_level=000018)                                    |
| J2EE ENGINE SERVERCORE 7.50                  | SP028           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP028&patch_level=000000)                                    |
| J2EE ENGINE APPLICATIONS 7.50                 | SP028           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP028&patch_level=000000)                                    |

## Side Effects

This document is causing side effects:  
- [3371873 - Update 1 to Security Note 3324732:](https://me.sap.com/notes/3371873) [CVE-2023-31405] Log Injection vulnerability in SAP NetWeaver AS for Java (Log Viewer)

---

*Credits to [redrays.io](https://redrays.io) for support to provided information.*