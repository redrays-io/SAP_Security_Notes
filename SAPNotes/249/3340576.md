SAP Security Note 3340576 - [CVE-2023-40309] Missing Authorization check in SAP CommonCryptoLib

```markdown
**SAP Security Note 3340576 - [CVE-2023-40309] Missing Authorization check in SAP CommonCryptoLib**

**Type:** SAP Security Note  
**Version:** 12  
**Released On:** 24.10.2023  
**Component:** Basis Components > Identity and Access Management > SAP Single Sign-On > CommonCryptoLib  

### **Description**
**Symptom:**  
SAP CommonCryptoLib does not perform necessary authentication checks, potentially allowing missing or incorrect authorization checks for authenticated users. This may result in privilege escalation, enabling attackers to abuse restricted functionalities and access, modify, or delete sensitive data.

**Reason and Prerequisites:**  
The verification of JavaScript Web Tokens (JWT) and raw signatures may fail, leading to incorrect authorization checks in the calling application.

### **Solution**
- **Download and Install:**  
  Download and install CommonCryptoLib version 8.5.50 or higher [here](https://notesdownloads.sap.com/note/0040000001088962023).

- **Component-Specific Instructions:**  
  - **SAP NetWeaver AS ABAP, SAP NetWeaver AS Java, ABAP Platform of S/4HANA on-premise:**  
    Implement the respective kernel version or the hotfix patch via dw_utils.sar. Details available in [SAP Note 2083594](https://me.sap.com/notes/2083594).

  - **SAP Web Dispatcher:**  
    Update to at least the patch level listed in the "Support Package Patches" section of this note. Refer to [SAP Note 908097](https://me.sap.com/notes/908097).

  - **SAP Host Agent:**  
    Apply patch level 61 or higher as per [SAP Note 3330927](https://me.sap.com/notes/3330927).

  - **SAP Content Server:**  
    Implement SAP Content Server 7.53 patch level 1214 or higher, or SAP Content Server 7.54 patch level 200 or higher. More details in [SAP Note 719971](https://me.sap.com/notes/719971).

  - **SAP HANA Database:**  
    Implement SAP HANA Database 2.0 with revision SPS 05 or newer. Refer to [SAP Note 3332084](https://me.sap.com/notes/3332084) and [SAP Note 3318727](https://me.sap.com/notes/3318727).

  - **SAP Extended Application Services and Runtime (XSA):**  
    Apply SP01 PL 3 or higher as per [SAP Note 3347041](https://me.sap.com/notes/3347041).

**Note:** There is no workaround or mitigation available.

**CVSS Score:** 9.8 (Critical)  
**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H  

For more details, refer to the [SAP Security Note 3340576](https://me.sap.com/notes/3340576).

---

*Credits: Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.*
```