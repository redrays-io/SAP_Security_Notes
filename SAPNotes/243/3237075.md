SAP Security Note 3237075 - [CVE-2022-39801] Insufficient Firefighter Session Expiration in SAP GRC Access Control Emergency Access Management

**Overview**

**CVE-2022-39801** - *Insufficient Firefighter Session Expiration in SAP GRC Access Control Emergency Access Management*

**Description**

**Symptom**
SAP GRC Access Control Emergency Access Management allows an authenticated attacker to access a Firefighter session even after it is closed in Firefighter Logon Pad. This attack can only be launched within the firewall. On successful exploitation, the attacker can gain access to an admin session and completely compromise the application.

**Other Terms**
- Web-based
- Firefighter
- Stateless
- Security
- Session
- EAM
- AC 12.0
- [CVE-2022-39801](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-39801)

**Reason and Prerequisites**
GRC detects user sessions using SM04 information. Stateless Security Sessions are only visible here. If they are not idle or if some other functionality (like SAP Gateway Soft State) keeps them alive, GRC does not detect them.

**Solution**
Implement the correction instruction for all plugin systems where Web-Based Firefighter is used. With this correction, the Firefighter Session will be detected using SM04 and SM05 information. To properly retrieve the SM05 data, the RFC user needs to be assigned the following authorization object:
- **Authorization Object:** `S_ADMI_FCD`
- **ID:** `S_ADMI_FCD`
- **Field:** `PADM`

**Minimum Version Requirement:** SAP NetWeaver Enhancement Package 2 for 7.0 Support Package Stack 00. Below this, the correction has no effect, and upgrading your SAP Basis level is recommended.

**Performance Impact:** This correction may result in slight performance degradation in the Firefighter Logon Pad in the central system. Depending on the number of active Security Sessions, retrieving the information may take more time. This affects only the central system.

**Workaround**
No workaround exists.

**CVSS Details**

- **Score:** 7.1
- **Vector:** [CVSS:3.0/AV:A/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS%3A3.0%2FAV%3AA%2FAC%3AH%2FPR%3AL%2FUI%3AN%2FS%3AU%2FC%3AH%2FI%3AH%2FA%3AH)

**Affected Software Components**

| Software Component | From        | To          |
|--------------------|-------------|-------------|
| GRCPINW            | V1100_700   | V1100_700   |
| GRCPINW            | V1100_731   | V1100_731   |
| GRCPINW            | V1200_750   | V1200_750   |

**Support Packages**

- [SAPK-11328INGRCPINW](https://me.sap.com/supportpackage/SAPK-11328INGRCPINW) for GRCPINW V1100_700
- [SAPK-11529INGRCPINW](https://me.sap.com/supportpackage/SAPK-11529INGRCPINW) for GRCPINW V1100_731
- [SAPK-V1219INGRCPINW](https://me.sap.com/supportpackage/SAPK-V1219INGRCPINW) for GRCPINW V1200_750

**Correction Instructions**

| Software Component | Number of Correction Instructions | URL                                      |
|--------------------|-----------------------------------|------------------------------------------|
| GRCPINW            | 2                                 | [Correction Instructions](https://me.sap.com/corrins/0003237075/9800) |

**Translations**
Available in multiple languages:
- [Deutsch](https://me.sap.com/notes/0003237075/D)
- [日本語](https://me.sap.com/notes/0003237075/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003237075/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003237075/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003237075/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003237075/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003237075/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003237075/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003237075/3)

**Side Effects**
This document solves side effects; no side effects are caused by this document.

**Credits**
Information provided with support from [redrays.io](https://redrays.io).