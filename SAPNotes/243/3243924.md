3243924 - [CVE-2022-41203] Insecure Deserialization of Untrusted Data in SAP BusinessObjects Business Intelligence Platform (Central Management Console and BI Launchpad)

### Symptom

**UPDATE 10th January 2023**: This note has been re-released with updated workaround information in the 'solution' section.

In some workflows of SAP BusinessObjects BI Platform (Central Management Console and BI LaunchPad), an authenticated attacker with low privileges can intercept a serialized object in the parameters and substitute it with a malicious serialized one. This leads to a deserialization of untrusted data vulnerability, which can severely compromise the Confidentiality, Integrity, and Availability of the system.

### Other Terms

Deserialization, [CVE-2022-41203](https://www.cve.org/CVERecord?id=CVE-2022-41203)

### Reason and Prerequisites

There is no verification in the deserialization process.

### Solution

In the deserialization process, only specific internal classes are allowed. This issue is fixed in the patches listed in the **Support Packages & Patches** section below.

For Business Intelligence Platform maintenance schedule and strategy, see the Knowledge Base Article [2144559](https://me.sap.com/notes/2144559) in the References section.

#### Workaround

Please assess the workaround applicability for your SAP landscape prior to implementation. Note that this workaround is a temporary fix and is not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.

To mitigate the issue, remove the code related to the Format during the creation of Publication/Schedule:

1. **Stop Tomcat**
2. **Backup Files:**
   - Save all files from the following folders to another location:
     - `<tomcat folder>\**webapps**\BOE\WEB-INF\eclipse\plugins\webpath.AnalyticalReporting\web\jsp\Webi_DestinationFormat`
     - `<tomcat folder>\**webapps**\BOE\WEB-INF\eclipse\plugins\webpath.AnalyticalReporting\web\jsp\Webi_Format`
3. **Remove Files:**
   - After ensuring files are backed up, remove them from the two folders mentioned above.
4. **Clear Work Directory:**
   - Remove all files from the following directories:
     - `<tomcat folder>\**work**\Catalina\localhost\BOE\eclipse\plugins\webpath.AnalyticalReporting\web\jsp\Webi_DestinationFormat`
     - `<tomcat folder>\**work**\Catalina\localhost\BOE\eclipse\plugins\webpath.AnalyticalReporting\web\jsp\Webi_Format`
5. **Restart Tomcat**

**Note:** This workaround will generate 404 errors for the format page in:
- Central Management Console (CMC) and BI Launchpad (BILP) in version 4.2
- Only Central Management Console (CMC) in version 4.3

For more information on this vulnerability and the workaround, please see:  
[3250938 - Q&A for SAP Security Note 3243924 (CVE-2022-41203)](https://me.sap.com/notes/3250938)

### CVSS

**CVSS Score:** 9.9  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

### Affected Components

- BI-RA-WBI-FE

### Support Package Patches

- **SBOP BI PLATFORM SERVERS 4.3**
  - SP003: [Patch Details](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)
  - SP002: [Patch Details](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)
- **SBOP BI PLATFORM SERVERS 4.2**
  - SP009: [Patch Details](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)

### References

- [3250938 - Q&A for SAP Security Note 3243924 (CVE-2022-41203)](https://me.sap.com/notes/3250938)
- [2144559 - BI 4.x Maintenance Strategy & Schedule](https://me.sap.com/notes/2144559)

**Credits:** Special thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.