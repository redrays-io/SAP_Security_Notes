3242933 - [CVE-2022-39802] File path traversal vulnerability in SAP Manufacturing Execution

**SAP Security Note 3242933** has been released addressing a critical vulnerability (CVE-2022-39802) in SAP Manufacturing Execution. Here's a summary of the key details:

### **Symptom**
SAP Manufacturing Execution allows an attacker to exploit insufficient validation of a file path request parameter. The intended file path can be manipulated to allow arbitrary traversal of directories on the remote server, potentially leading to information disclosure.

### **Reason and Prerequisites**
- **Affected Versions:** ME 15.1.3 to before ME 15.4
- **Affected Modules:** Work Instruction Viewer (WI500), Visual Test and Repair (MODEL_VIEWER)

### **Solution**
The issue has been fixed through a code correction that avoids passing the file path as a request parameter. The file path is now managed internally in the session.

- **Implementation:** Apply the Support Packages and Patches referenced in this SAP Note.
- **Note:** The issue is addressed in ME 15.4 and later releases; no patch is required for these versions.

### **Workaround**
- Remove any sensitive content from file systems accessible to the Netweaver process or service user.
- Restrict access to unnecessary file paths for the Netweaver process or service user.

### **CVSS Score**
- **Score:** 9.9
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H

### **Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001343242022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003242933?language=en-US&token=5384533B80F6233315FAB17EF6DA4F6F)
- [Download FAQs (PDF)](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125800001819862022&iv_version=0012&iv_guid=00109B36BCB61EDD8BC3F62E1794AE16)

### **Attachments**
- [SAPSecurityNote3242933FAQs.pdf](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125800001819862022&iv_version=0012&iv_guid=00109B36BCB61EDD8BC3F62E1794AE16)

### **Support Package Patches**
- **SAP MFG EXECUTION CORE 15.1:**
  - [SP003 Patch 000045](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200002878&support_package=SP003&patch_level=000045)
  - [SP005 Patch 000043](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200002878&support_package=SP005&patch_level=000043)
- **SAP MFG EXECUTION CORE 15.2:**
  - [SP000 Patch 000029](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200007589&support_package=SP000&patch_level=000029)
  - [SP003 Patch 000035](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200007589&support_package=SP003&patch_level=000035)
- **SAP MFG EXECUTION CORE 15.3:**
  - [SP000 Patch 000030](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200010427&support_package=SP000&patch_level=000030)

For more details, visit [SAP Notes](https://me.sap.com/notes/3242933).

*Credits to [Redrays](https://redrays.io) for support in providing this information.*