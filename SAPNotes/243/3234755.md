SAP Security Note 3234755 – Information Disclosure Vulnerability in Master Data Governance

**Overview**
  
**SAP Note Number:** 3234755  
**Type:** SAP Security Note  
**Version:** 4  
**Released On:** December 12, 2022  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Component:** Cross-Application Components > Master Data Governance > Applications > Customer (Central Parts)  
**Language:** English  

**Description**

**Symptom**

Under certain conditions, a part of the MDG Key Mapping correction functionality allows an attacker to access information that should be restricted. This vulnerability can lead to information exposure or leaks within the Master Data Governance system.

**Reason and Prerequisites**

The issue arises from the MDG Key Mapping correction report which utilizes an external RFC call (refer to SAP Note 3195018). The existing RFC module lacks proper authorization checks, making it susceptible to unauthorized information access.

**Solution**

1. **Enhancement of RFC Module:**
   - The RFC module has been enhanced to include appropriate authorization checks to prevent unauthorized access.

2. **Implementation of Correction Instructions:**
   - **Automatic Correction:** Apply the attached automatic correction instructions suitable for your software component versions and support packages.
   - **Manual Correction:** If you have previously implemented the manual solution from SAP Note 3195018 (i.e., the RFC function module 'ZMDG_RETRIEVE_KNVK'), you need to replace it with the updated version provided in the attachment. The new version includes the necessary authorization checks.
   - After replacement, verify the authorizations of the standard RFC user(s) used for accessing the ERP client system from the MDG hub system to ensure the changes are effective.

**Attachments**

- [Template_Function_Module_ZMDG_RETRIEVE_KNVK.docx](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125900001299192022&iv_version=0004&iv_guid=00109B36D6AA1EDD90959B3FA72B233B)

**CVSS Rating**

- **Score:** 4.3
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N

This score indicates a **Medium** severity vulnerability with the following characteristics:
- **Attack Vector:** Network
- **Attack Complexity:** Low
- **Privileges Required:** Low
- **User Interaction:** None
- **Scope:** Unchanged
- **Confidentiality Impact:** Low
- **Integrity Impact:** None
- **Availability Impact:** None

**Supported Software Components**

The correction is applicable to various versions of the SAP_APPL and S4CORE components. Please refer to the [Support Package](https://me.sap.com/supportpackage/SAPK-10211INS4CORE) section for detailed version information and applicable support packages.

**Additional Actions Required**

If you implemented the manual part of the solution from SAP Note 3195018 in version 9 or earlier, ensure you replace the 'ZMDG_RETRIEVE_KNVK' function module with the updated version to incorporate the necessary authorization checks.

**References**

- [SAP Note 3195018 – MDG - Wrong Partner Number retrieved from Key Mapping for Vendor Contact Person Replication via IDoc](https://me.sap.com/notes/3195018)
- [Download SAP Note 3234755 for SNOTE](https://me.sap.com/notes/3234755)

For more detailed information, visit the [SAP Support Portal](https://me.sap.com/).

---
*Credits to [Redrays](https://redrays.io) for supporting the provision of this information.*