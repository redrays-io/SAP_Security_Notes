3237251 - [CVE-2022-41205] Code injection vulnerability in SAP GUI for Windows

**Symptom**

SAP GUI allows an authenticated attacker to execute scripts in the local network. On successful exploitation, the attacker can gain access to registries, which can cause a limited impact on the confidentiality and a high impact on the availability of the application.

**Other Terms**

- SAP GUI for Windows
- SAP GUI
- Command Injection
- OS Command Injection
- [CVE-2022-41205](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41205)
- [CVE-2022-41208](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41208)

**Solution**

General recommendation from SAP GUI side: Unless you want your users to be able to install add-ons without having administrative permissions, you should consider limiting write access to `HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\`. Such a restriction would prevent attacks of this kind not only against SAP GUI for Windows but also other programs.

The security issue described above is fixed for SAP GUI for Windows by an SAP GUI for Windows patch. The section "SP Patch Level" lists the patch that contains the respective correction per affected release. Install this patch or a newer one to obtain a correction for the issue (SAP GUI patches are always cumulative).

**Downloading SAP GUI Patches**

All SAP GUI patches are available on the [SAP Support Portal](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200011345&V=MAINT). Detailed information about the location of the patches can be found in [SAP Note 563161](https://me.sap.com/notes/563161).

**Installation of SAP GUI for Windows Patches**

The installation of SAP GUI for Windows patches is documented in the [SAP Frontend Installation Guide](https://help.sap.com/viewer/1ebe3120fd734f67afc57b979c3e2d46/LATEST/en-US) or on the SAP GUI installation media.

**CVSS**

- **CVSS Score:** 5.5
- **CVSS Vector:** CVSS:3.0/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:H

  - **Attack Vector (AV):** Local (L)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** High (H)

**References**

- [SAP Note 563161](https://me.sap.com/notes/563161)

**Credits**

Supported by [redrays.io](https://redrays.io) for providing the information.