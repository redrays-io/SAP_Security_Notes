SAP Security Note 1534115 - Potential false redirection of Web site content in BSPs

**Description**
  
SAP Security Note 1534115 addresses a vulnerability in the BSP applications CERTREQ and CERTMAP that allows for potential phishing attacks. A malicious user can exploit this vulnerability by publishing a deceptive URL that redirects victims to a malicious site, thereby tricking them into divulging sensitive information such as authentication details.

**Symptom**

The BSP applications CERTREQ and CERTMAP can be manipulated to perform phishing attacks. A malicious user can publish a URL that appears to originate from the SAP product but redirects the victim to a different URL controlled by the attacker. This deception can lead victims to disclose private data, including authentication information.

**Other Terms**

- Cross-domain redirection
- CERTREQ
- CERTMAP

**Reason and Prerequisites**

Certain pages within the BSP applications CERTREQ and CERTMAP allow cross-domain redirection. An attacker can insert a URL from an unauthorized domain into a legitimate URL sent to users. When users visit the manipulated page, they believe they are interacting with the official SAP application, while in reality, they are being redirected to a malicious domain. This can enable attackers to mimic legitimate pages, such as login screens, to harvest sensitive information like passwords. The vulnerability can be mitigated by restricting redirections to relative or local domains only.

**Solution**

Apply the correction provided in this security note. After applying the correction, maintain the list of allowed redirection URLs in the table `HTTP_WHITELIST` with entry type 2 (`sap-exiturl`).

**Valid Software Components**

This security note is applicable to the following SAP_BASIS versions:

- 6.40
- 7.00 to 7.02
- 7.10 to 7.30

**Support Packages**

Ensure that the appropriate support packages are applied for your SAP_BASIS version:

- SAP_BASIS 6.40: [SAPKB64028](https://me.sap.com/supportpackage/SAPKB64028)
- SAP_BASIS 7.00: [SAPKB70025](https://me.sap.com/supportpackage/SAPKB70025)
- SAP_BASIS 7.01: [SAPKB70110](https://me.sap.com/supportpackage/SAPKB70110)
- SAP_BASIS 7.02: [SAPKB70208](https://me.sap.com/supportpackage/SAPKB70208)
- SAP_BASIS 7.10: [SAPKB71013](https://me.sap.com/supportpackage/SAPKB71013)
- SAP_BASIS 7.11: [SAPKB71108](https://me.sap.com/supportpackage/SAPKB71108)
- SAP_BASIS 7.20: [SAPKB72006](https://me.sap.com/supportpackage/SAPKB72006)
- SAP_BASIS 7.30: [SAPKB73003](https://me.sap.com/supportpackage/SAPKB73003)

**Download and Print**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009100672017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001534115?language=en-US&token=B36949DD8D557E296A854A2345A9FEE6)

For more details and to view the full security note, visit the [SAP Support Portal](https://me.sap.com/notes/1534115).

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*