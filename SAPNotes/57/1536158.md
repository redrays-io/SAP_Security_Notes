1536158 - Security constraints not working properly

**Symptom**

Resource that should be accessible anonymously returns HTTP error code 403 - Forbidden.

**Other Terms**

web.xml, security constraints, http-method, 403, forbidden

**Reason and Prerequisites**

A programming error causes the following behavior: Two or more security constraints are defined for one URL. One is for anonymous access for some of the HTTP methods, and another defines access for other HTTP methods to be allowed for some role.

**Example:**
```xml
<servlet-mapping>
  <servlet-name>test</servlet-name>
  <url-pattern>/test</url-pattern>
</servlet-mapping>
<!--
  Allow GET to anybody.
-->
<security-constraint>
  <web-resource-collection>
    <web-resource-name>Protected area 1</web-resource-name>
    <url-pattern>/test/*</url-pattern>
    <http-method>GET</http-method>
  </web-resource-collection>
</security-constraint>
<!--
 Allow all other methods to some-role.
 -->
<security-constraint>
  <web-resource-collection>
    <web-resource-name>Protected area 2</web-resource-name>
    <url-pattern>/test/*</url-pattern>
  </web-resource-collection>
  <auth-constraint>
    <role-name>some-role</role-name>
  </auth-constraint>
</security-constraint>
```
After deploying the application, the resource is not accessible anonymously for the methods defined in the first constraint.

**Solution**

Deploy the latest patch level of the `ENGINEAPI.sca` for the corresponding Support Package.

**Download and Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017143072017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001536158?language=en-US&token=5B8BF1DC9507BD73CB4665A7D9834DD3)

For more details and related information, visit [SAP Support](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*