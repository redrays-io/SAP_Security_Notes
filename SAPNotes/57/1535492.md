SAP Security Note 1535492: Directory Traversal in SCM-FRE-FRP

---

**Title:** 1535492 - Directory Traversal in SCM-FRE-FRP

**Type:** SAP Security Note

**Version:** 2  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 08.02.2011  
**Component:** SCM-FRE-FRP (Supply Chain Management > Forecasting and Replenishment > FRP Functions)

---

### **Description**

A directory traversal vulnerability has been identified in the SAP component **SCM-FRE-FRP**. The affected reports are:

- `/FRE/FU_TOOLS_TS_FILE_LOAD`
- `/FRE/FU_TOOLS_FILE_COPY`

These vulnerabilities allow malicious users to:

- **Read Arbitrary Files:** Potentially disclose confidential information by reading arbitrary files on the remote server.
- **Write Arbitrary Files:** Corrupt data or alter system behavior by writing arbitrary files on the remote server.

### **Cause**

The reports fail to correctly validate the file paths used when referencing files on the remote server. This lack of validation enables attackers to target arbitrary files on the system.

### **Solution**

1. **Prerequisite:**  
   Implement the corrections from [Note 1497003](https://me.sap.com/notes/1497003) which addresses potential directory traversals in applications.

2. **Logical File Name Configuration:**  
   - Create the logical file name `/FRE/SAF_FILE_PATH_NAME` to validate physical file names.
   - Ensure the physical path for the syntax group `UNIX` for the logical path `/FRE/SAF_FILE_PATH` is set to `/frp/` using transaction FILE.

3. **Validation Enforcement:**  
   - Remove any physical path assignments for `/FRE/SAF_FILE_PATH` to enforce validation logic.
   - Specifically, delete assignments on Windows platforms if present to prevent bypassing validation.

### **Support Packages**

- **SCM 500:** [SAPKY50019](https://me.sap.com/supportpackage/SAPKY50019)
- **SCM 510:** [SAPKY51015](https://me.sap.com/supportpackage/SAPKY51015)
- **SCM 700:** [SAPKY70009](https://me.sap.com/supportpackage/SAPKY70009)
- **SCM 701:** [SAPKY70104](https://me.sap.com/supportpackage/SAPKY70104)

### **References**

- **Related Note:** [Potential directory traversals in applications (1497003)](https://me.sap.com/notes/1497003)

### **CVSS Information**

- **Score:** 0  
- **Vector:** Not specified

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*