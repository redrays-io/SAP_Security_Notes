SAP Security Note 1535298 - Unauthorized use of application functions in AMC Web Editor

**Symptom**
A malicious user can execute functions in the AMC Web Editor Application without authentication and authorization.

**Other Terms**
Cross-site request forgery (XSRF), AMC Web Editor Application.

**Reason and Prerequisites**
The AMC Web Editor Application executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a specific URL and parameters, the function is executed with the rights of the authenticated user. This can be achieved through cross-site scripting attacks or by presenting a deceptive link to the victim.

**Solution**
To mitigate XSRF attacks, web applications must ensure that state-changing operations do not rely solely on credentials or tokens automatically submitted by browsers. A common approach is to include a special token in each request, associated with the user session and valid only for the session's lifetime.

The SAP NetWeaver Application Server Java (AS Java) has been enhanced with the XSRF Protection Framework. You can secure your web application using the token-based approach by adopting this framework. This note provides the steps to adopt the XSRF Protection Framework for the AMC Web Editor Application.

**References**
- [SAP Note 1450166 - Unauthorized usage of application functionality](https://me.sap.com/notes/1450166)

**Attachments**
- [How_to_Protect_AMC_against_XSRF.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000646392010&iv_version=0002&iv_guid=7D1B8C0B6C977A459BD3A7617C55591B)

**Affected Versions**
- AMC 2.0: applet version 181
- AMC 3.0: applet version 168
- AMC 4.0: applet version 02

**Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017141792017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001535298?language=en-US&token=492154C3FAEBB00C0113B0B841A98775)

*Credits to [Redrays.io](https://redrays.io) for supporting the information provided.*