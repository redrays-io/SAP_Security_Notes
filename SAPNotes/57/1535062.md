SAP Security Note 1535062 - Directory Traversal in IS-R-LG-RMA

```markdown
## Overview

**SAP Note Number:** 1535062  
**Title:** Directory Traversal in IS-R-LG-RMA  
**Type:** SAP Security Note  
**Priority:** Correction with medium priority  
**Release Date:** 08.02.2011  
**Component:** IS-R-LG-RMA  
**Supported Versions:** EA-RETAIL 603, 604, 605

## Symptom

There is a potential directory traversal vulnerability in the component **IS-R-LG-RMA**. Specifically, the report `RWRF_ORGPRICE_SETUP` allows malicious users to read arbitrary files on the remote server, which can lead to the disclosure of confidential information.

## Reason and Prerequisites

The vulnerability arises because the report `RWRF_ORGPRICE_SETUP` does not properly validate the file path when referencing files on the remote server. This flaw enables attackers to manipulate the program to access unintended files within the system.

## Solution

To address this issue, refer to **Note 1497003** for additional information. The corrections provided in Note 1497003 are required before implementing this note.

### Steps to Implement:

1. **Logical File Names:**
   - Created logical file names:
     - `ISR_RMA_ORGPRICE_LOG_FILE`
     - `ISR_RMA_ORGPRICE_PHY_FILE`
   - These allow validation of logical and physical file names.

2. **Recommended Directory Structure:**
   - Organize directories to reflect user and program structures.
   - Define physical path names using already defined parameters in transaction FILE (F1 help for physical path).

3. **Configuration:**
   - Maintain the physical path for the syntax group UNIX for the logical path `ISR_RMA_PATH` using transaction FILE: `/usr/SAP/data/<SYSID>/<CLIENT>/`
   - Define logical file names with appropriate data formats and references.

4. **Validation:**
   - Ensure that file paths are validated based on the logical file names to prevent unauthorized access.

For detailed instructions, refer to the full note available [here](https://me.sap.com/notes/1535062).

## Download and Resources

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000009106242017](https://notesdownloads.sap.com/note/0040000009106242017)
- **PDF Version:** [https://me.sap.com/sap/support/sfm/notes/print/0001535062?language=en-US&token=1B0D3C933B1191C64F6D936635841C11](https://me.sap.com/sap/support/sfm/notes/print/0001535062?language=en-US&token=1B0D3C933B1191C64F6D936635841C11)

## References

- **Related Note:** [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

## Support Packages

- **EA-RETAIL 603:** [SAPK-60308INEARETAIL](https://me.sap.com/supportpackage/SAPK-60308INEARETAIL)
- **EA-RETAIL 604:** [SAPK-60409INEARETAIL](https://me.sap.com/supportpackage/SAPK-60409INEARETAIL)
- **EA-RETAIL 605:** [SAPK-60504INEARETAIL](https://me.sap.com/supportpackage/SAPK-60504INEARETAIL)

## Correction Instructions

- Available via [https://me.sap.com/corrins/0001535062/167](https://me.sap.com/corrins/0001535062/167)

## Prerequisites

Ensure that **Note 1497003** is implemented before applying this security note.

## Credits

Special thanks to [RedRays.io](https://redrays.io) for supporting the provision of this information.
```