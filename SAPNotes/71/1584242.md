SAP Security Note 1584242 - Directory Traversal in the RSCRM framework

**SAP Security Note 1584242** addresses a directory traversal vulnerability in the RSCRM framework. This vulnerability allows a malicious user to write arbitrary files on the remote server, potentially leading to data corruption or altering system behavior.

### **Description**
The RSCRM framework fails to correctly validate the path where a user-submitted file is written. This oversight allows an attacker to potentially overwrite data on the remote system by manipulating file paths.

### **Affected Components**
- **Software Component:** SAP Business Warehouse > Enhanced Infrastructure > Retraction (BW-EI-RTR)
- **Versions:**
  - SAP NetWeaver BW 7.00
  - SAP NetWeaver BW 7.01
  - SAP NetWeaver BW 7.02
  - SAP NetWeaver BW 7.11
  - SAP NetWeaver BW 7.30

### **Solution**
To mitigate this vulnerability, apply the appropriate support package for your SAP NetWeaver BW version:

- **SAP NetWeaver BW 7.00:** [Support Package 27 (SAPKW70027)](https://me.sap.com/supportpackage/SAPKW70027)
- **SAP NetWeaver BW 7.01:** [Support Package 10 (SAPKW70110)](https://me.sap.com/supportpackage/SAPKW70110)
- **SAP NetWeaver BW 7.02:** [Support Package 09 (SAPKW70209)](https://me.sap.com/supportpackage/SAPKW70209)
- **SAP NetWeaver BW 7.11:** [Support Package 08 (SAPKW71108)](https://me.sap.com/supportpackage/SAPKW71108)
- **SAP NetWeaver BW 7.30:** [Support Package 04 (SAPKW73004)](https://me.sap.com/supportpackage/SAPKW73004)

In urgent cases, you can use the correction instructions provided in the note:

- **Correction Instructions:** [SAP Note 1584242 - Correction Instructions](https://me.sap.com/corrins/0001584242/30)

### **Manual Activities**
Some corrections require manual steps. Follow the instructions below:

```markdown
#### **Messages**
1. Launch transaction SE91.
2. Enter Message class as `RSCRM` and choose **Change**.
3. Scroll to Message Number `310`.
4. Enter the following:
   - **Message 310:** No authority to delete or write file &1. See note 1584242. **X**
   - **Message 311:** Filename must not contain "..". See note 1584242. **X**
5. Save.

#### **Domain**
1. Launch Transaction SE11.
2. Select **Domain** and enter name `RSCRMPATH`.
3. Choose **Create** and enter the following details:
   - **Short Description:** Path
   - **Data Type:** CHAR
   - **Length:** 255
   - **Decimal Places:** 0
   - **Output:** Normal
   - **Output Length:** 255
   - **Lower Case:** Checked
4. Save and Activate.

#### **Data Element**
1. Launch Transaction SE11.
2. Select **Data Type** and enter name `RSCRMPATH`.
3. Choose **Create** and select **Data Element**.
4. Enter the following details:
   - **Short Description:** Path Name
   - **Elementary Type:** Selected
   - **Domain:** RSCRMPATH
5. Save and Activate.
```

### **References**
- [SAP Note 1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

### **Summary**
The RSCRM framework now uses the function `FILE_VALIDATE_NAME` to enhance security. Assign a physical path to the logical path `RSCRM_FILE_EXTRACT_PATH` in transaction FILE. This ensures that filenames are validated to be within the specified logical path and do not contain unauthorized path segments like "..".

### **Credits**
Credits to [redrays.io](https://redrays.io) for support to provided information.