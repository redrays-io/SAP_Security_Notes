1585527 - Directory traversal in CRM Web channel

**Description**

CRM Web Channel applications contain a vulnerability that allows a malicious user with access to the admin area to potentially read arbitrary files on the remote server, which may lead to the disclosure of confidential information.

**Symptom**

A malicious user with admin access can exploit a directory traversal vulnerability in the logging section of CRM Web Channel applications. This can allow the attacker to reference and read arbitrary files on the system, potentially exposing sensitive data.

**CVSS Information**

- **Base Score:** 2.1
- **Vector:** AV:N/AC:H/AU:S/C:P/I:N/A:N

*Note:* The CVSS score provided is an estimate of the risk and does not account for specific system configurations or environments. It's recommended to conduct a thorough risk assessment for accurate evaluation.

**Solution**

SAP has introduced new security checks in the logging section of the CRM Web Channel applications' admin area:

1. **Path Validation:** Log files or directories must reside within the J2EE server's root directory, for example:
   - Linux/Unix: `/usr/sap/[SID]/JC00/j2ee/cluster/serverX/`
   - Windows: `D:\usr\sap\[SID]\JCOO\j2ee\cluster\serverX\`

2. **File Extension Restriction:** Only log files with the following extensions can be created, viewed, or downloaded:
   - `.log`
   - `.trc`
   - `.zip`

**Affected Components:**
- **SAP-SHRJAV**
  - Changed files: `Admin.java`, `CoreAdminServlet.java`
- **ESALES_Base**
  - Changed files: `Admin.java`, `CoreAdminServlet.java`

**Action Required:**
Apply the Support Package patch level attached to this note. For detailed instructions on applying Java patches, refer to [SAP Note 877887](https://me.sap.com/notes/877887). Additionally, see [SAP Note 1546959](https://me.sap.com/notes/1546959) for information about the patch strategy.

**Support Package Patches**

Ensure that the following support package patches are applied based on your software component version:

- **CRM JAVA COMPONENTS 7.01**
  - [SP004 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014673&support_package=SP004&patch_level=000001)
- **SAP SHARED JAVA COMPONENTS 6.0**
  - [SP008 Patch 000011](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200005025&support_package=SP008&patch_level=000011)
- *(Refer to the full list in the original note for other components and versions.)*

**References**

- [Patch strategies for SAP E-Commerce solutions (Note 1546959)](https://me.sap.com/notes/1546959)
- [Installing Patches for CRM Java Components and FSCM BD (Note 877887)](https://me.sap.com/notes/877887)

**Download and Additional Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017237082017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001585527?language=en-US&token=8C44A8353B88BB5BCAA4279957D64769)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001585527)
- [Share by Email](mailto:?subject=SAP%20Note%201585527&body=Check%20out%20this%20SAP%20Note%20for%20details.%20https://me.sap.com/notes/1585527)
- [Open in New Window](https://me.sap.com/notes/1585527)

**Credits**

Credits to [RedRays](https://redrays.io) for support in providing this information.