2736825 - [CVE-2019-0271] Denial of Service via XML External Entity (XXE) vulnerability in ABAP Server

**Description**

ABAP Server (used in NetWeaver and Suite/ERP) does not sufficiently validate an XML document accepted from an untrusted source. This Missing XML Validation vulnerability can lead to arbitrary file retrieval from the server and denial-of-service (DoS) conditions in successful exploits.

**Reason and Prerequisites**

External entities may be used in Document Type Definition (DTD), potentially causing system resource exhaustion. Such external entities are generally not required for SAP applications.

**Solution**

- **For Kernel Versions 7.21 or 7.22 (ABAP Server 7.00 to 7.31):**
  - **Profile Parameters Configuration:**
    - **`ixml/dtd_restriction`**: Controls the behavior of the iXML Toolset.
      - **Default Value:** `none` (A malicious DTD may cause an exhaustion exception, stopping the application's processing.)
      - **Recommended Setting:** `expansion` (Handles errors gracefully without stopping the application, but may lead to inconsistent application data if not managed properly.)
    - **`ixml/xml_expansion_factor`**: Sets restrictions on external entities in XML documents.
      - **Default Value:** `10` (Ratio between the size of DTD and external entity.)
  - **Configuration Method:** Set these parameters via transaction **RZ11**.

- **For Kernel Versions 7.45, 7.49, or 7.53 (ABAP Server 7.40 to 7.52 or ABAP Platform):**
  - **Default Behavior:**
    - **`ixml/dtd_restriction`**: `expansion`
    - **`ixml/xml_expansion_factor`**: `10`
  - **SAP Applications:** Handle the new error situation by implementing interfaces as described in [SAP Note 1594475](https://me.sap.com/notes/1594475) and [SAP Note 1712860](https://me.sap.com/notes/1712860).
  - **Recommendation:** Review custom-developed applications to ensure they are prepared for the new error handling mechanisms.

**CVSS**

- **Score:** 6.5
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
- **Breakdown:**
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** None (N)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** High (H)

**References**

- [SAP Note 1594475: Potential denial of service in all programs using iXML](https://me.sap.com/notes/1594475)
- [SAP Note 1712860: iXML: Protection against attacks via a DTD](https://me.sap.com/notes/1712860)

**Credits**

Information provided by [Redrays.io](https://redrays.io).