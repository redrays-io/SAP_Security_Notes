2727564 - [CVE-2019-0259] Unrestricted File Upload vulnerability in BO 4.2/ Visual Difference

## Description

### Symptom

BO 4.2/ Visual Difference allows an attacker to upload any file (including script files) without proper file format validation.

Some well-known impacts of Unrestricted File Upload vulnerability are:

- Malicious file insertion or modification
- Make the Web site vulnerable to some other attacks such as XSS

### Reason and Prerequisites

Visual Difference is used to compare the reference and the target info objects by uploading lcmbiar file. Currently, it does not check the type of file system when selecting it and hence it is vulnerable to upload any file type. However, the usage of the Visual Difference can be done only by logging into CMC tool with a user having enough access privileges.

### Solution

We have restricted the file upload type to lcmbiar only. The existing functionalities are not impacted after implementing this security note.

This issue is fixed in the patches listed in the "Support Packages & Patches" section below. The "Support Packages & Patches" section will be populated with the relevant patch levels once they are released.

## Affected Software Components

| Software Component | From | To  |
|--------------------|------|-----|
| ENTERPRISE         | 420  | 420 |
| ENTERPRISE         | 430  | 430 |

## CVSS

**CVSS Score**: 6.3

**CVSS Vector**: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

- **Attack Vector (AV)**: Network (N)
- **Attack Complexity (AC)**: Low (L)
- **Privileges Required (PR)**: Low (L)
- **User Interaction (UI)**: None (N)
- **Scope (S)**: Unchanged (U)
- **Confidentiality Impact (C)**: Low (L)
- **Integrity Impact (I)**: Low (L)
- **Availability Impact (A)**: Low (L)

## Support Packages & Patches

### Support Package Patches

| Software Component Version        | Support Package | Patch Level | URL                                                                                                                                                                                                                      |
|-----------------------------------|------------------|-------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SBOP BI PLATFORM SERVERS 4.3       | SP000            | 000000      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)                                     |
| SBOP BI PLATFORM SERVERS 4.2       | SP007            | 000000      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)                                     |
| SBOP BI PLATFORM SERVERS 4.2       | SP006            | 000500      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)                                     |

## Download and Documentation

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000249992019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002727564?language=en-US&token=6E7AB80BB8DA125C07F0C8414CDA7B4A)

## References

- [CVE-2019-0259](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-0259)

## Available Translations

- [Deutsch](https://me.sap.com/notes/0002727564/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002727564/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002727564/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002727564/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002727564/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002727564/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002727564/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002727564/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002727564/3)

## Credits

Thanks to [redrays.io](https://redrays.io) for support in providing this information.