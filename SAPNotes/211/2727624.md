SAP Security Note 2727624 - [CVE-2019-0249] Information Disclosure in SAP Landscape Management

**SAP Note Details**
- **Note Number:** 2727624
- **Type:** SAP Security Note
- **Version:** 3
- **Recency:** Updated
- **Language:** English
- **Category:** Program error
- **Priority:** HotNews
- **Status:** Released for Customer
- **Released On:** 08.01.2019
- **Component:** Basis Components > Virtualization / Cloud Management > Landscape Virtualization Management

**Title**
2727624 - [CVE-2019-0249] Information Disclosure in SAP Landscape Management

**Description**
### Symptom
Under certain conditions, SAP Landscape Management allows an attacker to access information which would otherwise be restricted. This allows attackers to gather user credentials for further exploits and attacks.

### Other Terms
- Information Exposure
- Information Leak
- [CVE-2019-0249](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0249)

### Reason and Prerequisites
Execution of "Install Application Server" on a system with a single-tenant or multi-tenant SAP HANA database.

### Solution
1. **Implement the referenced SAP Landscape Management Patch.**
2. **Perform the manual correction instructions described in this SAP Note.**

**Manual Activities**
```plaintext
-------------------------------------------------------------------------
|Manual Activity                                                                              |
-------------------------------------------------------------------------
|VALID FOR                            Software Component                               |
|                                     VCM                                               |
| Release 3.00                         All Support Package Levels                     |
-------------------------------------------------------------------------

**Caution:** You have to perform this manual activity separately in each system into which you transport the Note for implementation.

Perform the manual activities according to your mitigation goals.

### Mitigation Goal 1
**Precondition:**  
Application server provisioning for single-tenant or multi-tenant SAP HANA has been executed within the period of persisted logs (cf. Setup-Settings-Engine).

**Goals:**
- **Goal a:** Remove confidential information from the activity step details and from the related database entries.
- **Goal b:** Remove confidential information from technical database entries that are available in plaintext and that are not visible on the SAP Landscape Management UI.

**Mitigation Steps:**
1. In SAP Landscape Management, navigate to **Monitoring → Activities**.
2. Search for activities with the description **"Application Server Installation"**.
3. Remove each activity related to SAP HANA application server provisioning.

### Mitigation Goal 2
**Precondition:**  
Application server provisioning for single-tenant or multi-tenant SAP HANA has been executed within the period of persisted logs (cf. Setup-Settings-Engine).

**Goal:**  
Remove confidential information from the operation logs and from the related database entries.

**Mitigation Steps:**
- **Option 1:** Applicable if you can accept deleting operation logs.
  1. Navigate to **Setup → Settings → Engine** in SAP Landscape Management.
  2. Enable the deletion of non-archived logs.
  3. Go to **Monitoring → Logs**.
  4. Delete the logs that contain confidential information.

- **Option 2:** Applicable if you cannot accept deleting the logs.
  1. Log on to the SAP Landscape Management NetWeaver database using the SQL client.
  2. Execute the following SQL command:
     ```sql
     UPDATE BC_VC_EVENT_OPERA SET MSG = 'deleted' WHERE C_MSG_CODE = 'SWPM_PARAM';
     ```
     *Note: You may change the string 'deleted'.*

### Mitigation Goal 3
**Precondition:**  
Application server provisioning for single-tenant or multi-tenant SAP HANA has been executed and log archiving is enabled.

**Goal:**  
Remove confidential information from archives.

**Mitigation Steps:**
1. Navigate to **Setup → Settings → Engine** in SAP Landscape Management.
2. Check the path entered to store the archived log files.
3. Navigate to the folder of the archived log files.
4. Delete the archives.

*Note: Check potential other locations for files to be deleted, according to your internal processes.*

### Mitigation Goal 4
Change all relevant user passwords. Relevant passwords are those that fulfill all subsequent criteria:
- SYSTEM user passwords configured for single-tenant or multi-tenant SAP HANA DB (SYSTEMDB) in SAP Landscape Management.
- Passwords where at least one of the tenants has served as a database in an application server provisioning activity.

*Note: The relevant user is the HANA SYSTEMDB SYSTEM user, not the SYSTEM user for the tenant.*

### General Considerations
1. For security, data protection, and privacy-related reasons, we strongly recommend that you delete log files once you do not need them any longer.
2. Ensure the SAP HANA system user is disabled, as recommended by the SAP HANA Security Guide.
3. Change relevant passwords as described in Mitigation Goal 4 in addition to Mitigation Goals 1-3.
4. Log and activity data may have been exported by users. Ensure proper deletion of these exports according to your internal processes.

**CVSS Details**
- **CVSS Score:** 9.1
- **CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** High (H)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** High (H)

**Support Package Patches**
- **VCM LVM 3.0 SP009 Patch Level 000001:** [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73555000100200004112&support_package=SP009&patch_level=000001)
- **VCM LVM ENTERPRISE 3.0 SP009 Patch Level 000001:** [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73555000100200004114&support_package=SP009&patch_level=000001)

For more information, visit the [SAP Support Portal](https://me.sap.com/notes/0002727624/E).

*Credits to [redrays.io](https://redrays.io) for support to provided information.*