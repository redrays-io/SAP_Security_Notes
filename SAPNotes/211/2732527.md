2732527 - Potential Oracle attack on OPC UA server in SAP Plant Connectivity

**SAP Note/KBA:** 2732527  
**Type:** SAP Security Note  
**Version:** 7  
**Recency:** Updated  
**Language:** English  
**Master Language:** English  
**Category:** Consulting  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 12.05.2020  
**Component:** SAP Manufacturing > SAP Plant Connectivity

### Description

**Symptom**

**UPDATE 12th May 2020**: This note has been re-released with updated ‘Solution’ information.

A potential Oracle attack targeting OPC UA servers has been discovered. This may allow attackers to determine the private key of the application certificate of an OPC UA server. This is described in CVE-2018-7559 and documents referred to in that CVE.

**Reason and Prerequisites**

According to the CVE, this vulnerability is relevant only if the security policy Basic128Rsa15 is used.

**Solution**

Replace the security policy Basic128Rsa15 with a stronger security policy. Note that the security policy Basic128Rsa15 is deprecated anyway since it is based on SHA1 as signature algorithm and allows the usage of key size 1024.

**Steps to change the security policy:**

1. Open the PCo Management Console.
2. In the agent instances window, select an agent instance that hosts an OPC UA server (you have to repeat this activity for every such instance). Stop the agent instance if it is running.
3. Select the 'Server' tab and the 'OPC UA-Server' entry on that tab. In the server configuration pane, the 'OPC UA Server Settings' are displayed. The endpoint URLs that you can configure here have the security policy encoded in their string representation. The endpoints that use the policy Basic128Rsa15 will contain one of the substrings `[Sign:Basic128Rsa15:Binary]` or `[SignAndEncrypt:Basic128Rsa15:Binary]`.
4. To change the security policy of such an endpoint, select the endpoint and click the 'Edit' button. In the following dialog, you can select the security policy from the drop-down list with label 'Security Policy'. Make an appropriate choice and click 'OK'.
5. Save the agent instance and start it again.

Clients that connect to the servers you want to change must support the newly chosen security policy as well and may have to be reconfigured.

- On PCo 15.1, you can use the security policy Basic256 instead of Basic128Rsa15.
- On PCo 15.2, you can use the security policies Basic256 and Basic256Sha256 instead of Basic128Rsa15.
- On PCo 15.3 and PCo 15.4 you can use the security policies Basic256, Basic256Sha256, Aes128_Sha256_RsaOaep or Aes256_Sha256_RsaPss.

**Note:** The security policy Basic256 is currently classified as deprecated by the OPC Foundation. If you are using the OPC UA server and secure communication is relevant in your environment, it is strongly recommended to upgrade your PCo installation to at least PCo 15.2 and use one of the other supported security policies.

There is no correction available for this issue.

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000443712019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002732527?language=en-US&token=F8E9581CDC02B428F27B198D196A904B)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002732527/E/diff)

### CVSS

**CVSS Score:** 5.3  
**CVSS Vector:** CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** High (H)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** None (N)
- **Availability Impact (A):** None (N)

*Credits to [Red Rays](https://redrays.io) for support provided information.*