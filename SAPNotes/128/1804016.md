1804016 - Potential Information Disclosure in Incident Management

**SAP Security Note 1804016 - Potential Information Disclosure in Incident Management**

---

### **Symptom**
- **Component:** Incident Management
- **Module:** Incident Recording

Incident tasks can potentially reveal confidential information about persons involved in incidents to users who do not have the appropriate access levels assigned.

### **Other Terms**
- **Keywords:** EHSM200SP04INC, EHSM300SP03INC, confidential person, authorization, access level

### **Reason and Prerequisites**
- **Reason:** Program error
- **Prerequisites:**
  - Implement SAP Note [1802680](https://me.sap.com/notes/1802680)
  - Implement SAP Note [1754662](https://me.sap.com/notes/1754662)

**Note:** Ensure that the above SAP Notes are implemented before applying this security note.

### **Solution**
You can resolve this issue by either:
1. **Applying the Support Packages** listed below that contain the necessary corrections.
2. **Implementing the Correction Instructions** provided in this SAP Note.

#### **Support Packages**
- **For EHSM 200:**
  - **Support Package:** [SAPK-20004INEHSM](https://me.sap.com/supportpackage/SAPK-20004INEHSM)
- **For EHSM 300:**
  - **Support Package:** [SAPK-30003INEHSM](https://me.sap.com/supportpackage/SAPK-30003INEHSM)

#### **Correction Instructions**
Follow the detailed correction instructions available [here](https://me.sap.com/corrins/0001804016/9587).

#### **Manual Activities**
After importing the Note, perform the following manual post-implementation steps in each system:

1. **Regenerate Business Objects:**
   - Start transaction `/BOBF/CUST_UI`.
   - Expand the "Business Objects" folder.
   - Open and regenerate the following BOs:
     - `EHHSS_INCIDENT_REPORT`
     - `EHHSS_INCIDENT_ACTION`
     - `EHHSS_PROC_CTRL_INC_APPROVAL`
     - `EHHSS_PROC_CTRL_INC_HR_ABSENCE`
     - `EHHSS_PROC_CTRL_INC_INQUIRY`
     - `EHHSS_PROC_CTRL_INC_NOTIFIC`

2. **Update Customizing Activity:**
   - Navigate to: `SAP EHS Management -> Foundation for EHS Management -> General Configuration -> Specify Field Control`.
   - Select `EHHSS_PROC_CTRL_INC_INQUIRY` from the "Business Objects" list.
   - Choose "BO Nodes" and then select "INQUIRY".
   - Click on "Profiles BO Nodes" and add the following entry:
     - **Profile:** `CHECK_CONF_ACCESS`
     - **BO Node Name:** `INQUIRY`
     - **Node Attribute:** `FORM_NAME`
     - **Function Class:** `CL_EHHSS_INC_CHECK_CONF_ACCESS`
     - **Profile Desc.:** `Check Confidential Access`
   - Update the "Dialog Structure" by adding a new entry for `FORM_NAME`.

**Caution:** Perform these steps manually and separately in each system after importing the Note.

### **Prerequisites**
Ensure the following SAP Notes are implemented before applying this Note:
- [1637741](https://me.sap.com/notes/1637741) - Injury/Illness tab is not hidden for restricted users
- [1721648](https://me.sap.com/notes/1721648) - Additional authorization check for incident links
- [1758151](https://me.sap.com/notes/1758151) - Disabling pushbuttons for closed and void incidents
- [1802680](https://me.sap.com/notes/1802680) - Potential information disclosure in incident tasks

### **References**
- **This document refers to:**
  - [1802680 - Potential information disclosure in incident tasks](https://me.sap.com/notes/1802680)
  - [1754662 - New cross BO functionality for Risk Assessment](https://me.sap.com/notes/1754662)

- **This document is referenced by:**
  - [1754662 - New cross BO functionality for Risk Assessment](https://me.sap.com/notes/1754662)

### **Credits**
Special thanks to [Redrays](https://redrays.io) for supporting the provision of this information.