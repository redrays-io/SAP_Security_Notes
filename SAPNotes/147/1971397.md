1971397 - Missing authorization check in BW-BEX-OT

## Symptom

An authenticated user can use functions of **BW-BEX-OT** to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**
- **CVSS Base Score:** 6.0
- **CVSS Base Vector:** AV:N/AC:M/AU:S/C:P/I:P/A:P

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://me.sap.com/securitynotes/) at [SAP Security Notes](https://me.sap.com/securitynotes/).

## Reason and Prerequisites

**BW-BEX-OT** does not contain authorization checks for checking an authenticated user's authorization to access some of its functions. This may result in undesired system behavior.

## Solution

### Supported SAP NetWeaver BW Releases

To address this issue, import the appropriate Support Package for your SAP NetWeaver BW version:

- **SAP NetWeaver BW 7.00**
  - Import Support Package 33 ([SAP Note 1930762](https://me.sap.com/notes/1930762)) for SAP NetWeaver BW 7.00 (SAPKW70033).
  
- **SAP NetWeaver BW 7.01 (EHP 1)**
  - Import Support Package 16 ([SAP Note 1936601](https://me.sap.com/notes/1936601)) for SAP NetWeaver BW 7.01 (SAPKW70116).
  
- **SAP NetWeaver BW 7.02 (EHP 2)**
  - Import Support Package 16 ([SAP Note 1940530](https://me.sap.com/notes/1940530)) for SAP NetWeaver BW 7.02 (SAPKW70216).
  
- **SAP NetWeaver BW 7.11**
  - Import Support Package 14 ([SAP Note 1940531](https://me.sap.com/notes/1940531)) for SAP NetWeaver BW 7.11 (SAPKW71114).
  
- **SAP NetWeaver BW 7.30**
  - Import Support Package 12 ([SAP Note 1950117](https://me.sap.com/notes/1950117)) for SAP NetWeaver BW 7.30 (SAPKW73012).
  
- **SAP NetWeaver BW 7.31 (EHP 1)**
  - Import Support Package 12 ([SAP Note 1951409](https://me.sap.com/notes/1951409)) for SAP NetWeaver BW 7.31 (SAPKW73112).
  
- **SAP NetWeaver BW 7.40**
  - Import Support Package 7 ([SAP Note 1955499](https://me.sap.com/notes/1955499)) for SAP NetWeaver BW 7.40 (SAPKW74007).

The Support Packages will be available once the respective SAP Notes are released for customers.

### Temporary Correction Instructions

You can use the correction instructions before the mentioned Support Packages are available. Ensure you check [SAP Note 1668882](https://me.sap.com/notes/1668882) for transaction SNOTE before applying these instructions.

#### Manual Activities

1. **Create Whitelist Definitions:**
   
   - **Transaction SLDW:**
     - Press the button: **Create White List Definition** or use **CTRL + F1**.
     - Specify the whitelist name: `RSDPL_CUBE_DATA_READ_FUNC`.
     - Maintain short text: `Cube read RFC check`.
     - Set the check status to `'X'` and SAL-status to `'A'`.
     - Choose Document Class: `NT`.
     - Documentation Object: `1971397`.
     - Save the whitelist definition.
     - Specify the package as `RSDRI_DBA` (create it if it does not exist) or specify package `RSDRI`.

   - **Create Another Whitelist Definition:**
     - Press the button: **Create White List Definition** or use **CTRL + F1**.
     - Specify the whitelist name: `RSDRI_DF_READ`.
     - Maintain short text: `Read of data via Datafederator`.
     - Set the check status to `'X'` and SAL-status to `'A'`.
     - Choose Document Class: `NT`.
     - Documentation Object: `1971397`.
     - Save the whitelist definition.
     - Specify the package as `RSDRI_DBA` or `RSDRI`.

2. **Maintain Message Class RSDRI_DTP:**
   
   - **Transaction SE91:**
     - Choose message class `RSDRI_DTP`.
     - Maintain message number `101` as follows:
       ```
       Receiver &2 not registered in whitelist. Callback aborted.
       ```

## Prerequisites

Before applying this security note, ensure the following SAP Notes are implemented in your system:

- [SLDW: Environment for maintaining switchable allowlists](https://me.sap.com/notes/1919573)
- [SLDW: Transport connection for new whitelists](https://me.sap.com/notes/2061628)
- [Check callback targets](https://me.sap.com/notes/1976303)

## References

This document refers to:
- [Check callback targets (SAP Note 1976303)](https://me.sap.com/notes/1976303)
- [SLDW: Environment for maintaining switchable allowlists (SAP Note 1919573)](https://me.sap.com/notes/1919573)

## Downloads

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011638392017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001971397?language=en-US&token=BCEF58F82E987018E904B2284F8E60A9)

*Credits to [Redrays](https://redrays.io) for supporting provided information.*