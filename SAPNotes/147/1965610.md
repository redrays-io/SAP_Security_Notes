SAP Security Note 1965610 - Code injection vulnerability in external commands

**Symptom**

External commands contain code that permits the execution of arbitrary operating system commands of the userâ€™s choice.

An attacker can therefore control the behavior of the system or potentially escalate privileges by executing malicious code without having their own legitimate credentials.

**CVSS Information**

- **CVSS Base Score:** 7.5
- **CVSS Base Vector:** AV:N/AC:M/AU:S/C:P/I:P/A:C

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/).

**Reason and Prerequisites**

The program code contains a possibility to define and execute operating system commands that change the behavior of the system. A valid and authenticated user is required.

Depending on the command, the user can:

- Inject and run their own code,
- Obtain additional information that should not be displayed,
- Modify data, delete data,
- Modify the output of the system,
- Create new users with higher privileges,
- Perform a denial-of-service attack.

**Solution**

With the correction, the condition "additional parameters allowed" is evaluated and handled correctly, i.e., additional parameters are allowed or refused for the command. In case that additional parameters are not allowed, the exception `TOO_MANY_PARAMETERS` is raised by the API.

Please apply the support package mentioned in this note or follow the respective correction instructions.

**Support Package**

Refer to the following support packages based on your SAP_BASIS version:

- [SAPKB70031](https://me.sap.com/supportpackage/SAPKB70031) for SAP_BASIS 700
- [SAPKB70116](https://me.sap.com/supportpackage/SAPKB70116) for SAP_BASIS 701
- [SAPKB70216](https://me.sap.com/supportpackage/SAPKB70216) for SAP_BASIS 702
- [SAPKB71019](https://me.sap.com/supportpackage/SAPKB71019) for SAP_BASIS 710
- [SAPKB71114](https://me.sap.com/supportpackage/SAPKB71114) for SAP_BASIS 711
- [SAPKB72008](https://me.sap.com/supportpackage/SAPKB72008) for SAP_BASIS 720
- [SAPKB73012](https://me.sap.com/supportpackage/SAPKB73012) for SAP_BASIS 730
- [SAPKB73112](https://me.sap.com/supportpackage/SAPKB73112) for SAP_BASIS 731
- [SAPKB74007](https://me.sap.com/supportpackage/SAPKB74007) for SAP_BASIS 740

**Correction Instructions**

Follow the correction instructions available [here](https://me.sap.com/corrins/0001965610/41) for SAP_BASIS.

---

*Credits to [https://redrays.io](https://redrays.io) for support in providing this information.*