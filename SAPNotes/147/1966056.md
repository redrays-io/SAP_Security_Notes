SAP Security Note 1966056 - Code injection vulnerability in BW

---

**Description**

**Symptom**

BW contains code that permits the execution of arbitrary program code of the user's choice. An attacker can control the system's behavior or potentially escalate privileges by executing malicious code without having their own legitimate credentials.

**Other Terms**
- Injection
- Run
- Credentials
- BW

**Reason and Prerequisites**

The program code allows the definition and execution of user-defined code that alters the system's behavior. A valid and authenticated user is required.

Depending on the code, the user can:
- Inject and run their own code
- Obtain additional information that should not be displayed
- Modify or delete data
- Modify the system's output
- Create new users with higher privileges
- Perform a denial of service attack

**Solution**

To address this vulnerability, apply the appropriate Support Package for your SAP NetWeaver BW version:

1. **SAP NetWeaver BW 7.00**
   - **Support Package:** [SAPKW70033](https://me.sap.com/supportpackage/SAPKW70033)
   - **Note:** [SAP Note 1930762](https://me.sap.com/note/1930762) - "SAPBWNews NW BW 7.0 ABAP SP33"

2. **SAP NetWeaver BW 7.01 (SAP NW BW7.0 EHP 1)**
   - **Support Package:** [SAPKW70116](https://me.sap.com/supportpackage/SAPKW70116)
   - **Note:** [SAP Note 1936601](https://me.sap.com/note/1936601) - "SAPBINews NW7.01 BW ABAP SP16"

3. **SAP NetWeaver BW 7.02 (SAP NW BW7.0 EHP 2)**
   - **Support Package:** [SAPKW70216](https://me.sap.com/supportpackage/SAPKW70216)
   - **Note:** [SAP Note 1940530](https://me.sap.com/note/1940530) - "Preliminary Version SAPBWNews NW BW 7.02 ABAP SP16"

4. **SAP NetWeaver BW 7.11**
   - **Support Package:** [SAPKW71114](https://me.sap.com/supportpackage/SAPKW71114)
   - **Note:** [SAP Note 1940531](https://me.sap.com/note/1940531) - "Preliminary Version SAPBINews NW7.11 BW ABAP SP14"

You can also use the correction instructions provided in this note to implement the fixes before the corresponding Support Packages are available. Ensure you check [SAP Note 1668882](https://me.sap.com/note/1668882) for transaction SNOTE before applying the correction instructions.

**Validity**

This note is applicable to the following software components and versions:
- **SAP_BW:** 700 to 702, 710 to 720
- **SAP_BW_VIRTUAL_COMP:** 701

**References**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011605022017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001966056?language=en-US&token=391E2392498B5D72CBEDF4CCB27EE8F1)

**Available Languages**
- [Deutsch](https://me.sap.com/notes/0001966056/D)
- [日本語](https://me.sap.com/notes/0001966056/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001966056/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001966056/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001966056/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001966056/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001966056/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001966056/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001966056/3)

**Preconditions**

Ensure that [SAP Note 1129320](https://me.sap.com/notes/1129320) - "LISTCUBE displays error in status line and no data" for component BW-BEX-OT-DBIF is applied if you are using SAP NetWeaver BW version 710.

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*