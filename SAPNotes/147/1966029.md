SAP Security Note 1966029 - Directory Traversal Vulnerability in SAP Environment Health and Safety

**Overview**

SAP has released Security Note **1966029** addressing a critical directory traversal vulnerability in the **SAP Environment Health and Safety (EHS)** module. This vulnerability allows attackers to read and write arbitrary files on the remote server, potentially leading to the disclosure, corruption, or alteration of confidential information.

**Vulnerability Details**

- **Description:**  
  The EHS module fails to properly validate file paths used to reference files on the remote server. This allows an attacker to manipulate the path, enabling unauthorized access to arbitrary files. Additionally, the vulnerability permits overwriting of data on the remote system.

- **Impact:**  
  - **Confidentiality:** Low  
  - **Integrity:** Low  
  - **Availability:** Low  

- **CVSS Score:** 7.3 (High)  
  **CVSS Vector:** `CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L`

**Affected Components**

- **Component:** Environment, Health, and Safety / Product Compliance > Product Safety (EHS-SAF)
- **Module:** Specification Management

**Solution**

To mitigate this vulnerability, SAP recommends applying the specified support packages or following the provided correction instructions.

- **Support Packages:**  
  Apply the relevant support packages for your SAP component version. Below are the applicable support packages:

  | Software Component Version | Support Package                      | [URL](https://me.sap.com/supportpackage/SAPKGPAD26)                            |
  |----------------------------|--------------------------------------|---------------------------------------------------------------------------------|
  | EA-APPL 600                | SAPKGPAD26                           | [Link](https://me.sap.com/supportpackage/SAPKGPAD26)                            |
  | EA-APPL 602                | SAPK-60216INEAAPPL                    | [Link](https://me.sap.com/supportpackage/SAPK-60216INEAAPPL)                    |
  | EA-APPL 603                | SAPK-60315INEAAPPL                    | [Link](https://me.sap.com/supportpackage/SAPK-60315INEAAPPL)                    |
  | EA-APPL 604                | SAPK-60416INEAAPPL                    | [Link](https://me.sap.com/supportpackage/SAPK-60416INEAAPPL)                    |
  | EA-APPL 605                | SAPK-60513INEAAPPL                    | [Link](https://me.sap.com/supportpackage/SAPK-60513INEAAPPL)                    |
  | EA-APPL 606                | SAPK-60612INEAAPPL                    | [Link](https://me.sap.com/supportpackage/SAPK-60612INEAAPPL)                    |
  | EA-APPL 616                | SAPK-61607INEAAPPL                    | [Link](https://me.sap.com/supportpackage/SAPK-61607INEAAPPL)                    |
  | EA-APPL 617                | SAPK-61704INEAAPPL                    | [Link](https://me.sap.com/supportpackage/SAPK-61704INEAAPPL)                    |

- **Correction Instructions:**  
  Implement the manual activities as specified in the correction instructions. Detailed steps are provided in the Security Note under the "Manual Activities" section.

**Additional Information**

- **Release Date:** March 10, 2020
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer

**Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000377812020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001966029?language=en-US&token=36569C9189A71AD03EC2945756029665)
- [Edit Note](https://me.sap.com/support/notes/edit/0001966029)
- [Show Changes](https://me.sap.com/support/notes/compareversions/0001966029)
- [Support Package Details](https://me.sap.com/supportpackage/SAPKGPAD26)
- [Correction Instructions](https://me.sap.com/corrins/0001966029/229)

For more detailed information, refer to the full Security Note on the [SAP Support Portal](https://me.sap.com/support/notes/1966029).

**Credits**

Information supported by [RedRays.io](https://redrays.io).