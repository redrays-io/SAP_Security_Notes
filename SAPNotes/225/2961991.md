2961991 - [CVE-2020-6320] Improper Access Control in SAP Marketing (Mobile Channel Servlet)

**Description**

### Symptom
The servlet reference implementation provided for the Mobile Channel Servlet in SAP Marketing allows an authenticated attacker to invoke certain functions that are restricted. Limited knowledge of the payload is required for an attacker to exploit the vulnerability and perform tasks related to contact and interaction data.

### Other Terms
- **Servlet**
- **SAP Marketing Cloud**
- **SAP Marketing**
- **Mobile Application**
- **Improper Access Control**
- **Information Disclosure**
- **Data Manipulation**
- [CVE-2020-6320](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6320)

### Reason and Prerequisites
The service did not contain restrictions.

### Solution
1. The reference implementation will block the unwanted URLs via `web.xml`.
2. The payload of `/\$batch` request is scanned for its validity.

Please refer to the correction instructions to fix the issue.

If you cannot apply the correction instructions, then as an interim fix, disable the servlet as described in [Note 2962970](https://me.sap.com/notes/2962970). Note 2962970 is a workaround and a defense in depth, but not a solution.

**Manual Activities**
```plaintext
-------------------------------------------------------------------------
|Manual Activity                                                       |
-------------------------------------------------------------------------
|VALID FOR                                                             |
|Software Component  SAP_CUAN                                           |
| Release 130        Until SAPK-13001INSAPCUAN                          |
| Release 140        w/o Support Packages                              |
| Release 150        w/o Support Packages                              |
|Software Component  SAPSCORE                                           |
| Release 121        w/o Support Packages                              |
-------------------------------------------------------------------------
Caution: You have to perform this manual activity separately in each system into which you transport the Note for implementation.

1. Go to the link https://sap-my.sharepoint.com/:f:/p/susheel_kumar_c/ElJYQhVn-4dNsiAQZCAzIacBAdjpzyoA6Cpt3ESM2VS_hg?e=IGMtZa

2. Unzip the downloaded file; follow the help document "Servlet_Guide_<version>.pdf" to install/configure the servlet.
```

**CVSS**
- **Score:** 9.6
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N)
  - **Attack Vector:** Network (N)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** Low (L)
  - **User Interaction:** None (N)
  - **Scope:** Changed (C)
  - **Confidentiality Impact:** High (H)
  - **Integrity Impact:** High (H)
  - **Availability Impact:** None (N)

**References**
- [Show Changes](https://me.sap.com/notesLatestChanges/0002961991/E/diff)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002961991?language=en-US&token=D4EF977B123E362714860DB5375CD18D)
- [Share by Email](https://me.sap.com/notes/0002961991/share)
- [Open in New Window](https://me.sap.com/notes/0002961991/open)

**Attachments**
- None

For more details, visit the [SAP Support Portal](https://me.sap.com/).

_Credits to [RedRays](https://redrays.io) for support in providing this information._