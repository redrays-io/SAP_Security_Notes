3346500 - [CVE-2023-39439] Improper authentication in SAP Commerce Cloud

**SAP Note Number:** 3346500  
**Title:** [CVE-2023-39439] Improper authentication in SAP Commerce Cloud  
**Type:** SAP Security Note  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 12.03.2024  
**Category:** Program error  
**CVSS Score:** 8.8

---

### Description
Certain configurations of SAP Commerce Cloud may accept an empty passphrase for user ID and passphrase authentication, allowing users to log into the system without a passphrase.

**Affected Conditions:**
- The `user.password.acceptEmpty` configuration property is set to `true` (default value).
- An active user account with an empty passphrase exists.

**Circumstances Leading to Vulnerability:**
- Extensions (including custom ones) create or modify user accounts without setting a passphrase.
- Administrative actions set the passphrase to null, an empty string, or similar values.

**Impact:**
This vulnerability affects only active user accounts with an empty passphrase. Accounts with valid passphrases remain unaffected.

---

### Solution
SAP Commerce Cloud addresses this vulnerability by setting the default value of the `user.password.acceptEmpty` property to `false`. Apply the following patches to mitigate the issue:

- [SAP Commerce Cloud Patch Release 2105.25](https://notesdownloads.sap.com/note/0040000000949702023)
- [SAP Commerce Cloud Patch Release 2205.22](https://me.sap.com/help/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/f9b65161e1e645249542e59f42f64a7b.html?locale=en-US&version=v2205)
- [SAP Commerce Cloud Update Release 2211.19](https://me.sap.com/help/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/f9b65161e1e645249542e59f42f64a7b.html?locale=en-US)

**Manual Remediation Steps:**
If upgrading is not immediately possible, implement the following workaround:

1. **Edit Configuration:**
   - Open the `local.properties` file in your SAP Commerce Cloud installation.
   - Set `user.password.acceptEmpty=false`.

2. **Restart Services:**
   - After saving the changes, restart the SAP Commerce Cloud services to apply the configuration.

*Note: This workaround is temporary. It is strongly recommended to apply the official patches as a permanent solution.*

---

### CVSS Details
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

---

### Supported Software Components
- **HY_COM:** Versions 2105 and 2205
- **COM_CLOUD:** Version 2211

---

### Downloads
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000949702023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003346500?language=en-US&token=FECAD2747F8EDA5CC72037E5C110F5F9)

**For installation instructions:**
- [About Patch Releases](https://me.sap.com/help/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/8c25978386691014b4abdd61376acd24.html?locale=en-US)

---

**Credits:** Special thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.