3350297 - [CVE-2023-36922] OS command injection vulnerability in SAP ECC and SAP S/4HANA (IS-OIL)

**Overview**

SAP Security Note [3350297](https://me.sap.com/notes/3350297) addresses a critical OS command injection vulnerability identified as [CVE-2023-36922](https://www.cve.org/CVERecord?id=CVE-2023-36922) in SAP ECC and SAP S/4HANA within the IS-OIL component. This vulnerability allows an authenticated attacker to inject arbitrary operating system commands, potentially leading to unauthorized system access, data modification, or system shutdown.

**Symptom**

The vulnerability exists due to a programming error in function modules and reports within the IS-OIL component. This error permits an authenticated attacker to inject OS commands into unprotected parameters, exploiting common (default) extensions.

**Reason and Prerequisites**

- **Reason:** A program error in function modules and reports allows unauthenticated access to the application server.
- **Prerequisites:** 
  - The IS-OIL component must be enabled in your SAP system.
  - Verify the activation of the relevant business functions and switches (`OIB_QCI` and `OI0_COMMON_2`) using the `SFW_BROWSER` transaction.
  - Refer to [KBA Note 3349318](https://me.sap.com/notes/3349318) for detailed instructions on confirming IS-OIL activation.

**Solution**

The programming error has been rectified by validating input parameters against authenticated values in both reports and function modules. To mitigate the vulnerability:

1. **Implement the Security Note:**
   - Apply the correction instructions provided in [SAP Note 3350297](https://me.sap.com/notes/3350297).
   - Ensure that all prerequisites are met before implementation to avoid system disruptions.

2. **Upgrade Support Packages:**
   - Upgrade to the latest support packages as referenced in the security note to ensure comprehensive protection.

For detailed correction steps, refer to the [Correction Instructions](https://me.sap.com/corrins/0003350297/11).

**Additional Resources**

- **Download for SNOTE:** [Download](https://notesdownloads.sap.com/note/0040000000826212023)
- **PDF Version:** [Print PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003350297?language=en-US&token=006D245D32C71DF6C682EB90EC8E22BC)
- **Show Changes:** [Compare Versions](https://me.sap.com/notesLatestChanges/0003350297/E/diff)
- **Share by Email:** Use the "Share by Email" option in the SAP Note interface.
- **Open in New Window:** Use the "Open in New Window" option in the SAP Note interface.

**CVSS Details**

- **Score:** 9.1
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

**Warnings**

- This note is specific to the IS-OIL component. If IS-OIL is not active in your system, this note does not apply.
- Avoid activating IS-OIL or related business functions solely to implement this note, as it may cause irreversible changes and potential system damage.

For assistance, please raise a new case under IS-OIL-DS-HPM with relevant screenshots.

**Credits**

Thanks to [RedRays](https://redrays.io) for support in providing this information.