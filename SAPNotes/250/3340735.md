3340735 - [CVE-2023-35871] Memory Corruption Vulnerability in SAP Web Dispatcher

**Summary**

SAP has released Security Note [3340735](https://me.sap.com/notes/3340735) addressing a memory corruption vulnerability in SAP Web Dispatcher identified as [CVE-2023-35871](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-35871). This vulnerability allows unauthenticated attackers to cause memory corruption through logical errors in memory management, potentially leading to information disclosure or system crashes.

**Vulnerability Details**

- **CVE**: [CVE-2023-35871](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-35871)
- **Impact**:
  - **Confidentiality**: Low
  - **Integrity**: High
  - **Availability**: High
- **CVSS Score**: 7.7
- **Attack Vector**: Network (N)
- **Attack Complexity**: High (H)
- **Privileges Required**: None (N)
- **User Interaction**: None (N)
- **Scope**: Unchanged (U)

**Affected Components**

This vulnerability affects the following components:

- **SAP Web Dispatcher**:
  - Versions: ≤ 7.54 (if `icm/HTTP/support_http2` is set to TRUE)
  - HTTP/2 support introduced in Web Dispatcher 7.73

- **SAP NetWeaver Application Server ABAP**:
  - Affects ICM supporting HTTP/2 from kernel 7.73

- **Web Dispatcher in SAP HANA Extended Application Services Classic (XS Classic) and Advanced (XS Advanced)**

**Workaround**

To mitigate the vulnerability, disable HTTP/2 by setting the profile parameter:

```
icm/HTTP/support_http2=FALSE
```

This can be done without restarting the system via the administration UI, `wdispmon`, `sapcontrol`, or by modifying `webdispatcher.ini` for specific setups.

**Solution**

Apply the necessary patches as outlined in the security note:

- **Standalone Web Dispatcher**: Use [SAPWEBDISP.SAR](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200018813&V=MAINT) and follow SAP Note [908097](https://me.sap.com/notes/908097).

- **Embedded Web Dispatcher**: Apply `dw.sar` or `SAPEXE.SAR` and `SAPEXEDB.SAR` patches. Follow SAP Notes [2083594](https://me.sap.com/notes/2083594) for kernel patch levels and [19466](https://me.sap.com/notes/19466) for downloading patches.

Detailed instructions and additional information can be found in the respective SAP Notes and the [Update Strategy for the Kernel of the Application Server ABAP](https://support.sap.com/deployment-strategies-kernel-abap.pdf) document.

**Additional Information**

- **Released On**: 11.07.2023
- **Category**: Program error
- **Priority**: Correction with high priority
- **Status**: Released for Customer
- **SAP Component**: [BC-CST-WDP](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

For more details and to download patches:

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000826122023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003340735?language=en-US&token=6DBB6478FA47530147138CD12B806375)

**Available Translations**

Translations are available in multiple languages, including Deutsch, 日本語, Português, Español, Français, Italiano, Русский, 中文, and 한국어.

**Credits**

Thanks to [redrays.io](https://redrays.io) for support in providing this information.