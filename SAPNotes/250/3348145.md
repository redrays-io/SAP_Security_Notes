SAP Security Note 3348145 - [CVE-2023-36921] Header Injection in SAP Solution Manager (Diagnostic Agent)

**Title:** 3348145 - [CVE-2023-36921] Header Injection in SAP Solution Manager (Diagnostic Agent)

**Description:**

### Symptom
SAP Solution Manager (Diagnostics Agent) allows an attacker to tamper with headers in a client request. This misleads the SAP Diagnostics Agent to serve poisoned content to the server. On successful exploitation, the attacker can cause a limited impact on the confidentiality and availability of the application.

### Other Terms
HTTP Header Injection, SAP Solution Manager 7.2, LM-SERVICE, [CVE-2023-36921](https://www.cve.org/CVERecord?id=CVE-2023-36921)

### Reason and Prerequisites
Insufficient input validation.

### Solution
Input validation has been added for URL and header parameters.  
Apply the latest LM_SERVICE version containing the fix. To understand the upgrade process, kindly refer to [SAP Note 2686969](https://me.sap.com/notes/2686969).

**CVSS:**
- **Score:** 7.2
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L
  - **Attack Vector:** Network (N)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** None (N)
  - **User Interaction:** None (N)
  - **Scope:** Changed (C)
  - **Confidentiality Impact:** Low (L)
  - **Integrity Impact:** None (N)
  - **Availability Impact:** Low (L)

**Affected Component:**
- **Component:** Service > SAP Solution Manager > Diagnostics > Infrastructure / Framework > Agent Framework (SV-SMG-DIA-SRV-AGT)

**Released On:** July 11, 2023  
**Priority:** Correction with high priority  
**Status:** Released for Customer

**References:**
- [How to Upgrade the LM-SERVICE Patch Level (Note 2686969)](https://me.sap.com/notes/2686969)

**Support Package Patches for SOLMANDIAG 720:**
- [SP009 Patch 000029](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP009&patch_level=000029)
- [SP010 Patch 000022](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP010&patch_level=000022)
- [SP011 Patch 000020](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP011&patch_level=000020)
- [SP012 Patch 000020](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP012&patch_level=000020)
- [SP013 Patch 000011](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP013&patch_level=000011)
- [SP014 Patch 000013](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP014&patch_level=000013)

**Downloads:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000826482023)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003348145?language=en-US&token=FE733E3FAB6EC39ED8DB8B22715C9CBB)

**Credits:** Thanks to [redrays.io](https://redrays.io) for support in providing this information.