1511751 - Unauthorized usage of application functionality in SNC

**SAP Security Note Number**: 1511751  
**Type**: SAP Security Note  
**Version**: 4  
**Recency**: New  
**Language**: English  
**Master Language**: English  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer  
**Released On**: 14.12.2010  
**Component**: Supply Chain Management > SCM Basis > UI Framework  
**Download for SNOTE**: [Download](https://me.sap.com/note/0040000008958932017)  
**PDF Version**: [Download PDF](https://me.sap.com/sap/support/sfm/notes/print/0001511751?language=en-US&token=87215CDBD33AFBD1DD774D1FEEA52DE3)

### Description

#### Symptom
A malicious user can trigger functionality in SNC without authentication and authorization.

#### Other Terms
Cross-Site Request Forgery, XSRF

#### Reason and Prerequisites
SNC executes certain functions through referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the user.
If present, the attacker may use a Cross Site Scripting attack to trigger the exploit, or use an approach in which a link to click is presented to the victim.

### Solution
Perform the attached manual corrections.
- As a pre-requisite, install [Note 1508661](https://me.sap.com/note/1508661).
- For SNC releases 7.0 and below, as a pre-requisite, install [Note 1520324](https://me.sap.com/note/1520324).

### Correction Instructions
1. Execute report `/SCF/BSP_XSRF_PARAM_SNC`.
2. Delete the following BSP applications:
   - `/SCF/CB_HTML`
   - `/SCF/COLLABORATION`
   - `/SCF/STYLES`
   - `/SCF/UIBSP`
3. For each application:
   - Log in to the SNC system and start transaction SE80.
   - Click "Repository Browser" and choose "BSP Application".
   - Enter the application name and press Enter or click the display button.
   - Right-click the application name and choose "Delete".

### Attachments
- [ZBSP_XSRF_PARAM_SNC_500.txt](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000401432010&iv_version=0004&iv_guid=B82D5DB56F85C84D9A4ECB021746E1BA) (1 KB)

### References
- [1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/note/1540729)
- [1520324 - Advance creation of XSRF information](https://me.sap.com/note/1520324)
- [1508661 - Note icons are not consistent within SNC](https://me.sap.com/note/1508661)

### Validity
This note is valid for the following software components:
- **SCMSNC**: 510, 700, 701
- **SCM_BASIS**: 410, 500

### Support Packages
Ensure you have the required support packages installed:
- [SAPK-41021INSCMBASIS](https://me.sap.com/supportpackage/SAPK-41021INSCMBASIS) for SCM_BASIS 410
- [SAPK-50019INSCMBASIS](https://me.sap.com/supportpackage/SAPK-50019INSCMBASIS) for SCM_BASIS 500
- [SAPK-51015INSCMSNC](https://me.sap.com/supportpackage/SAPK-51015INSCMSNC) for SCMSNC 510
- [SAPK-70009INSCMSNC](https://me.sap.com/supportpackage/SAPK-70009INSCMSNC) for SCMSNC 700
- [SAPK-70103INSCMSNC](https://me.sap.com/supportpackage/SAPK-70103INSCMSNC) for SCMSNC 701

### Preconditions
- Ensure the following notes are installed:
  - [1511751 - Unauthorized usage of application functionality in SNC](https://me.sap.com/note/1511751)
  - [1508661 - Note icons are not consistent within SNC](https://me.sap.com/note/1508661)
  - [1031144 - The user session is NOT canceled when navigate away from ICH](https://me.sap.com/note/1031144)
  - [891932 - ICH: browser pop-up blocker causes locking problems](https://me.sap.com/note/891932)
  - [910307 - Security Note, ICH Input-Output validation](https://me.sap.com/note/910307)

**Credits**: Information supported by [RedRays.io](https://redrays.io).