1511541 - Unauthorized usage of application functionality of ISR / BSP

**SAP Note Number:** [1511541](https://me.sap.com/support/notes/1511541)

**Title:** Unauthorized usage of application functionality of ISR / BSP

**Description:**

A malicious user can trigger functionality of BSP based ISR Forms without authentication and authorization.

**Other Terms:**

ISR_DEMO1, ISR_DEMO01, Cross-Site Request Forgery, XSRF, Internal Service Request

**Reason and Prerequisites:**

ISR executes certain functions through referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the user.

If present, the attacker may use a Cross Site Scripting attack to trigger the exploit, or use an approach in which a link to click is presented to the victim.

**Solution:**

1. Refer to [note 1520324](https://me.sap.com/support/notes/1520324) for additional information and instructions. The corrections from note 1520324 are a prerequisite for implementation of this note.

2. Implement the correction instructions of this note. This will also create the reports `BSP_XSRF_PARAM_ISR` and `BSP_XSRF_PARAM_ISR_EA_APPL` in your system.

3. Execute the reports `BSP_XSRF_PARAM_ISR` and `BSP_XSRF_PARAM_ISR_EA_APPL` and specify a corresponding transport request number when prompted. The report will fill the database table `BSPTEMPXSRFSTORE` with corresponding table entries for the BSP applications adapted by this note.

**Affected Components:**

- **Component:** Controlling > Overhead Cost Controlling (CO-OM)
- **Software Components:** 
  - SAP_APPL: Versions 500 to 605
  - EA-APPL: Versions 500 to 605

**Support Packages:**

- [SAP_APPL 500 - SAPKH50025](https://me.sap.com/supportpackage/SAPKH50025)
- [EA-APPL 500 - SAPKGPAC25](https://me.sap.com/supportpackage/SAPKGPAC25)
- [SAP_APPL 600 - SAPKH60019](https://me.sap.com/supportpackage/SAPKH60019)
- [EA-APPL 600 - SAPKGPAD19](https://me.sap.com/supportpackage/SAPKGPAD19)
- [SAP_APPL 602 - SAPKH60209](https://me.sap.com/supportpackage/SAPKH60209)
- [EA-APPL 602 - SAPK-60209INEAAPPL](https://me.sap.com/supportpackage/SAPK-60209INEAAPPL)
- ... *(additional support packages can be added similarly)*

**References:**

This document refers to:

- [1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/support/notes/1540729)

This document is referenced by:

- [1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/support/notes/1540729)

**Available Languages:**

- [Deutsch](https://me.sap.com/notes/0001511541/D)
- [日本語](https://me.sap.com/notes/0001511541/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001511541/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001511541/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001511541/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001511541/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001511541/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001511541/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001511541/3)

**Download Links:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008957502017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001511541?language=en-US&token=52C3A682B3E7E76B87A3E52EAC5D19BA)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001511541/E/diff)

**Credits:**
Credits to [redrays.io](https://redrays.io) for support to provided information.