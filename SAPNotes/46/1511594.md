SAP Security Note 1511594: Unauthorized usage of application Customer Bill of Services.

**Description**
---
A malicious user can trigger functionality in the Bill of Services without proper authentication and authorization. Specifically, the user can create new service entry sheets without the necessary permissions.

**Symptoms**
- Unauthorized creation of service entry sheets in the Bill of Services application.

**Other Terms**
- Cross-Site Request Forgery (XSRF)
- BOS02, BOS02_WAP

**Reason and Prerequisites**
BOS executes certain functions by referencing specific URLs. An attacker can trick an authenticated user's browser into making a request with a malicious URL and specific parameters. This causes the function to execute with the user's rights. Attackers may use Cross Site Scripting (XSS) to trigger the exploit or present a malicious link to the victim.

**Solution**
1. **Prerequisite:** Refer to [SAP Note 1481392](https://me.sap.com/notes/1481392) for additional information and instructions. Implementing the corrections from this note is mandatory before proceeding.
2. **Implement Corrections:** Follow the correction instructions outlined in this note. This will create the report `RITS_XSRF_PARAM_BOS02` in your system.
3. **Execute Report:** Run the report `RITS_XSRF_PARAM_BOS02` and provide a corresponding transport request number when prompted. This report will add service parameters for the adapted ITS services, which can be maintained via the GUI configuration pushbutton for a service within transaction SICF.

**Affected Software Components**
- **ECC-DIMP** Versions 500, 600, 602, 603, 604, 605

**Support Packages**
- **ECC-DIMP 500:** [SAPKIPMH14](https://me.sap.com/supportpackage/SAPKIPMH14)
- **ECC-DIMP 600:** [SAPK-60019INECCDIMP](https://me.sap.com/supportpackage/SAPK-60019INECCDIMP)
- **ECC-DIMP 602:** [SAPK-60209INECCDIMP](https://me.sap.com/supportpackage/SAPK-60209INECCDIMP)
- **ECC-DIMP 603:** [SAPK-60308INECCDIMP](https://me.sap.com/supportpackage/SAPK-60308INECCDIMP)
- **ECC-DIMP 604:** [SAPK-60409INECCDIMP](https://me.sap.com/supportpackage/SAPK-60409INECCDIMP)
- **ECC-DIMP 605:** [SAPK-60503INECCDIMP](https://me.sap.com/supportpackage/SAPK-60503INECCDIMP)

**Correction Instructions**
- **Software Component:** ECC-DIMP
- **Number of Correction Instructions:** 2
- **Details:** [Correction Instructions 1511594](https://me.sap.com/corrins/0001511594/591)

For more detailed information, refer to the [full SAP Security Note 1511594](https://notesdownloads.sap.com/note/0040000008957892017).

---

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*