1648395 - Unauthorized modification of displayed content in CA-AUD

**SAP Note/KBA:** 1648395  
**Type:** SAP Security Note  
**Version:** 3  
**Recency:** New  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 10.04.2012  
**Component:** CA-AUD (Cross-Application Components > PLM Audit Management)

### Description

This security note addresses a vulnerability in the CA-AUD component that allows unauthorized modification of displayed application content through reflected cross-site scripting (XSS).

### Symptom

An attacker can abuse CA-AUD to modify displayed content without authorization and potentially obtain authentication information from other legitimate users.

### Affected Software Components

- **Software Component:** SAP_ABA  
  - Versions: 700 to 702, 710 to 711, 731

### Reason and Prerequisites

The API interface within CA-AUD does not sufficiently encode input parameters, resulting in a reflected XSS issue. This vulnerability can enable an attacker to:

- Deface or modify website content.
- Steal user authentication information.
- Impersonate users, including administrators, potentially compromising the entire application.

### Solution

To mitigate this vulnerability:

1. **Replace the HTTP Handler:**
   - Replace `CL_PLM_AUDIT_HTTP_PDF_VIEWER` with a custom handler.
2. **Delete the Outdated HTTP Handler:**
   - Remove the outdated HTTP handler of SAP.

**Manual Activity:**

Delete the class `CL_PLM_AUDIT_HTTP_PDF_VIEWER` within the class builder (SE24).

### Support Packages

Ensure that the appropriate support packages are applied for your system version:

- [SAPKA70026](https://me.sap.com/supportpackage/SAPKA70026) for SAP_ABA 700
- [SAPKA70111](https://me.sap.com/supportpackage/SAPKA70111) for SAP_ABA 701
- [SAPKA70211](https://me.sap.com/supportpackage/SAPKA70211) for SAP_ABA 702
- [SAPKA71014](https://me.sap.com/supportpackage/SAPKA71014) for SAP_ABA 710
- [SAPKA71109](https://me.sap.com/supportpackage/SAPKA71109) for SAP_ABA 711
- [SAPKA73102](https://me.sap.com/supportpackage/SAPKA73102) for SAP_ABA 731

### Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009788872017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001648395?language=en-US&token=F42A29EF8EC62EE99EE247E29CAAF3E3)

### Translations

This note is available in multiple languages:

- [日本語](https://me.sap.com/notes/0001648395/J)  
- [Deutsch](https://me.sap.com/notes/0001648395/D)  
- [Português (Machine Translation)](https://me.sap.com/notes/0001648395/P)  
- [Español (Machine Translation)](https://me.sap.com/notes/0001648395/S)  
- [Français (Machine Translation)](https://me.sap.com/notes/0001648395/F)  
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001648395/I)  
- [Русский (Machine Translation)](https://me.sap.com/notes/0001648395/R)  
- [中文 (Machine Translation)](https://me.sap.com/notes/0001648395/1)  
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001648395/3)

---

*Credits to [Redrays.io](https://redrays.io) for supporting the information provided.*