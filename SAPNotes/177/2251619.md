Missing authorization check in Audit Functions of DBA Cockpit (SAP Note 2251619)

```markdown
**SAP Security Note 2251619**  
*Missing authorization check in Audit Functions of DBA Cockpit*

---

### **Overview**
- **Type:** SAP Security Note
- **Version:** 1
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 12.01.2016
- **Component:** Basis Components > Database Interface, Database Platforms > DB2 Universal Database for Unix / NT > CCMS/Database Monitors

### **Symptom**
The DBA Cockpit infrastructure contains function modules for auditing, which are not protected by authority checks.

---

### **CVSS Information**
- **CVSS Base Score:** 4.9 / 10
- **Attack Vector:** Network (N)
- **Access Complexity:** Medium (M)
- **Authentication:** Single (S)
- **Confidentiality Impact:** Partial (P)
- **Integrity Impact:** Partial (P)
- **Availability Impact:** None (N)

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. It does not account for your system configuration or operational environment.*

---

### **Reason and Prerequisites**
DBA Cockpit infrastructure for auditing does not contain authorization checks for verifying an authenticated user's authorization to access certain functions. This may result in undesired system behavior.

---

### **Solution**
An authorization check of authorization object `S_RZL_ADM` will be added to the affected functions. The related changes will be delivered via a support package. You can also implement the changes in advance by applying the assigned correction instructions.

---

### **Correction Instructions**
1. **Start Transaction SE37.**
2. **Enter Function Module: `DB6_ADM_WRITE_AUDIT_LOG`.**
   1. Click **Change** to start the editor.
   2. Navigate to the **Source Code** tab.
   3. Before the first line of code, add the following:
      ```abap
      AUTHORITY-CHECK OBJECT 'S_RZL_ADM' ID 'ACTVT' FIELD '01'.
      IF sy-subrc <> 0.
        EXIT.
      ENDIF.
      ```
4. **Save and activate** the changes.
5. **Repeat** the above steps for the function modules `DB6_ADM_READ_AUDIT_LOG` and `DB6_ADM_READ_AUDIT_LOG_DETAILS`.

---

### **Support Packages**
Ensure you have the latest support packages applied for your SAP_BASIS component. Relevant support packages include:
- [SAPKB70033](https://me.sap.com/supportpackage/SAPKB70033) for SAP_BASIS 700
- [SAPKB70118](https://me.sap.com/supportpackage/SAPKB70118) for SAP_BASIS 701
- [SAPKB70218](https://me.sap.com/supportpackage/SAPKB70218) for SAP_BASIS 702
- [SAPKB71021](https://me.sap.com/supportpackage/SAPKB71021) for SAP_BASIS 710
- [SAPKB71116](https://me.sap.com/supportpackage/SAPKB71116) for SAP_BASIS 711
- [SAPKB73015](https://me.sap.com/supportpackage/SAPKB73015) for SAP_BASIS 730
- [SAPKB73118](https://me.sap.com/supportpackage/SAPKB73118) for SAP_BASIS 731
- [SAPKB74014](https://me.sap.com/supportpackage/SAPKB74014) for SAP_BASIS 740
- [SAPK-75002INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75002INSAPBASIS) for SAP_BASIS 750

---

For more detailed information, refer to the [official SAP Security Notes](https://me.sap.com/notes/2251619).

---

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*