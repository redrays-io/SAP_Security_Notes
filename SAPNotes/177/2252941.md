SAP Security Note 2252941 - Potential Information Disclosure in SAP HANA Export Function

**SAP Security Note 2252941 - Potential Information Disclosure Relating to Files Exported from SAP HANA with EXPORT Statement**

**Type:** SAP Security Note  
**Version:** 2  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** January 12, 2016  
**Component:** SAP HANA Database (HAN-DB)

---

### **Symptom**
SAP HANA users with the system privilege `EXPORT` can export table content to the server's file system. These exported files can contain confidential content (depending on the exporting user's actions and privileges). Other users with access to the server's file system can access these files depending on the file access privileges on the file system level.

### **CVSS Information**
- **Base Score:** 1.7 / 10
- **Vector:**
  - **AV:** Local (L)
  - **AC:** Low (L)
  - **Au:** Single (S)
  - **C:** Partial (P)
  - **I:** None (N)
  - **A:** None (N)

### **Reason and Prerequisites**
If the exported file's access permissions on the file system are set too broadly, other users at the operating system level can access the file. SAP HANA's previous default for the file access permissions of exported files was `644` on Linux, making them readable by all operating system users on the server.

### **Solution**
An improvement for the security of the export function has been added. A configuration option for adjusting the access permissions for the exported files is now available. The SAP HANA administrator can configure the access permissions set by HANA for exported files in the `indexserver.ini` configuration file, under the `[import_export]` section, using the `file_security` parameter. The available settings are:

- **high:** Exported files are readable and writable only by the owner (`600` on Linux).
- **medium:** Exported files are readable and writable by the owner and readable by the group (`640` on Linux). *[Default]*
- **low:** Exported files are readable by all users and writable by the owner and group only (`664` on Linux).

This configuration option and the changed default are available with HANA SPS11 (revision 110) and with revision 102.03 for SPS10.

### **Workaround**
- **Operating System Level:** Restrict access to the files by limiting user access to the server. Additionally, set the file access permissions for the exported files to the desired values using operating system tools.
- **Database Level:** Grant `EXPORT/IMPORT` privileges to a restricted set of users only.

### **References**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018221252017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002252941?language=en-US&token=1E96AFC8F9707F1C159498AEAC097927)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002252941)

### **Available Languages**
- Deutsch
- Japanese (Machine Translation)
- Portuguese (Machine Translation)
- Español (Machine Translation)
- Français (Machine Translation)
- Italiano (Machine Translation)
- Русский (Machine Translation)
- 中文 (Machine Translation)
- 한국어 (Machine Translation)

### **Software Components Affected**
- **SAP HANA Database (HDB):** 1.00 to 1.00

### **Support Package Patches**
- **SAP HANA DATABASE 1.00**
  - **SP110 Patch Level 000000:** [View Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP110&patch_level=000000)
  - **SP102 Patch Level 000003:** [View Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP102&patch_level=000003)

For more details, visit the [SAP Support Notes](https://me.sap.com/support/sfm/notes).

---

*Information provided by [redrays.io](https://redrays.io) for support and information sourcing.*