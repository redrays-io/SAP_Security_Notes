2197100 - OS injection through call of function module by SM37

**SAP Security Note 2197100 Summary**

**Title:** OS injection through call of function module by SM37

**CVSS Base Score:** 7.1 / 10

**CVSS Vector:**
- **Access Vector:** Network (N)
- **Access Complexity:** High (H)
- **Authentication:** Single (S)
- **Confidentiality Impact:** Complete (C)
- **Integrity Impact:** Complete (C)
- **Availability Impact:** Complete (C)

### Description
A security vulnerability has been identified that allows OS injection through the call of the function module `SCTC_REFRESH_EXPORT_USR_CLNT` using transaction SM37.

### Affected Releases
- **Release 7.00 SAP_BASIS SP22 - SP31**
- **Release 7.01 SAP_BASIS SP07 - SP16**
- **Release 7.02 SAP_BASIS SP05 - SP16**
- **Release 7.10 SAP_BASIS SP11 - SP18**
- **Release 7.11 SAP_BASIS SP06 - SP13**
- **Release 7.30 SAP_BASIS SP00 - SP12**
- **Release 7.31 SAP_BASIS SP00 - SP14**
- **Release 7.40 SAP_BASIS SP00 - SP09**

### Solution

**If you do not have the PCAI_ENT add-on installed:**

1. **Apply the Latest Support Package:**
   - [Release 7.00 SAP_BASIS SP32](https://me.sap.com/notes/2197100)
   - [Release 7.01 SAP_BASIS SP17](https://me.sap.com/notes/2197100)
   - [Release 7.02 SAP_BASIS SP17](https://me.sap.com/notes/2197100)
   - [Release 7.10 SAP_BASIS SP20](https://me.sap.com/notes/2197100)
   - [Release 7.11 SAP_BASIS SP15](https://me.sap.com/notes/2197100)
   - [Release 7.30 SAP_BASIS SP13](https://me.sap.com/notes/2197100)
   - [Release 7.31 SAP_BASIS SP15](https://me.sap.com/notes/2197100)
   - [Release 7.40 SAP_BASIS SP10](https://me.sap.com/notes/2197100)

2. **Modify the Function Module `SCTC_REFRESH_EXPORT_USR_CLNT`:**
   - **Step 1:** Go to transaction **SE37**.
   - **Step 2:** Change the function module `SCTC_REFRESH_EXPORT_USR_CLNT`.
   - **Step 3:** Mark all code except the first and last lines as comments.
   - **Step 4:** Ensure the first and last lines are not commented out.
   - **Step 5:** Activate the function module.

3. **Enforce Security Rules to Mitigate Risks:**
   - Control access to transaction **SE37** using authorization object **S_DEVELOP**, type **FUGR**, and activity **16** (execute).
   - Control access to transaction **SE24** using authorization object **S_DEVELOP**, type **CLAS**, and activity **16** (execute).
   - Control access to authorization objects **S_C_FUNCT** and **S_DATASET**.

**If you have the PCAI_ENT add-on installed:**

1. **Apply the Latest Support Package** *(same as above)*.
2. **Implement [SAP Note 2039075 System Copy: Task Content (8. Improvements)](https://me.sap.com/notes/2039075)*.

   - This will result in the function module `SCTC_REFRESH_EXPORT_USR_CLNT` being disabled when called via transaction SE37.

### Additional Information
- For more details, visit the [SAP Security Notes](https://me.sap.com/securitynotes) page.
- Always conduct a risk assessment based on your system configuration and operational environment before applying security notes.

**Credits:** Supported by [redrays.io](https://redrays.io).