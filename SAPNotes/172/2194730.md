2194730 - Multiple vulnerabilities in SAP Mobile Document Android Client

### Symptom

Multiple vulnerabilities have been discovered in SAP Mobile Document Android Client.

- **Missing authentication check**: During OAuth authentication in SAP Mobile Documents Android Client, SSL errors are silently ignored and the login continues without any errors or warnings.

- **CVSS Information**

  **CVSS Base Score**: 6.8 / 10  
  **CVSS Base Vector**:

  | Key                                                   | Value          |
  |-------------------------------------------------------|----------------|
  | AV : Access Vector (Related exploit range)            | Network (N)    |
  | AC : Access Complexity (Required attack complexity)   | Medium (M)     |
  | Au : Authentication (Level of authentication needed) | None (N)       |
  | C : Impact to Confidentiality                        | Partial (P)    |
  | I : Impact to Integrity                              | Partial (P)    |
  | A : Impact to Availability                           | Partial (P)    |

  SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).

- **FileContentProvider information disclosure**: Data stored in SAP Mobile Documents application space is also accessible to other applications when viewing a document through an external viewer. (CVSS Score: 1.9, LMN\|PNN)

### Other Terms

SSL, OAuth, SAP Mobile Document Android Client, SAP Mobile Documents, Content Provider

### Reason and Prerequisites

1. **Missing authentication check**: SSL errors were ignored by SAP Mobile Document Android Client for OAuth authentication.
2. **FileContentProvider information disclosure**: Since SAP Mobile Documents content provider is not protecting the following paths: `/downloaded/`, `/synched/`, `/cached/`, they are accessible from other applications.

### Solution

1. **Missing authentication check**: If an SSL error occurs, the login process is aborted and the user is presented with the login screen.
2. **FileContentProvider information disclosure**: SAP Mobile Documents content provider is no longer exported and URI Permission is added while viewing a document through an external viewer. By adding URI Permission and setting the exported flag to false, other directories like `/downloaded/`, `/synced/`, and `/cached/` files will not be accessible.

These fixes are available from SAP Mobile Document Android Client version **1.4.4**.

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018129512017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002194730?language=en-US&token=2978C71D47386175B87A7CC620F07996)

*Credits to [Red Rays](https://redrays.io) for support to provided information.*