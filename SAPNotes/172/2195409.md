2195409 - Potential modification/disclosure of persisted data in SAP CPQ Solution Configuration (SME)

## SAP Security Note 2195409: Potential Modification/Disclosure of Persisted Data in SAP CPQ Solution Configuration (SME)

**Type:** SAP Security Note  
**Version:** 1  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 06.05.2016  
**Component:** LO-SLC (Logistics - General > Solution Configuration)  

### Symptom

An attacker can exploit SAP CPQ Solution Configuration and use specially crafted inputs to modify database commands. This results in either the retrieval of additional information or the modification of data persisted by the system.

### Other Terms

SQL injection, database, SAP CPQ Solution Configuration

### Reason and Prerequisites

The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by an attacker. The manipulated SQL statement can then be used to retrieve additional data from the database or to modify the data.

### Solution

Please implement this correction note.

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000012998802017](https://notesdownloads.sap.com/note/0040000012998802017)
- **PDF Version:** [https://me.sap.com/support/sfm/notes/print/0002195409?language=en-US&token=49D9059673E60FD8A98038E7E0A62817](https://me.sap.com/support/sfm/notes/print/0002195409?language=en-US&token=49D9059673E60FD8A98038E7E0A62817)

### Correction Instructions

To address the SQL injection vulnerability, follow these steps to create and assign the necessary authorization role:

1. Start transaction `PFCG`.
2. Enter Role name `/SLCE/SME`.
3. Click on "Edit".
4. Select the "Authorizations" tab.
5. Select "Change authorization Data".
6. Do not select a template.
7. Choose "Manually" for "Manual entry of authorization objects".
8. In the popup, enter `S_TABU_NAM` and confirm.
9. Expand the hierarchy under the role name to locate "Activity" and "Table Name".
10. Select "Change activity" and set it to "Display".
11. Save and transfer.
12. Select "Change Table name" and enter the following patterns:
    - `COMM_CFG*`
    - `/1SAP1/*`
13. Save and transfer.
14. Save the role.
15. The system will generate a default profile. You may specify a custom name or accept the default.
16. Click on "Generate" to start the generation process.

### References

- **Support Package:** [SAPK-60506INSLCE](https://me.sap.com/supportpackage/SAPK-60506INSLCE)

For more detailed instructions and additional information, please refer to the official SAP note.

*Credits: [redrays.io](https://redrays.io) for support in providing this information.*