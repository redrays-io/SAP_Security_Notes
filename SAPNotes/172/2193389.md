2193389 - Potential modification/disclosure of persisted data in SAP Batch Processing

---

**SAP Note Number:** 2193389  
**Title:** Potential modification/disclosure of persisted data in SAP Batch Processing  
**Type:** SAP Security Note  
**Version:** 4  
**Recency:** Updated  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 08.10.2015  
**Component:** Basis Components > Computer Center Management System (CCMS) > Background Processing (BC-CCM-BTC)  

### Symptom

An attacker can exploit SAP Batch Processing and use specially crafted inputs to modify database commands. This results in either the retrieval of additional information or the modification of data persisted by the system.

#### CVSS Information

- **Base Score:** 4.6 / 10
- **Vector:**
  - **Attack Vector (AV):** Network (N)
  - **Access Complexity (AC):** High (H)
  - **Authentication (Au):** Single (S)
  - **Confidentiality Impact (C):** Partial (P)
  - **Integrity Impact (I):** Partial (P)
  - **Availability Impact (A):** Partial (P)

*Note: SAP provides this CVSS base score as an estimate of the risk. It does not account for specific system configurations or environments.*

### Reason and Prerequisites

The issue is caused by an SQL injection vulnerability in the function `BP_FIND_JOBS_WITH_PROGRAM`. The code constructs an SQL statement containing strings that can be altered by an attacker, allowing manipulation to retrieve or modify database data.

### Solution

Implement the provided correction to secure the dynamic SQL implementation in the `BP_FIND_JOBS_WITH_PROGRAM` function. Apply the relevant Support Package as mentioned in this SAP Note or follow the respective correction instructions.

**Download Options:**
- [Download for SNOTE](https://me.sap.com/notes/0040000012987392017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002193389?language=en-US&token=14BB95AFD1811CC50BB4977A1F1A4CC8)

**Support Package Details:**
- **SAP_BASIS 700:** [SAPKB70033](https://me.sap.com/supportpackage/SAPKB70033)
- **SAP_BASIS 701:** [SAPKB70118](https://me.sap.com/supportpackage/SAPKB70118)
- **SAP_BASIS 702:** [SAPKB70218](https://me.sap.com/supportpackage/SAPKB70218)
- **SAP_BASIS 710:** [SAPKB71021](https://me.sap.com/supportpackage/SAPKB71021)
- **SAP_BASIS 711:** [SAPKB71116](https://me.sap.com/supportpackage/SAPKB71116)
- **SAP_BASIS 730:** [SAPKB73014](https://me.sap.com/supportpackage/SAPKB73014)
- **SAP_BASIS 731:** [SAPKB73117](https://me.sap.com/supportpackage/SAPKB73117)
- **SAP_BASIS 740:** [SAPKB74013](https://me.sap.com/supportpackage/SAPKB74013)
- **SAP_BASIS 750:** [SAPK-75001INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75001INSAPBASIS)

### Prerequisites

Ensure the following SAP Notes are applied to your system:
- [1502272 - Function module for escaping quotes](https://me.sap.com/notes/1502272)
- [1487337 - Downporting the class CL_ABAP_DYN_PRG](https://me.sap.com/notes/1487337)
- [1850709 - Access to unsorted data by programs of SAP_BASIS](https://me.sap.com/notes/1850709)
- [2107411 - Improved error messages for job API](https://me.sap.com/notes/2107411)

### Additional Actions

- **Download SNOTE:** [Download for SNOTE](https://me.sap.com/notes/0040000012987392017)
- **Print PDF:** [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002193389?language=en-US&token=14BB95AFD1811CC50BB4977A1F1A4CC8)
- **Show Changes:** [Show Changes](https://me.sap.com/notesLatestChanges/0002193389/E/diff)
- **Share by Email:** Use the event option on the SAP support portal.
- **Open in New Window:** Use the event option on the SAP support portal.

For more details, visit the [SAP Security Notes](https://me.sap.com/securitynotes).

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*