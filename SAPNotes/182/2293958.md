Missing communication security for SAP HANA daemon service

**Symptom**

The daemon service in a SAP HANA landscape is used to start, stop, and restart all SAP HANA services. For the daemon service, communication encryption was not being enabled.

Potential attackers could cause a denial of service by stopping or restarting the instance if they:

- Gain access to the operating system of the SAP HANA system with an authorized user or
- Can access the network configured for SAP HANA's internal network configuration.

**CVSS Information**

**CVSS v3 Base Score:** 5.7 / 10

**CVSS v3 Base Vector:**

| Metric                    | Value           |
|---------------------------|-----------------|
| **Attack Vector (AV)**    | Adjacent (A)    |
| **Attack Complexity (AC)**| Low (L)         |
| **Privileges Required (PR)** | Low (L)     |
| **User Interaction (UI)** | None (N)        |
| **Scope (S)**             | Unchanged (U)   |
| **Confidentiality Impact (C)** | None (N)  |
| **Integrity Impact (I)**  | None (N)        |
| **Availability Impact (A)** | High (H)      |

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://me.sap.com/securitynotes) on SAP's security notes page.

**Other Terms**

- SAP HANA internal communication
- Service to service TLS/SSL

**Reason and Prerequisites**

The issue only affects customers who enabled TLS/SSL encryption for internal communication channels. In such cases, TLS/SSL for the daemon service was not enabled.

This affects SAP HANA systems in the following scenarios:

1. **Multi-tenant database container scenario with high isolation mode**
   - TLS/SSL for internal communication is enabled by default.
   - Available since SAP HANA SPS10.

2. **SAP HANA extended application services, advanced model installed on the same server as the SAP HANA system**
   - TLS/SSL for internal communication is enabled by default.
   - Available since SAP HANA SPS11.

3. **Customer explicitly enabled TLS/SSL for internal communication.**

Details on how to check the settings of your system can be found in the documentation ([SAP HANA Security Checklists and Recommendations](http://help.sap.com/hana/SAP_HANA_Security_Checklists_and_Recommendations_en.pdf), Chapter 5).

**Solution**

Communication encryption for the SAP HANA daemon service is available with SAP HANA SPS12.

1. **Check Configuration:**
   - Ensure your SAP HANA system is configured according to SAP recommendations regarding access to internal communication ports.
   - Refer to [SAP Note 2183363](https://me.sap.com/notes/2183363) for settings related to SAP HANA internal communication.

2. **Upgrade:**
   - Upgrade to HANA SPS12 or later if you are using one of the affected scenarios and require additional protection against authenticated operating system users while relying on TLS/SSL for internal communication security.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018282762017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002293958?language=en-US&token=C480E43A62B3A89BC40552F83C940577)

**References**

- [SAP Note 2183363 - Configuration of SAP HANA internal network](https://me.sap.com/notes/2183363)

**Software Components**

| Software Component | From | To  |
|--------------------|------|-----|
| HDB                | 1.00 | 1.00|

**Support Package Patches**

| Software Component Version | Support Package | Patch Level | URL |
|----------------------------|-----------------|-------------|-----|
| SAP HANA DATABASE 1.00     | SP120           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP120&patch_level=000000) |

**Credit**

Credits to [redrays.io](https://redrays.io) for support in providing this information.