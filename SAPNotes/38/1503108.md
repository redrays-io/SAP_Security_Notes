1503108 - Directory traversal in programs PKRT_DEPS_ANALYSIS*

## Description

**Symptom**

Programs `PKRT_DEPS_ANALYSIS` and `PKRT_DEPS_ANALYSIS_PREPARE` contain a vulnerability that allows a malicious user to write arbitrary files on the remote server. This can potentially corrupt data or alter system behavior. These programs are internal analysis tools not intended for productive system use and are not executed from any standard transaction.

**Other Terms**

- Directory
- Traversal

**Reason and Prerequisites**

The vulnerability arises because `PKRT_DEPS_ANALYSIS` and `PKRT_DEPS_ANALYSIS_PREPARE` fail to correctly validate the file name specified by a user before writing to and reading from that file. As a result, an attacker can overwrite data on the remote system.

## Affected Software Components

- **SAP_BASIS**
  - Versions: 711, 720, 730
  - Components Path:
    - Basis Components > ABAP Runtime Environment - ABAP Language Issues Only > Syntax, Compiler, Runtime

## Solution

Install the recommended support package to disable the vulnerable programs `PKRT_DEPS_ANALYSIS` and `PKRT_DEPS_ANALYSIS_PREPARE`.

## Support Packages

- **SAP_BASIS 711**
  - [SAPKB71106](https://me.sap.com/supportpackage/SAPKB71106)
- **SAP_BASIS 720**
  - [SAPKB72004](https://me.sap.com/supportpackage/SAPKB72004)
- **SAP_BASIS 730**
  - [SAPKB73001](https://me.sap.com/supportpackage/SAPKB73001)

## Additional Resources

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008897192017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001503108?language=en-US&token=8790FBA86569407BB5DAA82BCA791B0B)

## Available Languages

This SAP Security Note is available in the following languages:

- [Deutsch](https://me.sap.com/notes/0001503108/D)
- [日本語](https://me.sap.com/notes/0001503108/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001503108/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001503108/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001503108/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001503108/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001503108/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001503108/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001503108/3)

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*