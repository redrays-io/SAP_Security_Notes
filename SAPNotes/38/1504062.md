1504062 - SCM: Potential Directory Traversal

**Header Data**
- **SAP Note/KBA:** 1504062
- **Type:** SAP Security Note
- **Version:** 1
- **Recency:** New
- **Language:** English
- **Master Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Release Status:** Released for Customer
- **Released On:** 14.12.2010
- **Component:** Supply Chain Management > Advanced Planning and Optimization > Demand Planning > Basic Functions

**Description**
### Symptom
Potential Directory Traversal in the following component:

- SCM-APO-FCS-BF

### Other Terms
Path traversal, Character Combinations Upload from Server, Generate List with TSDM Combinations, Realignment of Characteristic value combination using a spreadsheet as a source

### Reason and Prerequisites
1. The programs contained in the correction instructions contain vulnerabilities through which a malicious user can potentially read arbitrary files on the remote server, possibly disclosing confidential information.
2. Some of the programs contained in the correction instructions contain a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

### Solution
Please refer to [note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The corrections from note 1497003 are a prerequisite for implementation of this note.

**Logical File Names Used in this Solution**
The following logical file names have been created to enable the validation of physical file names:

- **/SAPAPO/TSDM_PLOB_LIST_GENER:**
  - Programs using this logical file name and parameters used in this context:
    - /SAPAPO/TSDM_PLOB_LIST_GENER
  - Parameters used in this context:
    - NA

- **/SAPAPO/FCS_CHAR_COMBIS_CREATE:**
  - Programs using this logical file name and parameters used in this context:
    - The generated programs for CVC maintenance for the Planning Object Structure (generated out of /SAPAPO/TS_PSTRU_SAMPLE)
  - Parameters used in this context:
    - NA

- **/SAPAPO/FCS_RLGCOPY:**
  - Programs using this logical file name and parameters used in this context:
    - The generated programs for Realignment for the Planning Object Structure (generated out of /SAPAPO/TS_PSTRU_SAMPLE_realig)
  - Parameters used in this context:
    - NA

**Logical File Paths Used in this Solution**
The logical file names use the following logical file paths:
- /SAPAPO/TSDM_PLOB_LIST_GENER
- /SAPAPO/FCS_CHAR_COMBIS_CREATE
- /SAPAPO/FCS_RLGCOPY
- /SAPAPO/TSDM_PLOB_LIST_GENER_INT

**Available Actions**
- [Download for SNOTE](https://me.sap.com/notes/0001504062/Download)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001504062?language=en-US&token=F50068EB563AE399E68C8D8D406622ED)
- Share by Email
- Open in New Window

**Valid Software Components**
| Software Component | From | To   |
|--------------------|------|------|
| SCM                | 500  | 500  |
| SCM                | 510  | 510  |
| SCM                | 700  | 700  |
| SCM                | 701  | 701  |

**Support Package**
| Software Component Version | Support Package | URL                                                                                          |
|----------------------------|-----------------|----------------------------------------------------------------------------------------------|
| SCM 500                    | SAPKY50019      | [SAPKY50019](https://me.sap.com/supportpackage/SAPKY50019)                                 |
| SCM 510                    | SAPKY51015      | [SAPKY51015](https://me.sap.com/supportpackage/SAPKY51015)                                 |
| SCM 700                    | SAPKY70009      | [SAPKY70009](https://me.sap.com/supportpackage/SAPKY70009)                                 |
| SCM 701                    | SAPKY70103      | [SAPKY70103](https://me.sap.com/supportpackage/SAPKY70103)                                 |

**Correction Instructions**
| Software Component | Number of Correction Instructions | URL                                              |
|--------------------|-----------------------------------|--------------------------------------------------|
| SCM                | 5                                 | [Correction Instructions](https://me.sap.com/corrins/0001504062/418) |

**Prerequisites**
| Software Component | From | To   | SAP Note/KBA | Title                                           | Component          |
|--------------------|------|------|--------------|-------------------------------------------------|--------------------|
| SAP_BASIS          | 700  | 700  | 1497003      | Potential directory traversals in applications   | BC-CCM-FIL         |
| SAP_BASIS          | 701  | 701  | 1497003      | Potential directory traversals in applications   | BC-CCM-FIL         |
| SCM                | 701  | 701  | 1504062      | SCM: Potential Directory Traversal               | SCM-APO-FCS-BF     |

**References**
- **This document refers to:**
  - [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Actions**
- [Mark as Favorite](https://me.sap.com/notes/1504062/Favorite)
- [Unmark as Favorite](https://me.sap.com/notes/1504062/Unfavorite)

**Support Links**
- [Edit](https://me.sap.com/sap/support/notes/edit/0001504062)
- [Show Changes](https://me.sap.com/notes/1504062/CompareVersions)

*For more details, visit the [SAP Support Portal](https://me.sap.com/).*

Credits to [RedRays.io](https://redrays.io) for supporting the provision of this information.