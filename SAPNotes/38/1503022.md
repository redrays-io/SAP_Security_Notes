1503022 - Missing authorization checks in DOE

**Symptom**
Authorization checks are missing for some clean up reports and remote enabled function modules in Data Orchestration Engine.

**Other Terms**
ABAP, Security Code Scan, DOE, RMM

**Reason and Prerequisites**

**Reason:**
The following reports are typically executed by DOE administrators for cleaning up logs and older Data Object messages. Currently, authorization checks are missing for these reports. After the fix, the role `SAP_DOE_ADMINISTRATOR` is required to execute these reports.

1. `SMMW_REORG_LOG`
2. `SMMW_REORG_MSG_STORE`
3. `MMW_MON_LOGFILES_CLEANUP`

Additionally, one function module identified in the security code scan can be accessed remotely without DOE-specific authorizations. After the fix, the role `SAP_DOE_SYNC_ROLE` is required to access this function module.

- `SMMW_DEVICE_DISCOVERY`

**Prerequisite:**
- You are on a Support Package (SP) lower than SP 11 of WebAs 7.10
  **or**
- You are on a Support Package (SP) lower than SP 06 of WebAs 7.11

**Solution**
Authorization checks have been introduced.

- Apply **SP11** if you are on WebAs 7.10
  **or**
- Apply **SP06** if you are on WebAs 7.11

**Support Packages**
- [SAPKB71011](https://me.sap.com/supportpackage/SAPKB71011) for SAP_BASIS 710
- [SAPKB71106](https://me.sap.com/supportpackage/SAPKB71106) for SAP_BASIS 711

**Correction Instructions**
- [Apply Corrections](https://me.sap.com/corrins/0001503022/41)

**Download and More Information**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008896662017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001503022?language=en-US&token=2E723A6F748E50412E0DA3E6EA71F44F)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001503022/E/diff)

*Credits to [https://redrays.io](https://redrays.io) for support to provided information.*