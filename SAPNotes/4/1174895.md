1174895 - HTTP Request Smuggling problems solved

## Description

### Symptom

Specially prepared HTTP requests or content length headers may lead to an incorrect processing of this request in the back end. (HTTP Request Smuggling)

### Other Terms

HTTP, Internet Communication Manager, ICM, Web dispatcher, SAP Web Dispatcher

### Solution

The following patch levels modify the HTTP parser so that requests are recognized as invalid when reading and parsing the request at the kernel level, ensuring they are caught before being forwarded to higher protocol layers.

- **6.40:** SP237
- **7.00:** SP164
- **7.01:** SP8
- **7.10:** SP108

## Affected Software Components

- **SAP_BASIS** versions 6.40, 7.00, 7.01, and 7.10

## Support Package Patches

| Software Component Version                | Support Package | Patch Level | URL                                                                                                                                                                                                                                         |
|-------------------------------------------|------------------|-------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SAP KERNEL 7.00 32-BIT                    | SP000            | 000164      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004059&V=MAINT)                                                        |
| SAP KERNEL 7.00 32-BIT UNICODE            | SP000            | 000164      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004835&V=MAINT)                                                        |
| SAP KERNEL 7.00 64-BIT                    | SP000            | 000164      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004836&V=MAINT)                                                        |
| SAP KERNEL 7.00 64-BIT UNICODE            | SP000            | 000164      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004837&V=MAINT)                                                        |
| SAP KERNEL 6.40 32-BIT UNICODE            | SP237            | 000237      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004051&V=MAINT)                                                        |
| SAP KERNEL 6.40 64-BIT UNICODE            | SP237            | 000237      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004052&V=MAINT)                                                        |
| SAP KERNEL 6.40 32-BIT                     | SP237            | 000237      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200006931&V=MAINT)                                                        |
| SAP KERNEL 6.40 64-BIT                     | SP237            | 000237      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200006932&V=MAINT)                                                        |
| SAP KERNEL 7.00 32-BIT                     | SP164            | 000164      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004059&V=MAINT)                                                        |
| SAP KERNEL 7.00 32-BIT UNICODE             | SP164            | 000164      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004835&V=MAINT)                                                        |
| SAP KERNEL 7.00 64-BIT                     | SP164            | 000164      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004836&V=MAINT)                                                        |
| SAP KERNEL 7.00 64-BIT UNICODE             | SP164            | 000164      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004837&V=MAINT)                                                        |

## References

- [Security Note 1170848 - HTTP request check tightened](https://me.sap.com/notes/1170848)

## Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016528512017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001174895?language=en-US&token=BCFDE2930B4159F5A5916E524C676745)

*Credits to [redrays.io](https://redrays.io) for support to provided information.*