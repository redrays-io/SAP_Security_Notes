SAP Security Note 1175239 - XSS Attacks Protection

**Overview**
SAP Security Note [1175239](https://me.sap.com/notes/0001175239) addresses critical vulnerabilities related to Cross-Site Scripting (XSS) attacks within the authentication mechanism of SAP systems. This note introduces essential security features to enhance the protection of user authentication processes.

**Symptom**
Security issues were detected in the authentication mechanism, specifically:
- Lack of encryption for HTTP parameters used during navigation post-authentication, making it susceptible to URL manipulation.
- Insufficient escaping and validation of special scripting characters in all inputs of the logon application.
- Unescaped values in hidden input fields, risking the integrity of initial POST parameters.

**Solution**
To mitigate these vulnerabilities, apply the appropriate patches based on your SAP system release:

- **For Release 7.11:**
  - Download and deploy the latest `J2EEAPPS.SCA` patch for your current Support Package (SP).
  
- **For Release 7.10:**
  - If on SP6, the patch is already available.
  - For SP5, apply the latest patches for the `SERVERCORE` and `ENGINEAPI` components available on the [SAP Support Marketplace](https://me.sap.com/).

- **For Releases 6.40, 7.00, 7.01, 7.02, 7.20, 7.21, and 7.22:**
  - **Escape and Validate Inputs:** Already implemented in the logon application; no additional fixes required.
  - **URL Encryption:** Available in specific SPs:
    - 6.40 SP26
    - 7.00 SP22
    - 7.01 SP07
    - 7.02 SP03
  - For older SPs released in the last 18 months, apply the latest patches for `SAP_JTECHS` and `SAP-JEECOR` from the [SAP Support Marketplace](https://me.sap.com/).

**Important**
Ensure that both components (`SAP_JTECHS.sca` and `SAP-JEECOR`) are patched together to avoid issues such as:
1. Redirection to `index.html` post-login.
2. `NoSuchMethodError` or `NoClassDefFoundError` exceptions.
3. "404 Not Found" errors with scrambled URL sequences.

Deploy the latest patch levels for both components as mentioned to resolve these issues.

**Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016529372017)
- [PDF Version](https://me.sap.com/notes/0001175239/print?language=en-US&token=644141BD5ADB878FD2CBF1DA231D17FC)

**References**
- [Duplicate Database Systems in SLD](https://me.sap.com/notes/1520646)
- [SLD Registration of an AS Java: IsICM Flag](https://me.sap.com/notes/1516009)
- [Missing Support Package Versions in SLD](https://me.sap.com/notes/1477903)
- [Error While Processing Supplied Data](https://me.sap.com/notes/1445294)
- [SAP J2EE Engine Session Fixation Protection](https://me.sap.com/notes/1310561)
- [Blank Page on Protected Resource Request](https://me.sap.com/notes/1232718)

For more detailed information and support, visit the [SAP Security Notes](https://me.sap.com/notes) section.

---

*Credits to [Redrays](https://redrays.io) for supporting the provision of this information.*