1694226 - Unauthorized execution of application funcs. in BW-PLA-BPS

**Symptom**
An attacker can execute functions in BW-PLA-BPS without authentication and authorization.

**Other Terms**
Cross-site request forgery, XSRF, BW-PLA-BPS

**Reason and Prerequisites**
BW-PLA-BPS executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The attacker may use a cross-site scripting attack to do this, or they may present a link to the victim.

**Solution**
Implement this SAP Note or import the relevant Support Package.

Also, take the manual post-implementation steps into account when you implement this SAP Note.

**Important:** The new protection measures take effect only if the HTTPS protocol is selected for the Web interfaces before regeneration. There is no support for HTTP.

**Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010066342017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001694226?language=en-US&token=45BDFFDEDFBA35E58FDCE305016E7988)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001694226)
- [Share by Email](https://me.sap.com/notes/0001694226/share)
- [Open in New Window](https://me.sap.com/notes/0001694226/open)
- [Show Changes](https://me.sap.com/notes/0001694226/compare)

**Prerequisites**
- Ensure that you have implemented [SAP Note 1520324](https://me.sap.com/notes/1520324) and the other SAP Notes specified there in your system or that your system has the relevant Support Package level.

**Manual Activities**
1. **Manual Pre-Implement Steps**
   - Download the attached files:
     - `000_cl_upwc_application_OnInputprocessing.txt`
     - `300_cl_upwc_application_OnInputprocessing.txt`
   - In transaction SE38, execute the report `UPWB_TEMPLATE_EDITOR` with the following parameters:
     - HTML Version: `000000`
     - Class/Interface: `CL_UPWC_APPLICATION`
     - Template Name: `INPUTPROCESSING`
   - Load and replace the current template with `000_cl_upwc_application_OnInputprocessing.txt`.
   - Repeat the process for HTML Version `000300` using `300_cl_upwc_application_OnInputprocessing.txt`.

2. **Enable HTTPS**
   - Set the parameter `Use HTTPS` to `true` for the relevant Web interfaces in transaction BPS_WB.
   - Regenerate the Web interfaces for the changes to take effect.

**Software Components Affected**
- SAP_BW (Versions 350 to 731)
- SAP_BW_VIRTUAL_COMP (Version 701)

**Support Package Information**
Ensure you apply the appropriate Support Package as listed:
- [SAPKW35030](https://me.sap.com/supportpackage/SAPKW35030)
- [SAPKW70029](https://me.sap.com/supportpackage/SAPKW70029)
- ... *(additional support packages as needed)*

For detailed information and updates, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [https://redrays.io](https://redrays.io) for support in providing this information.*