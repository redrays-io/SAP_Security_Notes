1438191 - Unauthorized modification of displayed content- SOAP Adapter

**Symptom**
  
SOAP Adapter Helper servlet has a vulnerability to reflected Cross-Site Scripting (XSS) attacks. An attacker may specify an unrecognized value of an input parameter with malicious script commands, causing these commands to execute in the user's browser.

**Other Terms**

Reflected Cross-Site Scripting, XSS, SOAP Adapter

**Reason and Prerequisites**

The SOAP Adapter Helper servlet does not sufficiently encode input parameters, making it vulnerable to reflected cross-site scripting attacks. An attacker can present a malicious link to a victim, and clicking it can execute malicious scripts in the user's browser. This compromises the user's security context, including browser cookies and cache objects. It can also cause the victim's browser to navigate to URLs on the vulnerable site, allowing the attacker to intrude into the user's security context.

Reflected cross-site scripting can be used to steal another user's authentication information, such as session data. An attacker with access to this data could impersonate the user and access all information with the same rights. If an administrator is impersonated, the application's security could be fully compromised.

**Affected Releases**

- **7.10**
  - SP6 patch level 39 or less
  - SP7 patch level 42 or less
  - SP8 patch level 22 or less
  - SP9 patch level 6 or less
- **7.11**
  - EHP1 SP2 patch level 18 or less
  - EHP1 SP3 patch level 16 or less
  - EHP1 SP4 patch level 5 or less

**Solution**

Please apply the corresponding patch listed below:

- **XI ADAPTER FRAMEWORK 7.10**
  - **SP6**: Patch Level 40  
    [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200007188&support_package=SP006&patch_level=000040)
  - **SP7**: Patch Level 43  
    [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200005003&support_package=SP007&patch_level=000043)
  - **SP8**: Patch Level 23  
    [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200005003&support_package=SP008&patch_level=000023)
  - **SP9**: Patch Level 7  
    [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200005003&support_package=SP009&patch_level=000007)
  - **SP10**: Patch Level 0  
    [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200005003&support_package=SP010&patch_level=000000)

- **XI ADAPTER FRAMEWORK 7.11**
  - **SP2**: Patch Level 19  
    [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006988&support_package=SP002&patch_level=000019)
  - **SP3**: Patch Level 17  
    [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006988&support_package=SP003&patch_level=000017)
  - **SP4**: Patch Level 6  
    [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006988&support_package=SP004&patch_level=000006)
  - **SP5**: Patch Level 0  
    [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006988&support_package=SP005&patch_level=000000)

**References**

- [Procedure to deactivate SOAP Adapter and JPR applications](https://me.sap.com/notes/1616164)
- [Briefing at Black Hat conference on August 4th, 2011](https://me.sap.com/notes/1616259)
- [SAP EhP1 for XI on Netweaver 7.00 SP09](https://me.sap.com/notes/1576121)
- [NW04s XI Support Package Stack 24](https://me.sap.com/notes/1564466)
- [SAP EhP2 for Netweaver 7.00 SP07](https://me.sap.com/notes/1561929)
- [SAP EhP1 for XI on Netweaver 7.00 SP08](https://me.sap.com/notes/1531912)
- [NW04s XI Support Package Stack 23](https://me.sap.com/notes/1530712)
- [SAP EHP1 FOR SAP NETWEAVER PI 7.1 SP05](https://me.sap.com/notes/1459565)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays.io](https://redrays.io) for supporting the information provided.*