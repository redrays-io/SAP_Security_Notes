1440519 - PI SEC: Potential disclosure of authentication information

**Symptom**

The "Diagnostic Servlet" can be abused by a malicious user allowing them to obtain authentication information from other legitimate users.

**Other Terms**

Exchange Infrastructure, XI, XPI, Process Integration, PI

**Reason and Prerequisites**

You are running SAP NetWeaver Process Integration (PI). The "Diagnostic Servlet" is an undocumented, internal servlet used for system analysis.

Some pages within the Diagnostic Servlet do not sufficiently encode input/output parameters, resulting in a cross site scripting issue. Cross site scripting can be used to steal another user's authentication information such as data relating to their current session.

It can be used to permanently modify displayed content from a web site, allowing the malicious user to embed content that is rendered automatically, without the need to individually target victims.

An attacker who gains access to this data may use this to impersonate the user and access all information with the same rights as the target user. In case of an administrator being impersonated, a full compromise of the application's security can be may occur.

**Solution**

The Diagnostic Servlet has been deleted with the following Support Packages and Patches of Software Components **"XI TOOLS"**, **"ESR"** and **"XI Adapter Framework"**:

**Release 6.40**

- **SAP NetWeaver 6.40 (XI 3.0) SP22**
  - XI TOOLS 3.0: [SAPXITOOL22 - Patch 07](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 6.40 (XI 3.0) SP23**
  - XI TOOLS 3.0: [SAPXITOOL23 - Patch 04](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 6.40 (XI 3.0) SP24**
  - XI TOOLS 3.0: [SAPXITOOL24 - Patch 04](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 6.40 (XI 3.0) SP25**
  - XI TOOLS 3.0: [SAPXITOOL25 - Patch 02](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 6.40 (XI 3.0) SP26**
  - XI TOOLS 3.0: [SAPXITOOL26 - Patch 00](https://me.sap.com/note/0040000016979962017)

**Release 7.00**

- **SAP NetWeaver 7.00 SP15**
  - XI TOOLS 7.00: [SAPXITOOL15 - Patch 15](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.00 SP16**
  - XI TOOLS 7.00: [SAPXITOOL16 - Patch 12](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.00 SP17**
  - XI TOOLS 7.00: [SAPXITOOL17 - Patch 08](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.00 SP18**
  - XI TOOLS 7.00: [SAPXITOOL18 - Patch 09](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.00 SP19**
  - XI TOOLS 7.00: [SAPXITOOL19 - Patch 07](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.00 SP20**
  - XI TOOLS 7.00: [SAPXITOOL20 - Patch 06](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.00 SP21**
  - XI TOOLS 7.00: [SAPXITOOL21 - Patch 01](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.00 SP22**
  - XI TOOLS 7.00: [SAPXITOOL22 - Patch 00](https://me.sap.com/note/0040000016979962017)

**Release 7.01**

- **SAP NetWeaver 7.01 SP02**
  - XI TOOLS 7.01: [SAPXITOOL02 - Patch 05](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.01 SP03**
  - XI TOOLS 7.01: [SAPXITOOL03 - Patch 07](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.01 SP04**
  - XI TOOLS 7.01: [SAPXITOOL04 - Patch 04](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.01 SP05**
  - XI TOOLS 7.01: [SAPXITOOL05 - Patch 02](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.01 SP06**
  - XI TOOLS 7.01: [SAPXITOOL06 - Patch 01](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.01 SP07**
  - XI TOOLS 7.01: [SAPXITOOL07 - Patch 00](https://me.sap.com/note/0040000016979962017)

**Release 7.02**

- **SAP NetWeaver 7.02 SP03**
  - XI TOOLS 7.02: [SAPXITOOL03 - Patch 00](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.02 SP04**
  - XI TOOLS 7.02: [SAPXITOOL04 - Patch 00](https://me.sap.com/note/0040000016979962017)

**Release 7.10**

- **SAP NetWeaver 7.10 SP05**
  - XI TOOLS 7.10: [SAPXITOOL05 - Patch 16](https://me.sap.com/note/0040000016979962017)
  - ESR 7.10: [SAPXIESR05 - Patch 18](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.10: [SAPXIAF05 - Patch 20](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.10 SP06**
  - XI TOOLS 7.10: [SAPXITOOL06 - Patch 25](https://me.sap.com/note/0040000016979962017)
  - ESR 7.10: [SAPXIESR06 - Patch 34](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.10: [SAPXIAF06 - Patch 42](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.10 SP07**
  - XI TOOLS 7.10: [SAPXITOOL07 - Patch 25](https://me.sap.com/note/0040000016979962017)
  - ESR 7.10: [SAPXIESR07 - Patch 27](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.10: [SAPXIAF07 - Patch 45](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.10 SP08**
  - XI TOOLS 7.10: [SAPXITOOL08 - Patch 13](https://me.sap.com/note/0040000016979962017)
  - ESR 7.10: [SAPXIESR08 - Patch 13](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.10: [SAPXIAF08 - Patch 24](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.10 SP09**
  - XI TOOLS 7.10: [SAPXITOOL09 - Patch 07](https://me.sap.com/note/0040000016979962017)
  - ESR 7.10: [SAPXIESR09 - Patch 07](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.10: [SAPXIAF09 - Patch 07](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.10 SP10**
  - XI TOOLS 7.10: [SAPXITOOL10 - Patch 00](https://me.sap.com/note/0040000016979962017)
  - ESR 7.10: [SAPXIESR10 - Patch 00](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.10: [SAPXIAF10 - Patch 00](https://me.sap.com/note/0040000016979962017)

**Release 7.11**

- **SAP NetWeaver 7.11 SP01**
  - XI TOOLS 7.11: [SAPXITOOL01 - Patch 14](https://me.sap.com/note/0040000016979962017)
  - 7.11: [SAPXIESR01 - Patch 21](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.11: [SAPXIAF01 - Patch 26](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.11 SP02**
  - XI TOOLS 7.11: [SAPXITOOL02 - Patch 11](https://me.sap.com/note/0040000016979962017)
  - ESR 7.11: [SAPXIESR02 - Patch 12](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.11: [SAPXIAF02 - Patch 21](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.11 SP03**
  - XI TOOLS 7.11: [SAPXITOOL03 - Patch 14](https://me.sap.com/note/0040000016979962017)
  - ESR 7.11: [SAPXIESR03 - Patch 13](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.11: [SAPXIAF03 - Patch 19](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.11 SP04**
  - XI TOOLS 7.11: [SAPXITOOL04 - Patch 08](https://me.sap.com/note/0040000016979962017)
  - ESR 7.11: [SAPXIESR04 - Patch 07](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.11: [SAPXIAF04 - Patch 08](https://me.sap.com/note/0040000016979962017)
  
- **SAP NetWeaver 7.11 SP05**
  - XI TOOLS 7.11: [SAPXITOOL05 - Patch 00](https://me.sap.com/note/0040000016979962017)
  - ESR 7.11: [SAPXIESR05 - Patch 00](https://me.sap.com/note/0040000016979962017)
  - XI ADAPTER FRAMEWORK CORE 7.11: [SAPXIAF05 - Patch 00](https://me.sap.com/note/0040000016979962017)

**Release 7.20**

- **SAP NetWeaver 7.20 SP03**
  - ESR 7.20: [SAPXIESR03 - Patch 00](https://me.sap.com/note/0040000016979962017)

*For more details and downloads, visit the [SAP Support Portal](https://me.sap.com/).*

*Credits to [redrays.io](https://redrays.io) for support to provided information.*