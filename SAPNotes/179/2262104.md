2262104 - Security vulnerabilities found in Apache Commons Collections library used in CA Introscope

**Symptom**

CA Introscope Enterprise Manager uses an open source software version - Apache Commons Collections library, for which security vulnerabilities (arbitrary code execution or denial of service) were detected.

**Other Terms**

OSS, remote code injection, denial of service, java serialization vulnerability, Introscope, Wily, Enterprise Manager

**Reason and Prerequisites**

CA Introscope Enterprise Manager versions 9.x are shipped with the two vulnerable files of Apache Commons Collections library:

- `org.apache.commons.collections_3.2.1.jar`
- `org.apache.commons_collections_3.0.0.jar`

**Solution**

CA provided modified files that have been updated with the documented fix for the issue. To apply the modified files from the attachment of this note, follow the steps below:

1. **Stop the Introscope Enterprise Manager**
2. **Backup the two files**  
   `org.apache.commons_collections_3.0.0.jar`  
   `org.apache.commons.collections_3.2.1.jar`  
   from `<EM_HOME>/product/enterprisemanager/plugins` and `<EM_HOME>/product/workstation/plugins`
3. **Replace the vulnerable files**  
   Put the two files from [ApacheCommonsCollectionsLib_plugins.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200002081892015&iv_version=0001&iv_guid=EF616D5AEAF7EB4A8DD3606F0F8780D9) into `<EM_HOME>/product/enterprisemanager/plugins` and `<EM_HOME>/product/workstation/plugins`
4. **Clean the Work Directory**  
   Remove all files from the folder `<EM_HOME>/work`
5. **Update Configuration**  
   Remove all files *except* `config.ini` from `<EM_HOME>/product/enterprisemanager/configuration`
6. **Restart the Enterprise Manager**

**Known Issues:**

Although the attached files can be applied to all CA Introscope Enterprise Manager 9.x versions, SAP delivers the attached files signed for Introscope versions starting with Introscope 9.7. For Introscope versions 9.5.6 and 9.1.x, launching the Introscope Workstation with Java Webstart will fail due to security checks. As a workaround, you can install the Introscope Workstation locally.

**Download Links:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018234922017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002262104?language=en-US&token=021CF84B90750A33F82C5A2127189E70)

---

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*