SAP Security Note 2264948 - Switchable authorization checks for RFC in CRM-MW-SRV

```markdown
**SAP Security Note 2264948 - Switchable authorization checks for RFC in CRM-MW-SRV**

**Title:**  
2264948 - Switchable authorization checks for RFC in CRM-MW-SRV

**Type:**  
SAP Security Note

**Version:**  
3

**Priority:**  
Correction with medium priority

**Status:**  
Released for Customer

**Released On:**  
06.10.2017

**Component:**  
Customer Relationship Management > Middleware > Flow / Services

**Description:**

### Symptom
This SAP note introduces new switchable authorization checks for RFC function modules within middleware flow services and queue processing. It addresses scenarios where the existing S_RFC authorization checks may not be sufficient to ensure secure execution of certain RFC function modules.

### Reason and Prerequisites
Remote calls to RFC function modules are protected using the S_RFC authorization object. However, some RFC function modules require additional authorization checks to enhance system security. This note provides switchable authorization checks to ensure that these function modules are adequately protected. Ensure that S_RFC authorizations are limited to the minimum necessary for all users.

### Solution
The note implements new switchable authorization checks that are inactive by default to maintain compatibility with existing processes. These checks can be activated using transaction SACF. Detailed steps for activation are provided below.

**New Authorization Scenarios:**

1. **CRM_MW_QPROC** - Scenario for middleware queue processing modules
   - **RFC Function Modules:**
     - SMOENQUEUE_RFC (Auth. Object: CRM_MW_AC, ACTVT=16)
     - SMO_ACENQUEUE (Auth. Object: CRM_MW_AC, ACTVT=16)
     - SMOH_SITE_RELEASE (Auth. Object: CRM_MW_AC, ACTVT=2)
     - SMOH_EXTRACTREQUEST_RFC (Auth. Object: CRM_MW_AC, ACTVT=16)

2. **CRM_MW_MFLOW** - Scenario for middleware flow modules
   - **RFC Function Module:**
     - SMW3_MFLOW_QPROCESSMBDOC (Auth. Object: CRM_MW_FC, ACTVT=16)

**Implementation Steps:**

1. **Create Authorization Scenario Definition:**
   - Use transaction SACF to check for the existence of `CRM_MW_QPROC` and `CRM_MW_MFLOW`.
   - If not present, apply Note 2264948 via SNOTE and execute the report `Note_2264948_ver1` in transaction SE38.

2. **Create Productive Authorization Scenario:**
   - In SACF, select the scenario definition and transfer it to a productive scenario.
   - Choose the initial status as "Active" or "Logging".
     - **Active:** Activates authorization checks and logs to Security Audit Log.
     - **Logging:** Activates logging only; authorization checks will pass regardless of user authorizations.

3. **Activate Logging in Security Audit Log:**
   - Ensure Security Audit Log is active via transaction SM19.
   - Activate message IDs:
     - DUO (Authorization check successful)
     - DUP (Authorization check failed)
     - DUQ (Change in active scenario)

4. **Adjust User Roles:**
   - Use report RSAU_SELECT_EVENTS to identify users needing additional authorizations.
   - Update roles accordingly to comply with the new authorization scenarios.

**Download and Resources:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000013402082017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002264948?language=en-US&token=CDC7A4E64AD0AF144CA81B15AD8AC00E)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002264948/E/diff)

**Support Package Information:**

- Applicable to Software Component **BBPCRM** across various releases (700 to 714).
- Includes support packages like SAPKU70018, SAPKU70020, SAPKU70115, etc.

**Prerequisites:**

- Ensure prerequisites such as SAP Note 2040612 and 2236076 are implemented as applicable to your system's release version.

For more detailed instructions and support, visit [SAP Support Portal](https://me.sap.com/).

*Credits: Information supported by [RedRays.io](https://redrays.io).*
```