SAP Security Note 2264949 - Switchable authorization checks for RFC in CRM-MW-GEN

**Description**
This SAP security note introduces new switchable authorization checks for RFC function modules in the `CRM-MW-GEN` component. Remote calls to RFC function modules are now protected by enhanced authorization objects to ensure stricter security compliance.

**Symptom**
Prior to this update, authorization object `S_RFC` checks might not have been sufficient to secure the execution of certain RFC function modules within `CRM-MW-GEN`. This posed potential security risks by allowing unauthorized access through inadequate authorization checks.

**Reason and Prerequisites**
The update addresses the insufficiency of `S_RFC` authorization checks by activating new switchable authorization checks. These checks are initially inactive to maintain compatibility with existing processes and require manual activation. Before implementing this note, ensure that SAP Note [2236076](https://me.sap.com/notes/2236076) is applied to avoid syntax errors when calling `CL_RFC=>CHECK_EXTERNAL` and `CL_SACF=>AUTH_CHECK_SPEC`.

**Solution**
The note provides new authorization scenarios and direct authorization checks for specific RFC function modules. The implementation involves the following steps:

1. **Implement the Support Package:**
   - Download the support packages from [Download for SNOTE](https://me.sap.com/notes/0040000013402092017) or the [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002264949?language=en-US&token=4344FCFC190081B847A517CC8552D6F3).
   - Apply the support packages relevant to your `BBPCRM` component version.

2. **Activate Authorization Checks:**
   - **Step 1:** In transaction `SACF`, verify if the scenario definition `CRM_MW_BDM_GEN` exists. If not, implement Note 2264949 via SNOTE and execute the report `Note_2264949_ver1` in transaction `SE38` to create the scenario definition.
   - **Step 2:** Create the productive authorization scenario from the scenario definition in `SACF`. Choose the initial status as `Active` to enforce authorization checks and logging.
   - **Step 3:** Activate logging of SACF-relevant audit messages in the Security Audit Log using transaction `SM19`. Ensure the following message IDs are active:
     - DUO (Authorization check successful)
     - DUP (Authorization check failed)
     - DUQ (Scenario status change)
   - **Step 4:** Adjust user roles to include the necessary authorizations identified through the new authorization scenario using reports like `RSAU_SELECT_EVENTS`.

**Support Package Information**
Applicable support packages for `BBPCRM` component versions 700, 701, 702, 712, 713, and 714 are provided. Ensure you apply the correct support package corresponding to your system's component version.

**Prerequisites**
- SAP Note [2236076](https://me.sap.com/notes/2236076) must be applied to avoid syntax errors related to RFC authorization checks.

**References**
For more detailed instructions and information, refer to the full SAP Note [2264949](https://me.sap.com/notes/2264949).

**Actions**
- [Download for SNOTE](https://me.sap.com/notes/0040000013402092017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002264949?language=en-US&token=4344FCFC190081B847A517CC8552D6F3)

---

*Credits to [RedRays.io](https://redrays.io) for supporting the provision of this information.*