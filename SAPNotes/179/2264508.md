SQL Injection Vulnerability in SAF-T Portugal (SAP Note 2264508)

**Overview**

A critical SQL Injection vulnerability has been identified in the SAF-T Portugal module (XX-CSC-PT-FICA) of SAP. This vulnerability allows attackers to manipulate database commands through specially crafted inputs, potentially leading to unauthorized access and data exposure.

**Details**

- **SAP Note Number:** 2264508
- **Title:** SQL Injection in SAF-T Portugal
- **Type:** SAP Security Note
- **Version:** 2
- **Released On:** October 27, 2020
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **CVSS Score:** 5.4 (Medium)
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

**Vulnerability Details**

An attacker can exploit the XX-CSC-PT-FICA component by using specially crafted inputs to modify SQL commands. This manipulation can result in the retrieval of additional information stored in the system's database, leading to potential data breaches and unauthorized data access.

**Affected Components**

- FI-CA versions: 600, 602, 603, 604, 605, 606, 616, 617, 618, 800

**Impact**

Exploitation of this vulnerability can lead to unauthorized disclosure of persisted data within the affected SAP components, compromising the confidentiality and integrity of the system's data.

**Solution**

To mitigate this vulnerability, please implement [SAP Note 2264508](https://notesdownloads.sap.com/note/0040000001805482020). This note provides the necessary corrections to address the SQL Injection issue in the SAF-T Portugal module.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001805482020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002264508?language=en-US&token=4A1DA49F30AF77656B3D79260BEC6D66)

**Prerequisites**

Ensure that the following SAP Notes are implemented prior to applying SAP Note 2264508:

- 1903286
- 1940565
- 2022179
- 2029862
- 2034542
- 2078475
- 2232540
- 2252923

These prerequisites address various aspects of the FI-CA component and ensure a smooth implementation of the security note.

**Support Packages**

Applicable support packages for the FI-CA component are available [here](https://me.sap.com/supportpackage/SAPK-60028INFICA).

**Credits**

Special thanks to [RedRays.io](https://redrays.io) for providing support and information related to this vulnerability.