186119 - Restricting DB access to specific hosts

## SAP Note 186119 - Restricting DB access to specific hosts

**Type:** SAP Security Note  
**Version:** 7  
**Released On:** 08.10.2009  
**Priority:** Correction with low priority  
**Status:** Released for Customer  
**Component:** Basis Components > Database Interface, Database Platforms > Oracle

### Description

#### Symptom
The Oracle SQLnet (Net8) setup defined by the standard installation is not restrictive enough for some administrators.

#### Other Terms
Sqlnet, security, OPS$, net8, protocol.ora  
tcp.validnode_checking, tcp.invited_nodes, tcp.excluded_nodes

#### Reason and Prerequisites
- You installed the standard system and are not using the additional security features at the Oracle Net8 level.
- You want to restrict remote access to specific hosts at the DB level.

#### Solution
The Oracle listener must be configured to accept connections only from certain hosts. To achieve this, modify the `protocol.ora` file on the database host as follows:

- **UNIX:**  
  `$ORACLE_HOME/network/admin/protocol.ora`  
  or  
  `$ORACLE_HOME/network/admin/.protocol.ora` (for Oracle 8.1.5, 8.1.6 - see [Note 198752](https://me.sap.com/notes/198752))
  
- **Windows NT:**  
  `%ORACLE_HOME%\net80\admin\protocol.ora` (for Oracle 8.0.*, 8.1.5, 8.1.6 - see [Note 198752](https://me.sap.com/notes/198752))  
  or  
  `%ORACLE_HOME%\network\admin\protocol.ora` (from Oracle 8.1.7)

Add the following lines to the `protocol.ora` file:

```plaintext
tcp.validnode_checking = yes
tcp.invited_nodes = (IP_Address1, IP_Address2, ...)
```

List the IP addresses of the hosts from which access should be accepted in the `invited_nodes` list.

Alternatively, you can use a negative list to exclude specific hosts:

```plaintext
tcp.excluded_nodes = (IP_Address1, IP_Address2, ...)
```

**Important:**
- The `tcp.excluded_nodes` parameter is ignored if `tcp.invited_nodes` is set. Only one method can be used.
- If a host name entered in `tcp.invited_nodes` or `tcp.excluded_nodes` is invalid, all access control parameters in `protocol.ora` are ignored, effectively canceling access control.
- Starting with Oracle 9i, the `protocol.ora` file is deprecated. Use `sqlnet.ora` instead for the above parameters.

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000014748312017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0000186119?language=en-US&token=1A072514925FC4F357F884A1AD611A7A)
- [Share by Email](https://me.sap.com/notes/186119/share)
- [Open in New Window](https://me.sap.com/notes/186119)

### References

- [Overview: Oracle Security SAP Notes](https://me.sap.com/notes/1868094)
- [TCP_NODELAY is ignored if protocol.ora is incorrect](https://me.sap.com/notes/586710)
- [FAQ: Logon mechanisms](https://me.sap.com/notes/562863)
- [FAQ: Oracle Net](https://me.sap.com/notes/562403)
- [Hang situations](https://me.sap.com/notes/521264)
- [TCP delay problem under Oracle 8.1.x](https://me.sap.com/notes/198752)
- [tcp.validnode_checking on Oracle 64-bit](https://me.sap.com/notes/194868)
- [Performance problems with SQL*Net](https://me.sap.com/notes/72638)
- [Availability of the SAP Security Guide](https://me.sap.com/notes/39267)

### Available Languages

- [日本語](https://me.sap.com/notes/0000186119/J)
- [Deutsch (Origin)](https://me.sap.com/notes/0000186119/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0000186119/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0000186119/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0000186119/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0000186119/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0000186119/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0000186119/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0000186119/3)

### Attributes

**Other Components:** Basis Components > Security - Read KBA [2985997](https://me.sap.com/notes/2985997) for subcomponents (BC-SEC)

### CVSS

**CVSS Score:** 0  
**CVSS Vector:** N/A

### Rating

This document has not been rated yet.

### Side Effects

- **Solves:** None
- **Causes:** None

*Credits to [Redrays](https://redrays.io) for support in providing the information.*