3316509 - Remote Code Execution vulnerability in SAP Commerce

**Description**

Due to insufficient input validation, SAP Commerce allows a user with high privileges to execute malicious code by modifying velocity templates. On successful exploitation, the attacker can cause a limited impact on the confidentiality, integrity, and availability of the application.

**Other Terms**
- Code Injection
- Command Injection
- OS Command Injection
- Remote Code Execution (RCE)
- [CVE-2020-13936](https://www.cve.org/CVERecord?id=CVE-2020-13936)

**Reason and Prerequisites**

This vulnerability affects both on-premise installations of SAP Commerce and [SAP Commerce Cloud in the Public Cloud](https://me.sap.com/). Any deployment granting users permission to change velocity templates at runtime is affected.

**Affected Versions**

- SAP Commerce versions 1905, 2005, and 2011 have reached their [end of mainstream maintenance](https://help.sap.com/docs/SAP_COMMERCE/c5613bd3cc9942efb74d017b40eb0892/1c6c687ad0ed4964bb43d409818d23a2.html).
- Versions under maintenance, currently SAP Commerce [2105](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?version=2105) and [2205](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html), are not affected and were fixed before their initial release.

**Solution**

Patching the affected versions (1905, 2005, 2011) is not technically feasible as the fix breaks backward compatibility. It is recommended to upgrade to a version that is not affected.

**Workaround**

Limit the permissions to edit Velocity templates in SAP Commerce to users who already have permission to execute code elsewhere in commerce, such as the Hybris administration console.

- **Impact:** Users without permission to edit Velocity templates will no longer be able to edit such templates.

**CVSS Score**

- **Score:** 4.7
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000433852023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003316509?language=en-US&token=01CE20EC39FCA33718EB1DBB83EE290D)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*