3318850 - [CVE-2023-35874] Improper authentication vulnerability in SAP NetWeaver AS ABAP and ABAP Platform

---

### **Symptom**

SAP NetWeaver Application Server ABAP and ABAP Platform under some conditions performs improper authentication checks for functionalities that require user identity. An attacker can perform malicious actions over the network, extending the scope of impact, causing a limited impact on confidentiality, integrity, and availability.

### **Other Terms**

- Improper Authentication
- KERNELCOR
- Identity Spoofing
- Authentication Abuse
- Authentication Bypass
- [CVE-2023-35874](https://www.cve.org/CVERecord?id=CVE-2023-35874)

### **Reason and Prerequisites**

The corrections introduced by [SAP Security Note 3089413](https://me.sap.com/notes/3089413/E) have been implemented and profile parameter `rfc/allowoldticket4tt` is set on the caller side to `client` (or `no`) and on the called side to `server` (or `no`).

### **Solution**

The correction implements the correct evaluation for the value `no` of profile parameter `rfc/allowoldticket4tt`.

This correction is initially delivered with the kernel patch level listed in the "**Support Package Patches**" section of this SAP Note. All subsequent kernel patch levels also contain the correction. Keep in mind that only the latest kernel patch level is available for download; however, it contains all previously delivered corrections. As a result, you can download and install the latest available kernel patch at any time to implement this correction.

If there is no entry for the kernel patch level in the "**Support Package Patches**" section, the patch is not yet available. The entry will be added upon the delivery of the correction. Please check this SAP Note to see if new patch level entries are added.

This correction is delivered with the following kernel archives:

- **hotfix** - file `dw.sar`
- **SP Stack Kernel** - files `SAPEXE.SAR` and `SAPEXEDB.SAR`

Follow the SAP recommendations on how to select and install the kernel patch:

1. Apply the latest **SP Stack Kernel** if it contains the correction. For the list of current SP Stack Kernels, see [SAP Note 2083594](https://me.sap.com/notes/2083594/E) (SAP Kernel Versions and SAP Kernel Patch Levels).
2. Otherwise, the next **SP Stack Kernel** will deliver the correction. Apply the **hotfix** only if you require the correction on short notice.
3. The correction may not be available for kernel releases that are out of maintenance. Please upgrade to the corresponding downward compatible kernel (**DCK**), see [SAP Note 2083594](https://me.sap.com/notes/2083594/E) (SAP Kernel Versions and SAP Kernel Patch Levels).
4. Review the **regression note** for the target patch level before installing the patch. For details, see [SAP Note 1802333](https://me.sap.com/notes/1802333/E) (Finding information about regressions in the SAP kernel).
5. For instructions on how to download and install kernel patches, see [SAP Note 19466](https://me.sap.com/notes/19466/E) (Downloading SAP kernel patches).

The paper [Update Strategy for the Kernel of the Application Server ABAP in On-Premise Landscapes](https://support.sap.com/deployment-strategies-kernel-abap.pdf) provides detailed SAP recommendations.

### **Workaround**

Please assess the workaround applicability for your SAP landscape prior to implementation.

**Note:** This workaround is a temporary fix and is not a permanent solution. SAP strongly recommends you apply the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.

Set profile parameter `rfc/allowoldticket4tt = both`

### **CVSS**

- **CVSS Score:** 6.0
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:L)

**Metrics:**
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** High (H)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

### **Software Components Affected**

- **KERNEL**
  - Versions: 7.22, 7.53, 7.77, 7.81, 7.85, 7.89, 7.92, 7.93
- **KRNL64NUC**
  - Versions: 7.22, 7.22EXT
- **KRNL64UC**
  - Versions: 7.22, 7.22EXT, 7.53

### **Support Package Patches**

- **SAP KERNEL 7.92 64-BIT UNICODE**
  - SP010 / Patch 000010: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019973&V=MAINT)
- **SAP KERNEL 7.89 64-BIT UNICODE**
  - SP114 / Patch 000114: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200015809&V=MAINT)
- *(Additional support package patches available in the JSON data can be added similarly.)*

### **References**

- [This correction solves side effects from SAP Note 3089413](https://me.sap.com/notes/3089413/E) ([CVE-2023-0014](https://www.cve.org/CVERecord?id=CVE-2023-0014))
  
---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*