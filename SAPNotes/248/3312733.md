3312733 - [CVE-2023-26458] Information Disclosure vulnerability in SAP Landscape Management

**Description**

An information disclosure vulnerability exists in SAP Landscape Management, enterprise edition. This vulnerability allows an authenticated SAP Landscape Management user to obtain privileged access to other systems, making those systems vulnerable to information disclosure and modification.

**Vulnerability Details**

- **CVE:** [CVE-2023-26458](https://www.cve.org/CVERecord?id=CVE-2023-26458)
- **CVSS Score:** 6.8
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N
- **Affected Component:** SAP Landscape Management (VCM-LVM)
- **Release Date:** April 11, 2023
- **Status:** Released for Customer

**Impact**

The vulnerability allows an authenticated user to escalate privileges on the SAP Solution Manager system by accessing confidential information through the Diagnostics Agent Connection via Java SCS Message Server.

**Prerequisites**

1. SAP Landscape Management, enterprise edition is used.
2. Diagnostics Agent Connection via Java SCS Message Server user credentials are configured on an SAP Solution Manager system.
3. Execution of *Install Diagnostics Agent* on a managed system assigned to the SAP Solution Manager system.

**Solution**

1. **Apply the Patch:**
   - Apply the patch referenced in the Support Package section of this note.

2. **Manual Correction Instructions:**
   - Follow the detailed manual activities outlined in the note to mitigate the vulnerability.

**Manual Activities**

Perform the following manual activities separately in each system where the Note is implemented:

- **Mitigation Goal 1:** Remove confidential information from activity step details and related database entries.
  1. Navigate to `Monitoring -> Activities` in SAP Landscape Management.
  2. Search for activities with the description `Install Diagnostics Agent`.
  3. Remove each activity that meets the preconditions.

- **Mitigation Goal 2:** Remove confidential information from operation logs and related database entries.
  1. Navigate to `Setup -> Settings -> Engine` in SAP Landscape Management.
  2. Enable the deletion of non-archived logs.
  3. Go to `Monitoring -> Logs` and delete logs containing confidential information.

- **Mitigation Goal 3:** Remove confidential information from archives.
  1. Navigate to `Setup -> Settings -> Engine` in SAP Landscape Management.
  2. Check the path for archived log files.
  3. Delete the archived log files from the specified folder.

- **Mitigation Goal 4:** Change all relevant user passwords.
  - Change passwords for users associated with Diagnostics Agent Connection via Java SCS Message Server on the SAP Solution Manager system.

**References**

- [How to connect Diagnostics Agent to SAP Solution Manager 7.2 system](https://me.sap.com/notes/2385361)
- [SAP Landscape Management 3.0 SP26 Patch02](https://me.sap.com/notes/3311963)
- [SAP Landscape Management - Collective Security Note](https://me.sap.com/notes/2910170)

**Download and Print**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000433832023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003312733?language=en-US&token=FAA727A90225419EF5D547A2EDE4C01C)

For more information and updates, visit [SAP Support Portal](https://me.sap.com/).

*Credits: Information provided with support from [redrays.io](https://redrays.io).*