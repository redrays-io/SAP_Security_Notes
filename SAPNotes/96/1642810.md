SAP Security Note 1642810 - Code Injection Vulnerability in SV-SMG-SDD

**Type:** SAP Security Note  
**Version:** 4  
**Released On:** 05.12.2012  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Component:** [Service Data Download (SV-SMG-SDD)](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'SV-SMG-SDD*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

## Symptom

This security note has been updated. For more detailed information, see [Security Note 1727119](https://me.sap.com/notes/1727119).

Component SV-SMG-SDD contains code that permits the execution of arbitrary program code of the user's choice. An attacker can therefore control the behavior of the system or potentially escalate privileges by executing malicious code without having legitimate credentials.

## Reason and Prerequisites

The program code allows the definition and execution of user-defined code that changes the system's behavior. A valid and authenticated user is required with authorization to create and execute ABAP reports.

Depending on the code, the user can:

- Inject and run their own code
- Obtain additional information that should not be displayed
- Modify or delete data
- Modify the system's output

## Solution

### SAP_BASIS Releases 610 - 731

- Implement the correction instructions provided in this note.

### SAP_BASIS Releases 46B - 46D

- **If ST-PI Add-on is Installed:** No further action is needed.
- **If ST-PI Add-on is Not Installed:** Install the ST-PI add-on. Refer to [Note 769623](https://me.sap.com/notes/769623) or [Note 1228898](https://me.sap.com/notes/1228898) for detailed installation instructions.

## Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009754642017)
- [PDF Version](https://me.sap.com/support/sfm/notes/print/0001642810?language=en-US&token=86DD3C9D319D3400FD1088361291F309)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001642810/E/diff)

## References

**This document refers to:**

- [Note 888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)
- [Note 1727119 - Update 1 to security note 1642810](https://me.sap.com/notes/1727119)

**This document is referenced by:**

- [Note 888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

## Valid Software Components

- **SAP_BASIS**
  - From: 46B To: 46D
  - From: 610 To: 640
  - From: 700 To: 702
  - From: 710 To: 730
  - From: 731 To: 731

## Support Packages

- **SAP_BASIS 640:** [SAPKB64032](https://me.sap.com/supportpackage/SAPKB64032)
- **SAP_BASIS 701:** [SAPKB70111](https://me.sap.com/supportpackage/SAPKB70111)

## Correction Instructions

Implement the correction instructions [here](https://me.sap.com/corrins/0001642810/41).

Credits to [redrays.io](https://redrays.io) for support to provided information.