SAP Security Note 2469377 - Missing Authorization check in CIAP

**Description**

**UPDATE 18th September 2018**: This note has been re-released with updated **‘Correction Instructions’** information.

CIAP functionality does not perform necessary authorization checks for an authenticated user, resulting in escalation of privileges.

Some well-known impacts of Missing Authorization check are:
- Abuse functionality restricted to a particular user group
- Read, modify or delete restricted data

**CVSS Information**

- **CVSS v3 Base Score:** 6.3 / 10
- **CVSS v3 Base Vector:**
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** Low (L)

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/support).

**Other Terms**

CIAP, Access control, Authorization error, Authorization profile

**Reason and Prerequisites**

This is an SAP Tax Declaration Framework note. If you do not have SAP TDF installed in your system, this note does not apply to you. SAP TDF requires a specific license.

This SAP Note is relevant only for Brazil.

**You have implemented SAP Note 2470078.**

**Solution**

As a general rule, SAP recommends that you install a solution by applying a Support Package. However, if you need to install a solution earlier, use the [Note Assistant](https://me.sap.com/support/notes/assistant) to implement the correction instruction. Note that documentation, transactions, and Customizing activities are only delivered via Support Package.

With this SAP Note, new authorization checks are performed in the CIAP transactions. To implement the solution, you must implement the correction instructions that are valid for your release.

**Affected Components**

- **Component:** Financials > Tax Management Framework > Tax Management Framework Brazil > Tax Management Framework Brazil - CIAP
- **SAP Component Key:** FIN-TMF-BR-CIAP

**Validity**

Applicable to the following software components:
- SAP_APPL 605 to 618
- S4CORE 100 to 101

**Support Packages**

Refer to the following [Support Package URLs](https://me.sap.com/supportpackage) for your software component version:
- S4CORE 100: [SAPK-10005INS4CORE](https://me.sap.com/supportpackage/SAPK-10005INS4CORE)
- S4CORE 101: [SAPK-10103INS4CORE](https://me.sap.com/supportpackage/SAPK-10103INS4CORE)
- SAP_APPL 605: [SAPKH60517](https://me.sap.com/supportpackage/SAPKH60517)
- ... *(additional support packages as listed in the note)*

**Correction Instructions**

- **SAP_APPL:** 5 correction instructions [View Instructions](https://me.sap.com/corrins/0002469377/1)
- **S4CORE:** 2 correction instructions [View Instructions](https://me.sap.com/corrins/0002469377/19773)

**References**

- **Referenced by:**
  - [2562251 - TDF: CIAP Troubleshooting Guide](https://me.sap.com/notes/2562251)

**Side Effects**

This document solves side effects caused by:
- [2470078 - TDF: CIAP - ICMS Credit Control of Fixed Assets - 10.4](https://me.sap.com/notes/2470078)

**Attachments**

No attachments available.

For more detailed information, visit the [SAP Security Notes](https://me.sap.com/support/securitynotes).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*