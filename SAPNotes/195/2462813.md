2462813 - SQL Injection Vulnerability in Revenue Accounting

**Title:** 2462813 - SQL Injection Vulnerability in Revenue Accounting

**Description:**
Revenue Accounting allows an attacker to execute crafted database queries, exposing the backend database.

**Symptom:**
Revenue Accounting allows an attacker to execute crafted database queries, exposing the backend database.

Some well-known impacts of SQL Injection vulnerability are:
- Read sensitive data, modify or delete data from the database
- Execute admin-level operations on the database

**Other Terms:**
FARR, Revenue Accounting, Injection attack, blind SQL injection, database vulnerabilities

**Reason and Prerequisites:**
If customers reuse these DB access classes for their custom development, it may lead to SQL Injection errors or sensitive data access.

**Solution:**
Use the standard function `FREE_SELECTIONS_RANGE_2_WHERE` to convert the format from `RSDS_TRANGE` to `RSDS_TWHERE` at the closest place. This ensures that every dynamic selection condition is formatted by the standard function before the SQL query sentence.

**Valid For:**
- **Release 130:** From 130 to SAPK-13001INREVREC
- **Release 120:** From 120 to SAPK-12003INREVREC

**Support Package:**
- **REVREC 120:** [SAPK-12004INREVREC](https://me.sap.com/supportpackage/SAPK-12004INREVREC)
- **REVREC 130:** [SAPK-13002INREVREC](https://me.sap.com/supportpackage/SAPK-13002INREVREC)

**Correction Instructions:**
Number of Correction Instructions: 2
- [Correction Instructions](https://me.sap.com/corrins/0002462813/14019)

**Side Effects:**
This document is causing side effects:
- [2486248 - Correct Datasource 0FARR_RECKEY_ATTR Logic](https://me.sap.com/notes/0002486248)

**Additional Actions:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018767812017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002462813?language=en-US&token=B689AAF3375F11DF854CBEB16A1B1094)

**Credits:**
Information provided by [redrays.io](https://redrays.io) for support.