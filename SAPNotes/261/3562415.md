SAP Security Note 3562415: Multiple Vulnerabilities in Spring Framework within SAP Commerce Cloud and SAP Datahub

## **Symptom**
SAP Commerce Cloud and SAP Datahub use versions of the Spring Framework that contain path traversal ([CVE-2024-38819](https://nvd.nist.gov/vuln/detail/CVE-2024-38819)) and field manipulation ([CVE-2024-38820](https://nvd.nist.gov/vuln/detail/CVE-2024-38820)) vulnerabilities.

## **Reason and Prerequisites**
These vulnerabilities are due to insufficient sanitization of path sequences and locale-dependent exceptions in the Spring Framework components used by SAP Commerce Cloud and SAP Datahub. However, in their default configurations:
- **CVE-2024-38819:** SAP Commerce Cloud and SAP Datahub do not use the vulnerable functional approach in WebMVC.
- **CVE-2024-38820:** They do not use the vulnerable `setDisallowedFields` method in DataBinder.

## **Solution**
SAP addresses these vulnerabilities by upgrading the Spring Framework to version 5.3, which mitigates the identified issues. The following patches include the necessary improvements:

### **For SAP Commerce Cloud:**
- [**Patch Release 2205.36**](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?locale=en-US&version=2205)
- [**Update Release 2211.37**](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/f9b65161e1e645249542e59f42f64a7b.html?version=v2211)

### **For SAP Datahub:**
- [**Release 2205.36 Download**](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL&PAGE=SEARCH/SAP%20COMMERCE)
- [**Release 2211.37 Download**](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/79763857d2264a189cb577fc90de0fea.html)

#### **Installation Instructions:**
- **SAP Commerce Cloud:**
  - [Build Instructions](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/79763857d2264a189cb577fc90de0fea.html)
  - [Deploy Instructions](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/72e126a98eb14b668709be9946070e5c.html)
- **SAP Commerce OnPrem:**
  - [Build and Deploy Instructions](https://help.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/LATEST/en-US/8bb0ad2786691014b930c18dd4cd7851.html)

After installing the patches, ensure you re-build and re-deploy the updated SAP Commerce Cloud or SAP Datahub versions.

## **CVSS Information**
- **CVSS Score:** 3.7
- **Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N](https://nvd.nist.gov/vuln/detail/CVE-2024-38819)

## **Affected Software Components**
- **HY_COM:** From 2205 to 2205
- **HY_DHUB:** From 2205 to 2205
- **COM_CLOUD:** From 2211 to 2211
- **DHUB_CLOUD:** From 2211 to 2211

For more details and downloads, visit [SAP Support Portal](https://me.sap.com/).

---

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*