SAP Security Note 3569602: XSS Vulnerability in SAP Commerce Swagger UI [CVE-2025-27434]

---

**Symptom**

Due to insufficient input validation, SAP Commerce (Swagger UI) allows an unauthenticated attacker to inject malicious code from remote sources, enabling a cross-site scripting (XSS) attack. This vulnerability can significantly impact the confidentiality, integrity, and availability of data in SAP Commerce.

**Other Terms**

- DOM XSS
- [CVE-2025-27434](https://www.cve.org/CVERecord?id=CVE-2025-27434)

**Reason and Prerequisites**

The vulnerability originates from the open-source library `springdoc-openapi-starter`, which includes a repackaged version of `swagger-ui`. In its previous configuration, this version of `swagger-ui` is susceptible to XSS attacks. An attacker can inject malicious XSS payloads into Swagger UIs only if they can persuade a victim to input the malicious payload manually. This attack vector is not exploitable via URLs directly, requiring significant user interaction. Other components of SAP Commerce remain unaffected as the issue is isolated to the `swagger-ui` package.

**Solution**

SAP Commerce resolves this vulnerability by changing the starter theme used by `swagger-ui`. This switch eliminates the risk by removing the explore feature of Swagger UI, which was vulnerable to the DOM-based XSS attack. Consequently, the vulnerable DOM element is no longer rendered in Swagger UI.

> **Note:** As a side effect, customers will no longer be able to open arbitrary OpenApi specifications but only the default specification of the respective extension. Swagger UIs will remain available for a given extension if activated.

**Affected Versions**

- SAP Commerce Cloud Patch Release **2211.37** and later patches address this vulnerability.

**Workaround**

Before implementing the workaround, assess its applicability to your SAP landscape. 

If applying the patch is not feasible, consider the following temporary fixes:

1. **Remove `swagger-ui` Usage:** Eliminate any use of `swagger-ui` in SAP Commerce. Refer to the [documentation](https://me.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/e1391e5265574bfbb56ca4c0573ba1dc/c22fd09d5e7545dab3d9edc6bf3d6a5a.html) for guidance.
2. **Block Swagger Consoles:** Restrict access to Swagger consoles through firewall rules, Web Application Firewalls (WAF), or similar security measures.

> **Warning:** Implementing this workaround will disable the ability to test and use SAP Commerce APIs via Swagger consoles.

**CVSS**

- **Score:** 8.8
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Additional Information**

For more details, visit the [SAP Support Portal](https://me.sap.com/notes/3569602).

---

Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.