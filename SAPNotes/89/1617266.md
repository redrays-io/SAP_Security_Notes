1617266 - Unauthorized modification of content in Interaction Center

**SAP Note:** [1617266 - Unauthorized modification of content in Interaction Center](https://me.sap.com/notes/1617266)

**Type:** SAP Security Note  
**Version:** 1  
**Released On:** December 13, 2011  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Category:** Program error  
**Component:** Customer Relationship Management > Interaction Center WebClient > E-Mail Response Management System

### Description

**Symptom**

Some functions in the CRM Interaction Center that use the so-called BTF editor can be abused by a malicious user, allowing them to modify application content, persist the modified content without authorization, and potentially obtain authentication information from other legitimate users.

**Other Terms**

Stored cross-site scripting, XSS, CSS

**Reason and Prerequisites**

Using certain functions in the CRM Interaction Center that utilize the BTF editor can result in a stored cross-site scripting issue. This vulnerability allows malicious users to permanently modify displayed content on a website, enabling them to embed content that is rendered automatically without needing to target victims individually. Additionally, stored cross-site scripting can be exploited to steal another user's authentication information, such as data related to their current session. A malicious user who gains access to this data may impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

### Solution

1. **Implement SAP Note [1577766](https://me.sap.com/notes/1577766)** first.

2. After implementing the attached correction instructions, content processed by the BTF editor will be filtered. If filtering is not possible, the content will be removed.

3. For ERMS E-mail Workbench and the Agent Inbox E-Mail Editor, activate filtering explicitly:
    - **Execute a new parameter value** for the parameter controlling the display of HTML mails.
    - Refer to the manual steps for the corresponding release for detailed instructions.

### Correction Instructions

[Download Correction Instructions](https://me.sap.com/corrins/0001617266/63)

**Steps:**

1. Start transaction `SE11`.
2. Change domain `CRM_IC_HTMLMAIL_DISP`.
3. On the 'Value Range' tab, enter the following fixed value in English:
    - **Fixed Value:** FLT
    - **Short Description:** Filtered
4. Activate your changes.

This will make a new option for displaying HTML mails available under the IMG path:
`Customer Relationship Management → Interaction Center WebClient → Basic Functions → Communication Channels → Define E-Mail Profiles`.

5. To set up filtering, execute transaction `SM30` and modify table `SMOFPARSFA` by adding the following entries:
    - **Key:** `CRMIC`
    - **Parameter Name:** `HTMLDISPLAY`
    - **Param. Value:** `FLT`
    - **Param. Name 2:** Your E-Mail profile (add more rows for each E-Mail profile).

**Param-Value Notes:**
- `''` = Enabled
- `'DIS'` = Disabled
- `'FLT'` = Filtered

### Prerequisites

Ensure the following SAP Notes are implemented:
- [1086680](https://me.sap.com/notes/1086680) - URL in created email launches in email view causes error
- [1145782](https://me.sap.com/notes/1145782) - Javascript error occurs randomly when viewing emails
- [1497951](https://me.sap.com/notes/1497951) - Unauthorized modification of stored content in Interaction Center
- [1644756](https://me.sap.com/notes/1644756) - Unauthorized modification of content in CRM IC
- ... *(additional notes as listed in the original document)*

### References

This document refers to [SAP Note 1497951](https://me.sap.com/notes/1497951) - Unauthorized modification of stored content in Interaction Center.

### Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009603772017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001617266?language=en-US&token=718E0143CA53CD7C2B4BE30DB2629178)

---

**Credits:** Thanks to [redrays.io](https://redrays.io) for supporting and providing the information.