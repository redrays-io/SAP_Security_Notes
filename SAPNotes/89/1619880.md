1619880 - SREP: Data Import of Electronic Time Register - Directory Traversal Vulnerability

**Symptom**

The **Data import of electronic time register** (HBRTMIF0) report contains a vulnerability allowing a malicious user to potentially read arbitrary files on the remote server. This could lead to disclosing confidential information, corrupting data, or altering system behavior.

**Other Terms**

- Directory traversal
- SREP
- HBRTMIF0
- Portaria 1510
- Ordinance 1510

**Reason and Prerequisites**

The HBRTMIF0 report does not correctly validate the file path used to reference files read from the remote server. Consequently, a malicious user can direct the program to any other file in the system, potentially disclosing its contents.

**Solution**

The HBRTMIF0 report has been updated to validate input files properly. This improvement is included in an HR Support Package, as detailed in the "Reference to Support Packages" section below.

**Support Package Details**

- **SAP_HR 46C**
  - Support Package: [SAPKE46CH9](https://me.sap.com/supportpackage/SAPKE46CH9)

- **SAP_HRCBR 470**
  - Support Package: [SAPK-470C4INSAPHRCBR](https://me.sap.com/supportpackage/SAPK-470C4INSAPHRCBR)

- **SAP_HRCBR 500**
  - Support Package: [SAPK-50090INSAPHRCBR](https://me.sap.com/supportpackage/SAPK-50090INSAPHRCBR)

- **SAP_HRCBR 600**
  - Support Package: [SAPK-60073INSAPHRCBR](https://me.sap.com/supportpackage/SAPK-60073INSAPHRCBR)

- **SAP_HRCBR 604**
  - Support Package: [SAPK-60439INSAPHRCBR](https://me.sap.com/supportpackage/SAPK-60439INSAPHRCBR)

**Correction Instructions**

1. **Execute Transaction FILE**
2. **Logical File Path Definition**
   - Create new entries: `HR_BR_DIR_AFD_FILE` with the name `AFD file import`.
3. **Logical File Name Definition, Cross-Client**
   - Add new entries with the following details:
     - Logical file: `HR_BR_DIR_AFD_FILE`
     - Name: `AFD file import`
     - Data format: `DIR`
     - Application area: `HR`
     - Logical path: `HR_BR_DIR_AFD_FILE`
4. **Assign Physical Paths**
   - Use the "Assignment of Physical Paths to Logical Path" option in Transaction FILE.
   - Maintain client-specific logical file names using Transaction SF01.
   - Refer to the Implementation Guide (IMG) under `SAP NetWeaver -> Application Server -> System administration -> Platform-Independent File Names` for more details.

For more information, visit the [SAP Service Marketplace](https://me.sap.com/service-support).

**Prerequisites**

Ensure the following SAP Notes are applied:

- [1508171](https://me.sap.com/notes/1508171) - Portaria No. 1510 - Electronic time clock record
- [1517029](https://me.sap.com/notes/1517029) - SREP: Data import of electronic time register - PIS numbers
- [1531975](https://me.sap.com/notes/1531975) - HBRTMIF0 - Importation server files is not working properly

**Credits**

Special thanks to [RedRays](https://redrays.io) for supporting the provision of this information.