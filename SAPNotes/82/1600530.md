1600530 - Unauthorized use of application functions in PT-RC-UI-XS

## Description

**Symptom**  
An attacker can execute functions in PT-RC-UI-XS without authentication and authorization.

**Other Terms**  
Cross-site request forgery, XSRF, PT-RC-UI-XS

**Reason and Prerequisites**  
PT-RC-UI-XS executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The attacker may use a cross-site scripting attack to do this, or they may present a link to the victim.

## Solution

1. For additional information and instructions, see [Note 1520324](https://me.sap.com/notes/1520324). The corrections from Note 1520324 are a prerequisite for implementing this note.
2. Implement the correction instructions provided in this note. Create the report `ZBSP_XSRF_PARAM_ESS_LEAVEREQ` as a local object in your system.
3. Execute the report `ZBSP_XSRF_PARAM_ESS_LEAVEREQ` and when requested, specify a relevant transport request number. The report will fill the database table `BSPTEMPXSRFSTORE` with relevant table entries for the BSP applications adapted by this note.

## Affected Components

- **Component:** Personnel Time Management > Time Data Recording and Management > User Interface > Leave Self Services Web Dynpro (PT-RC-UI-XS)
- **Release Status:** Released for Customer
- **Priority:** Correction with high priority
- **Released On:** 14.02.2012

## References

- [Note 1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)
- [Note 693368 - ESS: Error in R/3; Business Server Page Error (Admin)](https://me.sap.com/notes/693368)

## Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009502332017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001600530?language=en-US&token=0CD928BA7372ADE3CCBA06AEC34B5744)

## Attachments

- [ZBSP_XSRF_PARAM_ESS_LEAVEREQ.txt](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000280332011&iv_version=0002&iv_guid=D50775C6D2E538468BE79CD2C5A031C9)

Credits to [RedRays.io](https://redrays.io) for support in providing this information.