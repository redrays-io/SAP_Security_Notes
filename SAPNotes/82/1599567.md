SAP Security Note 1599567 - Unauthorized use of application functions in Dealer portal

**SAP Security Note 1599567 - Unauthorized use of application functions in Dealer portal**

---

### **Symptom**
An attacker can execute functions in BSP-based Automotive Dealer Portal without authentication and authorization.

### **CVSS Information**
- **CVSS Base Score:** 6.8
- **CVSS Base Vector:** AV:N/AC:M/AU:N/C:P/I:P/A:P

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://me.sap.com/securitynotes/) on the SAP website.*

### **Other Terms**
Cross-Site Request Forgery (CSRF), XSRF, Warranty, Automotive, Dealer Portal, A&D.

### **Reason and Prerequisites**
The Automotive Dealer Portal executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user.

The attacker may use a Cross-Site Scripting (XSS) attack to do this, or they may present a link to the victim.

### **Solution**
The corrections for XSRF protection are enabled via the Workbench.

For EA-APPL 605 and subsequent lower releases, please follow the manual correction instructions attached.

**Please note:**
1. Refer to [Note 1520324](https://me.sap.com/notes/1520324) for additional information and instructions. The corrections from Note 1520324 are a prerequisite for the implementation of this note.
2. Implement the correction instructions of this note.

### **Manual Activities**

#### **/sapdii/di_spp_ui:**
1. Open the BSP application `/sapdii/di_spp_ui` in SE80 transaction.
2. In the Properties tab of the BSP application, check the flag **'XSRF Protection'**.
3. Navigate to the controllers `c_spp_main.do`, `c_spp_header.do`, `c_spp_overview.do`, `c_spp_del.do`, `c_spp_inv.do`, `c_spp_ord.do`, `c_spp_ret.do`.
4. Check the flag **'Start BSP'**.
5. Save and activate the BSP application.

#### **/sapdii/dwb:**
1. Open the BSP application `/sapdii/dwb` in SE80 transaction.
2. In the Properties tab of the BSP application, check the flag **'XSRF Protection'**.
3. Save and activate the BSP application.

#### **/sapdii/di_dp_common:**
1. Open the BSP application `/sapdii/di_dp_common` in SE80 transaction.
2. In the Properties tab of the BSP application, check the flag **'XSRF Protection'**.
3. Save and activate the BSP application.

### **Support Packages**
This security note is applicable to the following SAP Application Components:

| **Software Component** | **From** | **To** |
|------------------------|----------|--------|
| EA-APPL                | 600      | 600    |
| EA-APPL                | 602      | 602    |
| EA-APPL                | 603      | 603    |
| EA-APPL                | 604      | 604    |
| EA-APPL                | 605      | 605    |
| EA-APPL                | 606      | 606    |

### **Download and Additional Resources**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009496222017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001599567?language=en-US&token=B0A0E41364F55F3E0786E85438743F93)
- [Edit Note](https://me.sap.com/notes/0001599567/Edit)
- [Show Changes](https://me.sap.com/notes/0001599567/CompareVersions)

### **Available Languages**
- [Deutsch](https://me.sap.com/notes/0001599567/D) (Human Translation)
- [日本語](https://me.sap.com/notes/0001599567/J) (Human Translation)
- [Português](https://me.sap.com/notes/0001599567/P) (Machine Translation)
- [Español](https://me.sap.com/notes/0001599567/S) (Machine Translation)
- [Français](https://me.sap.com/notes/0001599567/F) (Machine Translation)
- [Italiano](https://me.sap.com/notes/0001599567/I) (Machine Translation)
- [Русский](https://me.sap.com/notes/0001599567/R) (Machine Translation)
- [中文](https://me.sap.com/notes/0001599567/1) (Machine Translation)
- [한국어](https://me.sap.com/notes/0001599567/3) (Machine Translation)

### **References**
- [Note 1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)

---

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*