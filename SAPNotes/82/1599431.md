SAP Security Note 1599431 - Potential disclosure and modification of persisted data

**SAP Note Number:** 1599431  
**Type:** SAP Security Note  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 08.11.2011  
**Component:** Customer Relationship Management > Mobile Sales > Use CRM-MSA (Adapters Mobile Sales)

### Description

#### Symptom
A malicious user can exploit persisted data from the Consolidated Database using specially crafted inputs to execute arbitrary database commands in function modules of certain upgrade packages to retrieve, modify, or remove data persisted by the system.

#### Other Terms
- SQL injection
- Database

#### Reason and Prerequisites
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement dynamically including strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve additional information from the database or to potentially modify it.

#### Solution
Please implement the attached correction instructions.

### Affected Software Components
- **BBPCRM** versions 400, 500, 520, 600, 700, 701

### Support Packages
- **BBPCRM 400:** [SAPKU40018](https://me.sap.com/supportpackage/SAPKU40018)
- **BBPCRM 500:** [SAPKU50019](https://me.sap.com/supportpackage/SAPKU50019)
- **BBPCRM 520:** [SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011)
- **BBPCRM 600:** [SAPKU60010](https://me.sap.com/supportpackage/SAPKU60010)
- **BBPCRM 700:** [SAPKU70010](https://me.sap.com/supportpackage/SAPKU70010)
- **BBPCRM 701:** [SAPKU70106](https://me.sap.com/supportpackage/SAPKU70106)

### Correction Instructions
- **BBPCRM:** 6 correction instructions  
  [View Correction Instructions](https://me.sap.com/corrins/0001599431/63)

### Prerequisites
- **BBPCRM 300 to 400:**  
  [SAP Note 709950](https://me.sap.com/notes/709950) - Performance Problem in UPDATE_DB_COMP_TABLES (Component: CRM-MSA-ADP-PAS)
- **BBPCRM 400:**  
  [SAP Note 902590](https://me.sap.com/notes/902590) - Performance of upgrade report PAS_MATNRLNG_MIGRATION (Component: CRM-MSA-ADP-MIG)  
  [SAP Note 1487906](https://me.sap.com/notes/1487906) - Missing authorization check in Employee Migration Program (Component: CRM-MSA)
- **BBPCRM 500:**  
  [SAP Note 1487906](https://me.sap.com/notes/1487906) - Missing authorization check in Employee Migration Program (Component: CRM-MSA)
- **BBPCRM 520:**  
  [SAP Note 1487906](https://me.sap.com/notes/1487906) - Missing authorization check in Employee Migration Program (Component: CRM-MSA)
- **BBPCRM 600:**  
  [SAP Note 1487906](https://me.sap.com/notes/1487906) - Missing authorization check in Employee Migration Program (Component: CRM-MSA)
- **BBPCRM 700:**  
  [SAP Note 1487906](https://me.sap.com/notes/1487906) - Missing authorization check in Employee Migration Program (Component: CRM-MSA)

### Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009495512017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001599431?language=en-US&token=44C42D0ED8DDE059A126CA26F193B1F7)

### Available Languages
- [Deutsch (D)](https://me.sap.com/notes/0001599431/D)
- [日本語 (J)](https://me.sap.com/notes/0001599431/J)
- [Português (P) - Machine Translation](https://me.sap.com/notes/0001599431/P)
- [Español (S) - Machine Translation](https://me.sap.com/notes/0001599431/S)
- [Français (F) - Machine Translation](https://me.sap.com/notes/0001599431/F)
- [Italiano (I) - Machine Translation](https://me.sap.com/notes/0001599431/I)
- [Русский (R) - Machine Translation](https://me.sap.com/notes/0001599431/R)
- [中文 (1) - Machine Translation](https://me.sap.com/notes/0001599431/1)
- [한국어 (3) - Machine Translation](https://me.sap.com/notes/0001599431/3)

### CVSS
**Score:** 0  
**Vector:** Not provided

*Credits to [redrays.io](https://redrays.io) for support to provided information.*