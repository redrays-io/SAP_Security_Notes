1496008 - Trace: Possible divulging of saved trace data

**Symptom**

A malicious user can exploit a program or transaction and use specially crafted inputs to execute arbitrary database commands to ensure it outputs trace data.

**Other Terms**

SQL injection, database, workflow trace

**Reason and Prerequisites**

The problem is caused by an SQL injection vulnerability. The code composes an SQL statement including strings that can be altered by a malicious user. As a result, the attacker can manipulate the entire resulting statement and, therefore, execute all SQL statements with the rights of the database user who is logged on.

**Solution**

Import the Support Package or implement the correction instructions.

For the following releases, we can provide correction instructions only as of a specific Support Package:

- **SAP_BASIS 640** → as of [Support Package 17](https://me.sap.com/supportpackage/SAPKB64027)
- **SAP_BASIS 700** → as of [Support Package 8](https://me.sap.com/supportpackage/SAPKB70023)

**Support Package**

| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| SAP_BASIS 640              | SAPKB64027      | [Link](https://me.sap.com/supportpackage/SAPKB64027) |
| SAP_BASIS 700              | SAPKB70023      | [Link](https://me.sap.com/supportpackage/SAPKB70023) |
| SAP_BASIS 701              | SAPKB70108      | [Link](https://me.sap.com/supportpackage/SAPKB70108) |
| SAP_BASIS 702              | SAPKB70205      | [Link](https://me.sap.com/supportpackage/SAPKB70205) |
| SAP_BASIS 710              | SAPKB71011      | [Link](https://me.sap.com/supportpackage/SAPKB71011) |
| SAP_BASIS 711              | SAPKB71106      | [Link](https://me.sap.com/supportpackage/SAPKB71106) |
| SAP_BASIS 720              | SAPKB72004      | [Link](https://me.sap.com/supportpackage/SAPKB72004) |
| SAP_BASIS 730              | SAPKB73001      | [Link](https://me.sap.com/supportpackage/SAPKB73001) |

**Correction Instructions**

| Software Component | Number of Correction Instructions | URL |
|--------------------|-----------------------------------|-----|
| SAP_BASIS          | 8                                 | [Link](https://me.sap.com/corrins/0001496008/41) |

**Preconditions**

| Software Component | From | To  | SAP Note/KBA | URL | Title                                    | Component         |
|--------------------|------|-----|--------------|-----|------------------------------------------|-------------------|
| SAP_BASIS          | 700  | 700 | 1487337      | [Link](https://me.sap.com/notes/1487337) | Downporting the class CL_ABAP_DYN_PRG | BC-ABA-LA         |
| SAP_BASIS          | 701  | 701 | 1487337      | [Link](https://me.sap.com/notes/1487337) | Downporting the class CL_ABAP_DYN_PRG | BC-ABA-LA         |
| SAP_BASIS          | 702  | 702 | 1487337      | [Link](https://me.sap.com/notes/1487337) | Downporting the class CL_ABAP_DYN_PRG | BC-ABA-LA         |
| SAP_BASIS          | 710  | 710 | 1487337      | [Link](https://me.sap.com/notes/1487337) | Downporting the class CL_ABAP_DYN_PRG | BC-ABA-LA         |
| SAP_BASIS          | 711  | 711 | 1487337      | [Link](https://me.sap.com/notes/1487337) | Downporting the class CL_ABAP_DYN_PRG | BC-ABA-LA         |
| SAP_BASIS          | 720  | 720 | 1487337      | [Link](https://me.sap.com/notes/1487337) | Downporting the class CL_ABAP_DYN_PRG | BC-ABA-LA         |
| SAP_BASIS          | 730  | 730 | 1487337      | [Link](https://me.sap.com/notes/1487337) | Downporting the class CL_ABAP_DYN_PRG | BC-ABA-LA         |

**CVSS**

- **CVSS Score:** 0
- **CVSS Vector:** N/A

**Rating**

- **Rated Helpful:** 0 people
- **Quality Rating:** 0.0/5
- **Quality Votes:** 0

**Side Effects**

- **This document solves side effects:** None
- **This document is causing side effects:** None

*Credits: [RedRays.io](https://redrays.io) for support to provided information.*