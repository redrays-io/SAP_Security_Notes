1504497 - COPA: Potential Directory Traversal

**SAP Security Note 1504497 - COPA: Potential Directory Traversal**

**Description:**
A potential directory traversal vulnerability exists in the CO-PA module. This vulnerability may allow a malicious user to read arbitrary files on the remote server, potentially disclosing confidential information. Additionally, some programs may allow writing arbitrary files, which could corrupt data or alter system behavior.

**Symptoms:**
- Potential Directory Traversal in module CO-PA

**Other Terms:**
- Path traversal
- COPA
- KE

**Reason and Prerequisites:**
The programs addressed in this correction contain vulnerabilities that could be exploited to read or write arbitrary files on the server. Implementing this note requires the corrections from [SAP Note 1497003](https://me.sap.com/notes/1497003) as a prerequisite.

**Solution:**
Refer to [SAP Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The following logical file names have been created to validate physical file names:

- **COPA_REOCE4** used in program RKEREOCE4_EXTRACT
- **COPA_RKEHOH10** used in program RKEHOH10
- **COPA_RKEXD000** used in program RKEXD000
- **COPA_KEFC_IN** and **COPA_KEFC_OUT** used in transaction KEFC
- **COPA_KEDA** used in transaction KEDA

These logical file names utilize the logical file path `COPA_ROOT`.

**Download and Documentation:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008905602017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001504497?language=en-US&token=20A02FC5DA4A766BE6FD69A244DF7E23)

**Valid Software Components:**
- SAP_APPL 31I to 605
- SAP_BASIS 46B to 710

**References:**
- [SAP Note 1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003)
- [SAP Note 1403572: Missing authorization check in CO-PA](https://me.sap.com/notes/1403572)
- [SAP Note 1322707: KEDA for account-based summarization levels](https://me.sap.com/notes/1322707)

**Available Languages:**
- [Japanese](https://me.sap.com/notes/0001504497/J)
- [Deutsch](https://me.sap.com/notes/0001504497/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0001504497/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001504497/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001504497/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001504497/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001504497/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001504497/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001504497/3)

**Credits:**
Information supported by [RedRays.io](https://redrays.io).