1505302 - Purchasing Agent: Security Note for XSRF and BSP Applications

**Symptom**

A malicious user can trigger functionality in the BSP applications of the Portal Role **"Purchasing Agent"** without authentication and authorization. This role is part of the business package **"External Procurement"**. The affected BSP applications are:
- **MMPUR_DOCTRK** (Document Tracing)
- **MMPUR_VNDCNF** (Vendor Confirmations)

**Other Terms**
- Cross-Site Request Forgery (XSRF)
- Purchasing Agent
- BSP (Business Server Pages)
- Security

**Reason and Prerequisites**

The two BSP applications execute specific functions through referencing particular URLs. An attacker could trick an authenticated user's browser into making a request containing these URLs and specific parameters, causing the function to execute with the user's rights. Additionally, if present, the attacker might use a Cross-Site Scripting (XSS) attack to facilitate this exploit or present a clickable link to the victim.

**Solution**

Follow these steps to address the security vulnerability:

1. **Refer to [SAP Note 1520324](https://me.sap.com/notes/1520324)** for additional information and instructions. The corrections from this note are a prerequisite for implementing this security note.
2. **Implement the correction instructions from [this note](https://me.sap.com/notes/1505302)**. This will create the report `BSP_XSRF_PARAM_MM_PUR` in your system.
3. **Execute the report `BSP_XSRF_PARAM_MM_PUR`** and provide a corresponding transport request number when prompted. The report will populate the database table `BSPTEMPXSRFSTORE` with the necessary entries for the adapted BSP applications.

**Downloads and Additional Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008909292017)
- [PDF Version](https://me.sap.com/support/sfm/notes/print/0001505302?language=en-US&token=B4D26041422FEC39547DD42CD13BF609)

**References**

- [SAP Note 1520324](https://me.sap.com/notes/1520324) - Advance creation of XSRF information
- [SAP Note 1540729](https://me.sap.com/notes/1540729) - ASU content for activating XSRF protection for BSP

**Validity**

This security note is applicable to the following SAP_APPL software components:
- Versions 500 through 605

**Support Packages**

Ensure that your system is updated with the relevant support packages listed in the [Support Package section](https://me.sap.com/supportpackage/SAPKH1505302) of the note.

For more detailed information and updates, visit the [SAP Support Portal](https://me.sap.com/).

*Credits: Information supported by [Redrays.io](https://redrays.io).*