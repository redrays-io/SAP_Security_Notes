SAP Security Note 1505368: EHS: Potential Directory Traversal

---

**Overview**
  
SAP Security Note 1505368 addresses a potential directory traversal vulnerability in the Environment, Health, and Safety (EHS) component. This vulnerability may allow malicious users to read or write arbitrary files on the server, potentially disclosing confidential information or corrupting data.

**Symptoms**
  
- **Updated Security Note:** Refer to [Security Note 1540408](https://me.sap.com/notes/1540408) for additional details.
- **Affected Functionalities:**
  - Import and export of specifications, phrase libraries, sources, property trees, report templates, and reports.
  - Uploading and downloading of files.
- **Additional Issue:** During import/export of phrase libraries or sources, the physical path field length is insufficient.

**Reason and Prerequisites**
  
The vulnerability exists due to flaws in the programs that handle file operations, allowing unauthorized access to the server's file system. Before implementing this security note, ensure that the corrections from [SAP Note 1497003](https://me.sap.com/notes/1497003) are applied.

**Solution**
  
1. **Apply Prerequisite Corrections:**
   - Implement corrections from [SAP Note 1497003](https://me.sap.com/notes/1497003).
   
2. **Configure Logical File Names:**
   - Define and validate logical file names and paths as specified in the correction instructions.
   
3. **Download and Apply the Security Note:**
   - [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008919492017)
   - [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001505368?language=en-US&token=20C3A70BCC8EBDB3515E00F160A9A228)

**Affected Components**
  
- **Component:** Environment, Health, and Safety / Product Compliance > Product Safety (EHS-SAF)
- **SAP Components Versions:** Various versions are affected. Refer to the "Validity" section in the original note for detailed information.

**References**
  
- [SAP Note 1793271: Runtime error during data import and export](https://me.sap.com/notes/1793271)
- [SAP Note 1552798: Directory Traversal in EH&S](https://me.sap.com/notes/1552798)
- [SAP Note 1540408: Update #1 for security Note 1505368](https://me.sap.com/notes/1540408)
- [SAP Note 1529298: Import and export: Changes to the documentation](https://me.sap.com/notes/1529298)
- [SAP Note 1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Support Packages**
  
Ensure that your system is updated with the relevant support packages as specified in the security note. Refer to the "Support Package" section for detailed links:
  
- [SAPKIPEI18](https://me.sap.com/supportpackage/SAPKIPEI18)
- [SAPKGPAA32](https://me.sap.com/supportpackage/SAPKGPAA32)
- ... *(Additional support packages as listed in the original note)*

**CVSS**
  
- **Score:** 0
- **Vector:** Not provided

**Side Effects**
  
Implementing this security note may interact with other notes and functionalities:
  
- [Importing data (with validation)](https://me.sap.com/notes/1539751)
- [Runtime error during data import and export](https://me.sap.com/notes/1793271)
- [Internal system error when exporting sources](https://me.sap.com/notes/1627581)
- [Directory Traversal in EH&S](https://me.sap.com/notes/1552798)
- [Specification import terminates with runtime error](https://me.sap.com/notes/1533264)

**Credits**
  
Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.

---