1505512 - Bank master data: Potential Directory Traversal

### SAP Security Note 1505512

**Type:** SAP Security Note  
**Version:** 5  
**Language:** English  
**Released On:** 14.12.2010  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Category:** Program error  
**Recency:** New  
**Component:** Cross-Application Components > Bank (CA-BK)

---

#### **Symptom**
Potential Directory Traversal in the following programs (transactions):
- `RFBVALL_0` (BAUP)
- `RFBVBIC_0` (BIC)
- `RFBVBIC2` (BIC2)
- `RFIBANMD` (IBANMD)

**Other Terms:**  
Path traversal

#### **Reason and Prerequisites**
1. The programs contained in the correction instructions contain vulnerabilities that allow malicious users to potentially read arbitrary files on the remote server, possibly disclosing confidential information.
2. Some programs also allow malicious users to potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

#### **Solution**
Please refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The corrections from Note 1497003 are a prerequisite for implementing this note.

**Logical File Names Used in this Solution:**
- **BANK_DIRECTORY** - used in program `RFBVALL_0` for reading
- **BIC_PLUS_IBAN_DIRECTORY** - used in programs `RFBVBIC_0` and `RFBVBIC2` for reading
- **IBAN_BIC_UPLOAD**, **IBAN_BIC_DOWNLOAD** - used in program `RFIBANMD` for reading/uploading and writing/downloading.

**Logical File Paths Used in this Solution:**
- **BANK_DATA** - used with logical file names `BANK_DIRECTORY` and `BIC_PLUS_IBAN_DIRECTORY`
- **IBAN_BIC_DATA** - used with logical file names `IBAN_BIC_UPLOAD` and `IBAN_BIC_DOWNLOAD`

#### **Affected Software Components**
- **SAP_ABA** versions: 46C, 620, 640, 700 to 702, 710 to 711, 730

#### **Support Packages**
Refer to the following support packages required for your SAP_ABA components:
- [SAPKA46C62](https://me.sap.com/supportpackage/SAPKA46C62) for SAP_ABA 46C
- [SAPKA62070](https://me.sap.com/supportpackage/SAPKA62070) for SAP_ABA 620
- [SAPKA64028](https://me.sap.com/supportpackage/SAPKA64028) for SAP_ABA 640
- [SAPKA70024](https://me.sap.com/supportpackage/SAPKA70024) for SAP_ABA 700
- [SAPKA70109](https://me.sap.com/supportpackage/SAPKA70109) for SAP_ABA 701
- [SAPKA70206](https://me.sap.com/supportpackage/SAPKA70206) for SAP_ABA 702
- [SAPKA71012](https://me.sap.com/supportpackage/SAPKA71012) for SAP_ABA 710
- [SAPKA71107](https://me.sap.com/supportpackage/SAPKA71107) for SAP_ABA 711
- [SAPKA73002](https://me.sap.com/supportpackage/SAPKA73002) for SAP_ABA 730

#### **Correction Instructions**
- **Software Component:** SAP_ABA  
  **Number of Correction Instructions:** 4  
  [View Correction Instructions](https://me.sap.com/corrins/0001505512/44)

#### **Manual Activities**
Funtion module: `KD_GET_FILENAME_ON_F4`

Add a new import parameter:
- **Parameter name:** PATH
- **Type:** DXFIELDS-LONGPATH
- **Default Value:** *(None)*
- **Optional:** X
- **Pass value:** X

#### **Prerequisites**
Refer to the list of prerequisite SAP Notes and KBAs [here](https://me.sap.com/notes/1505512/preconditions).

#### **References**
This document refers to:
- [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

---

For more detailed information, visit the [SAP Support Portal](https://me.sap.com/notes/1505512).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*