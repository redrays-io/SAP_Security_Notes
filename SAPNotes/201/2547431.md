2547431 - [CVE-2018-2380] Directory Traversal vulnerability in Internet Sales

**Symptom**

Internet Sales allows an attacker to exploit insufficient validation of path information provided by users, allowing characters representing 'traverse to parent directory' to be passed to the file APIs.

**Impacts of Directory Traversal Vulnerability:**
- **Confidentiality**: An attacker could read the content of arbitrary files on the remote server and expose sensitive data.
- **Integrity**: An attacker could overwrite, delete, or corrupt arbitrary files on the remote server.

**CVSS Information**
- **CVSS v3 Base Score**: 6.6 / 10
- **CVSS v3 Vector**: AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L

_SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. It does not account for your system configuration or operational environment. For more information, refer to the [SAP Security Notes FAQ](https://support.sap.com/securitynotes)._

**Other Terms**
Path traversal, backtracking, directory climbing, Internet Sales, ECo, E-Commerce, WebChannel, Web Channel, CRM-ISA, CRM-ISE, [CVE-2018-2380](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-2380)

**Reason and Prerequisites**
- **Reason**: Internet Sales did not properly check the provided log file destination.
- **Prerequisites**: An attacker needs to be logged in as an admin user.

**Solution**

Internet Sales now properly checks the log paths submitted by the user and disallows arbitrary log file locations and extensions.

To resolve this issue, apply the Support Package patch level attached to this note. For more information about applying Java patches, refer to [Note 877887](https://me.sap.com/notes/877887). See [Note 1546959](https://me.sap.com/notes/1546959) for information about the patch strategy.

**References**
- [Note 1546959 - Patch strategies for SAP E-Commerce solutions](https://me.sap.com/notes/1546959)
- [Note 877887 - Installing Patches for CRM Java Components and FSCM BD](https://me.sap.com/notes/877887)

**Support Package Patches**

Refer to the [Support Package Patches](https://me.sap.com/notes/2547431) section of this note for the list of applicable patches based on your software component versions.

---

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*