SAP Note 2540180 â€“ Switchable Authorization Checks for RFC in Environment, Health & Safety

**Summary**

SAP Note [2540180](https://me.sap.com/notes/2540180) introduces switchable authorization checks for Remote Function Calls (RFC) within the Environment, Health & Safety (EHS) module. This enhancement addresses security concerns by implementing additional authorization checks beyond the standard S_RFC object, ensuring more secure execution of RFC function modules.

**Details**

- **Type**: SAP Security Note
- **Version**: 3
- **Released On**: June 9, 2020
- **Priority**: Correction with medium priority
- **Status**: Released for Customer

**Problem Addressed**

The standard S_RFC authorization checks are insufficient for certain RFC function modules in EHS, potentially leading to security vulnerabilities. This note implements new switchable authorization checks to mitigate these risks.

**Solution**

New switchable authorization checks are implemented and delivered inactive to maintain compatibility with existing processes. They can be activated using transaction **SACF** as detailed in the manual correction instructions provided with the note.

**Implementation Steps**

1. **Create Authorization Scenario Definitions**
   - Start transaction **SACF** in the development system.
   - Verify if scenario definitions (e.g., EHS_PS_GLM, EHS_PS_GLM_PROC_ORD, EHS_PS_BOMBOS) exist.
   - If not, download the corresponding `.txt` files attached to the note.
   - Use transaction **SACF_TRANSFER** to upload and assign the scenario definitions to the appropriate development packages.

2. **Activate Switchable Authorization Checks**
   - After implementing via support package or correction instructions, activate the checks manually.
   - Use transaction **SACF_COMPARE** post system updates for collective maintenance of authorization scenarios.

**Affected Components**

- **SAP Component**: EHS-BD-TLS (Environment, Health, and Safety / Product Compliance > Basic Data and Tools > Tools)
- **Function Modules**:
  - `CBIF_GLM1_PROCESS_ORDER_READ`
  - `CBIF_GLM1_DELIVERY_NOTE_READ`
  - `C1L0_BOM_TRIGGER_GEN_WL`
  - `C1L3_READ_STKO`
  - `C1L3_READ_STPO`

**Prerequisites**

Ensure the following SAP Notes are applied:
- [2216306: S_RFC check and profile parameter auth/rfc_authority_check](https://me.sap.com/notes/2216306)
- [2449051: SACF | Documentation of scenarios](https://me.sap.com/notes/2449051)
- [2008727: Securing Remote Function Calls (RFC)](https://me.sap.com/notes/2008727)

**Side Effects**

Implementing this note may cause syntax errors during note implementation if certain fields (e.g., ABAP_TRUE in function module `C1L0_BOM_TRIGGER_GEN_WL`) are unknown. Refer to [2952629](https://me.sap.com/notes/2952629) for details.

**Downloads and Documentation**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000960192020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002540180?language=en-US&token=445631A13DA84A76A05C7B384E6CAE38)
- [Manual Correction Instructions](https://me.sap.com/corrins/0002540180/1)

**References**

- [2216306: S_RFC check and profile parameter auth/rfc_authority_check](https://me.sap.com/notes/2216306)
- [2449051: SACF | Documentation of scenarios](https://me.sap.com/notes/2449051)
- [2008727: Securing Remote Function Calls (RFC)](https://me.sap.com/notes/2008727)
- [2952629: Syntax error during note implementation because field ABAP_TRUE is not known in function module C1L0_BOM_TRIGGER_GEN_WL](https://me.sap.com/notes/2952629)

**Credits**

Thanks to [RedRays.io](https://redrays.io) for support and provided information.