2537545 - [CVE-2017-16685] Cross-Site Scripting (XSS) vulnerability in SAP BW Universal Data Integration

**Header Data**
- **SAP Note/KBA**: 2537545
- **Type**: SAP Security Note
- **Version**: 7
- **Recency**: Updated
- **Language**: English
- **Category**: Program error
- **Priority**: Correction with medium priority
- **Status**: Released for Customer
- **Released On**: 12.12.2017
- **Component**: [SAP Business Warehouse > Business Explorer > Universal Data Integration](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BW-BEX-UDI*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

**Description**

### Symptom
SAP Business Warehouse (BW) Universal Data Integration (UDI) does not sufficiently encode user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability.

Some well-known impacts of XSS vulnerability are:
- Non-permanently deface or modify displayed content from a Web site
- Steal authentication information of the user, such as data relating to their current session
- Impersonate the user and access all information with the same rights as the target user

### CVSS Information
- **CVSS v3 Base Score**: 6.9 / 10
- **Attack Vector**: Network (N)
- **Attack Complexity**: High (H)
- **Privileges Required**: None (N)
- **User Interaction**: Required (R)
- **Scope**: Changed (C)
- **Confidentiality Impact**: High (H)
- **Integrity Impact**: Low (L)
- **Availability Impact**: None (N)

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://me.sap.com/support/securitynotes).

### Other Terms
- **CVE Identifier**: [CVE-2017-16685](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-16685)
- **Related Terms**: XSS, stored XSS, reflected XSS, CSS

### Solution
Input encoding and validation have been added to fix the vulnerability. Please implement the Support Package or Patch referenced by this SAP Note.

**Support Package Patches**
- [BI UDI 7.20 SP009 Patch 000004](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012893&support_package=SP009&patch_level=000004)
- [BI UDI 7.20 SP008 Patch 000002](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012893&support_package=SP008&patch_level=000002)
- [BI UDI 7.50 SP011 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001460&support_package=SP011&patch_level=000000)
- [BI UDI 7.50 SP010 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001460&support_package=SP010&patch_level=000001)
- [BI UDI 7.11 SP017 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006915&support_package=SP017&patch_level=000001)
- [BI UDI 7.40 SP017 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019564&support_package=SP017&patch_level=000000)
- [BI UDI 7.40 SP018 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019564&support_package=SP018&patch_level=000000)
- [BI UDI 7.11 SP018 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006915&support_package=SP018&patch_level=000000)
- [BI UDI 7.30 SP018 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015080&support_package=SP018&patch_level=000000)
- [BI UDI 7.30 SP019 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015080&support_package=SP019&patch_level=000000)
- [BI UDI 7.10 SP022 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200004790&support_package=SP022&patch_level=000001)
- [BI UDI 7.31 SP022 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017512&support_package=SP022&patch_level=000000)
- [BI UDI 7.10 SP023 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200004790&support_package=SP023&patch_level=000000)
- [BI UDI 7.31 SP023 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017512&support_package=SP023&patch_level=000000)

**References**
This document is referenced by:
- [2567025: Collective Note: SAP NetWeaver 7.30 SP18 - EP Core - Application Portal](https://me.sap.com/notes/2567025)
- [2566957: Collective Note: SAP NetWeaver 7.30 SP18 - AS Java Extensions](https://me.sap.com/notes/2566957)
- [2637703: Central Note for NetWeaver 7.31 SP23 Enterprise Portal Core](https://me.sap.com/notes/2637703)
- [2637702: Central note for SAP NetWeaver 7.31 SP23 Composition App. Framework](https://me.sap.com/notes/2637702)
- [2637684: Central Note for CAF for NW 731 SP23](https://me.sap.com/notes/2637684)
- [2597775: Central Note: SAP NetWeaver 7.5 SP11 EP Core (Application Platform)](https://me.sap.com/notes/2597775)
- [2597884: Collective Note: SAP NetWeaver 7.5 SP11 - Composition Platform](https://me.sap.com/notes/2597884)
- [2552663: Collective note : SAP NETWEAVER 7.31 SP22 - Process Orchestration (PI)](https://me.sap.com/notes/2552663)

Credits to [redrays.io](https://redrays.io) for support in providing this information.