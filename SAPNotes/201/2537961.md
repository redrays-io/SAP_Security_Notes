2537961 - Switchable Authorization checks for RFC in MM-PUR-GF

**Description**
  
**UPDATE 8th September 2020**: This note has been re-released with the updated 'Solution' information. We made changes in the 'manual activity' steps which are mentioned to activate the switchable authorization check. This update does not require any customers' action.

S_RFC authorization checks are not sufficient to ensure secure execution of RFC function modules covered by this SAP Note. New switchable authorization checks have been implemented for RFC function modules in MM-PUR-GF.

### Other Terms

- SACF
- RFC
- authorization
- MSR

### Reason and Prerequisites

Remote calls to RFC function modules are by default protected by checks on the authorization object S_RFC. These checks must not be deactivated. See [SAP Note 2216306](https://me.sap.com/notes/2216306) for recommended and deprecated settings of profile parameter auth/rfc_authority_check. Authorization for S_RFC must be limited to the required minimum authorizations for all users to ensure system security. Many RFC function modules can be sufficiently protected using S_RFC authorization checks. These RFC function modules often do not perform additional functional authorization checks. Please see white paper “[Securing Remote Function Calls (RFC)](https://www.sap.com/documents/2015/07/e6441a8d-5b7c-0010-82c7-eda71af511fa.html)” which is also attached to [SAP Note 2008727](https://me.sap.com/notes/2008727) for further information on RFC Security.

It was identified that S_RFC authorization checks are not sufficient to ensure secure execution of RFC function modules covered by this SAP Note. Activate new switchable authorization checks and update corresponding roles if these RFC function modules are included in S_RFC authorizations in your system.

### Solution

New switchable authorization checks have been implemented. The checks are delivered inactive to ensure compatibility with your running processes. The checks can be activated in transaction SACF as described in attached manual correction instruction. See [SAP Note 1922808](https://me.sap.com/notes/1922808) for additional information on the switchable authorization check framework (SACF).

**New authorization scenario**

The following new authorization scenario can be maintained in transaction SACF after implementation of this SAP Note.

**Scenario**

*MM_PUR_BEST* - Check for authorization Purchase order

Switchable authorization checks for external RFCs

**Affected RFC function modules**

- **Function module ME_SWP_SIC_DISP_FOR_MATERIAL**
  - Authorization object: M_BEST_WRK
    - Parameter 1: ACTVT (activity) = 03 (Display)
- **Function module ME_SWP_SIC_SA_GET_DEL_SCHEDULE**
  - Authorization object: M_BEST_WRK
    - Parameter 1: ACTVT (activity) = 03 (Display)
- **Function module ME_SWP_SIC_SR_GET_HEADERS**
  - Authorization object: M_BEST_WRK
    - Parameter 1: ACTVT (activity) = 03 (Display)
- **Function module ME_SWP_SIC_SR_GET_ITEMS**
  - Authorization object: M_BEST_WRK
    - Parameter 1: ACTVT (activity) = 03 (Display)

**Implementation of the switchable authorization check**

The switchable authorization scenario and the switchable authorization checks are provided via support package. They can be technically pre-implemented via below correction instructions. After technical implementation via support package or correction instructions, the checks remain inactive until manual activation.

**Activation of the switchable authorization check**

SAP Update Manager (SUM) informs you after system updates to run transaction SACF_COMPARE to activate switchable authorization checks required by your business processes. Follow below manual activities to individually activate the checks of this SAP Note.

### Manual Activities

1. **Maintenance of Authorization Default Values**
   
   Execute transaction SU22 with 'RFC Function Module' as 'Type of Application' and maintain default values as described below.

   a) **Function module ME_SWP_SIC_DISP_FOR_MATERIAL**
   - Authorization Object: M_BEST_WRK
     - Field Name: ACTVT
       - Value: 03 (Display)
     - Field Name: WERKS
       - Value: -

   b) **Function Module ME_SWP_SIC_SA_GET_DEL_SCHEDULE**
   - Authorization Object: M_BEST_WRK
     - Field Name: ACTVT
       - Value: 03 (Display)
     - Field Name: WERKS
       - Value: -

   c) **Function Module ME_SWP_SIC_SR_GET_HEADERS**
   - Authorization Object: M_BEST_WRK
     - Field Name: ACTVT
       - Value: 03 (Display)
     - Field Name: WERKS
       - Value: -

   d) **Function Module ME_SWP_SIC_SR_GET_ITEMS**
   - Authorization Object: M_BEST_WRK
     - Field Name: ACTVT
       - Value: 03 (Display)
     - Field Name: WERKS
       - Value: -

2. **Using these steps, you implement and activate the switchable authorization checks.**

   **Step 1:**
   Create the authorization scenario definition in systems where they do not exist yet (transported as workbench objects in your landscape):
   - Start transaction SACF in the development system and check if scenario definition MM_PUR_BEST exists. If it exists, go to step 2.
   
   - If the scenario definition does not exist in SACF, download the file [SACF_DATA.txt](https://me.sap.com/notes/2537961/attachments/SACF_DATA.TXT) attached to this note.
   - Start transaction SACF_TRANSFER.
   - Select radio button "Upload", select work area "Scenario Definition", deselect work area "Productive Scenarios", deselect "Test Mode", and execute (F8).
   - Choose the file SACF_DATA.txt and confirm upload.
   - Assign the scenario definition MM_PUR_BEST to development package ME_SWP.

   **Step 2:**
   Individual activation of switchable authorization checks is done by creating productive authorization scenarios from scenario definitions in transaction SACF. SAP note [1922808](https://me.sap.com/notes/1922808) explains in section [4] how to ensure that authorized users have all required authorizations and how to activate the checks. Collective maintenance of authorization scenarios is done after system updates using transaction SACF_COMPARE.

### CVSS

- **CVSS Score:** 6.3
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L)

**Metrics:**
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

**[Full CVSS Details](https://me.sap.com/notes/2537961)**

For more information, visit the [SAP Security Notes](https://me.sap.com/).

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*