2665970 - Missing XML Validation Vulnerability in SAP Plant Connectivity (PCo)

**SAP Security Note 2665970 - Missing XML Validation Vulnerability in Plant Connectivity (PCo)**

**Type**: SAP Security Note  
**Version**: 8  
**Priority**: Correction with medium priority  
**Status**: Released for Customer  
**Released On**: 01.10.2018  
**Component**: SAP Manufacturing > SAP Plant Connectivity  

### Symptom

SAP Plant Connectivity does not sufficiently validate an XML document accepted from an untrusted source. This missing XML validation vulnerability can lead to:

- Arbitrary file retrieval from the server
- Denial-of-service conditions in successful exploits

### CVSS Information

**CVSS v3 Base Score**: 5.3 / 10

| Metric                     | Value             |
|----------------------------|-------------------|
| Attack Vector (AV)         | Network (N)       |
| Attack Complexity (AC)     | High (H)          |
| Privileges Required (PR)   | Low (L)           |
| User Interaction (UI)      | None (N)          |
| Scope (S)                  | Unchanged (U)     |
| Confidentiality Impact (C) | None (N)          |
| Integrity Impact (I)       | None (N)          |
| Availability Impact (A)    | High (H)          |

### Reason and Prerequisites

The vulnerability addresses that OPC UA servers built using the .NET stack by the OPC Foundation are vulnerable to XML External Entity (XXE) attacks. Specifically:

- Only SAP Plant Connectivity 15.0 uses the vulnerable stack, and only for OPC UA clients, not servers.
- An attack requires a compromised server and specific client requests to exploit the vulnerability.

### Solution

The issue is corrected with **patch 10 for SAP Plant Connectivity 15.0 with Support Package 06**.

**Download Links:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001779442018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002665970?language=en-US&token=3FFD4A0ACA65A1B00B507B8D46F9236B)

**Installation Instructions:**

1. **Download** the current installation program for Plant Connectivity 15.0 from the [SAP Service Marketplace](https://me.sap.com/).
2. **Install** it following the [installation guide](http://help.sap.com/pco).
3. **Ensure** all agent instances are stopped and the Management Console is closed before upgrading.
4. **Restart** the system if prompted by the installer.
5. **Perform a Data Backup** prior to installation:
   - Navigate to **Plant Connectivity** â†’ **Data Backup**.

*Key Points Before Installation:*

- Make sure all PCo applications are not running to prevent upgrade issues.
- Restart the system if the installer requests it.
- Execute a data backup to safeguard your data.

For more detailed information, visit the [SAP Security Notes](https://me.sap.com/securitynotes).

---

*Credits: Information supported by [redrays.io](https://redrays.io).*