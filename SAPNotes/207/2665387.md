SAP Security Note 2665387 - CSRF Vulnerability in Cash Management

**SAP Security Note 2665387 - Cross-Site Request Forgery (CSRF) Vulnerability in Cash Management**

**Symptom**
*Manage banks* allows an attacker to trick an authenticated user into sending unintended requests to the web server. This vulnerability is due to insufficient CSRF protection.

Modifying or state-changing function imports with HTTP Method "GET" leads to CSRF vulnerabilities.

Some well-known impacts of CSRF vulnerability are:
- Attacker could take actions on behalf of an authenticated user
- Loss of non-repudiation

**Reason and Prerequisites**
Program error.

**Solution**
Follow the manual steps and apply the correction instructions in this note or upgrade to the corresponding support package.

**Correction Instructions**
```plaintext
------------------------------------------------------------------------
|Manual Activity                                                         |
------------------------------------------------------------------------
|VALID FOR                                                               |
|Software Component  S4CORE                                              |
| Release 102    Until SAPK-10202INS4CORE                               |
------------------------------------------------------------------------

Because of some non-supported objects, you should do the following manual steps:
1. Open transaction code: segw
2. Click "Open Project" button and input "FCLM_BM", then click "display <-> change" button to "edit mode"
3. Find hierarchy node "FCLM_BM->Data Model->Function Imports->LOCK_BNKA"
4. Double click "LOCK_BNKA" node
5. In the detail page, find field "HTTP Method Type", change the value in dropdown list from "GET" to "POST"
6. Click "Generate Runtime Objects" button and save to your change request
7. Click "display <-> change" button to "display mode" and close
```

**CVSS**
- **Score:** 5.5
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** Low (L)

**Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000036152021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002665387?language=en-US&token=D21D69C8ED4C7BC7B0117B36CBDBE5D5)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for support to provided information.*