2661740 - [CVE-2018-2477] XML External Entity (XXE) Vulnerability in SAP NetWeaver Knowledge Management XMLForms

---

**Symptom:**
SAP NetWeaver Knowledge Management XMLForms does not sufficiently validate XML documents from untrusted sources. This vulnerability allows attackers to retrieve arbitrary files from the server or cause denial-of-service (DoS) conditions.

**CVSS Information:**
- **Score:** 6.5/10
- **Vector:** AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

**Impact:**
An attacker exploiting this vulnerability can:
- Retrieve arbitrary files from the server.
- Cause denial-of-service conditions in successful exploits.

**Solution:**
1. **Update XML Parser Configuration:**
   - Configure the XML parser to disallow external entities in incoming XML documents.
   
2. **Apply Support Packages and Patches:**
   - Implement the support packages and patches referenced in [SAP Note 2661740](https://me.sap.com/notes/0002661740).
   
3. **For Custom XML Forms Projects:**
   - If your projects depend on external entities, update them to include your entities in a whitelist.
   - Follow the steps below if you encounter issues:
     1. Open the **Config Tool**.
     2. Select **Configuration Editor** from the drop-down menu and locate the **XMLHardener** node.
     3. Create a sub-node named "wcm.service.xmlforms".
     4. Add external configuration for the XMLHardener with a whitelist of your entities, either manually or using the XML Hardener UI Tool as detailed in [SAP Note 2261259](https://me.sap.com/notes/2261259).

**References:**
- [CVE-2018-2477](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2477)

**Support Package Patches:**
Several support package patches are available for different versions of KMC CONTENT MANAGEMENT. Details and download links can be found in [SAP Note 2661740](https://me.sap.com/notes/0002661740).

**Components Affected:**
- **Component:** EP-KM-TLS-XFB (Enterprise Portal > Enterprise Portal - Knowledge Management and Collaboration > KM Tools > XF Builder)

**Released On:** November 13, 2018

For more information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*