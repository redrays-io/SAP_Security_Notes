2132584 - Buffer overflow in SAP Afaria 7 XcListener

**Header Data**

| Key               | Value                                 |
|-------------------|---------------------------------------|
| SAP Note/KBA      | 2132584                               |
| Type              | SAP Security Note                     |
| Version           | 2                                     |
| Recency           | New                                   |
| Language          | English                               |
| Master Language   | English                               |
| Category          | Program error                         |
| Priority          | Correction with high priority         |
| Status            | Released for Customer                 |
| Released On       | 10.03.2015                            |
| Component         | Business Mobile > Afaria (MOB-AFA)    |

**Title**

2132584 - Buffer overflow in SAP Afaria 7 XcListener

**Description**

### Symptom

A vulnerability has been discovered in certain landscape configurations of SAP Afaria that utilize XcListener for initiating client-to-server communications.

**CVSS Information**
- **CVSS Base Score:** 4.3 / 10
- **CVSS Base Vector:**
  - **Attack Vector (AV):** Network (N)
  - **Access Complexity (AC):** Medium (M)
  - **Authentication (Au):** None (N)
  - **Impact to Confidentiality (C):** None (N)
  - **Impact to Integrity (I):** None (N)
  - **Impact to Availability (A):** Partial (P)

_SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/)._

### Other Terms

SAP Afaria Server, Windows Client (desktop and laptop), Windows Mobile, WindowsCE, Buffer Overrun

### Reason and Prerequisites

The Windows Mobile and Windows client under certain landscape configurations can be susceptible to a buffer overflow vulnerability. To be vulnerable, XcListener must be an active process. The Windows client enrollment policy allows administrators to enable or disable XcListener with the advanced option “Outbound listener and firewall”.

XcListener listens on port 3005. If port 3005 is not exposed externally, the vulnerability is only accessible locally on the machine.

### Solution

A vulnerability has been discovered in certain landscape configurations of SAP Afaria that utilize XcListener for initiating client-to-server communications. SAP has released security patches for the vulnerable clients, including Windows Mobile, Windows CE, and Windows. Windows Phone is not affected. SAP strongly recommends customers to patch their server.

**Patch Instructions:**

1. **Download hotfix:**
   - [SAP Afaria 7 SP5 Hotfix 8](https://notesdownloads.sap.com/note/0040000018306812017)
   - [SAP Afaria 7 SP4 Hotfix 16](https://notesdownloads.sap.com/note/0040000018306812017)

2. **Apply server hotfix:**
   
   The server’s version of XcListener will be patched when the hotfix is applied. The clients will be updated through the Afaria ESD process as they connect to the server.

For more details, refer to [SAP Note 2132584](https://me.sap.com/notes/0002132584).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*