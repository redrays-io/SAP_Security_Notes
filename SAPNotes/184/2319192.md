2319192 - Whitelist based Clickjacking Framing Protection in BSP

```markdown
## Symptom

BSP framework does not protect its applications against Clickjacking attack.

## Other Terms

UI redressing attack, Clickjacking, Framing Protection, Framing, IFrame, UI Redressing, BSP, Clickjacking Whitelist, X-FRAME-OPTIONS, Business Server Pages

## Reason and Prerequisites

Clickjacking is a UI-redressing attack where an attacker tricks a user into clicking on something different than the user is aware of. This attack exploits standard functionalities in HTML and does not rely on weaknesses in the application code.

Further details can be found at [OWASP Clickjacking](https://www.owasp.org/index.php/Clickjacking).

## Solution

Standard protection measures against clickjacking (X-FRAME-OPTIONS header) are not suitable for common Netweaver integration scenarios. Therefore, SAP provides a whitelist-based framework for Netweaver technologies.

This framework and its implementation are described in [SAP Note 2319727](https://me.sap.com/notes/2319727).

This note provides the BSP part.

**IMPORTANT:**

The Clickjacking protection works only if the HTML page contains the `<head></head>` tags. Ensure these tags are present on the page; otherwise, Clickjacking protection cannot be applied.

## Correction Instructions

1. **Ensure Prerequisite Note is Installed:**
   - Make sure that [SAP Note 2142551](https://me.sap.com/notes/2142551) is already installed in your system.

2. **Activate Clickjacking Protection:**
   - The Clickjacking protection is deactivated by default. To activate it, create a new entry in the table `BSPGLOBALSETTING`.
   - If the table `BSPGLOBALSETTING` is not available and you receive an error stating "Table BSPGLOBALSETTING is not active in the Dictionary," manually create the table as described in [SAP Note 2119535](https://me.sap.com/notes/2119535), and apply the correction instructions attached to this SAP Note.
   - After ensuring the table exists, proceed with the following steps:
     - **SORT_KEY:** Enter a number (recommended between 0000 and 9999).
     - **NAME:** Enter `CLICKJACKING`.
     - **VALUE:** Enter `ON`.
     - **APPLNAME:** Leave empty to apply protection server-wide or specify an application name to apply protection to a specific application.
   - Save the entry.

## Prerequisites

This SAP Note applies to the following SAP_BASIS versions:

- 700
- 701
- 702
- 730
- 731
- 740

## References

- [SAP Note 2319727 - Clickjacking protection framework in SAP Netweaver AS ABAP and AS Java](https://me.sap.com/notes/2319727)
- [SAP Note 2142551 - Whitelist service for Clickjacking Framing Protection in AS ABAP](https://me.sap.com/notes/2142551)

## Side Effects

This document does not solve any side effects and does not cause any side effects.

---

Credits to [https://redrays.io](https://redrays.io) for support in providing this information.
```