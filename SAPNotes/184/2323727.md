2323727 - URL Redirection vulnerability in URL and Generic iView

**Description**

### Symptom
The **URL and Generic iViews** allow an attacker to redirect users to a malicious site due to insufficient URL validation. This vulnerability can lead to:

- **Phishing attacks** to steal victims' credentials.
- **Redirection to untrusted webpages** containing malware or similar malicious exploits.

### Other Terms
- Open redirect
- Cross-site redirect
- Cross-domain redirect

### Reason and Prerequisites
- **Program Error**

**Solution**

To address this vulnerability, apply the relevant Support Package (SP) patch level. Additionally, perform the following manual activities in each system where the Note is implemented:

1. **Enable Whitelist for URL Redirect:**
   - Open the service `AllowedResourceUrlsService` located inside the `com.sap.portal.ivs.httpservice` application.
   - Configure the property **Enable "Whitelist For URL Redirect"** to `true`.
   - Configure the property **"Allowed Redirect URL Prefixes"** by adding the allowed URL prefixes separated by commas. Each URL must include the protocol, domain, and port (wildcards are not allowed). To support URLs without a port, configure the default port (port 80).
   - Save and restart the service.

2. **Configure Portal Services:**
   - For **EP 7.0x**:
     [Configure Portal Services for EP 7.0x](https://help.sap.com/saphelp_nw70ehp1/helpdata/en/dd/92fc3ee241ba28e10000000a114084/content.htm?frameset=/en/38/9da3bd8bd849dbb1ee8d489fd0f4cd/frameset.htm&current_toc=/en/a9/76bd3b57743b09e10000000a11402f/plain.htm&node_id=599)
   - For **EP >= 7.1x**:
     [Configure Portal Services for EP >= 7.1x](https://help.sap.com/saphelp_nw73/helpdata/en/49/2a94e59c1a1903e10000000a42189c/frameset.htm)

**Affected Software Components**

- **EP-RUNTIME**
  - Versions: 7.00 to 7.50
- **EP-ADMINISTRATION**
  - Versions: 7.10 to 7.50
- **EP-PSERV**
  - Versions: 7.00 to 7.02

**Support Package Patches**

Various support package patches are available for different versions. You can download the appropriate patch [here](https://notesdownloads.sap.com/note/0040000018339692017).

**References**

- This document is causing side effects with [SAP Note 2609421: HTTPRenderLayer_Redirect.jsp fails to compile](https://me.sap.com/notes/0002609421).

**Related Notes**

- [2332266: SAP NetWeaver 7.30 SP17 - Composition Platform](https://me.sap.com/notes/2332266)
- [2332236: SAP NetWeaver 7.30 SP17 - EP Core - Application Portal](https://me.sap.com/notes/2332236)
- [2463570: SAP NetWeaver 7.31 SP20 - Composition Platform](https://me.sap.com/notes/2463570)

**Download PDF Version**
[Download PDF](https://me.sap.com/sap/support/sfm/notes/print/0002323727?language=en-US&token=511C9EA8AC65A31354E2A9C109AF3C43)

**Rate this Document**

[Rate this document](https://me.sap.com/notes/0002323727/E/diff)

---

*Credits to [Redrays](https://redrays.io) for support providing this information.*