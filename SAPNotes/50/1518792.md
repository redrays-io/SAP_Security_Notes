1518792 - Potential disclosure of persisted data in ESFUtil.

**SAP Security Note 1518792**  
**Type:** SAP Security Note  
**Version:** 5  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 14.06.2011  
**Component:** Basis Components > Enterprise Service Infrastructure > Enterprise Service Framework Layer > Supportability Tools (TestShell, ESFUtil) (BC-ESI-ESF-TS)

### Symptom
A malicious user can exploit the ESFUtil API and use specially crafted inputs to modify database commands, resulting in the retrieval of additional information persisted by the system.

### Other Terms
SQL injection, database, ESFUtil

### Reason and Prerequisites
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve data from the database.

### Solution
The security threat is present in NetWeaver versions 7.11 and 7.2L for ByD. Applying the fix/patch as part of this note should resolve the problem.

### Affected Software Components
- **SAP_BASIS**: Versions 711 and 72L

### Support Package
- **SAPKB71107**  
  [Download Support Package](https://me.sap.com/supportpackage/SAPKB71107)

### Correction Instructions
- [Correction Instruction 0001518792/41](https://me.sap.com/corrins/0001518792/41)

### References
- **This document refers to:**  
  [888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

- **This document is referenced by:**  
  [888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

### Available Languages
- [Japanese](https://me.sap.com/notes/0001518792/J)
- [Deutsch](https://me.sap.com/notes/0001518792/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0001518792/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001518792/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001518792/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001518792/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001518792/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001518792/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001518792/3)

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009005312017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001518792?language=en-US&token=B5ECB7808BB076DBDBEFF1E6BB9BD9F7)
- [Share by Email](https://me.sap.com/notes/0001518792/email)
- [Open in New Window](https://me.sap.com/notes/0001518792)

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*