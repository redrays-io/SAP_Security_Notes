1616058 - XSRF possible in SPML Services in AS Java

**SAP Security Note 1616058 – XSRF possible in SPML Services in AS Java**

**Overview**
- **Type:** SAP Security Note
- **Category:** Workaround of missing functionality
- **Priority:** HotNews
- **Status:** Released for Customer
- **Released On:** 16.05.2012
- **Component:** Basis Components > NetWeaver Application Server Java > Security, User Management > User Management Engine

**Description**
A malicious user can execute web application functions through SPML services in SAP NetWeaver AS Java on behalf of a legitimate user, without their consent.

**CVSS Information**
- **Base Score:** 6.8
- **Vector:** AV:N/AC:M/AU:N/C:P/I:P/A:P

**Details**
SPML services execute certain functions by referencing specific URLs. A malicious user can trick an authenticated user into making requests with specific URLs and parameters, potentially executing functions with the user's privileges. This can be done via cross-site scripting attacks or by presenting a crafted link to the victim.

**Solution**
- **Update AS Java** to a support package or release where the issue is fixed. 
- **Apply patches** available for SAP products using the SPML interface. For more details, see the [Related Notes](https://me.sap.com/notes/1631354).

**Workarounds**
If using third-party SPML clients that cannot be updated, you may disable the protection by setting the UME property `ume.spml.http_header_check_active` to `false`. This requires a cluster restart and additional protection mechanisms like URL filtering via ICM, load balancers, or firewalls.

**References**
- [Security Note 1631354 - Update 1 to Security Note 1616058](https://me.sap.com/notes/1631354)
- [Security Note 1621289 - SPML Connection Between SAP NW IdM and NW AS Java Fails](https://me.sap.com/notes/1621289)
- [Security Note 1616259 - Briefing at Black Hat conference on August 4th, 2011](https://me.sap.com/notes/1616259)
- [Security Note 1451753 - Filtering of administration requests for AS Java](https://me.sap.com/notes/1451753)

**Support Package Patches**
Patches are available for various software components and versions. For a complete list of support package patches, please visit the [SAP Support Portal](https://me.sap.com/).

**Attributes**
- **Externally Reported:** Yes

**Translations**
Available in multiple languages:
- [Deutsch](https://me.sap.com/notes/0001616058/D)
- [日本語](https://me.sap.com/notes/0001616058/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001616058/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001616058/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001616058/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001616058/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001616058/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001616058/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001616058/3)

**Credits**
Supported by [Redrays.io](https://redrays.io) for providing the information.