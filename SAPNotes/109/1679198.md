1679198 - Potential code injection in Extraction & Reporting Services

**Description**

### Symptom

Generic Ad Hoc Reporting customizing allows generating reports containing code that permits the execution of arbitrary program code of the user's choice. An attacker can control the behavior of the system or potentially escalate privileges by executing malicious code without having legitimate credentials.

### Other Terms

- Injection
- Run
- Credentials
- Generic Ad Hoc Reporting
- Report to Report Interface (RRI)
- View /BA1/FP_VRRI (Configure Receiver Reports for Drill-Through)

### Reason and Prerequisites

The program code allows defining and executing user-defined code that changes the system's behavior. A valid and authenticated user is not required.

Depending on the code, a user can:

- Inject and run their own code
- Obtain additional information that should not be displayed
- Modify or delete data
- Modify the output of the system
- Create new users with higher privileges
- Perform a denial-of-service attack

### Solution

Implement the attached correction or the corresponding support package.

To correct the existing potential code injection, follow these steps to regenerate existing RRI customizing entries:

1. **Access the IMG Activity:**
   - Navigate to the IMG activity "Configure Receiver Reports for Drill-Through" (view `/BA1/FP_VRRI`).

2. **Generate Receiver Reports:**
   - In this activity, generate receiver reports for BI drill-through by selecting one of the following report categories:
     - SDL ad hoc reporting
     - Generic ad hoc reporting
     - Drill-through using CVMP

3. **Update Customizing Entries:**
   - For each existing entry, double-click on it in change mode.
   - Change the title description and save it. If necessary, undo your title modification and save again. This action changes the entry status to "not generated."

4. **Regenerate Reports:**
   - Use the "regenerate receiver report" button to regenerate the receiver report using the new note correction.

As a result, the code injection risk in this IMG activity is eliminated.

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009973732017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001679198?language=en-US&token=2FC7C1843AD56A5B89B038CAAC84B12A)

**Support Packages**

- **FSAPPL 200:** [SAPKISC323](https://me.sap.com/supportpackage/SAPKISC323)
- **FSAPPL 300:** [SAPK-30016INFSAPPL](https://me.sap.com/supportpackage/SAPK-30016INFSAPPL)
- **FSAPPL 400:** [SAPK-40007INFSAPPL](https://me.sap.com/supportpackage/SAPK-40007INFSAPPL)
- **BANK-ALYZE 42:** [SAPKIBAM18](https://me.sap.com/supportpackage/SAPKIBAM18)
- **BANK-ALYZE 50:** [SAPKIBAL31](https://me.sap.com/supportpackage/SAPKIBAL31)

**Correction Instructions**

- **FSAPPL:** 3 Instructions [View Instructions](https://me.sap.com/corrins/0001679198/1534)
- **BANK-ALYZE:** 2 Instructions [View Instructions](https://me.sap.com/corrins/0001679198/189)

**Preconditions**

- **BANK-ALYZE 42**
- **BANK-ALYZE 50**
- **FSAPPL 200**
- **FSAPPL 300**
- **FSAPPL 400**

*Credits to [RedRays.io](https://redrays.io) for supporting information.*