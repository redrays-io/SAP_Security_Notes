1681997 - Missing authorization check in EP-KM-COL component

## Symptom

An authenticated user can use the functions of the EP-KM-COL component. The access to this component should be restricted. This case results in an escalation of privileges.

## Other Terms

Authorization, authorization check, EP-KM-COL

## Reason and Prerequisites

The EP-KM-COL component does not contain the authorization checks for the authorization of authenticated users to access some of its functions. This may result in undesired system behavior.

## Solution

For SAP NetWeaver Portal 7.3 and 7.3 including enhancement package 1, a CTC template could be executed instead of the procedure described below. In case of CTC template execution for SAP NetWeaver 7.3 and 7.3 including enhancement package 1, refer to [SAP note 599425](https://me.sap.com/notes/599425).

Use the following procedure to change the permissions of the "attachment" repository after deploying the patches for KMCBC, KMCCM, and GROUPWARE:

1. **Configure the "attachment" repository to be listed in the root directory.**
    a. Log on to the portal as an administrator user.
    b. Navigate to **System Administration → System Configuration → Knowledge Management → Content Management → Repository Managers → CM Repository**
    c. Select the "attachment" repository
    d. Choose "Edit".
    e. Choose "Show Advanced Options".
    f. Deselect the "Hide in Root Folder" property.
    g. Save your entries.

2. **Configure the permissions of the "attachment" repository.**

   When the patches are applied, the initial attachment repository permissions are set to "Everyone" (Full Control). To restrict the permissions of the repository, you should use the following procedure:
   
    a. Navigate to **Content Administration → KM Content**
    
    b. From the context menu of the "attachment" repository, choose **Details → Settings → Permissions**
    
    c. In the "Permissions" tab, delete the permissions for the "Everyone" group and then add the following permissions:
    - **Name:** "content_admin_role"; **Permissions:** "Full Control"
    
    d. Save your entries.

### Main Disclaimer for the New Implementation:

When the "Everyone" group is deleted from the permissions of the "attachment" repository, the users who have been sent or received emails before the patch installation should no longer be able to access the attachments for their emails stored in this repository.

- **A.)** For more information about the affected releases, see the "SP Patch Level" tab page of this [SAP note](https://me.sap.com/notes/1681997).

  For more information about the SP Stack schedule and updates, see [Support Package Stacks maintenance schedule](http://service.sap.com/swdc).

- **B.)** Possible workaround before the release of the mentioned deliveries: There is no workaround possible.

## Additional Information

- **Download for SNOTE:** [Download Note 1681997](https://notesdownloads.sap.com/note/0040000017385842017)
- **PDF Version:** [Print PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001681997?language=en-US&token=C1EEAD1D88527CC0FE0137FD06C30A70)
- **Share by Email:** Use the [Share by Email](https://me.sap.com/notes/0001681997/share) feature.
- **Open in New Window:** [Open in New Window](https://me.sap.com/notes/0001681997)

### Affected Software Components

- **KMC-BC:** 7.00 - 7.02+, 7.30+, 7.31+
- **KMC-CM:** 7.00 - 7.02+, 7.30+, 7.31+
- **KMC-COLL:** 7.00 - 7.02
- **EP-CM:** 6.0_640+
- **GROUPWARE:** 7.30+, 7.31+

### References

**This document refers to:**

- [SAP Note 1740667 - KMC in EHP1 for SAP NETWEAVER 7.0 SP12](https://me.sap.com/notes/1740667)

**This document is referenced by:**

- [SAP Note 1740667 - KMC in EHP1 for SAP NETWEAVER 7.0 SP12](https://me.sap.com/notes/1740667)
- [SAP Note 1686202 - KMC in EHP2 for SAP NetWeaver 7.02 SPS11](https://me.sap.com/notes/1686202)

### Side Effects

This document is causing side effects:

- [SAP Note 1752250 - PermissionExistsException when using attachments](https://me.sap.com/notes/1752250)
  
---

*Credits to [RedRays.io](https://redrays.io) for support and information provided.*