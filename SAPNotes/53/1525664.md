1525664 - Unauthorized usage of appl. functionality in Plant Manager

**Description**

### Symptom
A malicious user can trigger functionality in Plant Manager 1.0 without authentication and authorization.

**Note the following:**
- Plant Manager 1.0 is marked as obsolete as of Release ERP 2005 and has been replaced by Plant Manager 2.0.
- Plant Manager 2.0 uses different technology and is therefore not affected.

### Other Terms
Cross Site Request Forgery, XSRF, Business Server Pages, BSP

### Reason and Prerequisites
The BSP application executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the user's rights. If present, the attacker may use a Cross Site Scripting (XSS) attack to trigger the exploit or use an approach in which a link is presented for the victim to click.

### Solution
1. **Implement [Note 1520324](https://me.sap.com/notes/1520324).**
2. **Apply the correction instructions contained in [this note](https://me.sap.com/corrins/0001525664/1).** This will create the report `BSP_XSRF_PARAM_PLANT_MANAGER1` in your system.
3. **Execute the report and specify a transport request.** The report creates entries in the table `BSPTEMPXSRFSTORE`; these entries must be transported.

**Downloads:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009047482017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001525664?language=en-US&token=FB04A9ABF1627334E0101C925172173B)

**References:**
- [ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)

**Affected Software Components:**
- SAP_APPL versions 500, 600, 602, 603, 604, 605

**Support Packages:**
- [SAPKH50025](https://me.sap.com/supportpackage/SAPKH50025)
- [SAPKH50024](https://me.sap.com/supportpackage/SAPKH50024)
- [SAPKH60019](https://me.sap.com/supportpackage/SAPKH60019)
- [SAPKH60209](https://me.sap.com/supportpackage/SAPKH60209)
- [SAPKH60308](https://me.sap.com/supportpackage/SAPKH60308)
- [SAPKH60409](https://me.sap.com/supportpackage/SAPKH60409)
- [SAPKH60504](https://me.sap.com/supportpackage/SAPKH60504)

For more details, visit the [official SAP Security Note 1525664](https://me.sap.com/notes/0001525664).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*