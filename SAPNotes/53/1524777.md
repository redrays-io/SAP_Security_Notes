SAP Security Note 1524777 - Unauthorized modification of content in SAP Retail Store

**SAP Note:** 1524777 - Unauthorized modification of content in SAP Retail Store  
**Type:** SAP Security Note  
**Version:** 2  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 08.11.2011  
**Component:** LO-SRS (Logistics - General > SAP Retail Store)  
**Category:** Program error  

### Symptom

This security note addresses two critical vulnerabilities in the SAP Retail Store:

1. **Reflected Cross-Site Scripting (XSS):**  
   Malicious users can modify displayed application content without authorization and potentially steal authentication information from legitimate users.

2. **Stored Cross-Site Scripting (XSS):**  
   Allows permanent modification of displayed content, enabling malicious users to embed content that is rendered automatically. This can lead to the theft of authentication information and unauthorized access with the same privileges as the targeted user.

### Solution

The correction can be applied via a support package or through manual steps. Follow the procedures below to mitigate the vulnerabilities:

1. **Apply Support Packages:**
   - Refer to [SAP Note 1488500](https://me.sap.com/notes/1488500) for prerequisites.
   - If using Theme 99, also apply [SAP Note 1510419](https://me.sap.com/notes/1510419).

2. **Manual Correction Steps:**
   - **Update ITS Services Parameters:**
     - Use transaction SE80 to add the parameter `~AUTO_HTML_ESCAPING` with the value `X` to all relevant ITS services.
   - **Remove HTML Tags from Language Parameters:**
     - Eliminate HTML tags like `<sup>`, `<font>`, etc., from all language resource files across all themes and services.
   - **Update HTML Templates:**
     - Replace existing HTML templates with the updated versions provided in the attachments.

### Attachments

- [Release110-Theme90.zip](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000538112010&iv_version=0002&iv_guid=45627975D1856445A4DE36BD606C1E4D)
- [Release110-Theme99.zip](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000538112010&iv_version=0002&iv_guid=7E5BB03A5302644699205A68B9E9C48D)
- [Release200-Theme90.zip](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000538112010&iv_version=0002&iv_guid=B91AABAF0599D247981110FB0531BEBB)
- [Release200-Theme99.zip](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000538112010&iv_version=0002&iv_guid=D26DA659E1ABE84B98575289A4BEC079)
- [Release46C-Theme90.zip](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000538112010&iv_version=0002&iv_guid=DBD86D82A691CE458C88BFC17F97337D)

### References

- [SAP Note 1510419](https://me.sap.com/notes/1510419) - IAC Template Library fixed for automatic HTML escaping
- [SAP Note 1488500](https://me.sap.com/notes/1488500) - ITS: Automatically escape context fields in output
- [SAP Note 1437902](https://me.sap.com/notes/1437902) - Unauthorized usage and modification of SAP Retail Store

### Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009041642017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001524777?language=en-US&token=EC382CF610E880C0E39BFDEC6E5139DE)

---

*Credits to [Redrays.io](https://redrays.io) for support and provided information.*