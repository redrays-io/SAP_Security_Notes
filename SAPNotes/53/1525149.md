SAP Note 1525149 - Unauthorized use of application functions in IS-AFS

---

**Symptom**

A malicious user can execute functions in IS-AFS without authentication and authorization.

**Other Terms**

Cross-site request forgery, XSRF, IS-AFS

**Reason and Prerequisites**

IS-AFS executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The malicious user may use a cross-site scripting attack to achieve this, or they may present a link to the victim.

**Solution**

1. For additional information and instructions, see [Note 1481392](https://me.sap.com/support/component#sapnote=1481392). The corrections from Note 1481392 are a prerequisite for implementing this note.
2. Implement the correction instructions provided in this note. Create the report `/AFS/ITS_XSRF_PARAM_PO_CONF` as a local object in your system.
3. Execute the report `/AFS/ITS_XSRF_PARAM_PO_CONF` and when prompted, specify a relevant transport request number. The report will add service parameters for the adapted ITS services (maintained via the GUI configuration pushbutton for a service within transaction SICF).

**Support Packages**

| Software Component Version | Support Package            | URL                                                                                       |
|----------------------------|----------------------------|-------------------------------------------------------------------------------------------|
| P3A V500                   | SAPKIAF513                 | [View Support Package](https://me.sap.com/supportpackage/SAPKIAF513)                     |
| P3A V600                   | SAPK-60011INAFS            | [View Support Package](https://me.sap.com/supportpackage/SAPK-60011INAFS)                |
| P3A V603                   | SAPK-60307INP3A            | [View Support Package](https://me.sap.com/supportpackage/SAPK-60307INP3A)                |
| P3A V604                   | SAPK-60404INP3A            | [View Support Package](https://me.sap.com/supportpackage/SAPK-60404INP3A)                |
| P3A V605                   | SAPK-60501INP3A            | [View Support Package](https://me.sap.com/supportpackage/SAPK-60501INP3A)                |

**Correction Instructions**

| Software Component | Number of Correction Instructions | URL                                                                                       |
|--------------------|-----------------------------------|-------------------------------------------------------------------------------------------|
| P3A                | 5                                 | [View Correction Instructions](https://me.sap.com/corrins/0001525149/4)                    |

**Additional Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009044232017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001525149?language=en-US&token=EE7E24D88322D7CFEA84E3F4ECAF51AF)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001525149)
- [Share by Email](https://me.sap.com/sharebyemail?note=1525149)
- [Open in New Window](https://me.sap.com/notes/0001525149)

**Credits:** [redrays.io](https://redrays.io) for support in providing this information.