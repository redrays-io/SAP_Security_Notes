1953939 - Directory Traversal Vulnerability in /CEECV/ROFI_D205_MERGE_XML

**Title:**  
SAP Security Note 1953939 - Directory Traversal Vulnerability in /CEECV/ROFI_D205_MERGE_XML

**Symptom:**  
The endpoint `/CEECV/ROFI_D205_MERGE_XML` contains a vulnerability that allows an attacker to perform directory traversal. This can enable unauthorized writing of arbitrary files to the remote server, potentially leading to data corruption or alteration of system behavior.

**Reason and Prerequisites:**  
The vulnerability arises because `/CEECV/ROFI_D205_MERGE_XML` does not properly validate the path to which a user-submitted file is written. Consequently, an attacker can overwrite data on the remote system.

**Solution:**  
SAP recommends applying the latest Support Package to address this issue. If an immediate solution is required, follow these steps using the Note Assistant:

1. **Apply Manual Corrections:**
   - Download and apply the manual corrections provided in the attachment: [Guide - Logical File Path, Name (ROFI).docx](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001164192013&iv_version=0003&iv_guid=6D30FAA37522C746B79669EB04DDF658).

2. **Apply Code Corrections:**
   - Use transaction `SNOTE` to apply the code correction instructions from the note.
   - Ensure that you have applied the prerequisites from [Note 1497003](https://me.sap.com/notes/1497003) before implementing this note.

3. **Set Up Logical File Names:**
   - A new logical file name `/CEECV/ROFI` has been created for validating physical file names.
   - To enhance security and reduce the number of logical file names, create a directory structure that reflects user and program names. This helps in securely separating data created by different users and programs.

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011534632017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001953939?language=en-US&token=7E561BBB6F4C7434902BE5857F5990AE)

**Support Packages:**
- [SAPK-11038INCCEE](https://me.sap.com/supportpackage/SAPK-11038INCCEE) for C-CEE 110_600
- [SAPK-60224INCCEE](https://me.sap.com/supportpackage/SAPK-60224INCCEE) for C-CEE 110_602
- [SAPK-60324INCCEE](https://me.sap.com/supportpackage/SAPK-60324INCCEE) for C-CEE 110_603
- [SAPK-60422INCCEE](https://me.sap.com/supportpackage/SAPK-60422INCCEE) for C-CEE 110_604

**Manual Activities:**  
Refer to the attached document for detailed manual correction instructions.

**Prerequisites:**  
Ensure that [Note 1820586](https://me.sap.com/notes/1820586) titled "RO: D205 xml merge" is implemented before applying this security note.

For more detailed information and instructions, visit the [SAP Service Marketplace](https://me.sap.com/note-assistant).

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*