1953974 - Directory traversal in /CEECV/RO_ANN_FS_EXPORT

**SAP Security Note 1953974: Directory traversal in /CEECV/RO_ANN_FS_EXPORT**

### Symptom
`/CEECV/RO_ANN_FS_EXPORT` contains a vulnerability through which an attacker can potentially write arbitrary files to the remote server, possibly corrupting data or altering system behavior.

### Other Terms
- **Directory traversal**
- **Endpoint:** `/CEECV/RO_ANN_FS_EXPORT`

### Reason and Prerequisites
`/CEECV/RO_ANN_FS_EXPORT` fails to correctly validate the path to which a user-submitted file is written. As a result, an attacker can potentially overwrite data in the remote system.

### Solution
SAP recommends installing a solution by applying a **Support Package**. If an earlier installation is required, use the **Note Assistant** and follow the instructions below:

1. **Manual Corrections:**
   - Apply manual corrections as provided in the attachment [Guide - Logical File Path, Name (ROFI).docx](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001164652013&iv_version=0001&iv_guid=D788170BF790E645903314E587DE939D).

2. **Code Correction:**
   - Use transaction `SNOTE` to apply code correction instructions from the note.
   - Ensure that you have applied [Note 1497003](https://me.sap.com/notes/1497003), as it is a prerequisite for implementing this note.

3. **Logical File Name Setup:**
   - A logical file name `/CEECV/ROFI` has been created to enable the validation of physical file names.
   - **Recommendations:**
     - Create a directory structure that reflects the user name and/or program name to securely separate data created by different users and programs.
     - Use this information when setting up the physical path and file names for the logical file paths and file names.

For more information about the Note Assistant, visit [SAP Service Marketplace](https://me.sap.com/service.sap.com/note-assistant).

### Attachments
- [Guide - Logical File Path, Name (ROFI).docx](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001164652013&iv_version=0001&iv_guid=D788170BF790E645903314E587DE939D) (51 KB)

### Support Packages
- **C-CEE 110_600:** [SAPK-11038INCCEE](https://me.sap.com/supportpackage/SAPK-11038INCCEE)
- **C-CEE 110_602:** [SAPK-60224INCCEE](https://me.sap.com/supportpackage/SAPK-60224INCCEE)
- **C-CEE 110_603:** [SAPK-60324INCCEE](https://me.sap.com/supportpackage/SAPK-60324INCCEE)
- **C-CEE 110_604:** [SAPK-60422INCCEE](https://me.sap.com/supportpackage/SAPK-60422INCCEE)

### Correction Instructions
- **Software Component:** C-CEE
- **Number of Correction Instructions:** 1
- **URL:** [Correction Instruction 369](https://me.sap.com/corrins/0001953974/369)

### Prerequisites
- **Software Component:** C-CEE
- **Valid From:** 011_46C
- **Valid To:** 110_604
- **SAP Note/KBA:** [1709231](https://me.sap.com/notes/1709231)
- **Title:** RO: XML for Annual financial statement
- **Component:** XX-CSC-RO-FI

For detailed information, visit the [SAP Security Notes](https://me.sap.com/notes/1953974).

*Credits to [Redrays](https://redrays.io) for supporting the provision of this information.*