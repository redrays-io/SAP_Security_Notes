1953973 - Directory traversal in /CEECV/ROFI_VIES_394_XML

**Description**

**Symptom**

`/CEECV/ROFI_VIES_394_XML` contains a vulnerability that allows an attacker to potentially write arbitrary files to the remote server. This could lead to data corruption or alteration of system behavior.

**Reason and Prerequisites**

The path validation for user-submitted files in `/CEECV/ROFI_VIES_394_XML` is insufficient. As a result, an attacker can overwrite data on the remote system.

**Solution**

SAP recommends installing solutions by applying a **Support Package**. If an earlier installation is necessary, follow these steps using the **Note Assistant**:

1. **Apply Manual Corrections:**
   - Refer to the attachment "[Guide - Logical File Path, Name (ROFI).docx](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001164632013&iv_version=0001&iv_guid=DC941F4AEBB3E34D914171ACD9269058)".

2. **Apply Code Correction Instructions:**
   - Use transaction `SNOTE` to follow the instructions provided in this note.

3. **Install Prerequisite Note:**
   - Apply [Note 1497003](https://me.sap.com/notes/1497003). This note must be implemented before applying the current note.

**Support Packages**

Ensure you have the appropriate Support Package installed for your software component version:

- **C-CEE 110_600:** [SAPK-11038INCCEE](https://me.sap.com/supportpackage/SAPK-11038INCCEE)
- **C-CEE 110_602:** [SAPK-60224INCCEE](https://me.sap.com/supportpackage/SAPK-60224INCCEE)
- **C-CEE 110_603:** [SAPK-60324INCCEE](https://me.sap.com/supportpackage/SAPK-60324INCCEE)
- **C-CEE 110_604:** [SAPK-60422INCCEE](https://me.sap.com/supportpackage/SAPK-60422INCCEE)

**Pre-requisites**

Before applying this note, ensure the following notes are installed:

- [1689977](https://me.sap.com/notes/1689977) - 394 Declaration 2012, corrections I
- [1687951](https://me.sap.com/notes/1687951) - 394 Declaration 2012, XML output formats

**Attachments**

- [Guide - Logical File Path, Name (ROFI).docx](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001164632013&iv_version=0001&iv_guid=DC941F4AEBB3E34D914171ACD9269058) (51 KB)

**Translations**

This note is available in multiple languages via machine translation:

- [Deutsch](https://me.sap.com/notes/0001953973/D)
- [日本語](https://me.sap.com/notes/0001953973/J)
- [Português](https://me.sap.com/notes/0001953973/P)
- [Español](https://me.sap.com/notes/0001953973/S)
- [Français](https://me.sap.com/notes/0001953973/F)
- [Italiano](https://me.sap.com/notes/0001953973/I)
- [Русский](https://me.sap.com/notes/0001953973/R)
- [中文](https://me.sap.com/notes/0001953973/1)
- [한국어](https://me.sap.com/notes/0001953973/3)

**Recommendations for Logical File Paths**

To enhance security and reduce dependencies:

- Create a directory structure that reflects the user name and/or program name.
- Use this structure when setting up physical paths and file names for logical file paths.

For detailed guidance, refer to the attached manual.

**Credits**

Supported by [Redrays](https://redrays.io) for providing the information.