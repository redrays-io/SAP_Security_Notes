1490437 - Corrections for ST-PI

**Description**

### Symptom
The following problems were identified in the functions in ST-PI:

1. Extensive authorizations for the object 'S_RFC' allow certain non-RFC-capable function modules to be called using an RFC user.
2. It is possible to read files using an RFC access without sufficient authorization checks being carried out.
3. Only one insufficient check of the import parameter is carried out for certain form routines for generating includes that are used to call function modules for Service Data Control Center (SDCCN) data download.

These affected functions are used during the download collection in the EarlyWatch Alert, during the central system administration, and in Business Process Monitoring in the Solution Manager.

### Reason and Prerequisites
*Details not provided.*

### Solution
To correct the problems described above, implement the attached source code corrections or import one of the Support Packages 2008_1_XXX Support Package 4 (XXX stands for the particular Release).

**Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008819972017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001490437?language=en-US&token=39A405D13CAB010C39C402DE3A028D75)
- [Share by Email](https://me.sap.com/notes/0001490437/share)
- [Open in New Window](https://me.sap.com/notes/0001490437)
- [Edit](https://i7p.wdf.sap.corp/sap/support/notes/edit/0001490437) *(Visible to authorized users)*
  
**Header Data**
- **SAP Note/KBA:** 1490437
- **Type:** SAP Security Note
- **Version:** 6
- **Recency:** New
- **Language:** English
- **Master Language:** German
- **Category:** Program error
- **Priority:** Correction with high priority
- **Release Status:** Released for Customer
- **Released On:** 08.03.2011
- **Component:** Service > SAP Solution Manager > Service Data Download

**Software Components**
- **ST-PI:** 2008_1_46C to 2008_1_710

**Support Packages**
- [SAPKITLRA3](https://me.sap.com/supportpackage/SAPKITLRA3)
- [SAPKITLRA4](https://me.sap.com/supportpackage/SAPKITLRA4)
- [SAPKITLRB4](https://me.sap.com/supportpackage/SAPKITLRB4)
- [SAPKITLRB3](https://me.sap.com/supportpackage/SAPKITLRB3)
- [SAPKITLRC4](https://me.sap.com/supportpackage/SAPKITLRC4)
- [SAPKITLRD4](https://me.sap.com/supportpackage/SAPKITLRD4)
- [SAPKITLRE3](https://me.sap.com/supportpackage/SAPKITLRE3)
- [SAPKITLRE4](https://me.sap.com/supportpackage/SAPKITLRE4)

**References**
- [1861791 - OS CMD injection vulnerability in ST-PI](https://me.sap.com/notes/1861791)
- [1552585 - SAP Solution Manager: Basic functions 7.1 SP1](https://me.sap.com/notes/1552585)
- [888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

**Validity**
Applicable to ST-PI versions from 2008_1_46C to 2008_1_710.

**Correction Instructions**
Implement the corrections available [here](https://me.sap.com/corrins/0001490437/212).

For more details and updates, visit the [SAP Support Portal](https://me.sap.com/notes/0001490437).

*Credits to [Red Rays](https://redrays.io) for supporting the provision of this information.*