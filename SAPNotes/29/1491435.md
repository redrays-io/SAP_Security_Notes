1491435 - Missing authorization check for SPP alert deletion

**Symptom**

A malicious user can exploit the deletion of alerts in the SPP application by using specially crafted inputs to execute arbitrary database commands. This can be used to retrieve or remove data persisted by the system.

**Reason and Prerequisites**

This issue is caused by an SQL injection vulnerability. The code constructs an SQL statement including strings that can be altered by a malicious user. The manipulated SQL statement can retrieve additional information from the database or modify it.

**Prerequisite Note**

- [1490783 - No authorization check when searching for alert types](https://me.sap.com/notes/1490783)

**Solution**

To address this vulnerability, implement this security correction by applying SAP Note [1491435](https://me.sap.com/notes/1491435) or installing the corresponding support package.

**Affected Software Components**

- **Supply Chain Management > Advanced Planning and Optimization > Service Parts Planning > Shortage Analysis (SCM-APO-SPP-SHA)**

**Valid for Software Component Versions**

- **SCM:** 500, 510, 700, 701
- **SCM_BASIS:** 500, 510, 700, 701

**Support Packages**

- **SCM 500:** [SAPKY50019](https://me.sap.com/supportpackage/SAPKY50019)
- **SCM_BASIS 500:** [SAPK-50019INSCMBASIS](https://me.sap.com/supportpackage/SAPK-50019INSCMBASIS)
- **SCM_BASIS 510:** [SAPK-51018INSCMBASIS](https://me.sap.com/supportpackage/SAPK-51018INSCMBASIS)
- **SCM 510:** [SAPKY51015](https://me.sap.com/supportpackage/SAPKY51015)
- **SCM_BASIS 700:** [SAPK-70009INSCMBASIS](https://me.sap.com/supportpackage/SAPK-70009INSCMBASIS)
- **SCM 700:** [SAPKY70009](https://me.sap.com/supportpackage/SAPKY70009)
- **SCM 701:** [SAPKY70102](https://me.sap.com/supportpackage/SAPKY70102)
- **SCM_BASIS 701:** [SAPK-70102INSCMBASIS](https://me.sap.com/supportpackage/SAPK-70102INSCMBASIS)

**Manual Correction Instructions**

1. Run transaction `SE91`.
2. Enter the following in the Message class field: `/SCMB/ABAS`
3. Add the following message to the message class:
   - **Number:** 522
   - **Text:** No authorization to delete alerts of the selected alert type(s)
4. Save the new text.

**References**

- [SAP Note 1491435 - Missing authorization check for SPP alert deletion](https://me.sap.com/notes/1491435)
- [SAP Note 1490783 - No authorization check when searching for alert types](https://me.sap.com/notes/1490783)

**Credits**

Credits to [redrays.io](https://redrays.io) for support in providing the information.