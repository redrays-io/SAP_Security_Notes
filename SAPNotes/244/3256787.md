3256787 - [CVE-2023-24530] Unrestricted Upload of File in SAP BusinessObjects Business Intelligence Platform (CMC)

## Description

SAP BusinessObjects Business Intelligence Platform (CMC) has a vulnerability that allows authenticated admin users to upload malicious files. This can lead to complete compromise of the application, affecting confidentiality, integrity, and availability.

## Impact

An attacker can exploit this vulnerability to perform operations that may fully compromise the application, with a high impact on all security aspects.

## CVSS Score

- **Score**: 8.4 (Critical)
- **Vector**: CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H

## Affected Software Components

- **ENTERPRISE** versions 420 and 430

## Solution

The issue is resolved by implementing frontend and backend validation of file format types. Patches are listed in the "Support Package Patches" section below.

- **Download for SNOTE**: [Download](https://notesdownloads.sap.com/note/0040000000170002023)
- **PDF Version**: [PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003256787?language=en-US&token=9B2E1C747D5B6AC898E5822199E3CF8A)

## Workaround

1. **Locate the `global.properties` File**:
   - **Windows**: `<InstallDir>\SAP BusinessObjects\tomcat\webapps\BOE\WEB-INF\config\default`
   - **Unix**: `<INSTALL_DIR>/enterprise_xi40/tomcat/webapps/BOE/WEB-INF/config/default`
2. **Update File Formats**:
   - Check if the property `upload.file.allowed.formats` is assigned with supported format types.
   - If not, update it with at least one supported format type. Refer to [SAP KBA 2315665](https://me.sap.com/notes/2315665) for a list of supported formats.
3. **Save and Restart**:
   - Save the `global.properties` file after the update.
   - Restart Tomcat.
4. **Outcome**:
   - After these steps, users will be allowed to upload only whitelisted format types.

*Ensure to assess the applicability of this workaround for your SAP landscape prior to implementation.*

## References

- [SAP Note 3256787](https://me.sap.com/notes/3256787)
- [SAP KBA 2315665](https://me.sap.com/notes/2315665)

## Support Package Patches

- **SBOP BI PLATFORM SERVERS 4.3 SP004 000000**: [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)
- **SBOP BI PLATFORM SERVERS 4.3 SP003 000100**: [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)
- **SBOP BI PLATFORM SERVERS 4.2 SP009 001200**: [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
- **SBOP BI PLATFORM SERVERS 4.3 SP002 000900**: [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)

## Credits

Credits to [redrays.io](https://redrays.io) for support to provided information.