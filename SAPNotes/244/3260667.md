SAP Security Note 3260667 - Missing Authorization Check in SAP S/4HANA Finance (Advanced Payment Management)

**Overview**

SAP has released Security Note **3260667** addressing a critical vulnerability in **SAP S/4HANA Finance for Advanced Payment Management**. This vulnerability pertains to missing authorization checks, which could allow an attacker to create in-house bank accounts, posing a low impact on the confidentiality of the application.

**Details**

- **CVE Identifier:** [CVE-2024-21736](https://www.cve.org/CVERecord?id=CVE-2024-21736)
- **Type:** SAP Security Note
- **Version:** 6
- **Recency:** New
- **Status:** Released for Customer
- **Release Date:** January 9, 2024
- **Component:** Financials > Financial Supply Chain Management > Payment Factory > In-House Bank (FIN-FSCM-PF-IHB)

**Symptom**

SAP S/4HANA Finance for Advanced Payment Management does not perform the necessary authorization checks. An attacker could exploit this by triggering a function import to create in-house bank accounts, leading to unauthorized access and modifications.

**Reason and Prerequisites**

This security note should be applied **only** if you are using:
- **Product:** S/4HANA Finance for Advanced Payment Management
- **Component:** In-House Banking for S/4HANA Finance for Advanced Payment Management

**Solution**

An authorization check has been implemented for the affected function import. To mitigate the vulnerability, you should:

1. **Implement Corrections or Support Packages:**
   - Apply the corrections referenced in this security note.
   - Install the relevant support packages to ensure the authorization checks are enforced.

**Affected Components**

- **Software Components:**
  - **SAPSCORE:** Version 128
  - **S4CORE:** Version 107

**CVSS Score**

- **Base Score:** 6.4
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

**Downloads**

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000000019212024](https://notesdownloads.sap.com/note/0040000000019212024)
- **PDF Version:** [View PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003260667?language=en-US&token=EA72BCAA0BE5C1A862416E8AAAB6636F)

**Support Package**

- **SAPK-10701INS4CORE:** [Download Support Package](https://me.sap.com/supportpackage/SAPK-10701INS4CORE)

**Manual Correction Instructions**

To manually apply the authorization check, follow these steps:

```plaintext
1. Open transaction code SU22 and enter the following selection parameters:

   - Select By: Application Types
   - Type of Application: TADIR Service
   - Object Name: UI_IHBACCOUNTMASSCREATP_02   0001

2. Execute the selection by pressing F8.

3. Switch into Edit mode and select Object -> Add Objects (Manually) in the Authorization Object section.

4. Add the object /PF1/MASAV, set the Check Indicator to "Check" and the Default Status to "Yes".

5. In the Authorization Default Values section, set the following field names and values for object /PF1/MASAV:

   - Field Name: /PF1/BKARE
     - From: <initial>
     - To: <initial>

   - Field Name: ACTVT
     - From: 01
     - To: <initial>

6. Save your changes.
```

**Available Languages**

This security note is available in multiple languages, including:

- Deutsch
- 日本語 (Machine Translation)
- Português (Machine Translation)
- Español (Machine Translation)
- Français (Machine Translation)
- Italiano (Machine Translation)
- Русский (Machine Translation)
- 中文 (Machine Translation)
- 한국어 (Machine Translation)

**Credits**

Thanks to [RedRays](https://redrays.io) for supporting the provision of this information.