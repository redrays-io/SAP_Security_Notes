3265173 - [CVE-2022-41261] Improper Access Control in SAP Solution Manager (Diagnostic Agent)

**Symptom**

SAP Solution Manager allows an authenticated attacker on a Windows system to access a file containing sensitive data, which can be used to access a configuration file containing credentials to access other system files. Successful exploitation can enable the attacker to access files and systems for which they are not authorized.

**Other Terms**

Access control, SAP Solution Manager 7.2, SAP Solution Manager Diagnostic, [CVE-2022-41261](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41261)

**Reason and Prerequisites**

On Windows, all users in a certain group have full access to specific secured files and folders.

**Solution**

The patch is applicable only for SAP Solution Manager 7.2 running SP 14.

1. **Install the Latest Patch:**
   - Apply patch version >= 8 for LM-SERVICE SP14.
   - Refer to [SAP Note 2686969](https://me.sap.com/notes/2686969) to understand the procedure for upgrading the Solution Manager LM-SERVICE Java component.

2. **Post-Upgrade Changes:**
   - After the automatic upgrade of the Diagnostics Agents, group and individual user access to the secured files and folders are removed.
   - Only the user running the agent (e.g., "SAPServiceDAA") will have full access to these secured files and folders.

**Workaround for LM-SERVICE SP13 and Lower SPs**

Please assess the applicability of the workaround for your SAP landscape before implementation.

**Manual Workaround Steps:**

1. Open `<SMDAgent_directory>/configuration/secstore.properties` file in Windows Explorer.
2. Right-click and select "Properties".
3. In the popup, select the "Security" tab.
4. Click the "Edit" button to open a new window.
5. Remove all users and groups.
6. Add and grant full permission to the user running the diagnostic agent (e.g., "SAPServiceDAA").
7. Repeat the above steps for the files and folders under `<SMDAgent_directory>/configuration/security`.

![Folder Permission](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125900001509532022&iv_version=0003&iv_guid=00109B36D59A1EDD97FDC6839D9C70CA)

**CVSS**

- **Score:** 6.0
- **Vector:** [CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N](https://me.sap.com)

  | Key                     | Value        |
  |-------------------------|--------------|
  | Attack Vector (AV)      | Local (L)    |
  | Attack Complexity (AC)  | Low (L)      |
  | Privileges Required (PR)| High (H)     |
  | User Interaction (UI)   | None (N)     |
  | Scope (S)               | Changed (C)  |
  | Confidentiality Impact (C)| High (H)   |
  | Integrity Impact (I)    | None (N)     |
  | Availability Impact (A) | None (N)     |

**Software Components**

- **LM-SERVICE:** From 7.20 to 7.20

**Support Package Patches**

- **SOLMANDIAG 720 SP014 Patch Level 000008:** [Download Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP014&patch_level=000008)

**References**

- This document is referenced by [SAP Note 3282073](https://me.sap.com/notes/3282073).

**Attachments**

- [secuity_folder_permission.jpg](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125900001509532022&iv_version=0003&iv_guid=00109B36D59A1EDD97FDC6839D9C70CA) (53 KB)

For more details, visit [SAP Support](https://me.sap.com/).

---

*Information supported by [Redrays.io](https://redrays.io).*