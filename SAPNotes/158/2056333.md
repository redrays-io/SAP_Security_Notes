2056333 - Directory traversal in IS-ADEC-SPC

**Description**

**Symptom**

SPEC2000 contains a vulnerability through which an attacker can potentially read arbitrary files on the remote server, possibly disclosing confidential information.

**CVSS Information**
- **CVSS Base Score:** 2.3 / 10
- **CVSS Base Vector:**
  - **Attack Vector (AV):** Adjacent Network (A)
  - **Attack Complexity (AC):** Medium (M)
  - **Authentication (Au):** Single (S)
  - **Impact to Confidentiality (C):** Partial (P)
  - **Impact to Integrity (I):** None (N)
  - **Impact to Availability (A):** None (N)

_SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/service.sap.com/securitynotes/)._

**Reason and Prerequisites**

SPEC2000 fails to correctly validate the path that is used to reference a file that is read from the remote server. As a result, an attacker can potentially direct the program to an arbitrary other file in the system, disclosing its contents.

**Solution**

Implement the relevant support package or follow the attached correction instructions.

**Software Components Affected**

- **ECC-DIMP:** Versions 600, 602, 603, 604, 605, 606, 616, 617

**Support Package**

- **ECC-DIMP 600:** [SAPK-60027INECCDIMP](https://me.sap.com/supportpackage/SAPK-60027INECCDIMP)
- **ECC-DIMP 602:** [SAPK-60217INECCDIMP](https://me.sap.com/supportpackage/SAPK-60217INECCDIMP)
- **ECC-DIMP 603:** [SAPK-60316INECCDIMP](https://me.sap.com/supportpackage/SAPK-60316INECCDIMP)
- **ECC-DIMP 604:** [SAPK-60417INECCDIMP](https://me.sap.com/supportpackage/SAPK-60417INECCDIMP)
- **ECC-DIMP 605:** [SAPK-60514INECCDIMP](https://me.sap.com/supportpackage/SAPK-60514INECCDIMP)
- **ECC-DIMP 606:** [SAPK-60614INECCDIMP](https://me.sap.com/supportpackage/SAPK-60614INECCDIMP)
- **ECC-DIMP 616:** 
  - [SAPK-61608INECCDIMP](https://me.sap.com/supportpackage/SAPK-61608INECCDIMP)
  - [SAPK-61609INECCDIMP](https://me.sap.com/supportpackage/SAPK-61609INECCDIMP)
- **ECC-DIMP 617:** [SAPK-61706INECCDIMP](https://me.sap.com/supportpackage/SAPK-61706INECCDIMP)

**Correction Instructions**

1. Download [DIMP_CI_NO_FILENAME_C.zip](https://me.sap.com/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001135132014&iv_version=0002&iv_guid=590561CCDD5C22409749CA91891AF1BE) from the attachment section of the note. In this archive, you will find `DIMP_CI_NO_TFRM_T.bcs`.
2. Copy `DIMP_CI_NO_FILENAME_C.bcs` to an appropriate folder.
3. Create a workbench request in client 000 and keep it.
4. In SE06, set the system change option to make sure that ECC-DIMP is modifiable (this can be reverted back after all the steps).
5. Run transaction SCPR3.
6. Click on the **Upload BC set** button (Shift + F8).
7. Enter the file name as `DIMP_CI_NO_FILENAME_C.bcs` from the folder where it was saved.
8. Select **OK** for the appearing pop-up and save.
9. Provide a transport request when prompted.
10. Using SE38, execute the report `SCPR_ACTIVATE_SBCSETS`.
11. Select the options "Ignore Previous Activations" and "Ignore Table Delivery Classes" under the "Activation Options" section and activate (F8) the Switch BC sets `DIMP_CI_NO_FILENAME_C`.
12. Using the FILE transaction, configure the appropriate file path for the `S2K_MESSAGE` logical file path.
13. Implement the attached correction instructions.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000012223532017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002056333?language=en-US&token=CEB2693DCCABEA80A0D465A40E3B8BEE)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002056333)

**Attributes**

- **Externally Reported:** Yes

**Translations Available**

- [Japanese](https://me.sap.com/notes/0002056333/J)
- [Deutsch](https://me.sap.com/notes/0002056333/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0002056333/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002056333/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002056333/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002056333/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002056333/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002056333/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002056333/3)

**Attachments**

- [DIMP_CI_NO_FILENAME_C.zip](https://me.sap.com/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001135132014&iv_version=0002&iv_guid=590561CCDD5C22409749CA91891AF1BE) (969 KB, application/x-zip-compressed)

For more details, visit the [SAP Security Notes](https://me.sap.com/service.sap.com/securitynotes/).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*