2059285 - Switchable authorization checks for RFC in LO-MD-BP-CM

**Description**

This SAP Security Note introduces new switchable authorization checks for RFC function modules within the LO-MD-BP-CM component. These enhancements aim to strengthen the security measures by ensuring that remote function calls are adequately authorized.

**Details**

- **SAP Note Number:** 2059285
- **Type:** SAP Security Note
- **Version:** 2
- **Release Status:** Released for Customer
- **Release Date:** 11.11.2014
- **Component:** Logistics - General > Logistics Basic Data > Business Partners > Customer Master

**Symptom**

The existing S_RFC authorization checks may not be sufficient to guarantee the secure execution of certain RFC function modules. This vulnerability necessitates the implementation of additional authorization controls to enhance system security.

**Solution**

New switchable authorization checks have been implemented and are delivered in an inactive state to maintain compatibility with existing processes. These checks can be activated manually using transaction **SACF**. Below are the steps to activate these authorization checks:

### Activation Steps

1. **Import Scenario Definition:**
   - Start transaction **SACF** in the development system.
   - Verify if the scenario definition **LOMDBPCM_SDCA_CUSTOMER** exists.
   - If absent, download the file [LOMDBPCM_SDCA_CUSTOMER.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001195112014&iv_version=0002&iv_guid=2769FE6EA43AD74F90348016A97EA4F5) attached to this note.
   - Use transaction **SACF_TRANSFER** to upload the scenario definition.

2. **Create Productive Authorization Scenario:**
   - In **SACF**, navigate to **Scenario Definition**.
   - Select **LOMDBPCM_SDCA_CUSTOMER** and transfer it to a productive scenario.
   - Choose the status **Active** to activate authorization checks and logging, or **Logging** to enable logging without enforcing authorization.

3. **Configure Security Audit Log:**
   - Ensure that the Security Audit Log is activated via transaction **SM19**.
   - Create a new filter to capture relevant audit messages:
     - **DUO:** Authorization check on object successful.
     - **DUP:** Authorization check on object failed.
     - **DUQ:** Changes to the authorization scenario.

4. **Adjust User Roles:**
   - Use report **RSAU_SELECT_EVENTS** to identify users requiring additional authorizations.
   - Update roles accordingly to comply with the new authorization scenarios.

**Prerequisites**

- **SAP Note 1988903:** Check whether a function module was called via external RFC.
- **SAP Note 1995667:** SACF: Navigation error.
- Applicable for SAP_BASIS releases 700, 701, 702, 731, and 740.

**Support Packages**

Ensure that the relevant support packages are applied:
- [SAPKH60027](https://me.sap.com/supportpackage/SAPKH60027) for SAP_APPL 600
- [SAPKH60217](https://me.sap.com/supportpackage/SAPKH60217) for SAP_APPL 602
- ... *(list continues for other versions)*

**Attachments**

- [LOMDBPCM_SDCA_CUSTOMER.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001195112014&iv_version=0002&iv_guid=2769FE6EA43AD74F90348016A97EA4F5) (387 KB)

**References**

- [SAP Note 2078596: Further improvements for RFC security](https://me.sap.com/notes/2078596)

For more detailed information, refer to the official SAP Note [2059285](https://me.sap.com/notes/2059285).

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*