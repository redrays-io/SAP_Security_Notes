2054616 - Authority-check not working properly if used without fields

**Symptom**

An authenticated user can use functions of BC-SEC-AUT to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**

- **CVSS Base Score:** 4.6
- **CVSS Base Vector:** AV:N/AC:H/AU:S/C:P/I:P/A:P

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/).*

**Other Terms**

Authorization, authorization check, authority-check, BC-SEC-AUT.

**Reason and Prerequisites**

The authority-check returns wrong results if it is called without a field and the user has no authorizations for the tested authorization object. The correct `sy-subrc` should be 12 in this case.

The error is a side effect of [Note 2025703 - Performance of AUTHORITY-CHECK](https://me.sap.com/notes/2025703).

**Solution**

Import a kernel (disp+work) with a patch level of at least:

| Release | PL  |
|---------|-----|
| 7.21    | 316 |
| 7.40    | 77  |
| 7.41    | 43  |
| 7.42    | 9   |

For more information about download and installation, refer to [SAP Note 19466](https://me.sap.com/notes/19466).

**Affected Releases and Patch Levels**

| Software Component | From | To   |
|--------------------|------|------|
| KRNL32NUC          | 7.21 | 7.21 |
| KRNL32NUC          | 7.21EXT | 7.21EXT |
| KRNL32UC           | 7.21 | 7.21 |
| KRNL32UC           | 7.21EXT | 7.21EXT |
| KRNL64NUC          | 7.21 | 7.21 |
| KRNL64NUC          | 7.21EXT | 7.21EXT |
| KRNL64NUC          | 7.40 | 7.40 |
| KRNL64NUC          | 7.41 | 7.41 |
| KRNL64NUC          | 7.42 | 7.42 |
| KRNL64UC           | 7.21 | 7.21 |
| KRNL64UC           | 7.21EXT | 7.21EXT |
| KRNL64UC           | 7.40 | 7.40 |
| KRNL64UC           | 7.41 | 7.41 |
| KRNL64UC           | 7.42 | 7.42 |
| KERNEL             | 7.21 | 7.21 |
| KERNEL             | 7.40 | 7.40 |
| KERNEL             | 7.41 | 7.41 |
| KERNEL             | 7.42 | 7.42 |

**Support Package Patches**

- [SAP KERNEL 7.42 64-BIT UNICODE SP009 Patch 000009](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200025031&V=MAINT)
- [SAP KERNEL 7.21 32-BIT SP316 Patch 000316](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200021235&V=MAINT)
- *(Additional patches available in the Support Package Patch section.)*

For complete details on available support packages and patches, visit the [SAP Support Portal](https://me.sap.com/).

**References**

- **This document refers to:** [2040721 - authority-check not working properly if used without fields](https://me.sap.com/notes/2040721)
- **This document is referenced by:** [2040721 - authority-check not working properly if used without fields](https://me.sap.com/notes/2040721)

**Side Effects**

This document solves side effects related to [2025703 - Performance of AUTHORITY-CHECK](https://me.sap.com/notes/2025703).

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*