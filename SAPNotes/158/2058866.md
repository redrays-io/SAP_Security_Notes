2058866 - Potential modification of persisted data in IS-R-PUR-AHD

**SAP Note/KBA**: 2058866  
**Type**: SAP Security Note  
**Version**: 2  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer  
**Released On**: 09.12.2014  
**Component**: [IS-R-PUR-AHD](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'IS-R-PUR-AHD*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

### Symptom
An attacker can exploit AHD and use specially crafted inputs to modify database commands, resulting in the modification of data persisted by the system.

### Other Terms
SQL injection, database, AHD, WDRD

### Reason and Prerequisites
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by an attacker. The manipulated SQL statement can then be used to modify information in the database.

### Solution
Implement the source code correction.

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000012238082017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002058866?language=en-US&token=6817254E9B7CBFF69A2D38C8AF02C7B4)
- [Share by Email](https://me.sap.com/sharebyemail)
- [Open in New Window](https://me.sap.com/opennewwindow)

### Support Packages
| Software Component Version | Support Package           | URL |
|----------------------------|---------------------------|-----|
| SAP_APPL 600               | [SAPKH60027](https://me.sap.com/supportpackage/SAPKH60027) |  
| SAP_APPL 602               | [SAPKH60217](https://me.sap.com/supportpackage/SAPKH60217) |  
| SAP_APPL 603               | [SAPKH60316](https://me.sap.com/supportpackage/SAPKH60316) |  
| SAP_APPL 604               | [SAPKH60417](https://me.sap.com/supportpackage/SAPKH60417) |  
| SAP_APPL 605               | [SAPKH60514](https://me.sap.com/supportpackage/SAPKH60514) |  
| SAP_APPL 606               | [SAPKH60614](https://me.sap.com/supportpackage/SAPKH60614) |  
| SAP_APPL 616               | [SAPKH61609](https://me.sap.com/supportpackage/SAPKH61609) |  
| SAP_APPL 617               | [SAPKH61706](https://me.sap.com/supportpackage/SAPKH61706) |  

### Correction Instructions
- [Correction Instruction 1](https://me.sap.com/corrins/0002058866/1)

### Available Languages
- [Deutsch](https://me.sap.com/notes/0002058866/D)
- [日本語](https://me.sap.com/notes/0002058866/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002058866/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002058866/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002058866/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002058866/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002058866/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002058866/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002058866/3)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

_Credits to [redrays.io](https://redrays.io) for support and information._