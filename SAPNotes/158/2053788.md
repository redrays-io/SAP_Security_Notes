2053788 - Missing authorization check in RFC enabled function module - BC-MOB-MI-SER

---

**Symptom**

This SAP note describes new switchable authorization checks for RFC function modules in BC-MOB-MI-SER.

**Reason and Prerequisites**

Remote calls to RFC function modules are protected by checks on the authorization object S_RFC. Authorizations for S_RFC must be limited to the required minimum to ensure system security. Many RFC function modules can be sufficiently protected using S_RFC authorization checks, often without additional functional authorization checks. Please see SAP note [2008727](https://me.sap.com/notes/2008727) for further information on RFC Security.

It was identified that S_RFC authorization checks might not be sufficient for secure execution of RFC function modules covered by this note. Activate new switchable authorization checks and update corresponding roles if these RFC function modules are included in S_RFC authorizations in your system.

**Solution**

New switchable authorization checks have been implemented. The checks are delivered inactive to ensure compatibility with your running processes. They can be activated in transaction SACF as described in the attached manual correction instructions.

**Implementation Steps:**

1. **Download and Upload SACF_DATA:**
   - Download the `SACF_DATA.TXT` file from [Attachment](https://me.sap.com/support/sapnotes/public/services/attachment.htm?iv_key=012006153200001084682014&iv_version=0006&iv_guid=54DBF55F75DCE24790325A8AC8844D69).
   - Save it locally.
   - Go to transaction `SACF_TRANSFER`, choose "Upload" and check "Scenario Definition".
   - Enter the scenario name `BC_MI_RFC_CHECK`.
   - Uncheck "Replace existing scenarios" and 'Test Mode' if not testing.
   - Execute and select the downloaded file.
   - Save the scenario definition to the package `S_ME_MGMT`.

2. **Activate the Scenario:**
   - Go to transaction `SACF`.
   - Enter `BC_MI_RFC_CHECK` and select "Productive Scenarios".
   - Execute and double-click the scenario name to check if the status is "A" (Active).
   - If not active, activate it by selecting "Scenario Definition", double-clicking `BC_MI_RFC_CHECK`, and choosing 'Active' from the 'Scenario' button in the toolbar.
   - If authorization issues arise, run transaction `SU53` to identify missing authorizations and update profiles accordingly. If unresolved, contact the 'BC-SEC' component.

3. **Maintain Authorization Proposals:**
   - In transaction `SU22`, select application type "RFC Function Module".
   - Select the function modules with new switchable authorization checks and execute maintenance.
   - Switch to change mode and add any missing authorization objects manually.
   - Set proposal status:
     - Set `S_RFC` to "No".
     - Set "Yes" for authorization objects used in your checks to allow PFCG to propose them when adding function modules to roles.

4. **Maintain Default Values:**
   - For display-only authorizations (e.g., activity 03), set as default values.
   - Leave fields blank where multiple values may be valid to allow flexibility during role maintenance.

5. **Update Message Class:**
   - Go to transaction `SE91`.
   - Open message class `MI_AUTH` and create:
     - Message 008: "Note 1882417 must be implemented including kernel requirements"
     - Message 009: "No Authorization To Execute For RFC enabled Function Module"

**Attachments and References:**

- [Download for SNOTE](https://me.sap.com/note/0040000012208792017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002053788?language=en-US&token=D01B46B280965C4F54FACC6B9834D0D9)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002053788)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002053788/E/diff)

**Prerequisites:**

Ensure the following SAP notes are implemented based on your SAP_BASIS release:
- [1988903 - Check whether a function modules was called via external RFC](https://me.sap.com/notes/1988903)
- [1995667 - SACF: Navigation error](https://me.sap.com/notes/1995667)

**Support Packages:**

Apply the relevant support packages for your SAP_BASIS version:
- SAP_BASIS 700: [SAPKB70032](https://me.sap.com/supportpackage/SAPKB70032)
- SAP_BASIS 701: [SAPKB70117](https://me.sap.com/supportpackage/SAPKB70117)
- SAP_BASIS 702: [SAPKB70217](https://me.sap.com/supportpackage/SAPKB70217)
- SAP_BASIS 731: [SAPKB73115](https://me.sap.com/supportpackage/SAPKB73115)
- SAP_BASIS 740: [SAPKB74010](https://me.sap.com/supportpackage/SAPKB74010)

**Credits**

Thanks to [RedRays](https://redrays.io) for supporting the information provided.