2094598 - Fixing POODLE SSLv3.0 Vulnerability in AS Java

**Symptom**

An attacker can discover information related to SAP NetWeaver (NW) Application Server (AS) Java when using the SSL 3.0 protocol. Such information could allow the attacker to specialize attacks against AS Java.

As reported in [CVE-2014-3566](https://me.sap.com/cve-2014-3566), a so-called man-in-the-middle attack is possible, even if the newer protocol version TLS 1.0 is enabled or configured in addition to SSLv3.

**Other Terms**

- Information disclosure
- SSL v3.0
- POODLE
- CVE-2014-3566

**Reason and Prerequisites**

The SSL protocol 3.0 uses nondeterministic CBC padding, which makes it easier for man-in-the-middle attackers to obtain clear text data via a padding-oracle attack, also known as the "POODLE" issue.

**Solution**

Apply the corrective measures according to the Validity and SP Patch Level sections of this note.

**Manual Activities**

Introduced two new properties of the SSL service on the Java dispatcher node:

- `SSL_VERSION_MIN`
- `SSL_VERSION_MAX`

These properties specify the minimum and maximum versions of the SSL/TLS protocol that should be used by AS Java for establishing SSL connections.

**Supported Values:**

- `SSL30`
- `TLS10`
- `TLS11`

The property values are case insensitive. The default values are `TLS10` and `TLS11`, respectively, and they are enforced immediately after the fix is deployed. No manual intervention is necessary for switching off SSL 3.0 as it is switched off automatically by applying the fix.

**Changing Property Values:**

- **Visual Admin Tool:**
  - Navigate to: `Dispatcher -> Services -> SSL Provider -> Properties`
  
  *A restart of the Java Dispatcher node will be necessary for the new values to take effect.*

- **Configtool:**
  - Navigate to:
    1. `Global dispatcher configuration -> services -> ssl`
    2. `instance_IDxxxxxx -> dispatcher_IDxxxxxxxx -> services -> ssl`
  
  *A restart of the cluster will be necessary for the new values to take effect.*

**References**

- [2088755 Disabling SSLv3.0 in Netweaver AS Java 6.40 -7.0x](https://me.sap.com/notes/2088755)
- [2503155 TLS 1.2 Support in SAP NetWeaver AS Java 7.0x Systems](https://me.sap.com/notes/2503155)
- [2110020 Enabling TLS or disabling SSLv3 protocol versions on SAP WebDispatcher, or SAP WebAS](https://me.sap.com/notes/2110020)

**Validity**

Applicable to the following software components:

- **SAP-JEECOR**
  - From: 7.00 to 7.00
  - From: 7.01 to 7.02

**Support Package Patches**

Various support package patches are available for different versions. Refer to the [Support Package Patch List](https://me.sap.com/notes/0040000012444172017) for more details.

For more information, visit the [SAP Notes](https://me.sap.com/notes/2094598).

*Credits to [RedRays](https://redrays.io) for supporting information.*