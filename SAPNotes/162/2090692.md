SAP Security Note 2090692 - Security vulnerability in ICM content filter [sapcsa]

---

**SAP Note Number:** 2090692  
**Type:** SAP Security Note  
**Version:** 3  
**Release Date:** January 12, 2015  
**Component:** Basis Components > Security  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Language:** English  

### Symptom

An attacker can enlarge HTTP requests to a size where the content is not checked by the filter in ICM.

### CVSS Information

- **CVSS Base Score:** 6.0 / 10
- **CVSS Vector:**
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Medium (M)
  - **Privileges Required (PR):** Single (S)
  - **Confidentiality Impact (C):** Partial (P)
  - **Integrity Impact (I):** Partial (P)
  - **Availability Impact (A):** Partial (P)

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/).*

### Reason and Prerequisites

The content filter does not check content that is larger than the internal memory buffer. The SAP profile parameter `mpi/buffer_size` defines the size of this buffer, which is set to 64 KB by default. If a request exceeds this size, the content is not checked.

### Solution

Perform an upgrade of your kernel. Use the kernel patches listed in this note.

### Support Package Patches

Here are some of the available support package patches:

- **SAP KERNEL 7.43 64-BIT UNICODE**
  - [Support Package SP007 Patch 000007](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200023955&V=MAINT)
  
- **SAP KERNEL 7.42 64-BIT UNICODE**
  - [Support Package SP032 Patch 000032](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200025031&V=MAINT)
  
- **SAP KERNEL 7.21 64-BIT UNICODE**
  - [Support Package SP411 Patch 000411](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200021238&V=MAINT)

*For a complete list of patches, please refer to the [Support Package Patches](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200023955&V=MAINT) section of this note.*

### References

This document is referenced by:

- [2070374 - 403 Access Denied when strings like "script:", "transcript:" or "</script>" are part of a business transaction or E-Mail](https://me.sap.com/notes/2070374)
- [925602 - Corrections within SAP Content Filter](https://me.sap.com/notes/925602)
- [2121255 - Regression error in SAP Content Filter [sapcsa] in large requests](https://me.sap.com/notes/2121255)

### Side Effects

This document is causing side effects as referenced by:

- [2121255 - Regression error in SAP Content Filter [sapcsa] in large requests](https://me.sap.com/notes/2121255)

### Download and Print

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017973652017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002090692?language=en-US&token=E8451634485663AD58F59D2DAB7CFD34)

### Available Languages

Translations are available in multiple languages:

- [Deutsch](https://me.sap.com/notes/0002090692/D)
- [Japanese (Machine Translation)](https://me.sap.com/notes/0002090692/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002090692/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002090692/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002090692/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002090692/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002090692/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002090692/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002090692/3)

---

*Credits: [Redrays](https://redrays.io) for support in providing this information.*