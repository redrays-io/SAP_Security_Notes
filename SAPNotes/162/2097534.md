SAP Security Note 2097534 - Code Injection Vulnerability in CRM-BF-BRF

## Description

SAP has released Security Note **2097534** addressing a critical **code injection vulnerability** in the **CRM-BF-BRF** component. This vulnerability allows attackers to execute arbitrary program code, potentially leading to unauthorized system behavior control or privilege escalation without needing legitimate credentials.

## Affected Components

- **Customer Relationship Management > Basic Functions > Business Rules Framework (CRM-BF-BRF)**
- **Other Components:**
  - Customer Relationship Management > Leasing (CRM-LAM)
  - Customer Relationship Management > Financial Services (CRM-IFS)

## Impact

An authenticated user with the necessary authorizations (`S_TCODE` for transaction BRF) can exploit this vulnerability to:

- Execute arbitrary program code
- Escalate privileges
- Modify or delete data
- Perform **SQL injection** to retrieve sensitive information from the database
- Create new users with higher privileges
- Conduct denial of service (DoS) attacks

## Solution

To address this vulnerability, implement the **correction instructions** provided in the security note. This involves:

1. **Applying Correction Instructions:**
   - Use the [Download for SNOTE](https://notesdownloads.sap.com/note/0040000012460872017) to apply the necessary corrections.

2. **Manual Configuration Changes:**
   - Perform configuration changes within the BRF transaction as detailed in the security note.
   - Ensure users have the `S_DEVELOP` authorization to modify `SELECT` and `CALL FUNCTION` BRF expressions.

3. **Transport Changes:**
   - After implementation, transport the changes throughout your system landscape to ensure consistency across environments.

**Detailed Steps:**

- Open the BRF application class and switch to edit mode.
- Enter `CL_CRM_AUTHORIZATION_BRF` in the "Authorization check" field for all relevant application classes and their leaves.
- Save the changes and repeat for any other BRF application classes.
- Ensure meta implementation classes like `<IMPL>` are also maintained.
- Transport the configuration changes across your system landscape.

## Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000012460872017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002097534?language=en-US&token=8FCE82E65BB79CFB1144B54A867629C0)

## Additional Information

- **Number of Correction Instructions:** 5
- **Software Components Affected:** BBPCRM versions 600, 700, 701, 702, 712, 713
- **Release Status:** Released for Customer on 14.04.2015
- **Priority:** Correction with high priority

## Credits

Thanks to [RedRays](https://redrays.io) for support in providing this information.