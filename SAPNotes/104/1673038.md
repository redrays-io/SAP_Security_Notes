SAP Security Note 1673038: SUS - Unauthorized Modification in BSP Application SRMSUS

**Overview**

SAP Security Note **1673038** addresses a critical vulnerability in the **SRM-SUS** application component that allows unauthorized modification of displayed application content through a Cross-Site Scripting (XSS) attack. This vulnerability can enable malicious users to steal authentication information from legitimate users, potentially compromising the entire application by impersonating administrators.

**Details**

- **Vulnerability Type:** Cross-Site Scripting (XSS)
- **Affected Component:** SRM-SUS (Supplier Relationship Management > Supplier Self-Services)
- **Affected Versions:** 500, 550, 600, 700, 701, 702

**Impact**

- Unauthorized modification of application content.
- Theft of authentication information, leading to session hijacking.
- Potential full compromise of application security if an administrator is impersonated.

**Solution**

1. **Implement Prerequisite Notes:**
   - [SAP Note 1582870](https://me.sap.com/notes/1582870) - *ABAP XSS Escaping Support*
   - [SAP Note 1582867](https://me.sap.com/notes/1582867) - *Security options (XSS) for ESCAPE*

   Ensure these notes are implemented using SNOTE before proceeding.

2. **Apply the Correction:**
   - Use SNOTE to apply the correction instructions provided in SAP Note 1673038.
   - Alternatively, implement the corresponding support package as detailed below.

**Support Packages**

| Software Component Version | Support Package                           | URL                                                                                         |
|----------------------------|-------------------------------------------|---------------------------------------------------------------------------------------------|
| SRM_SERVER 500             | SAPKIBKS18                                | [Download](https://me.sap.com/supportpackage/SAPKIBKS18)                                   |
| SRM_SERVER 550             | SAPKIBKT21                                | [Download](https://me.sap.com/supportpackage/SAPKIBKT21)                                   |
| SRM_SERVER 600             | SAPKIBKU06                                | [Download](https://me.sap.com/supportpackage/SAPKIBKU06)                                   |
| SRM_SERVER 700             | SAPKIBKV13                                | [Download](https://me.sap.com/supportpackage/SAPKIBKV13)                                   |
| SRM_SERVER 701             | SAPK-70109INSRMSRV                         | [Download](https://me.sap.com/supportpackage/SAPK-70109INSRMSRV)                            |
| SRM_SERVER 702             | SAPK-70203INSRMSRV                         | [Download](https://me.sap.com/supportpackage/SAPK-70203INSRMSRV)                            |

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009933742017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001673038?language=en-US&token=2C8E7E5CA9E9CC9EA9E97BD19B54AF2C)

**Prerequisites**

Ensure the following SAP Notes are implemented as they are essential for the successful application of the solution:

- [SAP Note 1508969](https://me.sap.com/notes/1508969) - Unauthorized usage of application functionality in SRM
- [SAP Note 1003820](https://me.sap.com/notes/1003820) - Supplier cannot be registered
- [SAP Note 1032573](https://me.sap.com/notes/1032573) - FormofAddr field mandatory in userselfreg.htm page
- [SAP Note 1411659](https://me.sap.com/notes/1411659) - Security fixes for SRM SUS, Vendor Evaluation, SRM ROS
- [SAP Note 1579382](https://me.sap.com/notes/1579382) - Incomplete error messages during self-registration
- [SAP Note 1597931](https://me.sap.com/notes/1597931) - XSRF Protection for the stateless BSP application
- Additional notes as listed in the full SAP Security Note.

**References**

- [SAP Note 1682054](https://me.sap.com/notes/1682054) - Unauthorized modification of displayed content in SRM-SUS
- [SAP Note 1582870](https://me.sap.com/notes/1582870) - ABAP XSS Escaping Support
- [SAP Note 1582867](https://me.sap.com/notes/1582867) - Security options (XSS) for ESCAPE

**Additional Information**

For a comprehensive understanding and implementation guidance, please refer to the full SAP Security Note available on the [SAP Support Portal](https://me.sap.com/notes/1673038).

**Credits**

Thanks to [redrays.io](https://redrays.io) for supporting information.