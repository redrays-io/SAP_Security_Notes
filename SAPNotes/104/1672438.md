1672438 - Unauthorized modification of BSP in CRM-MKT-MPL

**SAP Security Note 1672438**

**Type:** SAP Security Note  
**Version:** 1  
**Recency:** New  
**Language:** English  
**Master Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 08.05.2012  
**Component:** Customer Relationship Management > Marketing > Marketing Planner (CRM-MKT-MPL)  
**Support Package Versions:**
- **BBPCRM 600:** [SAPKU60012](https://me.sap.com/supportpackage/SAPKU60012)
- **BBPCRM 700:** [SAPKU70012](https://me.sap.com/supportpackage/SAPKU70012)
- **BBPCRM 701:** [SAPKU70108](https://me.sap.com/supportpackage/SAPKU70108)
- **BBPCRM 702:** [SAPKU70203](https://me.sap.com/supportpackage/SAPKU70203)
- **BBPCRM 712:** Not Available

### Symptom
CRM-MKT-MPL can be abused by a malicious user, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

### Other Terms
Cross-site scripting, XSS, CRM-MKT-MPL

### Reason and Prerequisites
BSP Page/s  
CORM_VISUALIZE  
MKTSC_DEFAULT  
CPG_TODO  
CPGEF_PLANNING  
CPGOE_ABLOCKS  
CPTEF_PLANNING  
SCNOE_SS  
TPMOE  
within CRM-MKT-MPL do not sufficiently encode OUTPUT parameters, resulting in a cross-site scripting issue.

Cross-site scripting can be used to steal another user's authentication information, such as data relating to their current session. A malicious user who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user.

If an administrator is impersonated, the security of the application may be fully compromised.

### Solution
Please apply this note or import the changes via the relevant support package.

**References:**
- [1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [1582867 - Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)

**Preconditions:**
- **BBPCRM 600:** [1409777 - Possible Cross Site Scripting in Campaign Planning](https://me.sap.com/notes/1409777)
- **BBPCRM 700:** [1409777 - Possible Cross Site Scripting in Campaign Planning](https://me.sap.com/notes/1409777)

**Corrections Information:**
- **Number of Correction Instructions:** 4  
  [View Corrections](https://me.sap.com/corrins/0001672438/63)

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009929882017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001672438?language=en-US&token=AB7DF2D64BDC3EDF8D6315F01AF3BCE7)

**Translations Available:**
- [Deutsch](https://me.sap.com/notes/0001672438/D) (Human Translation)
- [日本語](https://me.sap.com/notes/0001672438/J) (Human Translation)
- [Português (Machine Translation)](https://me.sap.com/notes/0001672438/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001672438/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001672438/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001672438/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001672438/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001672438/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001672438/3)

**Rate this Document:**
Currently, there are no ratings for this document.

*Credits: [RedRays.io](https://redrays.io) for support to provided information.*