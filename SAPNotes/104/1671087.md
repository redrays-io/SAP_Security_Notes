1671087 - Unauthorized modification of display content in MKT Calendar

**SAP Security Note 1671087: XSS Vulnerability in CRM Marketing Calendar**

A critical security vulnerability has been identified in the SAP CRM Marketing Calendar (Component: CRM-MKT-MPL-CAL). This vulnerability allows attackers to perform unauthorized modifications of displayed application content, potentially leading to the theft of authentication information through Cross-Site Scripting (XSS) attacks.

### **Details**

- **Symptom:**  
  The application components `MKTCALENDAR` and `MKTCALENDAR_NEW` are susceptible to XSS attacks, enabling unauthorized modification of displayed content and the possibility of stealing user authentication information.

- **Reason:**  
  Insufficient encoding of parameters such as `LV_CHARSET`, `URLBASECONTROLERSTATELESS`, `URLBASECONTROLER`, and `BASEADR` in `CALENDARAPPLET.HTM` leads to XSS vulnerabilities. Similarly, parameters like `DISPLAY_URL` in `MKTPROJFLEXRESULT.HTM` and `MKTPROJFLEXRESULTS.HTM` are not properly encoded. Additionally, outdated XML encoding methods and unverified communication between Java Applets and the `MKTCALENDAR` component exacerbate the issue.

- **Impact:**  
  Successful exploitation can allow attackers to deface or modify website content and steal session-related authentication information, potentially enabling impersonation of users, including administrators, thereby compromising application security.

### **Affected Components and Versions**

- **Software Component:** BBPCRM
- **Versions:** 520, 600, 700, 701, 702, 712

### **Solution**

To mitigate this vulnerability, apply SAP Security Note 1671087 or import the necessary changes via the relevant support package. Ensure that all affected software components are updated to the recommended support package versions as listed below:

- **BBPCRM 520:** SAPKU52011
- **BBPCRM 600:** SAPKU60011, SAPKU60012
- **BBPCRM 700:** SAPKU70011, SAPKU70012
- **BBPCRM 701:** SAPKU70108, SAPKU70109
- **BBPCRM 702:** SAPKU70202, SAPKU70203

For detailed support package information and downloads, visit the [Support Package](https://me.sap.com/supportpackage/SAPKU52011) section on the SAP support portal.

### **References**

- [SAP Note 1671470](https://me.sap.com/notes/1671470) - BSP: Design2008 for release 7.00 and 7.01
- [SAP Note 1582870](https://me.sap.com/notes/1582870) - ABAP XSS Escaping Support
- [SAP Note 1582867](https://me.sap.com/notes/1582867) - Security options (XSS) for ESCAPE

### **Additional Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009921582017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001671087?language=en-US&token=4C505D7C8DDD8532D0DBDB4EA012020F)

**Credits:** Information supported by [Redrays.io](https://redrays.io).