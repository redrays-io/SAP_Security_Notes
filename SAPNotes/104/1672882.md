1672882 - Unauthorized use of User Mapping functions in portal

**SAP Note/KBA**: 1672882  
**Type**: SAP Security Note  
**Version**: 2  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with medium priority  
**Status**: Released for Customer  
**Released On**: 10.07.2012  

### Description

**Symptom**  
An attacker can execute functions in the User Mapping Portal component application without authentication and authorization.

**Other Terms**  
Cross-Site Request Forgery (XSRF), XSRF, Portal component, User Mapping

**Reason and Prerequisites**  
The User Mapping Portal component application executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a specific URL and parameters, the function is executed with the rights of the authenticated user.  
The attacker may use a cross-site scripting (XSS) attack to achieve this or present a malicious link to the victim.

**Solution**  
To apply XSRF protection for the User Mapping Portal component application, please update the AS Java to the latest patch level as specified in the Support Package Patch level section below.

### Support Package Patches

| Software Component Version    | Support Package | Patch Level | URL                                                                                                                                                                                                                                                                                          |
|-------------------------------|-----------------|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| PORTAL FRAMEWORK 7.01         | SP009           | 000010      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010816&support_package=SP009&patch_level=000010)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.02         | SP009           | 000010      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012488&support_package=SP009&patch_level=000010)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.01         | SP008           | 000011      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010816&support_package=SP008&patch_level=000011)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.02         | SP008           | 000012      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012488&support_package=SP008&patch_level=000012)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.01         | SP012           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010816&support_package=SP012&patch_level=000000)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.02         | SP012           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012488&support_package=SP012&patch_level=000000)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.02         | SP007           | 000011      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012488&support_package=SP007&patch_level=000011)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.02         | SP006           | 000015      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012488&support_package=SP006&patch_level=000015)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.01         | SP011           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010816&support_package=SP011&patch_level=000001)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.02         | SP011           | 000003      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012488&support_package=SP011&patch_level=000003)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.01         | SP010           | 000009      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010816&support_package=SP010&patch_level=000009)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.02         | SP010           | 000009      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012488&support_package=SP010&patch_level=000009)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.00         | SP023           | 000013      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004659&support_package=SP023&patch_level=000013)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.00         | SP024           | 000013      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004659&support_package=SP024&patch_level=000013)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.00         | SP025           | 000012      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004659&support_package=SP025&patch_level=000012)                                                                                                                                                                   |
| PORTAL FRAMEWORK 7.00         | SP026           | 000005      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004659&support_package=SP026&patch_level=000005)                                                                                                                                                                   |
| PORTAL PLATFORM 6.0_640       | SP027           | 000011      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004174&support_package=SP027&patch_level=000011)                                                                                                                                                                   |
| PORTAL PLATFORM 6.0_640       | SP028           | 000008      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004174&support_package=SP028&patch_level=000008)                                                                                                                                                                   |
| PORTAL PLATFORM 6.0_640       | SP029           | 000005      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004174&support_package=SP029&patch_level=000005)                                                                                                                                                                   |
| PORTAL PLATFORM 6.0_640       | SP030           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004174&support_package=SP030&patch_level=000000)                                                                                                                                                                   |
| PORTAL PLATFORM 6.0_640       | SP031           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004174&support_package=SP031&patch_level=000000)                                                                                                                                                                   |

### Downloads

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017371902017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001672882?language=en-US&token=DECE9C0760845CA8114C22E0CD88BA80)

*Credits to [RedRays.io](https://redrays.io) for support and information.*