2994289 - Reverse Tabnabbing vulnerability within SAP CRM WebClient UI

## Description

Applications based on **SAP CRM WebClient UI** allow an attacker to redirect users to a malicious site due to Reverse Tabnabbing vulnerabilities. This can lead to:

- **Phishing attacks** to steal user credentials.
- **Redirection to untrusted webpages** containing malware or other malicious exploits.

## Affected Software Components

- **S4FND**
  - Releases: 102, 103, 104, 105
- **WEBCUIF**
  - Releases: 700, 701, 730, 731, 746, 747, 748, 800, 801

## Solution

Implement the attached Correction Instructions or apply the relevant Support Package for your software component version.

### Support Packages

- **S4FND**
  - [SAPK-10208INS4FND](https://me.sap.com/supportpackage/SAPK-10208INS4FND)
  - [SAPK-10306INS4FND](https://me.sap.com/supportpackage/SAPK-10306INS4FND)
  - [SAPK-10404INS4FND](https://me.sap.com/supportpackage/SAPK-10404INS4FND)
  - [SAPK-10502INS4FND](https://me.sap.com/supportpackage/SAPK-10502INS4FND)
  
- **WEBCUIF**
  - [SAPK-70024INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70024INWEBCUIF)
  - [SAPK-70121INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70121INWEBCUIF)
  - [SAPK-73016INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73016INWEBCUIF)
  - [SAPK-73128INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73128INWEBCUIF)
  - [SAPK-74722INWEBCUIF](https://me.sap.com/supportpackage/SAPK-74722INWEBCUIF)
  - [SAPK-74816INWEBCUIF](https://me.sap.com/supportpackage/SAPK-74816INWEBCUIF)
  - [SAPK-80012INWEBCUIF](https://me.sap.com/supportpackage/SAPK-80012INWEBCUIF)
  - [SAPK-80110INWEBCUIF](https://me.sap.com/supportpackage/SAPK-80110INWEBCUIF)

## Manual Activities

Before importing the Note to implement, perform the following manual pre-implementation steps in each system:

1. Execute transaction code `SE80`.
2. Open BSP Extension `THTMLB`.
3. Double-click on `link`.
4. Click the **Attribute** tab.
5. Switch to **Edit** mode.
6. Add a new attribute with the following properties:
   - **Attribute:** `rel`
   - **Dynamic Value Allowed:** checked
   - **Tying method:** `TYPE`
   - **Associated Type:** `STRING`
   - **Default value:** `noopener noreferrer`
   - **Description:** Relationship to linked resource. Space to remove default.
7. Save and Activate the modified BSP element (`link`).
8. Activate the entire BSP extension (`THTMLB`).

**Caution:** These manual steps must be performed manually and separately in each system **before** importing the Note.

## CVSS

- **Score:** 4.1
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:N/I:L/A:N
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** None (N)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

## References

- [3040219 - BSP error in WUI / SolMan](https://me.sap.com/notes/3040219)
- [3014875 - Reverse Tabnabbing attack in SAP Netweaver AS ABAP and SAP UI5 applications on multiple platforms](https://me.sap.com/notes/3014875)

## Additional Information

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000190402021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002994289?language=en-US&token=72085DDB68776DC64BE9DCEE6F7E7BAD)

## Credits

Information provided with support from [Redrays.io](https://redrays.io).