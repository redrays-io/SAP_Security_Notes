2992154 - [CVE-2021-21474] SAML Assertion Signature MD5 Digest Algorithm Vulnerability in SAP HANA Database

### Description

**Symptom**

According to the W3C specification, MD5 is not collision-resistant. Therefore, SAP HANA no longer accepts MD5 digests in SAML assertions.

**Other Terms**

- SAML assertion
- MD5
- [CVE-2021-21474](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21474)

**Reason and Prerequisites**

The MD5 algorithm has been removed from the W3C's XML signature specification.

**Solution**

MD5 digest support in SAML assertions has been removed from SAP HANA 2 with the following revisions:

- **HANA 2.0 SPS04** revision 48.03
- **HANA 2.0 SPS05** revision 53

For SAP HANA 1.0 revision 122.34, a new parameter has been added to disable MD5 in the configuration:

1. **Configuration Files:**
   - `global.ini` for the whole system or `<service>.ini` (e.g., `indexserver.ini` or `nameserver.ini`) to disable it for an individual service.

2. **Parameters:**
   - **Section:** `authentication`
   - **Key:** `saml_signature_hash_types`
   - **Default:** `md5,sha1,sha256`

3. **Disabling MD5 via SQL Command:**

   ```sql
   ALTER SYSTEM ALTER CONFIGURATION ('global.ini', 'SYSTEM') 
   SET ('authentication', 'saml_signature_hash_types') = 'sha1,sha256' 
   WITH RECONFIGURE;
   ```

### CVSS Score

- **Score:** 4.1
- **Vector:** `CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L`

### References

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000190422021)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002992154?language=en-US&token=9F2F7A468D0EB410E39824EA9B8C1BFD)

### Affected Components

- **SAP HANA DATABASE:** Versions 1.00 and 2.00

### Support Package Patches

- [SAP HANA DATABASE 1.00 SP122 Patch Level 000034](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP122&patch_level=000034)
- [SAP HANA DATABASE 2.0 SP048 Patch Level 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200005327&support_package=SP048&patch_level=000003)
- [SAP HANA DATABASE 2.0 SP053 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200005327&support_package=SP053&patch_level=000000)

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*