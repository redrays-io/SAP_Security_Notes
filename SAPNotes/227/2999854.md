SAP Security Note 2999854 - CVE-2021-21466: Code Injection in SAP BW/4HANA

### Summary

**SAP Note Number:** 2999854  
**Title:** [CVE-2021-21466] Code Injection in SAP Business Warehouse and SAP BW/4HANA  
**CVSS Score:** 9.9  
**Vulnerability Type:** Code Injection, OS Command Injection  
**Release Date:** April 27, 2021  
**Component:** Interface to Database (BW-BEX-OT-DBIF)  
**Priority:** HotNews  
**Status:** Released for Customer

### Description

SAP Business Warehouse and SAP BW/4HANA are vulnerable to a code injection flaw that allows a low-privileged attacker to inject malicious ABAP code using a remote-enabled function module over the network. Due to insufficient input validation, an attacker with S_RFC access can execute this function module to insert malicious code, which is then saved persistently in a report within the ABAP repository. Executing this report can lead to:

- **Sensitive Data Loss**
- **Modification of Critical Data**
- **Denial of Service**

### Affected Components

- **DW4CORE:** Versions 100, 200
- **SAP_BW:** Versions 700 to 702, 711, 730 to 731, 740, 750 to 755, 782

### Solution

To mitigate this vulnerability, implement the correction instructions provided in the SAP Note. The solution involves adding additional validation for all input data in the affected function to prevent malicious inputs from reaching the database.

**Download Correction Instructions:** [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000030052021)  
**PDF Version:** [PDF Download](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002999854?language=en-US&token=C6B4AD1ED216093C84E2B5510C729306)

### CVSS Details

- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** Low (L)
- **User Interaction:** None (N)
- **Scope:** Changed (C)
- **Confidentiality Impact:** High (H)
- **Integrity Impact:** High (H)
- **Availability Impact:** High (H)

**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

### Prerequisites

- **SAP Note 1884876:** Debug report generated with syntax error ([Link](https://me.sap.com/notes/1884876))
- **SAP Note 2099301:** Error analysis: Catching Queries that fail on the BWA ([Link](https://me.sap.com/notes/2099301))

### References

- [Q&A for SAP Security Note 2999854](https://me.sap.com/notes/3006112)

### Side Effects

This document does not introduce any side effects but resolves existing issues related to code injection vulnerabilities.

### Credits

Credits to [redrays.io](https://redrays.io) for support in providing this information.