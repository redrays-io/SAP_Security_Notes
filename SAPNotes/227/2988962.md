2988962 - Cross-Site Request Forgery (CSRF) vulnerability for S/4HANA OP2020, OP1909 in Import Financial Plan Data

**Description**

### Symptom
For S/4HANA OP2020, OP1909 in Import Financial Plan Data allows an attacker to trick an authenticated user into sending unintended requests to the web server. This vulnerability is due to insufficient CSRF protection.

Some well-known impacts of CSRF vulnerability are:
- Attacker could take actions on behalf of an authenticated user
- Loss of non-repudiation

### Other Terms
Open redirect, cross-site redirect, cross-domain redirect, XSRF, session riding

### Reason and Prerequisites
SAP Note 2988956 must be implemented as well.

### Solution
Apply support package **S/4HANA OP2020 FPS1**, **S/4HANA OP1909 SP4**.

**Manual Activities:**
1. Go to transaction `segw`.
2. Find project `FINS_ACDOC_PLAN_IMPORT`.
3. Open "Function Imports" of the project.
4. For function imports "Import" and "TestImport", change "HTTP Method Type" from "GET" to "POST".
5. Click on the button "Generate Run Time Objects".

**Prerequisites**
- SAP Note 2988956 must be implemented.

**CVSS Score**

- **Score:** 5.4
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L

  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** None
  - **User Interaction:** Required
  - **Scope:** Unchanged
  - **Confidentiality Impact:** None
  - **Integrity Impact:** Low
  - **Availability Impact:** Low

**Available Languages**

- [Deutsch (Machine Translation)](https://me.sap.com/notes/0002988962/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002988962/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002988962/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002988962/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002988962/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002988962/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002988962/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002988962/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002988962/3)

**Downloads**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001385742021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002988962?language=en-US&token=4E825AF11800AE0A94599B1A80FAB917)

**Release Information**
- **Released On:** 28.09.2021
- **Component:** Controlling > Fiori UI for Overhead Cost Controlling > Overhead Management > Planning

**Side Effects**
This document is causing side effects in [SAP Note 3265353](https://me.sap.com/notes/0003265353) titled "Test Import Source File" and "Import Source File" in Fiori app F1711 - Import Financial Plan Data is unresponsive.

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*