SAP Security Note 1539599 - Unauthorized use of application functions in Duet Enterprise

**Symptom**
A malicious user can trick legitimate users into executing functions in Duet Enterprise 1.0 without their awareness or consent.

**Other Terms**
Clickjacking, IW_TNG, Duet Enterprise 1.0

**Reason and Prerequisites**
Duet Enterprise 1.0 executes certain functions through user interface elements. When a malicious user tricks an authenticated user to open a specifically crafted website, the function is executed with the rights of the authenticated user. Malicious users may present a link to the victim to deceive legitimate users.

**Solution**
The customer should install the security fix provided as part of the [Reporting WSP](https://me.sap.com/servicessupport/knowledge) as per the standard SharePoint guidelines.

**Description of the fix [Technical]:**
1. **Convert GET to POST Calls:** GET calls for AlertMe/RunReport operations have been converted to POST calls. This enables validation of POST calls on the SharePoint server using the RequestDigest mechanism as suggested by Microsoft.
2. **Reject Unrecognized Commands:** In POST calls, unrecognized commands are rejected and no action is triggered.
3. **Encode Outputs:** The SharePoint code has been modified to include encoding of all outputs obtained as direct user inputs in SharePoint or customization entries in the SAP system.

**Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017149092017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001539599?language=en-US&token=4B60FB9AE5812761D150E17F2C9E14E5)
- [Share by Email](https://me.sap.com/notes/0001539599/share)
- [Open in New Window](https://me.sap.com/notes/0001539599/open)

**References**
This document refers to:
- [SAP Note 1517110 - Duet Enterprise: Patch Information Note](https://me.sap.com/notes/1517110)

This document is referenced by:
- [SAP Note 1517110 - Duet Enterprise: Patch Information Note](https://me.sap.com/notes/1517110)

**Available Translations**
- [日本語](https://me.sap.com/notes/0001539599/J) (Human)
- [Deutsch](https://me.sap.com/notes/0001539599/D) (Human)
- [Português (Machine Translation)](https://me.sap.com/notes/0001539599/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001539599/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001539599/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001539599/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001539599/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001539599/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001539599/3)

*Credits to [Redrays](https://redrays.io) for support in providing this information.*