1540257 - Potential directory traversal in bill of exchange trans.

---

**SAP Security Note 1540257 - Potential Directory Traversal in Bill of Exchange Transactions**

**Description**

**Symptom**
- Potential directory traversal in bill of exchange transactions.

**Other Terms**
- Path traversal, directory traversal, bill of exchange transactions.

**Reason and Prerequisites**
The programs specified in the correction instructions contain vulnerabilities that allow a malicious user to potentially read arbitrary files on the remote server, possibly disclosing confidential information. Additionally, some programs allow writing arbitrary files, which can lead to data corruption or alteration of system behavior.

**Solution**
For detailed information and instructions, refer to [Note 1497003](https://me.sap.com/notes/1497003). Implementing the corrections from Note 1497003 is a prerequisite for applying this note.

**Logical File Names Used in This Solution**

- **Logical Path Name:** `FI_DME_DOWNLOAD_PATH`
  - **Logical File Name:** `FI_DME_DOWNLOAD_FILE`
  - **Existing Programs:** Transaction FDTA
  - **New Programs:** Transactions FBWD, RFWEDX00, RFFBWG10, RFFBWD10

- **Logical Path Name:** `FI_DME_CREATE_PATH`
  - **Logical File Name:** `FI_DME_CREATE_FILE`
  - **Existing Programs:** SAPFPAYM, RFFOD__L, RFFOD__U, RFFOD__Z
  - **New Programs:** Transaction FBWE, transactions FBWE, RFFBWD99, RFFBWD00

**Recommendations for Setting Up Logical File Names**
To minimize the number of logical file names, some programs share the same logical file name. However, this creates dependencies among these programs. It is recommended to create a directory structure that reflects the user name and/or program name to securely separate data created by different users and programs. Use this structure when setting up the physical paths and file names for the logical file paths and file names.

**Affected Components**
- **Financial Accounting > Accounts Receivable > Basic Functions > Bill of exchange (FI-AR-AR-H)**

**Support Packages**
| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| SAP_APPL 31I               | SAPKH31IB9      | [Link](https://me.sap.com/supportpackage/SAPKH31IB9) |
| SAP_APPL 40B               | SAPKH40B89      | [Link](https://me.sap.com/supportpackage/SAPKH40B89) |
| SAP_APPL 45B               | SAPKH45B67      | [Link](https://me.sap.com/supportpackage/SAPKH45B67) |
| SAP_APPL 46B               | SAPKH46B62      | [Link](https://me.sap.com/supportpackage/SAPKH46B62) |
| SAP_APPL 46C               | SAPKH46C62      | [Link](https://me.sap.com/supportpackage/SAPKH46C62) |
| SAP_APPL 470               | SAPKH47036      | [Link](https://me.sap.com/supportpackage/SAPKH47036) |
| SAP_APPL 500               | SAPKH50025      | [Link](https://me.sap.com/supportpackage/SAPKH50025) |
| SAP_APPL 600               | SAPKH60020      | [Link](https://me.sap.com/supportpackage/SAPKH60020) |
| SAP_APPL 602               | SAPKH60210      | [Link](https://me.sap.com/supportpackage/SAPKH60210) |
| SAP_APPL 603               | SAPKH60309      | [Link](https://me.sap.com/supportpackage/SAPKH60309) |
| SAP_APPL 604               | SAPKH60410      | [Link](https://me.sap.com/supportpackage/SAPKH60410) |
| SAP_APPL 605               | SAPKH60504      | [Link](https://me.sap.com/supportpackage/SAPKH60504) |

**Correction Instructions**
- **Software Component:** SAP_APPL
- **Number of Correction Instructions:** 7
- **URL:** [Correction Instructions](https://me.sap.com/corrins/0001540257/1)

**Prerequisites**
Several SAP Notes must be applied before implementing this security note. Key prerequisites include:
- [Note 1497003](https://me.sap.com/notes/1497003) - Potential directory traversals in applications
- [Note 125240](https://me.sap.com/notes/125240) - FBWE: Spanish data medium exchange format for EURO
- [Note 501635](https://me.sap.com/notes/501635) - FBWE: Missing check of the DME directory
- [Note 862322](https://me.sap.com/notes/862322) - FBWE/DTA: Program termination after entry of the file path
- [Note 1498832](https://me.sap.com/notes/1498832) - FI: Potential Directory Traversal
- [Note 965432](https://me.sap.com/notes/965432) - FBWE/DTA: No directory check in UNIX environments

**Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009134962017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001540257?language=en-US&token=716A3AC07DA2CBD32D2F67AEB7DDC142)

---

*Credits to [RedRays](https://redrays.io) for supporting the information provided.*