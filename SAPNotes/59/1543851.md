SAP Security Note 1543851 - Potential directory traversals in applications

**Description**

Potential directory traversals in applications using physical file names or logical file names as input.

This note provides the additional correction instructions which need to be applied in case you decide not to import the transport request as described in [Note 1497003](https://me.sap.com/notes/1497003). As mentioned in [Note 1497003](https://me.sap.com/notes/1497003), SAP recommends that you import the transport request to avoid issues with copy & paste errors or other errors related to manual application or creation of corrections and objects.

**Other Terms**

path traversal, FILE_VALIDATE_NAME, FILE_GET_NAME, FILE, SF01, FILE_NOT_FOUND, LOGICAL_FILENAME_NOT_FOUND, VALIDATION_FAILED, SG 001, 805, 806, 807, 808, 809

**Reason and Prerequisites**

Please refer to [Note 1497003](https://me.sap.com/notes/1497003) for more details.

**Solution**

1. **Complete the manual pre-implementation steps** according to [Note 1497003](https://me.sap.com/notes/1497003).
2. **Apply the correction instructions** of [Note 1543851](https://me.sap.com/notes/1543851).
3. **Complete the manual post-implementation steps** according to [Note 1497003](https://me.sap.com/notes/1497003).

**Dependencies**

If you have to implement [Note 1497003](https://me.sap.com/notes/1497003) as a prerequisite for another note but decide to implement [Note 1543851](https://me.sap.com/notes/1543851), you can mark [Note 1497003](https://me.sap.com/notes/1497003) as implemented in SNOTE by implementing it via SNOTE but removing the checkboxes for all objects of all correction instructions.

The same applies if you encounter a note requiring [Note 1543851](https://me.sap.com/notes/1543851) as a prerequisite when you have already implemented [Note 1497003](https://me.sap.com/notes/1497003). Start implementing [Note 1543851](https://me.sap.com/notes/1543851) via SNOTE but remove all the checkmarks when applying the correction instructions.

**References**

*This document refers to:*
- [Note 1677794 - Erstellung der Einlieferungsdaten für die Deutsche Post AG](https://me.sap.com/notes/1677794)
- [Note 1593845 - Clarification on implementation of Notes 1497003 and 1543851](https://me.sap.com/notes/1593845)
- [Note 1566528 - Directory traversal in IS-M](https://me.sap.com/notes/1566528)
- [Note 1542033 - Update #1 for security note 1497003](https://me.sap.com/notes/1542033)
- [Note 1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

*This document is referenced by:*
- [Note 2021095 - ASU Toolbox - Function module "FILE_VALIDATE_NAME" not found.](https://me.sap.com/notes/2021095)
- [Note 1593845 - Clarification on implementation of Notes 1497003 and 1543851](https://me.sap.com/notes/1593845)
- [Note 1677794 - Erstellung der Einlieferungsdaten für die Deutsche Post AG](https://me.sap.com/notes/1677794)

**Available Languages**

- [日本語](https://me.sap.com/notes/0001543851/J)
- [Deutsch](https://me.sap.com/notes/0001543851/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0001543851/P) (Machine Translation)
- [Español (Machine Translation)](https://me.sap.com/notes/0001543851/S) (Machine Translation)
- [Français (Machine Translation)](https://me.sap.com/notes/0001543851/F) (Machine Translation)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001543851/I) (Machine Translation)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001543851/R) (Machine Translation)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001543851/1) (Machine Translation)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001543851/3) (Machine Translation)

**Side Effects**

*This document causes side effects:*
- [Note 1578073 - FILE_GET_LOGFILE_ALIAS: SAPSQL_INVALID_FIELDNAME](https://me.sap.com/notes/1578073)

**Correction Instructions**

- **SAP_BASIS**: 21 Correction Instructions [View Corrections](https://me.sap.com/corrins/0001543851/41)
- **SAP_APPL**: 2 Correction Instructions [View Corrections](https://me.sap.com/corrins/0001543851/1)

**Software Components**

Applicable to various releases of SAP_APPL and SAP_BASIS from 31I up to 730.

For full details, refer to the SAP Note [1543851](https://me.sap.com/notes/1543851).

**Credits**

Credits to [https://redrays.io](https://redrays.io) for support to provided information.