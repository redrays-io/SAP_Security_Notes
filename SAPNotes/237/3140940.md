3140940 - [CVE-2022-22544] Missing segregation of duties in SAP Solution Manager Diagnostics Root Cause Analysis Tools

**Description**

Due to missing segregation of duty, SAP Solution Manager allows an attacker with admin privileges to browse files and execute code on all connected Diagnostics Agents over the network. On successful exploitation, the attacker can completely compromise the confidentiality, integrity, and availability of the system.

**Other Terms**

- Escalation of privileges
- Segregation of duties (SOD)
- [CVE-2022-22544](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22544)

**Reason and Prerequisites**

Missing segregation of duty.

**Solution**

**Instructions:**

1. Apply the latest LM_SERVICE version containing the fix described in [SAP Note 3145008](https://me.sap.com/notes/3145008).
2. Apply [SAP Note 3137764](https://me.sap.com/notes/3137764) to remove the links to the applications from the SAP Solution Manager Launchpad.

**Workaround**

Please assess the applicability of the workaround for your SAP landscape before implementation.

*Note:* This workaround is a temporary fix and is not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note, either in lieu of the workaround or after implementing it.

1. **Undeploy the following applications in NetWeaver AS JAVA of the SAP Solution Manager:**
   - `tc~webadministrator~fsbrowser`
   - `tc~webadministrator~oscommand`
   - `tc~webadministrator~tda`
   - `tc~webadministrator~standlogviewer`

2. **Important:** These applications need to be undeployed every time a new LM_SERVICE is deployed. This will also remove the Log Viewer of the Diagnostics Agent.

**Alternatives to Removed Functionalities**

If you wish to use similar functionalities, please follow these notes:

- [OS Command Console in SAP Solution Manager](https://me.sap.com/notes/3132826)
- [Log Viewer in SAP Solution Manager](https://me.sap.com/notes/3132808)
- [File System Browser in SAP Solution Manager](https://me.sap.com/notes/3132773)
- [Thread Dump Analysis in SAP Solution Manager](https://me.sap.com/notes/3132758)

For more information, refer to [KBA 3145476](https://me.sap.com/notes/3145476).

**CVSS**

- **Score:** 9.1
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss)

  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** High (H)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** High (H)

**Credits**

Information supported by [redrays.io](https://redrays.io).