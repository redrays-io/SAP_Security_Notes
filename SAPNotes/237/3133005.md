3133005 - Update 2 to Security Note 3130521: [CVE-2021-44228] Remote Code Execution vulnerability associated with Apache Log4j 2 component used in Java Web Service Adapter of SAP NetWeaver Process Integration

## Symptom

**UPDATE 11th January 2022**: The SAP security note [3135581](https://me.sap.com/notes/3135581) includes the corrections provided in this security note as well as [3130521](https://me.sap.com/notes/3130521) and [3132204](https://me.sap.com/notes/3132204).

Java Web Service Adapter of SAP NetWeaver Process Integration uses a version of the open-source component Apache Log4j which is vulnerable to Denial of Service ([CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105)).

## Other Terms

DoS, DDoS, Distributed Denial of Service, Uncontrolled Resource consumption, Resource Exhaustion, [Apache Log4j Security Vulnerabilities](https://logging.apache.org/log4j/2.x/security.html), [CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105), [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046), [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228)

## Reason and Prerequisites

You are only affected by this vulnerability if you are running Java Web Service Adapter of Process Integration / Process Orchestration Release 7.50 SP20, SP21, or SP22. See KBA [3129883](https://me.sap.com/notes/3129883) on how to determine Log4j usage. For an exploit, an attacker requires credentials to the Web Service endpoints.

## Solution

Deploy the Support Packages and Patches referenced by this SAP Security Note. With this patch, version 2.17.0 of Apache Log4j is deployed to your system. This update also fixes the Log4j vulnerabilities reported in SAP Security Notes [3130521](https://me.sap.com/notes/3130521) and [3132204](https://me.sap.com/notes/3132204).

Workarounds are explained in SAP Security Note [3130521](https://me.sap.com/notes/3130521). Actual information about Log4j vulnerabilities is available in FAQ Note [3131436](https://me.sap.com/notes/3131436).

## CVSS

**CVSS Score:** 5.3  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** High (H)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** None (N)
- **Integrity Impact (I):** None (N)
- **Availability Impact (A):** High (H)

## References

- [3135581 - Update 3 to Security Note 3130521](https://me.sap.com/notes/3135581)
- [3130521 - CVE-2021-44228](https://me.sap.com/notes/3130521)
- [3132204](https://me.sap.com/notes/3132204)
- [3129883 - Determining Log4j Usage](https://me.sap.com/notes/3129883)
- [3131436 - Log4j Vulnerabilities FAQ](https://me.sap.com/notes/3131436)

## Attachments

_No attachments available._

## Validity

- **Software Component:** SAP_XIAF
- **From:** 7.50
- **To:** 7.50

## Support Package Patches

- **XI ADAPTER FRAMEWORK 7.50 SP020 Patch Level 000040:** [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP020&patch_level=000040)
- **XI ADAPTER FRAMEWORK 7.50 SP021 Patch Level 000030:** [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP021&patch_level=000030)
- **XI ADAPTER FRAMEWORK 7.50 SP022 Patch Level 000013:** [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP022&patch_level=000013)
- **XI ADAPTER FRAMEWORK 7.50 SP023 Patch Level 000000:** [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP023&patch_level=000000)
- **XI ADAPTER FRAMEWORK 7.50 SP024 Patch Level 000000:** [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP024&patch_level=000000)

## Credits

Information provided with support from [RedRays.io](https://redrays.io).