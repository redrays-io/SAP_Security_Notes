3140564 - [CVE-2022-22528] Information Disclosure in SAP Adaptive Server Enterprise

**Symptom**

SAP Adaptive Server Enterprise (ASE) installation modifies the system PATH environment variable on Windows platforms. Under certain conditions, this allows a Standard User to execute malicious Windows binaries, potentially leading to privilege escalation on the local system. The issue stems from the ASE installer and does not affect other ASE binaries.

**Other Terms**

- Access control
- Authorization error
- Authorization profile
- [CVE-2022-22528](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE-2022-22528)

**Solution**

The issue is resolved in the SAP ASE installer by correcting the system PATH environment variable. The fix is available in the following SAP ASE versions:

- SAP ASE 16.0 SP03 PL11
- SAP ASE 16.0 SP04 PL01 HF1

*Note:* All releases subsequent to the fixed releases inherit this fix.

**Workaround**

Before applying the correction, assess its applicability to your SAP landscape. SAP strongly recommends implementing the corrections outlined in the security note. However, if you need a temporary solution, you can:

1. **Remove SYBASE Entries Manually:**
   - Remove SYBASE-related entries from the system `%PATH%` environment variable.
   - Source `SYBASE.bat` before running ASE utilities.

2. **Update PATH Variable:**
   - Modify the system `%PATH%` environment variable to append SYBASE entries instead of prepending them.

**CVSS Details**

- **Score:** 5.6
- **Vector:** [CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:N/I:N/A:H)

  - **Attack Vector (AV):** Local (L)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** None (N)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** High (H)

**Additional Information**

- **SAP Component:** BC-SYB-ASE
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** 08.02.2022

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000153242022)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003140564?language=en-US&token=F7CDE855636FC8FC3B2D47C5914295D1)

**References**

- [SAP Support Notes](https://me.sap.com/servicessupport/knowledge)
- [Basis Components > Sybase Products > Sybase ASE Database Platform](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

**Credits**

Information provided with support from [Redrays.io](https://redrays.io).