3132922 - [CVE-2021-44228] Remote Code Execution vulnerability associated with Apache Log4j 2 component used in Internet of Things Edge Platform

**Symptom**

**UPDATE 18th January 2022**: This note has been re-released with updated 'Solution' information. This update upgrades the product to Log4j2 version 2.17.1.

Internet of Things Edge Platform uses a vulnerable version of the Apache Log4j 2 component, which is susceptible to remote code execution (CVE-2021-44228).

**Other Terms**

- Command Injection
- OS Command Injection
- Remote Code Execution
- Log4j2
- [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228)
- [CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105)
- [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)
- [CVE-2021-44832](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44832)

**Solution**

Upgrade your Edge Platform to the latest version (**4.75.3**), where Log4j is updated to v2.17.1. You can download the latest version from the [SAP Market Place](https://me.sap.com/softwarecenter).

**Workaround**

Before implementing the workaround, assess its applicability to your SAP landscape. Note that this workaround is a temporary fix and not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note, which can be done instead of or after implementing the workaround.

To mitigate the vulnerability, remove the `JndiLookup` class from the classpath by executing the following command:

```bash
zip -q -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class
```

**CVSS**

- **Score:** 10.0 (Critical)
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001837762021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003132922?language=en-US&token=FC69FF47AC535AB094CCCB78A07253F4)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

**Credits**

Information provided with support from [Redrays.io](https://redrays.io).