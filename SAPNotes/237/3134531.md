3134531 - [CVE-2021-44228] Denial of Service vulnerability associated with Apache Log4j component used in XSA Cockpit

**Symptom**

This SAP security note replaces the corrections provided in security notes [3131397](https://me.sap.com/bc/bsp/sno/ui_entry/entry.htm?param=69765F6D6F64653D3030312669765F7361706E6F7465735F6E756D6265723D3331333133393726) and [3132822](https://me.sap.com/bc/bsp/sno/ui_entry/entry.htm?param=69765F6D6F64653D3030312669765F7361706E6F7465735F6E756D6265723D3331333238323226).

XSA Cockpit uses a log4j version, which contains a severe security vulnerability, namely [CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105), which could cause a denial of service.

**Other Terms**

Denial of service, log4j shell, XSA cockpit, [CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105), [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046), [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228)

**Reason and Prerequisites**

XSA Cockpit uses a version of the Open Source component Apache Log4j which is vulnerable to denial of service (CVE-2021-45105).

**Solution**

Please update to XSA Cockpit version 1.1.25 or higher. In XSA Cockpit 1.1.25, `org.apache.logging.log4j:log4j-slf4j-impl:2.17.0` is used, which itself contains `org.apache.logging.log4j:log4j-core:2.17.0`.

The patch associated with this note addresses the vulnerabilities tracked as CVE-2021-44228, CVE-2021-45046, and CVE-2021-45105. Please apply the same for a complete fix.

**CVSS**

- **CVSS Score:** 7.5
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** None (N)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** High (H)

For more details, refer to the [SAP Security Note 3134531](https://me.sap.com/notes/3134531).

**References**

- This document is referenced by [3134932](https://me.sap.com/notes/3134932): "XSA Cockpit update fails with error 'Selected component SAP HANA Cockpit Stack is not compatible with XSAC_XSA_COCKPIT'".

**Released On**

24.12.2021

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001857532021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003134531?language=en-US&token=5D3DEAEF1884EA117114CBDD97CE3BF7)

---

Credits to [redrays.io](https://redrays.io) for supporting information.