SAP Security Note 3132964: Critical Log4j Vulnerability in SAP Enable Now Manager (CVE-2021-44228)

---

**Title:**  
3132964 - [CVE-2021-44228] Remote Code Execution vulnerability associated with Apache Log4j 2 component used in SAP Enable Now Manager

**Description:**

### Symptom

**UPDATE 11th January 2022:**  
This note has been re-released with minor textual changes in the 'Solution' section. Information about the 2111 HF1 security hotfix has been added.

**UPDATE 24th December 2021:**  
This note has been re-released with minor textual changes. No changes were made that require customer action.

The SAP Enable Now Manager uses a version of the Open Source component Apache Log4j, which has vulnerabilities **CVE-2021-44228**, **CVE-2021-45046**, and **CVE-2021-45105**.

### Other Terms

- Remote Code Execution
- Log4Shell
- Apache Log4j
- [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228)
- [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)
- [CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105)
- [CVE-2021-44832](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44832)

### Reason and Prerequisites

SAP Enable Now Manager versions up to 2111 (build 10.5.7) are impacted.

### CVE Details

**CVE-2021-44228**  
The Apache Software Foundation released a security advisory addressing a remote code execution vulnerability affecting Log4j versions 2.0-beta9 to 2.14.1. A remote attacker could exploit this vulnerability to take control of an affected system.  
**CVSS Score:** 10.0  
**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**CVE-2021-45046**  
The fix for CVE-2021-44228 in Log4j 2.15.0 was incomplete in certain non-default configurations, allowing potential denial of service (DoS) attacks and other exploits.  
**CVSS Score:** 9.0  
**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**CVE-2021-45105**  
Log4j2 versions 2.0-alpha1 through 2.16.0 are vulnerable to uncontrolled recursion from self-referential lookups, leading to DoS attacks. This was fixed in Log4j 2.17.0 and 2.12.3.  
**CVSS Score:** 7.5  
**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

**CVE-2021-44832**  
Vulnerable to remote code execution through malicious JNDI URIs in JDBC Appenders. Fixed in Log4j2 versions 2.17.1, 2.12.4, and 2.3.2.  
**CVSS Score:** 6.6  
**CVSS Vector:** CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H

### Solution

After securing the SAP Enable Now Manager Cloud Edition on 13th December 2021, a Log4j-related security hotfix was released. This update replaces Log4j version 2.14 with the latest version 2.17.1.

- **Hotfix Availability:** The 2111 HF1 hotfix is available on the [SAP Support Portal](https://me.sap.com/).

- **Cloud Instances:** All multi-tenant cloud instances were updated on 8th/9th January 2022.

#### Workaround

**SAP Enable Now - CE (HANA Cloud Edition):**  
No action is needed as the current version is not affected.

**SAP Enable Now Manager On-Premise:**

1. **For CVE-2021-44228:**
   - Navigate to the `TOMCAT\bin` folder.
   - Execute `TomcatXw.exe`.
   - Go to the **Java** tab.
   - Add `-Dlog4j2.formatMsgNoLookups=true` to the Java options.
   - Restart Tomcat.

2. **For CVE-2021-45046 & CVE-2021-45105:**
   - Remove the JndiLookup class from the classpath:
     ```
     zip -q -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class
     ```

### Additional Information

- **Affected Components:**  
  - WPB_MANAGER (1.0 to 1.0)
  - WPB_MANAGER_CE (10 to 10)
  - WPB_MANAGER_HANA (10 to 10)

- **Release Status:** Released for Customer on 11.01.2022
- **Priority:** HotNews
- **Category:** Program error

For more details, visit the [SAP Enable Now Notes](https://me.sap.com/notes/0003132964).

---

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*