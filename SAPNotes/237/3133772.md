3133772 - [CVE-2021-44228] Remote Code Execution vulnerability associated with Apache Log4j 2 component used in SAP Customer Checkout

**Description**

SAP Customer Checkout uses Apache Log4j 2, which is vulnerable to remote code execution (RCE) attacks. This vulnerability is identified by the following CVEs:
- [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228)
- [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)
- [CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105)

**Impact**

- **CVSS Score:** 10.0
- **Attack Vector:** Network
- **Attack Complexity:** Low
- **Privileges Required:** None
- **User Interaction:** None
- **Scope:** Changed
- **Confidentiality, Integrity, Availability Impact:** High

**Affected Versions**

- SAP Customer Checkout 2.0 FP11 PL06 or lower
- SAP Customer Checkout 2.0 FP12 PL04 or lower

**Solution**

**Recommended Action:**
Update to the following versions that include a patched version of Apache Log4j:
- SAP Customer Checkout 2.0 FP11 PL08 or higher
- SAP Customer Checkout 2.0 FP12 PL06 or higher

For customers using SAP Customer Checkout 2.0 FP09 or FP10, updating to FP11 PL08 or higher, or FP12 PL06 or higher is also recommended.

**Temporary Workaround:**

*For SAP Customer Checkout Manager:*

**Windows:**
1. Navigate to the `TOMCAT\bin` folder.
2. Execute `Tomcat9w.exe`.
3. Go to the Java tab.
4. Add `-Dlog4j2.formatMsgNoLookups=true` to the Java options.
5. Restart Tomcat.

**Linux:**
1. Add the parameter `-Dlog4j2.formatMsgNoLookups=true` to your Tomcat start configuration.
2. Restart the Tomcat service.

*For SAP Customer Checkout:*
1. Go to `C:\SapCustomerCheckout`.
2. Open `run.bat` with a text editor (e.g., Notepad++).
3. Locate the line: `-Dorg.apache.cxf.Logger=org.apache.cxf.common.logging.Log4jLogger ^`
4. Add a new line with the following system property: `-Dlog4j2.formatMsgNoLookups=true ^`

**Additional Information**

- Official SAP communication: [SAP Support](https://me.sap.com/sap/support/sfm/notes/0003133772)
- Further resources:
  - [Apache Log4j Security](https://logging.apache.org/log4j/2.x/security.html)
  - [Randori Blog on CVE-2021-44228](https://www.randori.com/blog/cve-2021-44228/)
  - [BSI Cybersecurity Warning](https://www.bsi.bund.de/SharedDocs/Cybersicherheitswarnungen/DE/2021/2021-549032-10F2.pdf?__blob=publicationFile&v=3) (German)

**Credits**

Thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.