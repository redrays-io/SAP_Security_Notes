3135581 - Update 3 to Security Note 3130521: [CVE-2021-44228] Remote Code Execution vulnerability associated with Apache Log4j 2 component used in Java Web Service Adapter of SAP NetWeaver Process Integration

## Description

### Symptom
Java Web Service Adapter of SAP NetWeaver Process Integration uses a version of the Open Source component Apache Log4j which is vulnerable to remote code execution ([CVE-2021-44832](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44832)).

This SAP security note also includes the corrections provided in security notes [3130521](https://me.sap.com/notes/3130521), [3132204](https://me.sap.com/notes/3132204), and [3133005](https://me.sap.com/notes/3133005) (tracked by CVEs [CVE-2021-44832](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44832), [CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105), [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)).

### Other Terms
Command Injection, OS command injection, RCE, [Apache Log4j Security Vulnerabilities](https://logging.apache.org/log4j/2.x/security.html), [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228).

### Reason and Prerequisites
You are only affected by this vulnerability if you are running Java Web Service Adapter of Process Integration / Process Orchestration Release 7.50 SP20, SP21, or SP22. See KBA [3129883](https://me.sap.com/notes/3129883) on how to determine Log4j usage. For an exploit, an attacker requires:
1. Credentials to the Web Service endpoints
2. Access to LDAP Server / file system.

## Solution
Deploy the Support Packages and Patches referenced by this SAP Security Note. This patch deploys version 2.17.1 of Apache Log4j to your system, fixing the Log4j vulnerabilities reported in SAP Security Notes [3130521](https://me.sap.com/notes/3130521), [3132204](https://me.sap.com/notes/3132204), and [3133005](https://me.sap.com/notes/3133005) (tracked by CVEs [CVE-2021-44832](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44832), [CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105), [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)).

### Workaround
Workarounds are explained in SAP Security Note [3130521](https://me.sap.com/notes/3130521). Actual information about Log4j vulnerabilities is available in FAQ Note [3131436](https://me.sap.com/notes/3131436).

## Affected Software Components
- **SAP_XIAF**: Version 7.50

## Support Package Patches
- **XI ADAPTER FRAMEWORK 7.50 SP020**: [Patch 000041](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP020&patch_level=000041)
- **XI ADAPTER FRAMEWORK 7.50 SP021**: [Patch 000031](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP021&patch_level=000031)
- **XI ADAPTER FRAMEWORK 7.50 SP022**: [Patch 000014](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP022&patch_level=000014)
- **XI ADAPTER FRAMEWORK 7.50 SP023**: [Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP023&patch_level=000000)
- **XI ADAPTER FRAMEWORK 7.50 SP024**: [Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP024&patch_level=000000)

## CVSS Score
- **Score**: 6.6
- **Vector**: CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
  - **Attack Vector (AV)**: Network
  - **Attack Complexity (AC)**: High
  - **Privileges Required (PR)**: High
  - **User Interaction (UI)**: None
  - **Scope (S)**: Unchanged
  - **Confidentiality Impact (C)**: High
  - **Integrity Impact (I)**: High
  - **Availability Impact (A)**: High

## References
- [3133005](https://me.sap.com/notes/3133005): Update 2 to Security Note 3130521
- [3132204](https://me.sap.com/notes/3132204): Update 1 to Security Note 3130521
- [3131436](https://me.sap.com/notes/3131436): FAQ Apache Log4j vulnerability in Web Service Adapter of SAP NetWeaver Process Integration
- [3130521](https://me.sap.com/notes/3130521): [CVE-2021-44228] Remote Code Execution vulnerability associated with Apache Log4j 2

## Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000021292022)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003135581?language=en-US&token=B38EF9760F9657E4551BC5848C87EBB0)
- [Show Changes](https://me.sap.com/notesLatestChanges/0003135581/E/diff)
- [Share by Email](https://me.sap.com/notes/0003135581)
- [Open in New Window](https://me.sap.com/notes/0003135581)

## Available Translations
- [Deutsch](https://me.sap.com/notes/0003135581/D) (Human Translation)
- [日本語](https://me.sap.com/notes/0003135581/J) (Machine Translation)
- [Português](https://me.sap.com/notes/0003135581/P) (Machine Translation)
- [Español](https://me.sap.com/notes/0003135581/S) (Machine Translation)
- [Français](https://me.sap.com/notes/0003135581/F) (Machine Translation)
- [Italiano](https://me.sap.com/notes/0003135581/I) (Machine Translation)
- [Русский](https://me.sap.com/notes/0003135581/R) (Machine Translation)
- [中文](https://me.sap.com/notes/0003135581/1) (Machine Translation)
- [한국어](https://me.sap.com/notes/0003135581/3) (Machine Translation)

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*