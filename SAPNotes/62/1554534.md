SAP Security Note 1554534 - Unauthorized use of application functions in BW-PLA-BPS

**Symptom**
A malicious user can execute functions in BW-PLA-BPS without authentication and authorization.

**Other Terms**
Cross-site request forgery (XSRF), BW-PLA-BPS

**Reason and Prerequisites**
BW-PLA-BPS executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a specific URL and parameters, the function is executed with the rights of the authenticated user. This can be achieved through cross-site scripting attacks or by presenting a crafted link to the victim.

**Solution**

*SAP NetWeaver BW 7.00*
- **Support Package 26 (SAPKW70026)**  
  Import Support Package 26 for SAP NetWeaver BW 7.00 into your BW system. This Support Package is available upon the release of [SAP Note 1524896](https://me.sap.com/notes/1524896) titled "SAPBWNews NW BW 7.0 ABAP SP26," which provides detailed information.

*SAP NetWeaver BW 7.01 (SAP NW BW7.0 EnhP 1)*
- **Support Package 09 (SAPKW70109)**  
  Import Support Package 09 for SAP NetWeaver BW 7.01. Available with the release of [SAP Note 1369296](https://me.sap.com/notes/1369296) titled "SAPBINews NW7.01 BW ABAP SP09."

*SAP NetWeaver BW 7.02 (SAP NW BW7.0 EnhP 2)*
- **Support Package 08 (SAPKW70208)**  
  Import Support Package 08 for SAP NetWeaver BW 7.02. Available with [SAP Note 1510975](https://me.sap.com/notes/1510975) titled "Preliminary Version SAPBWNews NW BW 7.02 ABAP SP08."

*SAP NetWeaver BW 7.11*
- **Support Package 07 (SAPKW71107)**  
  Import Support Package 07 for SAP NetWeaver BW 7.11. Available with [SAP Note 1510976](https://me.sap.com/notes/1510976) titled "Preliminary Version SAPBINews NW7.11 BW ABAP SP7."

*SAP NetWeaver BW 7.30*
- **Support Package 03 (SAPKW73003)**  
  Import Support Package 03 for SAP NetWeaver BW 7.30. Available with [SAP Note 1538941](https://me.sap.com/notes/1538941) titled "SAPBWNews NW7.30 BW ABAP SP03."

**Urgent Cases: Correction Instructions**
1. **Check Prerequisite Note:**  
   Ensure you review [SAP Note 875986](https://me.sap.com/notes/875986) for transaction SNOTE.

2. **Implement Correction Instructions:**  
   - Refer to [SAP Note 1520324](https://me.sap.com/notes/1520324) for additional information and prerequisites.
   - Implement the correction instructions provided in SAP Security Note 1554534.
   - Create the report `ZBSP_XSRF_PARAM_BW_PLA_BPS` as a local object in your system.

3. **Execute the Report:**
   - Run the report `ZBSP_XSRF_PARAM_BW_PLA_BPS` and specify a relevant transport request number when prompted. This will populate the `BSPTEMPXSRFSTORE` database table with relevant entries for the adapted BSP applications.

4. **Verify XSRF Protection:**
   - In transaction SE80, navigate to BSP-Application "TUNGUSKA."
   - Double-click the root node and ensure the "XSRF-Protection" flag is checked.

**Preconditions**
- [SAP Note 1357046](https://me.sap.com/notes/1357046) - Session is lost in the STS
- [SAP Note 1575234](https://me.sap.com/notes/1575234) - STS: Error in page overview.htm and inactive links
- [SAP Note 1482118](https://me.sap.com/notes/1482118) - Unauthorized change to data displayed in BPS planning

**Attachments**
- [ZBSP_XSRF_PARAM_BW_PLA_BPS.txt](https://me.sap.com/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000102562011&iv_version=0004&iv_guid=08557BE5FCBB9F46943D951B55278B22)

**Side Effects**
This document may cause the following side effect:
- [SAP Note 1829785](https://me.sap.com/notes/1829785) - Timeout due to missing session token in 'sts_refresh.htm'

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*