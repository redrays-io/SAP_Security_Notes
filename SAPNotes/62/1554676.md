1554676 - Unauthorized use of application functions in CRM planning

**Symptom**
A malicious user can execute functions in CRM planning without authentication and authorization.

**Other Terms**
Cross-site request forgery, XSRF, BW-PLA-BPS, CRM-MKT-MPL

**Reason and Prerequisites**
The CRM-MKT-MPL component in BW-PLA-BPS executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. This can be achieved through a cross-site scripting (XSS) attack or by presenting a deceptive link to the victim.

**Solution**

*SAP NetWeaver BW 7.00*
- Import [Support Package 26 for SAP NetWeaver BW 7.00 (SAPKW70026)](https://me.sap.com/supportpackage/SAPKW70026) into your BW system.
- The Support Package will be available once [Note 1524896](https://me.sap.com/notes/1524896) with the short text "SAPBWNews NW BW 7.0 ABAP SP26" is released.

*SAP NetWeaver BW 7.01 (SAP NW BW7.0 EnhP 1)*
- Import [Support Package 09 for SAP NetWeaver BW 7.01 (SAPKW70109)](https://me.sap.com/supportpackage/SAPKW70109) into your BW system.
- The Support Package will be available once [Note 1369296](https://me.sap.com/notes/1369296) with the short text "SAPBINews NW7.01 BW ABAP SP09" is released.

*SAP NetWeaver BW 7.02 (SAP NW BW7.0 EnhP 2)*
- Import [Support Package 08 for SAP NetWeaver BW 7.02 (SAPKW70208)](https://me.sap.com/supportpackage/SAPKW70208) into your BW system.
- The Support Package will be available once [SAP Note 1510975](https://me.sap.com/notes/1510975) with the short text "Preliminary Version SAPBWNews NW BW 7.02 ABAP SP08" is released.

*SAP NetWeaver BW 7.11*
- Import [Support Package 07 for SAP NetWeaver BW 7.11 (SAPKW71107)](https://me.sap.com/supportpackage/SAPKW71107) into your BW system.
- The Support Package will be available once [SAP Note 1510976](https://me.sap.com/notes/1510976) with the short text "Preliminary Version SAPBINews NW7.11 BW ABAP SP7" is released.

*SAP NetWeaver BW 7.30*
- Import [Support Package 03 for SAP NetWeaver BW 7.30 (SAPKW73003)](https://me.sap.com/supportpackage/SAPKW73003) into your BW system.
- The Support Package will be available once [SAP Note 1538941](https://me.sap.com/notes/1538941) with the short text "SAPBWNews NW7.30 BW ABAP SP03" is released.

**Correction Instructions**
1. **Pre-Implementation Steps:**
   - Ensure [Note 1520324](https://me.sap.com/notes/1520324) is applied. Depending on your system:
     - **Scenario 2a:** If already contained in your applied support package, apply the manual correction instructions:
       - [1390120 for 711](https://me.sap.com/notes/1390120)
       - [1386465 for 730](https://me.sap.com/notes/1386465)
       - [967382 for 70x](https://me.sap.com/notes/967382)
     - **Scenario 2b:** If not contained in the SP, apply the automatic correction instructions provided in this note by creating and executing the report `ZBSP_XSRF_PARAM_CRM_MKT_MPL`.

2. **Manual Activities:**
   - Perform the following steps in transaction SE80 for each relevant BSP application:
     - **Enable XSRF Protection for UPX_EXEC:**
       1. Transaction SE80.
       2. Select BSP Application and enter `UPX_EXEC`.
       3. Double-click the `UPX_EXEC` application and within the Properties tab, set the XSRF Protection to checked.
       4. Expand "Pages with Flow Logic" and enable the "Start BSP" checkbox for:
          - `frameset.htm`
          - `start.htm`
     - **Enable XSRF Protection for UPX_EXEC2:**
       1. Transaction SE80.
       2. Select BSP Application and enter `UPX_EXEC2`.
       3. Double-click the `UPX_EXEC2` application and within the Properties tab, set the XSRF Protection to checked.
       4. Expand "Controller" and enable the "Start BSP" checkbox for:
          - `data.do`
          - `main.do`
          - `upwb.do`
       5. Expand "Pages with Flow Logic" and enable the "Start BSP" checkbox for:
          - `start.htm`

**Downloads**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009214782017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001554676?language=en-US&token=DB0D05B726FA3644EE63400C1E437732)
- [Compare Versions](https://me.sap.com/notesLatestChanges/0001554676/E/diff)

**Prerequisites**
- Ensure all relevant [Prerequisite Notes](https://me.sap.com/notes) are applied as listed in the Security Note.

**Credits**
Information supported by [RedRays](https://redrays.io).