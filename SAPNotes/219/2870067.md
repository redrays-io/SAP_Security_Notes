2870067 - Update 1 to Security Note 2736825 - [CVE-2019-0271] Denial of Service via XML External Entity (XXE) vulnerability in ABAP Server

## Description

**Symptom**

The ABAP Server (used in SAP NetWeaver, Suite/ERP, and S/4HANA) does not sufficiently validate XML documents accepted from untrusted sources. This vulnerability allows attackers to:

- Retrieve arbitrary files from the server.
- Trigger denial-of-service (DoS) conditions.

**Reason and Prerequisites**

External entities may be used in Document Type Definitions (DTD). Such external entities can cause system resource exhaustion and are generally not required for SAP applications.

## Affected Software Components

- **KRNL64NUC**: 7.49
- **KRNL64UC**: 7.49, 7.53, 7.73
- **KERNEL**: 7.49, 7.53, 7.73, 7.77, 7.78, 7.79

## CVSS

- **Score**: 6.5
- **Vector**: `CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H`
  - **Attack Vector**: Network (N)
  - **Attack Complexity**: Low (L)
  - **Privileges Required**: Low (L)
  - **User Interaction**: None (N)
  - **Scope**: Unchanged (U)
  - **Confidentiality Impact**: None (N)
  - **Integrity Impact**: None (N)
  - **Availability Impact**: High (H)

## Solution

Upgrade to the following Kernel versions to mitigate the vulnerability:

- **Kernel 7.45, 7.49, or 7.53** (ABAP Server 7.40 to 7.52 or ABAP Platform)
- **Kernel 7.73 or 7.77** (ABAP Platform 7.53 or 7.54)

These versions include default settings for `ixml/dtd_restriction` and `ixml/xml_expansion_factor` to implement graceful behavior. SAP applications handle the new error situations by implementing interfaces as detailed in [SAP Security Note 1594475](https://me.sap.com/notes/1594475) and [SAP Note 1712860](https://me.sap.com/notes/1712860). It is recommended to review custom-developed applications accordingly.

*Note: The correction for Kernel 7.53 is also included in [Stack Kernel 753 PL501](https://me.sap.com/notes/2876647).*

## References

- [SAP Note 2736825](https://me.sap.com/notes/2736825) - [CVE-2019-0271] Denial of Service via XML External Entity (XXE) vulnerability in ABAP Server

## Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000199162020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002870067?language=en-US&token=2089D7B203BF100AD97D756F1B97FED4)

## Additional Information

- **Category**: Program error
- **Priority**: Correction with medium priority
- **Status**: Released for Customer
- **Released On**: 11.02.2020

_Credits to [redrays.io](https://redrays.io) for support to provided information._