2865348 - [CVE-2020-6306] Missing Authorization check in SAP Leasing

**Summary**

SAP Security Note 2865348 addresses a missing authorization check in transaction FIEH01 within SAP Leasing (FI-LA).

**Details**

- **CVE:** [CVE-2020-6306](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6306)
- **CVSS Score:** 2.7 (Low)
- **CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N
- **Affected Components:**
  - SAP_APPL 618
  - EA-APPL versions 600 through 617

**Description**

The authorization check is not performed when transaction FIEH01 is executed from the customer end, potentially allowing unauthorized access.

**Solution**

To mitigate this issue, additional switchable authorization checks have been implemented and are delivered inactive by default. Follow these steps to resolve the vulnerability:

1. **Download the SAP Note:**
   - [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000044282020)
   - [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002865348?language=en-US&token=A64A79BFC68F5E1664686F1C41B5F008)

2. **Apply Support Packages:**
   Ensure that the relevant support packages are applied for your software component versions. Refer to the appropriate [Support Package](https://me.sap.com/supportpackage/SAPKGPAD33) based on your system's version.

3. **Activate Switchable Authorization Checks:**
   Follow the correction instructions to manually activate the additional authorization checks via transaction SACF.

   **Manual Steps:**
   - Start transaction `SACF`.
   - Enter "FI_LA" as the scenario name and select "Scenario Definition".
   - Double-click on the `FI_LA` entry, then click "Change".
   - Use the "New" button to add the following authorization objects:
     - F_BKPF_BED
     - F_BKPF_BUK
     - F_KNA1_BED
     - F_KNA1_BUK
   - Select all new entries and set their status to "Check active without restrictions".
   - Save your changes.

**References**

- [SAP Security Note 2865348](https://me.sap.com/notes/2865348)

*Credits to [Redrays](https://redrays.io) for support in providing this information.*