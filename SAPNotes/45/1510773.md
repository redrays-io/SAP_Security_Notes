1510773 - Directory Traversal in RFC modules in classification

**Description**

The RFC modules in classification (function group CLBA) contain a vulnerability that allows a malicious user to perform directory traversal, potentially writing arbitrary files on the remote server. This can lead to data corruption or alteration of system behavior.

**Reason and Prerequisites**

The function modules `CLBA_CLASSIF_FILE_REMOTE_HOST` and `CLBA_UPDATE_FILE_REMOTE_HOST` do not correctly validate the path where user-submitted files are written, allowing an attacker to overwrite data on the remote system.

**Solution**

Implement the changes according to the advanced correction provided in this note. Additionally, refer to [Note 1497003](https://me.sap.com/notes/1497003), as the program changes from that note are prerequisites for this note.

**References**

This document refers to:

- [1514017 - Directory Traversal in transactions CL6E and CL6F](https://me.sap.com/notes/1514017)
- [1512352 - Directory Traversal in batch input reports in class system](https://me.sap.com/notes/1512352)
- [1509794 - Directory Traversal in transactions CL6E and CL6F](https://me.sap.com/notes/1509794)
- [1509235 - Directory Traversal in RFC modules in classification](https://me.sap.com/notes/1509235)
- [1499042 - Directory Traversal in batch input reports in class system](https://me.sap.com/notes/1499042)
- [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Support Packages**

- [SAPKA70206 for SAP_ABA 702](https://me.sap.com/supportpackage/SAPKA70206)
- [SAPKA73002 for SAP_ABA 730](https://me.sap.com/supportpackage/SAPKA73002)

**Download**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008952532017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001510773?language=en-US&token=67762F0B75A1CBFF7E7A9D555A0D5CF7)

**Translations**

Available in:
- [日本語](https://me.sap.com/notes/0001510773/J)
- [Deutsch (Origin)](https://me.sap.com/notes/0001510773/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0001510773/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001510773/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001510773/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001510773/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001510773/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001510773/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001510773/3)

**Side Effects**

- **Solves:** [1509235 - Directory Traversal in RFC modules in classification](https://me.sap.com/notes/1509235)
- **Causes:** [1512352 - Directory Traversal in batch input reports in class system](https://me.sap.com/notes/1512352)

**Credits**

Special thanks to [Redrays](https://redrays.io) for supporting the provision of this information.