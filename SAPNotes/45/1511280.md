1511280 - Unauthorized usage of application functionality in IS-U-WA

# Unauthorized Usage of Application Functionality in IS-U-WA (SAP Note 1511280)

## Symptom
A malicious user can trigger functionality in **IS-U-WA** without proper authentication and authorization.

## Other Terms
- **Cross-Site Request Forgery (CSRF/XSRF)**
- **IS-U-WA**

## Reason and Prerequisites
The **IS-U-WA** module executes certain functions by referencing specific URLs. An attacker can exploit this by tricking an authenticated user's browser into making a request with a crafted URL and specific parameters. This results in the unauthorized execution of functions with the user's privileges.

Potential attack vectors include:
- **Cross Site Scripting (XSS)** attacks to trigger the exploit.
- Presenting a malicious link for the victim to click.

The **ITS-Service EWHV_WASTE** within the **EEWA** package, designed to display detailed information for waste objects, is vulnerable. It can be manipulated to replace generated HTML content or inject scripts to submit unauthorized `OK_CODE` commands or steal the current session.

To mitigate this, the connected **SICF-Node EWHV_WASTE** has been modified to:
- Prohibit any `OK_CODE` handling.
- Prevent session stealing within the ITS-Service.

## Solution
1. **Refer to Note [1481392](https://me.sap.com/notes/1481392)** for additional information and instructions. Implementing the corrections from this note is a prerequisite for applying this security note.
2. **Implement the correction instructions of this note**. This will create the report `ITS_XSRF_PARAM_ISUWA` in your system.
3. **Execute the report `ITS_XSRF_PARAM_ISUWA`** and provide a corresponding transport request number when prompted. The report will:
   - Add service parameters for the adapted ITS services.
   - These services can be maintained via the GUI configuration pushbutton within the **SICF** transaction.

## References
- This document refers to [SAP Note 1512891](https://me.sap.com/notes/1512891) titled "CIC: Unauthorized usage of application functionality".

## Supported Software Components
- **IS-UT** versions: 600, 602, 603, 604, 605

## Support Packages
- **IS-UT 600:** [SAPK-60019INISUT](https://me.sap.com/supportpackage/SAPK-60019INISUT)
- **IS-UT 602:** [SAPK-60209INISUT](https://me.sap.com/supportpackage/SAPK-60209INISUT)
- **IS-UT 603:** [SAPK-60308INISUT](https://me.sap.com/supportpackage/SAPK-60308INISUT)
- **IS-UT 604:** [SAPK-60409INISUT](https://me.sap.com/supportpackage/SAPK-60409INISUT)
- **IS-UT 605:** [SAPK-60503INISUT](https://me.sap.com/supportpackage/SAPK-60503INISUT), [SAPK-60504INISUT](https://me.sap.com/supportpackage/SAPK-60504INISUT)

## Correction Instructions
- **Software Component:** IS-UT
- **Number of Correction Instructions:** 1
- **Details:** [Correction Instructions 951](https://me.sap.com/corrins/0001511280/951)

## CVSS
- **CVSS Score:** 0  
- **CVSS Vector:** Not provided

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*