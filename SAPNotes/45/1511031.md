SAP Security Note 1511031: Unauthorized usage of application functionality in WFM

```markdown
**SAP Security Note 1511031: Unauthorized usage of application functionality in WFM**

**Symptom**

A malicious user can trigger functionality in CA-GTF-WFA (WFM) without proper authentication and authorization.

**Reason and Prerequisites**

WFM (CA-GTF-WFA) executes certain functions by referencing specific URLs. If an attacker tricks an authenticated user's browser into making a request containing a specific URL and parameters, the function executes with the user's privileges. This vulnerability can be exploited via Cross-Site Request Forgery (XSRF) or by using a Cross-Site Scripting (XSS) attack to trigger the exploit.

**Solution**

To address the XSRF vulnerability, apply the following steps included in the current Support Package:

1. **Apply XSRF Protection Framework**
   - Ensure you have applied [Note 1450166](https://me.sap.com/notes/1450166) which provides an overview and details on the XSRF Protection Framework for SAP NetWeaver Application Server Java (AS Java).

2. **Update Configuration and JSP Files**
   - **Configuration File:**
     - Download and copy the `xsrf-config.xml` file from the attachments into the `/WEB-INF` directory of your WFM application.
   - **JSP Files:**
     - Replace the existing JSP files with the updated versions provided in the attachments. These enhanced pages include tokens attached to state-critical actions either as URL parameters or hidden form fields.
     - If you have customized JSP pages for branding or other purposes, manually integrate the token changes to ensure XSRF protection without losing your customizations.

3. **Handle Custom or Additional State-Changing Actions**
   - For any custom pages or additional state-changing actions:
     - **Configure Actions:**
       - Add the new actions to the `xsrf-config.xml` file as per the guidelines in [Note 1450166](https://me.sap.com/notes/1450166).
     - **Include Tokens:**
       - Ensure that all state-changing actions include the necessary URL parameters or hidden form fields to incorporate the XSRF tokens.

**Affected SAP Delivered JSP Pages in WFM (CA-GTF-WFA)**

The following JSP pages are affected and require updates:

- `swapshifts.jsp`
- `isv.jsp`
- `replacements.jsp`
- `scheduleevents.jsp`
- `startup.jsp`
- `ewsvpopup.jsp`
- `weeklyschedule.jsp`
- `scheduletrack.jsp`
- `corecoverage.jsp`
- `tasks.jsp`
- `Config.jsp`
- `ophours.jsp`
- `status.jsp`
- `/aslForecasting/forecast/forecastAdjust.jsp`
- `/aslForecasting/startup/startup.jsp`
- `/aslForecasting/workload/workloadAdjust.jsp`
- `/employee/pa/hire/pa.jsp`
- `/employee/pa/rehire/parehire.jsp`
- `/employee/pa/terminate/paterminate.jsp`
- `/employee/pa/transfer/patransfer.jsp`
- `/employee/pa/update/paupdate.jsp`
- `/employee/profile/profile.jsp`
- `contracts.jsp`
- `workRules.jsp`
- `timeoff.jsp`
- `work_area_qual.jsp`
- `budgetconstraints.jsp`
- `manualinput.jsp`
- `modify.jsp`
- `parameters.jsp`
- `dailyschedule.jsp`
- `availShifs.jsp`
- `dataServiceConfig.jsp`
- `iTimeClock.jsp`
- `mngoveride.jsp`
- `ArchiveTimeData.jsp`
- `Overide.jsp`
- `Punches.jsp`
- `benadjpopup.jsp`
- `dbUtil.jsp`

**Attachments**

- [xsrf-config-itcadmin.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000393442010&iv_version=0005&iv_guid=B56FF375937F424286246B73A5BA2829)
- [xsrf-config-wfmcs.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000393442010&iv_version=0005&iv_guid=3F4E90822CBE8742A95FD01163479C03)
- [xsrf-config-wfm.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000393442010&iv_version=0005&iv_guid=4629B731F9DA6D408ECEBA4D947C2980)
- [xsrf-config-itc.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000393442010&iv_version=0005&iv_guid=EFFB3B571B81DC488A8F4C53B70C6BDD)

**References**

- [Unauthorized usage of application functionality (Note 1450166)](https://me.sap.com/notes/1450166)

**Download**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017215232017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001511031?language=en-US&token=7AC768326883E94B8DB77337EE6F656F)

For more information and to apply the necessary corrections, visit the [SAP Support Portal](https://me.sap.com/).

---

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*
```