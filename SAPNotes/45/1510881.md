SAP Security Note 1510881: Unauthorized usage of Utility-application functionality

**SAP Security Note 1510881**

**Title:** Unauthorized usage of Utility-application functionality

**Description:**

### Symptom
A malicious user can trigger functionality in the Utility PC-UI applications without authentication and authorization.

### Other Terms
Cross-Site Request Forgery (XSRF), Utilities, PC-UI, BSP

### Reason and Prerequisites
The Utility PC-UI application executes certain functions through referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the user.

If present, the attacker may use a Cross Site Scripting attack to trigger the exploit, or use an approach in which a link to click is presented to the victim.

### Solution
The issue can be fixed by applying the attached manual correction instructions.

**Download Links:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008953272017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001510881?language=en-US&token=9E04FF01AB0D8E839B52B26E37E18BD3)

**References:**

- [SAP Note 1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)
- [SAP Note 1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)

**Validity:**

**Software Components:**

- BBPCRM 400
- BBPCRM 500
- BBPCRM 520
- BBPCRM 600
- BBPCRM 700
- BBPCRM 701

**Support Packages:**

- **BBPCRM 400:** [SAPKU40018](https://me.sap.com/supportpackage/SAPKU40018)
- **BBPCRM 500:** [SAPKU50018](https://me.sap.com/supportpackage/SAPKU50018)
- **BBPCRM 520:** [SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011)
- **BBPCRM 600:** [SAPKU60009](https://me.sap.com/supportpackage/SAPKU60009)
- **BBPCRM 700:** [SAPKU70009](https://me.sap.com/supportpackage/SAPKU70009)
- **BBPCRM 701:** [SAPKU70103](https://me.sap.com/supportpackage/SAPKU70103)

**Correction Instructions:**

**Software Component:** BBPCRM  
**Number of Correction Instructions:** 5  
[View Correction Instructions](https://me.sap.com/corrins/0001510881/63)

**Manual Activities:**

```plaintext
1) Goto transaction SE80 and choose "BSP Application" within the Repository Browser.

2) Choose Application "BSP_COP_EXCEL".

3) Tick-mark the "XSRF Protection" flag on the "properties" tab of the BSP.

4) Clear the field "Initial BSP".

5) Save & activate the application.

6) Repeat steps 3) to 5) for BSP Applications "BSP_GRAPHICS", "BSP_ISU_PROFILE", "BSP_POD_PROFILE", "GPI_CALL" and "OFFER_CALC_EXC".

------------------------------------------------------------------------
| Manual Activity                                                         |
------------------------------------------------------------------------
| VALID FOR                                                               |
| Software Component  BBPCRM           BBP / CRM                           |
| Release 701 Until SAPKU70102                                            |
------------------------------------------------------------------------

1. Refer to [SAP Note 1520324](https://me.sap.com/notes/1520324) for additional information and instructions. The corrections from this note are a prerequisite for implementation of this note.
2. Implement the correction instructions of this note. This will also create the report BSP_XSRF_PARAM_CRM_IU in your system.
3. Execute the report BSP_XSRF_PARAM_CRM_IU and specify when requested a corresponding transport request number. The report will fill the database table BSPTEMPXSRFSTORE with corresponding table entries for the BSP applications adapted by this note.
```

**Credits:**  
Thanks to [redrays.io](https://redrays.io) for support in providing this information.