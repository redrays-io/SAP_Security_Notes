SAP Security Note 1510789: Travel Expenses: Potential directory traversal

**Title:**  
1510789 - Travel Expenses: Potential directory traversal

**Description:**  
Travel expenses management contains a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behaviour.

**Symptom:**  
Travel expenses management fails to correctly validate the path to which a user-submitted file is written. As a result, a malicious user can potentially overwrite data in the remote system.

**Solution:**  
See [Note 1497003](https://me.sap.com/notes/1497003) for more information. The corrections from Note 1497003 are a prerequisite for this note.

This note creates the following logical file names to check the physical file names:
- `FI_TV_RPRCCC00_FILE`
  - Programs:
    - RPRCCC00 "Import of Credit Card Data (Credit Card Clearing)"
    - RPRCCC_CREATE_TESTFILE "Create a test file for credit card clearing"
    - RPRCCC_CREATE_CORRECTION_FILE
  - Logical Path:
    - FI_TV_CCC_FILES
- `FI_TV_RPRIRB00_30_FILE`
  - Programs:
    - RPRIRB00_30
    - RPRC50R3
  - Logical Path:
    - FI_TV_POSTING_RUN_FILES
- `FI_TV_RPRFIN00_30_FILE`
  - Programs:
    - RPRFIN00_30
    - RPREPR3C
  - Logical Path:
    - FI_TV_POSTING_RUN_FILES
- `FI_TV_CCC_AMEX_FILE`
  - Programs:
    - RPRCCC_READ_BTA
    - RPRCCC_READ_KR1025
  - Parameters:
    - `<PARAM_1>` The "Company ID" field of the selection screen
  - Logical Path:
    - FI_TV_CCC_AMEX_FILES
- `FI_TV_RPRTAX_FILE`
  - Programs:
    - RPRTAX_FINLAND
  - Logical Path:
    - FI_TV_RPRTAX_FILES

**Actions:**  
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008952622017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001510789?language=en-US&token=D51FF27F0F4887C55D9E5D962305F400)
- Share by Email
- Open in New Window

**References:**  
This document refers to:
- [1507935 - HCM: Potential Directory Traversal Internat. Payroll PY-XX](https://me.sap.com/notes/1507935)
- [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Prerequisites:**  
- [1498832 - FI: Potential Directory Traversal](https://me.sap.com/notes/1498832)
- [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)
- [1507935 - HCM: Potential Directory Traversal Internat. Payroll PY-XX](https://me.sap.com/notes/1507935)

**Support Packages:**  
- [SAPK-110B3INEAHRGXX](https://me.sap.com/supportpackage/SAPK-110B3INEAHRGXX) for EA-HRGXX 110
- [SAPK-20094INEAHRGXX](https://me.sap.com/supportpackage/SAPK-20094INEAHRGXX) for EA-HRGXX 200
- [SAPKE46BE1](https://me.sap.com/supportpackage/SAPKE46BE1) for SAP_HR 46B
- [SAPKE46CG8](https://me.sap.com/supportpackage/SAPKE46CG8) for SAP_HR 46C
- [SAPK-50079INEAHRGXX](https://me.sap.com/supportpackage/SAPK-50079INEAHRGXX) for EA-HRGXX 500
- [SAPK-60062INEAHRGXX](https://me.sap.com/supportpackage/SAPK-60062INEAHRGXX) for EA-HRGXX 600
- [SAPK-60241INEAHRGXX](https://me.sap.com/supportpackage/SAPK-60241INEAHRGXX) for EA-HRGXX 602
- [SAPK-60336INEAHRGXX](https://me.sap.com/supportpackage/SAPK-60336INEAHRGXX) for EA-HRGXX 603
- [SAPK-60428INEAHRGXX](https://me.sap.com/supportpackage/SAPK-60428INEAHRGXX) for EA-HRGXX 604
- [SAPK-60505INEAHRGXX](https://me.sap.com/supportpackage/SAPK-60505INEAHRGXX) and [SAPK-60504INEAHRGXX](https://me.sap.com/supportpackage/SAPK-60504INEAHRGXX) for EA-HRGXX 605

**CVSS:**  
- **Score:** 0  
- **Vector:** N/A

**Rating:**  
This document has not been rated yet.

*Credits to [RedRays.io](https://redrays.io) for supporting the information provided.*