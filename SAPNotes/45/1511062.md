SAP Security Note 1511062 - Unauthorized usage of application functionality in IS-HER-CM

**Description**

A malicious user can trigger functionality in IS-HER-CM without proper authentication and authorization, potentially exploiting the system's vulnerabilities.

**Symptom**

- Ability to execute certain functions in IS-HER-CM without authentication.
- Exploitation can occur through specific URLs and parameters.

**Other Terms**

- Cross-Site Request Forgery (XSRF)
- Cross Site Scripting (XSS)
- IS-HER-CM

**Reason and Prerequisites**

IS-HER-CM performs specific functions by referencing certain URLs. An attacker can trick an authenticated user's browser into making a request with these URLs and parameters, causing the function to execute with the user's privileges. This can be achieved via:
- Cross Site Scripting (XSS) attacks.
- Presenting malicious links to the victim.

**Solution**

1. **Refer to [SAP Note 1520324](https://me.sap.com/notes/1520324)** for additional information and instructions. Implementing the corrections from this note is a prerequisite for applying this note.
2. **Implement the correction instructions** provided in this note. This will create the report `BSP_XSRF_PARAM_PMIQ_<release>` in your system.
3. **Execute the report `BSP_XSRF_PARAM_PMIQ_<release>`** and provide a corresponding transport request number when prompted. This will populate the `BSPTEMPXSRFSTORE` database table with the necessary entries for the BSP applications modified by this note.

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008954202017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001511062?language=en-US&token=02723C1F731FC063CEF844603B0A4573)
- [Share by Email](https://me.sap.com/)
- [Open in New Window](https://me.sap.com/)

**References**

- **This document refers to:**
  - [SAP Note 1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)

**Validity**

Applicable to the following software components:
- IS-PS-CA versions 472, 600, 602, 603, 604, 605

**Support Package**

Relevant support packages can be found [here](https://me.sap.com/supportpackage/SAPKIPQH20).

**Correction Instructions**

Detailed correction instructions are available [here](https://me.sap.com/corrins/0001511062/64).

For more detailed information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*