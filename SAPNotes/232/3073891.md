3073891 - [CVE-2021-33672] Multiple vulnerabilities in SAP Contact Center

## Symptom

This SAP Security Note addresses several vulnerabilities identified in SAP Contact Center. The vulnerability details along with their CVE relevant information are as follows:

### OS Command Injection

Due to missing encoding in SAP Contact Center’s Communication Desktop component, an attacker could send a malicious script in a chat message. When the message is accepted by the chat recipient, the script gets executed in their scope. Due to the usage of ActiveX in the application, the attacker can further execute operating system level commands in the chat recipient’s scope. This could lead to complete compromise of their confidentiality, integrity, and could temporarily impact their availability.

- **CVE-2021-33672**
  - **CVSS:** 9.6
  - **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L
  - [More Details](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33672)

### OS Command Injection

Under certain conditions, SAP Contact Center does not sufficiently encode user-controlled inputs and persists them. This allows an attacker to exploit a Stored Cross-Site Scripting (XSS) vulnerability when a user browses through the employee directory and to execute arbitrary code on the victim’s browser. Due to the usage of ActiveX in the application, the attacker can further execute operating system level commands.

- **CVE-2021-33673**
  - **CVSS:** 8.3
  - **Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:L
  - [More Details](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33673)

### Reflected Cross-Site Scripting (XSS)

Under certain conditions, SAP Contact Center does not sufficiently encode user-controlled inputs. This allows an attacker to exploit a Reflected Cross-Site Scripting (XSS) vulnerability when creating a new email and to execute arbitrary code on the victim’s browser.

- **CVE-2021-33674**
  - **CVSS:** 6.5
  - **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L
  - [More Details](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33674)

### Reflected Cross-Site Scripting (XSS)

Under certain conditions, SAP Contact Center does not sufficiently encode user-controlled inputs. This allows an attacker to exploit a Reflected Cross-Site Scripting (XSS) vulnerability through phishing and to execute arbitrary code on the victim’s browser.

- **CVE-2021-33675**
  - **CVSS:** 6.1
  - **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  - [More Details](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33675)

## Reason and Prerequisites

The vulnerabilities are caused due to lack of proper encoding of user’s input.

## Solution

1. **Proper Encoding:** Implement proper encoding of content.
2. **Apply Hotfix:**
   - Download and implement the hotfix relevant to your SAP version.
   - SAP provides fixes for versions dating back to a maximum of 24 months.
   - **FP14** is currently the latest version that subscribes to the above condition.
   - **Relevant SAP NOTES:**
     - **FP14:** [SAP NOTE 3060146](https://me.sap.com/notes/3060146) / Hotfix 7.0.14.18
     - **FP15:** [SAP NOTE 3060145](https://me.sap.com/notes/3060145) / Hotfix 7.0.15.11
     - **FP16:** [SAP NOTE 3033793](https://me.sap.com/notes/3033793) / Hotfix 7.0.16.114
3. **Additional Resources:**
   - [SAP Contact Center Related SAP Notes and Hotfixes](https://me.sap.com/wiki/display/ATopics/SAP+Contact+Center+Related+SAP+Notes+and+Hotfixes)

## Workaround

- **Assess Applicability:** Please assess the workaround applicability for your SAP landscape prior to implementation.
- **Temporary Fix:**
  - This workaround is a temporary fix and is not a permanent solution.
  - SAP strongly recommends applying the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.
- **Specific Workarounds:**
  - **For CVE-2021-33672 (CVSS 9.6):**
    - Cease using the web chat and any integrations utilizing it.
    - Isolate the related network endpoint from the Internet.
  - **For CVE-2021-33673 (CVSS 8.3):**
    - Limit rights of regular users so that they cannot create sub-directories.
    - Refer to [User Rights Management](https://me.sap.com/help/b382b7dce2774c9aafdfda69f740b975/7.0/en-US/b563f9e1d7e84fd893217dc0d9192725.html) for more details.

## Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001318482021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003073891?language=en-US&token=8E4F237EC4606747C3DFC4ED5C4D4160)

For editing the note, refer to [Edit Note 3073891](https://me.sap.com/notes/0003073891/Edit).

## References

- [SAP Note 3082382 - Multiple vulnerabilities in SAP Contact Center: FAQ](https://me.sap.com/notes/3082382)

## CVSS Details

- **CVSS Score:** 9.6
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:L
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** Low (L)

---

*Credits to [Redrays](https://redrays.io) for support in providing this information.*