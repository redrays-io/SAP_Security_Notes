SAP Security Note 3078312 - [CVE-2021-33701] SQL Injection Vulnerability in SAP NZDT Row Count Reconciliation

**Symptom**

DMIS Mobile Plug-In or SAP S/4HANA allows an attacker with access to a highly privileged account to execute manipulated queries in the NZDT tool to gain access to the Backend Database.

**Other Terms**

- Injection attack
- Blind SQL injection
- Database vulnerabilities
- [CVE-2021-33701](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33701)

**Reason and Prerequisites**

The system has either installed the DMIS Mobile Plug-In or is an SAP S/4HANA system.

**Solution**

Implement the automatic correction instructions in transaction SNOTE. An ASSERT statement will be added directly after the authorization check of function module `IUUC_RECON_RC_COUNT_TABLE_BIG` that enforces the import parameter `IT_WHERE_CLAUSE` to be empty. If `IT_WHERE_CLAUSE` is not empty, the execution of the function module will fail with a short dump.

**Workaround**

Please assess the workaround applicability for your SAP landscape prior to implementation. This workaround is a temporary fix and not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.

As a workaround for systems with software component version SAP_BASIS 740 or higher and active Unified Connectivity (UCON) runtime checks, the following steps can be applied:

1. In transaction UCONPHTL, search for remote-enabled function module `IUUC_RECON_RC_COUNT_TABLE_BIG`.
2. Ensure that the phase status for `IUUC_RECON_RC_COUNT_TABLE_BIG` is set to "Final".
3. Check whether `IUUC_RECON_RC_COUNT_TABLE_BIG` has been assigned to a communication assembly (CA).
4. If assigned, enter change mode and unassign the function module from the CA.

**CVSS**

- **Score:** 9.1
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)

**References**

- [SAP Note 3078312 on me.sap.com](https://me.sap.com/notes/3078312)
- [FAQ Note 3080305](https://me.sap.com/notes/3080305)

**Support Packages**

Refer to the SAP Note for detailed support package information.

**Release Information**

- **Released On:** 10.08.2021
- **Priority:** HotNews
- **Status:** Released for Customer
- **Component:** BC-UPG-NZ (Basis Components > Upgrade - general > Component for problems related to NZDT procedure.)

**Credits**

Credits to [redrays.io](https://redrays.io) for support to provided information.