SAP Security Note 3074693: Missing XML Validation in SAP BusinessObjects Business Intelligence Platform (Crystal Reports)

**SAP Security Note 3074693** addresses a critical vulnerability in the SAP BusinessObjects Business Intelligence Platform (Crystal Reports). This vulnerability, identified as [CVE-2021-40500](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40500), involves missing XML validations at certain endpoints, allowing unauthenticated attackers to read sensitive data and retrieve arbitrary files from the server.

### **Symptom**
SAP BusinessObjects Business Intelligence Platform (Crystal Reports) lacks proper XML validation, enabling unauthenticated attackers to exploit exposed endpoints over the network. Successful exploitation can lead to unauthorized data access and file retrieval from the server.

### **Reason and Prerequisites**
The vulnerability arises when a Crystal Report is created from an untrusted XML or web service data source without adequate validation.

### **Solution**
The XML parser has been securely configured to disallow external entities in incoming XML documents. To mitigate this vulnerability, implement the **Support Packages and Patches** referenced in this SAP Note.

### **Affected Components**
- **SAP BusinessObjects Business Intelligence Platform**
  - Versions: 4.2, 4.3
  - Components: Crystal Reports

### **Support Package Patches**
Ensure that the following patches are applied to your SAP components:
- **SBOP BI PLATFORM SERVERS 4.2**
  - SP009 Patch Level 000400
  - [Download Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
- **SAP CRYSTAL REPORTS 2016**
  - SP009 Patch Level 000400
  - [Download Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200001117&V=MAINT)
- (Additional patches available in the Support Package Patch section of the SAP Note)

### **CVSS Score**
- **Score:** 6.9
- **Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:L/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

### **Download and Print Options**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001453662021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003074693?language=en-US&token=02D9AC05953743E6AD46C47E037A899D)

### **Additional Information**
- **Release Date:** October 12, 2021
- **Priority:** Correction with medium priority
- **Release Status:** Released for Customer
- **Component:** BI-RA-CR-DB (Business intelligence solutions > Reporting, analysis, and dashboards > Crystal Reports designer or Business View Manager > Database and Data Connection)

For more details and to implement the necessary patches, visit the [SAP Security Notes](https://me.sap.com/servicessupport/knowledge) page.

*Thanks to [Redrays](https://redrays.io) for support in providing this information.*