3079427 - [CVE-2021-38180] CSV Injection in SAP Business One

**Symptom**

SAP Business One allows an attacker to inject formulas when exporting data to Excel (CSV injection) due to improper sanitation during the data export. An attacker could thereby execute arbitrary commands on the victimâ€™s computer but only if the victim allows the execution of macros while opening the file and the security settings of Excel allow for command execution.

**Other Terms**

CSV, Excel, Macro, Export, [CVE-2021-38180](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38180)

**Solution**

*The export now properly sanitizes the data by adding a single quote in front of data starting with a special character. Customers should implement or upgrade to SAP Business One 10.0 PL2108.*

The patches can be found on the [SAP ONE Support Launchpad](https://launchpad.support.sap.com/#/softwarecenter).

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001453692021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003079427?language=en-US&token=1D32E2039C74CA84F284CC89DD3CAF56)

**CVSS**

- **Score:** 6.5
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L

**Software Components Affected**

- B1_ON_HANA 10.0
- SAP-M-BO 10.0

*Credits to [RedRays](https://redrays.io) for supporting the provided information.*