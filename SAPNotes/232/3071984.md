3071984 - [CVE-2021-33698] Unrestricted File Upload Vulnerability in SAP Business One

---

### Symptom

**UPDATE 24th August 2021**: This note has been re-released with updated 'Solution' information. We have made some corrections in the Workaround section.

SAP Business One allows an attacker with business authorization to upload any files (including script files) without the proper file format validation.

### Other Terms

- Upload of untrusted files
- File upload vulnerability
- [CVE-2021-33698](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33698)

### Solution

SAP Business One enhances the validation of related parameters. Customers need to implement or upgrade to SAP Business One FP2105 Hotfix1.

The patches can be found on the [SAP ONE Support Launchpad](https://launchpad.support.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=N&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=01200314694400000358&V=INST&TA=ACTUAL&ROUTENAME=products/SAP%20Business%20One%20-%20SAP%20Business%20One%20Products).

### Workaround

Please assess the workaround applicability for your SAP landscape prior to implementation.

*Note that this workaround is a temporary fix and is not a permanent solution. SAP strongly recommends you to apply the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.*

1. On the machine where the B1 client and gatekeeper are installed, create a shared folder and grant read and write permissions to admin users only.
2. Navigate to `Control Panel\All Control Panel Items\System`, open **Advanced system settings**, click **Environment Variables**, and under **System variables**, create a new system variable:
   - **Variable name**: `B1GS_TMP_DIR`
   - **Variable value**: `\\<yourmachine>\<sharefolder>`
3. Open the B1 client, go to **Administration > System Initialization > General Settings > Path** tab, and change the **Attachments Folder** to the shared folder created in step 1.
4. Navigate to `Control Panel\All Control Panel Items\Administrative Tools`, open **Services**, and restart **SAP Business One Browser Access Server Gatekeeper (64-bit)**.

### Attributes

- **Externally Reported**: Yes

### CVSS

- **CVSS Score**: 9.9
- **CVSS Vector**: [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://me.sap.com/notes/0003071984/#cvss-vector)

  - **Attack Vector (AV)**: Network (N)
  - **Attack Complexity (AC)**: Low (L)
  - **Privileges Required (PR)**: Low (L)
  - **User Interaction (UI)**: None (N)
  - **Scope (S)**: Changed (C)
  - **Confidentiality Impact (C)**: High (H)
  - **Integrity Impact (I)**: High (H)
  - **Availability Impact (A)**: High (H)

### References

- [Q&A for SAP Security Note 3071984](https://me.sap.com/notes/3077891)

### Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001143742021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003071984?language=en-US&token=92D362D1F94E3484323B49A1DCBC8F7C)
- [Show Changes](https://me.sap.com/notesLatestChanges/0003071984/E/diff)

### Available Languages

- **Japanese (J)** - [Link](https://me.sap.com/notes/0003071984/J)
- **Deutsch (D)** - Machine Translation - [Link](https://me.sap.com/notes/0003071984/D)
- **Português (P)** - Machine Translation - [Link](https://me.sap.com/notes/0003071984/P)
- **Español (S)** - Machine Translation - [Link](https://me.sap.com/notes/0003071984/S)
- **Français (F)** - Machine Translation - [Link](https://me.sap.com/notes/0003071984/F)
- **Italiano (I)** - Machine Translation - [Link](https://me.sap.com/notes/0003071984/I)
- **Русский (R)** - Machine Translation - [Link](https://me.sap.com/notes/0003071984/R)
- **中文 (1)** - Machine Translation - [Link](https://me.sap.com/notes/0003071984/1)
- **한국어 (3)** - Machine Translation - [Link](https://me.sap.com/notes/0003071984/3)

### Rating

- **Rated Helpful**: 0 people
- **Quality Rating**: 0.0 (0 Votes)

### Side Effects

- **This document solves side effects**: None
- **This document is causing side effects**: None

---

Credits to [redrays.io](https://redrays.io) for support in providing this information.