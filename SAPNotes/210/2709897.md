SAP Security Note 2709897 - Directory Traversal vulnerability in SAP Enterprise Architecture Designer v1.0 SP04

---

### Symptom

SAP Enterprise Architecture Designer v1.0 SP04 allows an authenticated attacker to exploit insufficient validation of path information provided by users, thus characters representing 'traverse to parent directory' are passed through to the file APIs.

This could be achieved by injecting a maliciously crafted Zip file ("Zip Slip" CVE-2018-1002204).

Some well-known impacts of the Directory Traversal vulnerability include:

- Overwriting, deleting, or corrupting arbitrary files on the remote server

### Other Terms

Path traversal, backtracking, directory climbing, CVE-2018-8039, CVE-2018-1002204

### Reason and Prerequisites

SAP Enterprise Architecture Designer for SAP HANA is an application on SAP HANA extended application services, advanced model. Only servers having SAP HANA extended application services and SAP Enterprise Architecture Designer for SAP HANA installed are affected by the described issue.

### Solution

1. **Verify Affected Versions:**
   - Log in with the XS client tool and issue the `xs lc` command.
   - The installed version should be listed in the following format:
     ```
     Found software components:
     software component version
     ----------------------------------
     XSAC_HANA_EA_D (sap.com) 1.X.Y
     ```
     - **X** is the service pack number.
     - **Y** is the patch level.
   - **Versions below 1.4.3 are affected.**

2. **Apply the Fix:**
   - Apply **PL03**: "SAP Enterprise Architecture Designer v1.0 SP04 PL03" or later versions.
   - This fix upgrades the zip processing library to a version not vulnerable to CVE-2018-1002204.

3. **Additional Fixes in PL03:**
   - **SECURITY:** Update Apache CXF to 3.2.6 to address CVE-2018-8039.
   - **SECURITY:** Update the `adm-zip` npm package to mitigate "Zip Slip" CVE-2018-1002204.
   - **LDAP Connection:** Resolves issues where some users cannot connect.

### CVSS

**CVSS Score:** 5.0

**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:L/A:N

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** None (N)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

### Support Package Patches

- **SAP EA DESIGN FOR SAP HANA 1.0**
  - **Support Package:** SP004
  - **Patch Level:** 000003
  - [Apply Patch](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200004907&support_package=SP004&patch_level=000003)

### Available Translations

- [Deutsch (Machine Translation)](https://me.sap.com/notes/0002709897/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002709897/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002709897/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002709897/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002709897/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002709897/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002709897/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002709897/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002709897/3)

### References

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000249942019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002709897?language=en-US&token=AE62BBA4519EB8C1EF9252C48466F1E7)

### Credits

Credits to [Redrays](https://redrays.io) for support in providing this information.

---