2718993 - [CVE-2018-2504] Cross-Site Scripting using host header in SAP NetWeaver AS Java

**Description**

A Cross-Site Scripting (XSS) vulnerability has been identified in the SAP NetWeaver AS Java Web Container service. This vulnerability arises from HTTP Host Header Manipulation, which can lead to unauthorized actions such as:

- Defacing or modifying website content temporarily.
- Stealing user authentication information, including session data.
- Impersonating users to access information with their privileges.

**Reason and Prerequisites**

The vulnerability stems from the implementation of the Servlet 2.5 specification in NetWeaver AS Java Web Container service. According to the specification, APIs that return host and port values read the host header if it exists. Validating the host header against a whitelist can result in incompatible behavior, making the system susceptible to manipulation.

**Solution**

To mitigate this vulnerability, configure the **ProxyMappings** property to ignore the host header information provided in requests. This prevents HTTP host header manipulation, even in environments without a proxy or load balancer. Follow these steps:

1. **Configure ProxyMappings:**

   ```
   50000=(Host:www.local.com,Port:50000,Scheme:http,Override:true),
   50001=(Host:www.local.com,Port:50001,Scheme:https,Override:true)
   ```

   - The `Override` attribute (default is `false`) is set to `true` to ensure that host and port information from requests are overridden by the specified properties.
   - If a proxy is already in use, ensure that the `Override` attribute remains set to `true`.

2. **Additional References:**
   
   - [Mapping Ports Documentation](https://me.sap.com/help/mapping-ports)
   - [KBA 1927272](https://me.sap.com/note/1927272)

**CVSS Score**

- **Score:** 6.1
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

**Affected Software Components**

- SERVERCORE versions 7.10 to 7.50

**Release Date**

- December 11, 2018

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000002397772018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002718993?language=en-US&token=0CE0295422E2E669FD4063B84DDD8664)

**Credits**

Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.