2719530 - [CVE-2019-0304] Code Injection vulnerability in SAP NetWeaver AS ABAP Platform (FTP Function)

## Symptom
The FTP Function of SAP NetWeaver AS ABAP Platform allows an attacker to inject code that can be executed by the application. An attacker could thereby control the behavior of the application.

**Impacts of Code Injection vulnerability include:**
- Unauthorized execution of commands
- Sensitive information disclosure
- Denial of Service

### Other Terms
- Command Injection
- OS Command Injection
- FTP_COMMAND, FTP_COMMAND_LIST
- [CVE-2019-0304](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0304)

## Reason and Prerequisites
The issue occurs only if the attacker has the authorization to modify the ABAP code calling functions `FTP_COMMAND` or `FTP_COMMAND_LIST`.

## Solution
SAPFTP program will check if the FTP command contains CR or LF. If yes, the part of the command after CR or LF will be removed.

**To get the fix, apply the corresponding patch:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001047902019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002719530?language=en-US&token=03C14CEFD7A4FFF3B99E365D71EBF0A8)

## CVSS
**Score:** 5.5  
**Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N)

**Metrics:**
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** High (H)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

## Affected Software Components
- **KRNL32NUC, KRNL32UC, KRNL64NUC, KRNL64UC, KERNEL** versions 7.21, 7.21EXT, 7.22, 7.22EXT, 7.49, 7.53, 7.73

For detailed information on supported versions and patches, visit the [Support Package Patches](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200007950&V=MAINT) section on the SAP Support Portal.

## References
- [SAP Note 2719530 on SAP Support Portal](https://me.sap.com/servicessupport/knowledge/2719530)

## Credits
Credits to [redrays.io](https://redrays.io) for support in providing this information.