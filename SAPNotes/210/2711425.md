SAP Security Note 2711425: CVE-2018-2505 - XSS Vulnerability in SAP Hybris Commerce Storefronts

**Symptom**

SAP Hybris Commerce does not sufficiently validate user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability in storefronts based on the product.

**Impacts of XSS Vulnerability:**
- Non-permanently deface or modify displayed content on a website
- Steal authentication information of the user, such as session data
- Impersonate the user and access all information with the same rights as the target user

**Affected Versions**

This vulnerability affects:
- **SAP Hybris Commerce** versions 6.2 through 6.7 and 18.08, including all but the latest patch releases.
- Installations of SAP Hybris Commerce based on the latest patch release remain secure unless they run a storefront based on an older, vulnerable version.

**Solution**

**Upgrade to the Latest Patch Release**

Users can protect their storefronts by upgrading to the latest patch releases. The following patch releases resolve this vulnerability:
- [SAP Hybris Commerce 6.2.0.27 Patch Release](https://jira.hybris.com/browse/PATCH-5315)
- [SAP Hybris Commerce 6.3.0.24 Patch Release](https://jira.hybris.com/browse/PATCH-5316)
- [SAP Hybris Commerce 6.4.0.18 Patch Release](https://jira.hybris.com/browse/PATCH-5240)
- [SAP Hybris Commerce 6.5.0.15 Patch Release](https://jira.hybris.com/browse/PATCH-5241)
- [SAP Hybris Commerce 6.6.0.12 Patch Release](https://jira.hybris.com/browse/PATCH-5242)
- [SAP Hybris Commerce 6.7.0.8 Patch Release](https://jira.hybris.com/browse/PATCH-5243)
- [SAP Commerce Cloud Patch Release 1808.3](https://jira.hybris.com/browse/PATCH-5244)

Download the corresponding [software downloads for SAP Hybris Commerce](https://me.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL) from the SAP Support Portal.

**Follow the Update Procedure:**
1. [Update Procedure for SAP Hybris Commerce Patch Releases](https://help.hybris.com/1808/hcd/8c25978386691014b4abdd61376acd24.html)
2. Include the smartedit extension when updating your installation.
3. After the update, perform additional manual steps to install the fix in all storefronts that integrate SmartEdit.

**Validating the Fix**
1. Ensure the `webApplicationInjector.js` file in your storefront matches the patched version.
2. Start the SAP Hybris Commerce server:
   - `./hybrisserver.sh` (Linux/Mac)
   - `hybrisserver.bat` (Windows)
3. Verify the `webApplicationInjector.js` file is updated by checking it in the browserâ€™s developer tools.

**Possible Workarounds**

If you cannot apply the patch immediately, consider the following temporary workarounds:
- **Remove the vulnerable `webApplicationInjector.js` file** from your storefronts.
- **Uninstall the old, vulnerable smarteditaddon AddOn** without installing the fixed version.
- **Block delivery of the vulnerable `webApplicationInjector.js`** using server-side configurations (e.g., HTTP reverse proxy, load balancer).

**References and Further Information**
- [SmartEdit Contract for Storefronts](https://me.sap.com/#/notes/0002711425/F)
- [Deploying New SAP Hybris Commerce Versions](https://help.hybris.com/1808/hcd/8bb0ad2786691014b930c18dd4cd7851.html)

**CVSS Details**
- **CVSS Score:** 9.3
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N)

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*