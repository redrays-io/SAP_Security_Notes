2719415 - Cross-Site Request Forgery (CSRF) vulnerability in SAP S/4 HANA for Advanced Compliance Reporting/ Run Advanced Compliance Report

---

## Symptom

SAP S/4 HANA for Advanced Compliance Reporting/ Run Advanced Compliance Report allows an attacker to trick an authenticated user into sending unintended requests to the web server. This vulnerability is due to insufficient CSRF protection.

Some well-known impacts of CSRF vulnerability are:

- Attacker could take actions on behalf of an authenticated user
- Loss of non-repudiation

## Other Terms

Open redirect, cross-site redirect, cross-domain redirect, XSRF, session riding, ACR, SRF, SAP S/4HANA for advanced compliance reporting, Run Compliance Reports, Run Advanced Compliance Reports, Function imports, httpMethod

## Reason and Prerequisites

Several function imports as part of OData services were discovered to be vulnerable to CSRF.

## Solution

- **HTTP Method Update:** Changed from `GET` to `POST` for the identified function imports.
- **XSRF Protection:** The XSRF protection framework is now properly utilized, ensuring that correct authentication tokens are present.

This Note is valid for the S/4HANA 1809 SP0 release.

**Recommendation:** SAP recommends installing the solution by applying a Support Package. If an earlier installation is needed, use the Note Assistant to implement the correction instructions. More information about the Note Assistant can be found on [SAP Service Marketplace](https://me.sap.com/service.sap.com/note-assistant).

## Affected Components

- **Component:** FI-LOC-SRF-RUN
- **Component Path:**
  - [Services & Support](https://me.sap.com/servicessupport)
  - [KBAs & Notes](https://me.sap.com/servicessupport/knowledge)
  - [Financial Accounting](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'FI*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)
  - [Country/Region-Specific Localizations](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'FI-LOC*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)
  - [Statutory Reporting](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'FI-LOC-SRF*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)
  - [Run Time (FI-LOC-SRF-RUN)](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'FI-LOC-SRF-RUN*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

## Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000155992019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002719415?language=en-US&token=7ACDE3BD11423178D4A9502C7FE6A800)
- [Share by Email](https://me.sap.com/share-email)
- [Open in New Window](https://me.sap.com/open-new-window)

## CVSS

- **Score:** 6.3
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L](https://www.first.org/cvss/v3.0)

  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** Low (L)

## Support Package

- **Software Component Version:** S4CORE 103
- **Support Package:** [SAPK-10301INS4CORE](https://me.sap.com/supportpackage/SAPK-10301INS4CORE)

## Correction Instructions

- **Software Component:** S4CORE
- **Number of Correction Instructions:** 1
- **URL:** [Correction Instruction](https://me.sap.com/corrins/0002719415/19773)

## Prerequisites

- **SAP Note 2710359:** [SAP S/4 HANA for advanced compliance reporting - Read Access Log Enabling for 1809 SP0](https://me.sap.com/notes/2710359)
- **SAP Note 2711149:** [Run Compliance Reports - Clarification Phase](https://me.sap.com/notes/2711149)
- **SAP Note 2713041:** [Usage Measurement for new features in Run Compliance Report](https://me.sap.com/notes/2713041)
- **SAP Note 2731887:** [Introduction of New Event](https://me.sap.com/notes/2731887)

## References

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000000155992019](https://notesdownloads.sap.com/note/0040000000155992019)
- **PDF Version:** [https://userapps.support.sap.com/sap/support/sfm/notes/print/0002719415?language=en-US&token=7ACDE3BD11423178D4A9502C7FE6A800](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002719415?language=en-US&token=7ACDE3BD11423178D4A9502C7FE6A800)

## Rating

- **Rated Helpful:** 0 people
- **Quality Rating:** 0.0 (No votes)

## Side Effects

- **Side Effects Causing:** None
- **Side Effects Solving:** None

---

Credits to [redrays.io](https://redrays.io) for support to provided information.