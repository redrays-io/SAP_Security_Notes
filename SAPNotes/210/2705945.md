2705945 - Cross-Site Request Forgery (CSRF) vulnerability in SAP S/4HANA for Advanced Compliance Reporting/ Run Advanced Compliance Report

---

## Summary

**SAP Note Number:** 2705945  
**Type:** SAP Security Note  
**Version:** 4  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 25.06.2019  
**Component:** Financial Accounting > Country/Region-Specific Localizations > Statutory Reporting > Run Time

## Description

### Symptom

**UPDATE 24th June 2019:** This note has been re-released with updated 'validity' information.

SAP S/4HANA for Advanced Compliance Reporting/Run Advanced Compliance Report allows an attacker to trick an authenticated user into sending unintended requests to the web server. This vulnerability is due to insufficient **CSRF** protection.

### Impact

Some well-known impacts of CSRF vulnerability are:

- Attacker could take actions on behalf of an authenticated user
- Loss of non-repudiation

### Reason and Prerequisites

Several function imports as part of OData services were discovered to be vulnerable to CSRF due to the HTTP method type used.

### Solution

The HTTP method types have been changed from 'GET' to 'POST' for the identified function imports, thereby protecting them from potential CSRF attacks.

**Installation Instructions:**

SAP recommends installing a solution by applying a Support Package. If you need to install the solution earlier, use the Note Assistant to implement the correction instruction. More information about the Note Assistant can be found on SAP Service Marketplace ([service.sap.com/note-assistant](https://me.sap.com/note-assistant)).

## CVSS Details

**CVSS Score:** 6.3  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L

- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** None (N)
- **User Interaction:** Required (R)
- **Scope:** Unchanged (U)
- **Confidentiality Impact:** Low (L)
- **Integrity Impact:** Low (L)
- **Availability Impact:** Low (L)

## References

### Referenced By

- [2736611 - SAP S/4HANA for Advanced Compliance Reporting - Electronic submission of ACR legal reports via SAP Localization Hub Advanced Compliance Reporting](https://me.sap.com/notes/2736611)
- [2688530 - SAP S/4HANA for Advanced Compliance Reporting - Security validation for Run Advanced Compliance Reports](https://me.sap.com/notes/2688530)
- [2689741 - SAP S/4HANA for Advanced Compliance Reporting - Change of HTTP method types of Function Imports in SRF_REPORTING_TASK](https://me.sap.com/notes/2689741)

## Correction Instructions

**Software Component:** S4CORE  
**Number of Correction Instructions:** 4  
**URL:** [Correction Instructions](https://me.sap.com/corrins/0002705945/19773)

**Manual Activities:**

This note has a dependency with UI note, so please implement the UI note - [2688530](https://me.sap.com/notes/2688530) along with this note.

## Prerequisites

**Software Component:** S4CORE  
**Valid From:** 102  
**Valid To:** 102  
**SAP Note/KBA:** [2581341 - Run Compliance Reports - Incorrect grouping of activities in completed phases](https://me.sap.com/notes/2581341)

## Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000087692019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002705945?language=en-US&token=C726C6BC24CC7A28FD3D0AD628D8B106)

## Credits

Credits to [redrays.io](https://redrays.io) for support to provided information.