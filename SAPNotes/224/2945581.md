SAP Security Note 2945581 - Cross-Site Scripting (XSS) Vulnerability in SAP CRM WebClient UI

**Symptom**
 
**UPDATE 8th December 2020:** This note has been re-released with updated 'Correction instruction' information. We added the prerequisite note 2542223 in the correction instruction.

**UPDATE 13th October 2020:** This note has been re-released with updated 'Solution’ information. We have added the pre-implementation manual instruction in the solution section. The implementation requires a replacement of a MIME file, the existing file needs to be deleted manually before implementing the automatic instructions of the note.

SAP CRM WebClient UI does not sufficiently encode user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability.

**Impacts of XSS Vulnerability:**
- Non-permanently deface or modify displayed content from a website
- Steal authentication information of the user, such as data relating to their current session
- Impersonate the user and access all information with the same rights as the target user

**Reason and Prerequisites**

jQuery needs to be upgraded to fix the vulnerabilities.

**Solution**

1. **Implement the Support Packages and Patches referenced by this SAP Note.**
   - [Download for SNOTE](https://me.sap.com/notes/0040000001593602020)
   - [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002945581?language=en-US&token=4644FF45B8F51A6401EFB556C8B5AFFE)

2. **Manual Pre-Implementation Steps:**
   ```
   --------------------------------------------------------------------------------
   |Manual Pre-Implement.                                                          |
   --------------------------------------------------------------------------------
   |VALID FOR                                                                    |
   |Software Component   S4FND                                                    |
   | Release 103          Until SAPK-10304INS4FND                                 |
   | Release 102          Until SAPK-10206INS4FND                                 |
   | Release 104          Until SAPK-10402INS4FND                                 |
   | Release 105          without Support Packages                               |
   |Software Component   WEBCUIF                                                   |
   | Release 731          SAPK-73101INWEBCUIF - SAPK-73126INWEBCUIF               |
   | Release 746          All Support Package Levels                             |
   | Release 747          Until SAPK-74721INWEBCUIF                             |
   | Release 748          Until SAPK-74815INWEBCUIF                             |
   | Release 800          Until SAPK-80011INWEBCUIF                             |
   | Release 801          Until SAPK-80109INWEBCUIF                             |
   --------------------------------------------------------------------------------

   **Caution:** You have to perform this manual pre-implementation step manually and separately in each system **before** you import the Note to implement.

   1. Execute transaction SE80:
      - Go to Mime Repository:
      - Navigate to `SAP→BC→BSP→SAP→WCF_JQUERY` Folder.

   2. Save a local copy of the file `current.min.js` and delete the `current.min.js` file from the WCF_JQUERY Folder.

   3. Implement the automatic steps of the note.
   ```

**Prerequisites**
- Ensure prerequisite Note [2542223](https://me.sap.com/notes/2542223) is implemented for the following components:
  - S4FND 102
  - WEBCUIF 731, 747, 748

**CVSS Score**
- **Score:** 4.7
- **Vector:** CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N
  - **Attack Vector:** Network
  - **Attack Complexity:** High
  - **Privileges Required:** None
  - **User Interaction:** Required
  - **Scope:** Changed
  - **Confidentiality Impact:** Low
  - **Integrity Impact:** Low
  - **Availability Impact:** None

**Affected Software Components**
- **S4FND:** Versions 102 to 105
- **WEBCUIF:** Versions 731, 746-801

**References**
- [Issues when trying to implement security note 2945581](https://me.sap.com/notes/2998240)

For more details and to access the full security note, visit [SAP Support Portal](https://me.sap.com/notes/2945581).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*