2943844 - [CVE-2020-6308] Server-Side Request Forgery vulnerability in SAP BusinessObjects Business Intelligence Platform (Web Services)

**SAP Note Number:** 2943844  
**Title:** [CVE-2020-6308] Server-Side Request Forgery vulnerability in SAP BusinessObjects Business Intelligence Platform (Web Services)  
**Type:** SAP Security Note  
**Version:** 8  
**Recency:** Updated  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 23.02.2021  
**Component:** BI-DEV-JAV  

### Description
**Symptom**

*UPDATE 23rd February 2021:* This note has been re-released with updated 'Reason and Prerequisites' information.

SAP BusinessObjects Business Intelligence Platform (Web Services) allows an unauthenticated attacker to inject arbitrary values as CMS parameters to perform lookups on the internal network, which is otherwise not accessible externally. On successful exploitation, an attacker can scan the internal network to determine internal infrastructure and gather information for further attacks such as remote file inclusion, retrieving server files, bypassing firewalls, and forcing the vulnerable server to perform malicious requests.

**Other Terms**

Server-Side Request Forgery, SSRF, Information exposure, webservices, [CVE-2020-6308](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6308)

**Reason and Prerequisites**

The logon pages of tools using `dswsbobje` (Web Services) for login allow users to enter a custom CMS host and port number. An attacker can use common techniques to determine which ports are in use on the backend server. Web Services may call URLs that are not authorized by administrators.

### Solution
The allowlist of authorized CMS has been included in the product. Administrators must configure this before attempting any login. To do so, edit the `dsws.properties` file and configure the `allowed.cms` field with a comma-separated list of all authorized URLs, for example:
```
allowed.cms=host:6400,host2:6400,host3:15678
```

This issue is fixed in the patches listed in the "Support Packages & Patches" section below.

For Business Intelligence Platform maintenance schedules and strategies, see [Knowledge Base Article 2144559](https://me.sap.com/notes/2144559) in the References section.

### CVSS
**Score:** 5.3  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** None (N)
- **Availability Impact (A):** None (N)

### Support Package Patches
- **SBOP BI PLATFORM SERVERS 4.3**
  - SP000 Patch 000200  
    [View Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)

- **SBOP BI PLATFORM SERVERS 4.2**
  - SP009 Patch 000000  
    [View Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
  - SP008 Patch 000500  
    [View Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
  - SP007 Patch 001300  
    [View Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)

- **SBOP BI PLATFORM SERVERS 4.1**
  - SP012 Patch 000800  
    [View Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)

### References
- [BI 4.x Maintenance Strategy & Schedule (2144559)](https://me.sap.com/notes/2144559)
- Referenced by [2951044](https://me.sap.com/notes/2951044) - Unable to login to BI Platform using web service URL due to invalid CMS

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*