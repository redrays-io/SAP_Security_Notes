2952084 - [CVE-2020-26814] Information Disclosure in SAP Process Integration (PGP Module â€“ Business-to-Business Add On)

## Description

### Symptom
Under certain conditions, the PGP Module of SAP Process Integration, business-to-business add-on allows an attacker to read PGP Keys. These keys are specifically maintained in the Module tab of communication channels (like B2B add-on SFTP Adapter, SAP NetWeaver File Adapter), but not readable there. An attacker could use these keys to read messages processed by these channels, which are supposed to be encrypted.

### Other Terms
Information Exposure, Information Leak, Secure File Transfer Protocol Adapter (SFTP Adapter), Process Orchestration (PO), PGP, Encryption, Decryption, B2B TOOLKIT 1.0, [CVE-2020-26814](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26814)

### Reason and Prerequisites
You are using PGP Module in Module tab of communication channel and you have configured module parameter `useSecureStore=true` to retrieve the PGP Keys stored using PGP Secure Store (http://&lt;host&gt;:&lt;port&gt;/PGPSecureStore).

An attacker would need administrator access to the operating system to exploit this vulnerability.

The vulnerability is caused by missing encryption.

## Solution
An appropriate encryption has been implemented. Deploy the Support Packages and Patches referenced by this SAP Security Note.

### Migration Instructions
If you are already using PGP keys stored using PGP Secure Store, migrate them as follows:
1. Go to [PGP Secure Store](http://&lt;host&gt;:&lt;port&gt;/PGPSecureStore)
2. Click the "Update Keys" button

## CVSS
- **Score:** 4.9
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N)

### Metrics
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** High (H)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** None (N)
- **Availability Impact (A):** None (N)

## Support Package Patches
- **Software Component Version:** PGP MODULE 1.0
- **Support Package:** SP005
- **Patch Level:** 000006
- **URL:** [Download SP005 Patch 000006](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67837800100200020375&support_package=SP005&patch_level=000006)

## Manual Activities
```
-------------------------------------------------------------------------
|Manual Activity                                                               |
-------------------------------------------------------------------------
|VALID FOR                                                                   |
|Software Component  PIB2BPGP                                                 |
| Release 1.0  All Support Package Levels                                   |
-------------------------------------------------------------------------

**Caution:** You have to perform this manual activity separately in each system into which you transport the Note for implementation.

In case you are already using PGP keys stored using PGP Secure Store, migrate them as follows:

1. Go to PGP Secure Store by calling http://&lt;host&gt;:&lt;port&gt;/PGPSecureStore and click the "Update Keys" button
```

## References
- **CVE:** [CVE-2020-26814](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26814)

## Additional Information
- **Number:** 2952084
- **Type:** SAP Security Note
- **Version:** 5
- **Recency:** New
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** 10.11.2020
- **Component:** Basis Components > NetWeaver Process Integration (PI) > Connectivity

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*