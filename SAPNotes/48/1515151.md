SAP Security Note 1515151 - Unauthorized usage of application functionality in PLM-CFO

---

**Description**

A malicious user can trigger functionality in PLM-CFO without authentication and authorization.

**Symptom**

This security note has been updated. For more detailed information, see [Security Notes 1567901](https://me.sap.com/notes/1567901) and [1572616](https://me.sap.com/notes/1572616).

**Other Terms**

Cross-Site Request Forgery (XSRF), PLM-CFO

**Reason and Prerequisites**

PLM-CFO executes certain functions through referencing specific URLs. An attacker can trick an authenticated user's browser into making a request containing a specific URL and parameters, causing the function to execute with the user's rights. This can be exploited through Cross Site Scripting (XSS) or by presenting a clickable link to the victim.

**Solution**

Please apply the following steps:

1. Refer to [Note 1520324](https://me.sap.com/notes/1520324) for additional information and instructions. The corrections from this note are a prerequisite for implementing this note.
2. Implement the correction instructions of this note. This will create the report `BSP_XSRF_PARAM_CFOLDERS` in your system.
3. Execute the report `BSP_XSRF_PARAM_CFOLDERS` and specify a corresponding transport request number when prompted. The report will populate the database table `BSPTEMPXSRFSTORE` with entries for the BSP applications adapted by this note.

**Manual Activities**

To successfully implement this note, you must perform the following manual instructions; otherwise, the changes will not take effect:

1. **Mark the flag "XSRF protection" for the following BSP Applications:**
   - CFX_RFC_UI
   - CFX_ARCH_UI

**Steps for Manual Change:**

1. Navigate to SE80 → BSP Application.
2. Double-click on the application and switch to the "Properties" tab.
3. Mark the flag "XSRF-Protection".

**References**

- [1699886 - Dump occurs while starting cFolder from notification mail](https://me.sap.com/notes/1699886)
- [1674620 - Error while executing report BSP_XSRF_PARAM_CFOLDERS](https://me.sap.com/notes/1674620)
- [1666244 - cFolders: Composite SAP Note - Security](https://me.sap.com/notes/1666244)
- [1660140 - Error occurs while exporting BOM to cFolder using CFE02](https://me.sap.com/notes/1660140)
- [1599647 - Application generates short dump](https://me.sap.com/notes/1599647)
- [1572616 - Update #2 to Security Note 1515151](https://me.sap.com/notes/1572616)
- [1567901 - Update #1 to Security Note 1515151](https://me.sap.com/notes/1567901)
- [1560533 - System message page generates short dump](https://me.sap.com/notes/1560533)
- [1555062 - Unauthorized usage of application functionality in PLM-CFO](https://me.sap.com/notes/1555062)
- [1543703 - Redlining is not working](https://me.sap.com/notes/1543703)
- [1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)
- [1538581 - Not able to navigate from SRM to cFolder](https://me.sap.com/notes/1538581)

**Supported Software Components**

- **CPROJECTS**
  - From: 310_620
  - To: 310_640
- **CPRXRPM**
  - From: 400, 450_700, 500_702

**Support Packages**

- [SAPK-31220INCPROJECT](https://me.sap.com/supportpackage/SAPK-31220INCPROJECT)
- [SAPK-31219INCPROJECT](https://me.sap.com/supportpackage/SAPK-31219INCPROJECT)
- [SAPK-31420INCPROJECT](https://me.sap.com/supportpackage/SAPK-31420INCPROJECT)
- [SAPK-31419INCPROJECT](https://me.sap.com/supportpackage/SAPK-31419INCPROJECT)
- [SAPK-40019INCPRXRPM](https://me.sap.com/supportpackage/SAPK-40019INCPRXRPM)
- [SAPK-45010INCPRXRPM](https://me.sap.com/supportpackage/SAPK-45010INCPRXRPM)
- [SAPK-45011INCPRXRPM](https://me.sap.com/supportpackage/SAPK-45011INCPRXRPM)
- [SAPK-50005INCPRXRPM](https://me.sap.com/supportpackage/SAPK-50005INCPRXRPM)
- [SAPK-50004INCPRXRPM](https://me.sap.com/supportpackage/SAPK-50004INCPRXRPM)

**Side Effects**

This document is causing side effects, including:

- [1587101 - Error for thumbnail display in cFolders](https://me.sap.com/notes/1587101)
- [1538581 - Not able to navigate from SRM to cFolder](https://me.sap.com/notes/1538581)
- [1660140 - Error occurs while exporting BOM to cFolder using CFE02](https://me.sap.com/notes/1660140)
- [1543703 - Redlining is not working](https://me.sap.com/notes/1543703)
- [1599647 - Application generates short dump](https://me.sap.com/notes/1599647)
- [1560533 - System message page generates short dump](https://me.sap.com/notes/1560533)
- [1699886 - Dump occurs while starting cFolder from notification mail](https://me.sap.com/notes/1699886)
- [1555062 - Unauthorized usage of application functionality in PLM-CFO](https://me.sap.com/notes/1555062)
- [1674620 - Error while executing report BSP_XSRF_PARAM_CFOLDERS](https://me.sap.com/notes/1674620)

**Attachments**

No attachments are available for this note.

**Available Translations**

This SAP Note is available in multiple languages:
- [Deutsch](https://me.sap.com/notes/0001515151/D)
- [日本語](https://me.sap.com/notes/0001515151/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001515151/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001515151/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001515151/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001515151/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001515151/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001515151/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001515151/3)

**Credits**

Information provided with support from [Redrays](https://redrays.io).