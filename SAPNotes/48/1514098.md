SAP Security Note 1514098 - Unauthorized Usage of Application Functionality

**Type:** SAP Security Note  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** December 14, 2010  
**Component:** CRM-MKT (Customer Relationship Management > Marketing)

### Symptom

A malicious user can trigger functionality in the following BSP applications without authentication and authorization:

- CARPTEST
- CRM_MKTTG_SEGAP
- CRM_MKTCA_UI
- CRM_MKTIMEX_MON

### Other Terms

- Cross-Site Request Forgery (XSRF)
- Cross Site Scripting (XSS)

### Reason and Prerequisites

The mentioned BSP applications execute certain functions by referencing specific URLs. An attacker can trick an authenticated user's browser into making a request containing certain URLs and parameters, causing functions to execute with the user's rights.

If present, the attacker may use a Cross Site Scripting attack to trigger the exploit or present a clickable link to the victim.

### Solution

1. Refer to [Note 1520324](https://me.sap.com/notes/1520324) for additional information and instructions. The corrections from this note are a prerequisite for implementing this note.
2. Implement the correction instructions of this note. This will create the report `BSP_XSRF_PARAM_CRM_MKT` in your system.
3. Execute the report `BSP_XSRF_PARAM_CRM_MKT` and specify a corresponding transport request number when prompted. The report will populate the database table `BSPTEMPXSRFSTORE` with entries for the BSP applications adapted by this note.

### Correction Instructions

- **Software Component:** BBPCRM
- **Number of Correction Instructions:** 8
- [Correction Instructions Details](https://me.sap.com/corrins/0001514098/63)

### Manual Activities

1. Enter transaction SE80 and edit the BSP Application **CARPTEST**.
   - a) Mark the checkbox for "XSRF Protection".
   - b) Save and activate your changes.
2. Enter transaction SE80 and edit the BSP Application **CRM_MKTTG_SEGAP**.
   - a) Mark the checkbox for "XSRF Protection".
   - b) Save and activate your changes.
3. Enter transaction SE80 and edit the BSP Application **CRM_MKTIMEX_MON**.
   - a) Mark the checkbox for "XSRF Protection".
   - b) Save and activate your changes.
4. Enter transaction SE80 and edit the BSP Application **CRM_MKTCA_UI**.
   - a) Mark the checkbox for "XSRF Protection".
   - b) Save and activate your changes.

### References

- [Note 1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)

### Validity

**Software Components: BBPCRM**

| Software Component | From | To  |
|--------------------|------|-----|
| BBPCRM             | 400  | 400 |
| BBPCRM             | 500  | 500 |
| BBPCRM             | 520  | 520 |
| BBPCRM             | 600  | 600 |
| BBPCRM             | 700  | 700 |
| BBPCRM             | 701  | 701 |

### Support Package

| Software Component Version | Support Package      | URL                                                         |
|----------------------------|----------------------|-------------------------------------------------------------|
| BBPCRM 400                 | SAPKU40018           | [Link](https://me.sap.com/supportpackage/SAPKU40018)        |
| BBPCRM 500                 | SAPKU50018           | [Link](https://me.sap.com/supportpackage/SAPKU50018)        |
| BBPCRM 520                 | SAPKU52011           | [Link](https://me.sap.com/supportpackage/SAPKU52011)        |
| BBPCRM 600                 | SAPKU60009           | [Link](https://me.sap.com/supportpackage/SAPKU60009)        |
| BBPCRM 700                 | SAPKU70009           | [Link](https://me.sap.com/supportpackage/SAPKU70009)        |
| BBPCRM 701                 | SAPKU70103           | [Link](https://me.sap.com/supportpackage/SAPKU70103)        |

### CVSS

**CVSS Score:** 0  
**CVSS Vector:** N/A

### Rating

- **Rated Helpful:** 0 people
- **Quality Rating:** 0.0 (0 votes)

### Side Effects

This document does not solve or cause any side effects.

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*