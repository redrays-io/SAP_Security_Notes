1514717 - Unauthorized usage of application functionality

**Symptom**

A malicious user can trigger functionality in the following BSP applications without authentication and authorization:
- `BBP_SUS_UM`
- `BBP_SUS_WORKER`
- `CRM_BSP_PSD_CHM`
- `CRM_SEND_SCREEN`

**Other Terms**
- Cross-Site Request Forgery (XSRF)

**Reason and Prerequisites**

The mentioned BSP applications execute certain functions through specific URLs. An attacker can trick an authenticated user's browser into making a request containing a certain URL and specific parameters, causing the function to execute with the user's privileges. This can be achieved through a Cross Site Scripting (XSS) attack or by presenting a clickable link to the victim.

**Solution**

1. **Manual Pre-Implementation Steps for CRM Release 7.01 and Lower:**
   - **For CRM 7.01:**
     - Implement the attached corrections from the note.
   - **For Lower Releases:**
     - Follow the manual steps provided in the note.

2. **Enable XSRF Protection on BSP Applications:**
   - Enter transaction `SE80` and edit each affected BSP Application:
     1. **BBP_SUS_UM**
        - Mark the checkbox for "XSRF Protection".
        - Save and activate the changes.
     2. **BBP_SUS_WORKER**
        - Mark the checkbox for "XSRF Protection".
        - Save and activate the changes.
     3. **CRM_BSP_PSD_CHM**
        - Mark the checkbox for "XSRF Protection".
        - Save and activate the changes.
     4. **CRM_SEND_SCREEN**
        - Mark the checkbox for "XSRF Protection".
        - Save and activate the changes.

3. **Implement Correction Instructions:**
   - Create reports `BSP_XSRF_PARAM_CRM_MISC_3_400A` and `BSP_XSRF_PARAM_CRM_MISC_3_400B` in your system.
     - **Report Details:**
       - `BSP_XSRF_PARAM_CRM_MISC_3_400A` should be created in package `CRM_CHM_CM_PRT_F+R`.
       - `BSP_XSRF_PARAM_CRM_MISC_3_400B` should be created in package `CRM_EMAIL`.
     - Maintain both reports as "SAP standard production report".

4. **Execute Reports for Manual Post-Implementation:**
   - **For CRM 7.0 and Lower:**
     1. Execute the reports `BSP_XSRF_PARAM_CRM_MISC_3` and `BSP_XSRF_PARAM_CRM_MISC_3_400A/B`, specifying a corresponding transport request number when prompted. These reports will populate the database table `BSPTEMPXSRFSTORE` with the necessary entries.
     2. If upgraded to a basis support package containing note [1520324](https://me.sap.com/notes/1520324), the BSP metadata repository will automatically populate with the correct data, eliminating the need for manual table entries.

**References**
- [ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)

**Download and Print**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008977262017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001514717?language=en-US&token=E91272BA63B27AE18C4B47D776DF8F93)

**Software Components Affected**
- BBPCRM (Releases 400 to 701)
- CRMIS (Release 400)

**Support Packages Required**
- Various support packages for BBPCRM and CRMIS as listed in the note.

**Credits**
Information supported by [RedRays](https://redrays.io).