SAP Security Note 1515145 - XSRF Protection for BSP Applications

## Summary

**SAP Note Number:** 1515145  
**Title:** WTY, A&D: XSRF Protection for BSP Application  
**Type:** SAP Security Note  
**Release Status:** Released for Customer  
**Released On:** 14.12.2010  
**Component:** Industry-Specific Components > Automotive > Dealer Portal (IS-A-DP)  
**Priority:** Correction with high priority  
**Version:** 3  
**Recency:** New  
**Language:** English  

## Description

### Symptom
The XSRF protection provided by the BSP Framework is not adapted to the WTY and A&D dealer portals, which are BSP applications.

### Reason and Prerequisites
The Warranty Dealer Portal and A&D Spare Parts portal execute certain functions by referencing specific URLs. An attacker can trick an authenticated user's browser into making requests containing specific URLs and parameters, causing functions to execute with the user's privileges. Potential attack vectors include Cross Site Scripting (XSS) attacks or presenting clickable links to victims.

### Solution
Implement the corrections attached to this note. These corrections are valid for releases up to Ehp4 (604 for EA-APPL). For Ehp5 (605 for EA-APPL) and higher, the corrections are not applicable as XSRF protection is enabled via the Workbench.

**Steps to Implement:**
1. Refer to [SAP Note 1520324](https://me.sap.com/notes/1520324) for additional information and prerequisites. The corrections from this note are required before implementing SAP Note 1515145.
2. Follow the correction instructions provided in this note. This will create the report `/SAPDII/BSP_XSRF_PARAM_DII_WTY` in your system.
3. Execute the report `/SAPDII/BSP_XSRF_PARAM_DII_WTY` and specify a transport request number when prompted. The report will populate the `BSPTEMPXSRFSTORE` database table with entries for the adapted BSP applications.

## Affected Software Components

- **EA-APPL Versions:** 600, 602, 603, 604, 605

## Download & Resources

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008981322017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001515145?language=en-US&token=AAC7B774D7439691A59974C5D71A224C)
- [Edit Note](https://me.sap.com/corrins/0001515145/229) _(Visible only internally)_

## References

- [SAP Note 1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)
- [SAP Note 1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)

## Available Translations

- Deutsch
- 日本語
- Português (Machine Translation)
- Español (Machine Translation)
- Français (Machine Translation)
- Italiano (Machine Translation)
- Русский (Machine Translation)
- 中文 (Machine Translation)
- 한국어 (Machine Translation)

## Correction Instructions

- **Software Component:** EA-APPL  
- **Number of Correction Instructions:** 4  
- [View Correction Instructions](https://me.sap.com/corrins/0001515145/229)  

---

*Credits: Thanks to [Redrays.io](https://redrays.io) for support in providing this information.*