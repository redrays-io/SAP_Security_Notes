3017908 - [CVE-2021-21482] Information Disclosure in SAP NetWeaver Master Data Management

**Symptom**
When security guidelines and recommendations concerning administrative accounts of a SAP NetWeaver Master Data Management installation have not been thoroughly reviewed, a malicious user with access to the MDM Server subnet might try to find the password using a brute force method. If successful, the attacker could obtain access to highly sensitive data and MDM administrative privileges.

**Other Terms**
Information Exposure, Information Leak, [CVE-2021-21482](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21482)

**Reason and Prerequisites**
Unlike regular user accounts, the MDM administrative accounts cannot be locked after multiple unsuccessful connection retries. In case of a badly chosen or weak password, an attacker could try to guess it using a dictionary/brute force.

**Solution**
The solution is to apply the latest patch, effectively replacing the main server executable and restarting it. In addition, the use of strong passwords should be enforced, especially for administrative accounts. It is highly recommended to create an additional administrative user in addition to the default 'Admin' account, in order to alleviate the possible locking of this default account.

**Workaround**
To minimize the risk of a successful attack, enforce a strong password policy for all account types by following these steps:

1. **Set or update the password parameters in the `mds.ini` file(s) as follows:**
   - `Lock Account After Failed Password Attempts=5`
   - `Lock Account Duration=1800`
   - `Minimum Password Length=12`
   - `Maximum Password Length=255`
   - `Password Must Contain Uppercase And Lowercase Letters=True`
   - `Password Must Contain At Least One Digit=True`
   - `Password Must Contain At Least One Special Character=True`
   - `Password Cannot Contain The User Name=True`
   - `Number Of Previous Passwords That Cannot Be Reused=5`
   - `Password Expiration Days=90`
   - `Password Expiration Warning=7`

   Once set, restart the MDM server(s) for the changes to take effect.

2. **Change all passwords of accounts with Admin roles** in accordance with the parameters set in step 1.

**Note:** Assess the workaround applicability for your SAP landscape prior to implementation. This workaround is a temporary fix and is not a permanent solution. SAP strongly recommends applying the patches outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.

**References**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000540092021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003017908?language=en-US&token=6683DCC90426AC5902EAEB97044C3024)

**CVSS**
- **Score:** 8.3
- **Vector:** [CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L](https://nvd.nist.gov/vuln-metrics/cvss)

**Affected Software Components**
- MDM_SERVER 7.1
- MDM_SERVER 7.1 7.5
- MDM_IMPORT_SERVER 7.1
- MDM_IMPORT_SERVER 7.1 7.5
- ... *(additional components as listed in the security note)*

**Support Package Patches**
- [MDM SHARED INSTALL CONTENT 7.1 SP020 Patch 000008](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200009976&support_package=SP020&patch_level=000008)
- [MDM SERVER 7.1 SP020 Patch 000008](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200011990&support_package=SP020&patch_level=000008)
- ... *(additional patches as listed in the security note)*

For more details and updates, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io) for support to provided information.*