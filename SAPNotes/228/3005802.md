3005802 - Cross-Site Request Forgery (CSRF) vulnerability in S/4HANA Finance for advanced payment management

### Description
**Symptom**

*S/4HANA Finance for Advanced Payment Management* allows an attacker to trick an authenticated user into sending unintended requests to the web server. This vulnerability is due to insufficient CSRF protection.

**Impacts of CSRF Vulnerability:**
- Attacker could take actions on behalf of an authenticated user
- Loss of non-repudiation

**Other Terms:** Open redirect, cross-site redirect, cross-domain redirect, XSRF, session riding

### Solution
- **Code Fix:** The fix changes any function import HTTP requests from GET to POST, enabling CSRF protection.
- **Implementation Steps:**
  1. Apply the Support Packages and Patches referenced by this SAP Note.
  2. After implementation, apply [Note 3006448](https://me.sap.com/notes/3006448) in the corresponding frontend system to avoid possible error messages like *Function '<..>' not found in the metadata.*

### CVSS Score
- **Score:** 5.4
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L

### Affected Components
- **Software Components:**
  - ECC-SE 803
  - S4CORE 105
  - S4COREOP 104

### Support Packages
- **S4COREOP 104:** [SAPK-10404INS4COREOP](https://me.sap.com/supportpackage/SAPK-10404INS4COREOP)
- **S4CORE 105:** [SAPK-10502INS4CORE](https://me.sap.com/supportpackage/SAPK-10502INS4CORE)
- **ECC-SE 803:** [SAPK-80306INECCSE](https://me.sap.com/supportpackage/SAPK-80306INECCSE)

### References
- **This document refers to:**
  - [3006448: Create Payments: Switch from GET to POST requests for function imports](https://me.sap.com/notes/3006448)

### Actions
- **Download for SNOTE:** [Download](https://notesdownloads.sap.com/note/0040000000423812021)
- **PDF Version:** [PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003005802?language=en-US&token=B7DFC34A9E4A47FFEF9F4E747FD501A0)
- **Share by Email:** Available within the SAP Support Portal
- **Open in New Window:** Available within the SAP Support Portal

### Prerequisites
Ensure the following SAP Notes are applied before implementing this security note:
- [2957707: Mapping of Fee info field](https://me.sap.com/notes/2957707)
- [2984285: Create App: Missing Fields End-To-End-ID and UETR](https://me.sap.com/notes/2984285)
- [2988009: Create UI changing of Value Date field to Due Date](https://me.sap.com/notes/2988009)
- [2988180: UI fields Invoice, Instruction ID, End to End ID](https://me.sap.com/notes/2988180)
- [2990463: Create Payments: Improvements of Originating Account Search and Maintenance](https://me.sap.com/notes/2990463)
- [2863764: Intermediary Institution and instruction codes](https://me.sap.com/notes/2863764)
- [2927326: Create Payments OData service BIC value help issue](https://me.sap.com/notes/2927326)
- [2968180: Performance - TCHAIN access](https://me.sap.com/notes/2968180)

### Credits
Information supported by [Redrays.io](https://redrays.io).