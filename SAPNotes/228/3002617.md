3002617 - [Multiple CVEs] Improper Input Validation in SAP 3D Visual Enterprise Viewer

**Symptom**

This SAP security note addresses improper input validation when the following file formats are opened in SAP 3D Visual Enterprise Viewer. When a user opens manipulated files received from untrusted sources in SAP 3D Visual Enterprise Viewer, the application crashes and becomes temporarily unavailable until the application is restarted.

**Affected File Formats and CVEs**

- **Interchange File Format (.IFF)**
  - [CVE-2021-21449](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21449)
  - [CVE-2021-21457](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21457)
  - [CVE-2021-21458](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21458)
  - [CVE-2021-21459](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21459)
  
- **Photoshop Document (.PSD)**
  - [CVE-2021-21450](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21450)
  
- **Silicon Graphics Image (.SGI)**
  - [CVE-2021-21451](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21451)
  
- **Graphical Interchange Format (.GIF)**
  - [CVE-2021-21452](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21452)
  
- **Run Length Encoded (.RLE)**
  - [CVE-2021-21453](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21453)
  - [CVE-2021-21454](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21454)
  
- **Device Independent Bitmap (.DIB)**
  - [CVE-2021-21455](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21455)
  - [CVE-2021-21456](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21456)
  - [CVE-2021-21460](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21460)
  
- **Bitmap (.BMP)**
  - [CVE-2021-21461](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21461)
  
- **Picture Exchange (.PCX)**
  - [CVE-2021-21462](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21462)
  - [CVE-2021-21463](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21463)
  - [CVE-2021-21464](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21464)

**Reason and Prerequisites**

Insufficient input validation occurs when the above-mentioned file formats are opened in SAP 3D Visual Enterprise Viewer.

**Solution**

This issue is fixed in the patch listed in the "Support Packages & Patches" section below.

The following file formats have been fixed with additional validation when they are opened in SAP 3D Visual Enterprise Viewer:

- Windows Bitmap (.bmp, .dib, .rle)
- Maya Image File Format (.iff)
- Silicon Graphics Image (.sgi)
- Graphics Interchange Format (.gif)
- PhotoShop Document (.psd)
- PiCture eXchange (.pcx)

For release information about SAP 3D Visual Enterprise Viewer 9.0 FP10, refer to [SAP Note 2934632](https://me.sap.com/notes/2934632).

**Support Package Patches**

- **VE_VIEWER_COMPLETE 9.0**
  - **Support Package:** SP010
  - [Download Patch SP010](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73555000100200003543&support_package=SP010&patch_level=000000)

**CVSS Score**

- **Score:** 4.3
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L)

| Metric                 | Value            |
|------------------------|------------------|
| Attack Vector (AV)     | Network (N)      |
| Attack Complexity (AC) | Low (L)          |
| Privileges Required (PR)| None (N)        |
| User Interaction (UI)  | Required (R)     |
| Scope (S)              | Unchanged (U)    |
| Confidentiality Impact (C)| None (N)      |
| Integrity Impact (I)   | None (N)         |
| Availability Impact (A)| Low (L)          |

**Additional Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000030072021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003002617?language=en-US&token=65A81A685137E08B00B69A020868991C)
- [Share by Email](https://me.sap.com/notes/0003002617)
- [Open in New Window](https://me.sap.com/notes/0003002617)

*Credits: [redrays.io](https://redrays.io)*