SAP Security Note 3000897 - [CVE-2021-21475] Directory Traversal vulnerability in SAP NetWeaver Master Data Management 7.1

## Description

### Symptom
Under specific circumstances, SAP NetWeaver Master Data Management allows an unauthorized attacker to exploit insufficient validation of path information provided by users. Characters representing 'traverse to parent directory' are passed through to the file APIs. Due to this Directory Traversal vulnerability, the attacker could read the content of arbitrary files on the remote server and expose sensitive data.

### Other Terms
Path traversal, backtracking, directory climbing, MDM, MDS, [CVE-2021-21475](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21475)

### Reason and Prerequisites
The MDM server is missing a file path check on the requested service. An attacker must know the password of the MDM server administrator and the path to the file to exploit the vulnerability.

### Solution
Added a restriction: The MDM Server restricts access only to the files inside the directories, but not subdirectories, defined in MDM server settings (in the `mds.ini` file).

Implement the Support Package (SP) patch level attached to this note.

## Affected Software Components
- **MDM_CLIX**: 7.1, 7.1.750
- **MDM_IMP_SRV**: 7.1, 7.1.750
- **MDM_SYND_SRV**: 7.1
- **MDM_IMPORT_MANAGER**: 7.1, 7.1.750
- **MDM_SYNDICATOR**: 7.1, 7.1.750
- **MDM_CONSOLE**: 7.1, 7.1.750
- **MDM_LANGUAGE_SELECTOR**: 7.1, 7.1.750
- **MDM_DATA_MANAGER**: 7.1, 7.1.750
- **MDM_SHARED_INSTALL_CONTENT**: 7.1, 7.1.750
- **MDM_SERVER**: 7.1, 7.1.750

## CVSS

- **CVSS Score**: 4.0
- **CVSS Vector**: [CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N)

### Metrics
- **Attack Vector (AV)**: Network (N)
- **Attack Complexity (AC)**: High (H)
- **Privileges Required (PR)**: None (N)
- **User Interaction (UI)**: None (N)
- **Scope (S)**: Changed (C)
- **Confidentiality Impact (C)**: Low (L)
- **Integrity Impact (I)**: None (N)
- **Availability Impact (A)**: None (N)

## References
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000190502021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003000897?language=en-US&token=8D8F17CFC0842294FDD8D00FD92C2748)
- [Share by Email](https://me.sap.com/notes/0003000897/S)
- [Open in New Window](https://me.sap.com/notes/0003000897/O)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0003000897)

## Support Package Patches
- **MDM SERVER 7.1**
  - [SP016 Patch 000017](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200011990&support_package=SP016&patch_level=000017)
  - [SP017 Patch 000014](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200011990&support_package=SP017&patch_level=000014)
  - [SP018 Patch 000016](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200011990&support_package=SP018&patch_level=000016)
  - [SP019 Patch 000008](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200011990&support_package=SP019&patch_level=000008)
  - [SP020 Patch 000005](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200011990&support_package=SP020&patch_level=000005)
  - [SP021 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=73555000100200011990&support_package=SP021&patch_level=000003)

For a complete list of support package patches, visit the [Support Package Patches](https://me.sap.com/notes/0003000897/SPPatches) page.

---

*Credits to [RedRays](https://redrays.io) for supporting the provided information.*