3007182 - [CVE-2021-27610] Improper Authentication in SAP NetWeaver ABAP Server and ABAP Platform

**SAP Security Note 3007182: [CVE-2021-27610] Improper Authentication in SAP NetWeaver ABAP Server and ABAP Platform**

**Description**

**Symptom**

**UPDATE 13th July 2021**: This note has been re-released with updated ‘Support Packages & Patches’ information. We have added the SP Stack Kernel 753 PL801 to the support packages section.

SAP NetWeaver ABAP Server and ABAP Platform do not create information about internal and external RFC users in a distinguished and consistent format, which may be exploited by malicious users to obtain illegitimate access to the system.

**Other Terms**

RFC and HTTP communication, [CVE-2021-27610](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27610)

**Reason and Prerequisites**

ABAP Server does not unambiguously distinguish if communication via RFC or HTTP is between the application server of the same SAP system or with servers outside the same system.

A malicious user can steal credentials from internal RFC communication between server A (RFC or HTTP client) and server B (serving the request) within the same system. These stolen credentials can enable the attacker to craft their own RFC or HTTP communications between a new, external program C and server A, pretending to be an internal caller against server A.

**Solution**

There is no workaround available. The risk of an attack can be reduced by restricting external network access for RFC and HTTP communications using your network protection solutions accordingly.

By applying the correction provided in this SAP Note, the identification of application servers within one SAP system is improved, allowing communication to be distinguished from application servers of another SAP system or external client and server programs.

For the correction, a new Kernel version for RFC and HTTP is required, along with an ABAP correction for HTTP communication.

Please implement the Kernel patch level mentioned in this SAP Note. For constraints regarding implementing the Kernel patch level, refer to [SAP Note 3026990](https://me.sap.com/notes/3026990).

**Support Package**

Detailed support package information can be found within the note. Ensure you apply the latest Support Package Patches relevant to your SAP components.

**CVSS**

- **Score:** 9.0
- **Vector:** CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H

**Side Effects**

Applying this correction may cause side effects, including but not limited to:
- [3045515 - RFC_WITHIN_SAME_SYSTEM - Wrong Result](https://me.sap.com/notes/3045515)
- [3039802 - WebSocket RFC with Alias User in Same System](https://me.sap.com/notes/3039802)
- [3050126 - Internal RFC fails due to time difference between database and application server](https://me.sap.com/notes/3050126)
- [3068552 - Performance regression of type T destinations with note 3007182 or 3026990](https://me.sap.com/notes/3068552)
- [3097598 - Internal RFC calls waiting longer than 5 minutes for a free workprocess fail](https://me.sap.com/notes/3097598)
- [3137822 - Internal WebSocket-RFC calls waiting longer than 5 minutes for a free workprocess fail](https://me.sap.com/notes/3137822)
- [3046390 - Incorrect SAP compatibility level for SAP executables on Windows prevents RKS](https://me.sap.com/notes/3046390)

**Credits**

Credits to [redrays.io](https://redrays.io) for support to provided information.