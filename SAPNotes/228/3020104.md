SAP Security Note 3020104: Multiple CVEs - Memory Corruption Vulnerability in SAP NetWeaver ABAP Server and ABAP Platform

**Description**

**Symptom**

An unauthenticated attacker without specific knowledge of the system can send a specially crafted packet over a network which will trigger an internal error in the system causing the system to crash and rendering it unavailable. In this attack, no data in the system can be viewed or modified.

**Other Terms**

Buffer overflow, heap overflow, memory leaks, dangling pointers, null pointer dereferences, [CVE-2021-27606](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27606), [CVE-2021-27629](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27629), [CVE-2021-27630](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27630), [CVE-2021-27631](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27631), [CVE-2021-27632](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27632)

**Reason and Prerequisites**

Memory corruption can be provoked in SAP Enqueue Server (ENSA1) due to a programming error.

**Solution**

The patch will protect against the memory corruption attacks described here by correcting a programming error.

Please implement the patch level mentioned in this SAP Note.

Due to the nature of the vulnerability, no workaround is possible.

**Affected Software Components**

| Software Component | From   | To     |
|--------------------|--------|--------|
| KRNL64NUC          | 7.22   | 7.22   |
| KRNL64NUC          | 7.22EXT| 7.22EXT|
| KRNL64NUC          | 7.49   | 7.49   |
| KRNL64UC           | 8.04   | 8.04   |
| KRNL64UC           | 7.22   | 7.22   |
| KRNL64UC           | 7.22EXT| 7.22EXT|
| KRNL64UC           | 7.49   | 7.49   |
| KRNL64UC           | 7.53   | 7.53   |
| KRNL64UC           | 7.73   | 7.73   |
| KERNEL             | 7.22   | 7.22   |
| KERNEL             | 8.04   | 8.04   |
| KERNEL             | 7.49   | 7.49   |
| KERNEL             | 7.53   | 7.53   |
| KERNEL             | 7.73   | 7.73   |

**CVSS**

**CVSS Score:** 7.5

**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** None (N)
- **Integrity Impact (I):** None (N)
- **Availability Impact (A):** High (H)

**References**

This document is referenced by [SAP Note 3104060: Work process in status "RUN" Action "ENQ"](https://me.sap.com/notes/3104060)

**Download Patches**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000819082021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003020104?language=en-US&token=0E2591EE64114728D3C49B07285D94B5)

**Credits**

Credits to [Redrays.io](https://redrays.io) for support in providing this information.