SAP Security Note 3007888 - CVE-2021-21486: Missing Authorization Check in SAP Enterprise Financial Services (Bank Customer Accounts)

**Description**

**Symptom**  
SAP Bank Customer Accounts (BCA) does not perform necessary authorization checks for authenticated users, allowing them to completely modify reference limits beyond their defined roles. Exploiting this vulnerability requires in-depth system knowledge to invoke specific functions that take advantage of the altered limits.

**Other Terms**  
- Access control
- Authorization error
- Authorization profile  
- [CVE-2021-21486](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21486)

**Reason and Prerequisites**  
Usage of reference limits for Banking Customer Accounts.

**Solution**  
The affected functions now properly enforce access restrictions. To mitigate this vulnerability:
1. **Import the relevant Support Package** for your SAP release.
2. **Use transaction SNOTE** to implement the attached correction instructions.

**Manual Activities**  
To maintain `V_TVIMF`:
1. Go to `SM30`, enter `V_TVIMF`, and press **Maintain**.
2. In the pop-up **Determine Work Area: Entry**, enter `V_TBKKE2` and continue.
3. In change mode, select **New Entries** and input the following:
   - **T:** `25` (Individual authorization checks)
   - **FORM routine:** `BKK_COA_AUTHORITY_CHECK`
4. Save your changes.

**CVSS**

- **CVSS Score:** 6.8  
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N](https://www.first.org/cvss/score)

**Support Packages**  
The following support packages address this vulnerability:

| Software Component | Software Component Version | Support Package | [URL](https://me.sap.com/supportpackage/SAPK-10110INS4CORE) |
|--------------------|----------------------------|-----------------|-----------------------------------------------------------|
| S4CORE             | 101                        | SAPK-10110INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10110INS4CORE) |
| S4CORE             | 102                        | SAPK-10208INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10208INS4CORE) |
| S4CORE             | 103                        | SAPK-10306INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10306INS4CORE) |
| S4CORE             | 104                        | SAPK-10404INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10404INS4CORE) |
| S4CORE             | 105                        | SAPK-10502INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10502INS4CORE) |
| EA-FINSERV         | 600                        | [SAPKGPFD35](https://me.sap.com/supportpackage/SAPKGPFD35) | [Link](https://me.sap.com/supportpackage/SAPKGPFD35) |
| EA-FINSERV         | 603                        | SAPK-60324INEAFINSRV | [Link](https://me.sap.com/supportpackage/SAPK-60324INEAFINSRV) |
| EA-FINSERV         | 604                        | SAPK-60425INEAFINSRV | [Link](https://me.sap.com/supportpackage/SAPK-60425INEAFINSRV) |
| EA-FINSERV         | 605                        | SAPK-60522INEAFINSRV | [Link](https://me.sap.com/supportpackage/SAPK-60522INEAFINSRV) |
| EA-FINSERV         | 606                        | SAPK-60628INEAFINSRV | [Link](https://me.sap.com/supportpackage/SAPK-60628INEAFINSRV) |
| EA-FINSERV         | 617                        | SAPK-61722INEAFINSRV | [Link](https://me.sap.com/supportpackage/SAPK-61722INEAFINSRV) |
| EA-FINSERV         | 618                        | SAPK-61816INEAFINSRV | [Link](https://me.sap.com/supportpackage/SAPK-61816INEAFINSRV) |
| EA-FINSERV         | 800                        | SAPK-80012INEAFINSRV | [Link](https://me.sap.com/supportpackage/SAPK-80012INEAFINSRV) |

**Additional Information**  
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000337942021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003007888?language=en-US&token=AB43F76C4653B3C9FC80E28F097ACFD3)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0003007888) *(Requires internal access)*
- [Share by Email](mailto:?subject=SAP%20Security%20Note%203007888&body=Check%20out%20this%20SAP%20Security%20Note%20-%203007888%3A%20https://me.sap.com/notes/3007888)
- [Open in New Window](https://me.sap.com/notes/3007888)

**Credits**  
Information provided with support from [RedRays.io](https://redrays.io).