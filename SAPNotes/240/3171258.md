3171258 - [CVE-2022-22965] Remote Code Execution vulnerability associated with Spring Framework used in SAP Commerce

## SAP Security Note 3171258 - CVE-2022-22965

**Symptom**

SAP Commerce uses a version of Spring Framework which has a Remote Code Execution vulnerability ([CVE-2022-22965](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965)).

**Affected Components**

- HAC
- Backoffice
- SmartEdit
- Accelerators

**Reason and Prerequisites**

This vulnerability affects all SAP Commerce web applications that utilize Spring MVC, making them susceptible to remote code execution attacks.

**Solution**

SAP Commerce addresses this vulnerability by updating to the latest versions of Spring libraries. The following patch releases resolve this issue:

- [SAP Commerce Cloud Patch Release 2105.10](https://help.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/2105/en-US/f9b65161e1e645249542e59f42f64a7b.html) (spring-beans 5.3.18)
- [SAP Commerce Cloud Patch Release 2011.20](https://help.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/2011/en-US/f9b65161e1e645249542e59f42f64a7b.html) (spring-beans 5.2.20)
- [SAP Commerce Cloud Patch Release 2005.25](https://help.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/2005/en-US/f9b65161e1e645249542e59f42f64a7b.html) (spring-beans 5.2.20)
- [SAP Commerce Cloud Patch Release 1905.41](https://help.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/1905/en-US/f9b65161e1e645249542e59f42f64a7b.html) (spring-beans 5.1.18-sap-spring4shell-patch)

You can download these or later patches from the [Software Downloads](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=MAINT&TA=ACTUAL/SAP%20COMMERCE) section of the SAP Support Portal. For installation guidance, refer to [About Patch Releases](https://help.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/2105/en-US/8c25978386691014b4abdd61376acd24.html).

**Workaround**

If upgrading to the latest SAP Commerce Cloud patch release is not immediately feasible, implement the workaround described in [Knowledge Base Article 3187386](https://me.sap.com/notes/3187386). Please evaluate the applicability of this workaround for your specific SAP landscape before implementation. Note that this is a temporary fix and not a permanent solution. SAP strongly recommends applying the corrections outlined in this security note as soon as possible.

**CVSS Score**

- **Score:** 9.8
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**References**

- [Spring4Shell: Zero-Day Vulnerability in Spring Framework on SAP Commerce (KBA 3187386)](https://me.sap.com/notes/3187386)

**Credits**

Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.