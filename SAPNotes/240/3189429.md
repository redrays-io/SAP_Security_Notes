3189429 - [CVE-2022-22965] Remote Code Execution vulnerability associated with Spring Framework used in PowerDesigner Web (upto including 16.7 SP05 PL01)

**Description**

PowerDesigner Web uses a version of the Spring Framework which has a Remote Code Execution vulnerability ([CVE-2022-22965](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965)). The default installation based on JRE 1.8 is not vulnerable. However, if you use another Java runtime or upgrade your Java to version 1.9 or higher, your installation may be subject to the Spring4Shell vulnerability.

**Affected Components**

- **Software Component:** SYBASE_POWERDESIGNER_WEBPORTAL
- **Version:** 16.7
- **Component Path:** Basis Components > Sybase Products > PowerDesigner

**Solution**

If you have upgraded your Java to version 1.9 or higher, you must either:

1. **Upgrade PowerDesigner Web** to the upcoming PowerDesigner 16.7 SP05 PL02.
2. **Use an earlier Java version** and modify the service as follows:

   - Open the **Windows Services** application.
   - Find and double-click on the service named **SAP PowerDesigner Portal 16.7**.
   - Copy the content of the **Path of Executables** line (typically `<installation-directory>\Tomcat\bin\Tomcat8.exe //RS//PortalServer16`).
   - Replace `Tomcat8.exe` with `Tomcat8w.exe` and `//RS//` with `//ES//` and run the modified command.
   - In the **Java Virtual Machine** field of the PowerDesigner Portal properties window, ensure it points to a Java 1.8 JRE (e.g., `<installation-directory>\sapjvm_8_jre\bin\java -version`).

**Workaround**

1. Stop the service from the **General** tab of the PowerDesigner Portal properties window.
2. Ensure Java 1.8 JRE is available (install if necessary).
3. Update the **Java Virtual Machine** path to the 1.8 `jvm.dll`.
4. Save the changes by clicking **OK**.
5. Start the service.

**CVSS**

- **Score:** 9.8
- **Vector:** `CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H`
  - **Attack Vector:** Network (N)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** Low (L)
  - **User Interaction:** None (N)
  - **Scope:** Unchanged (U)
  - **Confidentiality Impact:** High (H)
  - **Integrity Impact:** High (H)
  - **Availability Impact:** High (H)

**Attachments**

- [Java properties.png](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125800001203682022&iv_version=0003&iv_guid=00109B36D6AA1EDCADB01AA40E85E333)

**Additional Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000485452022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003189429?language=en-US&token=D7AD288DB0D2596F6029B8504B3350DB)

*For more information, visit [me.sap.com](https://me.sap.com/).*

**Credits**

Thanks to [redrays.io](https://redrays.io) for support in providing this information.