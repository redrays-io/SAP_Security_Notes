SAP Security Note 3194674 - CVE-2022-29612: Server-Side Request Forgery in SAP NetWeaver, ABAP Platform and SAP Host Agent

## Description

**Symptom**
SAP NetWeaver, ABAP Platform, and SAP Host Agent allow an authenticated user to misuse a function of `sapcontrol` web functionality (`startservice`) in the Kernel. This can enable malicious users to retrieve technical information such as system numbers or physical addresses, which are otherwise restricted, causing a limited impact on the confidentiality of the application.

**Other Terms**
- **SSRF**: Server-Side Request Forgery
- **Affected Components**: SAP NetWeaver, ABAP Platform, SAP Host Agent
- **CVE Identifier**: [CVE-2022-29612](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29612)

**Reason and Prerequisites**
The `sapcontrol` web functionality in the Kernel can be misused to provoke an error, enabling malicious users to retrieve information that could grant access to further network components, such as access from host A to host B. This function is intended for limited use cases and will be restricted.

## Impact
An attacker can obtain technical information like system numbers or physical addresses, which may aid in further compromising the system. The impact is limited to the confidentiality of the application.

## Solution

The solution involves blocking the execution of the vulnerable functionality for any caller, except in the following releases where SAP Host Agent is accepted as a legitimate caller:
- 7.22
- 7.49
- 7.53

**Action Steps:**
1. **Update SAP Kernel and SAP Host Agent**: Ensure that both are updated to at least the patch levels mentioned in this SAP Note.
2. **Apply the Latest SP Stack Kernel**: If it contains the necessary correction, refer to [SAP Note 2083594](https://me.sap.com/notes/2083594) for details on SAP Kernel Versions and Patch Levels.
3. **Apply Hotfix if Necessary**: Only apply the hotfix if you require the correction urgently.
4. **Upgrade Out-of-Maintenance Kernels**: If the correction isn't available for your kernel release, upgrade to a compatible downward compatible kernel as per [SAP Note 2083594](https://me.sap.com/notes/2083594).
5. **Review Regression Notes**: Before installing the patch, review the regression notes in [SAP Note 1802333](https://me.sap.com/notes/1802333).
6. **Download and Install Patches**: Follow the instructions in [SAP Note 19466](https://me.sap.com/notes/19466) for downloading and installing kernel patches.

For detailed SAP recommendations, refer to the [Update Strategy for the Kernel of the Application Server ABAP in On-Premise Landscapes](https://support.sap.com/deployment-strategies-kernel-abap.pdf).

## Affected Components

- **Components**: BC-CST-STS, Basis Components > Client/Server Technology > Startup Service
- **Software Components**: KRNL64NUC, KRNL64UC, SAPHOSTAGENT, KERNEL

## CVSS Score

- **Score**: 5.0
- **Vector**: [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N](https://www.first.org/cvss/v3-0)

## Support Package Patches

Ensure that you apply the appropriate support package patches for your SAP Kernel version:

- **SAP KERNEL 7.88 64-BIT UNICODE**: [SP008 Patch 000008](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200017305&V=MAINT)
- **SAP KERNEL 7.87 64-BIT UNICODE**: [SP024 Patch 000024](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200016628&V=MAINT)
- *(Additional patches available in the Support Package Patches section of the SAP Note.)*

## References

- [SAP Kernel Versions and SAP Kernel Patch Levels (SAP Note 2083594)](https://me.sap.com/notes/2083594)
- [Finding information about regressions in the SAP kernel (SAP Note 1802333)](https://me.sap.com/notes/1802333)
- [Downloading SAP kernel patches (SAP Note 19466)](https://me.sap.com/notes/19466)

For more information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for support and providing the information.*