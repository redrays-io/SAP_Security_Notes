SAP Security Note 3165801 - CVE-2022-29611: Missing Authorization Check in SAP NetWeaver

**Description**

*Update 28th June 2022:* This note has been re-released with updated 'Solution' information. We have removed the manual correction instruction.

*Update 14th June 2022:* This note has been re-released with updated 'Solution' information.

SAP NetWeaver Application Server for ABAP and ABAP Platform do not perform necessary authorization checks over the network for an authenticated user, resulting in escalation of privileges leading to a profound impact on confidentiality.

**Other Terms**

- Access control
- Authorization error
- Authorization profile
- [CVE-2022-29611](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29611)

**Reason and Prerequisites**

The contents of ABAP list output can be sent from the System Menu of the SAP Business System via e-mail without appropriate authorization check.

**Solution**

The correction introduces an authorization check on authorization object `S_OC_SEND` with IDs `COM_MODE` (value dummy) and `NUMBER` (value dummy).

Please implement the [Support Package](https://me.sap.com/supportpackage/SAPKB70225) mentioned in this SAP Note or the respective correction instruction.

*Note:* If your system runs with Kernel 7.22, it is important to have at least Kernel 7.22 PL10 to implement the correction instruction for technical reasons.

**CVSS**

- **CVSS Score:** 6.5
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** None (N)

**Affected Software Components**

| Software Component | From | To |
|--------------------|------|----|
| SAP_BASIS          | 700  | 702 |
| SAP_BASIS          | 710  | 711 |
| SAP_BASIS          | 730  | 730 |
| SAP_BASIS          | 731  | 731 |
| SAP_BASIS          | 740  | 740 |
| SAP_BASIS          | 750  | 756 |
| SAP_BASIS          | 787  | 788 |

**Support Package**

| Software Component Version | Support Package | URL                                          |
|----------------------------|-----------------|----------------------------------------------|
| SAP_BASIS 700              | SAPKB70040      | [Link](https://me.sap.com/supportpackage/SAPKB70040)      |
| SAP_BASIS 701              | SAPKB70125      | [Link](https://me.sap.com/supportpackage/SAPKB70125)      |
| SAP_BASIS 702              | SAPKB70225      | [Link](https://me.sap.com/supportpackage/SAPKB70225)      |
| SAP_BASIS 731              | SAPKB73131      | [Link](https://me.sap.com/supportpackage/SAPKB73131)      |
| SAP_BASIS 740              | SAPKB74028      | [Link](https://me.sap.com/supportpackage/SAPKB74028)      |
| SAP_BASIS 750              | SAPK-75025INSAPBASIS | [Link](https://me.sap.com/supportpackage/SAPK-75025INSAPBASIS) |
| SAP_BASIS 751              | SAPK-75115INSAPBASIS | [Link](https://me.sap.com/supportpackage/SAPK-75115INSAPBASIS) |
| SAP_BASIS 752              | SAPK-75211INSAPBASIS | [Link](https://me.sap.com/supportpackage/SAPK-75211INSAPBASIS) |
| SAP_BASIS 753              | SAPK-75309INSAPBASIS | [Link](https://me.sap.com/supportpackage/SAPK-75309INSAPBASIS) |
| SAP_BASIS 754              | SAPK-75407INSAPBASIS | [Link](https://me.sap.com/supportpackage/SAPK-75407INSAPBASIS) |
| SAP_BASIS 755              | SAPK-75505INSAPBASIS | [Link](https://me.sap.com/supportpackage/SAPK-75505INSAPBASIS) |
| SAP_BASIS 756              | SAPK-75603INSAPBASIS | [Link](https://me.sap.com/supportpackage/SAPK-75603INSAPBASIS) |
| SAP_BASIS 787              | SAPK-78707INSAPBASIS | [Link](https://me.sap.com/supportpackage/SAPK-78707INSAPBASIS) |
| SAP_BASIS 788              | SAPK-78801INSAPBASIS | [Link](https://me.sap.com/supportpackage/SAPK-78801INSAPBASIS) |

**References**

- [SAP Note 2198580](https://me.sap.com/notes/2198580) - Code injection vulnerability in ABAP

**Credits**

Information supported by [RedRays.io](https://redrays.io).