3165333 - [CVE-2022-28215] URL Redirection vulnerability in SAP NetWeaver ABAP Server and ABAP Platform

# Description

**SAP NetWeaver ABAP Server and ABAP Platform** allows an unauthenticated attacker to redirect users to a malicious site due to insufficient URL validation. This vulnerability could lead to users being tricked into disclosing personal information.

## CVSS Details

- **CVSS Score:** 4.7
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N)

  - **Attack Vector:** Network (N)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** None (N)
  - **User Interaction:** Required (R)
  - **Scope:** Changed (C)
  - **Confidentiality Impact:** Low (L)
  - **Integrity Impact:** None (N)
  - **Availability Impact:** None (N)

# Affected Versions

This vulnerability affects the following SAP_BASIS versions:

- 740
- 750 to 756
- 787

# Solution

The sanitization process has been corrected to suppress redirect information. To mitigate this vulnerability, apply the relevant Support Package or follow the correction instructions provided in the SAP Note.

## Support Packages

- **SAP_BASIS 740:** [SAPKB74028](https://me.sap.com/supportpackage/SAPKB74028)
- **SAP_BASIS 750:** [SAPK-75024INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75024INSAPBASIS)
- **SAP_BASIS 751:** [SAPK-75115INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75115INSAPBASIS)
- **SAP_BASIS 752:** [SAPK-75211INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75211INSAPBASIS)
- **SAP_BASIS 753:** [SAPK-75309INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75309INSAPBASIS)
- **SAP_BASIS 754:** [SAPK-75407INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75407INSAPBASIS)
- **SAP_BASIS 755:** [SAPK-75505INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75505INSAPBASIS)
- **SAP_BASIS 756:** [SAPK-75603INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75603INSAPBASIS)
- **SAP_BASIS 787:** [SAPK-78706INSAPBASIS](https://me.sap.com/supportpackage/SAPK-78706INSAPBASIS)

## Correction Instructions

For **SAP_BASIS**, apply the following manual activity:

1. Go to transaction **SE91**.
2. Enter message class name **'HTTP_CHW_MSG'**.
3. Enter message number **207**.
4. Click on **Change**.
5. Update row **207** with the text: `'The redirect URL &1 is invalid.'`.
6. Click on the **SAVE** button.

# References

- [SAP Note 3198137](https://me.sap.com/notes/3198137) – Update 1 to Security Note 3165333
- [SAP Note 3024048](https://me.sap.com/notes/3024048) – Format of correction instructions; unable to read correction instructions.

# Additional Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000479492022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003165333?language=en-US&token=72356B78AE97B3EA0CB4C974190B6E53)
- [Show Changes](https://me.sap.com/notesLatestChanges/0003165333/E/diff)

# Credits

Credits to [redrays.io](https://redrays.io) for support in providing this information.