SAP Security Note 3187290: Remote Code Execution Vulnerability in SAP Customer Checkout

**Description**

### Symptom
SAP Customer Checkout uses a version of the Spring Framework which has a Remote Code Execution vulnerability ([CVE-2022-22965](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965)).

### Other Terms
- Remote Code Execution
- Spring4Shell
- Spring Framework
- [CVE-2022-22965](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965)

### Reason and Prerequisites
**SAP Customer Checkout - POS and manager**:
- Versions 2.0 FP13 PL00
- Versions 2.0 FP12 PL09 (or lower)
- Versions 2.0 FP11 PL08 (or lower)

These versions are using the Spring Framework which is vulnerable to [CVE-2022-22965](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965). Therefore, the security vulnerability is applicable to SAP Customer Checkout and SAP Customer Checkout Manager.

### Solution
To prevent exploiting this vulnerability, the following updates are recommended:

**Recommended solution**: Update to one of the following versions that use a newer version of the Spring Framework:
- SAP Customer Checkout 2.0 FP13 PL01 or higher.
- SAP Customer Checkout 2.0 FP12 PL10 or higher.
- SAP Customer Checkout 2.0 FP11 PL09 or higher.

**Additional Recommendations**:
- Customers on SAP Customer Checkout 2.0 FP12 and SAP Customer Checkout 2.0 FP11 can also update to SAP Customer Checkout 2.0 FP13 PL01 or higher.
  - Feature Pack 13 includes all changes in Feature Pack 11 and Feature Pack 12.
- Customers on SAP Customer Checkout 2.0 FP11 can also update to SAP Customer Checkout 2.0 FP12 PL10 or higher.
  - Feature Pack 12 includes all changes in Feature Pack 11.

**SAP recommends updating as soon as possible.**

### CVSS
- **Score**: 9.8
- **Vector**: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**Detailed Metrics**:
- **Attack Vector (AV)**: Network (N)
- **Attack Complexity (AC)**: Low (L)
- **Privileges Required (PR)**: None (N)
- **User Interaction (UI)**: None (N)
- **Scope (S)**: Unchanged (U)
- **Confidentiality Impact (C)**: High (H)
- **Integrity Impact (I)**: High (H)
- **Availability Impact (A)**: High (H)

### Affected Software Components
- **SAP_CUSTOMER_CHECKOUT**: 2.0
- **SAP_CUSTOMER_CHECKOUT_SVR**: 2.0

### Support Package Patches
- **SAP CUSTOMER CHECKOUT 2.0**
  - SP012 Patch Level 000010: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200003473&support_package=SP012&patch_level=000010)
  - SP011 Patch Level 000009: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200003473&support_package=SP011&patch_level=000009)
  - SP013 Patch Level 000001: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200003473&support_package=SP013&patch_level=000001)

- **SAP CUST CHECKOUT MANAGER 2.0**
  - SP012 Patch Level 000010: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200003409&support_package=SP012&patch_level=000010)
  - SP011 Patch Level 000009: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200003409&support_package=SP011&patch_level=000009)
  - SP013 Patch Level 000001: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200003409&support_package=SP013&patch_level=000001)

### Downloads
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000485572022)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003187290?language=en-US&token=89ADFA0DBEA038FA65939ABCBEA10673)

### Available Languages
- [Deutsch (Machine Translation)](https://me.sap.com/notes/0003187290/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0003187290/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003187290/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003187290/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003187290/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003187290/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003187290/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003187290/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003187290/3)

**Credits**
Credits to [RedRays](https://redrays.io) for support in providing this information.