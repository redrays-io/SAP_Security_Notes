1477597 - Unauthorized modification of stored content in NW KMC

## SAP Note 1477597 - Unauthorized modification of stored content in NW KMC

**Type:** SAP Security Note  
**Version:** 6  
**Recency:** Updated  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 05.08.2016  
**Component:** Enterprise Portal > Enterprise Portal - Knowledge Management and Collaboration > Content Management

### Description

#### Symptom
The KMC resources like HTML and text documents can be abused by a malicious user allowing them to modify application content, and persist the modified content without authorization and to potentially obtain authentication information from other legitimate users.

#### Other Terms
Stored Cross Site Scripting, XSS, KMC resources

#### Reason and Prerequisites
Pages resulting in a stored cross site scripting issue.

It can be used to permanently modify displayed content from a website, allowing the malicious user to embed content that is rendered automatically, without the need to individually target victims.

Stored cross site scripting can also be used to steal another user’s authentication information such as data relating to their current session.

An attacker who gains access to this data may use this to impersonate the user and access all information with the same rights as the target user. In case of an administrator being impersonated, a full compromise of the application’s security may occur.

### Solution

**A.) The issue is cleared in these deliveries:**

- Patch 4 for KMC CONTENT MANAGEMENT 6.40 SP 23
- Patch 1 for KMC CONTENT MANAGEMENT 6.40 SP 24
- Patch 1 for KMC CONTENT MANAGEMENT 6.40 SP 25
- Patch 1 for KMC CONTENT MANAGEMENT 6.40 SP 26

- Patch 4 for KMC CONTENT MANAGEMENT 7.00 SP 19
- Patch 3 for KMC CONTENT MANAGEMENT 7.00 SP 20
- Patch 2 for KMC CONTENT MANAGEMENT 7.00 SP 21
- Patch 1 for KMC CONTENT MANAGEMENT 7.00 SP 22

- Patch 1 for SAP EHP1 FOR SAP NETWEAVER 7.0 SP4
- Patch 2 for SAP EHP1 FOR SAP NETWEAVER 7.0 SP5
- Patch 2 for SAP EHP1 FOR SAP NETWEAVER 7.0 SP6

- SAP EHP1 FOR SAP NETWEAVER 7.0 SP7
- SAP EHP1 FOR SAP NETWEAVER 7.0 SP8

- Patch 1 for SAP EHP2 FOR SAP NETWEAVER 7.0 SP3
- Patch 1 for SAP EHP2 FOR SAP NETWEAVER 7.0 SP4

- SAP EHP2 FOR SAP NETWEAVER 7.0 SP5

- SAP NETWEAVER 7.30 SP1

See [https://me.sap.com/sp-stacks](https://me.sap.com/sp-stacks) -> SP Stack Schedule for schedule details and updates.

**B.) Possible workaround before the release of mentioned deliveries:**  
None

### Manual Activities

You have to perform this manual activity separately in each system into which you transport the Note for implementation.

After applying the patch, navigate to **System Administration → System Configuration → Knowledge Management → Content Management → Protocols → (Show Advanced Options) → WebDAV** in the portal. Open the **WebDAV Protocol** configuration for editing and activate the parameter **"Force Text Download"**.

When the parameter **"Force Text Download"** is activated, the system does not allow you to open files containing executable scripts with your web browser, thus preventing the execution of potentially malicious scripts. Instead, when trying to open the file with a web browser, you are prompted to choose between the following options:

- Open the file for editing
- Download the file locally
- Cancel the operation

### References

This document is referenced by:

- **SAP Note 1473564** - [KMC in SAP NetWeaver 7.0 SPS23](https://me.sap.com/notes/1473564)

### Support Package Patches

- [KMC CONTENT MANAGEMENT 7.02 SP004 Patch Level 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP004&patch_level=000001)
- [KMC CONTENT MANAGEMENT 7.01 SP004 Patch Level 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP004&patch_level=000001)
- [KMC CONTENT MANAGEMENT 7.02 SP003 Patch Level 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP003&patch_level=000001)
- [KMC CONTENT MANAGEMENT 7.01 SP005 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP005&patch_level=000002)
- [KMC CONTENT MANAGEMENT 7.02 SP005 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP005&patch_level=000000)
- [KMC CONTENT MANAGEMENT 7.01 SP008 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP008&patch_level=000000)
- [KMC CONTENT MANAGEMENT 7.01 SP007 Patch Level 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP007&patch_level=000001)
- [KMC CONTENT MANAGEMENT 7.01 SP006 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP006&patch_level=000002)
- [KMC CONTENT MANAGEMENT 7.30 SP001 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP001&patch_level=000000)
- [KMC CONTENT MANAGEMENT 7.00 SP019 Patch Level 000004](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP019&patch_level=000004)
- [KMC CONTENT MANAGEMENT 7.00 SP020 Patch Level 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP020&patch_level=000003)
- [KMC CONTENT MANAGEMENT 7.00 SP021 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP021&patch_level=000002)
- [KMC CONTENT MANAGEMENT 7.00 SP022 Patch Level 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP022&patch_level=000001)
- [CM+COLLABORATION 6.0_640 SP023 Patch Level 000004](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004175&support_package=SP023&patch_level=000004)
- [KMC CONTENT MANAGEMENT 7.00 SP023 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP023&patch_level=000000)
- [CM+COLLABORATION 6.0_640 SP024 Patch Level 000004](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004175&support_package=SP024&patch_level=000004)
- [CM+COLLABORATION 6.0_640 SP025 Patch Level 000004](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004175&support_package=SP025&patch_level=000004)
- [CM+COLLABORATION 6.0_640 SP026 Patch Level 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004175&support_package=SP026&patch_level=000003)
- [CM+COLLABORATION 6.0_640 SP027 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004175&support_package=SP027&patch_level=000000)

*Credits to [redrays.io](https://redrays.io) for support to provided information.*