1458262 - ABAP: recommended settings for password hash algorithms

**SAP Note 1458262: ABAP - Recommended Settings for Password Hash Algorithms**

**Symptom**

There are known password hash attacks (see also [Note 1237762](https://me.sap.com/notes/1237762)). It's crucial to restrict access to password hash values (refer to [Note 1484692](https://me.sap.com/notes/1484692)) and ensure the utilization of the latest available password hash algorithms. This note provides guidance on configuring your system to enhance security in this area.

**Reason and Prerequisites**

ABAP systems use password-based authentication by comparing password hash values. Only the hash values and associated "code version" information are stored in the user master record. Over time, multiple password hash algorithms ("code versions") have been developed to maintain compatibility with older releases. However, maintaining this compatibility can prevent the use of more secure, newer hash algorithms or require storing additional legacy hash values.

**Solution**

The recommended settings depend on your system's SAP_BASIS version and its usage scenario:

- **Standalone ABAP Systems (Not part of a Central User Administration landscape):**
  - **SAP_BASIS 4.6x or 6.x:**  
    Set the profile parameter `login/password_charset` to `2`.  
    Refer to [Note 874738](https://me.sap.com/notes/874738) for more information.
  
  - **SAP_BASIS 7.x:**  
    Set the profile parameter `login/password_downwards_compatibility` to `0` and execute the report `CLEANUP_PASSWORD_HASH_VALUES` to remove redundant password hash values.  
    Be aware that this might affect compatibility with outdated frontend or middleware components. See [Note 1023437](https://me.sap.com/notes/1023437) for details.

- **ABAP Systems as Part of a Central User Administration (CUA) Landscape:**
  - **All CUA Members with SAP_BASIS 7.02 or Higher:**  
    Set `login/password_downwards_compatibility` to `0` and run `CLEANUP_PASSWORD_HASH_VALUES` across all systems to use "code version H".
  
  - **All CUA Members with SAP_BASIS 7.00 or 7.01:**  
    Similar to above, resulting in the use of "code version F".
  
  - **All CUA Members with SAP_BASIS 4.6x or 6.x:**  
    Set `login/password_charset` to `2` to use "code version E".
  
  - **Mixed SAP_BASIS Versions:**  
    Configure systems with SAP_BASIS 4.6x or 6.x to set `login/password_charset` to `2` and those with SAP_BASIS 7.00 or 7.01 to set `login/password_downwards_compatibility` to `1`, enabling the use of multiple code versions (B, E, and G).

**Attachments**

- [Note1458262.zip](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000132282010&iv_version=0002&iv_guid=EB24A3F3BAE03E4CB050F5E54E216387)

**References**

- [991968 - List of values for "login/password_hash_algorithm"](https://me.sap.com/notes/991968)
- [874738 - New password hash calculation procedure (code version E)](https://me.sap.com/notes/874738)
- [1237762 - ABAP systems: Protection against password hash attacks](https://me.sap.com/notes/1237762)
- [1023437 - ABAP syst: Downwardly incompatible passwords (since NW2004s)](https://me.sap.com/notes/1023437)

**Validity**

This note is applicable to the following SAP_BASIS versions:

- 4.6A to 4.6D+
- 6.10 to 6.40+
- 7.00 to 7.02+
- 7.10 to 7.30+

**Support Packages**

Ensure your system is updated with the relevant support packages for your SAP_BASIS version. For example:

- **SAP_BASIS 700:** [SAPKB70023](https://me.sap.com/supportpackage/SAPKB70023)
- **SAP_BASIS 701:** [SAPKB70108](https://me.sap.com/supportpackage/SAPKB70108)
- *(Refer to the Support Package section in the original note for a complete list.)*

**Correction Instructions**

There are three correction instructions available. You can access them [here](https://me.sap.com/corrins/0001458262/41).

---

*Credits: Thanks to [redrays.io](https://redrays.io) for supporting the information provided.*