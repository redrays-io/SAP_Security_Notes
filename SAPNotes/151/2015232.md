2015232 - Missing authorization check in XX-PART-OPT-INV

**SAP Note Number**: 2015232  
**Title**: Missing authorization check in XX-PART-OPT-INV  
**Type**: SAP Security Note  
**Version**: 2  
**Recency**: New  
**Released On**: 09.09.2014  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer

## Description

### Symptom

An authenticated user can use functions of XX-PART-OPT-INV to which access should be restricted. This may result in an escalation of privileges.

### CVSS Information

- **CVSS Base Score**: 6.0  
- **CVSS Vector**: AV:N/AC:M/AU:S/C:P/I:P/A:P

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/securitynotes/).

### Reason and Prerequisites

XX-PART-OPT-INV does not contain authorization checks for verifying an authenticated user's authorization to access some of its functions. This may result in undesired system behavior.

## Solution

1. **Function Module `/PTGWFI/CP_CALLTRANSACTION`**:
   - When calling the function module to open a transaction code, use the authorization object **S_RFCACL**.
   - Maintain the destination system as a trusted system using transaction code **SMT1**.
   - During the maintenance of the trusted system, it is mandatory to enable the check box "Use Transaction Code".
   - **Note**: This fix will be released as part of **VIM 7.0 SP4**.

2. **Function Modules `/OPT/VIM_RPT_GET_NPO_WI_DATA` and `/OPT/VIM_RPT_GET_PO_WI_DATA`**:
   - Call transaction **SE37**.
   - Change the processing type to "Normal Function Module" on the "Attributes" tab page.
   - Activate the function module again.

## How to Access the SAP Note

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018097092017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002015232?language=en-US&token=8E7D252CD8002F78CC6690E8813E22AE)

## Available Languages

- [Deutsch](https://me.sap.com/notes/0002015232/D)
- [日本語](https://me.sap.com/notes/0002015232/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002015232/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002015232/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002015232/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002015232/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002015232/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002015232/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002015232/3)

*Credits to [RedRays](https://redrays.io) for supporting the information provided.*