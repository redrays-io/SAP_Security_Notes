**SAP Security Note 2013153: Switchable Authorization Checks for RFC in Environment, Health & Safety**

Hello SAP Security Community,

I wanted to share important information regarding SAP Security Note **2013153** titled *"Switchable authorization checks for RFC in Environment, Health & Safety"*. This note introduces new, switchable authorization checks in RFC function modules within the Environment, Health & Safety (EHS) module to enhance security.

### **Symptom**
The system currently protects against unauthorized calls to RFC function modules using checks against the authorization object `S_RFC`. However, for certain RFC function modules in EHS, these checks alone are insufficient to guarantee secure execution as they often perform no additional authorization checks.

### **Reason and Prerequisites**
To ensure robust security, the authorizations for `S_RFC` must be minimized for all users. The new authorization checks address the shortcomings by implementing additional security layers for specific RFC function modules. This requires activating the new checks in transaction `SACF` and adjusting corresponding roles accordingly.

### **Solution**
**New Authorization Checks:**
The security note introduces several new authorization scenarios, each targeting specific business processes and function modules within EHS. These scenarios are delivered in inactive form to prevent disruptions to existing processes.

**Activation Steps:**
1. **Load Scenario Definitions:**
   - Use the attached `.TXT` files provided in the SAP Note to load the new authorization scenarios into your system via transaction `SACF_TRANSFER`.
  
2. **Create Productive Scenarios:**
   - Convert the loaded scenario definitions into productive scenarios using transaction `SACF`.
   - Choose between "Active" or "Logging" status:
     - **Active:** Activates authorization checks and logs successful and failed attempts.
     - **Logging:** Only logs attempts without enforcing authorization checks, useful for identifying required authorizations.

3. **Enable Audit Logging:**
   - Ensure the security audit log is active by configuring it in transaction `SM19`.
   - Activate relevant message IDs (`DUO`, `DUP`, `DUQ`) to monitor authorization checks.

**Implementation Instructions:**
Detailed step-by-step correction instructions are included in the SAP Note and can be accessed [here](https://me.sap.com/corrins/0002013153/1).

### **Attachments**
The SAP Note includes several attachment files essential for implementing the new authorization scenarios:
- [EHS_PS_REPORT.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000541152014&iv_version=0001&iv_guid=30B739CEE1E24F44BDCD07FBC412383F)
- [EHS_PS_GLM_PURCH_ORDER.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000541152014&iv_version=0001&iv_guid=549D0EF006918D48862979A0FB48443D)
- *(Additional attachments can be found within the SAP Note.)*

### **References**
For more context and related improvements, refer to the following SAP Notes:
- [2078596: Further improvements for RFC security](https://me.sap.com/notes/2078596)
- [2008727: Securing Remote Function Calls (RFC)](https://me.sap.com/notes/2008727)
- [1988903: Check whether a function module was called via external RFC](https://me.sap.com/notes/1988903)
- *(Additional references are listed in the SAP Note.)*

### **Software Compatibility**
This security note is applicable to various releases and support package levels for both `SAP_APPL` and `EA-APPL` components. Ensure you refer to the [Support Package section](https://me.sap.com/supportpackage/SAPKH60026) of the SAP Note to verify compatibility with your system.

### **Prerequisites**
Before implementing this security note, ensure the following prerequisites are met:
- SAP Note [1593384](https://me.sap.com/notes/1593384): Remote-enabled reading of work areas
- SAP Note [1595573](https://me.sap.com/notes/1595573): Reading data in the HRMS
- *(Additional prerequisites are detailed in the SAP Note.)*

### **Conclusion**
Implementing SAP Security Note 2013153 is crucial for enhancing the security of RFC function modules within the EHS module. By activating the new authorization checks and adjusting user roles, organizations can mitigate risks associated with unauthorized RFC calls.

For detailed instructions and further assistance, please refer to the SAP Note [2013153](https://me.sap.com/notes/2013153).

*Credits to [Redrays.io](https://redrays.io) for supporting the information provided.*