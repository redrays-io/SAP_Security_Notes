1501905 - Directory Traversal Vulnerability in Austrian FMA Reporting

**SAP Note**: 1501905  
**Type**: SAP Security Note  
**Version**: 6  
**Recency**: New  
**Language**: English (Master Language: German)  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer  
**Released On**: 14.12.2010  
**Component**: FS-SR-AT (Financial Services > Statutory Reporting for Insurancies > Austria)

### Description

This SAP Security Note addresses a directory traversal vulnerability with write or read and write authorization in the download function of the old solution for the Financial Market Authority (FMA) notifications of regulatory reporting in Austria. The vulnerability allows an attacker to read or write any data using the network.

**Affected Component**:
- **FS-SR-AT**

### Reason and Prerequisites

An error exists in the directory traversal mechanism when checking paths for data written by users in the old regulatory reporting solution for the Austrian FMA. This flaw can be exploited to transfer arbitrary data to the remote system or overwrite existing data.

### Solution

Refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional important information and instructions. The corrections in this note are a crucial prerequisite for implementing the fixes in Note 1501905.

**Corrections Implemented**:
- Created logical file names and paths to validate physical file names and paths.
- Updated relevant programs and classes to utilize these logical names and parameters.

### Actions

- **[Download for SNOTE](https://notesdownloads.sap.com/note/0040000008889982017)**
- **[PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001501905?language=en-US&token=900B52A7CB8D559B4959930B836EA9E6)**
- **[Share by Email](https://me.sap.com/)**
- **[Open in New Window](https://me.sap.com/)**

### Preconditions

To apply this correction, ensure that [Note 1497003](https://me.sap.com/notes/1497003) is implemented in your system.

### Support Package Details

The following support packages are available for different versions of the affected software components:

- **EA-FINSERV 110**: [SAPKGPFA32](https://me.sap.com/supportpackage/SAPKGPFA32)
- **EA-FINSERV 200**: [SAPKGPFB21](https://me.sap.com/supportpackage/SAPKGPFB21)
- **BANK/CFM 463_20**: [SAPKIPBJ40](https://me.sap.com/supportpackage/SAPKIPBJ40)
- & more...

### References

- [Potential directory traversals in applications - Note 1497003](https://me.sap.com/notes/1497003)

For more detailed information, you can visit the [SAP support portal](https://me.sap.com/).

*Credits to [Red Rays](https://redrays.io) for support in providing this information.*