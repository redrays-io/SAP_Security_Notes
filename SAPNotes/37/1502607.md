SAP Note 1502607 - Potential disclosure of persisted data

---

**Description**

A malicious user can exploit CRM Middleware and use specially crafted inputs to retrieve additional information persisted by the system.

**Symptom**

A malicious user can exploit CRM Middleware and use specially crafted inputs to retrieve additional information persisted by the system.

**Reason and Prerequisites**

The problem is caused by an SQL injection vulnerability. The code composes an SQL statement including strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve data from the database.

**Solution**

Import the Support Package specified below.

If you want to implement the correction instructions, follow the manual steps.

**Support Package**

| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| PI 2004_1_46C | SAPKIPZI4J | [Link](https://me.sap.com/supportpackage/SAPKIPZI4J) |
| PI_BASIS 2005_1_620 | SAPKIPYJ5M | [Link](https://me.sap.com/supportpackage/SAPKIPYJ5M) |
| PI_BASIS 2005_1_640 | SAPKIPYJ6M | [Link](https://me.sap.com/supportpackage/SAPKIPYJ6M) |
| PI_BASIS 2005_1_700 | SAPKIPYJ7O | [Link](https://me.sap.com/supportpackage/SAPKIPYJ7O) |
| PI_BASIS 2006_1_620 | SAPKIPYK12 | [Link](https://me.sap.com/supportpackage/SAPKIPYK12) |
| PI_BASIS 2006_1_640 | SAPKIPYL12 | [Link](https://me.sap.com/supportpackage/SAPKIPYL12) |
| PI_BASIS 2006_1_700 | SAPKIPYM14 | [Link](https://me.sap.com/supportpackage/SAPKIPYM14) |
| PI_BASIS 2006_1_710 | SAPKIPYN12 | [Link](https://me.sap.com/supportpackage/SAPKIPYN12) |
| PI_BASIS 701 | SAPK-70108INPIBASIS | [Link](https://me.sap.com/supportpackage/SAPK-70108INPIBASIS) |
| PI_BASIS 702 | SAPK-70207INPIBASIS | [Link](https://me.sap.com/supportpackage/SAPK-70207INPIBASIS) |
| PI_BASIS 711 | SAPK-71107INPIBASIS | [Link](https://me.sap.com/supportpackage/SAPK-71107INPIBASIS) |
| PI_BASIS 730 | SAPK-73002INPIBASIS | [Link](https://me.sap.com/supportpackage/SAPK-73002INPIBASIS) |

**Correction Instructions**

1. **Manual Pre-Implementation**
   - Create the authorization object according to [Note 1499392](https://me.sap.com/notes/1499392) and assign the relevant authorizations.

2. **Manual Post-Implementation**
   - In transaction SE91, create message 066 in the message class `C_` with the following text: "No authorization to select the data. See Note 1498111."
   - Call transaction SE11 and change the table `CRMATAB`.
     - On the "Delivery and Maintenance" tab page, set "Display/Maintenance Allowed with Restrictions."
   - Call transaction SE55 for the table `CRMRFCPAR`. From the menu, choose "Environment → Modification → Events" and create the event 25 with the form routine `check_auth`.
   - Follow the instructions from [Note 1501685](https://me.sap.com/notes/1501685).

**Prerequisites**

Ensure the following software components are within the supported versions:

| Software Component | From | To | SAP Note/KBA | Title | Component |
|--------------------|------|----|--------------|-------|-----------|
| PI | 2004_1_46C | 2004_1_46C | [1502607](https://me.sap.com/notes/1502607) | Potential disclosure of persisted data | CRM-MW-ADP |
| PI_BASIS | 2003_1_620 | 2004_1_640 | [761992](https://me.sap.com/notes/761992) | Entries with empty key fields exist in CRMRFCPAR | CRM-MW-ADP |
| PI_BASIS | 2004_1_620 | 730 | [1498366](https://me.sap.com/notes/1498366) | DIMa: Missing authorization check, header table in ERP | CRM-MW-ADP |
| PI_BASIS | 2004_1_620 | 730 | [1502607](https://me.sap.com/notes/1502607) | Potential disclosure of persisted data | CRM-MW-ADP |

**References**

- [Note 1501685 - Table CRMATAB is empty](https://me.sap.com/notes/1501685)
- [Note 1499392 - Missing authorization check in CRM Middleware extractor](https://me.sap.com/notes/1499392)
- [Note 1498111 - No authorization for data selection in initial load](https://me.sap.com/notes/1498111)

**Side Effects**

This document is causing side effects in [Note 1501685](https://me.sap.com/notes/1501685).

---

Credits to [redrays.io](https://redrays.io) for support to provided information.