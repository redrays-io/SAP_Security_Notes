1502272 - Function module for escaping quotes

**SAP Security Note 1502272 - Function module for escaping quotes**

**Description**

**Symptom**
New function modules are provided with this note. The new function modules are:
- `RS_ESCAPE_QUOTES`
- `RS_CHECK_VARIABLE`
- `RS_CHECK_WHITELIST_TAB`

Implementing the function modules is required only if another note specifies this note as a prerequisite.

**Reason and Prerequisites**
The new function modules are used as the basis for various quality improvement measures in the dynamic programming area. This includes the composition of dynamic WHERE clauses, dynamic SET clauses, and program texts that should be created with `INSERT REPORT` or `GENERATE SUBROUTINE-POOL`.

The functions of the function modules `RS_ESCAPE_QUOTES`, `RS_CHECK_VARIABLE`, and `RS_CHECK_WHITELIST_TAB` will be provided in later releases by the class `CL_ABAP_DYN_PRG`. As of SAP_BASIS Release 700, you must use the class `CL_ABAP_DYN_PRG`. For compatibility reasons, however, the function modules are also provided in Release SAP_BASIS 700 and higher.

**Solution**
You can implement the new function modules via Support Package or via the Note Assistant. This note contains three correction instructions:
1. For Releases 31I, 40B, and 45B
2. For Releases 46B and 46C
3. For SAP_BASIS Releases 620, 640, 700, 701, 702, 710, 711, 720, and 730

**Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008891972017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001502272?language=en-US&token=E0641A91C5801EC2FB4BC2E483D90D29)

**Validity**

**SAP_APPL**
- Release 31I until [SAPKH31IB9](https://me.sap.com/corrins/0001502272/1)
- Release 40B until [SAPKH40B89](https://me.sap.com/corrins/0001502272/1)
- Release 45B until [SAPKH45B67](https://me.sap.com/corrins/0001502272/1)

**SAP_BASIS**
- Release 46B to 46C
- Release 620 to 640
- Release 700 to 702
- Release 710 to 730

**Support Package**
- [SAP_APPL 31I - SAPKH31IB9](https://me.sap.com/supportpackage/SAPKH31IB9)
- [SAP_APPL 40B - SAPKH40B89](https://me.sap.com/supportpackage/SAPKH40B89)
- [SAP_APPL 45B - SAPKH45B67](https://me.sap.com/supportpackage/SAPKH45B67)
- [SAP_BASIS 46B - SAPKB46B62](https://me.sap.com/supportpackage/SAPKB46B62)
- [SAP_BASIS 46C - SAPKB46C61](https://me.sap.com/supportpackage/SAPKB46C61)
- [SAP_BASIS 620 - SAPKB62069](https://me.sap.com/supportpackage/SAPKB62069)
- [SAP_BASIS 640 - SAPKB64027](https://me.sap.com/supportpackage/SAPKB64027)
- [SAP_BASIS 700 - SAPKB70023](https://me.sap.com/supportpackage/SAPKB70023)
- [SAP_BASIS 701 - SAPKB70108](https://me.sap.com/supportpackage/SAPKB70108)
- [SAP_BASIS 702 - SAPKB70206](https://me.sap.com/supportpackage/SAPKB70206)
- [SAP_BASIS 710 - SAPKB71011](https://me.sap.com/supportpackage/SAPKB71011)
- [SAP_BASIS 711 - SAPKB71106](https://me.sap.com/supportpackage/SAPKB71106)

**Correction Instructions**
- **SAP_BASIS**: 2 Correction Instructions [View Details](https://me.sap.com/corrins/0001502272/41)
- **SAP_APPL**: 1 Correction Instruction [View Details](https://me.sap.com/corrins/0001502272/1)

**CVSS**
- **CVSS Score**: 0
- **CVSS Vector**: Not applicable

**References**
This document refers to:
- [SAP Note 1520356 - Avoiding SQL Injections](https://me.sap.com/notes/1520356)
- [SAP Note 1487337 - Downporting the class CL_ABAP_DYN_PRG](https://me.sap.com/notes/1487337)
- [SAP Note 1915995](https://me.sap.com/notes/1915995)
- [SAP Note 1778100](https://me.sap.com/notes/1778100)
- [SAP Note 1772474](https://me.sap.com/notes/1772474)

This document is referenced by:
- [SAP Note 1838541 - Syntax error in program /APB/POWLFEEDERSEL.](https://me.sap.com/notes/1838541)
- [SAP Note 1819965 - SDBI_CLUSTER_CHECK 4.6C: Endless loop for cluster records with single quotation marks in the key](https://me.sap.com/notes/1819965)
- [SAP Note 1520356 - Avoiding SQL Injections](https://me.sap.com/notes/1520356)

*Credits: Information provided by [Redrays.io](https://redrays.io) for supporting the creation of this post.*