1794273 - Persisted data in MAP may be changed/disclosed

**SAP Security Note 1794273**

**Type:** SAP Security Note  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 28.10.2013  
**Component:** Logistics - General > Merchandise and Assortment Planning (LO-MAP)  
**Version:** 2  
**Language:** English  
**Master Language:** German

### Description

**Symptom**

An attacker can exploit vulnerabilities within merchandise and assortment planning and use specially crafted inputs to modify database commands. This results in either the retrieval of additional information, or the modification of data persisted by the system.

**Other Terms**

SQL injection, database, MAP

**Reason and Prerequisites**

The problem is caused by an SQL injection vulnerability.  
The code composes an SQL statement that contains strings that can be altered by an attacker.  
The manipulated SQL statement can then be used to retrieve additional data from the database, or to modify the data.

**Solution**

Implement the attached correction instructions.  
[Download for SNOTE](https://notesdownloads.sap.com/note/0040000010601862017)  
[PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001794273?language=en-US&token=38D64F8D99FF4018D2587EEB0AC439B2)  
[Show Changes](/me.sap.com/notesLatestChanges/0001794273/E/diff)

### Available Actions

- [Share by Email](/me.sap.com/shareEmail)
- [Open in New Window](/me.sap.com/openNewWindow)

### References

**Side Effects Causing:**
- [Runtime error when entering the manual planning](https://me.sap.com/notes/0001888669)

### Software Components Affected

- **SAP_APPL** from 46C to 46C
- **SAP_APPL** from 470 to 470
- **SAP_APPL** from 500 to 500
- **SAP_APPL** from 600 to 600
- **SAP_APPL** from 602 to 602
- **SAP_APPL** from 603 to 603
- **SAP_APPL** from 604 to 604
- **SAP_APPL** from 605 to 605
- **SAP_APPL** from 606 to 606
- **SAP_APPL** from 616 to 616
- **PI** from 2004_1_470 to 2004_1_500

### Support Packages

- [SAPKIPZI5J](https://me.sap.com/supportpackage/SAPKIPZI5J) for PI 2004_1_470
- [SAPKIPZI6L](https://me.sap.com/supportpackage/SAPKIPZI6L) for PI 2004_1_500
- [SAPKH46C66](https://me.sap.com/supportpackage/SAPKH46C66) for SAP_APPL 46C
- [SAPKH47040](https://me.sap.com/supportpackage/SAPKH47040) for SAP_APPL 470
- [SAPKH50029](https://me.sap.com/supportpackage/SAPKH50029) for SAP_APPL 500
- [SAPKH60023](https://me.sap.com/supportpackage/SAPKH60023) for SAP_APPL 600
- [SAPKH60213](https://me.sap.com/supportpackage/SAPKH60213) for SAP_APPL 602
- [SAPKH60312](https://me.sap.com/supportpackage/SAPKH60312) for SAP_APPL 603
- [SAPKH60413](https://me.sap.com/supportpackage/SAPKH60413) for SAP_APPL 604
- [SAPKH60510](https://me.sap.com/supportpackage/SAPKH60510) for SAP_APPL 605
- [SAPKH60606](https://me.sap.com/supportpackage/SAPKH60606) for SAP_APPL 606
- [SAPKH61601](https://me.sap.com/supportpackage/SAPKH61601) for SAP_APPL 616

### Correction Instructions

- [SAP_APPL Corrections](https://me.sap.com/corrins/0001794273/1) (3 Instructions)
- [PI Corrections](https://me.sap.com/corrins/0001794273/48) (1 Instruction)

For more details and updates, visit the [SAP Security Notes](https://me.sap.com/notes/0001794273).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*