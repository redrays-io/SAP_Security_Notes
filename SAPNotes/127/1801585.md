1801585 - Potential disclosure of persisted data in "ABAP Selections"

## Description

An attacker can exploit "ABAP Selections" and use specially crafted inputs to modify database commands, resulting in the retrieval of additional information persisted by the system.

**Other Terms:**
- SQL injection, database, "ABAP Selections"
- Function Group SSEL, free selection API for ABAP programs
- Error message SLDBV:080

## Vulnerability Details

### Reason and Prerequisites

The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by an attacker. The manipulated SQL statement can then be used to retrieve data from the database.

### Solution

Please apply the support package mentioned in this note, or the respective correction instruction. The correction ensures that there is a stricter check of database column names that may have been supplied by an attacker.

## Affected Software Components

- **SAP_BASIS** versions:
  - 620 to 640
  - 700 to 702
  - 710 to 731
  - 740

## Support Packages

- [SAPKB62074](https://me.sap.com/supportpackage/SAPKB62074) for SAP_BASIS 620
- [SAPKB64032](https://me.sap.com/supportpackage/SAPKB64032) for SAP_BASIS 640
- [SAPKB70029](https://me.sap.com/supportpackage/SAPKB70029) for SAP_BASIS 700
- [SAPKB70114](https://me.sap.com/supportpackage/SAPKB70114) for SAP_BASIS 701
- [SAPKB70214](https://me.sap.com/supportpackage/SAPKB70214) for SAP_BASIS 702
- [SAPKB71017](https://me.sap.com/supportpackage/SAPKB71017) for SAP_BASIS 710
- [SAPKB71112](https://me.sap.com/supportpackage/SAPKB71112) for SAP_BASIS 711
- [SAPKB72008](https://me.sap.com/supportpackage/SAPKB72008) for SAP_BASIS 720
- [SAPKB73010](https://me.sap.com/supportpackage/SAPKB73010) for SAP_BASIS 730
- [SAPKB73108](https://me.sap.com/supportpackage/SAPKB73108) for SAP_BASIS 731
- [SAPKB73107](https://me.sap.com/supportpackage/SAPKB73107) for SAP_BASIS 731
- [SAPKB74002](https://me.sap.com/supportpackage/SAPKB74002) for SAP_BASIS 740

## Correction Instructions

Follow the correction instructions provided [here](https://me.sap.com/corrins/0001801585/41).

## Prerequisites

Ensure the following SAP Notes are applied before implementing this security note:

- [1487337](https://me.sap.com/notes/1487337) - Downporting the class CL_ABAP_DYN_PRG
- [1717578](https://me.sap.com/notes/1717578) - CL_ABAP_DYN_PRG: Database column name with semicolon
- [1502272](https://me.sap.com/notes/1502272) - Function module for escaping quotes

## CVSS

- **CVSS Score:** 0
- **CVSS Vector:** Not provided

## Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010645652017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001801585?language=en-US&token=7EA48E8C63228ACB4664B21362C9DA50)

Credits to [redrays.io](https://redrays.io) for support to provided information.