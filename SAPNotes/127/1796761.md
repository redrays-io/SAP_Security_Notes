1796761 - Directory traversal in CRM Handheld Service

**SAP Note**: 1796761  
**Type**: SAP Security Note  
**Version**: 2  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with medium priority  
**Status**: Released for Customer  
**Released On**: 13.08.2013  
**Component**: Collaborative Cross Applications > Mobile Business Applications > Use CRM-MSE(Handheld Service)  

### Symptom
**Read-write or write directory traversal:**

CRM Handheld Service contains a vulnerability through which an attacker can potentially write arbitrary files to the remote server, possibly corrupting data or altering system behavior.

### Other Terms
Directory traversal, CRM Handheld Service.

### Reason and Prerequisites
**Read-write or write directory traversal:**

CRM Handheld Service fails to correctly validate the path to which a user-submitted file is written. As a result, an attacker can potentially overwrite data in the remote system.

### Solution
1. **Follow the manual instructions.**
2. **Implement the attached correction instructions.**

### Manual Activities
**Caution**: You have to perform this manual activity separately in each system into which you transport the Note for implementation.

**Steps:**
1. Navigate to transaction: **FILE**
2. Create a new entry for **Logical File Path Definition** with the following values:
   - **Logical file path**: `HANDHELD_LOGICALPATH`
   - **Name**: `Handheld Logical Filepath`
3. Create a new entry for **Logical File Name Definition**, Cross-Client with the following values:
   - **Logical file**: `HANDHELD_SURVEY`
   - **Name**: `Handheld Survey`
   - **Data format**: `DIR`
   - **Applicat.area**: `CR`
   - **Logical path**: `HANDHELD_LOGICALPATH`
4. Save the entries

_For more information, refer to the [SAP Note 1497003](https://me.sap.com/notes/1497003)._

### Correction Instructions
Implement the correction instructions available [here](https://me.sap.com/corrins/0001796761/63).

### Supported Software Components

| Software Component | From | To |
|--------------------|------|----|
| BBPCRM             | 500  | 500 |
| BBPCRM             | 600  | 600 |
| BBPCRM             | 700  | 700 |
| BBPCRM             | 701  | 701 |
| BBPCRM             | 702  | 702 |
| BBPCRM             | 712  | 712 |
| BBPCRM             | 713  | 713 |

### Support Packages
Available support packages for affected software components:

- [SAPKU50023](https://me.sap.com/supportpackage/SAPKU50023) for BBPCRM 500
- [SAPKU50022](https://me.sap.com/supportpackage/SAPKU50022) for BBPCRM 500
- [SAPKU60013](https://me.sap.com/supportpackage/SAPKU60013) for BBPCRM 600
- [SAPKU60014](https://me.sap.com/supportpackage/SAPKU60014) for BBPCRM 600
- [SAPKU70013](https://me.sap.com/supportpackage/SAPKU70013) for BBPCRM 700
- [SAPKU70014](https://me.sap.com/supportpackage/SAPKU70014) for BBPCRM 700
- [SAPKU70110](https://me.sap.com/supportpackage/SAPKU70110) for BBPCRM 701
- [SAPKU70111](https://me.sap.com/supportpackage/SAPKU70111) for BBPCRM 701
- [SAPKU70206](https://me.sap.com/supportpackage/SAPKU70206) for BBPCRM 702
- [SAPKU70209](https://me.sap.com/supportpackage/SAPKU70209) for BBPCRM 702
- [SAPKU71201](https://me.sap.com/supportpackage/SAPKU71201) for BBPCRM 712
- [SAPKU71204](https://me.sap.com/supportpackage/SAPKU71204) for BBPCRM 712
- [SAPKU71302](https://me.sap.com/supportpackage/SAPKU71302) for BBPCRM 713

### Download
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010616862017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001796761?language=en-US&token=EE3AB571CE82360F512D7989358AC9C2)

*Credits to [RedRays](https://redrays.io) for support and information.*