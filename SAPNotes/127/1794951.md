1794951 - Directory traversal in XX-CSC-BR

# SAP Security Note 1794951 - Directory traversal in XX-CSC-BR

**Description**

### Symptom
Potential Directory Traversal in:
- **XX-CSC-BR**

Read-write or write directory traversal:
The report contained in the correction instructions includes a vulnerability that allows an attacker to potentially write arbitrary files to the remote server, which could corrupt data or alter system behavior.

### Other Terms
- Directory traversal
- XX-CSC-BR
- XX-CSC-BR-REP

### Reason and Prerequisites
The report in the correction instructions fails to properly validate the path where a user-submitted file is written. As a result, an attacker can potentially overwrite data on the remote system.

**Prerequisites:**
- You have implemented [Note 1782959](https://me.sap.com/notes/1782959).

### Solution
Please refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The corrections from this note are a prerequisite for implementing Note 1794951.

**Logical File Name Used in this Solution**
- **REP_BR_EFD_FILE**

**Logical File Paths Used in this Solution**
- **BR_REP_SPED_CONTRIBUTIONS**

**Recommendations for Setup of Logical File Names:**
1. **Create Data Element J_1BPIS_FILE_NAME**
    - Execute transaction SE11.
    - Select the "Data type" radio button.
    - Enter "J_1BPIS_FILE_NAME" and create the data element with appropriate field labels.
2. **Create Logical File Path BR_REP_SPED_CONTRIBUTIONS**
    - Execute transaction FILE.
    - Define new entries for logical file paths with appropriate physical paths for different syntax groups (DOS, UNIX, WINDOWS NT).
3. **Create Logical File Name REP_BR_EFD_FILE**
    - Execute transaction FILE.
    - Define the logical file name with data format "DIR" and assign it to the logical path "BR_REP_SPED_CONTRIBUTIONS".

For detailed step-by-step instructions, refer to the **Manual Activities** section in the original security note.

### Support Packages
Ensure that the following support packages are applied based on your software component version:

- **SAP_APPL 46C:** [SAPKH46C66](https://me.sap.com/supportpackage/SAPKH46C66)
- **SAP_APPL 470:** [SAPKH47040](https://me.sap.com/supportpackage/SAPKH47040)
- **SAP_APPL 500:** [SAPKH50029](https://me.sap.com/supportpackage/SAPKH50029)
- **SAP_APPL 600:** [SAPKH60023](https://me.sap.com/supportpackage/SAPKH60023)
- **SAP_APPL 602:** [SAPKH60213](https://me.sap.com/supportpackage/SAPKH60213)
- **SAP_APPL 603:** [SAPKH60312](https://me.sap.com/supportpackage/SAPKH60312)
- **SAP_APPL 604:** [SAPKH60413](https://me.sap.com/supportpackage/SAPKH60413)
- **SAP_APPL 605:** [SAPKH60510](https://me.sap.com/supportpackage/SAPKH60510)
- **SAP_APPL 606:** [SAPKH60606](https://me.sap.com/supportpackage/SAPKH60606)
- **SAP_APPL 616:** [SAPKH61601](https://me.sap.com/supportpackage/SAPKH61601)

### Download and Resources
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010605972017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001794951?language=en-US&token=6E46020118B733B78F96B86CC0FC9BB3)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001794951/E/diff)

### References
- [Note 1782959 - Directory traversal in XX-CSC-BR](https://me.sap.com/notes/1782959)
- [Note 1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Credits**
Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.