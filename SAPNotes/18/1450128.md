1450128 - Code injection vulnerability in ECC and SAP R/3

**Symptom**

SAP R/3 4.6, Enterprise R/3 4.7,  ECC 5.00, ECC 6.00 - 6.04 contain code which allows execution of arbitrary program code of the user's choice. A malicious user can therefore control the behavior of the system or potentially escalate privileges by executing malicious code without legitimate credentials.

**Other Terms**

Backdoor, injection, run, credentials, SAP R/3, SAP R/3 Enterprise,  ECC 5.00, ECC 6.00 - 6.04 SAP_HR, SAP_HRXX

**Reason and Prerequisites**

The program code contains a possibility to define and execute code of the user's choice which changes the system's behavior. A valid and authenticated user with authorization for transaction SA38 or SE38 is required.

Although the vulnerability is caused by code belonging to SAP_HR, the injection is not restricted to this component as the injected code can affect any other component of the system.

**Solution**

Apply the attached correction instructions or implement the HR support packages in which the corrections have been included.

Please consider the following special shipment conditions for releases Enterprise R/3 4.7 and higher:

The objects to be corrected are part of software component SAP_HRXX. This software component contains country-independent objects of SAP_HR which, according to [Note 1167891](https://me.sap.com/notes/1167891), are shipped twice a year in so-called Synchronization HRSPs. Given the priority of the issue, the corrections have been included in the next available HRSP for each release, although they are not Synchronization HRSPs.

These next available HRSPs are:

- Enterprise R/3 4.7      [SAPK-470A6INSAPHRRXX](https://me.sap.com/supportpackage/SAPK-470A6INSAPHRRXX)
- ECC 5.00             [SAPK-50072INSAPHRRXX](https://me.sap.com/supportpackage/SAPK-50072INSAPHRRXX)
- ECC 6.00             [SAPK-60055INSAPHRRXX](https://me.sap.com/supportpackage/SAPK-60055INSAPHRRXX)
- ECC 6.04             [SAPK-60421INSAPHRRXX](https://me.sap.com/supportpackage/SAPK-60421INSAPHRRXX)

Customers that have chosen the CLC mode to implement HRSPs ([Note 1167891](https://me.sap.com/notes/1167891)) will only receive the corrections in the next Synchronization HRSPs and not as part of the CLC deliveries of the next available HRSPs, as the CLC delivery only contains country-specific objects.

Customers that have not chosen the CLC mode to implement HRSPs will receive the correction with the HRSPs mentioned above. No special testing is necessary as obsolete and unused ABAP code is deleted by this correction.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008554192017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001450128?language=en-US&token=27C58CCE3DB225213B117670307D1D45)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001450128/E/diff)

**References**

- [Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)
- [Announcement: New HCM Legal Change Delivery Process](https://me.sap.com/notes/1167891)

**Supported Languages**

- [Deutsch](https://me.sap.com/notes/0001450128/D)
- [日本語](https://me.sap.com/notes/0001450128/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001450128/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001450128/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001450128/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001450128/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001450128/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001450128/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001450128/3)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [redrays.io](https://redrays.io) for support to provided information.*