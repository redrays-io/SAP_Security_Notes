1449940 - Browsing Web Shop via HTTP with SessionIDRegenerationEnabled

**SAP Security Note 1449940** addresses a critical security concern related to session management in web applications using the SAP NetWeaver Application Server Java. Below is a summary of the note, including the symptom, reasons, prerequisites, and the recommended solution.

### Symptom
Session cookies transmitted over plain HTTP connections are vulnerable to theft and can be exploited for session hijacking. While the `SystemCookiesHTTPSProtection` property can secure these cookies, it prevents scenarios where anonymous browsing via HTTP is required alongside authenticated browsing via HTTPS.

### Reason and Prerequisites
- **Properties Involved:**
  - `SystemCookiesHTTPSProtection`: When set to `true`, it adds the `secure` attribute to all session cookies, ensuring they are only sent over HTTPS. However, this disables anonymous HTTP browsing.
  - `SecuritySessionIDHTTPSProtection`: When enabled, only part of the session cookies have the `secure` attribute, allowing anonymous HTTP browsing up to the point of user authentication. Post-authentication, all session tracking occurs over HTTPS.

- **Prerequisites:**
  1. **Enable Session ID Regeneration:**
     - Set the `SessionIdRegenerationEnabled` property of the `servlet_jsp` service to `true`.
  2. **Configure HTTPS Protection:**
     - Ensure `SystemCookiesHTTPSProtection` is set to `false` if you intend to use `SecuritySessionIDHTTPSProtection`. If `SystemCookiesHTTPSProtection` is `true`, the `SecuritySessionIDHTTPSProtection` property will be ignored.

### Solution
1. **Upgrade the Engine:**
   - Upgrade to the latest version as specified in the **SP Patch Level** section.
   - Ensure that **Note 1310561** is applied before proceeding with this upgrade.

2. **Activate Session Identifier Cookie Protection:**
   - Open **Configtool**.
   - Navigate to: `cluster-data -> Global server configuration -> services -> http`.
   - Locate the `SecuritySessionIDHTTPSProtection` property.
   - Set its value to `true`.
   - Save the changes and restart the server nodes for the settings to take effect.

### Additional Information
- **Available Languages:** The note is available in multiple languages, including Japanese, German, Portuguese (Machine Translation), Spanish (Machine Translation), French (Machine Translation), Italian (Machine Translation), Russian (Machine Translation), Chinese (Machine Translation), and Korean (Machine Translation).

- **Attachments:**
  - [640_SP25_patch.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000045152010&iv_version=0006&iv_guid=C800D5C861EBAE42A6864FC57581566A)
  - [640_SP24_patch.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000045152010&iv_version=0006&iv_guid=80EBB18C2DE78E44BC3240533E2B8D29)

- **References:**
  - **Refers to:** [1310561 - SAP J2EE Engine Session Fixation Protection](https://me.sap.com/notes/1310561)
  - **Referenced by:** [2254695 - SAP NetWeaver AS Java 7.11 SP6 List of corrections](https://me.sap.com/notes/2254695)

- **Validity:** Applicable to various software components, including ENGINEAPI, SAP-JEECOR, and SERVERCORE across multiple versions.

For more detailed information and to download the security note, visit [SAP Support Portal](https://me.sap.com/notes/1449940).

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*