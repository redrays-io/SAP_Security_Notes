2845377 - [CVE-2020-6198] Missing Authentication check in SAP Solution Manager (Diagnostics Agent)

## Description

### Symptom
The **Diagnostics Agent** allows P4 connections from unauthenticated sources to an insecure server port. This vulnerability enables an attacker to control all remote functions on the Agent, resulting in:

- Access to sensitive data stored in the configuration.
- Execution of commands with the permissions of the `<SID>adm` user, including modification of sensitive data.
- Shutdown of the Agent, disabling monitoring and causing it to be unavailable.

### Other Terms
Broken authentication, P4 server port, P4S, [CVE-2020-6198](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6198)

### Reason and Prerequisites
The Diagnostics Agent opens an insecure server port where authentication controls can be bypassed.

## Impact
This vulnerability has a **CVSS Score of 9.8 (Critical)**, indicating a severe impact on confidentiality, integrity, and availability:

- **Confidentiality Impact:** High
- **Integrity Impact:** High
- **Availability Impact:** High

An attacker exploiting this vulnerability can fully compromise the Diagnostics Agent, leading to unauthorized access, data manipulation, and service disruption.

## Solution
To mitigate this vulnerability, update to the latest **LM-Service** version. This update will close the insecure server port, removing the ability to establish unauthorized connections.

### Download and Resources
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000377012020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002845377?language=en-US&token=2C19AA71EF1004875A3251E1EBCC08F7)

### Support Package Patches
Apply the following patches for the **SOLMANDIAG 720** software component:

- [SP004 Patch 000011](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP004&patch_level=000011)
- [SP005 Patch 000012](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP005&patch_level=000012)
- [SP009 Patch 000007](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP009&patch_level=000007)
- [SP008 Patch 000015](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP008&patch_level=000015)
- [SP007 Patch 000019](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP007&patch_level=000019)
- [SP006 Patch 000013](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP006&patch_level=000013)
- [SP010 Patch 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200023942&support_package=SP010&patch_level=000001)

## CVSS Score
- **Score:** 9.8
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

## References
- [SAP Note 2845377](https://me.sap.com/notes/2845377)
- [CVE-2020-6198 Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6198)

---

*Credits to [Redrays.io](https://redrays.io) for support in providing information.*