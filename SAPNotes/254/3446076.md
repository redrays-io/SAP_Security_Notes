3446076 - [CVE-2024-33007] Client-side script execution vulnerability in SAP UI5(PDFViewer)

**SAP Security Note 3446076**

**Type:** SAP Security Note  
**Version:** 8  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with low priority  
**Status:** Released for Customer  
**Released On:** 14.05.2024  
**Component:** Cross-Application Components > SAPUI5 > Suite Controls

### Symptom
PDFViewer is a control delivered as part of the SAPUI5 product which shows the PDF content in an embedded mode by default. If a PDF document contains embedded JavaScript (or any harmful client-side script), the PDFViewer will execute the JavaScript embedded in the PDF, which can cause a potential security threat.

### Reason and Prerequisites
PDFs shown in applications via the PDFViewer control might contain harmful client-side scripts. This allows attackers to inject client-side scripts into PDFs viewed by others, potentially bypassing security measures like the same-origin policy.

### Solution
The behavior of PDFViewer has been enhanced by adding the property `isTrustedSource`, which can be used by application developers to set the desired display behavior for the PDFViewer.

- **`isTrustedSource = true`**: PDFViewer opens with `displayType` set to "Embedded" on desktop devices. Use this only when the PDF is generated by the application or scanned for viruses.
- **`isTrustedSource = false`**: PDFViewer opens with `displayType` set to "Link" on desktop devices, overriding any application-provided configuration for `displayType`. Users will need to download the PDF to view its content.

**Steps to consume the Solution:**
By default, `isTrustedSource` is set to `false`, restricting the display of PDFs. Users can use the Download button provided by the PDFViewer to download and view PDFs. To continue viewing PDFs within the application, set `isTrustedSource` to `true` (recommended only for trusted sources).

More Documentation on [sap.m.PDFViewer](https://ui5.sap.com/#/api/sap.m.PDFViewer)

**Available in SAPUI5 versions:**
- 1.71.68
- 1.84.45
- 1.96.32
- 1.108.31
- 1.120.14
- 1.121.5
- 1.123.2

### CVSS Details
**Score:** 3.5  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** None (N)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

### Actions
- **Download for SNOTE:** [Download](https://notesdownloads.sap.com/note/0040000000549162024)
- **PDF Version:** [View PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003446076?language=en-US&token=72DCA9C47C48FDC4038E339BC2D3D0D8)
- **Share by Email**
- **Open in New Window**

### Attachments
No attachments available.

For more information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for support in providing this information.*