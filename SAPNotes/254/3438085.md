SAP Security Note 3438085: CVE-2024-33005 Missing Authorization Check in SAP NetWeaver Application Server

```markdown
**SAP Security Note 3438085** addresses a critical vulnerability identified as **CVE-2024-33005**. This vulnerability involves missing authorization checks in several SAP components, potentially allowing unauthorized actions that can compromise system integrity and availability.

### **Symptom**
Admin users of the following components can **impersonate other users** due to missing authorization checks:
- **SAP Web Dispatcher**
- **SAP NetWeaver Application Server (ABAP and Java)**
- **SAP Content Server**

This impersonation can lead to:
- **Low impact on confidentiality**
- **High impact on integrity and availability**

### **Affected Products**
Customers are affected if they:
- Use **icmbnd** to bind ports **< 1024** on **Unix systems** as described in [SAP Note 421359](https://me.sap.com/notes/421359).

**Not Affected:**
- Customers **not using icmbnd** or **haven't applied SAP Note 421359**.
- Customers operating on **Windows** platforms.

### **Solution**

#### **Applying the Patch**
**Attention!** Even if you have updated to the patch levels containing the correction, **manual steps** as detailed below must still be performed.

1. **SAP Web Dispatcher:**
   - **Standalone Deployment:** Use `SAPWEBDISP.SAR` to patch and follow [SAP Note 908097](https://me.sap.com/notes/908097) for installation instructions.
   - **Embedded Deployment:** Use `dw.sar` or `SAPEXE.SAR` and `SAPEXEDB.SAR` to patch. Follow SAP's recommendations on patching the SAP kernel as outlined in [SAP Note 2083594](https://me.sap.com/notes/2083594).

2. **SAP NetWeaver Application Server ABAP and Java:**
   - Apply the latest **SP Stack Kernel** listed in [SAP Note 2083594](https://me.sap.com/notes/2083594).
   - If necessary, apply the relevant **hotfix** and review [SAP Note 1802333](https://me.sap.com/notes/1802333) for regression information.
   - Instructions for downloading and installing kernel patches are available in [SAP Note 19466](https://me.sap.com/notes/19466).

3. **SAP Content Server:**
   - Download the `SAPCS.SAR` archive from the [SAP Software Center](https://me.sap.com/softwarecenter).
   - Unpack and replace the executables in `/sapmnt/<SID>/exe/uc/<operating_system>`.
   - Restart the SAP Content Server using the provided commands.

#### **Manual Steps Required**
1. **Restart** the system.
2. **Delete** the existing `icmbnd` executable from the instance executable folder (`/usr/sap/<SID>/<instance>/exe`).
3. **Follow** the steps in [SAP Note 421359](https://me.sap.com/notes/421359).

**No further restart is required** after completing these steps.

### **Workaround**
As a temporary fix, you can **replace only the `icmbnd` executable**:
1. Download the `dw_xxx.sar` archive for your kernel version.
2. Extract the archive using `SAPCAR -xvf dw_xxx.sar`.
3. Copy `icmbnd.new` to `/usr/sap/<SID>/<instance>/exe`.
4. Delete the existing `icmbnd` executable.
5. Follow the steps in [SAP Note 421359](https://me.sap.com/notes/421359).

**Note:** This workaround is **temporary** and **not a permanent solution**. It is strongly recommended to apply the corrections outlined in this security note.

### **CVSS Details**
- **CVSS Score:** 6.3
- **Vector:** [CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:H)
  - **Attack Vector (AV):** Local
  - **Attack Complexity (AC):** Low
  - **Privileges Required (PR):** High
  - **User Interaction (UI):** None
  - **Scope (S):** Unchanged
  - **Confidentiality Impact (C):** Low
  - **Integrity Impact (I):** High
  - **Availability Impact (A):** High

### **References**
- [SAP Security Note 3438085](https://me.sap.com/notes/3438085)
- [SAP Note 421359](https://me.sap.com/notes/421359)
- [SAP Note 908097](https://me.sap.com/notes/908097)
- [SAP Note 2083594](https://me.sap.com/notes/2083594)
- [SAP Note 1802333](https://me.sap.com/notes/1802333)
- [SAP Note 19466](https://me.sap.com/notes/19466)
- [Update Strategy for the Kernel of the Application Server ABAP in On Premise Landscapes](https://support.sap.com/deployment-strategies-kernel-abap.pdf)

For more detailed information and support, visit the [SAP Software Center](https://me.sap.com/).

---

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*