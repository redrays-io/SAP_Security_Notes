3433192 - [CVE-2024-22127] Code Injection vulnerability in SAP NetWeaver AS Java (Administrator Log Viewer plug-in)

## SAP Security Note 3433192 Overview

**Type:** SAP Security Note  
**Version:** 10  
**Priority:** HotNews  
**Status:** Released for Customer  
**Released On:** 12.03.2024  
**Component:** Basis Components > NetWeaver Application Server Java > Local Admin Tools > Logging  
**Category:** Program error  
**Recency:** New  
**Language:** English  

### Vulnerability Details

#### Symptom
SAP NetWeaver Administrator AS Java Log Viewer plug-in allows an attacker with high privileges to upload potentially dangerous files, leading to a command injection vulnerability. This enables the attacker to execute commands that can compromise the confidentiality, integrity, and availability of the application.

#### Other Terms
- **CVE:** [CVE-2024-22127](https://www.cve.org/CVERecord?id=CVE-2024-22127)
- **Related Terms:** Command Injection, Log Viewer

#### Reason and Prerequisites
The list of prohibited file types is insufficient, allowing the upload of potentially dangerous files.

### Solution
- **Apply the SAP Note:** Restricts uploads to only specific file types.
- **Additional Security Measures:**
  - Configure a Virus Scan Profile to scan each file for threats. While recommended, it is not mandatory for the fix.
  - Update the NW Application Server Java to a release or Support Package where the issue is resolved. Refer to the "Validity" and "Support Packages & Patches" sections of this SAP Note for detailed information and available patches.
  - Ensure compatibility by reviewing [SAP Note 1974464](https://me.sap.com/notes/1974464) regarding SCA Dependency Analysis for Java download objects.

### Workaround
- **User Role Adjustment:** Access NetWeaver Administrator using the 'NWA_READONLY' user role instead of the 'Administrators' user role.
  
*Note: This is a temporary fix. It is strongly recommended to apply the corrections outlined in the security note either in lieu of or after implementing the workaround.*

### CVSS Details
- **Score:** 9.1
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** High
  - **User Interaction:** None
  - **Scope:** Changed
  - **Confidentiality Impact:** High
  - **Integrity Impact:** High
  - **Availability Impact:** High

### Download and Documentation
- **Download for SNOTE:** [Click here](https://notesdownloads.sap.com/note/0040000000296272024)
- **PDF Version:** [View PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003433192?language=en-US&token=39D62D65DA4A041DAE8B446BDEC54CEB)
- **Edit Note:** Not publicly available.

### Available Languages
- Japanese
- Deutsch
- Português (Machine Translation)
- Español (Machine Translation)
- Français (Machine Translation)
- Italiano (Machine Translation)
- Русский (Machine Translation)
- 中文 (Machine Translation)
- 한국어 (Machine Translation)

*For translations, visit the [SAP Security Note 3433192](https://me.sap.com/notes/0003433192) page.*

### Support Package Patches
- **LM NWA BASIC APPS 7.50:**
  - SP030 Patch Level 000000: [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001606&support_package=SP030&patch_level=000000)
  - SP023 Patch Level 000010: [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001606&support_package=SP023&patch_level=000010)
  - SP028 Patch Level 000005: [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001606&support_package=SP028&patch_level=000005)
  - SP025 Patch Level 000015: [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001606&support_package=SP025&patch_level=000015)
  - SP026 Patch Level 000012: [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001606&support_package=SP026&patch_level=000012)
  - SP027 Patch Level 000011: [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001606&support_package=SP027&patch_level=000011)
  - SP024 Patch Level 000011: [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001606&support_package=SP024&patch_level=000011)
  - SP029 Patch Level 000000: [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001606&support_package=SP029&patch_level=000000)

### Additional Resources
- [SAP Help Documentation on Virus Scan Profile Configuration](https://me.sap.com/docs/SAP_NETWEAVER_750/1531c8a1792f45ab95a4c49ba16dc50b/4e0ac1ca085c570ae10000000a42189e.html)

*Stay safe and ensure your systems are updated promptly.*

---

*Credits to [Redrays](https://redrays.io) for support in providing this information.*