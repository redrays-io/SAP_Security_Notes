3434666 - [Multiple CVEs] Missing Authorization Checks in SAP S/4 HANA (Manage Bank Statement Reprocessing Rules)

**SAP Note/KBA:** 3434666  
**Type:** SAP Security Note  
**Version:** 9  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Release Status:** Released for Customer  
**Released On:** May 13, 2024  
**Component:** FI-FIO-AR-PAY  
*Financial Accounting > Fiori UI for Financial Accounting > Fiori UI for Accounts Receivable > Payment Apps*

### Description

#### Symptom

This SAP security note addresses multiple vulnerabilities identified in **SAP S/4 HANA** (**Manage Bank Statement Reprocessing Rules**). The vulnerability details along with their CVE relevant information can be found below.

**Missing Authorization Check**

1. **Issue:** Manage Bank Statement ReProcessing Rules does not perform necessary authorization checks for an authenticated user, resulting in escalation of privileges. By exploiting this vulnerability, an attacker can delete rules of other users, affecting the integrity of the application. Confidentiality and Availability are not affected.

   - [CVE-2024-4139](https://www.cve.org/CVERecord?id=CVE-2024-4139)
   - **CVSS Score:** 4.3  
     **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N

2. **Issue:** Manage Bank Statement ReProcessing Rules does not perform necessary authorization checks for an authenticated user, resulting in escalation of privileges. By exploiting this vulnerability, an attacker can enable/disable the sharing rule of other users, affecting the integrity of the application. Confidentiality and Availability are not affected.

   - [CVE-2024-4138](https://www.cve.org/CVERecord?id=CVE-2024-4138)
   - **CVSS Score:** 4.3  
     **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N

#### Other Terms

Access control, Authorization error, Authorization profile, F3555, [CVE-2024-4138](https://www.cve.org/CVERecord?id=CVE-2024-4138), [CVE-2024-4139](https://www.cve.org/CVERecord?id=CVE-2024-4139)

### Solution

The necessary authorization checks are implemented. Please implement the Correction Instructions or Support Packages referenced in this SAP Security Note.

### Correction Instructions

- **Software Component:** S4CORE  
  **Number of Correction Instructions:** 8  
  [View Correction Instructions](https://me.sap.com/corrins/0003434666/19773)

### Support Packages

- [S4CORE 105 - SAPK-10508INS4CORE](https://me.sap.com/supportpackage/SAPK-10508INS4CORE)
- [S4CORE 106 - SAPK-10606INS4CORE](https://me.sap.com/supportpackage/SAPK-10606INS4CORE)
- [S4CORE 107 - SAPK-10704INS4CORE](https://me.sap.com/supportpackage/SAPK-10704INS4CORE)
- [S4CORE 108 - SAPK-10802INS4CORE](https://me.sap.com/supportpackage/SAPK-10802INS4CORE)
- [SAPSCORE 131 - SAPK-13108INSAPSCORE](https://me.sap.com/supportpackage/SAPK-13108INSAPSCORE)

### Prerequisites

- **Software Component:** S4CORE  
  **Valid From:** 105  
  **Valid To:** 105  
  **SAP Note/KBA:** [2992472](https://me.sap.com/notes/2992472)  
  **Title:** F3555 - Source code parts for Allocation Sequence in Rules  
  **Component:** FI-FIO-AR  

### CVSS

- **CVSS Score:** 4.3
- **CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** None (N)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

### Available Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000549152024)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003434666?language=en-US&token=5CE6B954FC705DAC987EEF7ACA48D028)
- Share by Email
- Open in New Window

*Credits to [RedRays](https://redrays.io) for support in providing the information.*