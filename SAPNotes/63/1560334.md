SAP Security Note 1560334 - Potential disclosure of persisted data in database

**Symptom**

A malicious user can exploit the database and use specially crafted inputs to modify database commands, resulting in the retrieval of additional information persisted by the system.

**Other Terms**

SQL injection, database

**Reason and Prerequisites**

The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve data from the database.

The report RSORADJV allows running SQL queries on Oracle performance views. It accepts only read accesses to the database and no data manipulation. However, by chance, it might be possible to read application data.

The remaining reports (see list of reports below) are part of the monitoring transactions ST04 and DB02. If run alone, these reports provide structural information (like size, number of table lines, etc.) of database objects.

**Solution**

The ABAP reports
- RSORA100
- RSORA820
- RSORACMP
- RSORAOPS
- RSORAINI
- RSORATB1
- RSORATB2
- RSORATB3
- RSORATC2
- RSORATC6
- RSORATC8
- RSORADJV

are deleted with [SAP Note 1523173](https://me.sap.com/notes/1523173) starting with SAP Basis Release 7.00.

For SAP systems with an older Basis Release, the roles which pass the authority object S_ADMI_FCD need to be carefully assigned to users.

**Valid For**

- **Software Component:** SAP_BASIS
  - **Releases:** 46C, 620, 640, 700, 702, 710, 730

**Downloads**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009252252017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001560334?language=en-US&token=35F10EC943E383E9489D146255D91287)

For more information, visit the [SAP Notes](https://me.sap.com/notes/1560334) page.

Credits to [Red Rays](https://redrays.io) for support in providing this information.