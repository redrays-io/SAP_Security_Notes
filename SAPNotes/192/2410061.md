SAP Security Note 2410061: Denial of Service (DOS) in "System Messages" area in DOE Administration Portal

**Symptom**
> The "System Messages" area in the DOE Administration Portal allows an attacker to prevent legitimate users from accessing a service by crashing or flooding the service.

**Impact**
- **Availability:** High impact due to potential service interruptions and degraded performance for legitimate users.
- **Confidentiality & Integrity:** No direct impact.

**CVSS Information**
- **CVSS v3 Base Score:** 7.7 / 10
- **Vector:** `AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H`

**Reason and Prerequisites**
- **Reason:** The DOS vulnerability arises from an overflow of data when fetching the lifetime data for system messages. There was no restriction on the data saved in this field during the creation of system messages.
- **Prerequisites:**
  - Encountering a 500 SAP Internal Server Error.
  - Using one of the following versions:
    - **NWAs 710:** SP16 to SP21
    - **NWAs 711:** SP12 to SP16
    - **NWAs 730:** SP12 to SP16
    - **SUPDOE Add-On 731:** SP01 to SP04

**Solution**
Implement the corrections provided in SAP Note 2410061. The implementation will modify the `create` method in the `smmw_sys_msg` class to restrict the `lifetime` field, preventing users from entering an excessive number of days.

**Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018466462017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002410061?language=en-US&token=B0793128C4710441F7BFE34DC6E8408F)

**Attributes**
- **Externally Reported:** Yes

**Supported Software Components**
- **SAP_BASIS:** 710 to 711, 730
- **SUPDOE:** 731

**Support Package Information**
- **SAP_BASIS 710:** [SP16 to SP21](https://me.sap.com/supportpackage/SAPKB71022)
- **SAP_BASIS 711:** [SP12 to SP16](https://me.sap.com/supportpackage/SAPKB71117)
- **SAP_BASIS 730:** [SP12 to SP16](https://me.sap.com/supportpackage/SAPKB73017)

**Prerequisite Note**
- [SAP Note 2348985: New System message cannot be created](https://me.sap.com/notes/2348985)

*Credits to [Red Rays](https://redrays.io) for supporting the provision of this information.*