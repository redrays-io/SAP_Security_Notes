SAP Security Note 2413716 - Setup of Trusted RFC in GRC Access Control EAM

**Overview**
SAP Security Note **2413716** addresses the secure setup of Trusted RFC in **GRC Access Control Emergency Access Management (EAM)**. Improper configuration of Trusted RFC can lead to unauthorized access, allowing attackers to abuse restricted functionalities or manipulate sensitive data.

**CVSS Information**
- **CVSS v3 Base Score:** 8.2 / 10
- **Vector:** AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:L/A:L

**Issue**
GRC Access Controls EAM utilizes Trusted RFC to switch users from personal Fire Fighter accounts to Emergency Users (FFID) for performing emergency activities. If Trusted RFC is not securely configured, it may be exploited to:
- Abuse functionalities restricted to specific user groups.
- Read, modify, or delete restricted data.

**Solution**
To secure Trusted RFC in GRC Access Control EAM, implement the following configuration changes:

1. **Enhance Trust Relationship to Transmit Transaction Code (SMT1)**
   - Define trust relationships using transaction **SMT1**.
   - Activate the "use transaction code" setting under the "Configuration" tab.
   - Optionally, enable **Secure Network Communication (SNC)** for encrypted communication channels.

2. **Maintain Authorizations for Authorization Object S_RFCACL in Managed Systems**
   - Avoid using full authorizations (`*`) for fields like `RFC_SYSID` and `RFC_CLIENT`.
   - Specify trusted system IDs and clients to restrict access.
   - Set `RFC_EQUSER = N` and define specific transaction codes (`RFC_TCODE`).

3. **Adjust RFC Destinations to Utilize Authorization Object S_ICF (SM59)**
   - Restrict RFC destination usage to Fire Fighters by configuring **S_ICF**.
   - Assign appropriate authorizations to roles managing RFC destinations.

4. **Deactivate Passwords of FFIDs**
   - FFIDs are accessed via Trusted RFC and do not require passwords.
   - Use transaction **SU01** or **SU10** to deactivate passwords for FFIDs.

5. **Strictly Control Critical Basis Authorizations for Managing Trust Relationships and RFC Destinations**
   - Restrict access to authorization objects `S_RFC_ADM` and `S_RFC_TT` used in transactions **SM59** and **SMT1**.

**Prerequisites**
- Ensure all related systems define explicit trust relationships.
- Assign roles with necessary authorizations correctly.

**References**
- [SAP Note 128447 - Trusted/trusting systems](https://me.sap.com/notes/128447)
- [Security Guide â€“ SAP GRC Access Control](https://service.sap.com/~sapdownload/011000358700000406492008E/AC53_Sec_Guide_en.pdf)

**Related Links**
- [Online Documentation - Superuser Management in GRC 10](https://help.sap.com/saphelp_grcac10/helpdata/en/16/404938695540b398a5e76fe8cfb067/frameset.htm)

For more detailed information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*