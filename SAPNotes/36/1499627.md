SAP Security Note 1499627 - Executing any source code using template report

**SAP Note/KBA:** 1499627  
**Type:** SAP Security Note  
**Version:** 6  
**Released On:** 14.12.2010  
**Priority:** Correction with high priority  
**Component:** Controlling > Overhead Cost Controlling > Activity-Based Costing (CO-OM-ABC)  
**Language:** English  
**Master Language:** German  
**Category:** Program error  
**Release Status:** Released for Customer  

### Description

**Symptom:**  
By making specific entries in a table, an attacker can generate programs with harmful source code. The tables belong to the component CO-OM-ABC-F.

**Other Terms:**  
Database, generated programs, COTPLFS, COTPL  
Backdoor, injection, run, credentials

**Reason and Prerequisites:**  
The program code allows source code that can be freely determined to be added and executed, enabling an attacker to control the system response. Valid logon information is required for this.  
The relevant program code must be stored in a database table. Therefore, an attacker requires authorization for transaction SE16 or SE16N as well as change authorization for the authorization object S_TABU_DIS.  
With these authorizations, it is possible to make new entries in the tables because you have selected the "Display/Maintenance Allowed" option in the "Delivery and Maintenance" settings.

### Solution

Navigate to the table maintenance for the tables `COTPLFS` and `COTPL`, and change the setting on the **Delivery and Maintenance** tab page from **Display/Maintenance Allowed** to **Display/Maintenance Allowed with Restrictions**, or import the relevant [Support Package](https://me.sap.com/supportpackage/SAPKH46C62).  
Then call transactions SE16 and SE16N for the tables `COTPL` and `COTPLFS`. It should no longer be possible to add or change entries.

### Support Packages

- **SAP_APPL 46C:** [SAPKH46C62](https://me.sap.com/supportpackage/SAPKH46C62)
- **SAP_APPL 470:** [SAPKH47035](https://me.sap.com/supportpackage/SAPKH47035)
- **SAP_APPL 500:** [SAPKH50024](https://me.sap.com/supportpackage/SAPKH50024)
- **SAP_APPL 600:** [SAPKH60019](https://me.sap.com/supportpackage/SAPKH60019)
- **SAP_APPL 602:** [SAPKH60209](https://me.sap.com/supportpackage/SAPKH60209)
- **SAP_APPL 603:** [SAPKH60308](https://me.sap.com/supportpackage/SAPKH60308)
- **SAP_APPL 604:** [SAPKH60409](https://me.sap.com/supportpackage/SAPKH60409)
- **SAP_APPL 605:** [SAPKH60503](https://me.sap.com/supportpackage/SAPKH60503)

### Available Languages

- [Japanese (Machine Translation)](https://me.sap.com/notes/0001499627/J)
- [Deutsch (Origin)](https://me.sap.com/notes/0001499627/D)
- [Português (Machine Translation)](https://me.sap.com/notes/0001499627/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001499627/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001499627/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001499627/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001499627/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001499627/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001499627/3)

---

*Credits to [RedRays](https://redrays.io) for providing the information.*