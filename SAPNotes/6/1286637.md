SAP Security Note 1286637 - Buffer Overflow Vulnerability in SAPIrRfc Component

```markdown
**SAP Security Note 1286637 - Buffer Overflow Vulnerability in SAPIrRfc Component**

### Symptom

A security breach has been discovered in the front-end component `SAPIRRFC.DLL`. This vulnerability allows attackers to:

- Access foreign computers
- Execute damaging code using a "Buffer Overflow" attack
- Download files from the Internet and transfer them to any directory

**Affected Components:**

- SAP NetWeaver Knowledge Warehouse (SAP NetWeaver KW)
- All front ends with SAP NetWeaver KW front-end tools, regardless of usage

### Other Terms

- **KW add-on**
- **SAPIRRFC.DLL**
- **Security**
- **Browser**
- **ActiveX components**
- **SAP Information Repository Remote Function Call**
- **Buffer overflow**
- **Path traversal**

### Reason and Prerequisites

The vulnerability exists under the following conditions:

- **Affected SAP GUI Versions:** 620, 640, 710
- **Component:** SAP Knowledge Warehouse SAP IR Remote Function Call (`SAPIRRFC.DLL`)
- **Vulnerable Versions:** Up to Version 4.0.2.5 (Knowledge Workbench versions lower than 177)

**Important:** The security breach is present even if the SAP NetWeaver KW front-end tools are not actively used. Merely having `SAPIRRFC.DLL` on the frontend is sufficient for the attack.

**Determining the KW Add-on Patch Level:**

1. Navigate to the SAP GUI installation directory (e.g., `C:\Program Files\SAP\FrontEnd`).
2. Locate the file `sapidbw.exe`.
3. Check the file version; the last three digits represent the Knowledge Workbench version (e.g., Version `7100.700.0.175` indicates Knowledge Workbench version `175`).

### Solution

**For SAP GUI 6.20:**
- A correction is not possible in this version (see [Note 929300](https://me.sap.com/notes/929300)).
- **Action:** Upgrade to SAP GUI 7.10 or higher.

**For SAP GUI 6.40:**
- The vulnerability was identified after maintenance ended; no correction is available.
- **Action:** Upgrade to SAP GUI 7.10 or higher.

**For SAP GUI 7.10:**
- **Action:** Urgently apply KW add-on patch 5 or higher on each affected frontend.
- **Patch Details:** The patch ensures that `SAPIRRFC.DLL` filters all foreign processes that could damage the PC.
- **Download Patches:** Refer to [Note 1034521](https://me.sap.com/notes/1034521) for the location of KW add-on patches on SAP Service Marketplace.

**Potential Error During Patch Application:**
- **Error Message:** `The system cannot find the file specified <installation path SAP GUI>\DwReg32.ocx.uninstall.reg`
- **Impact:** This error does not affect the effectiveness of the security patches.
- **Further Information:** Refer to the attached [setuperror.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000498312008&iv_version=0008&iv_guid=6894E88EE92714499021CE2FC1FFB5E0) for more details.

**Interim Mitigation:**
- Apply the "kill bits" as described in [Note 1092631](https://me.sap.com/notes/1092631) to prevent `SAP GUI` files from being instantiated on Microsoft Internet Explorer websites until patches are applied.

### References

- [Remote vulnerabilities in SAP GUI for Windows - Note 1092631](https://me.sap.com/notes/1092631)
- [Composite note for SAP KW add-on patches - Note 949953](https://me.sap.com/notes/949953)

### Attachments

- [setuperror.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000498312008&iv_version=0008&iv_guid=6894E88EE92714499021CE2FC1FFB5E0)

---

*Credits to [Red Rays](https://redrays.io) for support and provided information.*
```