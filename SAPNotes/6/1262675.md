SAP Security Note 1262675 - J2EE engine filter to check for XSS input

**SAP Security Note 1262675 - J2EE engine filter to check for XSS input**

**Header Data**
- **Type:** SAP Security Note
- **Version:** 2
- **Recency:** New
- **Language:** English
- **Category:** Consulting
- **Priority:** Correction with low priority
- **Status:** Released for Customer
- **Released On:** 08.10.2009
- **Component:** CRM-ISA (Customer Relationship Management > Internet Sales)

**Title**
1262675 - J2EE engine filter to check for XSS input

**Description**

### Symptom
You are using SAP CRM WebChannel or SAP E-Commerce and you want to add an additional possibility to avoid Cross Site Scripting (XSS).

### Other Terms
isa, Internet Sales, ECo, E-Commerce, WebChannel, Web Channel, CRM, ERP, r3, r\3, r/3, ECC, b2b, Business-to-Business, Business to Business, b2c, Business-to-Customer, Business to Customer, isauseradm, isauseradmin, isa useradm, isa useradmin, useradmin, user admin, shopadmin, shop admin, XSS, X-SS

### Reason and Prerequisites

**Reason**  
You want to increase the security of the application.

**Solution**  
*This note is a consulting note. The changes described here are considered a modification of the web application. Further questions regarding these functions are not answered by support. Instead, they are processed as part of "Remote Consulting" and this is subject to an extra cost.*

The note describes the possibility of using a filter. This filter checks every HTTP GET or POST request parameter for XSS relevant input. The user is redirected to a predefined error page if one of the parameters has XSS content inside.

**How to Implement the Filter**

1. **Open the `web.xml`**  
   Locate the `web.xml` file in the root/WEB-INF folder of your J2EE application.

2. **Add Filter Configuration**  
   Insert the following lines between the `<context-param>` and `<servlet>` tags:

   ```xml
   </context-param>

   <filter>
     <filter-name>XSSFilter</filter-name>
     <display-name>XSSFilter</display-name>
     <filter-class>com.sapmarkets.isa.core.util.conv.XSSParameterFilter</filter-class>
   </filter>
   <filter-mapping>
     <filter-name>XSSFilter</filter-name>
     <url-pattern>*.do</url-pattern>
   </filter-mapping>
   <filter-mapping>
     <filter-name>XSSFilter</filter-name>
     <url-pattern>*.jsp</url-pattern>
   </filter-mapping>

   <servlet>
   ```

   *You can modify the package and the class name as needed.*

3. **Download the Filter Source Code**  
   [XSSFilterClass.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000658332008&iv_version=0002&iv_guid=B76FD746A2A71C43A3ADF59416C4D342)

4. **Integrate the Filter Class**  
   Add the downloaded class to your development environment and update the redirect URL on line 49:

   ```java
   ((HttpServletResponse) res).sendRedirect("PLEASE ENTER YOUR XSS ERROR PAGE!!!");
   ```

5. **Compile and Rebuild**  
   Compile the class and rebuild your application to include the new filter.

6. **Deploy the Application**  
   Deploy your modified application to activate the filter.

7. **Confirmation**  
   The filter is now active if no issues arise during deployment.

**Attachments**
- [XSSFilterClass.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000658332008&iv_version=0002&iv_guid=B76FD746A2A71C43A3ADF59416C4D342) (1 MB)

**References**
- **This document refers to:**
  - [SAP Note 1268340 - Extended security enhancements to prevent XSS vulnerability](https://me.sap.com/notes/1268340)

**Validity**
Supported Software Components:
- **SAP-CRMISA:** 4.0, 4.0_640
- **SAP-CRMJAV:** 5.0, 5.2, 6.0
- **SAP-CRMWEB:** 5.0, 5.1, 5.2, 6.0
- **SAP-SHRWEB:** 5.0, 5.2, 6.0
- **SAP-SHRJAV:** 5.0, 5.2, 6.0
- **SAP-CRMAPP:** 5.0, 5.2, 6.0
- **SAP-SHRAPP:** 5.0, 5.2, 6.0

**Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016647732017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001262675?language=en-US&token=F6257AD20A24F554DD32FDCD5E2DB5C9)

**Credits**
Credits to [Redrays.io](https://redrays.io) for support in providing this information.