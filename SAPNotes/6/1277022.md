SAP Security Note 1277022 - Session Forwarding by URL

**Description**

This security note addresses a vulnerability where a URL, such as one received via email, allows a user to connect to the SAP system without additional authentication.

**Other Terms**
- Security vulnerability
- Session Riding

**Reason and Prerequisites**
- The system is not configured for the HTTP Security Session. Refer to transaction `SICF_SESSIONS`.
- The application uses "stateful-http-communication," meaning the backend session remains open and is reused.
- In the current environment, the session stays open when the user accesses the URL, enabling connection without further authentication.
- The service is not classified as "public." A service is considered "public" if:
  - It is defined in `/sap/public`.
  - It is maintained with logon data and only permits the maintained logon data ("mandatory with logon data").

**Solution**
For SAP Web Application Server ABAP 6.40 and SAP NetWeaver Application Server ABAP 7.00, refer to [Note 1266780](https://me.sap.com/notes/1266780).

Starting with EhP1 for SAP NetWeaver Application Server ABAP 7.00, mitigate the vulnerability by setting the following dynamic profile parameters:

- `icf/user_recheck` from `0` to `1`: Activates reauthentication for each consecutive request in stateful HTTP communication. To suppress reauthentication for specific services, define them in transaction `SICF`.
- `icf/set_HTTPonly_flag_on_cookies` from `3` to `0`: Sets the HTTPonly attribute for cookies, especially the `MYSAPSSO2` cookie, preventing unexpected programmatic access to logon data if the client (e.g., browser) supports HTTPonly.

**Required Kernel Patch Levels**
The solution spans both ABAP and kernel components and requires the following kernel patch levels:

- **Kernel 7.01** Patch-level #44 or higher
- **Kernel 7.10** Patch-level #157 or higher
- **Kernel 7.11** Patch-level #37 or higher
- **Kernel 7.20** and above

Refer to the relevant [Support Packages](https://me.sap.com/supportpackage/SAPKB70105) for your SAP_BASIS version.

**Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016673272017)
- [PDF Version](https://me.sap.com/userapps.support.sap.com/sap/support/sfm/notes/print/0001277022?language=en-US&token=0F864D7E38A6C6A54C1A4E5BF0CEE053)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001277022/E/diff)

**References**
This document refers to:

- [1616535 - Secure Configuration of ICM for the ABAP Application Server](https://me.sap.com/notes/1616535)
- [1532874 - Upgrade: Changing the HTTP Reauthentication](https://me.sap.com/notes/1532874)
- [1532777 - Collective Note: ABAP Session Protection Recommendations](https://me.sap.com/notes/1532777)
- [1524152 - Correction Instructions for Note 1277022](https://me.sap.com/notes/1524152)
- [1519456 - Fax or Letter Document Cannot Be Opened After Creation](https://me.sap.com/notes/1519456)
- [1438421 - Microsoft Word Documents Do Not Open Using URL](https://me.sap.com/notes/1438421)
- [1420203 - Enable Foreign Access to a Stateful HTTP Session](https://me.sap.com/notes/1420203)
- [1325243 - ITS Up/down: Not Working if User Recheck Is Enabled](https://me.sap.com/notes/1325243)
- [1322944 - ABAP: HTTP Security Session Management](https://me.sap.com/notes/1322944)
- [1302734 - Accessing the HTTP Cookie "MYSAPSSO2" Fails](https://me.sap.com/notes/1302734)
- [1301591 - HTTP 400 - Session Not Found (Stateful HTTP Communication)](https://me.sap.com/notes/1301591)
- [1266780 - User Check for Each HTTP Request](https://me.sap.com/notes/1266780)

**Side Effects**
This document resolves side effects such as:

- [977420 - ESID Handling in the Internet Communication Framework](https://me.sap.com/notes/0000977420)

**Credits**
Information supported by [redrays.io](https://redrays.io).