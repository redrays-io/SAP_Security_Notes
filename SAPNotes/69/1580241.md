1580241 - Insecure default configuration for file uploads (LOD-ESO-AS)

---

### Description

**Symptom**

LOD-ESO-AS can be abused by a malicious user allowing them to upload potentially malicious files resulting in undesired system behavior.

**Other Terms**

Insecure default configuration, LOD-ESO-AS

**Reason and Prerequisites**

There are various locations within the application where documents can be uploaded (i.e., attachments). However, by default, there was no filtering of the type of files set. Without proper filtering, files with potentially damaging content can be uploaded.

**Solution**

The solution involves configuring a system property to create a "whitelist" of files that should be allowed for upload. The following are suggested settings for each type of deployment. This is not version-specific.

**On Premise:**

*Note: New installations of Version 7.0 and greater will receive a default set of values. These should be reviewed and updated as required. Prior versions and upgrades to 7.0 will need to set these as follows:*

- **Property:**
  ```
  attachments.attachments.upload.file.extension_list
  ```

- **Value:**
  ```
  doc;docx;xls;xlsx;csv;pdf;xml;tif;zip;rar;rtf;gif;jpeg;jpg;bmp;tsv;xlt;xltx;xlsm;xpdl;pptm;ppt;pptx;txt;png;pps;wmv;oma
  ```

- **Property:**
  ```
  attachment.attachments.upload.file.extension_list_permitted
  ```

- **Value:**
  ```
  TRUE
  ```

**On Demand:**

Same as above, handled by the hosting team. No additional customer action required.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017207872017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001580241?language=en-US&token=32E423BF8330E9E27B95D28C5B960487)

---

*Credits to [redrays.io](https://redrays.io) for support to provided information.*