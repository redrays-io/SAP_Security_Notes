SAP Security Note 1580017 - Code injection vulnerability in TH_GREP

**SAP Security Note 1580017** addresses a critical code injection vulnerability in the function module `TH_GREP`. This vulnerability allows malicious users to execute arbitrary operating system commands, potentially leading to system control or privilege escalation without legitimate credentials.

### Header Data
- **SAP Note/KBA:** 1580017
- **Type:** SAP Security Note
- **Version:** 8
- **Recency:** Updated
- **Language:** English
- **Master Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Release Status:** Released for Customer
- **Released On:** 12.08.2011
- **Component:** Basis Components > Client/Server Technology

### Description

#### Symptom
The function module `TH_GREP` contains code that permits the execution of operating system commands of the user's choice. A malicious user can control the system's behavior or potentially escalate privileges by executing malicious commands without having legitimate credentials.

**CVSS Information**
- **Base Score:** 6.0
- **Vector:** AV:N/AC:M/AU:S/C:P/I:P/A:P

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your system configuration or operational environment. It is not intended to replace any risk assessments you should conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes FAQ](https://service.sap.com/securitynotes/).*

#### Other Terms
Remote code execution, Backdoor, injection, run, credentials, TH_GREP

#### Reason and Prerequisites
The program code allows the definition and execution of user-defined code that alters system behavior. A valid and authenticated SAP system user is required. Depending on the code, the user can:
- Execute arbitrary operating system commands
- Obtain additional information that should not be displayed
- Modify or delete data
- Modify system output
- Perform a denial of service attack

### Solution
Please [apply the corrections attached to this note](https://me.sap.com/corrins/0001580017/41).

### Actions
- [Mark as Favorite](#) / [Unmark as Favorite](#)
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009375492017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001580017?language=en-US&token=374225F5B68B469089A6A86726B193FA)
- [Share by Email](#)
- [Open in New Window](#)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001580017/E/diff)

### References
- [Update #1 for Security Note 1580017](https://me.sap.com/notes/1620632)
- [Potential information disclosure relating to FM TH_GREP](https://me.sap.com/notes/1563110)
- [Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

### Validity
This security note is valid for the following SAP_BASIS versions:
- 640
- 700 to 702
- 710 to 730

### Support Package
Relevant support packages are available for various SAP_BASIS versions. For example:
- [SAP_BASIS 640 - SAPKB64029](https://me.sap.com/supportpackage/SAPKB64029)
- [SAP_BASIS 700 - SAPKB70025](https://me.sap.com/supportpackage/SAPKB70025)
  
*(Refer to the full list in the original note for other versions.)*

### Correction Instructions
- **Software Component:** SAP_BASIS
- **Number of Correction Instructions:** 8
- [View Correction Instructions](https://me.sap.com/corrins/0001580017/41)

### Preconditions
Ensure the following SAP notes are applied based on your SAP_BASIS version:
- [1433101 - Misuse of the search function in transaction SM51](https://me.sap.com/notes/1433101) for versions 610 to 720.

### Side Effects
Applying this security note addresses side effects caused by:
- [Update #1 for Security Note 1580017](https://me.sap.com/notes/1620632)

### Available Translations
Translations are available in several languages, including:
- [Deutsch](https://me.sap.com/notes/0001580017/D)
- [日本語](https://me.sap.com/notes/0001580017/J)
- [Português](https://me.sap.com/notes/0001580017/P)
- [Español](https://me.sap.com/notes/0001580017/S)
- [Français](https://me.sap.com/notes/0001580017/F)
- [Italiano](https://me.sap.com/notes/0001580017/I)
- [Русский](https://me.sap.com/notes/0001580017/R)
- [中文](https://me.sap.com/notes/0001580017/1)
- [한국어](https://me.sap.com/notes/0001580017/3)

For machine translations, add "(Machine Translation)" after the language name.

---

*Credits to [Redrays](https://redrays.io) for support in providing this information.*