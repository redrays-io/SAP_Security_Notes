SAP Security Note 1578645 - BRF+: Problems with special characters in generated coding

---

**Overview**

SAP Security Note [1578645](https://me.sap.com/notes/1578645) addresses issues related to the use of special characters (`` ` `` and `'`) in BRFplus decision tables and formulas. Improper handling of these characters can lead to syntax errors in the generated ABAP classes and potential code injection vulnerabilities.

**Symptom**

- Using characters `` ` `` or `'` in BRFplus decision tables or formulas results in syntax errors during code generation.
- Potential for code injection by malicious users if user-defined code is allowed without proper sanitization.

**Cause**

When assigning values in the format `Text = 'Peter O'Toole's Hotel'`, the apostrophe (`'`) in the string prematurely terminates the string, causing syntax errors. The system needs to differentiate between string delimiters and apostrophes within the string, requiring proper escaping (e.g., replacing `'` with `''`).

Additionally, unauthenticated or improperly restricted user-defined code execution can enable malicious activities such as code injection, data manipulation, or denial of service attacks.

**Solution**

To resolve these issues, apply the correction instructions provided in [Correction Instructions 41](https://me.sap.com/corrins/0001578645/41) associated with this security note. Ensure that your system is updated with the necessary support packages:

- [SAPKB70110](https://me.sap.com/supportpackage/SAPKB70110) for SAP_BASIS 701
- [SAPKB70208](https://me.sap.com/supportpackage/SAPKB70208) for SAP_BASIS 702
- [SAPKB73003](https://me.sap.com/supportpackage/SAPKB73003) for SAP_BASIS 730

**Preconditions**

Ensure that the following prerequisite notes are applied before implementing this security note:

1. [1459523](https://me.sap.com/notes/1459523) - BRF+: Error in generated class if a constant contains a '
2. [1464565](https://me.sap.com/notes/1464565) - BRF+: Generation fails for DB-Lookup
3. [1554106](https://me.sap.com/notes/1554106) - BRFplus: Problems with using Apostrophe in a constant
4. [1556438](https://me.sap.com/notes/1556438) - BRF+: Syntax error and code injection vulnerability
5. [1515283](https://me.sap.com/notes/1515283) - BRF+: Better Performance during generation of rules
6. [1541141](https://me.sap.com/notes/1541141) - BRF+: Generation cleanup for all expression types

**References**

- This document refers to [SAP Note 888889](https://me.sap.com/notes/888889) - Automatic checks for security notes using RSECNOTE (outdated).
- This document is referenced by [SAP Note 888889](https://me.sap.com/notes/888889) - Automatic checks for security notes using RSECNOTE (outdated).

**Download and More Information**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009783212017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001578645?language=en-US&token=FD67C3C62BF2BBED410C366340213158)

**Credits**

Thanks to [Redrays.io](https://redrays.io) for support in providing this information.