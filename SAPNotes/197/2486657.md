2486657 - Directory Traversal Vulnerability in SAP NetWeaver AS Java Web Container

## Description

### Symptom
**UPDATE 10<sup>th</sup> October 2017**: This security note has been re-released after adding corrections for the following SPs:

- ENGINEAPI 7.50 SP02
- ENGINEAPI 7.50 SP03
- ENGINEAPI 7.50 SP04
- ENGINEAPI 7.50 SP05

AS Java Web Container allows an attacker to exploit insufficient validation of path information provided by users, thus characters representing ‘traverse to parent directory’ are passed through to the file APIs.

Some well-known impacts of Directory Traversal vulnerability are:
- Attacker could read content of arbitrary files on the remote server and expose sensitive data
- Attacker could overwrite, delete, or corrupt arbitrary files on the remote server

### CVSS Information
**CVSS v3 Base Score:** 7.7 / 10  
**CVSS v3 Base Vector:**

| Metric                             | Value           |
|------------------------------------|-----------------|
| Attack Vector (AV)                 | Network (N)     |
| Attack Complexity (AC)             | Low (L)         |
| Privileges Required (PR)           | Low (L)         |
| User Interaction (UI)              | None (N)        |
| Scope (S)                          | Changed (U)     |
| Confidentiality Impact (C)         | High (H)        |
| Integrity Impact (I)               | None (N)        |
| Availability Impact (A)            | None (N)        |

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).

### Reason and Prerequisites
Applications that access resources using Servlet API without validating the resource path from the request parameters can expose system resources beyond the scope of the application root context.

### Solution
Update AS Java to the latest version. See the SP Patch Level section for details.

## Affected Software Components
- **ENGINEAPI** versions 7.10 to 7.50
- **SAP-JEECOR** versions 6.40 to 7.02

## Support Package Patches
Several Support Package Patches are available for different versions of ENGINEAPI. You can download the appropriate patch [here](https://me.sap.com/swdc/notes?cvnr=73554900100200001552&support_package=SP004&patch_level=000012).

## References
This document is referenced by:
- [2566930 - Collective Note: SAP NetWeaver 7.30 SP18 - NWDS Update Site standalone](https://me.sap.com/notes/2566930)
- [2567013 - Collective Note: SAP NetWeaver 7.30 SP18 - Application Server Java](https://me.sap.com/notes/2567013)

## Download and Additional Resources
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000019484122017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002486657?language=en-US&token=EE4129583FD9D6AAB1CA47C592EBB42C)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002486657/E/diff)

## Language Translations
Available in multiple languages including [Deutsch](https://me.sap.com/notes/0002486657/D), [Español](https://me.sap.com/notes/0002486657/S), and more.

## Released On
**10/10/2017**

**Credits:** Support provided by [redrays.io](https://redrays.io).