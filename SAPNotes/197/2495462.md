2495462 - Switchable Authorization checks for RFC in SAP Leasing

**Overview**

SAP Security Note [2495462](https://me.sap.com/notes/2495462) introduces switchable authorization checks for Remote Function Call (RFC) function modules in SAP Leasing (FI-LA). This enhancement aims to bolster system security by enforcing stricter authorization protocols, ensuring that only authorized users can execute specific RFC functions.

**Key Details**

- **Type:** SAP Security Note
- **Version:** 3
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Release Date:** April 28, 2020
- **Component:** Financial Accounting > Lease Accounting Engine (FI-LA)
- **CVSS Score:** 6.3 ([CVSS Vector](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator))

**Problem Statement**

By default, RFC function modules are protected using the `S_RFC` authorization object. However, this level of protection may not be sufficient for all scenarios, potentially allowing unauthorized access or actions within the Lease Accounting Engine. This note addresses these gaps by introducing additional, switchable authorization checks.

**Solution**

1. **Switchable Authorization Checks:**
   - New authorization checks are implemented but remain inactive by default to maintain compatibility.
   - Activation is performed manually via transaction `SACF`.

2. **Manual Pre-Implementation Steps:**
   - **Check Existing Authorization Objects:**
     - Use transaction `SU21` to verify if the authorization object `F_L_ACCRUL` exists.
   - **Create Authorization Fields:**
     - In transaction `SU20`, create new authorization fields: `LA_COMP`, `BUKRS`, `ACCRULE`, and `ACTVT`.
   - **Define New Authorization Object:**
     - Create `F_L_ACCRUL` in transaction `SU21` with the newly created fields.
   - **Regenerate Authorizations:**
     - Regenerate `SAP_ALL` to incorporate the new authorization settings.

3. **Activation of Authorization Checks:**
   - Use transaction `SACF_TRANSFER` to upload the scenario definition from the attached `SACF_DATA.TXT`.
   - Assign the scenario definition `FI_LA` to the development package `FI_LA_GF`.
   - Activate the switchable authorization checks using transaction `SACF_COMPARE` post system updates.

**Affected Function Modules**

- `FILA_BUS_TRANSACTION_RECEIVE`
- `FILA_PRODUCT_READ`
- `/LSIERP/TQ_GET_DETAILS`
- `FILA_ITEMS_PROCESS_NEW`
- `FILA_ITEMS_PROCESS`
- `FILA_ITEMS_PROCESS_ALL`
- `FILA_ITEMS_PROCESS_PACKAGE`
- `FIEH_EVENT_EXCEPTION_TRIGGER`
- `FIEH_EVENT_DONE_TRIGGER`

All these function modules now require appropriate authorization via the `F_L_ACCRUL` object to ensure secure operations.

**Prerequisites**

Ensure that your system is running within the valid software component versions as specified in the [Validity](https://me.sap.com/notes/2495462#validity) section of the note. Additionally, review and implement any prerequisite notes listed under the [Preconditions](https://me.sap.com/notes/2495462#preconditions) section.

**Side Effects**

Implementing this note may address or cause certain side effects:

- **Solves:** 
  - None explicitly listed.
  
- **Causes:**
  - [CVE-2020-6306](https://me.sap.com/notes/2865348) - Missing Authorization check in SAP Leasing.

**Support Package Information**

Ensure that the relevant support packages are applied as per the [Support Package](https://me.sap.com/notes/2495462#supportpackage) section to maintain system compatibility and security.

**Additional Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000044432020)
- [PDF Version](https://me.sap.com/notes/0002495462?language=en-US&token=8D4AD75E84C7962BF124F9E4518621CB)
- [Show Changes](https://me.sap.com/notes/0002495462/E/diff)
- [Edit Note](https://me.sap.com/notes/edit/0002495462)
- [Attachments](https://me.sap.com/notes/0002495462/attachments)

For detailed implementation steps, refer to the [Manual Activities](https://me.sap.com/notes/2495462#manualactivities) section within the note.

**Credits**

Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.