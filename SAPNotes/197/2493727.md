SAP Security Note 2493727 - SSRF Vulnerability in Central Management Console, BI Launchpad, and Fiori BI Launchpad

**SAP Security Note 2493727 - [CVE-2018-2370] Server Side Request Forgery (SSRF) Vulnerability in Central Management Console, BI Launchpad, and Fiori BI Launchpad**

**Summary:**
A Server Side Request Forgery (SSRF) vulnerability has been identified in the Central Management Console (CMC), BI Launchpad, and Fiori BI Launchpad. This vulnerability allows an attacker to manipulate the application to send crafted requests on behalf of the application.

**Details:**

### Symptom
Central Management Console, BI Launchpad, and Fiori BI Launchpad allow an attacker to manipulate the vulnerable application to send crafted requests, resulting in an SSRF vulnerability. Potential impacts include:

- Information gathering for further exploits/attacks

### CVSS Information
- **CVSS v3 Base Score:** 5.8 / 10
- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** None (N)
- **User Interaction:** None (N)
- **Scope:** Changed (C)
- **Confidentiality Impact:** Low (L)
- **Integrity Impact:** None (N)
- **Availability Impact:** None (N)

*Note: The CVSS score is provided as an estimate and should be considered alongside your own risk assessments.*

### Reason and Prerequisites
The login pages of CMC and BI Launchpad (when enabled) allow users to enter a custom CMS host and port number. An attacker can use common techniques to determine which ports are in use on the backend server.

### Solution
To mitigate this SSRF vulnerability, implement a whitelist of valid CMS names or IPs along with port numbers. The application will allow login only if the entered values match those in the whitelist.

**Steps:**

1. Edit the `global.properites` file located in `<BOEInstallDir>\tomcat\webapps\BOE\WEB-INF\internal`.
2. Enter the list of CMS names or IPs along with port numbers in the `allowed.cms` property. For example:
   ```
   allowed.cms=<cms name or IP>:<port number>
   ```
   For multiple CMSes, separate them with commas:
   ```
   allowed.cms=<cms1>:<port1>,<cms2>:<port2>
   ```
3. If using a clustered CMS, ensure that both the cluster name and specific CMS names are present in the `allowed.cms` property.

*Note: To log in using either CMS name or IP, add both to the `allowed.cms` property. If the port number is omitted, the default port will be used.*

**Exceptions:**
- Default configurations where `cms.visible` is set to false and a default CMS is configured.
- Login via Single Sign-On.

### Affected Software Components
- **ENTERPRISE:** Versions 410, 420+, 430+

### Support Package Patches
Apply the relevant support package patches based on your software component version:

- **SBOP BI PLATFORM SERVERS 4.3**
  - SP000 Patch Level 000000
  - [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)

- **SBOP BI PLATFORM SERVERS 4.2**
  - SP004 Patch Level 000006
  - [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
  - SP003 Patch Level 000012
  - [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
  - SP005 Patch Level 000000
  - [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)

- **SBOP BI PLATFORM SERVERS 4.1**
  - SP009 Patch Level 000009
  - [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
  - SP008 Patch Level 000013
  - [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
  - SP011 Patch Level 000000
  - [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
  - SP010 Patch Level 000003
  - [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)

### References
For more information, refer to the [SAP Security Notes](https://me.sap.com/securitynotes).

**Credits:** Information supported by [Redrays](https://redrays.io).