SAP Security Note 1527035 - Potential access of saved data in PCO

**Overview**
SAP Security Note [1527035](https://notesdownloads.sap.com/note/0040000009056182017) addresses a critical SQL injection vulnerability in the Posting Control Office (PCO) component (`FS-PCO`) of the Financial Services module. This vulnerability allows malicious users to manipulate database commands, potentially retrieving sensitive information stored in the system.

**Vulnerability Details**
- **Type:** SQL Injection
- **Component:** Financial Services > Posting Control Office (`FS-PCO`)
- **Impact:** Unauthorized access to persisted data
- **Priority:** High
- **Release Status:** Released for Customer on June 14, 2011

**Symptoms**
A malicious user can exploit the PCO by using specially crafted inputs to modify SQL statements, leading to the retrieval of additional data from the database.

**Reason and Prerequisites**
The vulnerability arises from the concatenation of user-supplied strings into SQL statements without proper sanitization, allowing SQL commands to be altered and executed.

**Solution**
1. **Import Support Packages:**
   - Ensure that you have the relevant support packages installed for your SAP release. Specific support packages are listed in the note under the [Support Package](https://me.sap.com/supportpackage/SAPKISC215) section.

2. **Manual Correction Steps:**
   - **Create Permitted Tables:**
     - Use transaction `SE11` to create the table `TBCA_DCA_VALTAB` with the following settings:
       - **Delivery Class:** `S`
       - **Table View Maintenance:** Display/Maintenance Allowed with Restrictions
       - **Fields:**
         - `TABLENAME` (Key, Data element: `TABNAME`)
       - **Technical Settings:**
         - **Data Class:** `APPL2`
         - **Size Category:** `0`
         - **Buffering:** Fully Buffered
         - **Log Data Changes:** Enabled
       - **Enhancement Category:** Cannot Be Enhanced
       - **Package:** `BCA_DCA_TEST`
     - Refer to [Note 618242](https://me.sap.com/notes/618242) for detailed instructions on creating tables.

   - **Create Maintenance View:**
     - Use transaction `SE11` to create the maintenance view `V_BCA_DCA_VALTAB`:
       - **Short Description:** Maintenance View for Table `TBCA_DCA_VALTAB`
       - **Tables:** `TBCA_DCA_VALTAB`
       - **Fields:** `TABLENAME` (Key, Data element: `TABNAME`)
       - **Maint. Status:** Read, Change, Delete, and Insert
       - **Delivery Class:** `S`
       - **Table View Maintenance:** Display/Maintenance Allowed
       - **Package:** `BCA_DCA_TEST`

   - **Generate Maintenance Dialog:**
     - Use transaction `SE54` to create the maintenance dialog for `V_BCA_DCA_VALTAB`:
       - **Authorization Group:** `FA01`
       - **Function Group:** `BCA_DCA_TEST_GD`
       - **Package:** `BCA_DCA_TEST`
       - **Maintenance Type:** One Step
       - **Maintenance Screen No.:** Overview screen `100`, Single screen `0`
       - **Recording Routine:** Standard
       - **Compare Flag:** Automatically Adjustable
     - Test the maintenance dialog using transaction `SM30` to ensure all fields are accessible.

   - **Populate Permitted Tables:**
     - Using transaction `SM30`, add the following table names to `V_BCA_DCA_VALTAB`:
       - `BAPC_ACTION_LOG`
       - `BAPC_ORDER`
       - `BCA_PAYMITEM`
     - Save the entries to apply the changes.

**Downloads**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009056182017)
- [PDF Version](https://me.sap.com/userapps.support.sap.com/sap/support/sfm/notes/print/0001527035?language=en-US&token=322D49A3CE07ECC98CF7E167BFF761F1)

**References**
- [Creating Tables in SAP](https://me.sap.com/notes/618242)
- [Support Packages for FS-PCO](https://me.sap.com/supportpackage/SAPKISC215)

**Impact Assessment**
- **CVSS Score:** 0 (Details not provided)
- **Affected Versions:** Release 100, 200, 300 of `FSAPPL`, and Release 30, 40 of `BANK-TRBK`

**Additional Information**
Implementing the provided correction instructions and applying the necessary support packages will mitigate the SQL injection vulnerability in the Posting Control Office, enhancing the security of your SAP environment.

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*