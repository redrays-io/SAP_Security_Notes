1526102 - IS-H: Directory Traversal Vulnerability in IS-H

**SAP Note Number:** 1526102  
**Title:** IS-H: Directory Traversal Vulnerability in IS-H  
**Type:** SAP Security Note  
**Version:** 3  
**Release Status:** Released for Customer  
**Released On:** 14.12.2010  
**Component:** IS-H (Industry-Specific Components > Hospital)

### Description
IS-H contains a vulnerability that allows a malicious user to potentially read or write arbitrary files on the remote server, which could lead to data corruption or alter system behavior.

### Symptom
A malicious user can exploit the vulnerability to read or write arbitrary files on the remote server.

### Reason and Prerequisites
Reports in IS-H fail to correctly validate the path where a user-submitted file is written. This flaw allows an attacker to potentially overwrite data on the remote system.

### Solution
1. **Implement Support Package 04 for EHP5**  
   Ensure that you apply Support Package 04 as a prerequisite for this note.

2. **Refer to SAP Note 1497003**  
   For additional information and instructions, refer to [Note 1497003](https://me.sap.com/notes/1497003). The corrections from this note are required before implementing the current note.

3. **Manual Activities Required**  
   - **Transaction FILE:**  
     Execute transaction `FILE` in your SAP system.
   - **Logical File Name Definition:**  
     Navigate to 'Logical File Name Definition, Cross-Client' in the tree on the left side.
   - **Create New Entries:**  
     For each report name listed below, create a new entry with the following details:
     - **Logical file:** `<REPORTNAME>`
     - **Name:** `Validation for <REPORTNAME>`
     - **Data format:** `DIR`
     - **Applicat. area:** `IS`
   - **Report Names to Configure:**
     - RNAICD50
     - RNAP21F01
     - RNC301C3
     - RNC301CHECKDATACOLLPOINTS
     - RNC301H3
     - RNC301T0
     - RNC302C0
     - RNCAMB00
     - RNCCHK02
     - RNCSDO00
     - RNIARZ01
     - RNIDEB01
     - RNIFID00
     - RNIGPA01
     - RNIKOS01
     - RNIKRH01
     - RNILST00
     - RNIMCONS0
     - RNNLLAZR
     - RNSKHSTATV2003
     - RNSKHSTATV2004
     - RNSKHSTATV2005
     - RNSKHSTATV2006
     - RNSKHSTATV2007
     - RNSSA9_2004
     - RNSSA9_2005
     - RNSSA9_2006
     - RNSSA9_2007
     - RNUDIAG2
     - RNUDIAG3
     - RNUDIAG4
     - RNUICPM4
     - RNUPLZSG
     - RNVPPR01

### Prerequisites
- **Support Package Requirements:**  
  Ensure that the following Support Packages are applied to your SAP components:
  - IS-H versions 463B, 472, 600, 602, 603, 604, 605

- **Related SAP Notes:**  
  A comprehensive list of prerequisite notes can be found [here](https://me.sap.com/notes/1526102).

### Side Effects
Implementing this note may cause side effects as documented in [SAP Note 1577000](https://me.sap.com/notes/1577000), which addresses problems after implementing Note 1526102.

### References
- [SAP Note 1637243](https://me.sap.com/notes/1637243): Further correction instructions for lower patches
- [SAP Note 1497003](https://me.sap.com/notes/1497003): Potential directory traversals in applications

For more detailed information, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for support in providing this information.*