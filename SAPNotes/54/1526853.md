1526853 - Protection of upgrade tools against acts of sabotage

**SAP Security Note 1526853**  
*Released On:* 21.10.2014  
*Type:* SAP Security Note  
*Version:* 6  
*Category:* Program error  
*Priority:* Correction with high priority  
*Status:* Released for Customer  
*Language:* English  
*Master Language:* German  
*Component:* Basis Components > Upgrade - general > Upgrade Tools (SUM) > Upgrade tools for ABAP  
*SAP Component Key:* BC-UPG-TLS-TLA

### Symptom
If you execute upgrade tools directly in test mode, a malicious user can use a clever selection of input parameters to overwrite or delete system-relevant data or files.

### Other Terms
Directory traversal, SQL injection, code injection, upgrade tools

### Reason and Prerequisites
Upgrade tools are structured in such a way that they can be called by standalone C programs (SAPup, SAPehpi). Therefore, many programs and function modules have input parameters that control the behavior of the tools dynamically, in order to accommodate the numerous scenarios involved in an upgrade or an Enhancement Package installation.

### Solution
**Note:** If you have already used SUM Version SP05 or above in your system, you can ignore this SAP Note, because all affected objects have either been deleted or adapted accordingly.

1. **Set the table maintenance parameter for the table TICNV to 'Display/Maintenance Allowed with Restrictions'.**

2. **Safeguard Execution:**
   - Either safeguard the execution of programs and function modules appropriately
   - **Or** implement the attached corrections. After implementing the corrections, execution is permitted only for the system-wide user DDIC. Ensure adequate access restrictions exist for this user.
   - Refer to the comments about the automatic implementation.

3. **Implement SAP Note:** Always implement this SAP Note after executing the "Extraction" step or the "Import" step of an upgrade or an EHPI application.

**Comments about the automatic implementation:**
- The corrections are valid for all releases equally, including releases < 46A.
- Individual objects may cause warnings and errors during automatic implementation due to:
  1. The object does not exist in the system. These errors can be ignored.
  2. The object exists, but the source code deviates from the correction instructions. Use the split-screen editor of the Note Assistant to insert the new source code lines appropriately.
- It's crucial to implement this SAP Note again after performing the extraction phase of an upgrade, EHP installation, or a support package import using SAPup, EHPI, or SUM.

### Actions
- **Download for SNOTE:** [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009054932017)
- **PDF Version:** [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001526853?language=en-US&token=E6A20C457880A93B378B24092D28EEDF)
- **Share by Email:** (Event)
- **Open in New Window:** (Event)
- **Show Changes:** [Show Changes](https://me.sap.com/notesLatestChanges/0001526853/E/diff)

### Validity
This SAP Note is applicable to the following software components and versions:

- **SAP_APPL:**
  - 31I
  - 40A to 40B
  - 45A to 45B
- **SAP_BASIS:**
  - 46A to 46D
  - 610 to 640
  - 700 to 702
  - 710 to 730

### Correction Instructions
- **SAP_BASIS:** 4 Correction Instructions  
  [View Corrections](https://me.sap.com/corrins/0001526853/41)
- **SAP_APPL:** 1 Correction Instruction  
  [View Correction](https://me.sap.com/corrins/0001526853/1)

### References
**This document refers to:**
- [SAP Note 1926261](https://me.sap.com/notes/1926261)
- [SAP Note 1878193](https://me.sap.com/notes/1878193)
- [SAP Note 1843776](https://me.sap.com/notes/1843776)
- [SAP Note 1790828](https://me.sap.com/notes/1790828)
- [SAP Note 1732061](https://me.sap.com/notes/1732061)
- [SAP Note 1707161](https://me.sap.com/notes/1707161)

**This document is referenced by:**
- [SAP Note 3474726 - Central Note - Software Update Manager 2.0 SP22 [lmt_022]](https://me.sap.com/notes/3474726)
- [SAP Note 3429205 - Central Note - Software Update Manager 2.0 SP21 [lmt_021]](https://me.sap.com/notes/3429205)
- [SAP Note 3412485 - Central Note - Software Update Manager 1.1 SP04 [lmt_007]](https://me.sap.com/notes/3412485)
- [SAP Note 3334353 - Central Note - Software Update Manager 1.1 SP03 [lmt_006]](https://me.sap.com/notes/3334353)
- [SAP Note 2882395 - Central Note - Software Update Manager 1.0 SP26 [lmt_004]](https://me.sap.com/notes/2882395)

### Credits
Credits to [redrays.io](https://redrays.io) for support in providing this information.