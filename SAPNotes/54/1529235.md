SAP Security Note 1529235 - Missing authorization check in TH_CREATE_FOREIGN_MODE

**Overview**

- **SAP Note Number:** 1529235
- **Type:** SAP Security Note
- **Version:** 3
- **Recency:** New
- **Language:** English
- **Released On:** 13.09.2011
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Component:** Basis Components > Client/Server Technology > Dispatcher, Task Handler (BC-CST-DP)

**Title**

1529235 - Missing authorization check in TH_CREATE_FOREIGN_MODE

**Description**

### Symptom

An authenticated user can use the functionality of `TH_CREATE_FOREIGN_MODE` to which access should be restricted. This can potentially result in an escalation of privileges.

**CVSS Information**

- **Base Score:** 6.0
- **Vector:** AV:N/AC:M/AU:S/C:P/I:P/A:P

*Note:* SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. It does not account for your system configuration or operational environment. Conduct your own risk assessment to determine the applicability or priority of this security note. More information is available in the [SAP Security Notes FAQ](https://service.sap.com/securitynotes/).

### Other Terms

Authorization, authorization check

### Reason and Prerequisites

`TH_CREATE_FOREIGN_MODE` lacks permission checks for an authenticated user's authorization to access some of its functionality. This may result in undesired system behavior.

### Solution

Apply the correction instructions from this note and assign proper authorizations for users allowed to use `TH_CREATE_FOREIGN_MODE`. The correction includes changes in ABAP and the kernel. Ensure you apply the kernel patch level mentioned in this note. For the ABAP correction, apply the support package specified.

**CVSS**

- **CVSS Score:** 6.0
- **Vector:** AV:N/AC:M/AU:S/C:P/I:P/A:P

**Affected Software Components**

- **SAP_BASIS:** Various versions from 46C to 730
- **KERNEL:** Versions 4.6D to 7.20
- *(Refer to the full list of affected components and versions in the note for detailed compatibility)*

**Support Packages**

Apply the relevant support package for your software component version. For example:

- **SAP_BASIS 46C:** [SAPKB46C62](https://me.sap.com/supportpackage/SAPKB46C62)
- **SAP_BASIS 640:** [SAPKB64028](https://me.sap.com/supportpackage/SAPKB64028)
- *(Complete list available in the Support Package section of the note)*

**Correction Instructions**

There are 22 correction instructions available for SAP_BASIS. You can access them [here](https://me.sap.com/corrins/0001529235/41).

**Download and Additional Resources**

- **Download for SNOTE:** [Download](https://notesdownloads.sap.com/note/0040000009069672017)
- **PDF Version:** [PDF Download](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001529235?language=en-US&token=B70DB0A458982CB8E014FA29A10E1DCB)
- **Edit Note:** [Edit Note](https://me.sap.com/sap/support/notes/edit/0001529235)
- **Available Languages:** Deutsch, 日本語, Português (Machine Translation), Español (Machine Translation), Français (Machine Translation), Italiano (Machine Translation), Русский (Machine Translation), 中文 (Machine Translation), 한국어 (Machine Translation)
  
**References**

- **This document refers to:** [SAP Note 733300 - Notification when SAPphone dialog box is not opened](https://me.sap.com/notes/733300)
- **Referenced by:** [SAP Note 733300 - Notification when SAPphone dialog box is not opened](https://me.sap.com/notes/733300)

**Validity**

Applies to various versions of SAP_BASIS and KERNEL components. Ensure your system falls within the valid ranges specified in the note.

**Credits**

Credits to [Redrays](https://redrays.io) for support in providing this information.