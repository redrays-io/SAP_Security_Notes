1528292 - Directory Traversal problem in the OCS functionality

## Symptom

The OCS functionality (Support Package Manager or Add-On Installation Tool) contains a vulnerability through which a malicious user can potentially process arbitrary files on the remote server, possibly disclosing confidential information.

## Other Terms

directory, traversal, Support Package Manager, Add-On Installation Tool

## Reason and Prerequisites

The OCS functionality fails to correctly validate the authorization of RFC-enabled function modules with which a file that is read and processed from the remote server is referenced. If a malicious user has knowledge of any user in the SAP system, they can open any file for processing via RFC.

## Solution

**Basis Release 6.20 - 7.30:**

This error is fixed in the SPAM/SAINT update (Version 0040). [Implement this SPAM/SAINT update](https://notesdownloads.sap.com/note/0040000009064112017) (or a higher update) as soon as possible.

After implementing the update, users can read files and process via RFC only if they have system administrator authorization.

**Basis Release 4.6x:**

This error is fixed in the SPAM/SAINT update (Version 4.6C/0051). [Implement this SPAM/SAINT update](https://notesdownloads.sap.com/note/0040000009064112017) (or a higher update) as soon as possible. You can also import the SPAM/SAINT update for Basis Release 4.6C in systems with Basis Releases 4.6B and 4.6D.

After implementing the update, users can read files and process via RFC only if they have system administrator authorization.

**R/3 Releases 4.0B and 4.5B:**

Import the latest SPAM/SAINT update (Version 0049) and then implement the corrections of the following [correction instructions](https://me.sap.com/corrins/0001528292/1).

After applying these corrections, users can read files and process via RFC only if they have system administrator authorization.

## Manual Activities

To apply the necessary corrections manually, follow these steps:

1. Call transaction SE37.
2. Enter the function module name `OCS_EXTENDED_UPLOAD`, select the "Interface" option under "Subobjects," and choose "Change."
3. Confirm the dialogs for object repairs, object keys, and the change request used.
4. Switch to the "Exceptions" tab page and add the exception `MISSING_AUTHORIZATION` at the end of the list.
5. Switch to the "Documentation" tab page and add the following short text for the exception `MISSING_AUTHORIZATION`:  
   *"Missing authorization for reading the attributes"*
6. Save the function module.
7. Repeat the above steps for the function modules `OCS_GET_UPG_STACK_INFO` and `OCS_PATCH_DISASSEMBLER`, updating the exception documentation accordingly.
8. Implement the source code corrections for the three function modules as per the [correction instructions](https://me.sap.com/corrins/0001528292/1).
9. Activate the three function modules.

## Affected Software Components

- **SAP_APPL**: Releases 40B and 45B
- **SAP_BASIS**: Releases 46B to 46D, 620 to 640, 700 to 702, 710 to 730

## Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009064112017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001528292?language=en-US&token=48DD9F56DC919BF5330489612D95CBF0)

## Credits

Information provided by [RedRays](https://redrays.io).