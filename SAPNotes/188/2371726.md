2371726 - Code Injection Vulnerability in Text Conversion

**Symptom**

**UPDATE 13 October 2017**: This note has been re-released with updated 'Correction Instructions' information.

Text Conversion, which enables SAP standard text to be replaced by industry-specific text, allows an attacker to inject code that can be executed by the application. An attacker could thereby control the behavior of the application.

Some well-known impacts of Code Injection vulnerability are:
- Unauthorized execution of commands
- Sensitive information disclosure
- Denial of Service

**CVSS Information**

- **CVSS v3 Base Score:** 9.1 / 10
- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** High (H)
- **User Interaction:** None (N)
- **Scope:** Changed (C)
- **Confidentiality Impact:** High (H)
- **Integrity Impact:** High (H)
- **Availability Impact:** High (H)

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/supportnotes).

**Reason and Prerequisites**

Function `BRAN_DIR_CREATE` enables an authenticated development user to inject operating system commands and execute these from the SAP system via that function. Developer rights (S_DEVELOP) are required.

**Solution**

The solution restricts the name of the directory to be created to a real name, allowing only "_" as a special character.

Please apply the Support Package mentioned in this SAP Note, or the respective correction instruction.

**Support Package**

- **SAP_BASIS 700:** [SAPKB70034](https://me.sap.com/supportpackage/SAPKB70034)
- **SAP_BASIS 701:** [SAPKB70119](https://me.sap.com/supportpackage/SAPKB70119)
- **SAP_BASIS 702:** [SAPKB70219](https://me.sap.com/supportpackage/SAPKB70219)
- **SAP_BASIS 710:** [SAPKB71022](https://me.sap.com/supportpackage/SAPKB71022)
- **SAP_BASIS 711:** [SAPKB71117](https://me.sap.com/supportpackage/SAPKB71117)
- **SAP_BASIS 730:** [SAPKB73017](https://me.sap.com/supportpackage/SAPKB73017)
- **SAP_BASIS 731:** [SAPKB73120](https://me.sap.com/supportpackage/SAPKB73120)
- **SAP_BASIS 740:** [SAPKB74017](https://me.sap.com/supportpackage/SAPKB74017)
- **SAP_BASIS 750:** [SAPK-75006INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75006INSAPBASIS)
- **SAP_BASIS 751:** [SAPK-75101INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75101INSAPBASIS)

**References**

- [Potential Modification of Persisted Data in IS-R-STR](https://me.sap.com/notes/1673713)

For more details, visit the [SAP Security Notes](https://me.sap.com/supportnotes). 

*Credits to [RedRays](https://redrays.io) for support in providing this information.*