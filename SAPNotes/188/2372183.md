2372183 - Cross-Site Scripting (XSS) Vulnerability in SAP Enterprise Portal Theme Editor

# SAP Security Note 2372183 - Cross-Site Scripting (XSS) Vulnerability in SAP Enterprise Portal Theme Editor

**SAP Note/KBA**: 2372183  
**Type**: SAP Security Note  
**Version**: 3  
**Recency**: New  
**Language**: English  
**Priority**: Correction with medium priority  
**Release Status**: Released for Customer  
**Released On**: January 10, 2017  
**Component**: Enterprise Portal > SAP Enterprise Portal (On Premise) > Themes / Portal UI Theme Designer / Theme Editor

## Description

### Symptom

The `LogPortalComponent` does not sufficiently encode user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability.

**Impacts of XSS Vulnerability:**
- Non-permanently deface or modify displayed content from a website.
- Steal authentication information of the user, such as data relating to their current session.
- Impersonate the user and access all information with the same rights as the target user.

### CVSS Information

**CVSS v3 Base Score:** 5.4 / 10  
**CVSS v3 Base Vector:**
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

*Note:* SAP provides this CVSS v3 base score as an estimate of the risk. It does not account for your specific system configuration or operational environment. Conduct your own risk assessments to determine applicability and priority.

### Solution

Proper encoding targeting input validation has been added to address the vulnerability.

Refer to the [Support Packages & Patches](https://me.sap.com/notes/0002372183) link to view the versions that include the fix.

## Available Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018407202017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002372183?language=en-US&token=717DA40CB2C1226F667EBB94EC0D0F7E)
- Share by Email
- Open in New Window

## Support Package Patches

| Software Component Version | Support Package | Patch Level | URL |
|----------------------------|-----------------|-------------|-----|
| EP RUNTIME 7.50            | SP005           | 000001      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP005&patch_level=000001) |
| EP RUNTIME 7.20            | SP009           | 000016      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012953&support_package=SP009&patch_level=000016) |
| EP RUNTIME 7.50            | SP007           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP007&patch_level=000000) |
| EP RUNTIME 7.50            | SP006           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP006&patch_level=000000) |
| EP RUNTIME 7.40            | SP013           | 000014      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP013&patch_level=000014) |
| EP RUNTIME 7.40            | SP014           | 000001      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP014&patch_level=000001) |
| EP RUNTIME 7.40            | SP015           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP015&patch_level=000000) |
| EP RUNTIME 7.11            | SP016           | 000001      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006929&support_package=SP016&patch_level=000001) |
| EP RUNTIME 7.30            | SP016           | 000003      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015108&support_package=SP016&patch_level=000003) |
| EP RUNTIME 7.30            | SP017           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015108&support_package=SP017&patch_level=000000) |
| EP RUNTIME 7.11            | SP017           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006929&support_package=SP017&patch_level=000000) |
| PORTAL 7.01                | SP018           | 000004      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200010804&support_package=SP018&patch_level=000004) |
| EP RUNTIME 7.31            | SP018           | 000013      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP018&patch_level=000013) |
| PORTAL 7.02                | SP018           | 000005      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012489&support_package=SP018&patch_level=000005) |
| EP RUNTIME 7.31            | SP019           | 000001      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP019&patch_level=000001) |
| PORTAL 7.01                | SP019           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200010804&support_package=SP019&patch_level=000000) |
| PORTAL 7.02                | SP019           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012489&support_package=SP019&patch_level=000000) |
| EP RUNTIME 7.31            | SP020           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP020&patch_level=000000) |
| EP RUNTIME 7.10            | SP021           | 000001      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006348&support_package=SP021&patch_level=000001) |
| EP RUNTIME 7.10            | SP022           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006348&support_package=SP022&patch_level=000000) |
| PORTAL 7.00                | SP033           | 000003      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200007801&support_package=SP033&patch_level=000003) |
| PORTAL 7.00                | SP034           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200007801&support_package=SP034&patch_level=000000) |

## References

This document is referenced by:

- [2463662 - Central Note for NetWeaver 7.31 SP20 Enterprise Portal Core](https://me.sap.com/notes/2463662)
- [2463570 - Collective Note: SAP NetWeaver 7.31 SP20 - Composition Platform](https://me.sap.com/notes/2463570)
- [2407374 - Central Note: SAP NetWeaver 7.5 SP07- EP Core (Application Platform)](https://me.sap.com/notes/2407374)
- [2407350 - Collective Note: SAP NetWeaver 7.5 SP07 - Composition Platform](https://me.sap.com/notes/2407350)
- [2403195 - Corrections for unified rendering 701/19 III (UR Mimes)](https://me.sap.com/notes/2403195)

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*