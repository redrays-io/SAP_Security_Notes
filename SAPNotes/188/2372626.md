SAP Security Note 2372626: Missing XML Validation Vulnerability in SAP NetWeaver Log Viewer

**Symptom**

The Log Viewer application in SAP NetWeaver Administrator does not sufficiently validate an XML document accepted from an untrusted source. This Missing XML Validation vulnerability can lead to:

- **Arbitrary file retrieval** from the server
- **Denial-of-Service (DoS)** conditions in successful exploits

**CVSS Information**

- **CVSS v3 Base Score:** 5.5 / 10
- **Vector:** 
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** High (H)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** Low (L)

*Note: This CVSS score is an estimate and does not account for your specific system configuration or operational environment. Conduct your own risk assessments when determining the applicability or priority of this security note.*

**Solution**

The XML parser is now configured securely to disallow external entities in incoming XML documents. To address this vulnerability:

1. **Apply the Support Packages and Patches** referenced in this SAP Note.
2. **Enable the XML Hardner** as described in the manual activities below.

**Manual Activities**

You must perform the following manual activity in each system where you transport the Note for implementation:

- **Enable the XML Hardner for your NetWeaver Java AS.**
  
  Refer to the official documentation for detailed steps: [Enable XML Hardner Documentation](https://me.sap.com/saphelp_nw75/helpdata/en/78/e3109bf9ea4e56bdec56f09a100863/content.htm)

- **Verify Configuration:**
  
  Use the Change Reporting and Configuration Validation tools in SAP Solution Manager to check the setting of the XML Hardener for all systems in your landscape. Look for the parameter `enable.xml.hardener` in the Configuration Store `xmlhardener_srv`.

  Additional resources:
  
  - [SAP CoE Security Services â€“ Checking Security Configuration and Authorization](https://support.sap.com/sos)
  - [AGS_Check_Config_and_Auth.pdf](https://support.sap.com/content/dam/library/SAP%20Support%20Portal/support-programs-services/support-services/security-optimization-service/media/AGS_Check_Config_and_Auth.pdf)
  - [Configuration Validation Wiki](https://wiki.scn.sap.com/wiki/display/TechOps/ConfVal_Home)

**Support Package Patches**

Apply the relevant support package patches for your software component version. Access the patches here: [Support Package Patches](https://me.sap.com/sap/support/swdc/notes)

**References**

- [SAP Note 2248846](https://me.sap.com/notes/2248846): XML Hardener Service Start Error
- [SAP Note 2332237](https://me.sap.com/notes/2332237): SAP NetWeaver 7.30 SP17 - NWDS Update Site Standalone
- [SAP Note 2463530](https://me.sap.com/notes/2463530): Central Note for SAP NetWeaver 7.31 SP20 Application Server Java

**Credits**

Information provided with support from [RedRays.io](https://redrays.io).