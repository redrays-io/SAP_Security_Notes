2373032 - Cross-Site Scripting (XSS) vulnerability in WebClient User Interface

**Title:** 2373032 - Cross-Site Scripting (XSS) vulnerability in WebClient User Interface

**Description:**
  
**UPDATE 7th June 2017:** This note has been re-released with updated 'Validity' information.

The `WebClient User Interface/CRM_THTMLB_UTIL` does not sufficiently encode user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability.

**Impacts of XSS Vulnerability:**
- Non-permanently deface or modify displayed content from a website
- Steal authentication information of the user, such as data relating to their current session
- Impersonate the user and access all information with the same rights as the target user

**CVSS Information:**
- **CVSS v3 Base Score:** 5.4 / 10
- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** Low (L)
- **User Interaction:** Required (R)
- **Scope:** Changed (C)
- **Confidentiality Impact:** Low (L)
- **Integrity Impact:** Low (L)
- **Availability Impact:** None (N)

*SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).*

**Reason and Prerequisites:**
The input was not being encoded.

**Solution:**
The URL parameters have been encoded to prevent XSS.

*Implement the Support Packages and Patches referenced by this SAP Note.*

**Support Package Information:**
- **Software Component:** WEBCUIF
  - **Versions Affected:**
    - 700
    - 701
    - 730
    - 731
    - 746
    - 747
    - 748
    - 800
    - 801
  - **Support Packages:**
    - [SAPK-70019INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70019INWEBCUIF)
    - [SAPK-70116INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70116INWEBCUIF)
    - [SAPK-73011INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73011INWEBCUIF)
    - [SAPK-73119INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73119INWEBCUIF)
    - [SAPK-74611INWEBCUIF](https://me.sap.com/supportpackage/SAPK-74611INWEBCUIF)
    - [SAPK-74713INWEBCUIF](https://me.sap.com/supportpackage/SAPK-74713INWEBCUIF)
    - [SAPK-74805INWEBCUIF](https://me.sap.com/supportpackage/SAPK-74805INWEBCUIF)
    - [SAPK-80004INWEBCUIF](https://me.sap.com/supportpackage/SAPK-80004INWEBCUIF)
    - [SAPK-80101INWEBCUIF](https://me.sap.com/supportpackage/SAPK-80101INWEBCUIF)

**Correction Instructions:**
- **Software Component:** WEBCUIF
  - **Number of Correction Instructions:** 5
  - **Details:** [Correction Instructions](https://me.sap.com/corrins/0002373032/6555)

**Prerequisites:**
Ensure the following SAP Notes are implemented before applying this note:
- [2367401 - F4Help attribute wrongly encoded.](https://me.sap.com/notes/2367401)

**Side Effects:**
Applying this note may cause issues with the following SAP Notes:
- [2389724 - Selection from F4 value help does not work](https://me.sap.com/notes/0002389724)
- [2446409 - Search does not work in F4 Value help popup](https://me.sap.com/notes/0002446409)
- [2436159 - Selection from F4 value help does not work - Part 3](https://me.sap.com/notes/0002436159)
- [2453742 - Various problems with F4 Value Help](https://me.sap.com/notes/0002453742)

**Additional Actions:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000014001182017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002373032?language=en-US&token=FE1ECD24516C8423227DD6D629742565)
- [Share by Email](https://me.sap.com/)
- [Open in New Window](https://me.sap.com/)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002373032/E/diff)

*For more details, visit the [SAP Security Notes](https://me.sap.com/notes/0002373032).*

*Credits to [Redrays](https://redrays.io) for providing the information.*