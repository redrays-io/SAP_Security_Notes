3281724 - [CVE-2023-0019] Missing Authorization check in SAP GRC (Process Control)

**Symptom**

In SAP GRC Process Control application, a remote-enabled function module allows an authenticated attacker with minimal privileges to access all confidential data stored in the database. Successful exploitation can expose user credentials from client-specific tables, leading to a high impact on confidentiality.

**Other Terms**
- Information Exposure
- Information Leak
- Improper Authorization
- Improper Input Validation
- [CVE-2023-0019](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0019)

**Reason and Prerequisites**
- Missing authorization check for RFC user when calling GRC function modules via RFC in automated monitoring scenarios.
- For systems V1100_700, it is mandatory to have V1200 as the GRCFND_A system.

**Solution**

Additional authorization checks have been implemented when calling GRC function modules via RFC. The following scenarios have been covered:
- Configurable data source & business rule
- ABAP report
- Programmed business rule

**Manual Activities**

1. **Message Creation:**
    - Go to transaction code SE91 and enter "GRFN_AUTO_MONITOR" under Message Class.
    - Click on **Change**.
    - Create 3 new entries:
        - **712** RFC user doesn't exist
        - **713** RFC user not authorized
        - **714** RFC user is locked
    - Click **Save**.

2. **Authorization Object:**
    - Create authorization object class: **GGPC**
    - Create authorization object: **GRCCCM_001** with permittable activities: **ACTVT = 16**
    - Assign this authorization object to the RFC user in the plugin system.

**CVSS**

- **Score:** 6.5
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

**References**
- [Release Information Note for 12.0 SAP Process Control Support Package 20](https://me.sap.com/notes/3302407)

**Validity**

Applicable for the following software components and versions:
- **GRCFND_A:** V1200, V8100
- **GRCPINW:** V1100_700, V1100_731, V1200_750

**Download**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000169902023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003281724?language=en-US&token=35DB96E1AA62E89597D95E0D40A0645E)

**Attachments**
- [CreateAuthObject_SU21.docx](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=002075125800002937622022&iv_version=0002&iv_guid=00109B36BCB61EDD9EF1DDF97BDF0E1A)

**Credits**

Supported by [redrays.io](https://redrays.io)