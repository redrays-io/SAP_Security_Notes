3276120 - [CVE-2023-0012] Local Privilege Escalation in SAP Host Agent (Windows)

## Description

### Symptom
An attacker who gains local membership to `SAP_LocalAdmin` could replace executables with a malicious file that will be started under a privileged account. Note that by default, all user members of `SAP_LocalAdmin` are denied the ability to log on locally by security policy, so this can only occur if the system has already been compromised.

### Other Terms
- **Local Privilege Escalation**
- **Improper Access Control**
- **Privilege Escalation**
- [CVE-2023-0012](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0012)

### Reason and Prerequisites
- **Operating System:** Windows
- **SAP Host Agent Version:** 7.22 PL58 or lower
- **Requirements:**
  - Attacker must have access to credentials of a user that is a member of the `SAP_LocalAdmin` group.
  - The user must have the Windows "logon locally" user right.

## Solution
Please upgrade SAP Host Agent to at least version **7.22 PL59**. It is always recommended to upgrade to the latest available version.

Follow the procedure described in [Note 1031096](https://me.sap.com/notes/1031096).

## CVSS
- **Score:** 6.4 (Medium)
- **Vector:** [CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H)

  | Metric                | Value          |
  |-----------------------|----------------|
  | **Attack Vector (AV)**        | Local (L)       |
  | **Attack Complexity (AC)**    | High (H)        |
  | **Privileges Required (PR)**  | High (H)        |
  | **User Interaction (UI)**     | None (N)        |
  | **Scope (S)**                 | Unchanged (U)   |
  | **Confidentiality Impact (C)**| High (H)        |
  | **Integrity Impact (I)**      | High (H)        |
  | **Availability Impact (A)**   | High (H)        |

## References
- [Installing Package SAPHOSTAGENT](https://me.sap.com/notes/1031096)
- [SAP Host Agent 7.22 PL59](https://me.sap.com/notes/3272740)

## Action Items
- **Download for SNOTE:** [Download](https://notesdownloads.sap.com/note/0040000000024122023)
- **PDF Version:** [PDF](https://me.sap.com/sap/support/sfm/notes/print/0003276120?language=en-US&token=52B8E48026F68CBD34E2F1EC0FDC9740)

---

*Credits to [Redrays.io](https://redrays.io) for support and provided information.*