1593433 - Unauthorized use of app. functions in CERTREQ and CERTMAP

## Description

### Symptom
An attacker can execute functions in the BSP applications CERTREQ and CERTMAP without authentication and authorization.

### Other Terms
Cross-site request forgery, XSRF, CERTREQ, CERTMAP

### Reason and Prerequisites
The BSP applications CERTREQ and CERTMAP execute certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The attacker may use a cross-site scripting attack to do this, or they may present a link to the victim.

### Solution
1. For additional information and instructions, see [Note 1520324](https://me.sap.com/notes/1520324). The corrections from Note 1520324 are a prerequisite for implementing this note.
2. Implement the automatic correction instructions provided in this note. Then follow the instructions from the manual correction.

## Correction Instructions

1. **Automatic Corrections:**
   - Apply the correction instructions available [here](https://me.sap.com/corrins/0001593433/41) for the SAP_BASIS component.

2. **Manual Activities:**
   - **Step 1:** Call transaction SE80 and choose package `SUSR_CERT`.
   - **Step 2:** 
     - Select the BSP application `CERTMAP` and open the "Properties" tab. Set the flag "XSRF Protection".
     - Navigate to the page `default.htm`, open the "Properties" tab, and set the flag "Start BSP".
   - **Step 3:** Repeat the above steps for the BSP applications `CERTREQ` and, if applicable, `CERTREQ2` (NW 7.30 only).

## Attachments
- [ZBSP_XSRF_PARAM_CERTREQ.txt](https://me.sap.com/support/attachment.htm?iv_key=012003146900000282132011&iv_version=0005&iv_guid=110F8A290281A64F838001D7B2826F69)

## References
- **This document refers to:**
  - [Note 1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)

## Validity
Applicable to the following SAP_BASIS versions:
- 640, 700-702, 710-731

## Support Package
Ensure the relevant support packages are applied:
- Examples include [SAPKB64030](https://me.sap.com/supportpackage/SAPKB64030), [SAPKB70027](https://me.sap.com/supportpackage/SAPKB70027), etc.

## Prequisites
- Before applying this note, ensure the prerequisites listed in related notes such as [1417568](https://me.sap.com/notes/1417568), [1534115](https://me.sap.com/notes/1534115), and [1276176](https://me.sap.com/notes/1276176) are addressed.

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*