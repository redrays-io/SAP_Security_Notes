SAP Security Note 1593164 - Directory Traversal in Treasury Confirmation

**Overview**

SAP Security Note **1593164** addresses a **Directory Traversal** vulnerability in the **Treasury Confirmation (PSM-FG-TC)** component. This vulnerability allows attackers to potentially read or write arbitrary files on the remote server, which can lead to the disclosure of confidential information or corruption of data/system behavior.

**Details**

- **Note Number:** 1593164
- **Type:** SAP Security Note
- **Version:** 3
- **Status:** Released for Customer
- **Released On:** June 12, 2012
- **Component:** Public Sector Management > Federal Government Functions > Treasury Confirmation (PSM-FG-TC)
- **Category:** Program error
- **Priority:** Correction with high priority

**Affected Software Components**

| Software Component | From | To  |
|---------------------|------|-----|
| EA-PS               | 110  | 110 |
| EA-PS               | 200  | 200 |
| EA-PS               | 500  | 500 |
| EA-PS               | 600  | 600 |
| EA-PS               | 603  | 603 |
| EA-PS               | 604  | 604 |
| EA-PS               | 605  | 605 |
| EA-PS               | 606  | 606 |
| EA-PS               | 616  | 616 |

**Vulnerability Summary**

1. **Read Arbitrary Files:** Certain programs may allow attackers to read arbitrary files on the server, potentially exposing confidential information.
2. **Write Arbitrary Files:** Vulnerable programs may permit attackers to write arbitrary files, leading to data corruption or altered system behavior.

**Solution**

1. **Prerequisite:** Ensure that **Note 1497003** is implemented as it provides necessary corrections for this issue.
2. **Create Logical File/Path Names:**
   - `PSM_AUTO_TC_CREATE_PATH` / `PSM_AUTO_TC_CREATE_FILE`
   - `PSM_AUTO_TC_SWIFT_CREATE_PATH` / `PSM_AUTO_TC_SWIFT_CRE_FILE`
3. **Recommendations:**
   - Minimize the number of logical file names by sharing them across programs where feasible.
   - Structure directories to reflect user and program names to securely separate data.
4. **Apply Source Code Corrections:** Follow the attached correction instructions in the note.

**Download and Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009458412017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001593164?language=en-US&token=FECBD7CB6176D9FAAB90949CD4F2291C)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001593164)

**References**

- [Note 1863678: FMFG_AUTO_TC: SLIN_SEC message during transaction CHECKMAN](https://me.sap.com/notes/1863678)
- [Note 1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Translations Available**

SAP Note 1593164 is available in multiple languages including Japanese, German, Portuguese, Spanish, French, Italian, Russian, Chinese, and Korean. [View Translations](https://me.sap.com/notes/0001593164/J)

**Rating**

This document currently has no ratings. Feel free to rate its helpfulness and quality once you've reviewed it.

**Support Package**

Ensure that you apply the relevant support packages for your software component version:

- **EA-PS 110:** [SAPKGPPA34](https://me.sap.com/supportpackage/SAPKGPPA34)
- **EA-PS 200:** [SAPKGPPB23](https://me.sap.com/supportpackage/SAPKGPPB23)
- *(Additional support packages available in the note)*

**Credits**

Information provided with the assistance of [RedRays.io](https://redrays.io).