1533004 - Authentication bypass vulnerability in ESR

**SAP Security Note 1533004 - Authentication Bypass Vulnerability in ESR**

**Release Date:** November 8, 2011

**Description:**

**Symptom:**
Some Java-based administration pages used in the ESR administration are vulnerable to authentication bypass. This can potentially result in an escalation of privileges. Furthermore, it can be exploited for remote file overwrite, denial of service attacks, user locking, and SMB relay attacks.

**Other Terms:**
NetWeaver CE, Composition Environment, Process Integration, ESR, Enterprise Services Repository, Administration, HTTP, Authentication Bypass

**Reason and Prerequisites:**
Certain HTTP requests bypass the authentication checks performed for HTTP GET requests, allowing commands to be executed without proper authentication. The affected Java Servlets and Java Server Pages belong to the old administration pages, which were replaced in NetWeaver 7.1 with a Web Dynpro-based solution. However, the old pages still exist and are accessible.

**Affected Releases:**
- SAP_XITOOLS 6.40
- SAP_XITOOLS 7.00
- SAP_XITOOLS 7.01
- SAP_XITOOLS 7.02
- SAP_XIESR 7.10
- SAP_XIESR 7.11
- SAP_XIESR 7.20
- SAP_XIESR 7.30
- SAP_XIESR 7.31

**Solution:**
Apply the provided patch to ensure that each HTTP request undergoes the necessary authentication checks.

**Fixed Versions and Patch Levels:**
- **SAP_XITOOLS 6.40**
- **SAP_XITOOLS 7.00**
- **SAP_XITOOLS 7.01**
- **SAP_XITOOLS 7.02**, SP3 onwards
- **SAP_XIESR 7.10**, SP7 onwards
- **SAP_XIESR 7.11**, SP3 onwards
- **SAP_XIESR 7.20**, SP1 onwards
- **SAP_XIESR 7.30**, all SP's
- **SAP_XIESR 7.31**

*Please apply the support package from the list above or apply the correction from the [SAP Note 1533004](https://notesdownloads.sap.com/note/0040000017137872017).*

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017137872017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001533004?language=en-US&token=8E1E594224EB026C3EE3C05618930131)

**References:**
- [SAP Note 1580663](https://me.sap.com/notes/1580663) - XI 30 Support Package Stack (SPS) 28
- [SAP Note 1576121](https://me.sap.com/notes/1576121) - SAP EhP1 for XI on NetWeaver 7.00 SP09
- [SAP Note 1570042](https://me.sap.com/notes/1570042) - ESR, SR, UDDI, Messaging related changes in 7.11 SP07
- [SAP Note 1561929](https://me.sap.com/notes/1561929) - SAP EhP2 for NetWeaver 7.00 SP07
- [SAP Note 1531912](https://me.sap.com/notes/1531912) - SAP EhP1 for XI on NetWeaver 7.00 SP08
- [SAP Note 1459565](https://me.sap.com/notes/1459565) - SAP EHP1 for SAP NetWeaver PI 7.1 SP05

**Credits:**
Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.