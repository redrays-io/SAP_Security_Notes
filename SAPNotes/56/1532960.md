SAP Security Note 1532960 - Funding Management: Potential directory traversals

**Description**

**Symptom**
The default implementation of the BAdI for securitization (import and export of offers, sales, and portfolios) in Funding Management permits the reading or writing of arbitrary files to the application server.

**Other Terms**
- `/TXS/BADI_ABS`
- Directory traversal

**Reason and Prerequisites**
A gap in the program design within the attached correction instructions allows a user to read arbitrary files on the network, leading to unauthorized access to confidential information. Additionally, another design gap permits the writing of arbitrary files on the network, posing a security risk. For more details, refer to [Note 1497003](https://me.sap.com/notes/1497003).

**Solution**
Implement the attached correction instructions or import the relevant Support Package. Note that the corrections provided in [Note 1497003](https://me.sap.com/notes/1497003) are a prerequisite for implementing this note. If you apply the corrections from this note without those from Note 1497003, the relevant functions remain active, and file names are not validated.

When implementing the corrections from this note, logical file names and file paths are introduced to validate the input data. System administration must adjust the specific physical file paths according to requirements.

**Correction Instructions**
- [Correction Instructions for FUNDMGMT](https://me.sap.com/corrins/0001532960/6629)

**Support Package**
- [SAPK-20004INFUNDMGMT](https://me.sap.com/supportpackage/SAPK-20004INFUNDMGMT)

**References**
- [Note 1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**Manual Activities**
1. Create the following client-independent logical file paths:
   - `/TXS/ABS_EXPORT` (Securitization: Export of files)
   - `/TXS/ABS_IMPORT` (Securitization: Import of files)
2. Assign the logical file paths to physical file paths as specified by your system administration.
3. Define the following logical file names (client-independent):
   - `/TXS/ABS_EXPORT_OFFER` (Securitization: Export offer)
   - `/TXS/ABS_EXPORT_PORTFOLIO` (Securitization: Export portfolio)
   - `/TXS/ABS_IMPORT_PORTFOLIO` (Securitization: Import portfolio)
   - `/TXS/ABS_IMPORT_SALE` (Securitization: Import sale)
4. For all file names, use the data format "DIR" to validate file names and set the logical paths to `/TXS/ABS_EXPORT` and `/TXS/ABS_IMPORT`. Leave the physical file name empty.

**Download and Print**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009092762017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001532960?language=en-US&token=B01F4DF9BEAC8918D7A33EFED9805407)

**Credits**
Information provided with support from [RedRays.io](https://redrays.io).