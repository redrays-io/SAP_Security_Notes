SAP Security Note 1532497: Potential disclosure of persisted ERP data using CRM Plug-In

---

**SAP Security Note 1532497 - Potential disclosure of persisted ERP data using CRM Plug-In**

**Date Released:** 14.12.2010  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Component:** Customer Relationship Management > Internet Pricing and Configurator (CRM-IPC)  
**Type:** SAP Security Note  
**Version:** 3  
**Language:** English

### Symptom
A malicious user can exploit the IPC-specific CRM Plug-In in ERP or R/3 systems by using specially crafted inputs to modify database commands, resulting in the retrieval of additional information of data persisted by the system.

### Reason and Prerequisites
The issue is caused by an SQL injection vulnerability. The code composes an SQL statement including strings that can be altered by a malicious user, allowing retrieval of additional data from the database.

### Solution
1. **Apply the Fix:**
   - Apply this fix in all listed ERP or R/3 releases, even if the CRM Plug-in is not used in your scenario.
   
2. **For PI Releases 2004_1_46C, 2004_1_470, and 2004_1_500:**
   - Follow the manual implementation steps only.
   - Install the attached release-specific ZIP file containing the authorization object `IPC_RFC_DB` and related structures.
   - Ensure that after installing the ZIP file, relevant objects have been updated as per the correction instructions.
   
3. **For Other ERP Releases:**
   - Apply the relevant correction instructions using SNOTE.

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009089222017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001532497?language=en-US&token=4253208EDAE2830B0270DC8EAB6BE9E0)

**Attachments:**
- [PI20041500.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000617202010&iv_version=0003&iv_guid=C8E01E7810D32B4BA381C10BFA777C86) (7 MB)
- [PI20041470.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000617202010&iv_version=0003&iv_guid=0FD68880DC88234A8EEB8983336BB72C) (7 MB)
- [PI2004146C.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000617202010&iv_version=0003&iv_guid=079307EEACE16B4DB8B714A3C14CC1C7) (8 MB)

### Prerequisites
Ensure the following software components are updated:

- **SAP_APPL:**
  - 600
  - 602
  - 603
  - 604
  - 605
- **PI:**
  - 2004_1_46C
  - 2004_1_470
  - 2004_1_500

### Manual Activities

#### Pre-Implement
Install the attached release-specific ZIP file. This contains the authorization object `IPC_RFC_DB` and all related structures. Follow [Note 480180](https://me.sap.com/notes/480180) and [Note 13719](https://me.sap.com/notes/13719) for the installation.

#### Post-Implement
- **If using E-Commerce ERP scenario (as mentioned in [Note 884408](https://me.sap.com/notes/884408)):**
  - Follow the post-implementation steps provided.
- **Otherwise:**
  - Do not assign the newly created authorization to any user.
  - Create appropriate user roles using transaction PFCG.
  - Add the new authorization object `IPC_RFC_DB` with value `16` to the RFC user set in the RFC destination `IPC_REMOTE_DB_CONNECTION_XXX` (refer to [Note 884408](https://me.sap.com/notes/884408) for details).
  - Ensure that other users do not have this authorization object assigned.

### References
- [Note 876036 - Authorization check missing in the IPC_READ function group](https://me.sap.com/notes/876036)
- [Note 885670 - Corrections in the EXTRACT_DATA_IPC module](https://me.sap.com/notes/885670)

### Support Packages
- **PI:**
  - [SAPKIPZI4J](https://me.sap.com/supportpackage/SAPKIPZI4J) (2004_1_46C)
  - [SAPKIPZI5J](https://me.sap.com/supportpackage/SAPKIPZI5J) (2004_1_470)
  - [SAPKIPZI6L](https://me.sap.com/supportpackage/SAPKIPZI6L) (2004_1_500)
- **SAP_APPL:**
  - [SAPKH60019](https://me.sap.com/supportpackage/SAPKH60019) (600)
  - [SAPKH60209](https://me.sap.com/supportpackage/SAPKH60209) (602)
  - [SAPKH60308](https://me.sap.com/supportpackage/SAPKH60308) (603)
  - [SAPKH60409](https://me.sap.com/supportpackage/SAPKH60409) (604)
  - [SAPKH60504](https://me.sap.com/supportpackage/SAPKH60504) (605)

### CVSS
**Score:** 0  
**Vector:** Not Provided

### Rating
Not rated yet.

---

*Credits to [Redrays.io](https://redrays.io) for supporting information.*