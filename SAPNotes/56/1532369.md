1532369 - XSRF protection for applications based on WebClient UI

**SAP Security Note 1532369: XSRF protection for applications based on WebClient UI**

- **Type:** SAP Security Note
- **Version:** 2
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 21.03.2011
- **Component:** [Cross-Application Components > WebClient User Interface > User Interface > Runtime Environment](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'CA-WUI-UI-RT*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

### Description

#### Symptom
This security note has been updated. For details, see security note [1570290](https://me.sap.com/notes/1570290).

This note introduces general XSRF protection for applications that are based on the WebClient UI.

#### Reason and Prerequisites
There is a program error.

#### Solution
Implement the attached correction instructions. Also implement the manual correction instructions.

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009088632017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001532369?language=en-US&token=DE79C2781ADB6B08EA05D1C3EB0F7E11)
- Share by Email
- Open in New Window
- [Show Changes](https://me.sap.com/notesLatestChanges/0001532369/E/diff)

### References

**This document refers to:**
- [1608040 - CRM-IC: blank page with hint to security issue](https://me.sap.com/notes/1608040)
- [1599361 - CA-WUI-UI-TAG: Unauthorized use of application functions in Flex app.](https://me.sap.com/notes/1599361)
- [1570290 - CA-WUI-UI-RT: Update #1 to Security Note 1532369](https://me.sap.com/notes/1570290)
- [1557618 - CA-GTF-IC-FRW-MES: HREIC: Switch to HTTPS](https://me.sap.com/notes/1557618)

**This document is referenced by:**
- [1557618 - CA-GTF-IC-FRW-MES: HREIC: Switch to HTTPS](https://me.sap.com/notes/1557618)
- [1608040 - CRM-IC: blank page with hint to security issue](https://me.sap.com/notes/1608040)

### Software Components

- **CRMUIF**
  - From: 520 To: 520
  - From: 600 To: 600
- **WEBCUIF**
  - From: 700 To: 700
  - From: 730 To: 730

### Support Packages

- [SAPK-52013INCRMUIF](https://me.sap.com/supportpackage/SAPK-52013INCRMUIF) for CRMUIF 520
- [SAPK-60011INCRMUIF](https://me.sap.com/supportpackage/SAPK-60011INCRMUIF) for CRMUIF 600
- [SAPK-70009INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70009INWEBCUIF) for WEBCUIF 700
- [SAPK-73001INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73001INWEBCUIF) for WEBCUIF 730

### Correction Instructions

- [WEBCUIF - Correction Instruction 6555](https://me.sap.com/corrins/0001532369/6555)
- [CRMUIF - Correction Instruction 4415](https://me.sap.com/corrins/0001532369/4415) (2 instructions)

### Manual Activities

#### WEBCUIF
1. Call transaction SE11 and create a new data element named `BSP_WD_SECURITY_TOKEN`.
2. Enter the short description "128Bit security token" and use the predefined type `CHAR` with a length of 32.
3. On the "Field Label" tab, specify the labels:
   - 10: Token
   - 15: Secure Token
   - 20: Security Token
   - 14: Security Token
4. Save and activate the data element.
5. Call transaction SE91, open the message class `BSP_WD` in change mode.
6. Create message `026` with the short text "The system determines a security problem, application has to be closed." and select the "Self-explanatory" checkbox.
7. Save the message class.

#### CRMUIF
1. Repeat the above steps for the CRMUIF component as applicable.

### Prerequisites

- [1130717 - CRM-FRW-UI-RT: Incorrect handling of CX_SY_NOT_IN_DYNPRO_ENVIRONMNT exc.](https://me.sap.com/notes/1130717)
- [1260445 - CRM-FRW-UI-RT: Response display for errors in internal HTTP communication](https://me.sap.com/notes/1260445)
- [1244479 - CA-WUI-UI-RT: CRM WebClient: Runtime related issues](https://me.sap.com/notes/1244479)
- [1456176 - CA-WUI-APF: Time Out/Logon Error Page not displayed in certain languages](https://me.sap.com/notes/1456176)

### CVSS

- **Score:** 0
- **Vector:** Not specified

### Side Effects

**This document is causing side effects:**
- [1720734 - Response registration is missing](https://me.sap.com/notes/1720734)
- [1620007 - Missing response registration](https://me.sap.com/notes/1620007)

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*