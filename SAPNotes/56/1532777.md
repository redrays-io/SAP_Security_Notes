1532777 - Collective Note: ABAP Session Protection Recommendations

---

## Symptom

You want to protect your ABAP system against common session attacks such as session hijacking and session fixation.

## Other Terms

- Session Access Token
- icf/user_recheck
- icf/ssocookie_mandatory
- Security Session Management
- sap-syscmd=nocookie

## Reason and Prerequisites

Previously, the ABAP server performed an access control check only when starting an application. When processing subsequent HTTP requests to stateful applications, only the application session identifier (which can be transmitted in the URL) was validated.

## Solution

1. **Implement [Note 1420203](https://me.sap.com/notes/1420203)** to support applications that require 3rd parties (other HTTP clients) to access stateful HTTP applications, despite the activated session protection mechanisms described in the notes listed below.

2. After applying Note 1420203, apply the appropriate application notes based on your SAP_BASIS component version:

| SAP_BASIS | Recommended      | Alternatively   |
|-----------|------------------|-----------------|
| 6.40      | Note 1266780     | n/a             |
| 7.00      | Note 1266780     | n/a             |
| 7.01      | Note 1277022     | n/a             |
| 7.02      | Note 1322944     | Note 1277022    |
| 7.03      | Note 1322944     | Note 1277022    |
| 7.10      | Note 1277022     | Note 1524152    |
| 7.11      | Note 1277022     | Note 1524152    |
| 7.20      | Note 1322944     | Note 1277022    |
| 7.30      | Note 1322944     | Note 1277022    |

3. **Apply [Note 1531399](https://me.sap.com/notes/1531399)** to enable SSL. This ensures that credentials, session identifiers, and all access-controlled business data are transmitted in encrypted form, preventing eavesdropping attacks.

**Important Remarks**

- The activation of the session protection mechanisms (by setting profile parameters `icf/user_recheck` or `icf/ssocookie_mandatory`, or by activating Security Session Management, if applicable) should always be the last step.
  
- When performing an SAP_BASIS upgrade from 6.40 or 7.00 to 7.01 (or higher), you must repeat the activation of the session protection mechanism as described in [Note 1532874](https://me.sap.com/notes/1532874).

- Prior to activating Security Session Management, apply [Note 1471069](https://me.sap.com/notes/1471069) if you are using a Portal (this is also mentioned in [Note 1322944](https://me.sap.com/notes/1322944)).

---

## References

- [Note 1562004: Option: Issuing assertion tickets without logon tickets](https://me.sap.com/notes/1562004)
- [Note 1532874: Upgrade: Changing the HTTP reauthentication](https://me.sap.com/notes/1532874)
- [Note 1531399: Enabling SSL for Session Protection](https://me.sap.com/notes/1531399)
- [Note 1524152: Correction instructions for Note 1277022](https://me.sap.com/notes/1524152)
- [Note 1521197: Update #1 to Security Note 1517094](https://me.sap.com/notes/1521197)
- [Note 1517094: CRM-IC: Session Access Token](https://me.sap.com/notes/1517094)
- [Note 1512081: CLOCO - GANTT is not displayed II](https://me.sap.com/notes/1512081)
- [Note 1510360: CRM marketing applets: Problems with icf/set_HTTPonly_flag](https://me.sap.com/notes/1510360)
- [Note 1506858: Security updates for Live Auction Cockpit](https://me.sap.com/notes/1506858)
- [Note 1505976: Webdocs: Unauthorized Content Modification & Session Handling](https://me.sap.com/notes/1505976)
- [Note 1457125: Java Applet not working in cFolders](https://me.sap.com/notes/1457125)
- [Note 1420203: Enable foreign access to a stateful HTTP session](https://me.sap.com/notes/1420203)
- [Note 1322944: ABAP: HTTP security session management](https://me.sap.com/notes/1322944)
- [Note 1277022: Security Note: Session Forwarding by URL](https://me.sap.com/notes/1277022)
- [Note 1266780: User check for each HTTP request](https://me.sap.com/notes/1266780)

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*