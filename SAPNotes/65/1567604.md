SAP Security Note 1567604 - Unauthorized modification of displayed content in BSP

**Release Date:** July 12, 2011  
**Type:** SAP Security Note  
**Component:** Basis Components > Middleware > Internet Communication Framework > ICF System Login  
**Priority:** Correction with high priority  
**Status:** Released for Customer

### Description

**Symptom**

A BSP test application can be abused by a malicious user, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

**Other Terms**

Reflected cross-site scripting (XSS), BSP.

**Reason and Prerequisites**

HTTP pages within a BSP test application do not sufficiently encode the HTTP parameters, resulting in a reflected cross-site scripting issue. This vulnerability can be exploited to deface or modify displayed web content temporarily and to steal authentication information, potentially allowing impersonation of users, including administrators.

### Solution

Use the latest SAP BASIS support package or implement the correction instructions manually.

#### Support Package Installation

Apply the appropriate SAPKB support packages based on your SAP_BASIS version:

- **SAP_BASIS 640:** [SAPKB64028](https://me.sap.com/supportpackage/SAPKB64028)
- **SAP_BASIS 700:** [SAPKB70025](https://me.sap.com/supportpackage/SAPKB70025)
- **SAP_BASIS 701:** [SAPKB70110](https://me.sap.com/supportpackage/SAPKB70110)
- **SAP_BASIS 702:** [SAPKB70208](https://me.sap.com/supportpackage/SAPKB70208)
- **SAP_BASIS 710:** [SAPKB71013](https://me.sap.com/supportpackage/SAPKB71013)
- **SAP_BASIS 711:** [SAPKB71107](https://me.sap.com/supportpackage/SAPKB71107)
- **SAP_BASIS 720:** [SAPKB72005](https://me.sap.com/supportpackage/SAPKB72005)
- **SAP_BASIS 730:** [SAPKB73003](https://me.sap.com/supportpackage/SAPKB73003)

#### Manual Activities

1. **Delete ICF Service Entries:**
   - Use transaction **SICF** to delete the following ICF Service entries, including all sub-nodes:
     - `/sap/public/bc/sicf_login_run`
     - `/sap/bc/bsp/sap/sicf_login_test`

2. **Delete BSP Application:**
   - Use transaction **SE80** to delete the BSP application `sicf_login_test`.

3. **Delete ABAP Class:**
   - Use transaction **SE80** to delete the ABAP class `CL_ICF_SYSTEM_LOGIN_TESTER`.
   
   **ATTENTION:**  
   Do **not** delete the ABAP class `CL_ICF_SYSTEM_LOGIN`. This class is essential for system login functionality.

### Download the Security Note

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009297842017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001567604?language=en-US&token=28D55DC58B00A2315557ABF88FD1602E)

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*