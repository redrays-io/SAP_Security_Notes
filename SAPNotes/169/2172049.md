2172049 - Dll Hijacking in SAP Financial Consolidation

**SAP Note Number**: 2172049  
**Type**: SAP Security Note  
**Component**: Enterprise Performance Management > Financial Consolidation (FC) > Technical Components  
**Priority**: Correction with medium priority  
**Status**: Released for Customer  
**Released On**: 13.09.2016  

### Description
An unwanted DLL may be loaded by SAP Financial Consolidation.

SAP Financial Consolidation uses English as the default language and loads the English DLL resource to retrieve default localized strings. The corresponding DLL will be missing if English is not installed.

The product tries to load the missing DLL in all paths configured in the `PATH` environment variable. An attacker with access to one of the referenced paths could replace the existing DLL with a malicious DLL of the same name, which would then be loaded for victim users.

### CVSS Information
**CVSS v3 Base Score**: 4.5/10  
**CVSS v3 Vector**:
- **Attack Vector (AV)**: Local (L)
- **Attack Complexity (AC)**: High (H)
- **Privileges Required (PR)**: Low (L)
- **User Interaction (UI)**: None (N)
- **Scope (S)**: Unchanged (U)
- **Confidentiality Impact (C)**: Low (L)
- **Integrity Impact (I)**: Low (L)
- **Availability Impact (A)**: Low (L)

### Solution
SAP Financial Consolidation has been updated to load the DLL only from the installation folder. The folders referenced in the `PATH` environment variable are now ignored.

### References
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018075292017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002172049?language=en-US&token=C209527833DE7FF3B527643728F65382)

### Affected Software Components
- **FINANCE**: Version 1000

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*