2168485 - XXE Vulnerability in Landscape System Configuration

## Symptom

A malicious user can modify an XML-based request to include XML content that is then parsed locally.  
This could allow a malicious user to perform a denial of service (DoS) on the parsing system, or disclose local data that is then returned in the response to the malicious request, or access further network-located resources that are accessible from the parsing system.

**CVSS Information**  
CVSS Base Score: 4.9 / 10  
CVSS Base Vector:

| **AV**: Access Vector (Related exploit range) | Network (N) |
|---------------------------------------------|-------------|
| **AC**: Access Complexity (Required attack complexity) | Medium (M) |
| **Au**: Authentication (Level of authentication needed to exploit) | Single (S) |
| **C**: Impact to Confidentiality | Partial (P) |
| **I**: Impact to Integrity | None (N) |
| **A**: Impact to Availability | Partial (P) |

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).

## Other Terms

XXE, XML eXternal Entity, information disclosure, denial of service, DoS, EP-PIN-PSL

## Reason and Prerequisites

The problem is caused by a program error in EP-PIN-PSL due to the incorrect use of an XML parser.  
By default, the parser opens external entities referenced within an XML input, which can then lead to malicious content being parsed.  
This malicious content can reference internal resources, such as files.  
These internal resources can be disclosed in the response to the request, or can be used to perform a denial of service attack on the parsing system, rendering application content temporarily unavailable.

## Solution

Refer to the [Support Packages & Patches](https://me.sap.com/servicessupport/knowledge) link to view the versions including the fix.

See the following link for information about providing feedback about this note:  
[Feedback on NetWeaver Enterprise Portal Notes](http://scn.sap.com/community/netweaver-portal/blog/2013/11/24/feedback-on-netweaver-enterprise-portal-notes)

## Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018069982017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002168485?language=en-US&token=FAE240333AFA80B5FCC28C0A9FD3B58B)
- [Share by Email](https://me.sap.com/share-email)
- [Open in New Window](https://me.sap.com/open-new-window)

## Validity

Applicable to the following software components:

- **EP-RUNTIME**: 7.30, 7.31, 7.40, 7.50

## Support Package Patches

- **EP RUNTIME 7.50 SP000 Patch 000000**: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP000&patch_level=000000)
- **EP RUNTIME 7.40 SP009 Patch 000021**: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP009&patch_level=000021)
- **EP RUNTIME 7.40 SP008 Patch 000023**: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP008&patch_level=000023)
- **EP RUNTIME 7.30 SP012 Patch 000020**: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015108&support_package=SP012&patch_level=000020)
- **EP RUNTIME 7.31 SP012 Patch 000031**: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP012&patch_level=000031)
- *(Additional patches can be found in the original support package patch list)*

## References

**This document refers to:**

- [2120111 - Central Note for NetWeaver EP / EPC 7.30 SP14](https://me.sap.com/notes/2120111)

**This document is referenced by:**

- [2215654 - Central Note for NetWeaver 7.31 SP17 Enterprise Portal Core](https://me.sap.com/notes/2215654)
- [2202223 - Central Note: SAP NetWeaver 7.5 SP00 - EP Core (Application Platform)](https://me.sap.com/notes/2202223)
- [2198192 - Collective Note: SAP NetWeaver 7.5 SP00 - Composition Platform](https://me.sap.com/notes/2198192)

## Credits

Credits to [redrays.io](https://redrays.io) for support in providing this information.