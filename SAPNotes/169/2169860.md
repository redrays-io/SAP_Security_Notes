2169860 - Whitelist based Clickjacking Framing Protection in Web Dynpro Java

### Symptom

Web Dynpro Java does not protect its applications against Clickjacking attacks.

### Other Terms

UI redressing attack, Clickjacking, Framing Protection, Framing, IFrame, UI Redressing, Clickjacking Whitelist, X-FRAME-OPTIONS, Web Dynpro Java, NWA, WDJ

### Reason and Prerequisites

Clickjacking is a UI-redressing attack where an attacker tricks a user to click something different than the user is aware of. This attack makes use of standard possibilities in HTML and does not use weaknesses in the code of the application.

Further details can be found at [OWASP Clickjacking](https://www.owasp.org/index.php/Clickjacking)

### Solution

Standard protection measures against Clickjacking (X-FRAME-OPTIONS header) are not suitable for common NetWeaver integration scenarios.

Therefore SAP is providing a whitelist based framework for NetWeaver technologies.

This framework and its implementation are described in [SAP Note 2319727](https://me.sap.com/notes/2319727).

This SAP Note provides the part for Web Dynpro Java (WDJ).

WDJ applications can be protected from the clickjacking vulnerability by following Whitelist enabling for JAVA in [SAP Note 2170590](https://me.sap.com/notes/2170590)

If the "ClickJackingProtection" parameter value was customized before applying the patch from the SAP Note then it is required to manually change the "ClickJackingProtection" parameter value to the default ones i.e. false.

There is another solution to secure the Web Dynpro Java applications from clickjacking vulnerability which is mentioned in the [SAP Note 1781171](https://me.sap.com/notes/1781171).

The solution provided in [SAP Note 1781171](https://me.sap.com/notes/1781171) is purely browser specific and was not allowing to whitelist multiple hosts for framing the WD Java applications. Since the solution from [SAP Note 1781171](https://me.sap.com/notes/1781171) is a browser specific feature, SAP has no control over the attribute “X-Frame-Options” values added in the server response which is used to control the framing of the Web Dynpro Java application.

But the whitelist service solution mentioned in this SAP Note is not browser specific and allows whitelisting of multiple hosts so that Web Dynpro Java can be framed on any whitelisted hosts and SAP has full control over the framing logic.

Either of the solutions could be used but both solutions must not be used together.

We strongly suggest to use the whitelist service solution mentioned in this SAP Note.

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000012867792017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002169860?language=en-US&token=980B8F5FD6CA760EE4E07E9B54F96256)
- [Share by Email](https://me.sap.com/)
- [Open in New Window](https://me.sap.com/)

### Attachments

![ClickJacking Protection configuration for NW 7.1X and above releases](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000870392015&iv_version=0003&iv_guid=51F472B32457EF4CBC1EA300CDF2812B)

### Manual Activities

**Software Component**: WD-RUNTIME Web Dynpro RUNTIME...

**Caution**: You have to perform this manual activity separately in each system into which you transport the Note for implementation.

To enable the service in NW 7.1X and above, follow the steps mentioned below:

1. Login to the NWA application.
2. Navigate to the Configuration tab.
3. Click on Infrastructure tab.
4. Click on Application Modules link.
5. Search for "tc~wd~dispwda" value in the filter for “Name” column of the module list and select the row.
6. Search for "default" value in the filter for Property Sheet Name" column of the Web Dynpro Properties tab and select the row.
7. Search for "ClickJackingProtection" value in the filter for WD Property Sheet Details "Name" column and select the row.
8. Modify the property "ClickJackingProtection" value from "false" to "true".
9. Save the configuration and restart the J2EE engine.

After enabling the parameter, the whitelist host entries can be configured in the application which can be accessed as mentioned below:

1. Login to the NWA application.
2. Navigate to the Configuration tab.
3. Click on Security tab.
4. Click on "ClickJacking Whitelist Configuration" application link.
5. This wizard will allow to create the whitelist entries.

**Software Component**: SAP_JTECHS SAP JAVA TECHNO...

**Caution**: You have to perform this manual activity separately in each system into which you transport the Note for implementation.

To enable the service in NW 7.0X, follow the steps mentioned below:

1. Login to the Visual Admin application by navigating to the path -> \\usr\\sap\\<SID>\\<System Number>\\j2ee\\admin.
2. Navigate to the directory Server X X_XXXX -> Services -> Configuration Adapter -> webdynpro.
3. Search an application under sap.com with the name tc~wd~dispwda.
4. Navigate to the propertysheet Propertysheet default in the edit mode to change the default configuration.
5. Search for the parameter with the name as "ClickJackingProtection".
6. Modify the default value "false" with "true" and save the configuration by entering the value in the custom field of the pop up.
7. After making the changes check the other server nodes also and make the necessary changes in case if it's not reflected.
8. Restart the J2EE server to take the changes into effect.

After enabling the parameter, the whitelist host entries can be configured in the application which can be accessed as mentioned below:

1. Login to the NWA application.
2. Navigate to the Configuration tab.
3. Click on Security tab.
4. Click on "ClickJacking Whitelist Configuration" application link.
5. This wizard will allow to create the whitelist entries.

### Credits

Credits to [Redrays.io](https://redrays.io) for support in providing this information.