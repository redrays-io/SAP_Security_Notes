2174357 - Reflected File Download Vulnerability in KM Documents Servlet

**Symptom**
There is a possibility that the end user is offered to download a non-existing executable file containing malicious code when certain query parameters are specified in the request URL to the KM Documents Servlet. The downloaded file may have an executable extension but is most probably not runnable because of corrupted content.

**CVSS Information**
- **CVSS Base Score:** 5.0 / 10
- **CVSS Base Vector:**
  - **Access Vector (AV):** Network (N)
  - **Access Complexity (AC):** Low (L)
  - **Authentication (Au):** None (N)
  - **Impact to Confidentiality (C):** None (N)
  - **Impact to Integrity (I):** Partial (P)
  - **Impact to Availability (A):** None (N)

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).*

**Reason and Prerequisites**
KM Documents Servlet allows users to specify additional HTTP request parameters. The combination of 'URI' and 'action' parameters may lead to the download of a non-existing file by the end user. The file will be created when the server returns its HTTP response. This behavior of the KM Documents Servlet may be exploited as a Reflected File Download (RFD) vulnerability, and an attacker can try to trigger an RFD attack. The created file cannot be run because its content will be corrupted.

**Solution**
Refer to the ["Support Packages & Patches"](https://me.sap.com/notes/0002174357) link to view the versions including the fix.

**Affected Software Components**
- **KMC-CM**
  - From 7.00 to 7.02
  - 7.30 to 7.30
  - 7.31 to 7.31
  - 7.40 to 7.40
  - 7.50 to 7.50

**Support Package Patches**
- [KMC CONTENT MANAGEMENT 7.40 SP009 Patch 000009](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP009&patch_level=000009)
- [KMC CONTENT MANAGEMENT 7.40 SP012 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP012&patch_level=000000)
- [KMC CONTENT MANAGEMENT 7.50 SP001 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001595&support_package=SP001&patch_level=000000)
- [KMC CONTENT MANAGEMENT 7.40 SP011 Patch 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP011&patch_level=000001)
- [KMC CONTENT MANAGEMENT 7.40 SP010 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP010&patch_level=000003)
- [KMC CONTENT MANAGEMENT 7.30 SP013 Patch 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP013&patch_level=000002)
- [KMC CONTENT MANAGEMENT 7.31 SP014 Patch 000008](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP014&patch_level=000008)
- [KMC CONTENT MANAGEMENT 7.30 SP014 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP014&patch_level=000000)
- [KMC CONTENT MANAGEMENT 7.31 SP015 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP015&patch_level=000003)
- [KMC CONTENT MANAGEMENT 7.02 SP015 Patch 000009](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP015&patch_level=000009)
- [KMC CONTENT MANAGEMENT 7.31 SP016 Patch 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP016&patch_level=000001)
- [KMC CONTENT MANAGEMENT 7.02 SP016 Patch 000007](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP016&patch_level=000007)
- [KMC CONTENT MANAGEMENT 7.01 SP016 Patch 000005](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP016&patch_level=000005)
- [KMC CONTENT MANAGEMENT 7.01 SP017 Patch 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP017&patch_level=000002)
- [KMC CONTENT MANAGEMENT 7.02 SP017 Patch 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP017&patch_level=000002)
- [KMC CONTENT MANAGEMENT 7.31 SP017 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP017&patch_level=000000)
- [KMC CONTENT MANAGEMENT 7.01 SP018 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP018&patch_level=000000)
- [KMC CONTENT MANAGEMENT 7.02 SP018 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP018&patch_level=000000)
- [KMC CONTENT MANAGEMENT 7.00 SP032 Patch 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP032&patch_level=000001)
- [KMC CONTENT MANAGEMENT 7.00 SP033 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP033&patch_level=000000)

**Side Effects**
- This document is causing side effects:
  - [2199306 - Error '404 Not Found' when downloading existing documents](https://me.sap.com/notes/0002199306)

*Credits: [redrays.io](https://redrays.io) for support to provided information.*