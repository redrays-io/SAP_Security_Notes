2169391 - Reflected File Download vulnerability in AFPServlet

**Symptom**

*This note has been updated with new support packages and patches information.*

There is a possibility an end user can be tricked into downloading a non-existing executable file containing malicious code when certain query parameters are specified in the request URL to the AFP Navigation Servlet.

**CVSS Information**

- **CVSS Base Score:** 7.5 / 10
- **Attack Vector:** Network (N)
- **Access Complexity:** Low (L)
- **Authentication:** None (N)
- **Confidentiality Impact:** Partial (P)
- **Integrity Impact:** Partial (P)
- **Availability Impact:** Partial (P)

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/securitynotes).

**Reason and Prerequisites**

AFP Navigation Servlet allows users to specify additional HTTP request parameters. The combination of 'URI' and 'action' parameters may lead to the download of a non-existing file by the end user. The file will be created when the server returns its HTTP response. This behavior of the AFP Navigation Servlet may be exploited as a Reflected File Download (RFD) Vulnerability, and an attacker can try to trigger an RFD attack.

**Solution**

Refer to the [Support Packages & Patches](https://me.sap.com/notes/2169391) link to view the versions that include the fix.

**Available Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018071292017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002169391?language=en-US&token=A259C9C96C024DA21CB454B1D7200B0F)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002169391/E/diff)
- [Share by Email](mailto:)
- [Open in New Window](https://me.sap.com/notes/2169391)
  
**References**

- [2120111 - Central Note for NetWeaver EP / EPC 7.30 SP14](https://me.sap.com/notes/2120111)
- [2116600 - Central Note for Portal Platform in SAP NW7.1 EhP1 SP15](https://me.sap.com/notes/2116600)
- [2110834 - Central Note for Portal Platform in SAP NW7.0 EhP1 SP18](https://me.sap.com/notes/2110834)
- [1743951 - Central Note for Portal Platform in SAP NW7.2 SP9](https://me.sap.com/notes/1743951)

**Support Package Patches**

- [EP RUNTIME 7.20 SP009 Patch 000008](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012953&support_package=SP009&patch_level=000008)
- [EP RUNTIME 7.40 SP009 Patch 000022](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP009&patch_level=000022)
- [EP RUNTIME 7.30 SP012 Patch 000021](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015108&support_package=SP012&patch_level=000021)
- *...and others available in the note.*

For a complete list of support package patches, refer to the [Support Package Patches](https://me.sap.com/notes/2169391) section of the note.

**Additional Information**

- **Released On:** 28.07.2016
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Component:** Enterprise Portal > SAP Enterprise Portal (On Premise) > Navigation > Ajax Framework Page

*Credits to [RedRays](https://redrays.io) for support in providing this information.*