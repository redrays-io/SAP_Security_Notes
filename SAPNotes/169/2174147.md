2174147 - Directory Traversal vulnerability in IS-OIL-PRA-REP-TAX and IS-OIL-PRA-REP-ROY

**Summary**

**Symptom**

IS-OIL-PRA-REP-TAX and IS-OIL-PRA-REP-ROY contain vulnerabilities that allow an attacker to:

- **Read arbitrary files** on the remote server, potentially disclosing confidential information.
- **Write arbitrary files** to the remote server, potentially corrupting data or altering system behavior.

**Other Terms**

- Path traversal
- Backtracking
- Directory climbing

**Reason and Prerequisites**

IS-OIL-PRA-REP-TAX and IS-OIL-PRA-REP-ROY fail to correctly validate the file paths used to reference and write files on the remote server. This allows attackers to manipulate file paths to access or modify unintended files.

**Affected Components**

- **IS-OIL**: Versions 46C, 600, 602, 603
- **IS-PRA**: Versions 604, 605, 606, 616, 617

**Solution**

Code corrections have been implemented and are available in this SAP Note. Specifically, input parameters that could introduce security issues have been commented out and are no longer utilized in the programs.

**Downloads and Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000299122018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002174147?language=en-US&token=5C9B7B7C84221CDF3F3B760999970436)

**Support Packages**

- [SAPKI4C144](https://me.sap.com/supportpackage/SAPKI4C144) for IS-OIL 46C
- [SAPK-60028INISOIL](https://me.sap.com/supportpackage/SAPK-60028INISOIL) for IS-OIL 600
- [SAPK-60218INISOIL](https://me.sap.com/supportpackage/SAPK-60218INISOIL) for IS-OIL 602
- [SAPK-60317INISOIL](https://me.sap.com/supportpackage/SAPK-60317INISOIL) for IS-OIL 603
- [SAPK-60418INISPRA](https://me.sap.com/supportpackage/SAPK-60418INISPRA) for IS-PRA 604
- [SAPK-60517INISPRA](https://me.sap.com/supportpackage/SAPK-60517INISPRA) for IS-PRA 605
- [SAPK-60616INISPRA](https://me.sap.com/supportpackage/SAPK-60616INISPRA) for IS-PRA 606
- [SAPK-61610INISPRA](https://me.sap.com/supportpackage/SAPK-61610INISPRA) for IS-PRA 616
- [SAPK-61710INISPRA](https://me.sap.com/supportpackage/SAPK-61710INISPRA) for IS-PRA 617

**Correction Instructions**

- **IS-PRA**: [Correction Instructions](https://me.sap.com/corrins/0002174147/6572)
- **IS-OIL**: [Correction Instructions](https://me.sap.com/corrins/0002174147/11)

**Preconditions**

Several prerequisite SAP Notes are required for proper implementation. Key prerequisites include:

- [1662299](https://me.sap.com/notes/1662299) - Tax 2.0 WYS & WYC - Short Dump on Download ASCII File
- [2045984](https://me.sap.com/notes/2045984) - Tax 2.0: File access error while report generation
- [2046561](https://me.sap.com/notes/2046561) - Roy 2.0: File access error while report generation
- [2076668](https://me.sap.com/notes/2076668) - Roy 2.0 TXGLO: Wrong structure on GLO2 XML
- [2078639](https://me.sap.com/notes/2078639) - Roy 2.0 TXGLO: Wrong structure on GLO2 XML - 2
- [2179705](https://me.sap.com/notes/2179705) - Roy 2.0 TX: Issues with Texas GLO royalty XML files download

**CVSS**

- **Score**: 0
- **Vector**: Not available

**Rating**

No ratings available at this time.

**Side Effects**

This document does not reference any side effects.

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*