1906927 - Missing authorization check in Accounting BAPIs

**Symptom**

An authenticated user can use functions of Accounting BAPIs to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**

- **CVSS Base Score:** 4.9
- **CVSS Base Vector:** AV:N/AC:M/AU:S/C:P/I:P/A:N

_SAP provides this CVSS Base Score as an estimate of the risk posed by the issue reported in this SAP Note. This estimate does not take into account your own system configuration or operational environment. It is therefore not intended to replace any risk assessments that you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the "FAQs" section at [SAP Security Notes](https://service.sap.com/securitynotes/)._

**Other Terms**

Authorization, authorization check, Accounting BAPIs

**Reason and Prerequisites**

Accounting BAPIs do not contain authorization checks for checking an authenticated user's authorization to access some of their functions. This may result in undesired system behavior.

**Solution**

Implement the attached correction instructions in your system and carry out the described manual steps.

**Correction Instructions**

- **SAP_FIN**
  - [Correction 15841](https://me.sap.com/corrins/0001906927/15841)
- **SAP_APPL**
  - [Correction 1](https://me.sap.com/corrins/0001906927/1)
  - [Correction 2](https://me.sap.com/corrins/0001906927/2)
  - [Correction 3](https://me.sap.com/corrins/0001906927/3)
  - [Correction 4](https://me.sap.com/corrins/0001906927/4)

**Manual Activities**

1. **Technical Prerequisites:**
   - Implement the correction instructions from [SAP Note 1882417](https://me.sap.com/notes/1882417).
   - Install the SACF Workbench from [SAP Note 1908870](https://me.sap.com/notes/1908870).

2. **Manual Pre-Implementation Steps:**
   - Call transaction SE38 and open the program SAPLFACI.
   - In the menu, choose `Goto` -> `Text Elements` -> `Text Symbols` and create the following text symbols:

     | Sym. | Text                 | mLen |
     |------|----------------------|------|
     | 004  | Customers            | 20   |
     | 005  | Vendors              | 20   |
     | 006  | Fixed Assets         | 20   |
     | 007  | G/L Accounts         | 20   |
     | 008  | Material Accounts    | 30   |

   - Implement the attached correction instructions in your system.
   - Once the above steps are completed, use the upload function in transaction SACF_TRANSFER to upload the SACF scenarios from [SAP Note 1923728](https://me.sap.com/notes/1923728).
   - Use transaction SACF to activate the scenarios and configure the authorization checks you want to execute.

**References**

- [1923728 - SACF scenarios for RFC postings in FI](https://me.sap.com/notes/1923728)
- [1908870 - SACF | Workbench for switchable authorization scenarios](https://me.sap.com/notes/1908870)
- [1882417 - External check for Remote Function Call](https://me.sap.com/notes/1882417)

**Side Effects**

- **Causing Side Effects:**
  - None

- **Solving Side Effects:**
  - [2030712 - F5 102 or F5 104 during posting using BAPI with RFC](https://me.sap.com/notes/0002030712)

For more details and support, visit [me.sap.com](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*