SAP Security Note 2880869 - CVE-2020-6184 and CVE-2020-6185: XSS Vulnerabilities in SAP NetWeaver and SAP S/4HANA

**Symptom:**

This SAP security note addresses several vulnerabilities identified in the ABAP Online Community Application of SAP NetWeaver and S/4HANA. The vulnerability details along with their CVE relevant information are outlined below.

**Reflected Cross Site Scripting (CVE-2020-6184):**

Under certain conditions, the ABAP Online Community does not sufficiently encode user-controlled inputs, resulting in a Reflected Cross-Site Scripting (XSS) vulnerability.

- [CVE-2020-6184](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6184)

**CVSS Score:** 6.1  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

**Stored Cross-Site Scripting (CVE-2020-6185):**

Under certain conditions, the ABAP Online Community allows an authenticated attacker to store a malicious payload, resulting in a Stored Cross-Site Scripting (XSS) vulnerability.

- [CVE-2020-6185](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6185)

**CVSS Score:** 5.4  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N

**Impacts of XSS:**

- Non-permanently deface or modify displayed content from a website.
- Steal authentication information of the user, such as data relating to their current session.
- Impersonate the user and access all information with the same rights as the target user.

**Reason and Prerequisites:**

The ABAP Online Community Application, built on UI5 and ABAP Push Channels, is vulnerable to cross-site scripting attacks due to:

- Missing correct escaping and input validation in some cases.
- Inadequate consistency checks of payload and MIME type of payload.

**Solution:**

The SAP Note provides the following corrections for the ABAP Online Community Application:

1. **Escaping Corrections:** Properly escaping inputs to prevent malicious scripts from being executed.
2. **Input Validation:** Validating inputs to prevent external entity (XXE) issues.
3. **MIME Content Checks:** Using a malware scanner to check MIME content. The application uses profile `/SIHTTP/HTTP_UPLOAD` for scanning and requires parameters `CUST_ACTIVE_CONTENT` (value "1") and `CUST_CHECK_MIME_TYPE` (value "1"). These are the SAP-delivered defaults.

**Support Packages:**

Please implement the relevant Support Package mentioned in the SAP Note for your SAP_BASIS version:

- **SAP_BASIS 740:** [SAPKB74024](https://me.sap.com/supportpackage/SAPKB74024)
- **SAP_BASIS 750:** [SAPK-75018INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75018INSAPBASIS)
- **SAP_BASIS 751:** [SAPK-75110INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75110INSAPBASIS)
- **SAP_BASIS 752:** [SAPK-75206INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75206INSAPBASIS)
- **SAP_BASIS 753:** [SAPK-75304INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75304INSAPBASIS)
- **SAP_BASIS 754:** [SAPK-75402INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75402INSAPBASIS)

**Download Links:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000199212020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002880869?language=en-US&token=91EE8033536CDB9273A40855689EAC25)

**Ratings:**

Currently, this document has not been rated.

**Validity:**

Applies to SAP_BASIS versions 740, and 750 to 754.

**Additional Information:**

No side effects are reported for this document.

*Credits to [https://redrays.io](https://redrays.io) for support to provided information.*