2890213 - [CVE-2020-6207] Missing Authentication Check in SAP Solution Manager

---

**Symptom**

*Update 9th March 2021*: This note has been re-released with updated 'Symptom' information. Customers need to be on SAP Solution Manager 7.2 Support Package Stack 4 to 11 to implement the required patch. Lower Support Package Stacks are not supported. Support Package Stack 12 and higher contain the correction, no action is required.

*Update 10th November 2020*: This note has been re-released with updated 'Support Packages & Patches' information. For the release SOLMANDIAG 720, we added SP011 and the Patch level 000004.

*Update 25th August 2020*: This note has been re-released with updated 'Symptom' and 'Solution' information. Minor textual changes were made; no customer action required.

SAP Solution Manager User-Experience Monitoring does not perform any authentication for a service, resulting in the complete compromise of all SMDAgents connected to the Solution Manager.

**CVE**

[CVE-2020-6207](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6207)

**Solution**

This fix enables user authentication on the User-Experience Monitoring administration service and removes the root cause of CVE-2020-6207.

**Prerequisites:**

1. **Single Sign-On Configuration**: Ensure that the Single Sign-On Automatic Activity in SAP Solution Manager Configuration has been executed successfully. This is available in transaction `SOLMAN_SETUP` under *Cross Scenario Configuration > Mandatory Configuration > Infrastructure Preparation: Setup Connectivity > Enable Connectivity*. Applies to all SAP Solution Manager 7.2 support packages.

2. **Enable Maintenance Mode**: Use the Agent Administration UI to enable Maintenance Mode. Refer to the Release Information Note relevant to your SAP Solution Manager 7.2 Support Package stack, as listed in [SAP Note 1595736](https://me.sap.com/notes/1595736).

**Deployment Steps:**

1. Deploy the `LM-SERVICE` Software Component mentioned in the "Support Packages & Patches" section.

**Interim Solution: EemAdmin Authentication**

*Note: This is an interim, temporary quick fix. The complete code-based solution should be implemented as described above.*

1. Log on to SAP NetWeaver Administration on the SAP Solution Manager Java Stack with the SAP J2EE Admin user.
2. Navigate to `Configuration > Infrastructure > Connectivity > Single Service Administration > Service Definitions`.
3. Search for the WSDL port Type named `EemAdmin` and press 'Go'.
4. Select it and display its configuration details in the 'Details' tab.
5. In the 'Security' tab of the `EemAdminBeanPort`, enable the following options in the HTTP Authentication section:
    - [x] User ID/Password
    - [ ] X.509 Client Certificate
    - [x] Logon Ticket
6. Save the settings. No restart is required.

**Download and Documentation**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000376922020)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002890213?language=en-US&token=7BE6744E859F38D192AC0EE32A3D73CD)

**CVSS**

- **Score:** 10.0
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**References**

This document is referenced by:

- [2978778 - LM-SERVICE 7.20 SP 11 Patch 4](https://me.sap.com/notes/2978778)
- [2898961 - LM-SERVICE 7.20 SP 8 Patch 16](https://me.sap.com/notes/2898961)
- [2898904 - LM-SERVICE 7.20 SP 9 Patch 8](https://me.sap.com/notes/2898904)

**Credits**

Thanks to [RedRays](https://redrays.io) for support in providing this information.