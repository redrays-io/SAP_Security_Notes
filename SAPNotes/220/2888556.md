SAP Security Note 2888556: Missing Authorization Check in SAP Commerce [CVE-2020-6232]

**Overview**
SAP has released Security Note [2888556](https://me.sap.com/notes/2888556) addressing a critical vulnerability in SAP Commerce. This vulnerability, identified as [CVE-2020-6232](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6232), involves a missing authorization check that allows authenticated users to escalate privileges, potentially accessing secure media.

**Affected Versions**
- **SAP Commerce Cloud Patch Release 1811.19**: [PATCH-6986](https://jira.hybris.com/browse/PATCH-6986)
- **SAP Commerce Cloud Patch Release 1905.11**: [PATCH-6987](https://jira.hybris.com/browse/PATCH-6987)

**CVSS Details**
- **Score**: 5.3
- **Vector**: [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

**Symptoms**
SAP Commerce Secure Media fails to perform necessary authorization checks for authenticated users, leading to privilege escalation and potential unauthorized access to secure media. This issue affects installations initialized with versions 1811 or 1905.

**Solution**
SAP has provided patches for the affected versions. Applying these patches is crucial to mitigate the vulnerability.

1. **Download and Apply Patch**
   - [SAP Commerce Cloud Patch Release 1811.19](https://jira.hybris.com/browse/PATCH-6986)
   - [SAP Commerce Cloud Patch Release 1905.11](https://jira.hybris.com/browse/PATCH-6987)

2. **Manual Correction Steps for Existing Installations**
   - **Remove READ Permissions in Backoffice Administration Cockpit**
     1. Sign into the Backoffice Administration Cockpit as the admin user.
     2. Navigate to **User > User Groups**.
     3. Search and select the `customergroup` user group.
     4. Click on **Principal Permission Action** to open the Permission Manager.
     5. Locate the `Item` item type and remove `READ` permission.
   
   - **Remove READ Permissions by ImpEx**
     - Import the following ImpEx script via the Administration Cockpit:
       ```plaintext
       INSERT_UPDATE UserGroup;UID[unique=true];
       ;customergroup;

       $START_USERRIGHTS;;;;;;;;;
       Type;UID;MemberOfGroups;Password;Target;read;change;create;remove;change_perm
       UserGroup;customergroup;;;;;;
       ;;;;Item;;;;;;
       $END_USERRIGHTS;;;;;
       ```
   
   - **Run System Update After Patch Installation**
     - Execute the command `ant updatesystem` to apply essential data from the patch.

**Important Notes**
- **System Update Warning**: Running `ant updatesystem` may override customized settings not stored in ImpEx files.
- **Impact on Headless CMS Storefronts**: Removing `READ` permissions can affect storefronts like Spartacus. Ensure `customergroup` has `READ` permissions for any customized item types to maintain functionality.

**Additional Resources**
- [Software Downloads for SAP Commerce](https://me.sap.com/software-downloads)
- [About Patch Releases](https://help.sap.com/viewer/dc198ac31ba24dce96149c8480be955f/6.7.0.0/en-US/8c25978386691014b4abdd61376acd24.html#loio8c25978386691014b4abdd61376acd24)

**Credits**
Thanks to [RedRays](https://redrays.io) for supporting the provision of this information.