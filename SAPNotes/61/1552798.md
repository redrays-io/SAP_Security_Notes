Directory Traversal Vulnerability in SAP EH&S (Note 1552798)

**Summary**

A directory traversal vulnerability has been identified in SAP Environment, Health, and Safety (EH&S). This vulnerability allows a malicious user to write arbitrary files on the remote server, potentially leading to data corruption or alteration of system behavior.

**Details**

- **SAP Note Number:** 1552798
- **Title:** Directory Traversal in EH&S
- **Release Date:** October 11, 2011
- **Type:** SAP Security Note
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Component:** Environment, Health, and Safety / Product Compliance > Basic Data and Tools (EHS-BD)

**Symptoms**

- Implementation of [SAP Note 1505368: EHS - Potential Directory Traversal](https://me.sap.com/notes/1505368) (EHS: Potential Directory Traversal).
- Importing inbound documents using transaction **CG36** terminates with the error:
  ```
  Internal program error; (RC1IMPPG SAPLC13Z 1 C13Z_RAWDATA_WRITE) (C$ 153)
  ```

**Cause**

EH&S exhibits an error when checking the file storage path, allowing a malicious user to overwrite data on the remote system.

**Affected Software Components**

- **EA-APPL Versions:** 110, 200, 500, 600, 602, 603, 604, 605
- **EHS Version:** 0207B0406C

**References**

- [SAP Note 1505368: EHS - Potential Directory Traversal](https://me.sap.com/notes/1505368)
- [SAP Note 1540408: Update #1 for security Note 1505368](https://me.sap.com/notes/1540408)

**Solution**

To address this vulnerability, apply the relevant support packages listed below or follow the provided correction instructions.

**Support Packages**

- **EHS 0207B0406C:** [SAPKIPEI18](https://me.sap.com/supportpackage/SAPKIPEI18)
- **EA-APPL 110:** [SAPKGPAA32](https://me.sap.com/supportpackage/SAPKGPAA32)
- **EA-APPL 200:** [SAPKGPAB21](https://me.sap.com/supportpackage/SAPKGPAB21)
- **EA-APPL 500:** [SAPKGPAC25](https://me.sap.com/supportpackage/SAPKGPAC25)
- **EA-APPL 600:** [SAPKGPAD20](https://me.sap.com/supportpackage/SAPKGPAD20)
- **EA-APPL 602:** [SAPK-60210INEAAPPL](https://me.sap.com/supportpackage/SAPK-60210INEAAPPL)
- **EA-APPL 603:** [SAPK-60309INEAAPPL](https://me.sap.com/supportpackage/SAPK-60309INEAAPPL)
- **EA-APPL 604:** [SAPK-60410INEAAPPL](https://me.sap.com/supportpackage/SAPK-60410INEAAPPL)
- **EA-APPL 605:** 
  - [SAPK-60504INEAAPPL](https://me.sap.com/supportpackage/SAPK-60504INEAAPPL)
  - [SAPK-60505INEAAPPL](https://me.sap.com/supportpackage/SAPK-60505INEAAPPL)

Alternatively, you can implement the attached correction instructions: [Correction Instructions](https://me.sap.com/corrins/0001552798/23)

**Additional Information**

- **Transaction Codes:** CG02, SPRO, CG42, CG12, CG33, CG34, CG35, CG31, CG32, CG36, CG3Z, CG3Y

**Credits**

Credits to [redrays.io](https://redrays.io) for support to provided information.