SAP Security Note 1551982 - Cross-site request forgery protection for stateless

**SAP Security Note 1551982 - Cross-site request forgery protection for stateless**

---

**Header Data**
- **SAP Note/KBA:** 1551982
- **Type:** SAP Security Note
- **Version:** 10
- **Recency:** Updated
- **Language:** English
- **Master Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Release Status:** Released for Customer
- **Released On:** 02.03.2012
- **Component:** Business Server Pages (BC-BSP)

**Title**
- *1551982 - Cross-site request forgery protection for stateless*

**Description**

### Symptom
This security note has been updated. For more detailed information, see [Security Note 1670352](https://me.sap.com/notes/1670352).

The correction within this note only provides a framework for the XSRF protection. To secure a specific application, configuration and sometimes adaptation effort are required. For applications delivered by SAP, check for corresponding notes that will set XSRF protection accordingly. If you would like to protect your own custom application, please follow the detailed instructions described in [Note 1458171](https://me.sap.com/notes/1458171). Activation of protection for a stateless BSP and a stateful BSP is performed via the same configuration and adaptation steps.

### Other Terms
- CSRF, XSRF

### Reason and Prerequisites
*Not specified in detail.*

### Solution
The XSRF generic protection of BSP is based on the secure token method.

**Important for System 620:**
- Ensure your system has at least Kernel 640 PL 325 according to [Note 1410294](https://me.sap.com/notes/1410294).
- Perform manual steps for SPs lower than SP71:
  1. **Transaction SE16**
     - Enter `RSECACHK` for Table Name.
     - Press 'Create Entries' (F5).
     - Insert `KRN/SNT/SNTXXHMAC` for PROGNAME and `2B5E0AB3E6C75C4CDF7556BC8FF2DFBC` for CHSUM.
     - Save.
  2. **Transaction SE16**
     - Enter `RSECACHK` for Table Name.
     - Press 'Table Contents' (F7).
     - Mark the entry `KRN/SNT/SNTXXHMAC`.
     - In the menu, go to 'Table Entry' â†’ 'Transport Entries'.
     - Insert the transport you opened for these changes.

*Note:* The prerequisites mentioned under SP Patch Level are only relevant for release 7.31.

**Attachments**
- [Add_Type_Group_ABAP.PDF](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000074692011&iv_version=0010&iv_guid=3B7E98CFF8C27C4DB2029FBE27CE1D2A) (103 KB)

**References**
- [1666244 - cFolders: Composite SAP Note - Security](https://me.sap.com/notes/1666244)
- [1658828 - Call of ROS questionnaire fails with "message type unknown"](https://me.sap.com/notes/1658828)
- [1658516 - Applets fail due to XSRF protection (COOKIE_NOT_FOUND)](https://me.sap.com/notes/1658516)
- [1647006 - Survey: "CALLED_BY_PUBLIC_SERVICE" in BSP application](https://me.sap.com/notes/1647006)
- [1624909 - Unauthorized use of application functions in BW-BCT-CRM-RTOM](https://me.sap.com/notes/1624909)
- [1618640 - Unauthorized use of application functions in CRM-ISE-WBF](https://me.sap.com/notes/1618640)
- [1590175 - Unauthorized use of application functions in CRM-MKT-DAM](https://me.sap.com/notes/1590175)
- [1587581 - Unauthorized use of application functions in workflow (BSP)](https://me.sap.com/notes/1587581)
- [1560585 - SAP Gateway 2.0 Release Note](https://me.sap.com/notes/1560585)

**Validity**
- **SAP_BASIS**: 
  - From 620 to 640
  - 700 to 702
  - 710 to 730
  - 731 to 731

**Support Package**
- [SAPKB62071](https://me.sap.com/supportpackage/SAPKB62071)
- [SAPKB64029](https://me.sap.com/supportpackage/SAPKB64029)
- [SAPKB70026](https://me.sap.com/supportpackage/SAPKB70026)
- [SAPKB70110](https://me.sap.com/supportpackage/SAPKB70110)
- [SAPKB70111](https://me.sap.com/supportpackage/SAPKB70111)
- [SAPKB70209](https://me.sap.com/supportpackage/SAPKB70209)
- [SAPKB71013](https://me.sap.com/supportpackage/SAPKB71013)
- [SAPKB71108](https://me.sap.com/supportpackage/SAPKB71108)
- [SAPKB72006](https://me.sap.com/supportpackage/SAPKB72006)
- [SAPKB73005](https://me.sap.com/supportpackage/SAPKB73005)
- [SAPKB73004](https://me.sap.com/supportpackage/SAPKB73004)
- [SAPKB73101](https://me.sap.com/supportpackage/SAPKB73101)

**Correction Instructions**
- **SAP_BASIS**: 21 Correction Instructions ([Details](https://me.sap.com/corrins/0001551982/41))

**Manual Activities**
1 Manual Activity ([Details](https://me.sap.com/corrins/0001551982/41))

**Preconditions**
- Various prerequisites across different SAP_BASIS releases. Refer to the [Prerequisites section](https://me.sap.com/notes/1551982) for detailed information.

**Side Effects**
- **Solving Side Effects:** None.
- **Causing Side Effects:**
  - [1658516 - Applets fail due to XSRF protection (COOKIE_NOT_FOUND)](https://me.sap.com/notes/1658516)

For more detailed information, visit the [SAP Security Notes](https://me.sap.com/notes/1551982).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*