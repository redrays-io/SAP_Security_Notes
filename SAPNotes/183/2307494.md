SAP Security Note 2307494: Missing Authorization Check in TREX ABAP+JAVA API

**SAP Security Note 2307494** addresses a critical issue where the TREX Function Module fails to perform necessary authorization checks for authenticated users, potentially allowing privilege escalation. This vulnerability affects SAP_BASIS releases 700, 701, and 702.

### **Symptom**
The TREX Function Module does not enforce proper authorization checks, which can lead to:
- Abuse of functionalities restricted to specific user groups.
- Unauthorized read, modification, or deletion of restricted data.

**Impact:** While this Function Module primarily deletes TREX trace data without affecting business or system data, the lack of authorization checks poses a security risk.

### **CVSS Information**
- **Base Score:** 4.4 / 10
- **Vector:**
  - **Attack Vector (AV):** Local (L)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

*Note: CVSS scores are estimates and should be evaluated within your specific environment.*

### **Reason and Prerequisites**
The vulnerability arises due to a missing authorization check in the `TREX_INT_DELETE_ABAP_TRACE` function for SAP_BASIS releases 700, 701, and 702. This issue has been resolved in newer SAP_BASIS releases where the Function Module is no longer implemented.

### **Solution**
To mitigate this vulnerability:
1. **Implement Correction Instructions:**
   - Apply the correction instructions provided in the security note to enforce proper access restrictions.
2. **Upgrade if Possible:**
   - Consider upgrading to a newer SAP_BASIS release where the affected Function Module is not present.

**No adverse impact on existing functionalities is expected after applying the security measures.**

### **Download and Additional Resources**
- [Download for SNOTE](https://me.sap.com/support/note/0040000013633572017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002307494?language=en-US&token=7AB93A6A2B86A9A32AE1D1D75EE8DCA0)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002307494)
- [Correction Instructions](https://me.sap.com/corrins/0002307494/41)

### **Validity**
- **Software Components:** SAP_BASIS
- **Affected Versions:** 700 to 702

### **Support Packages**
- **SAP_BASIS 700:** [SAPKB70034](https://me.sap.com/supportpackage/SAPKB70034)
- **SAP_BASIS 701:** [SAPKB70119](https://me.sap.com/supportpackage/SAPKB70119)
- **SAP_BASIS 702:** [SAPKB70219](https://me.sap.com/supportpackage/SAPKB70219)

For more detailed information, visit the [SAP Security Notes](https://me.sap.com/securitynotes) page.

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*