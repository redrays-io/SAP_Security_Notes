2303421 - Switchable authorization checks for RFC in Loyalty Management (CRM-LOY)

**SAP Note Number:** 2303421

**Title:** Switchable authorization checks for RFC in Loyalty Management (CRM-LOY)

**Type:** SAP Security Note

**Version:** 2

**Recency:** New

**Language:** English

**Category:** Program error

**Priority:** Correction with medium priority

**Status:** Released for Customer

**Released On:** 11.10.2016

**Component:** CRM-LOY (Loyalty)

### Description

This SAP note introduces new switchable authorization checks for RFC function modules in Loyalty Management (CRM-LOY). Remote calls to RFC function modules are secured by checks on the authorization object `S_RFC`, which should be limited to the minimum required authorizations to ensure system security. However, it was identified that `S_RFC` authorization checks alone might not suffice for secure execution of certain RFC function modules in this component. Therefore, new switchable authorization checks have been implemented and can be activated to enhance security.

### Solution

New switchable authorization checks have been delivered inactive to maintain compatibility with existing processes. To implement the security enhancements, follow these steps:

1. **Implementing the Switchable Authorization Check:**
    - Activate the new authorization checks in transaction **SACF** as per the attached manual correction instructions.
    - Refer to SAP Note [1922808](https://me.sap.com/notes/1922808) for additional information on the switchable authorization check framework (SACF).

2. **Manual Post-Implementation Activities:**
    - **Step 1:** 
        - Open transaction **SACF** and verify if the scenario definition "CRM_LOY" exists.
        - If it doesn't exist, download the file [CRM_LOY.TXT](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000431252016&iv_version=0002&iv_guid=6CAE8B27FF0B1ED683A1CFE28A34C3B9) and upload it via transaction **SACF_TRANSFER**.
    - **Step 2:**
        - Create a productive authorization scenario from the scenario definition in **SACF**.
        - Choose the initial scenario status as "Active" or "Logging" based on your requirements.
    - **Step 3:**
        - Activate logging of SACF relevant audit messages in the Security Audit Log using transaction **SM19**.
        - Ensure message IDs **DUO**, **DUP**, and **DUQ** are activated.
    - **Step 4:**
        - Adjust user roles to provide necessary authorizations based on the new authorization scenario.
        - Use report **RSAU_SELECT_EVENTS** to identify and analyze users requiring additional authorizations.

### Affected RFC Function Modules

| Scenario | Function Module                  | Auth. Object | Param1      |
|----------|----------------------------------|--------------|-------------|
| CRM_LOY  | CRM_MKTPL_LOY_PROGRAM_READ_RFC    | CRM_LOY      | ACTVT=03    |

### Support Packages

Ensure the following support packages are applied to your system:

| Software Component Version | Support Package       | URL                                             |
|----------------------------|-----------------------|-------------------------------------------------|
| BBPCRM 700                 | [SAPKU70018](https://me.sap.com/supportpackage/SAPKU70018) | [Link](https://me.sap.com/supportpackage/SAPKU70018) |
| BBPCRM 701                 | [SAPKU70115](https://me.sap.com/supportpackage/SAPKU70115) | [Link](https://me.sap.com/supportpackage/SAPKU70115) |
| BBPCRM 702                 | [SAPKU70217](https://me.sap.com/supportpackage/SAPKU70217) | [Link](https://me.sap.com/supportpackage/SAPKU70217) |
| BBPCRM 712                 | [SAPKU71210](https://me.sap.com/supportpackage/SAPKU71210) | [Link](https://me.sap.com/supportpackage/SAPKU71210) |
| BBPCRM 713                 | [SAPKU71312](https://me.sap.com/supportpackage/SAPKU71312) | [Link](https://me.sap.com/supportpackage/SAPKU71312) |
| BBPCRM 714                 | [SAPK-71403INBBPCRM](https://me.sap.com/supportpackage/SAPK-71403INBBPCRM) | [Link](https://me.sap.com/supportpackage/SAPK-71403INBBPCRM) |

### Attachments

- [CRM_LOY.TXT](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000431252016&iv_version=0002&iv_guid=6CAE8B27FF0B1ED683A1CFE28A34C3B9)

### Prerequisites

Ensure the following SAP Notes are applied prior to implementing this note:

- [2236076](https://me.sap.com/notes/2236076) Architectural change to avoid syntax errors when calling `CL_RFC=>CHECK_EXTERNAL` and `CL_SACF=>AUTH_CHECK_SPEC` (Component: CRM-BTX)
- [2303421](https://me.sap.com/notes/2303421) Switchable authorization checks for RFC in Loyalty Management (CRM-LOY) (Component: CRM-LOY)
- [2261048](https://me.sap.com/notes/2261048) Removing RFC flag (Component: CRM-LOY)

### CVSS

This note does not have an associated CVSS score.

### Rating

This document currently has no ratings. Feel free to share your experience after implementation.

### Side Effects

- **Solves:** No documented side effects.
- **Causes:** No documented side effects.

For more detailed information, refer to the full SAP Note [2303421](https://me.sap.com/notes/2303421).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*