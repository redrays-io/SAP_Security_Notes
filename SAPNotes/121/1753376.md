1753376 - SAML 2.0: possible XML Signature wrapping attack

**Description**

**Symptom**

Messages sent and received by the SAML 2.0 Service Provider can be manipulated by a malicious user to allow them to perform unauthorized actions on behalf of another user, thereby generally circumventing the integrity protection provided by the service.

**Reason and Prerequisites**

The SAML 2.0 Service Provider implementation contains a vulnerability in the manner in which XML signatures are used to certify security assertions. This issue affects multiple vendors of SAML 2.0 implementations and is not SAP specific. A malicious user can intercept or issue one signed assertion and use an XML signature wrapping attack to gain higher privileges or impersonate another user. This means that there is a risk of information disclosure, data tampering, and system unavailability as a result of this vulnerability.

**Solution**

Apply the patches in the note according to the used version and Service Pack level.

**Affected Software Components**

- **SECURITY-EXT 7.20** to **7.20**
- **SECURITY-EXT 7.30** to **7.30**
- **SECURITY-EXT 7.31** to **7.31**

**Support Package Patches**

- [SECURITY EXTENSIONS 7.20 SP004 Patch Level 000002](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200013763&support_package=SP004&patch_level=000002)
- [SECURITY EXTENSIONS 7.30 SP004 Patch Level 000002](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014998&support_package=SP004&patch_level=000002)
- [SECURITY EXTENSIONS 7.31 SP004 Patch Level 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017689&support_package=SP004&patch_level=000001)
- [SECURITY EXTENSIONS 7.20 SP003 Patch Level 000003](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200013763&support_package=SP003&patch_level=000003)
- [SECURITY EXTENSIONS 7.30 SP003 Patch Level 000003](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014998&support_package=SP003&patch_level=000003)
- [SECURITY EXTENSIONS 7.31 SP003 Patch Level 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017689&support_package=SP003&patch_level=000001)
- *(Additional patches available in the support note)*

**Downloads**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017487022017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001753376?language=en-US&token=3B09C5ADB64193151F2A130F7630729C)

**Credits**

Credits to [Redrays](https://redrays.io) for support to provided information.