1752717 - Unauthorized usage of application functionality in MFG-LPO

**SAP Security Note 1752717 Overview**

**Vulnerability**:  
An attacker can execute functions in MFG-LPO without proper authentication and authorization, exploiting Cross-Site Request Forgery (CSRF/XSRF) vulnerabilities.

**Affected Component**:  
- **Software Component**: SAP Lean Planning and Operation (MFG-LPO)  
- **Version**: 5.60

**Impact**:  
Unauthorized and unauthenticated third parties can trigger state-changing functionalities on behalf of authorized users without their knowledge or consent.

**Solution**:  
Implement the XSRF Protection Framework provided by SAP NetWeaver Application Server Java (AS Java). Follow these steps to secure your web application:

1. **Prerequisite**:  
   - Apply [SAP Note 1450166](https://me.sap.com/notes/1450166) to ensure the availability of the XSRF Protection Framework.

2. **Manual Activities**:
   - **Configuration**:
     - Copy the `xsrf-config.xml` file attached to this note into the `/WEB-INF` directory of your application.
   - **Update JSP Files**:
     - Replace the existing JSP files with the ones provided in the [XSRF_JSP_FILES.zip](https://me.sap.com/notes/1752717/XSRF_JSP_FILES.zip).
     - Ensure that state-critical actions have tokens attached either as URL parameters or hidden form fields.
     - **Affected SAP Delivered JSP Pages in LPO**:
       - Example: `kanban/capacity/CapacityAdjustMessage.jsp`, `admin/UserList.jsp`, etc. *(Full list available in the note)*
   - **Customization**:
     - If your JSP pages have been customized, manually integrate the token mechanism to avoid losing changes during the replacement.
     - For any additional custom pages with state-changing actions, ensure XSRF protection by:
       - Configuring the actions in `xsrf-config.xml`.
       - Including tokens in URL parameters or hidden form fields as per the [Protection Guide](https://me.sap.com/notes/1450166).

3. **Download Attachments**:
   - [XSRF_JSP_FILES.zip](https://me.sap.com/notes/1752717/XSRF_JSP_FILES.zip)
   - [xsrf-config.zip](https://me.sap.com/notes/1752717/xsrf-config.zip)

**Support Package Patch**:  
- **Version**: XLPO 5.60  
- **Support Package**: SP001 Patch Level 000000  
- [Download Patch](https://me.sap.com/notes/1752717/support-package)

**References**:  
- [SAP Note 1450166 - Unauthorized usage of application functionality](https://me.sap.com/notes/1450166)

**Additional Information**:  
Implementing this security measure is crucial to protect against CSRF/XSRF attacks and ensure the integrity of your SAP Lean Planning and Operation (MFG-LPO) system.

---

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*