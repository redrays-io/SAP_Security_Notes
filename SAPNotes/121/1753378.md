1753378 - Directory traversal in Web Container

## Description

**UPDATE March 8, 2022**: This note has been re-released with updated 'Solution' Information. We have added the details about the property 'DirectoryStructureProtection' of HTTP Provider serviceÂ and steps to change its values.

Potential directory traversal in the Web Container.

### Other Terms
Directory traversal, WebContainer

### Reason and Prerequisites
The programs specified in the correction instructions contain vulnerabilities through which an attacker can potentially read arbitrary files under one specific directory on the remote server, possibly disclosing confidential information.

## Solution

I. **Update your AS Java to a fixed version and SP.** For more details see the "SP Patch Level" section of this note.

II. **Change the value of the property `DirectoryStructureProtection` of the HTTP Provider service (http) to `true` by following the steps:**

### For SAP NetWeaver 7.10 and up
1. Open Configtool.
2. Choose **View** -> **Expert mode** should be checked.
3. Navigate to **Template** -> **instance** -> **services** -> **http**.
4. Choose the `DirectoryStructureProtection` property.
5. In the Value field type **true**.
6. Click **Set Custom Value** button.
7. Press the **Save** button (diskette icon) in the top-left corner.
8. Restart the server nodes for changes to take effect.

### For lower versions:
1. Open Configtool.
2. Go to **cluster-data** -> **Global server configuration** -> **services** -> **http**.
3. Choose the `DirectoryStructureProtection` property.
4. In the Value field type **true**.
5. Press the **Set** button in the top-right corner.
6. Press the **Save** button (diskette icon) in the top-left corner.
7. Confirm all popups.
8. Restart the server nodes for changes to take effect.

## CVSS

- **Score:** 5.3
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

### Breakdown:
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** None (N)
- **Availability Impact (A):** None (N)

## Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017487032017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001753378?language=en-US&token=C150474A2BBE72E27E18ECF6DE056C5A)
- [Share by Email](https://me.sap.com/)
- [Open in New Window](https://me.sap.com/)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001753378/E/diff)

## Attributes

- **Externally Reported:** Yes

## Validity

Applicable to the following software components:

- **SAP-JEE:** 6.40
- **SAP-JEECOR:** 6.40, 7.00, 7.01 - 7.02
- **SERVERCORE:** 7.10 - 7.31

For detailed support package patches, please refer to the [Support Package Patches](https://me.sap.com/) section.

---

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*