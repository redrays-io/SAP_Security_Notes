1760776 - Directory traversal in PY-NL-RP, PA-PA-NL and PA-PF-NL

**Description**

This SAP Security Note addresses a directory traversal vulnerability in the following components:
- PY-NL-RP
- PA-PA-NL
- PA-PF-NL

An attacker can exploit this vulnerability to write arbitrary files to the remote server, potentially corrupting data or altering system behavior.

**Affected Components**
- **Personnel Management > Pension Schemes > Pension Fund Netherlands (PA-PF-NL)**
- **Personnel Management > Personnel Administration > Netherlands (PA-PA-NL)**

**Solution**

To mitigate this vulnerability, apply the correction instructions provided in this note. This involves updating the relevant software components and performing manual activities as outlined below.

**Download Options**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011934982017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001760776?language=en-US&token=FA5A685203233B56240976A0BCC877C4)

**Support Packages**

Ensure that you have the following support packages installed for the respective software components:

- **SAP_HR 45B**
  - [SAPKE45BF5](https://me.sap.com/supportpackage/SAPKE45BF5)
  
- **SAP_HR 46B**
  - [SAPKE46BE1](https://me.sap.com/supportpackage/SAPKE46BE1)
  
- **SAP_HR 46C**
  - [SAPKE46CJ5](https://me.sap.com/supportpackage/SAPKE46CJ5)
  
- **SAP_HRCNL 470**
  - [SAPK-470E0INSAPHRCNL](https://me.sap.com/supportpackage/SAPK-470E0INSAPHRCNL)
  
- **SAP_HRCNL 500**
  - [SAPK-500A6INSAPHRCNL](https://me.sap.com/supportpackage/SAPK-500A6INSAPHRCNL)
  
- **SAP_HRCNL 600**
  - [SAPK-60089INSAPHRCNL](https://me.sap.com/supportpackage/SAPK-60089INSAPHRCNL)
  
- **SAP_HRCNL 604**
  - [SAPK-60455INSAPHRCNL](https://me.sap.com/supportpackage/SAPK-60455INSAPHRCNL)

**Correction Instructions**

Apply the following correction instructions based on your software component:

- **SAP_HRCNL**
  - [Correction Instruction 5359](https://me.sap.com/corrins/0001760776/5359)
  
- **SAP_HR**
  - [Correction Instruction 2](https://me.sap.com/corrins/0001760776/2)

**Manual Activities**

1. **Pre-Implement Activities for SAP_HRCNL:**
   - Create message `HRPANL_EN 511` using Transaction SE91.
   - Enter the message short text: "This report is no longer used" and mark it as self-explanatory.
   
2. **Pre-Implement Activities for SAP_HR:**
   - Follow similar steps to create and configure necessary messages.
   
3. **Post-Implement Activities for SAP_HRCNL:**
   - Ensure the creation of message `HRPANL_EN 511` as described above.
   - Adjust file name validations using Transaction SM31 for logical filenames related to Dutch Wage Return and First Day Announcement functionalities.

**Prerequisites**

Ensure that the following SAP Notes are applied:
- [1683502 - Aangifte LH: Short Dump due to long file names (RPCLAKN0)](https://me.sap.com/notes/1683502)
- [1777840 - Aangifte LH: Automatic processing or response messages](https://me.sap.com/notes/1777840)

**References**

- This document is referenced by [2666805 - PY-NL: Deactivation of Obsolete Reports](https://me.sap.com/notes/2666805)

**Side Effects**

No side effects are reported for this security note.

---

*Credits to [Redrays](https://redrays.io) for supporting the provision of this information.*