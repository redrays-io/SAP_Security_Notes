3158375 - [CVE-2022-27668] Improper Access Control of SAProuter for SAP NetWeaver and ABAP Platform

**Symptom**

Depending on the configuration of the route permission table in the `saprouttab` file, it is possible for an unauthenticated attacker to execute SAProuter administration commands in SAP NetWeaver and ABAP Platform from a remote client. For example, an attacker could stop the SAProuter, which could severely impact system availability.

**Other Terms**

[CVE-2022-27668](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27668)

**Reason and Prerequisites**

SAProuter is designed to restrict administration commands to clients that run on the same host as SAProuter. However, this restriction can be bypassed if a `saprouttab` entry of type "P" or "S" exists with:

- A wildcard (`*`) for the target host, and
- Either a wildcard for the target port or the target port set to SAProuter's own port number (3299 by default).

SAProuter configurations that do not use wildcards for the target host are not affected by this vulnerability.

**Solution**

***Correction***

The correction is contained in SAProuter and is delivered in the following components on the [SAP Service Marketplace](https://me.sap.com/):

- **SAPROUTER** versions 7.53 and 7.22
- **Package `saprouter.sar`** in the SAP KERNEL versions 7.85, 7.81, and 7.77.

It is recommended to use SAPROUTER version 7.53. For more details, refer to [SAP Note 1897597](https://me.sap.com/notes/1897597).

The correction will be included in future versions of the SP stack kernel `SAPEXE.SAR`, but it will not be available in all versions when this SAP note is published.

For instructions on how to download and install kernel patches, see [SAP Note 19466](https://me.sap.com/notes/19466).

***Workaround***

As a temporary fix, replace all wildcards for the target host in `saprouttab` 'P' and 'S' entries with specific hostnames or IP addresses. Assess the applicability of this workaround for your SAP landscape before implementation.

**CVSS**

- **Score:** 8.6
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H](https://nvd.nist.gov/vuln-metrics/cvss?vector=CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H)

**References**

- [1897597 - SAProuter: Release rollout](https://me.sap.com/notes/1897597)
- [1895350 - Secure configuration of SAProuter](https://me.sap.com/notes/1895350)

**Credits**

Thanks to [RedRays](https://redrays.io) for supporting the provision of this information.