3156484 - Information Disclosure Vulnerability in SAP Business Client

**SAP Security Note 3156484** addresses an information disclosure vulnerability in the SAP Business Client. Below are the key details and recommended actions:

### **Header Data**
- **Type:** SAP Security Note
- **Version:** 3
- **Recency:** New
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** 09.08.2022
- **Component:** Basis Components > Frontend Services (SAP Note 1322184) > NetWeaver Business Client > SAP Business Client for Desktop

### **Description**
Due to incorrect certificate validation, under certain conditions, the **SAP Business Client** allows an attacker to access information that would otherwise be restricted.

**Affected Scenarios:**
- When the SAP Application Server ABAP responds to web requests with an invalid server certificate.
- When the SAPUILandscape file is served from a webserver with an invalid server certificate.

### **Solution**
As per the patches mentioned in this SAP Security Note, the SAP Business Client can be switched to a more strict mode where no certificate errors are omitted. To enable this stricter mode, implement the attached patch and follow the instructions in the provided manual activity.

**Manual Activities:**
1. Add the setting `"StrictWinInetCertErrorHandling"` with the value `"true"` to your NWBC admin settings file located at `%PROGRAMDATA%\SAP\NWBC\NwbcOptions.xml`.
2. Set the following registry key to value `"3"`:
   - `HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\SAP\SAPLogon\CertErrorHandlingMode`
   - For 32-bit Windows: `HKEY_LOCAL_MACHINE\SOFTWARE\SAP\SAPLogon`
3. To add an exemption for a specific server, add hostnames to the allowlist in the registry key:
   - `HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\SAP\SAPLogon\WhitelistLandscapeFilesForIgnoringCertErrors`

Refer to [SAP Note 2892419](https://me.sap.com/notes/2892419) for additional details.

### **CVSS Score**
- **Score:** 6.5
- **Vector:** CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:L/A:N
  - **Attack Vector:** Network
  - **Attack Complexity:** High
  - **Privileges Required:** Low
  - **User Interaction:** Required
  - **Scope:** Changed
  - **Confidentiality Impact:** High
  - **Integrity Impact:** Low
  - **Availability Impact:** None

### **Available Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001029132022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003156484?language=en-US&token=C43059FF31E3DD1A5FA3A000F74960A2)
- Share by Email
- Open in New Window

### **Support Package Patches**
- **SAP BUSINESS CLIENT 7.70:**
  - **Support Package:** SP012
  - [Patch Details](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200012051&V=MAINT)
- **SAP BUSINESS CLIENT 7.0:**
  - **Support Package:** SP025
  - [Patch Details](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200007699&V=MAINT)

### **References**
- [Loading SAP UI landscape files via HTTPS: Certificate warnings / errors (SAP Note 2892419)](https://me.sap.com/notes/2892419)

For more information and support, visit [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for supporting the provision of this information.*