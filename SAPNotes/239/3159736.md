SAP Security Note 3159736 - [CVE-2022-35295] Privilege Escalation Vulnerability in SAPOSCOL on Unix

## Symptom

An attacker may use files created by SAPOSCOL to escalate privileges for themselves.

## Other Terms

- Privilege Escalation
- [CVE-2022-35295](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35295)

## Reason and Prerequisites

An attacker needs access to the operating system command line or ABAP report `RSBDCOS0`. The attacker may leverage permissions on files stored in the directory defined by the profile parameter `DIR_PERF`.

## Solution

Please install the latest Patch Level (PL) **57** or higher of the **SAP Host Agent**.

*This correction ensures that SAPOSCOL checks if the file can be appended or if a new file needs to be created.*

### Workaround

*Please assess the applicability of this workaround for your SAP landscape before implementation.*

*Note that this workaround is a temporary fix and not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note, which can be done instead of the workaround or after implementing the workaround.*

As a workaround, restrict access to the `DIR_PERF` directory so that the user `<sid>adm` does not have write permissions. This does not impact the functionality of SAPOSCOL but may prevent other SAP programs like CCMS from accessing this information.

## CVSS

**CVSS Score:** 6.7

**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:H)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** High (H)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

## Support Package Patches

- **Software Component Version:** SAP HOST AGENT 7.22
  - **Support Package:** SP056  
    [Download SP056](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200011934&support_package=SP056&patch_level=000056)
  - **Support Package:** SP057  
    [Download SP057](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200011934&support_package=SP057&patch_level=000057)

## Additional Information

- **Type:** SAP Security Note
- **Version:** 12
- **Recency:** New
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** 13.09.2022
- **Component:** Basis Components > Computer Center Management System (CCMS) > CCMS Monitoring & Alerting > Operating System Monitoring Tool

[Download the Security Note for SNOTE](https://notesdownloads.sap.com/note/0040000001203612022)

[PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003159736?language=en-US&token=618199BD156929F92EA3CD3895F03EE4)

## Credits

Information provided with support from [Redrays.io](https://redrays.io).