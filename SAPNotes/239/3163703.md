3163703 - Multiple Vulnerabilities in URI.js bundled with SAPUI5

**Symptom**

This SAP security note addresses several vulnerabilities identified in URI.js bundled with SAPUI5. The vulnerability details along with their CVE relevant information can be found below.

1. **Open Redirect**

   The hostname can be spoofed by using a backslash (`\`) character followed by an at (`@`) character. The attacker can access confidential information, modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited.

   - [CVE-2020-26291](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26291)
   - **CVSS Score:** 6.1; CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

2. **Open Redirect**

   URI.js is vulnerable to URL Redirection to Untrusted Site. The attacker can access confidential information, modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited.

   - [CVE-2021-3647](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3647)
   - **CVSS Score:** 6.1; CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

3. **URL Manipulation**

   URI.js fixed the issue for CVE-2021-3647, however an attacker can still exploit the issue due to case-sensitive checks in the earlier patch. Attacker can use case-insensitive protocol schemes like HTTP, htTP, HTtp etc. in order to bypass the patch for that issue.

   - [CVE-2022-0613](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0613)
   - **CVSS Score:** 6.1; CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

4. **URL Manipulation**

   URI.js mishandles certain uses of backslash such as `http:\\/` and interprets the URI as a relative path. The attacker can access confidential information, modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited.

   - [CVE-2021-27516](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27516)
   - **CVSS Score:** 5.4; CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N

**Other Terms**

URL Manipulation, Open Redirect, [CVE-2021-27516](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27516), [CVE-2020-26291](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26291), [CVE-2021-3647](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3647), [CVE-2022-0613](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0613)

**Reason and Prerequisites**

SAPUI5 is bundled with the third-party library URI.js and is using it for URL transformation.

**Solution**

In order to fix the problem, SAPUI5 is using URI.js version 1.19.10 or higher. Please update to one of the following SAPUI5 versions:

- **1.38.56 or higher**
- **1.60.43 or higher**
- **1.71.47 or higher**
- **1.84.24 or higher**
- **1.96.8 or higher**

**Manual Activities**

Please install the newest UI5 Patch - see referenced SAP Note [3155948](https://me.sap.com/notes/3155948).

For more details and to download the patches, visit the [SAP Support Portal](https://me.sap.com/).

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*