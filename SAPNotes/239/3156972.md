3156972 - [CVE-2023-40306] URL Redirection vulnerability in SAP S/4HANA (Manage Catalog Items and Cross-Catalog search)

**Description**

### Symptom
SAP S/4HANA Manage Catalog Items and Cross-Catalog search Fiori apps allow an attacker to redirect users to a malicious site due to insufficient URL validation. As a result, it may have a slight impact on confidentiality and integrity.

### Change Log:
- **v9 - 09th April 2024 (current):** This note has been re-released with updated 'Correction instruction' information.
- **v7 - 22nd August 2023:** This note has been re-released with CVSS score and minor textual changes. There have not been any changes done which require customer action.

### Other Terms
S/4HANA, untrusted URL, blocklist, [CVE-2023-40306](https://www.cve.org/CVERecord?id=CVE-2023-40306)

### Reason and Prerequisites
This is due to a program error, incorrect URL filtering maintenance, and the browser's security policy.

### Solution
Implement the Correction Instructions or Support Packages referenced by this security note.

**CVSS**

- **CVSS Score:** 6.1
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://me.sap.com/notes/CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

  | Key                     | Value                       |
  |-------------------------|-----------------------------|
  | Attack Vector (AV)      | Network (N)                 |
  | Attack Complexity (AC)  | Low (L)                     |
  | Privileges Required (PR)| None (N)                    |
  | User Interaction (UI)   | Required (R)                |
  | Scope (S)               | Changed (C)                 |
  | Confidentiality Impact (C)| Low (L)                   |
  | Integrity Impact (I)    | Low (L)                     |
  | Availability Impact (A) | None (N)                    |

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000949602023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003156972?language=en-US&token=21EF7A2D82779C569BA18A256A4F8FF0)
- [Show Changes](https://me.sap.com/notesLatestChanges/0003156972/E/diff)
- [Share by Email](#)
- [Open in New Window](#)

**Correction Instructions**

- [S4CORE Correction Instructions](https://me.sap.com/corrins/0003156972/19773)

**Prerequisites**

- SAP S/4HANA components affected: MM-FIO-PUR-REQ-SSP

**Support Package**

| Software Component Version | Support Package          | URL                                       |
|----------------------------|--------------------------|-------------------------------------------|
| S4CORE 103                 | SAPK-10309INS4CORE       | [Link](https://me.sap.com/supportpackage/SAPK-10309INS4CORE) |
| S4CORE 104                 | SAPK-10407INS4CORE       | [Link](https://me.sap.com/supportpackage/SAPK-10407INS4CORE) |
| S4CORE 105                 | SAPK-10505INS4CORE       | [Link](https://me.sap.com/supportpackage/SAPK-10505INS4CORE) |
| S4CORE 106                 | SAPK-10602INS4CORE       | [Link](https://me.sap.com/supportpackage/SAPK-10602INS4CORE) |

**Manual Activities**
Before maintaining the URIs in your app, decide and configure which HTTP(S) calls you want to permit or block. Use the "HTTP Allowlist Tool for Unified Connectivity (UCON)" via transaction UCONCOCKPIT with a system admin role. The Active Check mode is recommended.

More information:
1. [Managing HTTP Whitelists](https://help.sap.com/viewer/1ca554ffe75a4d44a7bb882b5454236f/7.40.27/en-US/1bf4b153a58644c6b6ee618e95af3b3e.html)
2. [Unified Connectivity](https://help.sap.com/viewer/1ca554ffe75a4d44a7bb882b5454236f/7.40.27/en-US/ab35e1c69f744d69a4fcf4ca93284e0c.html)
3. [Configuring HTTP Context Types (Active Check Mode)](https://help.sap.com/docs/SAP_NETWEAVER_AS_ABAP_FOR_SOH_740/1ca554ffe75a4d44a7bb882b5454236f/ad6340c911164f639877e2dfb51d4b49.html?q=active%20check)

**References**
No references are currently associated with this document.

**Credits**
Special thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.