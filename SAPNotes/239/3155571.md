3155571 - [CVE-2022-31594] Privilege escalation vulnerability in SAP Adaptive Server Enterprise (ASE)

### Symptom

**UPDATE 28th June 2022**: This note has been re-released with updated 'Symptomâ€™ information.

A highly privileged user can exploit SUID-root program to escalate their privileges to root on a local Unix system.

Non-Business Suite usage of ASE is not affected by this note; this note refers to usage of SAP NetWeaver ABAP or Java Stack on SAP ASE only.

### Other Terms

SAP ASE, Sybase ASE, [CVE-2022-31594](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31594)

### Reason and Prerequisites

The ASE database should be started by `sybctrl` without setting the SUID bit.

### Solution

The SUID bit is not set anymore.

If set, it should be removed by executing:

```bash
chmod 0755 /usr/sap/<SAPSID>/SYS/exe/run/sybctrl
```

This correction is delivered with the kernel archives:

- SP Stack Kernel - files SAPEXE.SAR and SAPEXEDB.SAR

### Workaround

Please assess the workaround applicability for your SAP landscape prior to implementation. Note that this workaround is a temporary fix and is not a permanent solution. SAP strongly recommends you apply the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.

If set, it should be removed by executing:

```bash
chmod 0755 /usr/sap/<SAPSID>/SYS/exe/run/sybctrl
```

The database can also be started using the SAP Host Agent with the `StartDatabase` command.

### CVSS

**CVSS Score**: 3.2

**CVSS Vector**: CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:C/C:N/I:L/A:N

- **Attack Vector (AV)**: Local (L)
- **Attack Complexity (AC)**: Low (L)
- **Privileges Required (PR)**: High (H)
- **User Interaction (UI)**: None (N)
- **Scope (S)**: Changed (C)
- **Confidentiality Impact (C)**: None (N)
- **Integrity Impact (I)**: Low (L)
- **Availability Impact (A)**: None (N)

### References

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000770492022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003155571?language=en-US&token=C14BA84F6328E1956440FDBE0AC14B9B)
- [Show Changes](https://me.sap.com/notesLatestChanges/0003155571/E/diff)
- [Referenced by SAP Note 3155559](https://me.sap.com/notes/3155559)

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*