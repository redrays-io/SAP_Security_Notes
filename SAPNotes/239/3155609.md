SAP Security Note 3155609 - Privilege escalation vulnerability in Apache Tomcat server component of SAP Commerce

**Symptom**

SAP Commerce contains an Apache Tomcat application server that has a known vulnerability ([CVE-2022-23181](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23181)). Configuring Tomcat to use FileStore to persist sessions can expose your SAP Commerce system to a time of check, time of use vulnerability that allows attackers to perform actions with the privileges of the user that the Tomcat process is using.

**Other Terms**

TOCTTOU, [CVE-2022-23181](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23181), Apache Tomcat

**Reason and Prerequisites**

The out-of-the-box configuration of SAP Commerce is not affected by this vulnerability as it doesn't use FileStore to persist sessions.

Customers who have modified their Tomcat configuration to use FileStore might be exposed to this vulnerability and are advised to upgrade to the newest patch.

**Solution**

SAP Commerce addresses this vulnerability by upgrading Apache Tomcat to a version that is not exposed to CVE-2022-23181.

The following SAP Commerce patch releases contain the upgraded Tomcat:

- [SAP Commerce Cloud Patch Release 2105.10](https://help.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/2105/en-US/f9b65161e1e645249542e59f42f64a7b.html)
- [SAP Commerce Cloud Patch Release 2011.20](https://help.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/2011/en-US/f9b65161e1e645249542e59f42f64a7b.html)
- [SAP Commerce Cloud Patch Release 2005.25](https://help.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/2005/en-US/f9b65161e1e645249542e59f42f64a7b.html)
- [SAP Commerce Cloud Patch Release 1905.41](https://help.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/1905/en-US/f9b65161e1e645249542e59f42f64a7b.html)

The [Software Downloads](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=MAINT&TA=ACTUAL/SAP%20COMMERCE) of these or later patches are available in the SAP Support Portal. For information on installing SAP Commerce patches, see [About Patch Releases](https://help.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/LATEST/en-US/8c25978386691014b4abdd61376acd24.html).

After installing a SAP Commerce patch, customers need to rebuild and redeploy the updated SAP Commerce version.

**CVSS**

- **Score:** 7.0
- **Vector:** `CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H`
  - **Attack Vector (AV):** Local (L)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** High (H)

**Available Languages**

- Deutsch: [View in Deutsch](https://me.sap.com/notes/0003155609/D)
- 日本語: [View in 日本語](https://me.sap.com/notes/0003155609/J)
- Português (Machine Translation): [View in Português](https://me.sap.com/notes/0003155609/P)
- Español (Machine Translation): [View in Español](https://me.sap.com/notes/0003155609/S)
- Français (Machine Translation): [View in Français](https://me.sap.com/notes/0003155609/F)
- Italiano (Machine Translation): [View in Italiano](https://me.sap.com/notes/0003155609/I)
- Русский (Machine Translation): [View in Русский](https://me.sap.com/notes/0003155609/R)
- 中文 (Machine Translation): [View in 中文](https://me.sap.com/notes/0003155609/1)
- 한국어 (Machine Translation): [View in 한국어](https://me.sap.com/notes/0003155609/3)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [redrays.io](https://redrays.io) for support to provided information.*