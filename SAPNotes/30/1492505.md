SAP Security Note 1492505 - Virus scan for WWI documents

## Description

### Symptom
**Component:** Product Safety  
**Module:** Reporting

In **Environment, Health, and Safety (EHS)**, you can process or generate different file formats using **Windows Wordprocessor Integration (WWI)**. As a result, virus-infected documents could enter the system or the front end, potentially leading to security breaches and undesired system behavior.

### Reason and Prerequisites
**Reason:**  
The EH&S application currently does not provide a virus scanning function during report generation. This omission could allow malicious documents to infiltrate the system.

**Prerequisites:**  
For information about the validity of the corrections, refer to the correction instructions provided with the note.

## Solution

To address the issue of unscanned documents being uploaded via WWI, the following steps should be taken:

1. **Activate/Deactivate Virus Check:**
   - Use the profile `/CBUI/WWI_REPORT_GEN` to (de)activate the virus check. This check is optional, but the profile must always be configured.
   
2. **Configure the Virus Scan Interface (VSI):**
   - Detailed configuration instructions are available in the [SAP NetWeaver Security Guide](https://me.sap.com/documentation).
   - Navigate through:
     - Documentation for SAP NetWeaver
     - System Administration
     - Security Guide
     - "Virus Protection and SAP GUI Integrity Checks" under "Security Guides for SAP NetWeaver According to Usage Types" for the usage type "Application Server (AS)"
     - "Using the Virus Scan Interface" section

3. **ABAP-Specific Configuration:**
   - Set up the virus search function for WWI or define an inactive profile `/CBUI/WWI_REPORT_GEN` to deactivate it.
   - Refer to [Note 786179](https://me.sap.com/notes/786179) for detailed information on using the virus scan interface.

4. **Manual Activities:**
   - If **Note Assistant 2.0** is not installed, perform the manual activities described in the correction instructions.
   - Ensure the table type `ESY_TT_RCGREPFILE` is created in the ABAP Dictionary using transaction `SE11`.
   - Create and configure the function module `C12H_VIRUS_CHECK` as outlined in the correction instructions.
   - Add the exception `VIRUS_CHECK_FAILED` to the function module `CBGL_LB61_LABEL_GENERATE` if applicable.

**Workaround:**  
Install an up-to-date virus scanner on the WWI server to enhance security, regardless of this note.

## Support Packages

The following support packages contain the necessary corrections for various software component versions:

- **EA-APPL 110:** [SAPKGPAA32](https://me.sap.com/supportpackage/SAPKGPAA32)
- **EA-APPL 200:** [SAPKGPAB21](https://me.sap.com/supportpackage/SAPKGPAB21)
- **EA-APPL 500:** [SAPKGPAC25](https://me.sap.com/supportpackage/SAPKGPAC25)
- **EA-APPL 600:** [SAPKGPAD19](https://me.sap.com/supportpackage/SAPKGPAD19)
- **EA-APPL 602:** [SAPK-60209INEAAPPL](https://me.sap.com/supportpackage/SAPK-60209INEAAPPL)
- **EA-APPL 603:** [SAPK-60309INEAAPPL](https://me.sap.com/supportpackage/SAPK-60309INEAAPPL)
- **EA-APPL 604:** [SAPK-60409INEAAPPL](https://me.sap.com/supportpackage/SAPK-60409INEAAPPL)
- **EA-APPL 605:** [SAPK-60505INEAAPPL](https://me.sap.com/supportpackage/SAPK-60505INEAAPPL)

## Download and Additional Resources

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000008833012017](https://notesdownloads.sap.com/note/0040000008833012017)
- **PDF Version:** [https://me.sap.com/sap/support/sfm/notes/print/0001492505?language=en-US&token=2C8864D706B441CC65BAB6201F7E85A9](https://me.sap.com/sap/support/sfm/notes/print/0001492505?language=en-US&token=2C8864D706B441CC65BAB6201F7E85A9)
- **Correction Instructions:** [https://me.sap.com/corrins/0001492505/229](https://me.sap.com/corrins/0001492505/229)

## References

- **Related Notes:**
  - [1772637 - Virus scan for WWI documents](https://me.sap.com/notes/1772637)
  - [1492914 - Missing virus scan during report import](https://me.sap.com/notes/1492914)

## Side Effects

This document references [1772637 - Virus scan for WWI documents](https://me.sap.com/notes/1772637) as a document causing side effects.

---

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*