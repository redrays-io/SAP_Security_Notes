1631354 - Update 1 to Security Note 1616058

---

**Header Data**

- **SAP Note/KBA:** 1631354
- **Type:** SAP Security Note
- **Version:** 2
- **Recency:** Updated
- **Language:** English
- **Master Language:** English
- **Category:** Program error
- **Priority:** HotNews
- **Release Status:** Released for Customer
- **Released On:** 16.05.2012
- **Component:** Basis Components > NetWeaver Application Server Java > Security, User Management > User Management Engine

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017309332017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001631354?language=en-US&token=D8E470D5158DB632DAB422692FF73664)
- Share by Email
- Open in New Window
- [Show Changes](https://me.sap.com/notesLatestChanges/0001631354/E/diff)

**Description**

### Symptom

Security note 1616058 has been rereleased. It previously provided workaround instructions which are no longer valid as corrections are available.  
The corrections introduce an incompatible change for the SPML service.

### Other Terms

URL, Uniform Resource Locator, ICM, SPML, IDM, SAP NetWeaver Identity Management, Update, Update Note

### Reason and Prerequisites

Workaround instructions in security note 1616058 have been replaced by correction instructions.  
The correction introduces an incompatible change for the SPML service.  
After this change, the SPML service checks every SPML request for the availability of an HTTP header with name "X-Requested-With" and value "XMLHttpRequest".  
Patches for SAP products that use the SPML interface are available. For more information, check the "Related Notes" section in Security Note 1616058.  
If you are using third-party SPML clients which cannot be updated, you may switch off the protection by changing the UME property `ume.spml.http_header_check_active` to `false` (a cluster restart is required). If this property is set to false, additional protection mechanisms like URL filter via ICM, load balancers, or firewalls have to be applied as described in Security Note 1616058.

### Solution

If you applied the workaround previously provided with Security Note 1616058, please revert all changes (see below for instructions) and update your AS Java to a Support Package or release where the issue is fixed. See the "SP Patch Level" section of Security Note 1616058 for details and available patches.

**Follow the instructions for your release as described below.**

**SAP NetWeaver 7.1 and higher:**

The URLs for the SPML service have a unique prefix and can be filtered out in the ICM on a rule basis. In the profile file, remove the following modification handler:

```
icm/HTTP/mod_0 = PREFIX=/,FILE=$(DIR_GLOBAL)/security/data/icm_filter_rules.txt
```

If you no longer need the rule file, you can delete it from the specified directory.

If you have disabled the alias "spml" in the HTTP provider service, use the following procedure:

**For NetWeaver 7.0x:**

1. Connect with Visual Admin and navigate to the server node per instance â†’ HTTP provider.
2. Select "Application Alias" and check the application alias "spml".
3. Save the changes with "Save Properties".

**For all NetWeaver Releases:**

Remove all configured restrictions applied to URLs starting with "/spml/" from your firewall or load balancer in front of the NetWeaver AS Java.

**References**

**This document refers to:**

- [Solution Manager adaptation to Java UME security](https://me.sap.com/notes/1647267)
- [SPML Connection Between SAP NW IdM and NW AS Java Fails](https://me.sap.com/notes/1621289)
- [XSRF possible in SPML Services in AS Java](https://me.sap.com/notes/1616058)

**This document is referenced by:**

- [Solution Manager adaptation to Java UME security](https://me.sap.com/notes/1647267)
- [SPML Connection Between SAP NW IdM and NW AS Java Fails](https://me.sap.com/notes/1621289)

**Side Effects**

**This document solves side effects:**

- [XSRF possible in SPML Services in AS Java](https://me.sap.com/notes/1616058)

---

*Information provided by [redrays.io](https://redrays.io).*