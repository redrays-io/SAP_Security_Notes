SAP Security Note 1629878 - AS Java allows flash access from any domain

---

**SAP Note Number:** 1629878  
**Type:** SAP Security Note  
**Priority:** Correction with high priority  
**Release Status:** Released for Customer  
**Released On:** 14.02.2012  
**Component:** Basis Components > NetWeaver Application Server Java > Local Admin Tools > Administration  
**Category:** Customizing  
**Version:** 2  

### Description

**Symptom:**  
SAP NetWeaver Application Server Java (AS Java) allows Web clients (such as Adobe Flash Player, Adobe Acrobat, and others) to handle data across domains.

**Other Terms:**  
Adobe, Flash clients, cross-domain, cross domain, crossdomain.xml, CSRF, XSRF

**Reason and Prerequisites:**  
AS Java has a configuration that allows Web clients to handle data across domains. When a client hosts content provided by a different domain, the configuration checks if AS Java trusts the domain to consume content deployed on AS Java. The default configuration is least restrictive, granting permissions for content from any domain to access resources from AS Java. This default configuration is vulnerable to XSRF (CSRF) attacks.

**Solution:**  
The solution makes the default configuration most restrictive, not permitting content provided by external domains to access resources from AS Java. Web applications deployed on AS Java can still deploy their specific policy files, granting external domains access to their resources. This access is limited only to the scope of application resources.

Apply the patches specified in the Support Package Patches section of this SAP Note.

### Support Package Patches

**J2EE ENGINE LM-CORE 7.20**  
- SP004 Patch 000006: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200013061&support_package=SP004&patch_level=000006)  
- SP003 Patch 000007: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200013061&support_package=SP003&patch_level=000007)  
- SP005 Patch 000004: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200013061&support_package=SP005&patch_level=000004)  
- SP007 Patch 000000: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200013061&support_package=SP007&patch_level=000000)  
- SP006 Patch 000000: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200013061&support_package=SP006&patch_level=000000)  

**J2EE ENGINE LM-CORE 7.30**  
- SP004 Patch 000002: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP004&patch_level=000002)  
- SP003 Patch 000004: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP003&patch_level=000004)  
- SP005 Patch 000001: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP005&patch_level=000001)  
- SP002 Patch 000005: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP002&patch_level=000005)  
- SP007 Patch 000000: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP007&patch_level=000000)  

**J2EE ENGINE LM-CORE 7.31**  
- SP002 Patch 000000: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014365&support_package=SP002&patch_level=000000)  
- SP001 Patch 000000: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014365&support_package=SP001&patch_level=000000)  

### References

This document is referenced by [SAP Note 2651364 - AS Java Security Vulnerability - crossdomain.xml is present](https://me.sap.com/notes/2651364).

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017306902017)  
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001629878?language=en-US&token=D772FE044EAD4E47AA4868349F5B6686)  
- [Edit](https://i7p.wdf.sap.corp/sap/support/notes/edit/0001629878) *(Not publicly visible)*  
- [Show Changes](#) *(URL is empty)*  

---

*Credits to [redrays.io](https://redrays.io) for support to provided information.*