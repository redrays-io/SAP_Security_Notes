3105728 - [CVE-2021-40504] Leverage of Permission in SAP NetWeaver Application Server for ABAP and ABAP Platform

**Description**

### Symptom
The template role `SAP_BC_DWB_WBDISPLAY` in SAP NetWeaver Application Server for ABAP and ABAP Platform contains transport authorizations that exceed the expected display-only permissions.

### Other Terms
- [CVE-2021-40504](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40504)

### Reason and Prerequisites
The template role `SAP_BC_DWB_WBDISPLAY` is intended for users with only display permissions for the ABAP Workbench. However, if an administrator assigns this role to a malicious user, they can exploit the higher privileges to transport ABAP artifacts.

### Solution
- **Support Package:** Apply the support package mentioned in this SAP Note. The correction removes activities `IMPA` and `IMPS` in object `S_CTS_ADMI` used in the template role `SAP_BC_DWB_WBDISPLAY`.
  
- **Review Authorizations:** User administrators should review the authorizations of roles intended for "developers" with display-only permissions. Use transaction `SUIM` to search for roles with object `S_CTS_ADMI` and activities `IMPA` and `IMPS`. Adjust the identified roles and the role `SAP_BC_DWB_WBDISPLAY` using transaction `PFCG`.

### CVSS
- **CVSS Score:** 4.9
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N)

### Validity
Applicable to the following SAP_BASIS releases:
- 700 to 702
- 710 to 711
- 730 to 731
- 740 to 756

### Support Packages
Ensure you apply the correct support package for your SAP_BASIS version:

- [SAPKB70040](https://me.sap.com/supportpackage/SAPKB70040) for SAP_BASIS 700
- [SAPKB70124](https://me.sap.com/supportpackage/SAPKB70124) for SAP_BASIS 701
- [SAPKB70224](https://me.sap.com/supportpackage/SAPKB70224) for SAP_BASIS 702
- [SAPKB73130](https://me.sap.com/supportpackage/SAPKB73130) for SAP_BASIS 731
- [SAPKB74027](https://me.sap.com/supportpackage/SAPKB74027) for SAP_BASIS 740
- [SAPK-75023INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75023INSAPBASIS) for SAP_BASIS 750
- [SAPK-75114INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75114INSAPBASIS) for SAP_BASIS 751
- [SAPK-75210INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75210INSAPBASIS) for SAP_BASIS 752
- [SAPK-75308INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75308INSAPBASIS) for SAP_BASIS 753
- [SAPK-75406INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75406INSAPBASIS) for SAP_BASIS 754
- [SAPK-75504INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75504INSAPBASIS) for SAP_BASIS 755
- [SAPK-75601INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75601INSAPBASIS) for SAP_BASIS 756

### Manual Activities
**Caution:** Perform this manual activity separately in each system where you transport the Note for implementation.

1. **Review Authorizations:** Use transaction `SUIM` to search for roles with object `S_CTS_ADMI` and activities `IMPA` and `IMPS`.
2. **Adjust Roles:** Modify the identified roles and the role `SAP_BC_DWB_WBDISPLAY` using transaction `PFCG`.

### Additional Information
- **Download for SNOTE:** [Download Note 3105728](https://notesdownloads.sap.com/note/0040000001605222021)
- **PDF Version:** [View PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003105728?language=en-US&token=6D908576AC75014E50FB3327FCFE67BA)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

**Credits:** Information provided with support from [RedRays](https://redrays.io).