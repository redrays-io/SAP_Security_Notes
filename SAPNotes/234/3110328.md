3110328 - [CVE-2021-40502] Missing Authorization check in SAP Commerce

**SAP Security Note 3110328 - [CVE-2021-40502] Missing Authorization Check in SAP Commerce**

**Description:**
SAP Commerce does not perform necessary authorization checks for an authenticated user, resulting in escalation of privileges. Authenticated attackers will be able to access and edit data from B2B units they do not belong to.

**Impacts of Missing Authorization Check:**
- Abuse functionality restricted to a particular user group
- Read, modify, or delete restricted data

**Affected Components:**
- **Component:** CEC-COM-CPS-WEB (Customer Engagement and Commerce > SAP Commerce > Store frontend, Web CMS, Accelerators)
- **Valid From:** 1905, 2005, 2011, 2105

**CVSS Score:**
- **Score:** 8.3
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:H

**Solution:**
SAP Commerce addresses this vulnerability with the following measures:
1. Resolving a 'SearchRestriction' code conflict between two different modules.
2. Adding new search restrictions.

**Patch Releases Addressing This Vulnerability:**
- [SAP Commerce Cloud Patch Release 2105.3](https://cxjira.sap.com/browse/PATCH-10046)
- [SAP Commerce Cloud Patch Release 2011.13](https://cxjira.sap.com/browse/PATCH-10045)
- [SAP Commerce Cloud Patch Release 2005.18](https://cxjira.sap.com/browse/PATCH-10044)
- [SAP Commerce Cloud Patch Release 1905.34](https://cxjira.sap.com/browse/PATCH-10043)

These patches are available in the [Software Downloads](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=MAINT&TA=ACTUAL/SAP%20COMMERCE) section of the SAP Support Portal. For information about installing patches, refer to [About Patch Releases](https://me.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/2105/en-US/8c25978386691014b4abdd61376acd24.html).

**Manual Remediation Steps:**
After applying the patch, manually re-import the following impex files to enable the restrictions at the database level:
- `/hybris/bin/modules/b2b-commerce/b2bcommerce/resources/impex/essentialdata_2_b2bcommerce.impex`
- `/hybris/bin/modules/b2b-accelerator-addons/accountsummaryaddon/resources/accountsummaryaddon/import/essentialdata_documenttype.impex`
- `/hybris/bin/modules/b2b-accelerator-addons/accountsummaryaddon/resources/accountsummaryaddon/import/essentialdata_documenttype_de.impex`
- `/hybris/bin/modules/b2b-accelerator-addons/accountsummaryaddon/resources/accountsummaryaddon/import/essentialdata_documenttype_en.impex`

**References:**
- [CVE-2021-40502](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40502)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

_Credits to [Redrays.io](https://redrays.io) for support in providing this information._