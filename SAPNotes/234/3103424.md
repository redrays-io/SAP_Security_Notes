3103424 - [CVE-2022-24398] Information Disclosure Vulnerability in SAP Business Objects Business Intelligence Platform

**Symptom**

Under certain conditions, SAP Business Objects Business Intelligence Platform allows an authenticated attacker to access information which would otherwise be restricted.

**Other Terms**

Information Exposure, Information Leak, [CVE-2022-24398](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE-2022-24398)

**Reason and Prerequisites**

Users that have view rights on OLAP connections can read passwords.

**Solution**

The problem can be resolved by using an alternative authentication mode for the connection:

- **Single Sign-On**: Authentication is delegated to another system that generates a session token used to identify the user.
- **BusinessObjects Credentials Mapping**: Connection parameters are saved in the BI Platform repository for each user. These credentials are used by the server when initiating a connection to the database.

Additionally, a new security right for OLAP connections has been introduced: **"Download connection locally"**. This right functions similarly to the existing right for relational connections:

- **If Denied**:
  - The OLAP connection is encrypted in the BI Platform repository, preventing disclosure of sensitive parameters (password, server details).
  - The connection cannot be retrieved locally by Web Intelligence Rich Client and saved in its local cache.
  - Users cannot use this connection in Web Intelligence Rich Client in offline mode.
  
- **If Granted**:
  - The connection can be retrieved locally by Web Intelligence Rich Client and saved in its local cache.
  - Users can use this connection in Web Intelligence Rich Client in offline mode.
  
This security right can be managed by Administrators in the [Central Management Console (CMC)](https://me.sap.com/centermanagementconsole) and can be granted or denied to users or groups. It is available in SAP BI 4.3 SP2 and above.

**CVSS Information**

- **CVSS Score**: 5.0
- **Vector**: [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N](https://www.first.org/cvss/v3-0)

**Support Package Patches**

The issue is fixed in the following support package patches:

- **SBOP BI PLATFORM SERVERS 4.3 SP003**: [Patch Details](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)
- **SBOP BI PLATFORM SERVERS 4.2 SP009**: [Patch Details](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
- **SBOP BI PLATFORM SERVERS 4.3 SP002**: [Patch Details](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)
- **SBOP BI PLATFORM SERVERS 4.3 SP001**: [Patch Details](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006622&V=MAINT)

For more information on the Business Intelligence Platform maintenance schedule and strategy, refer to the [Knowledge Base Article 2144559](https://me.sap.com/notes/2144559).

**References**

- [2144559 - BI 4.x Maintenance Strategy & Schedule](https://me.sap.com/notes/2144559)
- [3205638 - OLAP connections visibility issue in Analysis Office](https://me.sap.com/notes/3205638)

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*