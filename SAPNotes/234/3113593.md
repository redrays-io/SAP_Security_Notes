SAP Security Note 3113593 - Denial of service (DOS) in SAP Commerce

---

## Description

### Symptom
The library **jsoup** used in SAP Commerce may be vulnerable to DOS attacks. **jsoup** is utilized to sanitize various product-related metadata in **b2caccelerator**. A user with write access to product metadata could exploit this vulnerability.

**Impacts of the vulnerability:**
- Long response delays and service interruptions, degrading the service quality experienced by legitimate users.
- Direct impact on availability.

### Other Terms
- DoS, DDoS, Distributed Denial of Service, Uncontrolled Resource consumption, Resource Exhaustion, [CVE-2021-37714](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-37714)

### Reason and Prerequisites
This vulnerability affects any SAP Commerce installation using the [B2C Accelerator](https://help.sap.com/viewer/7e47d40a176d48ba914b50957d003804/v2105/en-US/1d2fea5f94644d07b3c301994691f978.html).

## Solution
SAP Commerce addresses this vulnerability by upgrading **jsoup**, which does not contain the vulnerability.

**The following patch releases address this vulnerability:**
- [SAP Commerce Cloud Patch Release 2105.4](https://cxjira.sap.com/browse/PATCH-10116)
- [SAP Commerce Cloud Patch Release 2011.14](https://cxjira.sap.com/browse/PATCH-10115)
- [SAP Commerce Cloud Patch Release 2005.19](https://cxjira.sap.com/browse/PATCH-10114)
- [SAP Commerce Cloud Patch Release 1905.35](https://cxjira.sap.com/browse/PATCH-10113)

The [Software Downloads](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=MAINT&TA=ACTUAL/SAP%20COMMERCE) of these or later patches are available in the SAP Support Portal. For information about installing patches, see [About Patch Releases](https://help.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/2105/en-US/8c25978386691014b4abdd61376acd24.html).

### Workaround
To minimize the impact, restrictions to product-related field length could be implemented to limit the size of inputs sent to **jsoup**. See [Creating Validation Constraints in Backoffice](https://help.sap.com/viewer/c0234cf985ba4390b4eebe4a38a4457f/2105/en-US/4b982f5685564dadb6e2927a35300bbe.html).

Please assess the workaround applicability for your SAP landscape prior to implementation.

**Note:** This workaround is a temporary fix and is not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.

## CVSS

**CVSS Score:** 7.5

**CVSS Vector:** CVSS:/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** None (N)
- **Integrity Impact (I):** None (N)
- **Availability Impact (A):** High (H)

## Affected Software Components

| Software Component | From  | To    |
|--------------------|-------|-------|
| HY_COM             | 1905  | 1905  |
| HY_COM             | 2005  | 2005  |
| HY_COM             | 2105  | 2105  |
| HY_COM             | 2011  | 2011  |

## References

- [CVE-2021-37714](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-37714)
- [B2C Accelerator](https://help.sap.com/viewer/7e47d40a176d48ba914b50957d003804/v2105/en-US/1d2fea5f94644d07b3c301994691f978.html)
- [Creating Validation Constraints in Backoffice](https://help.sap.com/viewer/c0234cf985ba4390b4eebe4a38a4457f/2105/en-US/4b982f5685564dadb6e2927a35300bbe.html)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

---

*Credits to [Red Rays](https://redrays.io) for supporting the information provided.*