3111293 - [CVE-2022-28773] Denial of service (DOS) in SAP Web Dispatcher and SAP Netweaver (Internet Communication Manager)

### Description

A vulnerability due to uncontrolled recursion in SAP Web Dispatcher and SAP Internet Communication Manager may allow an attacker to cause a denial of service (DoS) by crashing the application. While the application can restart automatically, this may lead to service disruptions. Additionally, SAP HANA Extended Application Services (XS Classic) includes a vulnerable Web Dispatcher.

**Other Terms:** DoS, DDoS, Distributed Denial of Service, Uncontrolled Resource Consumption, Resource Exhaustion, [CVE-2022-28773](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28773)

### CVSS

**Score:** 4.9  
**Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H)

### Affected Components

- **SAP Web Dispatcher:** Versions 7.53 and higher
- **SAP Netweaver (Internet Communication Manager):** Versions 7.22, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86
- **SAP HANA Extended Application Services (XS Classic)**

### Solution

Apply the relevant patches provided by SAP to mitigate this vulnerability:

1. **SAP Web Dispatcher:**
   - **Patch File:** `SAPWEBDISP.SAR`
   
2. **ICM and Embedded SAP Web Dispatcher:**
   - **Patch Files:** `dw.sar` or `SAPEXE.SAR` and `SAPEXEDB.SAR`
   
**Download and Installation Instructions:**
- Refer to [SAP Note 908097](https://me.sap.com/notes/908097) for recommended SAP Web Dispatcher versions and detailed patch installation steps.
- Apply the latest SP Stack Kernel as outlined in [SAP Note 2083594](https://me.sap.com/notes/2083594).
- If experiencing serious errors, apply the hotfix as necessary.
- Review the regression information in [SAP Note 1802333](https://me.sap.com/notes/1802333) before installing the kernel patch.
- For instructions on downloading and installing kernel patches, see [SAP Note 19466](https://me.sap.com/notes/19466).

### Workaround

As a temporary measure, you can disable the administration UI to prevent exploitation:

1. **Remove Administration UI Entries:**
   - Delete all `icm/HTTP/admin_xx` entries from the profile.
   
2. **Clear Profile Parameter:**
   ```
   icm/HTTP/admin_0 =
   ```
   
3. **Restart the System:**
   - Ensure the system is restarted for changes to take effect.

**Note:** This workaround is temporary and should be reversed once the appropriate patches are applied.

### Support Package Patches

For detailed support package patches relevant to your software components and versions, visit the [Support Package Patches](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&V=MAINT) page on the SAP Support Portal.

### References

- [SAP Note 908097](https://me.sap.com/notes/908097) - Recommended SAP Web Dispatcher version and patch installation.
- [CVE-2022-28773 Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28773)

### Valid Software Components

Affected software components and versions include:

- **SAP KERNEL:**
  - 7.22, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86
- **WEBDISP:**
  - 7.53, 7.77, 7.81, 7.85, 7.86

For a complete list of affected versions, refer to the [Support Package Patches](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&V=MAINT) page.

### Attachments

No attachments are available for this security note.

### Credits

Thanks to [https://redrays.io](https://redrays.io) for supporting the information provided.