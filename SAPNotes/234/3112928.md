3112928 - [CVE-2022-22531] Multiple vulnerabilities in F0743 Create Single Payment application of SAP S/4HANA

## Description

**Symptom**

**UPDATE 25th January 2022**: This note has been re-released with updated 'Solution' information. We have made minor textual corrections in the Solution information.

This SAP Security Note addresses the following vulnerabilities identified in SAP S/4HANA. The F0743 Create Single Payment application of SAP S/4HANA does not check uploaded or downloaded files. The vulnerability details along with their CVE relevant information are detailed below.

### Cross-Site Scripting (XSS):

A Reflected Cross-Site Scripting (XSS) vulnerability in SAP S/4HANA allows an attacker with basic user rights to run arbitrary script code, resulting in sensitive information being disclosed or modified.

- [CVE-2022-22531](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22531)
- **CVSS Score:** 8.7 (CVSS:3.0/AV:N/AC:L/PR:L/UI:P/S:C/C:H/I:H/A:N)

### Code Injection:

A code injection vulnerability in SAP S/4HANA allows an attacker with basic user rights to inject dangerous content or malicious code, potentially modifying critical information or compromising the availability of the application.

- [CVE-2022-22530](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22530)
- **CVSS Score:** 8.7 (CVSS:3.0/AV:N/AC:L/PR:L/UI:P/S:C/C:N/I:H/A:H)

## Reason and Prerequisites

Using attachments in the application F0743 Create Single Payment.

## Solution

This SAP Security Note implements the Virus Scanner Interface (VSI) that checks files during upload and download. This feature relies on antivirus software being installed, configured, and enabled on the server.

The critical part of the solution is properly configuring the VSI via the definition of the default VSCANPROFILE (as the application uses the default VSCANPROFILE). Please follow instructions described in [SAP Note 3052386 - FAQ | Virus Scan Interface (VSI)](https://me.sap.com/notes/3052386). Configure the required components to ensure the correct function of the VSI.

**Alternative Workaround:**

- Manually scan files before uploading.
- Avoid opening uploaded files directly in a web browser. Instead, download files to the local file system and manually scan them before opening.

## Validity

**Software Components:**

- **S4CORE**: Versions 100 to 106

## Support Packages

Refer to the specific support package URLs provided in the SAP Note or visit the [Support Package Downloads](https://me.sap.com/supportpackage) page for more information.

## Correction Instructions

- **Number of Correction Instructions:** 7
- **Manual Activities:** 1 (Error)
- **Prerequisites:** 1

## References

- [SAP Note 3112928](https://me.sap.com/notes/3112928)
- [Show Changes](https://me.sap.com/notesLatestChanges/0003112928/E/diff)
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000020192022)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003112928?language=en-US&token=E7985FCD6CAD316C3B55D0B09FB8EF01)

## Credits

Supported by [Redrays](https://redrays.io) for providing the information.