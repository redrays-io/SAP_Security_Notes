693220 - Recommendations for the security of ITS services

**Overview**

SAP Security Note **693220** provides important recommendations to enhance the security of Internet Transaction Server (ITS) services. Released on October 8, 2009, this note addresses potential vulnerabilities that allow unauthorized access to the R/3 backend system via ITS and outlines measures to prevent such risks.

**Symptom**

It is possible to access the R/3 backend system using the Internet Transaction Server (ITS). Appropriate measures should be taken to prevent unauthorized users from using this function or authorized users from using the backend system in a way that is not allowed.

**Reason and Prerequisites**

Authorizations are not sufficiently limited for service users and end users, which can lead to unauthorized access or misuse of the backend system.

**Solution**

The security note outlines several key measures to secure ITS services:

1. **Create an Authorization Concept**
   - **a)** Utilize the SAP-provided roles as templates for your own roles.
   - **b)** Use the authorization trace in transaction ST01 to identify required authorizations and create corresponding roles.
   - **c)** Define detailed authorizations for the authorization objects `S_TCODE` (transaction start authorization) and `S_RFC` (Remote Function Call authorization). Avoid granting full authorization (`*`) for these objects, especially to users accessing the system via the Internet.
   - **Additional Recommendation:** Use the Security Audit Log (transactions SM19 and SM20) to efficiently log started transactions and RFC function modules during testing. This helps in refining the authorization concept without impacting system performance.

2. **Implement Important Security Rules**
   - **a)** Prefer using the user type `'Communication'` over `'Dialog'` or `'Service'` for WebRFC Internet applications that exclusively use RFC for system access.
   - **b)** Change passwords for standard users (e.g., SAP*, DDIC, EARLYWATCH) across all clients and systems. Use report `RSUSR003` to check the passwords of standard users.
   - **c)** Deactivate all unnecessary SAP GUI for Windows services to minimize potential attack vectors.

For detailed instructions and additional measures, refer to the full SAP Security Note [693220](https://me.sap.com/notes/693220).

**Download and Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000015586062017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0000693220?language=en-US&token=59D769EF934F083CC91BD8CFB3AC392A)

**References**

- [ISS: Required authorizations](https://me.sap.com/notes/683043)
- [Availability of the SAP Security Guide](https://me.sap.com/notes/39267)
- [Data protection and security in SAP Systems](https://me.sap.com/notes/30724)
- [Collective Note: Security in SAP Products](https://me.sap.com/notes/23611)

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*