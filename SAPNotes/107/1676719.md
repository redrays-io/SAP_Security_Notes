SAP Security Note 1676719 - Unauthorized modification of BSP in Webdocuments

**Symptom**

The BSP application Webdocuments can be abused by malicious users, allowing them to modify displayed application content without authorization and potentially obtain authentication information from other legitimate users.

**Vulnerability Details**

- **Issue**: Cross-site scripting (XSS) in BSP applications within Webdocuments.
- **Affected Applications**: `/SAPDII/ADSPARES`, `/SAPDII/DI_DP_COMMON`, `/SAPDII/DI_SPP_UI`, `/SAPDII/DWB`, `/SAPDII/WTY_UI`
- **Impact**: 
  - Unauthorized modification of application content.
  - Theft of authentication information, such as session data.
  - Potential impersonation of users, including administrators, leading to full compromise of the application's security.

**Reason and Prerequisites**

BSP applications within Webdocuments do not sufficiently encode OUTPUT parameters, resulting in a cross-site scripting vulnerability. This flaw can be exploited to steal another user's authentication information, enabling malicious actions like impersonation.

**Solution**

Apply [SAP Note 1676719](https://notesdownloads.sap.com/note/0040000009956812017) or import the necessary changes via the relevant [support package](https://me.sap.com/supportpackage/SAPKGPAD22).

**Affected Components and Versions**

- **Software Component**: EA-APPL
  - **Versions**: 600, 602, 603, 604, 605, 606, 616

**Support Packages Available**

- [SAPKGPAD22 for EA-APPL 600](https://me.sap.com/supportpackage/SAPKGPAD22)
- [SAPK-60212INEAAPPL for EA-APPL 602](https://me.sap.com/supportpackage/SAPK-60212INEAAPPL)
- [SAPK-60311INEAAPPL for EA-APPL 603](https://me.sap.com/supportpackage/SAPK-60311INEAAPPL)
- [SAPK-60412INEAAPPL for EA-APPL 604](https://me.sap.com/supportpackage/SAPK-60412INEAAPPL)
- [SAPK-60413INEAAPPL for EA-APPL 604](https://me.sap.com/supportpackage/SAPK-60413INEAAPPL)
- [SAPK-60509INEAAPPL for EA-APPL 605](https://me.sap.com/supportpackage/SAPK-60509INEAAPPL)
- [SAPK-60510INEAAPPL for EA-APPL 605](https://me.sap.com/supportpackage/SAPK-60510INEAAPPL)
- [SAPK-60603INEAAPPL for EA-APPL 606](https://me.sap.com/supportpackage/SAPK-60603INEAAPPL)
- [SAPK-60606INEAAPPL for EA-APPL 606](https://me.sap.com/supportpackage/SAPK-60606INEAAPPL)
- [SAPK-61601INEAAPPL for EA-APPL 616](https://me.sap.com/supportpackage/SAPK-61601INEAAPPL)

**References**

- [SAP Note 1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [SAP Note 1582867 - Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)

**Download and More Information**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009956812017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001676719?language=en-US&token=EACF3A88AEF613F0505CEFFE35785311)

**Credits**

Information provided with support from [redrays.io](https://redrays.io).