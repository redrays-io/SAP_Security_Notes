1676754 - Unauthorized modification of BSP in Webdocuments

**SAP Note Details**

- **Number:** 1676754
- **Type:** SAP Security Note
- **Version:** 3
- **Recency:** Updated
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 03.03.2016
- **Component:** Industry-Specific Components > Automotive > Dealer Portal > Vehicle Management System WebFrontend (IS-A-DP-VMS)

**Description**

### Symptom
This security note has been updated. For more detailed information, see [Security Note 2071329](https://me.sap.com/notes/0002071329).

The Webdocuments can be abused by malicious users allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

### Reason and Prerequisites
The Webdynpro class `CL_DEF_IM_DPVMS_BADI_MODEL` does not sufficiently encode OUTPUT parameters, resulting in a cross-site scripting (XSS) issue.

Cross-site scripting can be used to steal another user's authentication information, such as data relating to their current session. A malicious user who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user.

If an administrator is impersonated, the security of the application may be fully compromised.

**Required OSS Notes:**
- [1420256 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [1505976 - Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)
- [1509753](https://me.sap.com/notes/1509753) *(Replace with actual link if available)*

### Solution
Apply this note or import the changes via the relevant [support package](https://me.sap.com/supportpackage/SAPK-60412INECCDIMP).

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009957142017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001676754?language=en-US&token=B111D513C2C651CD8E0C79D3F0FA9222)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001676754/E/diff)

**Support Packages:**
- **ECC-DIMP 604:** [SAPK-60412INECCDIMP](https://me.sap.com/supportpackage/SAPK-60412INECCDIMP)
- **ECC-DIMP 605:** [SAPK-60509INECCDIMP](https://me.sap.com/supportpackage/SAPK-60509INECCDIMP)
- **ECC-DIMP 606:** [SAPK-60603INECCDIMP](https://me.sap.com/supportpackage/SAPK-60603INECCDIMP)

**Correction Instructions:**
- **Software Component:** ECC-DIMP
- **Number of Correction Instructions:** 3
- [Corrins 0001676754/591](https://me.sap.com/corrins/0001676754/591)

**Preconditions:**
- **Software Component:** ECC-DIMP
- **Valid From:** 604
- **Valid To:** 604
- **SAP Note/KBA:** 1251023
- [Navigation from IPC Web UI to dealerportal causes problems](https://me.sap.com/notes/1251023)
- **Component:** IS-A-DP-VMS

**References**

- [1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [1582867 - Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)

**Side Effects**
This document is causing side effects:
- [2071329 - Update 1 to security note 1676754](https://me.sap.com/notes/0002071329)

*Credits to [redrays.io](https://redrays.io) for providing the information.*