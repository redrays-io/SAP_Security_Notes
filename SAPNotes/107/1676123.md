SAP Security Note 1676123 - Unauthorized modification of ITS in SRM-EBP-INV

**Title:** SAP Security Note 1676123 - Unauthorized modification of ITS in SRM-EBP-INV

**Description:**

### Symptom
SRM-EBP-INV can be exploited by a malicious user to modify displayed application content without proper authorization. This vulnerability allows the potential theft of authentication information from other legitimate users.

### Other Terms
- **Cross-site scripting (XSS)**
- **SRM-EBP-INV**

### Reason and Prerequisites
The ITS Services (BBPIV01 to BBPIV09) within SRM-EBP-INV do not sufficiently encode output parameters, resulting in a cross-site scripting issue. This vulnerability can be leveraged to steal another user's authentication information, such as session data. An attacker with access to this data can impersonate the user, potentially compromising the entire application's security.

### Impact
If an administrator is impersonated, the security of the entire application may be fully compromised, allowing unauthorized access to sensitive information and functionalities.

### Solution
1. **Apply Prerequisite Note:**
   - **SAP Note 1655802** must be applied to your system before addressing this vulnerability.

2. **Implement the Security Note:**
   - Apply SAP Security Note 1676123 directly or import the changes via the relevant support package.

3. **Manual Correction Steps:**
   - **Start Transaction SICF:**
     Navigate to the service path `/sap/bc/gui/sap/its/`.
   - **Configure Services:**
     - Double-click on each service (e.g., `bbpiv01`).
     - Click on the **'GUI Configuration'** button for SRM 5.0 and higher or the **'Settings'** button for SRM 4.0.
     - Add the following service parameters:
       - `~auto_html_escaping` with value `1`
       - `~new_xss_functions` with value `1`
     - Save the entry.
   - **Repeat for All Services:**
     Ensure these steps are performed for `BBPIV02`, `BBPIV03`, `BBPIV04`, `BBPIV05`, `BBPIV06`, `BBPIV08`, and `BBPIV09`.

**Support Packages:**
Ensure that your system is updated with the appropriate support packages for your software component versions:

| Software Component Version | Support Package                    | URL                                                             |
| -------------------------- | ---------------------------------- | ---------------------------------------------------------------- |
| SRM_SERVER 500             | SAPKIBKS18                         | [SAPKIBKS18](https://me.sap.com/supportpackage/SAPKIBKS18)      |
| SRM_SERVER 550             | SAPKIBKT21                         | [SAPKIBKT21](https://me.sap.com/supportpackage/SAPKIBKT21)      |
| SRM_SERVER 600             | SAPKIBKU06                         | [SAPKIBKU06](https://me.sap.com/supportpackage/SAPKIBKU06)      |
| SRM_SERVER 700             | SAPKIBKV13                         | [SAPKIBKV13](https://me.sap.com/supportpackage/SAPKIBKV13)      |
| SRM_SERVER 701             | SAPK-70109INSRMSRV                  | [SAPK-70109INSRMSRV](https://me.sap.com/supportpackage/SAPK-70109INSRMSRV) |
| SRM_SERVER 702             | SAPK-70204INSRMSRV                  | [SAPK-70204INSRMSRV](https://me.sap.com/supportpackage/SAPK-70204INSRMSRV) |

**References:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009953182017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001676123?language=en-US&token=0B7B6EDFCE76B9BEE060243CED049D1C)

**Credits:**
Information provided by [Redrays.io](https://redrays.io).