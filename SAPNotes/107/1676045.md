SAP Security Note 1676045 - Unauthorized modification of displayed content in APM

**SAP Security Note 1676045 - Unauthorized modification of displayed content in APM**

**Symptom**

The following ITS services can be abused by a malicious user, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users:
- BBP_MON_SC
- BBPSUBSCRIBE
- BBP_MS_ACC_DET
- BBP_MS_BE_C
- BBP_MS_MAP_TAX
- BBP_MS_STD_ACC

**Other Terms**

- Cross-site scripting (XSS)

**Reason and Prerequisites**

The ITS Service within the above services does not sufficiently encode output parameters, resulting in a cross-site scripting issue. This vulnerability can be exploited to steal another user's authentication information, such as data relating to their current session. A malicious user who gains access to this data may impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**

Please implement the manual instructions in this note or import the changes via the relevant support package. The corrections of this note only have a protecting effect if the corrections of [Note 1621946](https://me.sap.com/notes/1621946) and [Note 1488500](https://me.sap.com/notes/1488500) are implemented.

**Software Components Affected**

- **SRM_SERVER** versions:
  - 500
  - 550
  - 600
  - 700
  - 701
  - 702

**Support Packages**

| Software Component Version | Support Package                            | URL                                        |
|----------------------------|--------------------------------------------|--------------------------------------------|
| SRM_SERVER 500             | SAPKIBKS18                                 | [Download](https://me.sap.com/supportpackage/SAPKIBKS18) |
| SRM_SERVER 550             | SAPKIBKT20                                 | [Download](https://me.sap.com/supportpackage/SAPKIBKT20) |
| SRM_SERVER 600             | SAPKIBKU06                                 | [Download](https://me.sap.com/supportpackage/SAPKIBKU06) |
| SRM_SERVER 700             | SAPKIBKV12                                 | [Download](https://me.sap.com/supportpackage/SAPKIBKV12) |
| SRM_SERVER 701             | SAPK-70108INSRMSRV                          | [Download](https://me.sap.com/supportpackage/SAPK-70108INSRMSRV) |
| SRM_SERVER 702             | SAPK-70203INSRMSRV                          | [Download](https://me.sap.com/supportpackage/SAPK-70203INSRMSRV) |

**Correction Instructions**

1. Go to transaction SE38.
2. Enter the report name `ZITS_XSRF_PARAM_APM_ACC_TAX`.
3. Enter the title "ITS service parameter change - APM, ACC, TAX".
4. Select the Attribute Type as 'Executable program'.
5. Click on Save.
6. Implement the attached correction instructions.
7. Execute this report to set the service parameters.

**Side Effects**

This document is causing side effects for [SAP Note 1655802 - Javascript error on invoice screen](https://me.sap.com/notes/1655802).

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009952682017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001676045?language=en-US&token=F9993BCE12503A70CA64FFB1C26F19D0)
- [Share by Email](https://me.sap.com/notes/0001676045/SEND_EMAIL)
- [Open in New Window](https://me.sap.com/notes/0001676045/OPEN_NEW_WINDOW)
- [Edit](https://me.sap.com/sap/support/notes/edit/0001676045)
- [Show Changes](https://me.sap.com/notes/0001676045/compare)

*Credits to [Redrays.io](https://redrays.io) for supporting this information.*