SAP Security Note 1676848 - Unauthorized modification of BSP in CRM-IC-OBJ

**Description**

**Symptom**
Application Component CRM-IC-OBJ can be abused by a malicious user, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

**Other Terms**
Cross-site scripting (XSS), CRM-IC-OBJ

**Reason and Prerequisites**
BSP Page `CRM_IC_AUTO/RuntimeRepository.xml` within Application Component CRM-IC-OBJ does not sufficiently encode OUTPUT parameters, resulting in a cross-site scripting issue.

Cross-site scripting can be used to steal another user's authentication information, such as data relating to their current session. A malicious user who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user.

If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**
Please apply this note or import the changes via the relevant support package.

**Correction Instructions**

_Valid for Software Component BBPCRM in Release 701 with Support Package SAPKU70103 - SAPKU70108_

1. **Comment out the following XML files:**
   - `VEHMNAVIGATIONALLINKS1RT.xml`
   - `VEHMNAVIGATIONALLINKS2RT.xml`
   - `VEHMNAVLINKSEVENTHISTORYRT.xml`

2. **Steps to Comment Out Files:**
   1. Go to transaction SE80.
   2. Provide BSP Application `CRM_IC_AUTO`.
   3. Expand the node **Page Fragments**.
   4. Double-click on each of the XML files listed above and comment out the source code using the following syntax template:
      ```xml
      <%-- Source Code here --%>
      ```

**References**
- [SAP Note 1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)
- [SAP Note 1582867 - Security options (XSS) for ESCAPE](https://me.sap.com/notes/1582867)

**Support Package Information**
- **BBPCRM 510:** [SAPKU51006](https://me.sap.com/supportpackage/SAPKU51006)
- **BBPCRM 520:** [SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011)
- **BBPCRM 600:** [SAPKU60012](https://me.sap.com/supportpackage/SAPKU60012)
- **BBPCRM 700:** [SAPKU70012](https://me.sap.com/supportpackage/SAPKU70012)
- **BBPCRM 701:** [SAPKU70109](https://me.sap.com/supportpackage/SAPKU70109)
- **BBPCRM 702:** [SAPKU70203](https://me.sap.com/supportpackage/SAPKU70203)

**CVSS**
- **Score:** 0
- **Vector:** N/A

**Preconditions**
- Software Component: BBPCRM
- Release: 701
- SAP Note/KBA: [1676848](https://me.sap.com/notes/1676848)
- Component: CRM-IC-OBJ

**Credits**
Thanks to [RedRays.io](https://redrays.io) for supporting the provision of this information.