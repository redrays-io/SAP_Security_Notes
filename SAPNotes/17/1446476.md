SAP Security Note 1446476 - SMBRelay in SAP ALV

**Description**

**Symptom**

The ALV contains a vulnerability that makes it possible for a malicious user to perform an SMBRelay attack. An attacker may use this to obtain control over the computer of the user in the worst case scenario.

**CVSS Information**

- **CVSS Base Score:** 2.3
- **CVSS Base Vector:** AV:A/AC:M/AU:S/C:P/I:N/A:N

This CVSS Base Score provided by SAP is used to estimate the risk posed by the issue reported in this SAP Note. However, this estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/).

**Other Terms**

SMBRelay, SMB, Relay, ALV

**Reason and Prerequisites**

The SAP ALV fails to correctly validate UNC paths that are used to reference files that are read from remote servers. An attacker may use this vulnerability by redirecting the user to a compromised SMB share.

**Solution**

Implement the source code corrections in accordance with the [correction instructions](https://me.sap.com/corrins/0001446476/41).

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008532792017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001446476?language=en-US&token=2795BD572E4AD9E4DD9391146C5B43EA)
- [Share by Email](https://me.sap.com/)
- [Open in New Window](https://me.sap.com/)

**Attributes**

- **Externally Reported:** Yes

**Supported Software Components**

- **SAP_BASIS**
  - From version 640 to 640
  - From 700 to 702
  - From 710 to 730

**Support Packages**

- [SAPKB64032](https://me.sap.com/supportpackage/SAPKB64032) for SAP_BASIS 640
- [SAPKB70023](https://me.sap.com/supportpackage/SAPKB70023) for SAP_BASIS 700
- [SAPKB70108](https://me.sap.com/supportpackage/SAPKB70108) for SAP_BASIS 701
- [SAPKB70205](https://me.sap.com/supportpackage/SAPKB70205) for SAP_BASIS 702
- [SAPKB71011](https://me.sap.com/supportpackage/SAPKB71011) for SAP_BASIS 710
- [SAPKB71106](https://me.sap.com/supportpackage/SAPKB71106) for SAP_BASIS 711
- [SAPKB72003](https://me.sap.com/supportpackage/SAPKB72003) for SAP_BASIS 720
- [SAPKB72004](https://me.sap.com/supportpackage/SAPKB72004) for SAP_BASIS 720
- [SAPKB73001](https://me.sap.com/supportpackage/SAPKB73001) for SAP_BASIS 730

**References**

- **This document refers to:**
  - [Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889) for Component SV-SMG-SER

- **This document is referenced by:**
  - [Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889) for Component SV-SMG-SER

Credits to [Redrays.io](https://redrays.io) for support in providing this information.