SAP Security Note 1445998: Disabling Invoker Servlet

### Symptom

- You want to disable the default servlet mapping `/servlet/*`.
- Servlets can be accessed anonymously via different paths regardless of security constraints defined in the `web.xml`. Servlets that are not declared in the `web.xml` at all can also be accessed successfully.

### Reason and Prerequisites

A vulnerable feature in the Web Container allows invocation of special URLs that cause servlet execution. This method does not obey the rules defined in the `web.xml`.

### Solution

The Invoker Servlet has been disabled by default in version 7.20 (in the patch levels described in the SP Patch Level section) and in the initial shipment of version 7.30 of the Engine. For these versions, apply the following steps:

1. **Upgrade** to the latest version of SAP Java Engine. Refer to the [SP Patch Level](https://me.sap.com/notes/1445998#support-package-patch) section of this SAP Note for details.
2. **Identify** whether any requested scenarios rely on the Invoker Servlet.

For all other versions, additionally:

3. **Disable** the vulnerable feature by setting the `EnableInvokerServletGlobally` property of the `servlet_jsp` service on the server nodes to `false`.

Refer to the attached [PDF](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000004142010&iv_version=0005&iv_guid=3939AACB73BAD948BC9B8B783C5559EE) for detailed identification and mitigation steps.

### Attachments

- [Disabling InvokerServlet.pdf](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000004142010&iv_version=0005&iv_guid=3939AACB73BAD948BC9B8B783C5559EE)
- [Disabling InvokerServlet_Japanese.zip](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000004142010&iv_version=0005&iv_guid=6CAE8B3EA1851ED68E8B8200EA9980C8)
- [Disabling InvokerServlet_Japanese.z02](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000004142010&iv_version=0005&iv_guid=6CAE8B3E8C4C1ED68E8B85A9774F80C5)
- [Disabling InvokerServlet_Japanese.z01](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000004142010&iv_version=0005&iv_guid=6CAE8B3EAE551ED68E8B88403481C0C8)

### References

- [SAP Note 1802092: PDF display error due to invoker servlet disabled in NW 7.3](https://me.sap.com/notes/1802092)
- [SAP Note 1625314: HTTP verb tampering issue in BRMS-CORE](https://me.sap.com/notes/1625314)
- [SAP Note 1624360: HTTP verb tampering issue in DI_DTR](https://me.sap.com/notes/1624360)
- [SAP Note 1624182: HTTP verb tampering issue in CBS](https://me.sap.com/notes/1624182)
- [SAP Note 1623895: Missing authentication check in Usage Types Viewer](https://me.sap.com/notes/1623895)
- [SAP Note 1617369: Verb Tampering issues in CMS](https://me.sap.com/notes/1617369)
- [SAP Note 1616259: Briefing at Black Hat conference on August 4th, 2011](https://me.sap.com/notes/1616259)
- [SAP Note 1611873: Verb Tampering issues in CM Services](https://me.sap.com/notes/1611873)
- [SAP Note 1598246: Servlet declaration missing for LWC SOAP Dispatcher servlet](https://me.sap.com/notes/1598246)
- [SAP Note 1590689: PI SEC: HTTP verb tampering issue in AF Application](https://me.sap.com/notes/1590689)
- [SAP Note 1537663: Biller Direct, Security - Invoker Servlet](https://me.sap.com/notes/1537663)
- [SAP Note 1535301: Invoker Servlet Fix for IS-M/AMC](https://me.sap.com/notes/1535301)
- [SAP Note 1511415: Disabling Invoker Servlet in Tomcat](https://me.sap.com/notes/1511415)
- [SAP Note 1488846: CRM ECO. Security - Invoker Servlet](https://me.sap.com/notes/1488846)
- [SAP Note 1467771: Disabling invoker servlet in the portal](https://me.sap.com/notes/1467771)
- [SAP Note 1463661: Open SQL monitors: Servlets cannot be loaded](https://me.sap.com/notes/1463661)
- [SAP Note 1460635: RWB link "Index Administration" shows error 403 - forbidden](https://me.sap.com/notes/1460635)
- [SAP Note 1423130: Central Note for Portal Platform in SAP NW7.0 EhP1 SP6](https://me.sap.com/notes/1423130)
- [SAP Note 1373989: SAP NetWeaver Portal Platform NW701, EhP1 SP5](https://me.sap.com/notes/1373989)
- [SAP Note 1299552: SAP NetWeaver Portal Platform NW701, EhP1 SP4](https://me.sap.com/notes/1299552)
- [SAP Note 1258416: SAP NetWeaver Portal Platform NW701, EhP1 SP3](https://me.sap.com/notes/1258416)

_Credits to [Redrays.io](https://redrays.io) for support in providing information._