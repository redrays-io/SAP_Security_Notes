1448007 - Cross-Site Request Forgery Attack

**Overview**

SAP has released Security Note **1448007** addressing a Cross-Site Request Forgery (CSRF) vulnerability in the **Enterprise Performance Management > Business Planning and Consolidation > Microsoft Version (EPM-BPC-MS)** component. This vulnerability allows malicious users to execute certain functions without proper authentication and authorization.

**Details**

- **SAP Note Number:** 1448007
- **Type:** SAP Security Note
- **Component:** Enterprise Performance Management > Business Planning and Consolidation > Microsoft Version (EPM-BPC-MS)
- **Released On:** August 12, 2010
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Version:** 3

**Symptom**

A malicious user can trigger functionality in BPC MS without authentication and authorization.

**Cause and Prerequisites**

BPC MS executes certain functions through specific URLs. An attacker can trick an authenticated user's browser into making requests with specific parameters, causing functions to execute with the user's privileges. This can be exploited via CSRF or potentially combined with Cross-Site Scripting (XSS) attacks.

**Solution**

The issue is corrected in **75M SP2 Patch1**. After installing the service pack, follow these steps:

1. **Define the "AllowedSite" Parameter in Web.config**

   Add the following configuration to the `Web.config` file on each web server:

   ```xml
   <configuration>
     <appSettings>
       <add key="AllowedSite" value="www.yahoo.com,www.google.com" />
     </appSettings>
   </configuration>
   ```

   - **Requirements:**
     - Define this parameter on each WebServer.
     - List all allowed fully qualified domain names separated by commas (`,``).
     - Do **not** use wildcard characters (e.g., `*.yahoo.com`).
     - Host names must include the full host header name (e.g., `www.yahoo.com,www1.yahoo.com,hosting.yahoo.com`).

**References**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016993482017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001448007?language=en-US&token=1E5E9E26E85A0B8AC3ECECDA8C2CA227)
- [Compare Versions](https://me.sap.com/notesLatestChanges/0001448007/E/diff)

**Additional Information**

- **Translations Available:** The security note is available in multiple languages, including Deutsch, 日本語, Português, Español, Français, Italiano, Русский, 中文, and 한국어 (Machine Translation).
- **References to Other Notes:**
  - [1456848 - Planning and Consolidation 75M SP2 Patch2](https://me.sap.com/notes/1456848)
  - [1448569 - Planning and Consolidation 75M SP2 Patch1](https://me.sap.com/notes/1448569)

**Credits**

Information supported by [RedRays](https://redrays.io).