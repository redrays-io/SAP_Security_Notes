1507735 - Unauthorized execution of functions in IS-Media

**SAP Security Note 1507735**

**Type:** SAP Security Note  
**Version:** 6  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 13.11.2015  
**Component:** Industry-Specific Components > Media (IS-M)  
**Language:** English  
**Master Language:** German  

### Symptom
A malicious user can execute functions in IS-Media without authentication and authorization.

### Other Terms
- Cross Site Request Forgery (XSRF)
- Business Server Page (BSP)
- SAP Internet Transaction Server (ITS)
- Internet Application Component (IAC)

### Reason and Prerequisites
IS-Media executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the functions in IS-Media are executed with the rights of the authenticated user. The malicious user may use a cross-site scripting attack to do this, or they may present a link to the victim.

### Solution
1. **Import the relevant Support Package.**

2. **If you want to implement an advanced correction up to and including IS-M 604, perform the following steps:**
   - **Prerequisites:**
     - **Are you using BSP applications?**  
       Implement [Note 1520324](https://me.sap.com/notes/1520324). Pay particular attention to the manual step described there.
     - **Are you using ITS applications?**  
       Implement [Note 1481392](https://me.sap.com/notes/1481392). Pay particular attention to the manual step described there.
     
   - **Use the Note Assistant (transaction SNOTE) to implement the corrections contained in this note.**
   
   - **Manual post-implementation steps:**
     - **For BSP applications:**  
       Execute the report `RJ_BSP_XSRF_PARAM_ISM_606` to correct these BSP applications.
     - **For ITS applications (IACs):**  
       Execute the report `RJ_ITS_XSRF_PARAM_ISM_606` to correct these ITS applications.

### References
- [1540729: ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)
- [1520324: Advance creation of XSRF information](https://me.sap.com/notes/1520324)
- [1481392: Cross Site Request Forgery Protection for ITS](https://me.sap.com/notes/1481392)

### Affected Software Components
- **IS-M** versions 471 to 605

### Support Packages
- **IS-M 471:** [SAPKIPPM26](https://me.sap.com/supportpackage/SAPKIPPM26), [SAPKIPPM27](https://me.sap.com/supportpackage/SAPKIPPM27)
- **IS-M 472:** [SAPKIPPN20](https://me.sap.com/supportpackage/SAPKIPPN20), [SAPKIPPN21](https://me.sap.com/supportpackage/SAPKIPPN21)
- **IS-M 600:** [SAPK-60019INISM](https://me.sap.com/supportpackage/SAPK-60019INISM)
- **IS-M 602:** [SAPK-60209INISM](https://me.sap.com/supportpackage/SAPK-60209INISM)
- **IS-M 603:** [SAPK-60308INISM](https://me.sap.com/supportpackage/SAPK-60308INISM)
- **IS-M 604:** [SAPK-60409INISM](https://me.sap.com/supportpackage/SAPK-60409INISM)
- **IS-M 605:** [SAPK-60503INISM](https://me.sap.com/supportpackage/SAPK-60503INISM)

For more details and to download the note, visit the [SAP Support Portal](https://me.sap.com/notes/1507735).

**Credits:** Information provided by [Redrays.io](https://redrays.io).