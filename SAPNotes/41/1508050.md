1508050 - Potential modification of persisted data in BCONS Connector

**SAP Security Note 1508050 - Potential modification of persisted data in BCONS Connector**

- **Type:** SAP Security Note
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** December 14, 2010
- **Component:** Financial Supply Chain Management > Billing Consolidation > Billing Consolidation Connectors (FIN-FSCM-BC-CON)

### Description

#### Symptom
A malicious user can exploit BCONS Connector and use specially crafted inputs to modify database commands, resulting in the modification of data persisted by the system.

#### Other Terms
SQL Injection, database, EDX, Billing Consolidation, BCONS Connector

#### Reason and Prerequisites
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement including strings that can be altered by a malicious user. The manipulated SQL statement can then be used to modify information in the database.

#### Solution
Due to the complexity of the changes and the number of correction instructions, it is strongly recommended to import the relevant Support Package.

The following Support Packages (SPs) contain the corrections:

- **Release Support Package 604:** [SAPKH06409](https://me.sap.com/supportpackage/SAPKH06409)
- **Release Support Package 605:** [SAPKH60503](https://me.sap.com/supportpackage/SAPKH60503)

If this note is to be implemented in advance, perform the following manual steps (if automatic implementation is not possible):

1. **Create Text Symbols in Report EDX_DEL:**
   - **B01**
     - Text: "Status Selection"
     - Length: 100
   - **B02**
     - Text: "Processing"
     - Length: 100
   - **B03**
     - Text: "Message selection"
     - Length: 100
   - **B04**
     - Text: "To delete from table EDX_PARK"
     - Length: 100
   - **T05**
     - Text: "&1 message(s) deleted"
     - Length: 100

2. **Complete Selection Texts:**
   - **P_DOCTYP**
     - Text: "Message type"
     - Dictionary reference: not checked
   - **P_TEST**
     - Text: "Test System!"
     - Dictionary reference: not checked

3. **Handle Authorization Issues:**
   - If unable to activate Report EDX_DEL due to missing classes (e.g., EDX_AUTHORIZATION or method CHECK_FOR_AUTHORIZED_MSGS in class EDX_PROCESS_DOCSET), uncomment these classes in the DATA declaration and their usage in the code.

4. **Save and Activate Changes.**

### Downloads

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008935442017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001508050?language=en-US&token=004AE1F1C70A7CF7778980635B80D5B8)

### Support Packages

- [SAPKH06409](https://me.sap.com/supportpackage/SAPKH06409)
- [SAPKH60503](https://me.sap.com/supportpackage/SAPKH60503)

*Credits to [Redrays](https://redrays.io) for support to provided information.*