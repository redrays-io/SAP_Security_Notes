SAP Security Note 1507940 - Unauthorized usage of application functionality in FI-AR/AP

### Symptom
A malicious user can trigger functionality in FI-AR/FI-AP without authentication and authorization.

### Other Terms
Cross-Site Request Forgery, XSRF

### Reason and Prerequisites
FI-AR/FI-AP executes certain functions through referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the user.

If present, the attacker may use a Cross Site Scripting attack to trigger the exploit, or use an approach in which a link to click is presented to the victim.

### Solution
1. Refer to [Note 1481392](https://me.sap.com/notes/1481392) for additional information and instructions. The corrections from note 1481392 are a prerequisite for implementation of this note.

2. Implement the correction instructions of this note. This will also create the report `ITS_XSRF_PARAM__FIAP_AR_ALL` of the application component in your system.

3. Execute the report `ITS_XSRF_PARAM_FIAP_AR_ALL` of the application component and specify a corresponding transport request number when requested. The report will add service parameters for the adapted ITS services (maintained via the GUI configuration pushbutton for a service within transaction SICF).

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008934752017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001507940?language=en-US&token=2A5E56134D89086B255D2532806B3D96)
- [Share by Email](https://me.sap.com/notes/1507940/share)
- [Open in New Window](https://me.sap.com/notes/1507940/open-new-window)

### References
- **This document refers to:** [1515184 - Composite SAP Note: Security for FI-AR/FI-AP](https://me.sap.com/notes/1515184)
- **This document is referenced by:** [1515184 - Composite SAP Note: Security for FI-AR/FI-AP](https://me.sap.com/notes/1515184)

### Validity
Supported in the following Software Components:
- SAP_APPL 500
- SAP_APPL 600
- SAP_APPL 602
- SAP_APPL 603
- SAP_APPL 604
- SAP_APPL 605

### Support Packages
Refer to the [Support Package Details](https://me.sap.com/supportpackage/SAPKH50025) for your specific software component version.

### Correction Instructions
- [Correction Instruction 1](https://me.sap.com/corrins/0001507940/1)

For more details, visit the [official SAP Notes page](https://me.sap.com/notes/1507940).

*Credits to [RedRays.io](https://redrays.io) for support and information provision.*