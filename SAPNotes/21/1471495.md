SAP Security Note 1471495 - Directory Traversal in report CRM_LEAS_MIGRATE_BILS

**SAP Security Note 1471495**  
**Type:** SAP Security Note  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** December 14, 2010

**Component:** CRM-LAM-BTX-BE  
(Customer Relationship Management > Leasing > Leasing: Business Transaction Leasing > Billing of Leasing Contracts)

### Description

#### Symptom
Report `CRM_LEAS_MIGRATE_BILLS` contains a vulnerability that allows a malicious user to potentially read arbitrary files on the remote server, potentially disclosing confidential information.

Additionally, `CRM_LEAS_MIGRATE_BILLS` is no longer necessary as there are no customers migrating from SD billing to CRM Billing for the Leasing scenario.

#### Other Terms
- Directory Traversal
- CRM_LEAS_MIGRATE_BILLS

#### Reason and Prerequisites
The report `CRM_LEAS_MIGRATE_BILLS` fails to correctly validate the file path used to reference files from the remote server. This allows an attacker to direct the program to access arbitrary files on the system, leading to information disclosure.

### Solution
Apply the provided correction instructions to mitigate the vulnerability.

- [Download Correction Instructions](https://me.sap.com/corrins/0001471495/63)

### Affected Software Components
- **BBPCRM** versions 400, 500, 510, 600, 700, 701

### Support Packages
Ensure the application of the relevant support packages for your BBPCRM version:
- [SAPKU40018](https://me.sap.com/supportpackage/SAPKU40018) for BBPCRM 400
- [SAPKU50017](https://me.sap.com/supportpackage/SAPKU50017) for BBPCRM 500
- [SAPKU51006](https://me.sap.com/supportpackage/SAPKU51006) for BBPCRM 510
- [SAPKU60008](https://me.sap.com/supportpackage/SAPKU60008) for BBPCRM 600
- [SAPKU70007](https://me.sap.com/supportpackage/SAPKU70007) for BBPCRM 700
- [SAPKU70102](https://me.sap.com/supportpackage/SAPKU70102) for BBPCRM 701

### Preconditions
Before applying this security note, ensure the following SAP Notes are implemented:
- [SAP Note 677463](https://me.sap.com/notes/677463) - Migration of bills and related objects (3.20 â†’ 4.0)
- [SAP Note 863322](https://me.sap.com/notes/863322) - Leasing transaction: Billing Engine

---

*Credits to [Red Rays](https://redrays.io) for support in providing this information.*