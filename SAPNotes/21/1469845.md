SAP Security Note 1469845 - Missing authorization check in RMA

**SAP Note Number**: 1469845  
**Title**: Missing authorization check in RMA  
**Type**: SAP Security Note  
**Version**: 3  
**Release Date**: July 13, 2010  
**Category**: Program error  
**Priority**: Correction with medium priority  
**Status**: Released for Customer  
**Component**: [EA-RETAIL](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'IS-R-LG-RMA*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

### Description
**Symptom**  
Certain functions of the Retail Method of Accounting (RMA) can be called without the required authorization. This may result in an escalation of privileges.

**Other Terms**  
Authorization, authorization check, stock ledger, Retail Method of Accounting (RMA).

**Reason and Prerequisites**  
This note is relevant only if the business function `ISR_RETAIL_RMA` has been activated. In the RMA, authorization checks that regulate access to functions are missing. A user that is logged on can simply call these functions without these checks, potentially leading to unauthorized changes in system behavior.

### Solution
A new role `SAP_ISR_RMA_ADMINISTRATOR` is delivered with the following Support Package levels:
- **ECC 6.05** Support Package 02
- **ECC 6.04** Support Package 07
- **ECC 6.03** Support Package 07

**Correction Instructions** for ECC 6.05 and 6.04 are available [here](https://me.sap.com/corrins/0001469845/167). Note the following manual tasks:

1. **Create Transaction S_E5R_84000137** as a parameter transaction:
   - **Package**: WRF_ORGPRICE_DDIC
   - **Transaction Text**: Data Transfer Table WRF_ORGPRICE
   - **Transaction**: START_REPORT
   - **Skip Initial Screen**
   - **Inherit GUI Attributes**
   - **Professional User Transaction**
   - **GUI Support**: SAP GUI for HTML, SAP GUI for Java, SAP GUI for Windows
   - **Default Values**:
     - `D_SREPOVARI-REPORTTYPE`
     - `D_SREPOVARI-REPORT  RWRF_ORGPRICE_SETUP`

2. **Create the Role `SAP_ISR_RMA_ADMINISTRATOR`**:
   - **Description**: RMA Administrator
   - **Menu**:
     - Transaction `WRMA_CHECK`
     - Folder for RMA inbound with transactions:
       - `WRMA_WRART`
       - `WRMA_NO_DOC`
       - `WRMA_VALUES`
       - `WRMA_DATA_DISPLAY`
     - Folder for Original Price with transactions:
       - `S_E5R_84000137`
       - `WRF_ORGPR_MAINTAIN`

### Affected Software Components
- **EA-RETAIL** versions 603, 604, 605

### Support Package Information
- **EA-RETAIL 603**: [SAPK-60307INEARETAIL](https://me.sap.com/supportpackage/SAPK-60307INEARETAIL)
- **EA-RETAIL 604**: [SAPK-60407INEARETAIL](https://me.sap.com/supportpackage/SAPK-60407INEARETAIL)
- **EA-RETAIL 605**: [SAPK-60502INEARETAIL](https://me.sap.com/supportpackage/SAPK-60502INEARETAIL)

### Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008695022017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001469845?language=en-US&token=1420D76919EB1ACF9F9FAA2BE47EE7BC)

### Prerequisites
- Business function `ISR_RETAIL_RMA` must be activated.

**Credits**: [redrays.io](https://redrays.io) for support in providing the information.