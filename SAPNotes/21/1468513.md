1468513 - Unauthorized execution of functions in Web Survey

**Overview**
- **SAP Note Number:** 1468513
- **Type:** SAP Security Note
- **Version:** 28
- **Recency:** Updated
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** June 24, 2011
- **Component:** CA-SUR (Cross-Application Components > Web Survey)

**Description**

### Symptom
This security note has been updated. For details, see [security note 1603701](https://me.sap.com/notes/1603701).

1. An attacker can execute Web Survey functions without the relevant authentication and authorization.
2. The Web Survey could be abused by a malicious user, who could modify displayed application content without authorization and potentially obtain authentication information from other legitimate users.

### Other Terms
Cross Site Request Forgery, XSRF, Reflected Cross-Site Scripting, XSS, Web Survey, BBP_EVAL_SURVEY, ROS_QSTN_SURVEY, CRM Web request

### Reason and Prerequisites
1. A Web Survey executes functions by calling certain URLs with parameters. If an attacker succeeds in getting the browser of a logged-on user to execute arbitrary inquiries, the attacker can call functions in the Web Survey with the rights of the user. To do so, an attacker can exploit a cross-site scripting vulnerability or introduce a special link to the user in the form of an e-mail, for example.
2. Since there is no sufficient input validation by BSP in Web Survey, this results in a reflected cross-site scripting issue. A reflected cross-site scripting attack can be used to non-permanently deface or modify displayed content from a web site. Reflected cross-site scripting can be used to steal another user's authentication information, such as data relating to their current session. An attacker who gains access to this data could use it to impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the applicationâ€™s security could be fully compromised.

**Solution**
1. For more information and instructions, see [Note 1520324](https://me.sap.com/notes/1520324). Before you implement this note, you must implement the corrections contained in Note 1520324 in your system.
2. Implement the attached correction instructions that correspond to your release. As a result, the report `BSP_XSRF_PARAM_UWS_FORM` is also created in your system.
3. Execute the report `BSP_XSRF_PARAM_UWS_FORM` and when requested, specify a relevant transport request number. The report fills the database table `BSPTEMPXSRFSTORE` with the relevant table entries for BSP applications that are adjusted by this note.

**Actions**
- [Mark as Favorite](#) / [Unmark as Favorite](#)
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008687702017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001468513?language=en-US&token=5665D4D58B509D7B4455C94D151C0C48)
- [Share by Email](#)
- [Open in New Window](#)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001468513/E/diff)

**References**
- [1607006 - Survey: "CALLED_BY_PUBLIC_SERVICE" in BSP application](https://me.sap.com/notes/1647006)
- [1609287 - Unauthorized modification of displayed content in Websurvey](https://me.sap.com/notes/1609287)
- [1603701 - Update #1 to Security Note 1468513](https://me.sap.com/notes/1603701)
- [1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)
- [1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)
- [887168 - BSP Page Directive <%@page forceEncode="html"%> & <%html=%>](https://me.sap.com/notes/887168)

**Validity**
This security note is applicable to the following software components and versions:
- **SAP_ABA:** 620, 640, 700 to 702, 710 to 711, 730

**Support Packages**
Relevant support packages can be found [here](https://me.sap.com/supportpackage/SAPKA62069).

**Correction Instructions**
7 correction instructions are available for SAP_ABA. [View Correction Instructions](https://me.sap.com/corrins/0001468513/44)

For more details and assistance, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [RedRays.io](https://redrays.io) for support and provided information.*