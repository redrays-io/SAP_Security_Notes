SAP Security Note 2203591 - TREX/BWA Installation Vulnerability via RFC-Gateway

---

**Title:**  
2203591 - TREX/BWA installation can be attacked via RFC-Gateway

**Description:**  
A vulnerability exists in TREX and BWA installations connected to NetWeaver through RFC connections. Depending on the RFC Gateway settings, an attacker can execute actions such as reading metadata and business data, writing information, or executing OS commands on the TREX/BWA host.

**CVSS Information:**  
- **Base Score:** 7.6/10  
- **Vector:**  
  - **Attack Vector (AV):** Network (N)  
  - **Attack Complexity (AC):** High (H)  
  - **Privileges Required (PR):** None (N)  
  - **User Interaction (UI):** None  
  - **Confidentiality Impact (C):** Complete (C)  
  - **Integrity Impact (I):** Complete (C)  
  - **Availability Impact (A):** Complete (C)

**Affected Systems:**  
This vulnerability affects the following versions:  
- **NetWeaver Releases:** 7.00 to 7.40  
- **TREX Versions:** 7.00, 7.10  
- **BWA Versions:** 7.00, 7.20

**Solution:**  
To mitigate this vulnerability, configure the RFC Gateway to restrict communication to only the necessary NetWeaver application servers and TREX/BWA hosts. Follow these steps:

1. **Identify RFC Connection:**
   - For BWA: Use transaction `TREXADMIN` and navigate to Program > Get BIA Rfc Destination.
   - For TREX: Use transaction `SM59` and locate the RFC connection named `TREX_<xxx>` or `FASTSEARCH`.

2. **Create Template Entry in `reginfo`:**
   - Open transaction `SMGW`.
   - Navigate to: Goto > Expert Functions > External Security > Create (reginfo).
   - Select the relevant RFC destination and save the entries.

3. **Edit `reginfo` File on OS Level:**
   - Locate the `reginfo` file, typically found at `/usr/sap/<SID>/<INSTANCE>/data/reginfo`.
   - Modify the entries to restrict access to specific hostnames or IP addresses.
   - **Important:** Ensure there are no wildcard entries like `P TP=* HOST=* CANCEL=* ACCESS=*` as they pose security risks.

4. **Activation and Testing:**
   - In transaction `SMGW`, navigate to: Goto > Expert Functions > External Security > Reread (global).
   - Restart RFC Services on all TREX/BWA hosts using the TREXAdmin Standalone Tool.
   - Test the RFC connection by accessing TREX/BWA via `TREXADMIN`.

**Additional Information:**  
For detailed instructions and best practices on securing RFC communications, refer to the [Securing Remote Function Calls (RFC)](https://me.sap.com/docs/DOC-60424) whitepaper available on SAP's security whitepapers page: [SAP Security Whitepapers](https://me.sap.com/securitywp).

**Download & Print:**  
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000013042982017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002203591?language=en-US&token=F100F6BCFF81353929BE06D7DB811BFC)

**Credits:**  
Thanks to [RedRays.io](https://redrays.io) for supporting the provision of this information.