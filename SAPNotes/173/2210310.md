2210310 - Unauthorized use of application functions in NavigationServlet

### Symptom

An attacker can execute functions in NavigationServlet without authentication and authorization.

**CVSS Information**

CVSS v3 Base Score: 6.3 / 10  
CVSS v3 Base Vector:

| **Metric** | **Value** |
|------------|-----------|
| **AV** : Attack Vector | Network (N) |
| **AC** : Attack Complexity | Low (L) |
| **PR** : Privileges Required | None (N) |
| **UI** : User Interaction | Required (R) |
| **S** : Scope | Unchanged (U) |
| **C** : Impact to Confidentiality | Low (L) |
| **I** : Impact to Integrity | Low (L) |
| **A** : Impact to Availability | Low (L) |

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://support.sap.com/securitynotes](https://support.sap.com/securitynotes).

### Other Terms

Cross-site request forgery, XSRF, NavigationServlet

### Reason and Prerequisites

NavigationServlet executes certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user.

The attacker may use a cross-site scripting attack to do this, or they may present a link to the victim.

### Solution

Refer to the Support Package Patch levels to view the versions including the fix. Below are the relevant patches:

| Software Component Version | Support Package | Patch Level | URL |
|----------------------------|-----------------|-------------|-----|
| EP RUNTIME 7.40            | SP005           | 000031      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP005&patch_level=000031) |
| EP RUNTIME 7.20            | SP009           | 000012      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012953&support_package=SP009&patch_level=000012) |
| EP RUNTIME 7.50            | SP002           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP002&patch_level=000000) |
| EP RUNTIME 7.40            | SP012           | 000001      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP012&patch_level=000001) |
| EP RUNTIME 7.50            | SP001           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP001&patch_level=000000) |
| EP RUNTIME 7.40            | SP011           | 000016      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP011&patch_level=000016) |
| EP RUNTIME 7.31            | SP010           | 000031      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP010&patch_level=000031) |
| EP RUNTIME 7.40            | SP013           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP013&patch_level=000000) |
| EP RUNTIME 7.30            | SP014           | 000002      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015108&support_package=SP014&patch_level=000002) |
| EP RUNTIME 7.11            | SP015           | 000003      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006929&support_package=SP015&patch_level=000003) |
| EP RUNTIME 7.30            | SP015           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015108&support_package=SP015&patch_level=000000) |
| EP RUNTIME 7.31            | SP016           | 000019      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP016&patch_level=000019) |
| EP RUNTIME 7.11            | SP016           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006929&support_package=SP016&patch_level=000000) |
| EP RUNTIME 7.31            | SP017           | 000001      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP017&patch_level=000001) |
| EP RUNTIME 7.31            | SP018           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP018&patch_level=000000) |
| EP RUNTIME 7.10            | SP020           | 000003      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006348&support_package=SP020&patch_level=000003) |
| EP RUNTIME 7.10            | SP021           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006348&support_package=SP021&patch_level=000000) |

For downloading the SAP Note, you can use the following links:
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018154612017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002210310?language=en-US&token=DB250B47EC8D4E870E68F53E3E6A1F32)

### Affected Software Components

- **Enterprise Portal > SAP Enterprise Portal (On Premise) > Navigation > Ajax Framework Page**

### References

- This document is referenced by:
  - [2305555 - Collective Note: SAP NetWeaver 7.31 SP18 - Composition Platform](https://me.sap.com/notes/2305555)
  
### Side Effects

This document is causing side effects in the following notes:
- [2273980 - An error occurred while deploying the deployment item 'sap.com_com.sap.portal.lightning.lightningServletEar'](https://me.sap.com/notes/0002273980)
- [2453504 - AFP portal favorites not loading after idle time](https://me.sap.com/notes/0002453504)

---

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*