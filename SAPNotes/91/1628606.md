1628606 - Potential modification of persisted data by RSTRESNC

**Description**

An attacker can exploit the program RSTRESNC and use specially crafted inputs to modify database commands, resulting in the modification of data persisted by the system.

**Other Terms**

- SQL injection
- Database
- RSTRESNC

**Reason and Prerequisites**

The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by an attacker. The manipulated SQL statement can then be used to modify information in the database. This may affect tables that have fields similar to those in the tables TRESN and TRESC.

**Solution**

Import one of the attached requests if the program is in the system. Afterwards, the report may contain syntax errors. You can ignore these errors.

This problem does not occur for Enhancement Package 1 for SAP NetWeaver 7.30. All of the new EHPI and SUM versions also deliver the solution automatically.

**Manual Activities**

1. **SAP Application**
   - **Release 31I:** All Support Package Levels
   - **Release 40A:** Until SAPKH40A25
   - **Release 40B:** All Support Package Levels
   - **Release 45A:** Until SAPKH45A29
   - **Release 45B:** All Support Package Levels

2. **SAP Basis Components**
   - **Release 46C:** All Support Package Levels
   - **Release 46B:** All Support Package Levels
   - **Release 46A:** Until SAPKB46A34
   - **Release 46D:** All Support Package Levels
   - **Release 610:** All Support Package Levels
   - **Release 620:** All Support Package Levels
   - **Release 640:** All Support Package Levels
   - **Release 700:** All Support Package Levels
   - **Release 710:** All Support Package Levels
   - **Release 711:** All Support Package Levels
   - **Release 701:** All Support Package Levels
   - **Release 702:** All Support Package Levels
   - **Release 730:** All Support Package Levels
   - **Release 720:** All Support Package Levels
   - **Release 731:** All Support Package Levels

**Attachments**

- [YI2K080790.SAR](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000303142011&iv_version=0002&iv_guid=7F504A847C2B8B4AAFAD5C4B25B5C155) (6 MB)
- [BIOK017988.SAR](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000303142011&iv_version=0002&iv_guid=3DED19286596FE4AAD486FA91C2A6AFA) (5 MB)

**References**

- [1926261](https://me.sap.com/notes/1926261)
- [1878193](https://me.sap.com/notes/1878193)
- [1843776](https://me.sap.com/notes/1843776)
- [1790828](https://me.sap.com/notes/1790828)
- [1732061](https://me.sap.com/notes/1732061)
- [1707161](https://me.sap.com/notes/1707161)

**Affected Software Components**

| Software Component | From | To  |
|--------------------|------|-----|
| SAP_APPL           | 31I  | 31I |
| SAP_APPL           | 40A  | 40B |
| SAP_APPL           | 45A  | 45B |
| SAP_BASIS          | 46A  | 46D |
| SAP_BASIS          | 610  | 640 |
| SAP_BASIS          | 700  | 702 |
| SAP_BASIS          | 710  | 730 |
| SAP_BASIS          | 731  | 731 |
| SAP_BASIS          | 800  | 802 |

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009668652017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001628606?language=en-US&token=D87FBF626BB2F0ED7414399F71E64B40)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001628606/E/diff)

**Available Languages**

- [Deutsch (Origin)](https://me.sap.com/notes/0001628606/D)
- [日本語](https://me.sap.com/notes/0001628606/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001628606/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001628606/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001628606/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001628606/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001628606/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001628606/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001628606/3)

_Credits to [Redrays](https://redrays.io) for support and information._