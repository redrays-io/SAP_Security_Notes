1606267 - Unauthorized use of application functions in ERMS Web Forms

**Description**

A malicious user can execute functions in the ERMS Web Form Connector without authentication and authorization.

**Other Terms**

Cross-site request forgery, XSRF, CSRF

**Reason and Prerequisites**

The ERMS Web Form Connector executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The malicious user may use a cross-site scripting attack to do this, or they may present a link to the victim.

**Solution**

After implementing the correction instructions, the form data of your application will not be submitted to ERMS directly. Instead, a confirmation page with the entered data will be rendered for verification by the user. Only after confirming the data will the entered data be submitted to ERMS.

**Correction Instructions**

1. **Activate XSRF protection for BSP application `CRM_ERMS_SAMPLE`.**
    - Open BSP application `CRM_ERMS_SAMPLE` in edit mode.
    - Mark the checkbox for 'XSRF Protection'.
    - Activate the BSP application.

2. **Activate XSRF protection for BSP application `CRM_ERMS_WF_CON`.**
    - Open BSP application `CRM_ERMS_WF_CON` in edit mode.
    - Mark the checkbox for 'XSRF Protection'.
    - Activate the BSP application.

3. **Create and activate a default BAdI implementation for `BAdI CRM_ERMS_WF_CON`.**

**Download and More Information**

- [Download for SNOTE](https://me.sap.com/notesdownloads.sap.com/note/0040000009538502017)
- [PDF Version](https://me.sap.com/userapps.support.sap.com/sap/support/sfm/notes/print/0001606267?language=en-US&token=71183F19724B9B4AE9259B189674F345)

**Credits**

Credits to [redrays.io](https://redrays.io) for support in providing this information.