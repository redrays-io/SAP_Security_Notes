SAP Security Note 2904480: Missing XML Validation Vulnerability in SAP Commerce

**Symptom**

SAP Commerce does not process XML input securely in certain REST XML APIs. This affects the confidentiality and availability (partially) of SAP Commerce.

A well-known impact of insecure processing of XML is:

- An unauthenticated attacker could reference system files by new entities, making the parser load those files when the entities are included.

**Other Terms**

XML External Entity (XXE), [CVE-2020-6238](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6238)

**Reason and Prerequisites**

This vulnerability affects all installations of SAP Commerce that are based on unpatched versions.

**Solution**

SAP provides a patch for all supported versions of SAP Commerce. The following patch releases address this vulnerability:

- [SAP Hybris Commerce 6.6.0.29 Patch Release](https://jira.hybris.com/browse/PATCH-7203)
- [SAP Hybris Commerce 6.7.0.28 Patch Release](https://jira.hybris.com/browse/PATCH-7204)
- [SAP Commerce Cloud Patch Release 1808.23](https://jira.hybris.com/browse/PATCH-7205)
- [SAP Commerce Cloud Patch Release 1811.21](https://jira.hybris.com/browse/PATCH-7206)
- [SAP Commerce Cloud Patch Release 1905.13](https://jira.hybris.com/browse/PATCH-7207)

The corresponding [Software Downloads for SAP Commerce](https://me.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=MAINT&TA=ACTUAL/SAP%20COMMERCE) are available in the SAP Support Portal. For information about installing patches, see [About Patch Releases](https://help.sap.com/viewer/dc198ac31ba24dce96149c8480be955f/6.7.0.0/en-US/8c25978386691014b4abdd61376acd24.html#loio8c25978386691014b4abdd61376acd24).

**CVSS**

- **CVSS Score:** 9.3
- **CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:L

  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** Low (L)

**Validity**

This issue is valid for the following software component versions:

- HY_COM 6.6
- HY_COM 6.7
- HY_COM 1808
- HY_COM 1811
- HY_COM 1905

**Credits**

Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.