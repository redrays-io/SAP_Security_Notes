1537765 - CA-DMS: Potential Directory Traversal

**SAP Note/KBA**: 1537765  
**Type**: SAP Security Note  
**Version**: 2  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer  
**Released On**: 14.12.2010  
**Component**: CA-DMS (Cross-Application Components > Document management)  

### Description

#### Symptom
Document Management System (DMS) contains a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

#### Other Terms
OPEN DATASET, SEC-136, pf_file, FILE_VALIDATE_NAME, Path Traversal, CVALE, CVORIGINALS.

#### Reason and Prerequisites
The function modules `CV_WRITE_TABLE2FILE` and `CVDS_WRITE_TABLE2FILE` fail to validate the path a user-submitted file is written to. This means that an attacker can potentially overwrite data on the remote system.  
**Note** 1497003 is a prerequisite for this note.

#### Solution
Refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The corrections from Note 1497003 are a prerequisite for implementation of this note.

**Logical File Names Used in this Solution:**
- The following logical file name has been created in order to enable the validation of physical file names:
  - **DMS_LOG_FILE_PATH**

### Actions
- [Download for SNOTE](https://me.sap.com/note/0040000009119952017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001537765?language=en-US&token=5787C45EF111A242641B6AC333417B65)
- [Share by Email](https://me.sap.com/notes/1537765/share)
- [Open in New Window](https://me.sap.com/notes/1537765)

### References
- **This document refers to:** [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

### Validity
Supported in the following software components:
- **SAP_APPL**: 46B, 46C, 470, 500, 600, 602, 603, 604, 605

### Support Package
- **SAP_APPL 46B**: [SAPKH46B62](https://me.sap.com/supportpackage/SAPKH46B62)
- **SAP_APPL 46C**: [SAPKH46C62](https://me.sap.com/supportpackage/SAPKH46C62)
- **SAP_APPL 470**: [SAPKH47036](https://me.sap.com/supportpackage/SAPKH47036)
- **SAP_APPL 500**: [SAPKH50025](https://me.sap.com/supportpackage/SAPKH50025)
- **SAP_APPL 600**: [SAPKH60019](https://me.sap.com/supportpackage/SAPKH60019)
- **SAP_APPL 602**: [SAPKH60209](https://me.sap.com/supportpackage/SAPKH60209)
- **SAP_APPL 603**: [SAPKH60308](https://me.sap.com/supportpackage/SAPKH60308)
- **SAP_APPL 604**: [SAPKH60409](https://me.sap.com/supportpackage/SAPKH60409)
- **SAP_APPL 605**: [SAPKH60504](https://me.sap.com/supportpackage/SAPKH60504)

---

*Credits to [redrays.io](https://redrays.io) for support to provided information.*