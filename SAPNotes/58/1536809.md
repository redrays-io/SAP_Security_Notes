SAP Security Note 1536809 - Directory Traversal in Physical Inventory Processing

**Description**
  
SAP Security Note 1536809 addresses a potential Directory Traversal vulnerability in the component `SCM-EWM-PI`. This vulnerability affects the following transactions:

- `/SCWM/PI_UPLOAD` - Upload Storage Bins and Count Data
- `/SCWM/PI_DOWNLOAD` - Download Storage Bins and Count Data
- `/SCWM/PI_SAMP_STOCK` - Download Stock Population
- `/SCWM/PI_SAMP_CR` - Upload Sample to Create PI Documents
- `/SCWM/PI_SAMP_UPDATE` - Download Results or Stock Population

**Impact**

1. **Read Arbitrary Files:** A malicious user can potentially read arbitrary files on the remote server, possibly disclosing confidential information.
2. **Write Arbitrary Files:** A malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

**Affected Components and Versions**

- **SCM:** Versions 500
- **SCMEWM:** Versions 510, 700, 701

**Solution**

To mitigate this vulnerability:

1. **Prerequisites:** Ensure that SAP Note [1497003](https://me.sap.com/notes/1497003) is implemented as it contains prerequisites for this security note.
2. **Correction Instructions:** Apply the correction instructions provided in this note. Logical file names have been created to validate physical file names for the affected transactions. Refer to the respective notes for more information:
   - Transaction `/SCWM/PI_SAMP_CR`: Logical filename = `EWM_PI_SAMP_CR` ([Note 1470669](https://me.sap.com/notes/1470669))
   - Transaction `/SCWM/PI_SAMP_STOCK`: Logical filename = `EWM_PI_SAMP_DOWNLOAD` ([Note 1470669](https://me.sap.com/notes/1470669))
   - Transaction `/SCWM/PI_SAMP_UPDATE`: Logical filename = `EWM_PI_SAMP_UPDATE` ([Note 1470669](https://me.sap.com/notes/1470669))
   - Transaction `/SCWM/PI_UPLOAD`: Logical filename = `EWM_PI_UPLOAD` ([Note 1452989](https://me.sap.com/notes/1452989))
   - Transaction `/SCWM/PI_DOWNLOAD`: Logical filename = `EWM_PI_DOWNLOAD` ([Note 1452989](https://me.sap.com/notes/1452989))

**References**

- [Potential directory traversals in applications (Note 1497003)](https://me.sap.com/notes/1497003)
- [Physical inventory (PI) sampling: Logical file name (Note 1470669)](https://me.sap.com/notes/1470669)
- [Improvements in Download/Upload transactions. Performance (Note 1422197)](https://me.sap.com/notes/1422197)

**Additional Information**

- **Release Status:** Released for Customer
- **Priority:** Correction with high priority
- **Category:** Program error
- **Recency:** New
- **Released On:** 14.12.2010

For further details and direct access to the SAP Note, visit [SAP Note 1536809](https://me.sap.com/notes/1536809).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*