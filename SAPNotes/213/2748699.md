2748699 - [CVE-2019-0291] Information Disclosure in Solution Manager 7.2 / CA Introscope Enterprise Manager

---

**SAP Note Number:** 2748699  
**Type:** SAP Security Note  
**Version:** 4  
**Recency:** Updated  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 11.06.2019  
**Component:** Service > SAP Solution Manager > Diagnostics > Solution Manager / Introscope Integration > Enterprise Manager Setup  

### Title
**2748699 - [CVE-2019-0291] Information Disclosure in Solution Manager 7.2 / CA Introscope Enterprise Manager**

### Description

#### Symptom
Under certain conditions, Solution Manager 7.2 allows an attacker to access information which would otherwise be restricted.

Some well-known impacts of Information Disclosure include:
- Loss of information and system configuration confidentiality
- Information gathering for further exploits and attacks

#### Other Terms
Information Exposure, Information Leak, [CVE-2019-0291](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0291)

### Reason and Prerequisites
For the Solution Manager capability **Monitoring and Alerting Infrastructure (MAI)**, the **CA Introscope Enterprise Manager (EM)** offers the service **Introscope Push** (see [SAP Note 1751225](https://me.sap.com/notes/1751225)) to actively push monitoring metrics from EM to Solution Manager. Introscope Push calls a Web Service of Solution Manager that requires authentication.

The username and password for the Introscope Push service are stored in a file referenced by the property `dpcpush.credentials.file` in the file `<EM_install_dir>/sap/<SolMan_SID>.e2emai.properties`.

The credentials in the referenced file are insufficiently protected against attackers.

The standard user **SM_EXTERN_WS**, used for Introscope Push, is by default a system user (no dialog user) with limited permissions and an automatically generated password valid only for this user.

You may have configured your own user in Solution Manager during the configuration step:
- "Cross Scenario Configuration" → "Mandatory Configuration" → "System Preparation" → "Maintain Technical Users" with **Use Case ID** as **SM_EXTERN_WS**.

### Solution
To secure the credentials file, perform the following steps:

1. **Deploy the LM-SERVICE Software Component**, mentioned in the "Support Packages & Patches" section.
2. **Apply a new patch** to the CA Introscope Enterprise Manager:
   - Since the credentials file must be readable by CA Introscope Enterprise Manager, a new patch (Management Module [MM] package) must be applied. Details about MM can be found in [SAP Note 1579474](https://me.sap.com/notes/1579474).
   - Depending on the EM version, apply the corresponding SAP note patch:
     - [Note 2534316](https://me.sap.com/notes/2534316) Introscope 10.5 Release Notes
     - [Note 2285189](https://me.sap.com/notes/2285189) Introscope 10.1 Release Notes
3. **Change the password** of the user **SM_EXTERN_WS** (or the user specified during configuration):
   - Navigate to "Cross Scenario Configuration" → "Mandatory Configuration" → "System Preparation" → "Maintain Technical Users."
4. **Generate the credentials file in a protected manner**:
   - In Solution Manager, run "Cross Scenario Configuration" → "Mandatory Configuration" → "Basic Configuration" → "Configure Basic Functions."
   - Execute the task "Push DPC Configuration to CA Introscope" to generate the credentials file securely.
   - Verify the file content to ensure it includes the line: `$internal/mode=encrypted`

**Caution:** Perform this manual activity separately in each system where you transport the Note for implementation.

### CVSS Information
- **CVSS Score:** 7.1
- **CVSS Vector:** CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
  - **Attack Vector (AV):** Local (L)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** None (N)

### References
- [SAP Note 2734639](https://me.sap.com/notes/2734639)
- [SAP Note 2534316](https://me.sap.com/notes/2534316)
- [SAP Note 2285189](https://me.sap.com/notes/2285189)
- [SAP Note 1751225](https://me.sap.com/notes/1751225)
- [SAP Note 1579474](https://me.sap.com/notes/1579474)

### Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000871392019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002748699?language=en-US&token=B1345F414D123EFC2704694EBDD9A944)

---

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*