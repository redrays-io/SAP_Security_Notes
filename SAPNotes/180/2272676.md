SAP Security Note 2272676: Spreadsheet Formula Injection in FPM List UIBB ATS/FPM Tree UIBB/WD ALV

---

**Overview**

SAP Security Note **2272676** addresses a vulnerability related to Spreadsheet Formula Injection in components such as FPM List UIBB ATS, FPM Tree UIBB, and WD ALV. This issue allows attackers to embed malicious formulas in exported spreadsheet files, which can execute harmful code when opened by users in programs like Microsoft Excel.

**Details**

- **Type:** SAP Security Note
- **Version:** 7
- **Category:** Program error
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** 26.11.2018
- **Component:** Basis Components > Web Dynpro > Configurable Component > List Viewer > ALV for ABAP

**Vulnerability Description**

When exporting data using the **Export To Spreadsheet** function in either **CSV** or **Office Open XML (Microsoft Excel)** formats, attackers can manipulate the data to include formulas that execute upon opening the file. In the case of CSV files, Microsoft Excel displays a warning about potential security concerns, and if the user enables automatic update of links, the embedded malicious formulas execute automatically. For Office Open XML formats, additional steps are required for the formulas to execute, including user interaction.

**Mitigation Steps**

1. **Apply Relevant Support Packages:**
   - Ensure that all relevant support packages listed under the **Support Package** section of the note are applied to your system.
   
2. **Import Correction Instructions:**
   - Follow the **Correction Instructions** provided in the note to protect cell contents against potentially malicious formulas.

3. **Manual Activities:**
   - Perform the manual activities outlined in the note for each system where the note is transported. This includes applying SAP Note [2416832](https://me.sap.com/notes/2416832) which addresses apostrophes in cells when exporting to spreadsheets.

**CVSS Information**

- **CVSS v3 Base Score:** 5.4/10
- **Vector:** 
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

**Solution**

To mitigate this vulnerability, you need to import the relevant support packages as listed in the note. These packages protect all cell contents against potentially malicious formulas. Additionally, if not already implemented, apply SAP Note [2416832](https://me.sap.com/notes/2416832) to further secure your system against similar threats.

**References**

- [SAP Note 2272676](https://me.sap.com/notes/2272676)
- [SAP Note 2416832](https://me.sap.com/notes/2416832)
- [SAP Security Notes Overview](https://me.sap.com/securitynotes)

**Support Package Details**

Ensure that the following support packages are applied to your system:

- **SAP_BASIS 700:** [SAPKB70034](https://me.sap.com/supportpackage/SAPKB70034), [SAPKB70037](https://me.sap.com/supportpackage/SAPKB70037)
- **SAP_BASIS 701:** [SAPKB70119](https://me.sap.com/supportpackage/SAPKB70119), [SAPKB70122](https://me.sap.com/supportpackage/SAPKB70122)
- **SAP_BASIS 702:** [SAPKB70219](https://me.sap.com/supportpackage/SAPKB70219)
- **SAP_BASIS 710:** [SAPKB71021](https://me.sap.com/supportpackage/SAPKB71021), [SAPKB71024](https://me.sap.com/supportpackage/SAPKB71024)
- **SAP_BASIS 711:** [SAPKB71116](https://me.sap.com/supportpackage/SAPKB71116), [SAPKB71119](https://me.sap.com/supportpackage/SAPKB71119)
- **SAP_UI 740:** [SAPK-74016INSAPUI](https://me.sap.com/supportpackage/SAPK-74016INSAPUI)
- **SAP_UI 750:** [SAPK-75003INSAPUI](https://me.sap.com/supportpackage/SAPK-75003INSAPUI), [SAPK-75004INSAPUI](https://me.sap.com/supportpackage/SAPK-75004INSAPUI)

**Prerequisites**

Before applying the security note, ensure that the following SAP Notes are also implemented:

- [1391325](https://me.sap.com/notes/1391325) - ABAP ALV rounding is not supported during export (2)
- [1393673](https://me.sap.com/notes/1393673) - WD ABAP ALV: Different checkbox values for PDF and Excel
- [1400534](https://me.sap.com/notes/1400534) - ALV Excel export: Conversion exit missing/too many leading zeros
- *(Refer to the full list in the Security Note for all prerequisites)*

**Additional Information**

For more details, refer to the [official SAP Security Notes portal](https://me.sap.com/securitynotes).

---

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*