SAP Security Note 2271018 - Missing authorization checks in function modules related to CRM knowledgebases for configurable products

**Overview**

SAP Security Note [2271018](https://me.sap.com/notes/2271018) addresses critical missing authorization checks in several RFC function modules related to CRM Configuration Knowledgebases. This vulnerability can lead to unauthorized access and potential system misuse.

**Symptom**

This security note identifies missing authorization checks in the following RFC function modules for CRM Configuration Knowledgebases:

- `COM_PME_GET_NEW_IDS`
- `COM_PME_DB_INSERT_STABLE`
- `COM_PME_DB_INSERT_KB_START`
- `COM_PME_DB_INSERT_KB_END`
- `COM_PME_DB_INSERT_CFGKB`
- `COM_PME_DB_INSERT_VTABLE`
- `COM_PME_DB_TRANS_START`
- `COM_PME_DB_TRANS_ROLLBACK`
- `COM_PME_DB_TRANS_COMMIT`
- `CRM_SCE_DB_TRANS_INIT_RFC`

**Reason and Prerequisites**

Remote calls to RFC function modules are protected by checks on the authorization object `S_RFC`. However, it was identified that these checks might not be sufficient for the mentioned function modules, potentially allowing unauthorized access and undesired system behavior. The CRM Product Master lacks necessary authorization checks for these functions.

**Solution**

To mitigate this issue, ensure that proper user authorizations are maintained for the affected function modules. Specifically, assign the following authorizations:

| Function Module                  | Auth. Object | Param1  |
|----------------------------------|--------------|---------|
| COM_PME_GET_NEW_IDS              | COM_PRD      | ACTVT=03|
| COM_PME_DB_INSERT_STABLE         | COM_PRD      | ACTVT=03|
| COM_PME_DB_INSERT_KB_START        | COM_PRD      | ACTVT=03|
| COM_PME_DB_INSERT_KB_END          | COM_PRD      | ACTVT=03|
| COM_PME_DB_INSERT_CFGKB           | COM_PRD      | ACTVT=03|
| COM_PME_DB_INSERT_VTABLE          | COM_PRD      | ACTVT=03|
| COM_PME_DB_TRANS_START            | COM_PRD      | ACTVT=03|
| COM_PME_DB_TRANS_ROLLBACK         | COM_PRD      | ACTVT=03|
| COM_PME_DB_TRANS_COMMIT            | COM_PRD      | ACTVT=03|
| CRM_SCE_DB_TRANS_INIT_RFC          | COM_PRD      | ACTVT=01|

**Accessing the SAP Note**

You can download the security note and view the PDF version using the following links:

- [Download for SNOTE](https://me.sap.com/note/0040000013434002017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002271018?language=en-US&token=7C3686EF8EFAF0C720EB66AD4D8508D9)

**Support Packages and Patches**

Ensure your system is updated with the relevant support packages:

| Software Component Version | Support Package   | URL                                         |
|----------------------------|-------------------|---------------------------------------------|
| BBPCRM 700                 | SAPKU70018        | [SAPKU70018](https://me.sap.com/supportpackage/SAPKU70018) |
| BBPCRM 701                 | SAPKU70115        | [SAPKU70115](https://me.sap.com/supportpackage/SAPKU70115) |
| BBPCRM 702                 | SAPKU70217        | [SAPKU70217](https://me.sap.com/supportpackage/SAPKU70217) |
| BBPCRM 712                 | SAPKU71210        | [SAPKU71210](https://me.sap.com/supportpackage/SAPKU71210) |
| BBPCRM 713                 | SAPKU71312        | [SAPKU71312](https://me.sap.com/supportpackage/SAPKU71312) |
| BBPCRM 714                 | SAPK-71402INBBPCRM | [SAPK-71402INBBPCRM](https://me.sap.com/supportpackage/SAPK-71402INBBPCRM) |

**Prerequisites**

Ensure that SAP Note [1930885](https://me.sap.com/notes/1930885) is applied, which addresses RFC-enabled function modules for copying a Knowledge Base.

**Conclusion**

Addressing these missing authorization checks is crucial for maintaining the security and integrity of your SAP CRM system. Apply the necessary authorizations and updates as outlined in the security note to prevent potential vulnerabilities.

*Credits to [Redrays](https://redrays.io) for supporting information.*