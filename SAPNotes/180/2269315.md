2269315 - Missing authorization check in OAuth2 Server Runtime

### Symptom

An authenticated user (with a valid OAuth2 access token) can use OData services to which access should be restricted using OAuth2 scopes. This may result in an escalation of privileges.

### CVSS Information

- **CVSS v3 Base Score:** 6.3 / 10
- **CVSS v3 Vector:**

| Metric                  | Value            |
|-------------------------|------------------|
| Attack Vector (AV)      | Network (N)      |
| Attack Complexity (AC)  | Low (L)          |
| Privileges Required (PR)| Low (L)          |
| User Interaction (UI)   | None (N)         |
| Scope (S)               | Unchanged (U)    |
| Confidentiality Impact (C)| Low (L)        |
| Integrity Impact (I)    | Low (L)          |
| Availability Impact (A) | Low (L)          |

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://support.sap.com/securitynotes](https://support.sap.com/securitynotes).

### Reason and Prerequisites

In special situations (ICF configuration), the OAuth2 Server Runtime does not perform the required scope checks. This may result in undesired system behavior.

### Solution

Apply the ABAP correction instructions provided in the note.

Additionally, apply SAP note [2255477](https://me.sap.com/notes/2255477) titled "OAuth enablement for OData Services." Without this note, OData service calls that worked previously (because of the missing authorization check problem) might fail with an exception.

For more details and to download the necessary files, visit the SAP support portal: [https://me.sap.com/notes/2269315](https://me.sap.com/notes/2269315)

*Credits: [redrays.io](https://redrays.io) for support in providing the information.*