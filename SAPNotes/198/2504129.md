2504129 - Information Disclosure in SAP NetWeaver Instance Agent Service

**Description**

Under certain conditions, `sapstartsrv` allows an attacker to access information which would otherwise be restricted.

**Impacts of Information Disclosure:**

- Loss of information and system configuration confidentiality
- Information gathering for further exploits and attacks

**CVSS v3 Information**

- **Base Score:** 5.3 / 10
- **Vector:** AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

**Solution**

Implement the corrected version of `sapstartsrv` as specified in this SAP Note. Ensure you are using at least the version and Patch Level mentioned in the note. As a temporary workaround, you can use `service/protectedwebmethods=SDEFAULT +J2EEComponentList`.

**Software Components Affected**

- **KRNL32NUC**
  - 7.21, 7.21EXT, 7.22, 7.22EXT
- **KRNL32UC**
  - 7.21, 7.21EXT, 7.22, 7.22EXT
- **KRNL64NUC**
  - 7.21, 7.21EXT, 7.22, 7.22EXT, 7.42, 7.45, 7.49, 7.50, 7.51, 7.52, 7.53
- **KRNL64UC**
  - 7.21, 7.21EXT, 7.22, 7.22EXT, 7.42, 7.45, 7.49, 7.50, 7.51, 7.52, 7.53
- **KERNEL**
  - 7.21 to 7.22, 7.42, 7.45, 7.49, 7.50, 7.51, 7.52, 7.53

**Download and Additional Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000019858592017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002504129?language=en-US&token=84CDF53F6B6FDC7A84D36EBC76CD8F9A)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002504129)
- [Show Changes](https://me.sap.com/sap/support/notes/0002504129?showChanges=true)

**Prerequisites**

On AS Java instances, the Web method `J2EEGetComponentList` of `sapstartsrv` can be accessed without authentication even if authentication was enforced in the configuration (e.g., using `service/protectedwebmethods=SDEFAULT`, see [SAP Note 927637](https://me.sap.com/notes/927637) and [SAP Note 1439348](https://me.sap.com/notes/1439348)).

**Credits**

Credits to [Redrays](https://redrays.io) for support in providing this information.