SAP Security Note 2499109 - Collisions during UUID generation in SAP NetWeaver Java Server

**SAP Security Note 2499109 - Collisions during UUID generation in SAP NetWeaver Java Server**

**Type:** SAP Security Note  
**Version:** 5  
**Recency:** New  
**Released On:** 08.08.2017  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Component:** Basis Components > NetWeaver Application Server Java > Security, User Management > Cryptography  
**Language:** English  

### Description

**Symptom**
- NW Java Server random number generator is broken (race condition in parallel threads):
  - Two requestors of a random number might get the same “random” number.
  - An exception might occur in the random number generator.

**This can result in several security and functional issues:**
- UUID collision is possible.
- Cryptographic key generated by NW Java Server might be broken.
- Two different sessions might have identical Session IDs. Session hijacking might be possible.
- Functional errors like “HTTP Error 500”, "This page isn't working" or similar after login to Netweaver/Portal.
- Output like "500 Internal Server Error" instead of Logon Dialog in Netweaver/Portal.
- Error of type GC Allocation Failure.
- Outgoing TLS connections fail with various exceptions during key generation.

**CVSS Information**
- **CVSS v3 Base Score:** 6.8 / 10

**CVSS v3 Base Vector:**
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

*SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note.*

**Other Terms**
- UUID, engineNextBytes, SecRandomSpi, SecureRandom, Session ID

**Reason and Prerequisites**
- Due to changes introduced in Java VM 1.8u112 regarding the synchronization of SecureRandom generation, each provider needs to synchronize its own methods to avoid collisions and race conditions. Until now, this was not implemented.
- The problem affects only NW750SP6 and upcoming NW750 service packs.

**Solution**
- To apply this update, install the Support Package Add-on (SCA) attached to this note corresponding to your codeline/SP level.
  
  *We recommend performing this update even if no errors have been observed previously.*

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000019388162017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002499109?language=en-US&token=B20FEC2A5C6985D3214BCABC091B89DC)

**References:**
- [2553799 - 500 Internal Server Error when accessing Netweaver As Java Server](https://me.sap.com/notes/2553799)
- [2556722 - Unable to Generate the Random Token](https://me.sap.com/notes/2556722)
- [2555587 - Collective Note: SAP NetWeaver 7.5 SP10 - Application Server Java (AS Java)](https://me.sap.com/notes/2555587)

**Supported Software Components:**
- **CORE-TOOLS** from version **7.50**

**Support Package Patches:**
- [SP009 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001227&support_package=SP009&patch_level=000000)
- [SP008 Patch 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001227&support_package=SP008&patch_level=000001)
- [SP007 Patch 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001227&support_package=SP007&patch_level=000002)
- [SP006 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001227&support_package=SP006&patch_level=000003)
- [SP010 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001227&support_package=SP010&patch_level=000000)

*Credits to [redrays.io](https://redrays.io) for support to provided information.*