SAP Security Note 2508767 - Privilege Escalation after installation of SAP Systems on SAP HANA

**Description**

### Symptom

After the installation of an SAP NetWeaver system on SAP HANA, the roles “ABAP_ADMIN” and “ABAP_DEV” are created. These roles are automatically assigned to the ABAP schema user in SAP HANA (default SAPABAP1), potentially leading to privilege escalation for the ABAP schema user.

### CVSS Information

**CVSS v3 Base Score:** 4.7 / 10  
**CVSS v3 Metrics:**
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** High (H)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

_SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note._

### Reason and Prerequisites

If you have installed an ABAP system with SWPM 1.0 SP 18 patch version earlier than 3 and wish to resolve this security inconsistency without reinstalling from scratch, this note is relevant.

**Technical Background:**
The user who creates a new role in SAP HANA will automatically have the newly created role and its contained privileges assigned. This behavior can be circumvented by introducing a temporary user to create the new role. The temporary user is deleted after the role creation is successful.

### Solution

- **Fixed in SWPM 1.0 SP18 Patch 3:** The issue where roles are automatically assigned to the ABAP schema user has been resolved.
  
- **With SLToolset SP21:** Roles will no longer be created during installation or re-created during updates.

**For Already Installed Systems:**
- Delete the `ABAP_ADMIN` and `ABAP_DEV` roles.
- Re-create them correctly if needed.

**For New Installations:**
- Create the roles if needed.

_For detailed instructions on creating or re-creating the roles, refer to [SAP Note 2529272](https://me.sap.com/notes/2529272)._

### Downloads

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000020180442017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002508767?language=en-US&token=5EB79F3102246997DBCCD1066E321835)

### References

- [SAP Note 2529272 - ABAP_ADMIN and ABAP_DEV roles for NetWeaver on SAP HANA DB](https://me.sap.com/notes/2529272)

**Credits**
Thanks to [redrays.io](https://redrays.io) for support in providing the information.