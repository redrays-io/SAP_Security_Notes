2822074 - Missing Authorization check in SAP NetWeaver (ABAP Server)

---

### Description

**Symptom**

**UPDATE 10th March 2020**: This note has been re-released with updated *Solution* information. We added the requirement to add a manual pre-installation step. This step is to check whether package SWO_TEST exists and create it if it does not exist.

**UPDATE 28th January 2020**: This note has been re-released with updated *validity* and *Solution* information. We restricted the validity of 740 instructions to SP12.

SAP NetWeaver (ABAP Server) does not perform necessary authorization checks for an authenticated user, resulting in escalation of privileges.

Some well-known impacts of Missing Authorization check are:

- Abuse functionality restricted to a particular user group
- Read, modify, or delete restricted data

**Other Terms**

Access control, Authorization error, Authorization profile

Business Object Repository (BOR)

**Reason and Prerequisites**

Access to Business Objects (BO) in Business Object Repository (BOR) is not properly controlled. Specifically:

- Remote read access to attributes in BOR is only secured by generic S_RFC authorization.
- In case of remote access via a proxy system to a target system, only the generic S_RFC authorization is checked in the proxy system. In the target system, the check is done for the technical user in the RFC destination from the proxy system to the target system.

**Solution**

By the correction provided in this SAP Note, new authorization objects `S_BOR_RFC` and `S_BOR_PRX` are created. The new authorization checks are switchable using transaction `SACF` and must be switched on to activate the check.

- **Local use case**, e.g., SAP Business Workflow: No change.
- **RFC client use case**, e.g., SAP Java Connector (JCo) as RFC client:
  - A check for `S_BOR_RFC` is introduced and must be switched via scenario `SWO_REMOTE_ACCESS` on the RFC server-side.
- **Remote use case** with a logical system connecting two SAP Systems, e.g., SAP ERP and SAP CRM:
  - A check for `S_BOR_RFC` is introduced and must be switched via scenario `SWO_REMOTE_ACCESS` in the target system of the logical system connection.
- **Proxy use case**: RFC client calls a system (proxy) to connect to another system (target) using a logical system (from proxy to target):
  - In the proxy system, a check for `S_BOR_PRX` is introduced and must be switched via scenario `SWO_PROXY_ACCESS`.
  - In the target system, a check for `S_BOR_RFC` is introduced and must be switched via scenario `SWO_REMOTE_ACCESS`.

Please implement the SAP Support Package mentioned in this SAP Note or the respective correction instruction.

**Important**: If you want to implement the correction instructions, you must implement SAP Note [2844646](https://me.sap.com/notes/2844646) in advance. Restart transaction `SNOTE` after implementing 2844646. Only after that can you implement this SAP Note.

After implementing the SAP Note, execute the report `SWO_RFC_AUTH_CHECK_STATE` to see if the scenario is active and to check whether the used kernel meets the requirements of this correction.

### CVSS

**Score**: 6.6

**Vector**: [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L](https://me.sap.com/CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L)

**Metrics:**

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** High (H)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

### Support Packages

**Valid For Software Components:**

| Software Component | From | To  |
|--------------------|------|-----|
| SAP_BASIS          | 700  | 702 |
| SAP_BASIS          | 710  | 711 |
| SAP_BASIS          | 730  | 730 |
| SAP_BASIS          | 731  | 731 |
| SAP_BASIS          | 740  | 740 |
| SAP_BASIS          | 750  | 754 |

**Available Support Packages:**

| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| SAP_BASIS 700              | [SAPKB70038](https://me.sap.com/supportpackage/SAPKB70038) | 
| SAP_BASIS 701              | [SAPKB70123](https://me.sap.com/supportpackage/SAPKB70123) | 
| SAP_BASIS 702              | [SAPKB70223](https://me.sap.com/supportpackage/SAPKB70223) | 
| SAP_BASIS 710              | [SAPKB71025](https://me.sap.com/supportpackage/SAPKB71025) | 
| SAP_BASIS 711              | [SAPKB71120](https://me.sap.com/supportpackage/SAPKB71120) | 
| SAP_BASIS 730              | [SAPKB73020](https://me.sap.com/supportpackage/SAPKB73020) |
| SAP_BASIS 730              | [SAPKB73021](https://me.sap.com/supportpackage/SAPKB73021) |
| SAP_BASIS 731              | [SAPKB73127](https://me.sap.com/supportpackage/SAPKB73127) |
| SAP_BASIS 731              | [SAPKB73126](https://me.sap.com/supportpackage/SAPKB73126) |
| SAP_BASIS 740              | [SAPKB74024](https://me.sap.com/supportpackage/SAPKB74024) |
| SAP_BASIS 740              | [SAPKB74023](https://me.sap.com/supportpackage/SAPKB74023) |
| SAP_BASIS 750              | [SAPK-75017INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75017INSAPBASIS) |
| SAP_BASIS 750              | [SAPK-75018INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75018INSAPBASIS) |
| SAP_BASIS 751              | [SAPK-75110INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75110INSAPBASIS) |
| SAP_BASIS 752              | [SAPK-75206INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75206INSAPBASIS) |
| SAP_BASIS 753              | [SAPK-75304INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75304INSAPBASIS) |
| SAP_BASIS 754              | [SAPK-75401INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75401INSAPBASIS) |
| SAP_BASIS 754              | [SAPK-75402INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75402INSAPBASIS) |

### References

**This document refers to:**

- [2845081 - Switchable authorization checks SWO_REMOTE_ACCESS and SUCD SWO_PROXY_ACCESS](https://me.sap.com/notes/2845081)

**This document is referenced by:**

- [3232370 - Syntax error in business objects](https://me.sap.com/notes/3232370)
- [2845081 - Switchable authorization checks SWO_REMOTE_ACCESS and SUCD SWO_PROXY_ACCESS](https://me.sap.com/notes/2845081)

### Attachments

- [Manual_Instructions.pdf](https://me.sap.com/support/sapnotes/public/services/attachment.htm?iv_key=002075125800002086662019&iv_version=0006&iv_guid=00109B36D5D21EDA98BCA68E223400D9) (409 KB)

### Correction Instructions

Implement all manual changes that are described in the attached [Manual_Instructions.pdf](https://me.sap.com/support/sapnotes/public/services/attachment.htm?iv_key=002075125800002086662019&iv_version=0006&iv_guid=00109B36D5D21EDA98BCA68E223400D9).

### Preconditions

Ensure the following SAP Notes are implemented before applying this note:

- [2844646 - Ignore the local class definition, implementation, definition deferred, definition load, definition local friends changes](https://me.sap.com/notes/2844646)
- [2447731 - Error during creation of instances of object type TOJTB](https://me.sap.com/notes/2447731)

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*