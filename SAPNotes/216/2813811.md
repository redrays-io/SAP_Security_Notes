2813811 - [CVE-2019-0345] Server-Side Request Forgery in SAP NetWeaver Application Server for Java (Administrator System Overview)

### Description

#### Symptom
AS Java System Overview in SAP NetWeaver Administrator (NWA) allows an attacker to send a crafted request from a vulnerable web application. It is usually used to target internal systems behind firewalls that are normally inaccessible to an attacker from the external network, resulting in a Server-Side Request Forgery vulnerability.

Some well-known impacts of SSRF vulnerability are:
- Scan internal network to determine internal infrastructure
- Information gathering for further exploits/attacks
- Perform a Remote File Inclusion attack
- Retrieve server files (including /etc/passwd and more)
- Bypass Firewall and force the vulnerable server to perform malicious requests

#### Other Terms
Server-Side Request Forgery, SSRF, Information exposure, ASJO, [CVE-2019-0345](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0345)

#### Reason and Prerequisites
An attacker can trick the AS Java System Overview in NWA to gather information for further exploits/attacks.

### Solution
The vulnerable web service is removed from the project.

Kindly apply the patch from the [Support Packages & Patches section](https://me.sap.com/supportpackages).

After applying the fix, some systems' System Overview may display incorrect information about started/failed Java server nodes, for example, these monitors may show N/A values. This side effect is resolved by applying the settings from SAP KBA [2577844](https://me.sap.com/notes/2577844).

### CVSS

**CVSS Score:** 9.0  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** High (H)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

### References

- This document refers to [2577844 - AS Java Monitoring and Logging Parametrization Best Practice](https://me.sap.com/notes/2577844)
- This document is referenced by [2842655 - Central Note for SAP NetWeaver 7.31 SP26 Application Server Java](https://me.sap.com/notes/2842655)

### Validity

**Supported Software Components:**
- **LM-CORE:** 7.30 to 7.30
- **LM-CORE:** 7.31 to 7.31
- **LM-CORE:** 7.40 to 7.40
- **LM-CORE:** 7.50 to 7.50

### Support Package Patches

**J2EE ENGINE LM-CORE 7.50**
- [SP009 Patch Level 000007](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP009&patch_level=000007)
- [SP008 Patch Level 000009](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP008&patch_level=000009)
- [SP012 Patch Level 000005](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP012&patch_level=000005)
- [SP011 Patch Level 000007](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP011&patch_level=000007)
- [SP010 Patch Level 000009](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP010&patch_level=000009)
- [SP013 Patch Level 000005](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP013&patch_level=000005)
- [SP014 Patch Level 000003](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP014&patch_level=000003)
- [SP015 Patch Level 000002](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP015&patch_level=000002)
- [SP016 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP016&patch_level=000000)
- [SP017 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP017&patch_level=000000)

**J2EE ENGINE LM-CORE 7.30**
- [SP014 Patch Level 000006](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP014&patch_level=000006)
- [SP015 Patch Level 000008](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP015&patch_level=000008)
- [SP016 Patch Level 000008](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP016&patch_level=000008)
- [SP017 Patch Level 000009](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP017&patch_level=000009)
- [SP018 Patch Level 000010](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP018&patch_level=000010)
- [SP019 Patch Level 000005](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP019&patch_level=000005)
- [SP020 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP020&patch_level=000000)
- [SP021 Patch Level 000009](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014365&support_package=SP021&patch_level=000009)
- [SP022 Patch Level 000010](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014365&support_package=SP022&patch_level=000010)
- [SP023 Patch Level 000006](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014365&support_package=SP023&patch_level=000006)
- [SP024 Patch Level 000005](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014365&support_package=SP024&patch_level=000005)
- [SP025 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014365&support_package=SP025&patch_level=000000)
- [SP026 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014365&support_package=SP026&patch_level=000000)

**J2EE ENGINE LM-CORE 7.40**
- [SP015 Patch Level 000011](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019682&support_package=SP015&patch_level=000011)
- [SP016 Patch Level 000009](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019682&support_package=SP016&patch_level=000009)
- [SP017 Patch Level 000010](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019682&support_package=SP017&patch_level=000010)
- [SP018 Patch Level 000006](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019682&support_package=SP018&patch_level=000006)
- [SP019 Patch Level 000005](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019682&support_package=SP019&patch_level=000005)
- [SP020 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019682&support_package=SP020&patch_level=000000)
- [SP021 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019682&support_package=SP021&patch_level=000000)

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001462022019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002813811?language=en-US&token=DAEB3B3E975264800C38A21E9F5A84D4)
- [Share by Email](mailto:?body=https://me.sap.com/notes/2813811)

*Credits to [Redrays](https://redrays.io) for support to provided information.*