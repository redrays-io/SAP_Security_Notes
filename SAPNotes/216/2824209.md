2824209 - Clickjacking vulnerability in SAP Process Integration (Integration Builder Framework)

---

**SAP Security Note 2824209 - Clickjacking vulnerability in SAP Process Integration (Integration Builder Framework)**

**Number:** 2824209  
**Type:** SAP Security Note  
**Version:** 3  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 10.11.2020  
**Component:** Basis Components > NetWeaver Process Integration (PI) > Integration Builder - Configuration

### Description

#### Symptom

The Integration Builder Framework of SAP Process Integration does not restrict or incorrectly restricts frame objects or UI layers that belong to another application or domain, resulting in a Clickjacking vulnerability.

An attacker who successfully exploited this vulnerability could view and modify user data.

#### Other Terms

UI redressing attack, SAP Process Orchestration

#### Reason and Prerequisites

An appropriate clickjacking protection for JSPs of the Integration Builder Framework was missing.

#### Solution

The vulnerability has been fixed with the Support Packages and Patches referenced by this SAP Security Note.

### CVSS

**Score:** 5.4  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N

### Support Package Patches

Multiple Support Package Patches are available for different Software Component Versions. Below are some key patches:

| Software Component Version | Support Package | Patch Level | URL |
|----------------------------|-----------------|-------------|-----|
| ESR 7.20                   | SP009           | 000023      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200013139&support_package=SP009&patch_level=000023) |
| ESR 7.50                   | SP015           | 000005      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001567&support_package=SP015&patch_level=000005) |
| XI TOOLS 7.50              | SP015           | 000006      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001666&support_package=SP015&patch_level=000006) |
| ESR 7.50                   | SP016           | 000001      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001567&support_package=SP016&patch_level=000001) |
| XI TOOLS 7.50              | SP016           | 000001      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001666&support_package=SP016&patch_level=000001) |
| ESR 7.50                   | SP017           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001567&support_package=SP017&patch_level=000000) |
| XI TOOLS 7.50              | SP017           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001666&support_package=SP017&patch_level=000000) |
| ESR 7.11                   | SP019           | 000002      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006990&support_package=SP019&patch_level=000002) |
| XI TOOLS 7.11              | SP019           | 000002      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006992&support_package=SP019&patch_level=000002) |
| XI TOOLS 7.30              | SP019           | 000007      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015138&support_package=SP019&patch_level=000007) |
| ESR 7.30                   | SP019           | 000006      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015135&support_package=SP019&patch_level=000006) |
| ESR 7.40                   | SP020           | 000004      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019736&support_package=SP020&patch_level=000004) |
| XI TOOLS 7.40              | SP020           | 000004      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019735&support_package=SP020&patch_level=000004) |
| XI TOOLS 7.11              | SP020           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006992&support_package=SP020&patch_level=000000) |
| ESR 7.11                   | SP020           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006990&support_package=SP020&patch_level=000000) |
| XI TOOLS 7.30              | SP020           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015138&support_package=SP020&patch_level=000000) |
| ESR 7.30                   | SP020           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015135&support_package=SP020&patch_level=000000) |
| XI TOOLS 7.40              | SP021           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019735&support_package=SP021&patch_level=000000) |
| ESR 7.40                   | SP021           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019736&support_package=SP021&patch_level=000000) |
| ESR 7.30                   | SP021           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015135&support_package=SP021&patch_level=000000) |
| XI TOOLS 7.30              | SP021           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015138&support_package=SP021&patch_level=000000) |
| ESR 7.40                   | SP022           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019736&support_package=SP022&patch_level=000000) |
| XI TOOLS 7.40              | SP022           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019735&support_package=SP022&patch_level=000000) |
| ESR 7.10                   | SP024           | 000003      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006458&support_package=SP024&patch_level=000003) |
| XI TOOLS 7.10              | SP024           | 000003      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200005213&support_package=SP024&patch_level=000003) |
| ESR 7.31                   | SP025           | 000004      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017831&support_package=SP025&patch_level=000004) |
| XI TOOLS 7.31              | SP025           | 000004      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017830&support_package=SP025&patch_level=000004) |
| XI TOOLS 7.10              | SP025           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200005213&support_package=SP025&patch_level=000000) |
| ESR 7.10                   | SP025           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006458&support_package=SP025&patch_level=000000) |
| XI TOOLS 7.31              | SP026           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017830&support_package=SP026&patch_level=000000) |
| ESR 7.31                   | SP026           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017831&support_package=SP026&patch_level=000000) |
| ESR 7.31                   | SP027           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017831&support_package=SP027&patch_level=000000) |
| XI TOOLS 7.31              | SP027           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200017830&support_package=SP027&patch_level=000000) |

*For the complete list of Support Package Patches, please refer to the original SAP Security Note.*

### Manual Activities

Two manual activities are required to fully mitigate the vulnerability:

1. **For SAP_XITOOL (XI TOOLS):**  
   Perform manual activities separately in each system where the Note is transported. To fully mitigate against this attack, enable the clickjacking protection framework by executing the manual activities described in:
   - [SAP Note 2170590 - Whitelist service for Clickjacking Framing Protection in AS JAVA](https://me.sap.com/notes/0002170590)
   - [SAP Note 2263656 - Whitelist based Clickjacking Framing Protection in HTMLB Java](https://me.sap.com/notes/0002263656)

   If running any custom JSPs on AS Java, refer to:
   - [SAP Note 2290783 - Whitelist based Clickjacking Framing Protection for Java Server Pages](https://me.sap.com/notes/0002290783)

2. **For SAP_XIESR (XI ESR):**  
   Similarly, perform the manual activities in each system as described above.

### References

- [SAP Note 2290783 - Whitelist based Clickjacking Framing Protection for Java Server Pages](https://me.sap.com/notes/0002290783)
- [SAP Note 2263656 - Whitelist based Clickjacking Framing Protection in HTMLB Java](https://me.sap.com/notes/0002263656)
- [SAP Note 2170590 - Whitelist service for Clickjacking Framing Protection in AS JAVA](https://me.sap.com/notes/0002170590)

### Side Effects

This document causes the following side effect:

- [SAP Note 2892190 - Access to Additional Information section on index page is allowed with limited User Roles](https://me.sap.com/notes/0002892190)

**Credits:** [redrays.io](https://redrays.io) for support in providing information.