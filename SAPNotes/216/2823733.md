2823733 - Update 1 to Security Note 2808158: [CVE-2019-0330] OS Command Injection vulnerability in SAP Diagnostics Agent

**SAP Security Note 2823733** addresses a critical OS Command Injection vulnerability in the SAP Diagnostics Agent, identified as [CVE-2019-0330](https://me.sap.com/notes/2808158). This update replaces the corrections provided in [Security Note 2808158](https://me.sap.com/notes/2808158).

### Details

- **Type:** SAP Security Note
- **Version:** 7
- **Recency:** Updated
- **Language:** English
- **Category:** Program error
- **Priority:** HotNews
- **Status:** Released for Customer
- **Released On:** 12.11.2019
- **Component:** Service > SAP Solution Manager > Diagnostics > Infrastructure / Framework > Agent Framework

### Description

The OS Command Plugin in the transaction `GPA_ADMIN` and the `OSCommand Console` allow an attacker to inject code that can be executed by the application. This vulnerability enables an attacker to control the behavior of the application through:

- Unauthorized execution of commands
- Sensitive information disclosure
- Denial of Service

### Impact

- **CVSS Score:** 9.1
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H](https://me.sap.com/notes/2823733?language=en-US)

### Solution

Apply the new **LM_SERVICE** patch as per the referenced SAP Notes for your Support Package. Ensure that the number of allowed control characters is reduced and verify that all used commands, especially those manually added to `commands.xml`, continue to function correctly.

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001615342019)
- [PDF Version](https://me.sap.com/notes/0002823733?language=en-US&token=8BF0FEDE90ECCD7343F0CAB4088336CD)
- [Show Changes](https://me.sap.com/notes/0002823733/E/diff)

### References

- [LM-SERVICE 7.20 SP 7 Patch 12](https://me.sap.com/notes/2830313)
- [LM-SERVICE 7.20 SP 8 Patch 10](https://me.sap.com/notes/2830305)
- [LM-SERVICE 7.20 SP 6 Patch 10](https://me.sap.com/notes/2830273)
- [LM-SERVICE 7.20 SP 4 Patch 10](https://me.sap.com/notes/2830263)
- [LM-SERVICE 7.20 SP 3 Patch 6](https://me.sap.com/notes/2830251)
- [LM-SERVICE 7.20 SP 5 Patch 11](https://me.sap.com/notes/2830230)
- [LM-SERVICE 7.20 SP 9 Patch 1](https://me.sap.com/notes/2812129)

### Available Translations

- [Deutsch](https://me.sap.com/notes/0002823733/D)
- [日本語](https://me.sap.com/notes/0002823733/J)
- [Português](https://me.sap.com/notes/0002823733/P)
- [Español](https://me.sap.com/notes/0002823733/S)
- [Français](https://me.sap.com/notes/0002823733/F)
- [Italiano](https://me.sap.com/notes/0002823733/I)
- [Русский](https://me.sap.com/notes/0002823733/R)
- [中文](https://me.sap.com/notes/0002823733/1)
- [한국어](https://me.sap.com/notes/0002823733/3)

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*