SAP Security Note 2814357 - [CVE-2019-0389] Privilege escalation in SAP NetWeaver Application Server Java

**SAP Security Note 2814357** addresses a critical vulnerability identified as [CVE-2019-0389](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0389) in the SAP NetWeaver Application Server Java. Here's a summary of the key information and recommended actions:

### **Symptom**
An administrator can alter privileges for Java Server functions, allowing users to execute unauthorized functions. Specifically, Enterprise Java Beans (EJBs) called via the deprecated JCo RFC Provider service may run with elevated permissions if an administrator manually starts or restarts a JCo RFC Provider Destination.

### **Reason and Prerequisites**
The vulnerability arises when an administrator starts or restarts JCo RFC Provider Destinations via the NetWeaver Administration UI (NWA). EJBs called through these destinations execute with the administrator's permissions. This issue does not affect destinations started automatically at AS Java startup or those that perform explicit user logons.

### **Solution**
To mitigate this vulnerability:
1. **Download and Deploy Patches:** Depending on your SAP NetWeaver release, download and deploy the necessary patches from the "Support Package Patches" section of this [SAP Note 2814357](https://me.sap.com/notes/2814357).
2. **Restart AS Java:** After applying the patches, restart the NetWeaver AS Java instance to ensure the patches take effect.
3. **Default Execution Context:** Post-patch, EJBs called via JCo RFC Provider will run in an anonymous thread context with guest user permissions unless an explicit user logon is performed.

### **CVSS Score**
- **Score:** 5.9
- **Vector:** [CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator/7d2ba9e8-8b7c-4c2b-9d6a-cb5e1c5f1c14)

### **Affected Software Components**
- **J2EE ENGINE FRAMEWORK** versions 7.10 to 7.50

### **Support Package Patches**
Ensure you apply the appropriate support package patches based on your software component version. Detailed patch information and download links are available in the [Support Package Patches](https://me.sap.com/notes/2814357#SupportPackagePatch) section of the SAP Note.

### **Additional Actions**
- **Download for SNOTE:** [Download for SNOTE](https://notesdownloads.sap.com/note/0040000002022462019)
- **PDF Version:** [PDF](https://me.sap.com/sap/support/sfm/notes/print/0002814357?language=en-US&token=980FC4AE0C1DB6506DDE07A1D4BA48F3)
- **Edit Note:** [Edit Note](https://me.sap.com/sap/support/notes/edit/0002814357)
- **Share by Email:** Available on the SAP Note page.
- **Open in New Window:** Available on the SAP Note page.

### **References**
- **Referenced By:** 
  - [Central note for SAP NetWeaver 7.31 SP27 Application Server Java](https://me.sap.com/notes/2924750)
  - [Central note for SAP NetWeaver 7.31 SP26 Application Server Java](https://me.sap.com/notes/2842655)

For more details, visit the [SAP Support Portal](https://me.sap.com/notes/2814357).

*Credits to [RedRays.io](https://redrays.io) for supporting the information provided.*