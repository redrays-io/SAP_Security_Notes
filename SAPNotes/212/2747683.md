2747683 - [CVE-2019-0283] SAP NetWeaver Process Integration (Adapter Engine) vulnerable to Digital Signature Spoofing

**SAP Note Number**: 2747683  
**Title**: [CVE-2019-0283] SAP NetWeaver Process Integration (Adapter Engine) vulnerable to Digital Signature Spoofing  
**Type**: SAP Security Note  
**Version**: 6  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer  
**Released On**: 09.04.2019  
**Component**: Basis Components > NetWeaver Process Integration (PI) > Connectivity > Axis Extension for SOAP Adapter

### Description

#### Symptom
It is possible to spoof XML signatures and send arbitrary requests to the server via the PI Axis adapter. These requests will be accepted by the PI Axis adapter even if the payload has been altered, especially when the signed element is the body of the XML document.

**Impacts of the Digital Signature Spoofing Vulnerability:**
- Arbitrary requests can be sent and accepted by the server, completely bypassing the signature security mechanism in place.
- An attacker can modify critical information.
- In some cases, an attacker can obtain information from the spoofing signer.

**Other Terms:**  
Spoofing of digital signatures, PI Axis Adapter, [CVE-2019-0283](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0283)

#### Reason and Prerequisites
The attacker needs a valid request with a valid signature to use this attack (man-in-the-middle).

### Solution
The issue has been fixed by code correction in the PI Axis Adapter. All signed elements are now checked additionally for their correctness before signature validation.

**Actions to Take:**
- Deploy the fixed Support Packages and Patches referenced by this SAP Note.
- If you are using a very old version of PI with no code correction available, use the following configuration option to minimize the risk:
  - Ensure all incoming requests to the PI Axis Adapter use a secure transport protocol (SSL).

### CVSS

**CVSS Score**: 7.1  
**CVSS Vector**: CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:H/A:N

**Detailed Metrics:**
- **Attack Vector (AV)**: Network
- **Attack Complexity (AC)**: High
- **Privileges Required (PR)**: Low
- **User Interaction (UI)**: None
- **Scope (S)**: Changed
- **Confidentiality Impact (C)**: Low
- **Integrity Impact (I)**: High
- **Availability Impact (A)**: None

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000643142019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002747683?language=en-US&token=F412C545B73C03AD4A26045EC399D7CB)

### References

- [Collective note: SAP NETWEAVER 7.31 SP25 - Process Orchestration (PI)](https://me.sap.com/notes/2782147)
- [Collective note: SAP NETWEAVER 7.5 SP15 - Process Orchestration (PI)](https://me.sap.com/notes/2754302)

### Side Effects

This document is causing side effects with:
- [2798100 - Signature check fails in Axis adapter due to improper spoofing checks](https://me.sap.com/notes/2798100)

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*