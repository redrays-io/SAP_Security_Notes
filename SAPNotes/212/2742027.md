SAP Security Note 2742027 - [CVE-2019-0261] Missing authentication check in SAP HANA Extended Application Services, advanced model

**Symptom**

Under certain circumstances, SAP HANA Extended Application Services, advanced model (XS advanced) does not perform authentication checks properly for XS advanced platform and business users.

Some well-known impacts of faulty authentication checks are:
- Unauthorized access (read, modify, or delete) to sensitive information
- Unauthorized access to administrative or other privileged functionalities

**Other Terms**

Broken authentication, [CVE-2019-0261](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-0261)

**Reason and Prerequisites**

Authentication check for XS advanced users based on SAP HANA user management does not work as expected.

Affected are XS advanced runtime versions 1.0.97 to 1.0.99 running on SAP HANA 1 or SAP HANA 2 SPS0. You may check both versions by executing `xs version` with the xs command line client (xs CLI).

**Solution**

It is recommended to upgrade XS advanced to version 1.0.100 or higher. An update of the underlying SAP HANA system is not required.

In urgent cases or when updating the XS advanced system is not possible on short notice, the following workaround can be applied.

**Workaround**

*Note: The workaround disables the affected OIDC component. As a consequence of the workaround, single sign-on for SAP HANA users (X.509-based or SPNEGO) is deactivated.*

1. Log on as `<sid>adm` on the operating system level and set the property `uaa.oidc.enableoidc` in the `xsuaaserver.ini` file to `false`.
2. Restart the XS advanced server with `XSA restart`. Now the OIDC provider has been registered as inactive.
3. Execute the following commands:
    ```bash
    > cdxs
    > cd uaaserver/tomcat/webapps/
    > rm -rf uaa-security-oidc
    > mv uaa-security-oidc.war uaa-security-oidc.war.deactivate
    ```
4. Restart the XS advanced server again with `XSA restart`.

*After applying the workaround, OIDC needs to be re-activated after updating to a secure version of XS advanced:*
1. Log on as `<sid>adm` on the operating system level and set the property `uaa.oidc.enableoidc` in the `xsuaaserver.ini` file to `true`.
2. Restart the XS advanced server with `XSA restart`.

**CVSS**

- **CVSS Score:** 9.4
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

**References**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000249912019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002742027?language=en-US&token=EE33CA8000EA5FC298C56DFABF778007)

**Software Components Affected**

- **SAP_EXTENDED_APP_SERVICES:** From 1 to 1

**Support Package Patches**

- **SAP EXTENDED APP SERVICES 1**
  - **SP000, Patch Level 010100:** [View Patch](https://me.sap.com/swdc/notes?cvnr=73555000100200004274&support_package=SP000&patch_level=010100)

For more details, visit the [SAP Security Notes](https://me.sap.com/notes/0002742027).

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*