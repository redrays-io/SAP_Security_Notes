3022622 - [CVE-2021-21480] Code injection vulnerability in SAP Manufacturing Integration and Intelligence

---

**Description**

SAP MII allows users to create dashboards and save them as JSP through the SSCE (Self Service Composition Environment). An attacker can intercept a request to the server, inject malicious JSP code into the request, and forward it to the server. When this dashboard is opened by users with at least the `SAP_XMII_Developer` role, the malicious content in the dashboard gets executed, leading to remote code execution on the server. This vulnerability allows privilege escalation, where the attacker can execute certain OS commands to read sensitive files on the server, modify files, or delete contents, thereby compromising the confidentiality, integrity, and availability of the server hosting the SAP MII application.

**Impact**

- **CVSS Score:** 9.1
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)

**Solution**

**UPDATE 12th April 2022:** The solution provided in this note is obsolete. For the complete fix, please implement the [SAP Security Note 3158613](https://me.sap.com/notes/3158613).

Saving a file as JSP through SSCE will not be allowed after the installation of this note. There is no workaround to the issue reported. SSCE by default is designed to support JSP creation. Customers should provide access to SSCE only to authorized users. All JSP content should be validated manually before moving it to production systems.

If the correction is not applicable to the support package you are currently using, please upgrade to the next applicable support package.

**References**

- [SAP Note 3025807: Q&A for SAP Security Notes 3022622 and 3158613](https://me.sap.com/notes/3025807)
- [SAP Note 3158613: Update 1 to Security Note 3022622 - [CVE-2021-21480] Code injection vulnerability in SAP Manufacturing Integration and Intelligence](https://me.sap.com/notes/3158613)

**Download**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000337902021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003022622?language=en-US&token=7A8A7D40767558E1D2D31BA3529E1540)

---

*Credits to [RedRays](https://redrays.io) for supporting in providing this information.*