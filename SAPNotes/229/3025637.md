3025637 - [CVE-2021-21492] Content Spoofing in NetWeaver AS Java HTTP Service

**Description**

SAP NetWeaver Application Server Java HTTP Service does not sufficiently validate logon groups in URLs, resulting in a content spoofing vulnerability when directory listing is enabled.

**Impact**

Content spoofing allows attackers to deceive users by presenting malicious content that appears to come from a legitimate source. This can undermine user trust and lead to further security breaches.

**CVSS Score**

- **Score:** 4.3
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N

**Reason and Prerequisites**

Due to a program error, HTTP URL logon groups were not adequately validated against the system configuration, allowing unauthorized content manipulation.

**Solution**

1. **Update Application Server Java:**
   - Apply the latest Support Package or release where the issue is fixed.
   - Refer to the [Support Packages & Patches](https://me.sap.com/notes/0003025637#support-packages) section of this SAP Note for details and available patches.

2. **Configure GroupConfigurationProtection Property:**
   - Open the Config Tool: `/usr/sap/<SID>/<instance>/j2ee/configtool/configtool[.bat .sh]`
   - Navigate to `cluster-data` → `template – Usage_Type_All_in_One` → `services` → `http`.
   - Click on **View → Expert Mode**.
   - Locate the `GroupConfigurationProtection` property and set it to `true`.
   - Save the configuration and restart the cluster.

**Affected Software Versions**

- SERVERCORE versions 7.10 through 7.50

**Support Package Patches**

- **J2EE ENGINE SERVERCORE 7.20**
  - [SP009 Patch 000156](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200013150&support_package=SP009&patch_level=000156)
- **J2EE ENGINE SERVERCORE 7.50**
  - [SP016 Patch 000035](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP016&patch_level=000035)
  - [SP017 Patch 000035](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP017&patch_level=000035)
  - [SP018 Patch 000027](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP018&patch_level=000027)
  - [SP019 Patch 000019](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP019&patch_level=000019)
  - [SP020 Patch 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP020&patch_level=000001)
  - [SP021 Patch 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001452&support_package=SP021&patch_level=000000)
- **J2EE ENGINE SERVERCORE 7.11**
  - [SP020 Patch 000008](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006908&support_package=SP020&patch_level=000008)
- **J2EE ENGINE SERVERCORE 7.30**
  - [SP021 Patch 000005](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200014999&support_package=SP021&patch_level=000005)
- **J2EE ENGINE SERVERCORE 7.40**
  - [SP023 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019683&support_package=SP023&patch_level=000003)
- **J2EE ENGINE SERVERCORE 7.10**
  - [SP025 Patch 000010](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004736&support_package=SP025&patch_level=000010)
- **J2EE ENGINE SERVERCORE 7.31**
  - [SP028 Patch 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014373&support_package=SP028&patch_level=000003)

**References**

- [CVE-2021-21492](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21492)
- [SAP Note 3025637](https://me.sap.com/notes/0003025637)

**Credits**

Supported by [Redrays.io](https://redrays.io)