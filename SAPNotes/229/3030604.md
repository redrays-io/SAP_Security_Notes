3030604 - [CVE-2021-33663] Plaintext Injection in SAP NetWeaver AS for ABAP

**Symptom**

Due to improperly restricting I/O buffering, SAP NetWeaver AS ABAP allows an unauthorized attacker to insert cleartext commands into encrypted SMTP sessions over the network which can partially impact the integrity of the application.

**Other Terms**

[CVE-2021-33663](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33663)

**Reason and Prerequisites**

The implementation does not properly restrict I/O buffering, which allows man-in-the-middle attackers to insert commands into encrypted SMTP sessions by sending a cleartext command that is processed after TLS is in place, related to a "plaintext command injection" attack.

**Solution**

The problem is solved by applying the referenced SAP kernel patch.

This correction is delivered with the kernel archives:

- hotfix - file dw.sar
- SP Stack Kernel - files SAPEXE.SAR and SAPEXEDB.SAR

The correction is contained in all patch levels that are **equal to or higher** than the patch level listed in the "**Support Package Patches**" section of this SAP Note for the desired kernel release. If there is no entry, the patch is not yet delivered. The patch level will be added automatically when the patch is available for download. You can **subscribe** to this SAP Note to get informed when it is updated.

Follow the **SAP recommendations** on how to patch the SAP kernel:

1. Apply the **latest SP Stack Kernel** if it already contains the correction. For the list of current SP Stack Kernels, see SAP Note [2083594](https://me.sap.com/notes/2083594) (SAP Kernel Versions and SAP Kernel Patch Levels).
2. Apply the **hotfix** only if you are experiencing a serious error that is not yet corrected by the latest SP Stack Kernel.
3. Review the **regression note** for the required patch level before installing the kernel patch. For details, see SAP Note [1802333](https://me.sap.com/notes/1802333) (Finding information about regressions in the SAP kernel).
4. For instructions on how to download and install kernel patches, see SAP Note [19466](https://me.sap.com/notes/19466) (Downloading SAP kernel patches).

The paper [Update Strategy for the Kernel of the Application Server ABAP in On Premise Landscapes](https://support.sap.com/deployment-strategies-kernel-abap.pdf) provides detailed information on the SAP recommendations.

**CVSS**

- **CVSS Score:** 5.8
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N)

  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** None (N)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

For more details, refer to the [SAP Security Note 3030604](https://me.sap.com/notes/3030604).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*