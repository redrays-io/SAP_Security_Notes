3032624 - [CVE-2021-33684] Memory Corruption in SAP NetWeaver AS ABAP and ABAP Platform

**SAP Security Note 3032624 - CVE-2021-33684: Memory Corruption in SAP NetWeaver AS ABAP and ABAP Platform**

**Symptom**

A memory corruption vulnerability in SAP NetWeaver AS ABAP and ABAP Platform allows an attacker to send overlong content in an RFC request, causing the corresponding work process to crash. This can lead to partial impact on the availability of the SAP system as the work process attempts to restart itself after the crash.

**Affected Components**

- **SAP NetWeaver AS ABAP and ABAP Platform**
- **Kernel Versions:**
  - 7.21, 7.21EXT
  - 7.22, 7.22EXT, 7.22_EX2
  - 7.49, 7.53, 7.77, 7.81, 7.84
  - 8.04
- **Architectures:**
  - 32-BIT, 64-BIT UNICODE

**CVSS Score**

- **Base Score:** 5.3
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L

**Solution**

To address this vulnerability, apply the correction provided in SAP Note 3032624. The correction controls the length of data packages to prevent memory corruption and subsequent crashes.

**Steps to Apply the Patch:**

1. **Download the Patch:**
   - [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000994672021)
   - [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003032624?language=en-US&token=6A8385B7ED49877D37E5F9272FA8AA2E)

2. **Apply the Latest SP Stack Kernel:**
   - Ensure your system is updated to the patch level listed in the "Support Package Patches" section of this SAP Note.
   - Refer to [SAP Note 2083594](https://me.sap.com/notes/2083594) for a list of current SP Stack Kernels.

3. **Apply the Hotfix (if necessary):**
   - Only if experiencing a serious error not yet corrected by the latest SP Stack Kernel.

4. **Review Regression Notes:**
   - Check [SAP Note 1802333](https://me.sap.com/notes/1802333) for information on potential regressions before installing the kernel patch.

5. **Download and Install Kernel Patches:**
   - Follow instructions in [SAP Note 19466](https://me.sap.com/notes/19466).

For detailed guidance, refer to the [Update Strategy for the Kernel of the Application Server ABAP in On Premise Landscapes](https://support.sap.com/deployment-strategies-kernel-abap.pdf).

**Side Effects**

Applying this correction may cause side effects with:

- **SAP Note 3085973:** [rabax during sapgui logon](https://me.sap.com/notes/3085973)

**Credits**

Information supported by [Redrays.io](https://redrays.io).