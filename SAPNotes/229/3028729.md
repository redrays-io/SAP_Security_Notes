3028729 - [CVE-2021-27603] Denial of Service(DoS) in SAP NetWeaver AS of ABAP

## Header Data
- **SAP Note/KBA**: 3028729
- **Type**: SAP Security Note
- **Version**: 5
- **Recency**: New
- **Language**: English
- **Master Language**: English
- **Category**: Performance
- **Priority**: Correction with medium priority
- **Release Status**: Released for Customer
- **Released On**: 13.04.2021
- **Component**: BC-SRV-PMI
- **Component Description**: Basis Components > Basis Services/Communication Interfaces > Process Monitoring Infrastructure

## Description

### Symptom
An RFC enabled function module `SPI_WAIT_MILLIS` in SAP NetWeaver AS ABAP allows an attacker to keep a work process busy for any length of time. The attacker could call this function module multiple times to block all work processes thereby causing Denial of Service and affecting the entire availability of the SAP system.

Some well-known impacts of Denial of Service vulnerability are:
- Long response delays and service interruptions, thus degrading the service quality experienced by legitimate users
- Direct impact on availability

### Other Terms
DoS, DDoS, Distributed Denial of Service, Uncontrolled Resource consumption, Resource Exhaustion, [CVE-2021-27603](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27603)

### Solution
Implement the correction instruction attached to this note.

The respective function module is changed so that no code is executed anymore that can cause a response delay.

**Information for systems with release 730**: The fix is not contained in a support package for release 730. This means that customers who are on release 730 have to implement this note explicitly. For all other releases for which this note is valid, the fix is contained in a support package.

## CVSS
- **CVSS Score**: 6.5
- **CVSS Vector**: [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H)

  - **Attack Vector (AV)**: Network (N)
  - **Attack Complexity (AC)**: Low (L)
  - **Privileges Required (PR)**: Low (L)
  - **User Interaction (UI)**: None (N)
  - **Scope (S)**: Unchanged (U)
  - **Confidentiality Impact (C)**: None (N)
  - **Integrity Impact (I)**: None (N)
  - **Availability Impact (A)**: High (H)

## Correction Instructions

| Software Component | Number of Correction Instructions | URL |
|--------------------|-----------------------------------|-----|
| SAP_BASIS          | 1                                 | [https://me.sap.com/corrins/0003028729/41](https://me.sap.com/corrins/0003028729/41) |

## Software Components

| Software Component | From | To |
|--------------------|------|----|
| SAP_BASIS          | 702  | 702|
| SAP_BASIS          | 730  | 730|
| SAP_BASIS          | 731  | 731|
| SAP_BASIS          | 740  | 740|
| SAP_BASIS          | 750  | 752|

## Support Package

| Software Component Version | Support Package          | URL |
|----------------------------|--------------------------|-----|
| SAP_BASIS 702              | SAPKB70224               | [https://me.sap.com/supportpackage/SAPKB70224](https://me.sap.com/supportpackage/SAPKB70224) |
| SAP_BASIS 731              | SAPKB73129               | [https://me.sap.com/supportpackage/SAPKB73129](https://me.sap.com/supportpackage/SAPKB73129) |
| SAP_BASIS 740              | SAPKB74026               | [https://me.sap.com/supportpackage/SAPKB74026](https://me.sap.com/supportpackage/SAPKB74026) |
| SAP_BASIS 750              | SAPK-75021INSAPBASIS      | [https://me.sap.com/supportpackage/SAPK-75021INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75021INSAPBASIS) |
| SAP_BASIS 751              | SAPK-75113INSAPBASIS      | [https://me.sap.com/supportpackage/SAPK-75113INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75113INSAPBASIS) |
| SAP_BASIS 752              | SAPK-75209INSAPBASIS      | [https://me.sap.com/supportpackage/SAPK-75209INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75209INSAPBASIS) |

## Available Languages
- [Deutsch](https://me.sap.com/notes/0003028729/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0003028729/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003028729/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003028729/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003028729/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003028729/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003028729/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003028729/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003028729/3)

## Additional Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000540132021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003028729?language=en-US&token=BB73CC3E1C9F112927FD54849526B082)

Credits to [https://redrays.io](https://redrays.io) for support to provided information.