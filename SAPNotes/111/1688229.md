SAP Security Note 1688229 - Information disclosure due to missing auth. in EWA functions

**SAP Note/KBA:** 1688229  
**Type:** SAP Security Note  
**Version:** 5  
**Recency:** Updated  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 19.05.2014  
**Component:** Service > SAP Solution Manager > Service Data Download (SV-SMG-SDD)

### Title
**1688229 - Information disclosure due to missing auth. in EWA functions**

### Description
#### Symptom
An authenticated user can use remote functions of the Service Data framework (Addon ST-PI, SAP Solution Tools Plug-In) to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**  
CVSS Base Score: 3.5  
CVSS Base Vector: AV:N/AC:M/AU:S/C:P/I:N/A:N

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/).

#### Reason and Prerequisites
Several remote enabled functions of the Service Data framework do not contain authorization checks for checking an authenticated user's authorization to access some of its functions. This may result in information disclosure.

The functions are used for remote services such as the EarlyWatch Alert (EWA).

### Solution
**Apply Support Package ST-PI 2008_1_* SP08.** The solution in this support package consists of the following: In Support Package ST-PI 2008_1_* SP08 the remote functions are either supplied with authorization checks or they are no more remote enabled.

**Correction Instructions For Support Packages Below SP08**

If you cannot apply SP08 you can use the correction instructions. Please apply the respective correction instructions of this note. Ensure that users collecting service data have the relevant authorization:
- **Scenario 1:** If you create users in managed systems through the managed system setup procedure in Solution Manager (transaction SOLMAN_SETUP) the administrative user you specify will later be used to run SDCCN and collect data.
- **Scenario 2:** The user setting up the EarlyWatch Alert according to [SAP Note 207223](https://me.sap.com/notes/207223) in Service Data Control Center (transaction SDCCN) must have the appropriate authorization to activate the task manager of SDCCN.

The correction adds authorization checks for authorization object `SDCC_RUN_N` `READ`.

**Workaround For Old ST-PI AddOn Versions**

If you are using an old version of the ST-PI AddOn, you can enable the authorization check for remote function calls if not yet done. Users need the following authorizations to access the remote enabled functions:
- **Authorization object:** S_RFC
- **RFC function group:** /SDF/EWA

### Additional Information
For accessing specific ST-PI Function Modules remotely:
- **Function Module /SDF/EWA_GET_USER_ACCOUNTS:** Since Support Package ST-PI 2008_1_* SP06, this module is no longer remote enabled. Consider using functionality of the Central User Administration, such as function module `SUSR_ZBV_REMOTE_USERS_GET`.
- **Function Module /SDF/EWA_GET_PARAMETER_DATA:** In Support Package ST-PI 2008_1_* SP06 to SP07, this module is not remote enabled. See [SAP Note 1800234](https://me.sap.com/notes/1800234) for more information.

### Available Languages
- 日本語 ([Japanese](https://me.sap.com/notes/0001688229/J))
- Deutsch ([German - Machine Translation](https://me.sap.com/notes/0001688229/D))
- Português ([Portuguese - Machine Translation](https://me.sap.com/notes/0001688229/P))
- Español ([Spanish - Machine Translation](https://me.sap.com/notes/0001688229/S))
- Français ([French - Machine Translation](https://me.sap.com/notes/0001688229/F))
- Italiano ([Italian - Machine Translation](https://me.sap.com/notes/0001688229/I))
- Русский ([Russian - Machine Translation](https://me.sap.com/notes/0001688229/R))
- 中文 ([Chinese - Machine Translation](https://me.sap.com/notes/0001688229/1))
- 한국어 ([Korean - Machine Translation](https://me.sap.com/notes/0001688229/3))

### References
- [SAP Note 207223](https://me.sap.com/notes/207223)
- [SAP Note 1800234](https://me.sap.com/notes/1800234)

**Credits:** Thanks to [redrays.io](https://redrays.io) for supporting the information provided.