1687477 - Unauthorized modification in BSP in CA-GTF-IC-SCR 3

## Symptom

CA-GTF-IC-SCR can be abused by a malicious user, allowing them to modify displayed application content without authorization, and to potentially obtain authentication information from other legitimate users.

## Other Terms

Cross-site scripting, XSS, CA-GTF-IC-SCR

## Reason and Prerequisites

BSP Pages:

- `CRM_IC_ISE REUPLOAD.HTM`
- `CRM_IC_ISE UPLOAD.HTM`

Within CA-GTF-IC-SCR, OUTPUT parameters are not sufficiently encoded, resulting in a cross-site scripting issue.

Cross-site scripting can be used to steal another user's authentication information, such as data relating to their current session. A malicious user who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user.

If an administrator is impersonated, the security of the application may be fully compromised.

## Solution

Please apply this note or import the changes via the relevant support package.

**REMARK:** There are 3 notes which belong together:

1. CA-GTF-IC-SCR 1 ([1687426](https://me.sap.com/notes/1687426))
2. CA-GTF-IC-SCR 2 ([1632687](https://me.sap.com/notes/1632687))
3. CA-GTF-IC-SCR 3 ([1687477](https://me.sap.com/notes/1687477))

**Application Order for CRM 7.0 EHP2:**

1. Implement note [1687426](https://me.sap.com/notes/1687426) first.
2. Afterwards, implement note [1632687](https://me.sap.com/notes/1632687).
3. Finally, apply the present note [1687477](https://me.sap.com/notes/1687477).

For all releases below EHP2 of CRM 7.0, it is sufficient to implement only note [1687426](https://me.sap.com/notes/1687426), as it contains all the relevant changes.

**Download Links:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010024452017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001687477?language=en-US&token=4374A5A8A97CBF1D23C22D231131450E)

## References

- [BSP: Design2008 for release 7.00 and 7.01 (1671470)](https://me.sap.com/notes/1671470)
- [ABAP XSS Escaping Support (1582870)](https://me.sap.com/notes/1582870)
- [Security options (XSS) for ESCAPE (1582867)](https://me.sap.com/notes/1582867)

**Credits:** Information provided with support from [redrays.io](https://redrays.io)