New SAP Security Note 1509753: XSRF Protection for BSP Application WebDocuments

**SAP Note Number:** 1509753  
**Type:** SAP Security Note  
**Version:** 8  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 14.12.2010  

**Component:** CA-DMS (Cross-Application Components > Document management)  

**Title:** 1509753 - Webdocs: XSRF Protection for BSP Application WebDocuments

### Description

**Symptom**  
The XSRF protection provided by the BSP Framework is not adapted to the application WebDocuments, which is a BSP application.

**Other Terms**  
XSRF Protection, BSP, Session Forgery, WebDocuments.

**Reason and Prerequisites**  
The application WebDocuments needed to adapt the XSRF protection provided by the BSP Framework/NetWeaver. [Note 1505976](https://me.sap.com/notes/1505976) is a prerequisite.

**Solution**  
1. **Implement Corrections:** Apply the corrections attached to this note. These corrections are valid for releases up to Ehp4 (604 for EA-APPL). For Ehp5 (605 for EA-APPL) and higher, the corrections are not applicable as the XSRF protection is enabled via the Workbench. Refer to [Note 1505976](https://me.sap.com/notes/1505976).
2. **Additional Information:** Refer to [Note 1520324](https://me.sap.com/notes/1520324) for additional information and instructions. The corrections from this note are a prerequisite for implementing Note 1509753.
3. **Execute Report:** Implement the correction instructions of this note. This will create the report `BSP_XSRF_PARAM_WEBDOCS` in your system.
4. **Run Report:** Execute the report `BSP_XSRF_PARAM_WEBDOCS` and specify a corresponding transport request number when prompted. The report will populate the database table `BSPTEMPXSRFSTORE` with entries for the adapted BSP applications.

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008946162017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001509753?language=en-US&token=4ED4815FF6889043B8A8FB579F407044)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001509753)

### References
- [Note 1797045](https://me.sap.com/notes/1797045)
- [Note 1686627 - Unauthorized modification on document URL in PPM](https://me.sap.com/notes/1686627)
- [Note 1678243 - Unauthorized modification of BSP in WebDocuments (2)](https://me.sap.com/notes/1678243)
- [Note 1670098 - Unauthorized modification of BSP in WebDocuments](https://me.sap.com/notes/1670098)
- [Note 1540729 - ASU content for activating XSRF protection for BSP](https://me.sap.com/notes/1540729)
- [Note 1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)
- [Note 1505976 - Webdocs: Unauthorized Content Modification & Session Handling](https://me.sap.com/notes/1505976)

Credits to [Redrays.io](https://redrays.io) for support to provided information.