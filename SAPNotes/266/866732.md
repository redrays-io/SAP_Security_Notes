SAP Security Note 866732 - Security check when executing external commands/programs (2)

**Note Number:** 866732  
**Type:** SAP Security Note  
**Version:** 4  
**Recency:** New  
**Language:** English  
**Master Language:** German  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 08.10.2009  
**Component:** Basis Components > Computer Center Management System (CCMS) > Background Processing > External and Logical Commands

## Symptom

The security measures described in Note 686765 for external commands and external programs are insufficient for you.

## Reason and Prerequisites

The security check introduced in Note 686765 does not prevent a "hostile" user from packing a command that is forbidden by the negative list into a shell script, and then executing this forbidden command under the name of the shell script.

## Solution

You can use the sapxpg patches described in this note to have the system interpret the file `sapxpg.sec` (refer to Note 686765) as a positive list.

To implement this:
- Assign a three-character value, such as POS, to the environment variable `SAPXPG_SEC_CHECK` on the target host.
- Do not use the character '/' as a separator in the `sapxpg.sec` file; instead, use the character `#`.

### Examples for the `sapxpg.sec` file:

1. 
   ```
   #U#*#C#*#T#3#F#*#O#cp, pwd, ls #S#*#
   ```
   Only the commands `cp`, `pwd`, and `ls` may be executed by all users with the SAP authorization for external commands or external programs.

2. 
   ```
   #U#SMITH#C#*#T#3#F#*#O#cp, pwd, ls #S#*#
   #U#CARTER#C#*#T#3#F#*#O#cp, pwd, ls, rm #S#*#
   #U#SUPERUSER#C#*#T#3#F#*#O#*#S#*#
   ```
   In this example, the user `SUPERUSER` can execute all commands.

### Available Patches:

- **Release 640 sapxpg patch 7**
- **Release 700 sapxpg Patch 1**

In later kernel releases, these functions will be part of the standard release.

For operating systems UNIX and Windows NT, you can replace the program `sapxpg`, Kernel Release 4.6D or 620 with `sapxpg`, Release 640.

## Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000015930242017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0000866732?language=en-US&token=2FA82BB5DDE713749D1F639B8AE101F8)
- [Share by Email](https://me.sap.com/notes/0000866732/S)
- [Open in New Window](https://me.sap.com/notes/0000866732/O)

_For more details, visit [SAP Support](https://me.sap.com/)._

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*