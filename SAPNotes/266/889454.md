SAP Security Note 889454 - XSS attacks via ~designbaseurl

**Overview**

**SAP Note/KBA:** 889454  
**Type:** SAP Security Note  
**Version:** 5  
**Recency:** New  
**Language:** English  
**Master Language:** German  
**Category:** Program error  
**Priority:** Correction with low priority  
**Status:** Released for Customer  
**Released On:** 08.10.2009  
**Component:** Basis Components > Frontend Services (SAP Note 1322184) > SAP Internet Transaction Server

**Description**

### Symptom
When you start a service, the message "Security exploit" appears. In the trace, you can then find entries such as:

```
illegal host in ~designbaseurl=.......
WorkXSSFilter: possible xss exploit
```

### Other Terms
ITS, XSS, CSS, cross-site scripting, security exploit

### Reason and Prerequisites
An insecure parameter has been specified for `~designbaseurl` using the URL or service definition.

### Solution
Both the integrated ITS and the external ITS contain checks to avert possible cross-site scripting attacks. A possible attack could entail infiltration of a CSS file from an external host (in this case, a cascading style sheet) via the parameter `~designbaseurl`. To prevent this, the ITS, by default, allows only the current host on which the integrated or external ITS is running to be specified in `~designbaseurl`. To extend this to a complete domain, proceed as follows:

1. **For the external ITS:**
   - In the `Security/AllowDesignsFrom` key in the registry, enter a list of permitted hosts or domains separated by commas, for example:
     ```xml
     <key name="Security">
       <value name="AllowDesignsFrom" type="text">myhost,.company.com</value>
     </key>
     ```

2. **For the integrated ITS:**
   - Set the parameter in the profile file as follows, for example:
     ```
     itsp/Security/allow_designs_from = myhost,.company.com
     ```
   - Enter the parameter blank in the local profile file to avoid possible error messages due to a parameter not being set. The error message does not occur and the system does not perform a check.

**Caution:** Depending on the kernel patch used, this behavior may differ. It may only be reached as of a certain patch level. On this topic, see [Note 1245048](https://me.sap.com/notes/1245048).

**Supported Software Components**

- **BC-FES-ITS:** From 620 To 630+
- **SAP_BASIS:** From 640 To 640
- **SAP_BASIS:** From 700 To 701
- **SAP_BASIS:** From 710 To 710

**Support Package Patches**

- **SAP BASIS 7.01 SP000 Patch Level 000000**
- **SAP KERNEL 6.40 32-BIT UNICODE SP223 Patch Level 000223:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004051&V=MAINT)
- **SAP KERNEL 6.40 64-BIT UNICODE SP223 Patch Level 000223:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004052&V=MAINT)
- **SAP KERNEL 6.40 32-BIT SP223 Patch Level 000223:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200006931&V=MAINT)
- **SAP KERNEL 6.40 64-BIT SP223 Patch Level 000223:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200006932&V=MAINT)
- **SAP KERNEL 7.10 32-BIT UNICODE SP092 Patch Level 000092:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004840&V=MAINT)
- **SAP KERNEL 7.10 32-BIT SP092 Patch Level 000092:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004834&V=MAINT)
- **SAP KERNEL 7.10 64-BIT UNICODE SP092 Patch Level 000092:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004838&V=MAINT)
- **SAP KERNEL 7.10 64-BIT SP092 Patch Level 000092:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004839&V=MAINT)

**Available Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000015969202017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0000889454?language=en-US&token=C6CE0EADEE3616BF7A057813914A4B8A)
- [Share by Email](#)
- [Open in New Window](#)

**Attributes**

- **Other Components:** Basis Components > Frontend Services (SAP Note 1322184) > SAP GUI for HTML (BC-FES-WGU)

**Credits**

Information supported by [Red Rays](https://redrays.io).