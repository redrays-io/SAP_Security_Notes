915084 - Security Note: Correction Web Application Server

# Security Note 915084: Correction Web Application Server

**SAP Note/KBA:** 915084  
**Type:** SAP Security Note  
**Version:** 1  
**Recency:** New  
**Language:** English  
**Category:** Special development  
**Priority:** Correction with low priority  
**Status:** Released for Customer  
**Released On:** 08.10.2009  
**Component:** Basis Components > Middleware > Internet Communication Framework

## Description

### Symptom
Security information regarding a vulnerability for certain types of invalid or manipulated response messages.

### Other Terms
Security Advisory, Disclosure

### Reason and Prerequisites
This note describes a workaround solution for the solution provided in note [908147](https://me.sap.com/notes/908147). The workaround can be implemented in ABAP as a modification until the kernel patch with the proper correction can be applied. The modification should then be removed from the system.

With "error," we mean a response message causing an error within the SAP Web Application Server.

**Drawbacks of the Workaround:**
- An error page is displayed differently formatted than the common UI and exposes that this is an SAP Web Application Server.
- The workaround only helps in the ICF channel.
- Side-effects: Rejection of URLs that worked correctly before cannot be excluded, making it more restrictive in case of an error.

## Solution
Insert the following code in class `CL_HTTP_SERVER_NET`, method `RECEIVE_REQUEST`:

```abap
* bg: 04/04/2001: response protocol should be request protocol
  m_protocol_version =
      request->get_header_field( '~server_protocol' ). "#EC NOTEXT
  if m_protocol_version is not initial.
      if m_protocol_version <> 'HTTP/1.0' and
         m_protocol_version <> 'HTTP/1.1'.
         message e000(sr) with 'Wrong Format'. 
      endif.
      response->set_header_field( name = '~server_protocol'
                                 value = m_protocol_version ). "#EC NOTEXT
```

## Attributes

| Key                | Value                                                                                           |
|--------------------|-------------------------------------------------------------------------------------------------|
| Other Components   | Basis Components > Client/Server Technology > Internet Communication Manager (BC-CST-IC)          |
| Other Components   | Basis Components > Security - Read KBA 2985997 for subcomponents (BC-SEC)                       |
| Externally Reported| Yes                                                                                             |

## References

- **This document refers to:** [908147 - security relevant correction (HTTP response serialization)](https://me.sap.com/notes/908147)
- **This document is referenced by:** *None*

## Validity

| Software Component | From | To  |
|--------------------|------|-----|
| SAP_BASIS          | 620  | 640 |
| SAP_BASIS          | 700  | 700 |

## CVSS
**CVSS Score:** 0

## Available Languages
- [Deutsch](https://me.sap.com/notes/0000915084/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0000915084/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0000915084/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0000915084/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0000915084/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0000915084/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0000915084/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0000915084/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0000915084/3)

## Actions

- [Mark as Favorite](#) / [Unmark as Favorite](#)
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016043972017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0000915084?language=en-US&token=CA2D2717C856BD17207438EC4A95E529)
- [Share by Email](#)
- [Open in New Window](#)

---

*Credits to [RedRays](https://redrays.io) for support in providing this information.*