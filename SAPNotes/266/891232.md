891232 - BSP Security Relevant Changes

**SAP Note/KBA**: 891232  
**Type**: SAP Security Note  
**Version**: 2  
**Priority**: HotNews  
**Status**: Released for Customer  
**Released On**: 08.10.2009  
**Component**: BC-BSP (Basis Components > Business Server Pages)  

### Description
This security note addresses Cross-Site Scripting (XSS) and HTTP Header related vulnerabilities within the BSP runtime. Multiple enhancements have been implemented to bolster protection against these security threats.

### Solution

**HTTP Header Errors:**
- [SAP Note 887322: Whitelist checks of sap-exit URL](https://me.sap.com/notes/887322)
- [SAP Note 853878: HTTP WhiteList Check](https://me.sap.com/notes/853878)

**XSS Mitigations:**
- [SAP Note 887323: HTML Encoding of Error Messages](https://me.sap.com/notes/887323)

**Activation of (Test) BSP Applications in Production Systems:**
- [SAP Note 517484: Inactive services in the Internet Communication Framework](https://me.sap.com/notes/517484)
- [SAP Note 887164: BSP Test Applications in Production Systems](https://me.sap.com/notes/887164)

**Programming Aspects:**
- [SAP Note 887168: BSP Page Directive <%@page forceEncode="html"%>](https://me.sap.com/notes/887168)
- [SAP Note 944279: BSP Page Directive <%@page forceEncodeOtr="html"%>](https://me.sap.com/notes/944279)
- [SAP Note 822881: XSS Support for BSP-Extensions HTMLB, XHTMLB and PHTMLB](https://me.sap.com/notes/822881)

### Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000015972452017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0000891232?language=en-US&token=111DC41C399E6453DB2EE772FCFBC771)

### References
- [944279: BSP Page Directive <%@page forceEncodeOtr="html"%> and <OTR>](https://me.sap.com/notes/944279)
- [887323: HTML Encoding of Error Messages](https://me.sap.com/notes/887323)
- [887322: Whitelist checks of sap-exit URL](https://me.sap.com/notes/887322)
- [887168: BSP Page Directive <%@page forceEncode="html"%> & <%html=%>](https://me.sap.com/notes/887168)
- [887164: BSP Test Applications in Production Systems](https://me.sap.com/notes/887164)
- [853878: HTTP WhiteList Check (security)](https://me.sap.com/notes/853878)
- [822881: XSS Support for BSP-Extensions HTMLB, XHTMLB and PHTMLB](https://me.sap.com/notes/822881)
- [517484: Inactive services in the Internet Communication Framework](https://me.sap.com/notes/517484)

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*