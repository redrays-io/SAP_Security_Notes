SAP Security Note 866020 - SAP encoding functions in the Web environment

**SAP Note Number:** 866020  
**Type:** SAP Security Note  
**Version:** 20  
**Released On:** 29.06.2011  
**Priority:** Correction with low priority  
**Status:** Released for Customer  
**Component:** Basis Components > Security - Read KBA 2985997 for subcomponents

### Description

This security note addresses the prevention of Cross-Site Scripting (XSS) vulnerabilities by implementing proper encoding of user inputs in web environments. It emphasizes that user inputs in Internet applications should not be executed directly but should be converted into a safe format before being displayed in a web browser.

#### Symptom
User input using a Web front end, or input from user inputs and log files, is displayed directly, allowing the potential execution of unintended external source code (e.g., JavaScript) in an application.

#### Reason and Prerequisites
To prevent the unintentional execution of external source code, any external user input or content from external sources must be encoded appropriately before being displayed in a web browser.

#### Solution
SAP has developed several encoding methods that comply with OWASP XSS Prevention standards:

- **ABAP (SAP Note 1582870):**  
  The class `CL_ABAP_DYN_PRG` contains XSS encoding methods. Refer to [SAP Note 1487337](https://me.sap.com/support/notes/1487337) for additional details.

- **C/C++ (SAP Note 1582867):**  
  These functions are available exclusively within SAP. Create a customer message for BC-SEC.

- **Java (SAP Note 1590008):**  
  Utilize the security class in the J2EE and JEE libraries (`tc_sec_csi.jar`). These functions are available as per the releases specified in [SAP Notes 1582868](https://me.sap.com/support/notes/1582868), 1582870, and 1590008.

### Available Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000015928892017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0000866020?language=en-US&token=6E2449156087306F298AA80C511BEFC1)
- [Show Changes](https://me.sap.com/notesLatestChanges/0000866020/E/diff)

### References

- [Security Note 1601461 - Update #1 to Security Note 866020](https://me.sap.com/notes/1601461/D)
- [JAVA output encoding (SAP Note 1590008)](https://me.sap.com/notes/1590008/J)
- [ABAP XSS Escaping Support (SAP Note 1582870)](https://me.sap.com/notes/1582870/D)
- [Security options (XSS) for ESCAPE (SAP Note 1582867)](https://me.sap.com/notes/1582867/D)
- [Improved performance of encoding functions in Web environment (SAP Note 985459)](https://me.sap.com/notes/985459/D)
- [ITS: new functions for XSS prevention (SAP Note 903820)](https://me.sap.com/notes/903820/D)

### Valid For

- **SAP_BASIS 620 to 731**

### Support Packages

- [SAPKB64014 for SAP_BASIS 640](https://me.sap.com/supportpackage/SAPKB64014)
- [SAPKB70006 for SAP_BASIS 700](https://me.sap.com/supportpackage/SAPKB70006)
- *(Additional support packages available for different versions)*

### CVSS

- **Score:** 0  
- **Vector:** Not Provided

### Side Effects

No side effects reported.

### Credits

Credits to [redrays.io](https://redrays.io) for support in providing this information.