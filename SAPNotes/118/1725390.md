1725390 - Untrusted XML input parsing possible in GRMG

**Description**

### Symptom
A malicious user can modify an XML-based request to include XML content that is then parsed locally. This could allow a malicious user to perform a denial of service (DoS) on the parsing system, disclose local data that is then returned in the response to the malicious request, or access further network-located resources that are accessible from the parsing system.

### CVSS Information
- **CVSS Base Score:** 5.0
- **CVSS Base Vector:** AV:N/AC:L/AU:N/C:N/I:N/A:P

_SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://service.sap.com/securitynotes/)._

### Other Terms
XML eXternal Entity (XXE), information disclosure, denial of service (DoS), GRMG

### Reason and Prerequisites
The problem is caused by a program error in Generic Request and Message Generator (GRMG) due to the incorrect use of an XML parser.

By default, the parser opens external entities referenced within an XML input, which can then lead to malicious content being parsed. This malicious content can reference internal resources, such as files. These internal resources can be disclosed in the response to the request, or can be used to perform a denial of service attack on the parsing system, rendering application content temporarily unavailable.

**Solution**

Please use the recent version of the support package:

| Release       | Support Package   | Patched Component                                |
|---------------|-------------------|--------------------------------------------------|
| 6.40          | SAPJEE.SAR        | grmg.SDA                                         |
| 7.00 - 7.02   | SAPJTECHS.SCA     | grmg.SDA                                         |
| 7.11 - 7.31   | LMCORE.SCA        | com.sap.util.monitor.grmg.SDA                    |

You will find the corresponding patch number of the package in the SP Patch level section of this note.

The fix is in the included patched component. You can use SDM to deploy only the component `grmg.SDA`.

The instance restart will be necessary to restore the GRMG monitoring.

**Caution:** If you decide to import the entire support package `SAPJTECHS.SCA`, you have to import the last available `SAPJTECHF.SCA` ([SAP Note 1395627](https://me.sap.com/notes/1395627)) to avoid issues in WebDynproRuntime. Please check [SAP Note 1395627](https://me.sap.com/notes/1395627) for details.

**References**

- [SAP Note 1759165 - CCMS: Trace of GRMG core services in J2EE](https://me.sap.com/notes/1759165)
- [SAP Note 1395627 - Import a patch for WebDynproRuntime Java](https://me.sap.com/notes/1395627)

**Validity**

| Software Component    | From | To   |
|-----------------------|------|------|
| LM-CORE               | 7.11 | 7.11 |
| LM-CORE               | 7.20 | 7.20 |
| LM-CORE               | 7.30 | 7.30 |
| LM-CORE               | 7.31 | 7.31 |
| SAP_JTECHS            | 6.40 | 6.40 |
| SAP_JTECHS            | 7.00 | 7.02 |

**Support Package Patches**

| Software Component Version       | Support Package | Patch Level | URL                                                                                                                                                                     |
|----------------------------------|-----------------|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| J2EE ENGINE LM-CORE 7.20         | SP009           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200013061&support_package=SP009&patch_level=000000)                                               |
| J2EE ENGINE LM-CORE 7.30         | SP009           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200014920&support_package=SP009&patch_level=000000)                                               |
| SAP JAVA TECH SERVICES 7.01       | SP009           | 000026      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010811&support_package=SP009&patch_level=000026)                                               |
| SAP JAVA TECH SERVICES 7.02       | SP009           | 000023      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012532&support_package=SP009&patch_level=000023)                                               |
| SAP JAVA TECH SERVICES 7.02       | SP008           | 000020      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012532&support_package=SP008&patch_level=000020)                                               |
| SAP JAVA TECH SERVICES 7.02       | SP012           | 000001      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012532&support_package=SP012&patch_level=000001)                                               |
| SAP JAVA TECH SERVICES 7.01       | SP012           | 000004      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010811&support_package=SP012&patch_level=000004)                                               |
| SAP JAVA TECH SERVICES 7.02       | SP007           | 000027      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012532&support_package=SP007&patch_level=000027)                                               |
| J2EE ENGINE LM-CORE 7.31          | SP006           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014365&support_package=SP006&patch_level=000000)                                               |
| SAP JAVA TECH SERVICES 7.02       | SP006           | 000023      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012532&support_package=SP006&patch_level=000023)                                               |
| J2EE ENGINE LM-CORE 7.11          | SP011           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006913&support_package=SP011&patch_level=000000)                                               |
| SAP JAVA TECH SERVICES 7.02       | SP011           | 000011      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012532&support_package=SP011&patch_level=000011)                                               |
| SAP JAVA TECH SERVICES 7.01       | SP011           | 000016      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010811&support_package=SP011&patch_level=000016)                                               |
| SAP JAVA TECH SERVICES 7.02       | SP010           | 000020      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012532&support_package=SP010&patch_level=000020)                                               |
| SAP JAVA TECH SERVICES 7.01       | SP010           | 000026      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010811&support_package=SP010&patch_level=000026)                                               |
| SAP JAVA TECH SERVICES 7.01       | SP013           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200010811&support_package=SP013&patch_level=000000)                                               |
| SAP JAVA TECH SERVICES 7.02       | SP013           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012532&support_package=SP013&patch_level=000000)                                               |
| SAP JAVA TECH SERVICES 7.00       | SP024           | 000024      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004227&support_package=SP024&patch_level=000024)                                               |
| SAP JAVA TECH SERVICES 7.00       | SP025           | 000021      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004227&support_package=SP025&patch_level=000021)                                               |
| SAP JAVA TECH SERVICES 7.00       | SP026           | 000015      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004227&support_package=SP026&patch_level=000015)                                               |
| SAP J2EE ENGINE 6.40              | SP026           | 000032      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200006685&support_package=SP026&patch_level=000032)                                               |
| SAP JAVA TECH SERVICES 7.00       | SP027           | 000003      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004227&support_package=SP027&patch_level=000003)                                               |
| SAP J2EE ENGINE 6.40              | SP027           | 000028      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200006685&support_package=SP027&patch_level=000028)                                               |
| SAP JAVA TECH SERVICES 7.00       | SP028           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004227&support_package=SP028&patch_level=000000)                                               |
| SAP J2EE ENGINE 6.40              | SP028           | 000017      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200006685&support_package=SP028&patch_level=000017)                                               |
| SAP JAVA TECH SERVICES 7.00       | SP029           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200004227&support_package=SP029&patch_level=000000)                                               |
| SAP J2EE ENGINE 6.40              | SP029           | 000011      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200006685&support_package=SP029&patch_level=000011)                                               |
| SAP J2EE ENGINE 6.40              | SP030           | 000003      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200006685&support_package=SP030&patch_level=000003)                                               |
| SAP JAVA TECH SERVICES 6.40       | SP031           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200006523&support_package=SP031&patch_level=000000)                                               |
| SAP J2EE ENGINE 6.40              | SP031           | 000000      | [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200006685&support_package=SP031&patch_level=000000)                                               |

**Credits**
Credits to [redrays.io](https://redrays.io) for support in providing the information.