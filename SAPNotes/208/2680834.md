2680834 - [CVE-2018-2463] Server-Side Request Forgery (SSRF) in SAP Hybris Commerce

**Symptom**

The [Omni Commerce Connect API](https://help.hybris.com/6.7.0/hcd/8c19ab00866910148f87bf32d4a60d38.html) (OCC) of SAP Hybris Commerce is vulnerable to server-side request forgery (SSRF) attacks. This is due to a misconfiguration of the XML parser used in the server-side implementation of OCC.

Some well-known impacts of this SSRF vulnerability include:

- Abuse of the trust relationship between the vulnerable server and others
- Bypass host-based and IP-based authentication services
- Read resources that are not accessible to the public
- Reconnaissance of the internal network of the server

**CVSS Information**

**CVSS v3 Base Score:** 5.8 / 10  
**CVSS v3 Base Vector:**

| Metric                     | Value        |
|----------------------------|--------------|
| Attack Vector (AV)         | Network (N)  |
| Attack Complexity (AC)     | Low (L)      |
| Privileges Required (PR)   | None (N)     |
| User Interaction (UI)      | None (N)     |
| Scope (S)                  | Changed (C)  |
| Confidentiality Impact (C) | Low (L)      |
| Integrity Impact (I)       | None (N)     |
| Availability Impact (A)    | None (N)     |

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/securitynotes).

**Other Terms**

Extensible Markup Language (XML), Document Type Definition (DTD), Representational State Transfer (REST), Application Programming Interface (API), SAP Hybris Commerce, [CVE-2018-2463](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2463)

**Reason and Prerequisites**

This vulnerability affects all 6.* versions of SAP Hybris Commerce, including all but the latest patch releases. Earlier versions (which are not supported anymore) may also be affected.

The latest patch releases, published on August 10th, 2018, are not vulnerable.

The latest major release, SAP Hybris Commerce 18.08, is not vulnerable either.

SAP Hybris Commerce is only vulnerable if OCC is enabled. This is true for either OCCv1 or OCCv2, which is enabled by default. Installations that explicitly disable OCC are not vulnerable.

**Solution**

Users of Hybris Commerce can protect from this vulnerability by upgrading to the latest patch release. Currently, these are the latest patch releases that fix this vulnerability:

- [SAP Hybris Commerce 6.1.0.27 Patch Release](https://me.sap.com/jira.hybris.com/browse/PATCH-4882)
- [SAP Hybris Commerce 6.2.0.23 Patch Release](https://me.sap.com/jira.hybris.com/browse/PATCH-4883)
- [SAP Hybris Commerce 6.3.0.20 Patch Release](https://me.sap.com/jira.hybris.com/browse/PATCH-4884)
- [SAP Hybris Commerce 6.4.0.15 Patch Release](https://me.sap.com/jira.hybris.com/browse/PATCH-4885)
- [SAP Hybris Commerce 6.5.0.12 Patch Release](https://me.sap.com/jira.hybris.com/browse/PATCH-4886)
- [SAP Hybris Commerce 6.6.0.8 Patch Release](https://me.sap.com/jira.hybris.com/browse/PATCH-4887)
- [SAP Hybris Commerce 6.7.0.4 Patch Release](https://me.sap.com/jira.hybris.com/browse/PATCH-4888)

Alternatively, users can upgrade to the latest major release, SAP Hybris Commerce 18.08.

The corresponding [software downloads for SAP Hybris Commerce](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL) are available via the SAP Support Portal.

**Impact on Existing Functionality**

Users who relied on DTDs in XML documents that they submit to OCC may experience loss of functionality. This could happen if default values for XML attributes are declared in the DTD of the document but not in the XML document itself. As a workaround, it is recommended to rewrite the respective API clients so they do not add DTDs to their XML documents anymore.

Credits to [redrays.io](https://redrays.io) for support in providing this information.