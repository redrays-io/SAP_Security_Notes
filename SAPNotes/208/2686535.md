2686535 - [CVE-2019-0267] Cross site request forgery in implementation of Manufacturing Integration and Intelligence

**Description**

**Symptom**

MII Illuminator Servlet currently does not provide Anti-XSRF tokens. This might lead to XSRF attacks in case the data is being posted to the Servlet from an external application.

**Other Terms**

MII, Illuminator, XSRF, [CVE-2019-0267](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0267)

**Reason and Prerequisites**

This vulnerability is exploitable only when a call to Illuminator Servlet is made from a custom implementation.

**Solution**

A new flag named "Enable Illuminator Security" has been introduced as part of MII system properties.

If the flag is added, an additional HTTP POST call with a request parameter "Fetch" can be made to Illuminator Servlet in order to fetch the anti-XSRF token. The returned token needs to be sent with every subsequent call in order to prevent the XSRF attack.

The details of the availability of the new flag are added in the Support Packages and Patches section of this note. The "Support Packages & Patches" section will be populated with the relevant patch levels once they are released.

Enabling the flag might cause side effects with Workbench functionality. This flag is only meant for production environments where the Workbench is not used.

**CVSS**

**CVSS Score:** 6.3

**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** Low (L)

**Affected Software Components**

- **XMII** versions 15.0, 15.1, 15.2
- **MII_ADMIN** versions 15.0, 15.1, 15.2

**Support Package Patches**

- [XMII 15.2 SP000 Patch 000012](https://me.sap.com/sap/support/swdc/notes?cvnr=73555000100200008331&support_package=SP000&patch_level=000012)
- [MII_ADMIN 15.2 SP000 Patch 000004](https://me.sap.com/sap/support/swdc/notes?cvnr=73555000100200008332&support_package=SP000&patch_level=000004)
- [XMII 15.0 SP009 Patch 000010](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200021145&support_package=SP009&patch_level=000010)
- [MII_ADMIN 15.0 SP009 Patch 000005](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200021144&support_package=SP009&patch_level=000005)
- [XMII 15.1 SP006 Patch 000023](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001716&support_package=SP006&patch_level=000023)
- [MII_ADMIN 15.1 SP006 Patch 000008](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001715&support_package=SP006&patch_level=000008)

**Download and PDF**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000249922019)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002686535?language=en-US&token=D4E983FD156620075CCF763C902D5B43)

*Credits: [RedRays.io](https://redrays.io) for support in providing this information.*