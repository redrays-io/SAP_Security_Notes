SAP Security Note 2671160: [CVE-2018-2441] Missing Input Validation in ABAP Change and Transport System (CTS)

**SAP Security Note 2671160**

**Title:** [CVE-2018-2441] Missing input validation in ABAP Change and Transport System (CTS)

**Type:** SAP Security Note  
**Version:** 5  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 21.11.2018  
**Component:** [BC-CTS-TMS](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC-CTS-TMS*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

### Symptom
Under certain conditions, the ABAP Change and Transport System (CTS) allows an attacker to transport information which would otherwise be restricted.

### CVSS Information
**CVSS v3 Base Score:** 5.5 / 10  
**CVSS v3 Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:N](https://nvd.nist.gov/vuln-metrics/cvss)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** High (H)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

### Affected Software Components
- **KRNL32NUC** (versions 7.21, 7.21EXT)
- **KRNL32UC** (versions 7.21, 7.21EXT)
- **KRNL64NUC** (versions 7.21 to 7.74)
- **KRNL64UC** (versions 7.21 to 7.74)
- **KERNEL** (versions 7.21 to 7.74)

### Solution
To resolve this vulnerability, perform the following steps:

1. **Update Transport Tools:**
   Install the current versions of the transport tools `tp` (transport control) and `R3trans` (transport) in both export and import systems. Refer to the patches provided for your kernel codeline.

2. **Activate Consistency Check:**
   - Set the transport profile parameter `TLOGOCHECK=TRUE` via the Transport Management System (STMS).
   - **Instructions:**
     1. Call transaction STMS.
     2. Go to "System Overview" and select the transport domain controller.
     3. Navigate to the "Transport Tool Configuration" tab.
     4. Add a new line for the parameter `TLOGOCHECK` and enter `TRUE` as the value.
     5. To apply globally, mark the "Global" radio button. To apply to selected systems, do not mark the "Global" option and set the parameter individually for each system.

   **Note:** Enabling `TLOGOCHECK` may cause errors in release spanning transports or if using custom transport object definitions. It is recommended to:
   - Keep the check disabled in QA systems and monitor transport return codes.
   - Enable the check in productive systems.

### References
- [SAP Note 19466](https://me.sap.com/notes/19466): Downloading SAP kernel patches
- [SAP Note 2713386](https://me.sap.com/notes/2713386): Export of deletion transport ends with returncode 0006

### Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001608142018)  
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002671160?language=en-US&token=9B75B474799E8BA94E5E77D1B6BCD671)

**Credits:** Thanks to [Red Rays](https://redrays.io) for support and providing this information.