2684760 - [CVE-2018-2470] Cross-Site Scripting (XSS) vulnerability in SAP NetWeaver AS ABAP Business Server Pages

### Symptom

**UPDATE 18th October 2018**: Correction Instructions now extended to lower SPs.

*SAP Business Server Pages applications* do not sufficiently encode user-controlled inputs, resulting in Cross-Site Scripting (XSS) vulnerability.

Some well-known impacts of XSS vulnerability are:

- Non-permanently deface or modify displayed content from a website
- Steal authentication information of the user, such as data relating to their current session
- Impersonate the user and access all information with the same rights as the target user

### CVSS Information

**CVSS v3 Base Score**: 6.1 / 10  
**CVSS v3 Base Vector:**

| Key                               | Value        |
|-----------------------------------|--------------|
| AV : Attack Vector                | Network (N)  |
| AC : Attack Complexity            | Low (L)      |
| PR : Privileges Required          | None (N)     |
| UI : User Interaction             | Required (R) |
| S : Scope                         | Changed (C)  |
| C : Impact to Confidentiality     | Low (L)      |
| I : Impact to Integrity           | Low (L)      |
| A : Impact to Availability        | None (N)     |

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://support.sap.com/securitynotes](https://support.sap.com/securitynotes).

### Other Terms

- XSS, stored XSS, X-Content-Type-Options, HTTP header, vulnerability, nosniff, MIME Sniffing, Cross-Site Scripting, CSS, [CVE-2018-2470](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2470)

### Reason and Prerequisites

The header "X-Content-Type-Options" is not set. It can lead to MIME Sniffing Attacks.

### Solution

"X-Content-Type-Options" is added to the HTTP header of BSP and is set to "nosniff" for MIME objects.

### Validity

**Software Components:**

| Software Component | From | To  |
|--------------------|------|-----|
| SAP_BASIS          | 700  | 702 |
| SAP_BASIS          | 730  | 730 |
| SAP_BASIS          | 731  | 731 |
| SAP_BASIS          | 740  | 740 |
| SAP_BASIS          | 750  | 753 |

### Support Package

**Support Packages:**

| Software Component Version | Support Package                | URL                                                                                     |
|----------------------------|--------------------------------|-----------------------------------------------------------------------------------------|
| SAP_BASIS 700              | SAPKB70036                     | [SAPKB70036](https://me.sap.com/supportpackage/SAPKB70036)                              |
| SAP_BASIS 701              | SAPKB70121                     | [SAPKB70121](https://me.sap.com/supportpackage/SAPKB70121)                              |
| SAP_BASIS 702              | SAPKB70221                     | [SAPKB70221](https://me.sap.com/supportpackage/SAPKB70221)                              |
| SAP_BASIS 730              | SAPKB73019                     | [SAPKB73019](https://me.sap.com/supportpackage/SAPKB73019)                              |
| SAP_BASIS 731              | SAPKB73124                     | [SAPKB73124](https://me.sap.com/supportpackage/SAPKB73124)                              |
| SAP_BASIS 740              | SAPKB74021                     | [SAPKB74021](https://me.sap.com/supportpackage/SAPKB74021)                              |
| SAP_BASIS 750              | SAPK-75014INSAPBASIS           | [SAPK-75014INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75014INSAPBASIS)          |
| SAP_BASIS 751              | SAPK-75108INSAPBASIS           | [SAPK-75108INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75108INSAPBASIS)          |
| SAP_BASIS 752              | SAPK-75203INSAPBASIS           | [SAPK-75203INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75203INSAPBASIS)          |
| SAP_BASIS 753              | SAPK-75301INSAPBASIS           | [SAPK-75301INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75301INSAPBASIS)          |

### Correction Instructions

**SAP_BASIS:**

- Number of Correction Instructions: 10  
- [View Correction Instructions](https://me.sap.com/corrins/0002684760/41)

### References

**This document refers to:**
- *(No references)*

**This document is referenced by:**
- *(No references)*

### Attributes

- **Externally Reported**: Yes

### Translations

Available in the following languages:

- [Deutsch](https://me.sap.com/notes/0002684760/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002684760/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002684760/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002684760/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002684760/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002684760/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002684760/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002684760/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002684760/3)

### Credits

Credits to [Redrays.io](https://redrays.io) for support in providing this information.