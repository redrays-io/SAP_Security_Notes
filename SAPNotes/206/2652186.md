2652186 - Denial of Service in B2B Adapters

**Header Data**
- **SAP Note/KBA**: 2652186
- **Type**: SAP Security Note
- **Version**: 5
- **Recency**: Updated
- **Language**: English
- **Master Language**: English
- **Category**: Program error
- **Priority**: Correction with medium priority
- **Release Status**: Released for Customer
- **Released On**: 28.08.2018
- **Component**: BC-XI-CON-B2B
- **Component Path**: [Services & Support](https://me.sap.com/servicessupport) > [KBAs & Notes](https://me.sap.com/servicessupport/knowledge) > [Basis Components](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes) > [NetWeaver Process Integration (PI)](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC-XI*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes) > [Connectivity](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC-XI-CON*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes) > [B2B add-on (business-to-business)](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'BC-XI-CON-B2B*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

**Title**
2652186 - Denial of Service in B2B Adapters

**Description**

### Symptom
B2B Adapters allow an attacker to prevent legitimate users from accessing a service, either by crashing or flooding the service.

Some well-known impacts of Denial of Service vulnerability are:
- Long response delays and service interruptions, thus degrading the service quality experienced by legitimate users
- Direct impact on availability

### CVSS Information
- **CVSS v3 Base Score**: 4.9 / 10
- **CVSS v3 Base Vector**:
  - **Attack Vector (AV)**: Network (N)
  - **Attack Complexity (AC)**: Low (L)
  - **Privileges Required (PR)**: High (H)
  - **User Interaction (UI)**: None (N)
  - **Scope (S)**: Unchanged (U)
  - **Confidentiality Impact (C)**: None (N)
  - **Integrity Impact (I)**: None (N)
  - **Availability Impact (A)**: High (H)

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).

### Other Terms
DoS, DDoS, Distributed Denial of Service, Uncontrolled Resource consumption, Resource Exhaustion, DB Connections Leak

### Reason and Prerequisites
The problem is caused by a resource exhaustion condition. An attacker can launch a specifically crafted request that causes the process to consume excessive resources. As a result, no other processes can allocate new resources, rendering the system unavailable. This condition can be intentionally provoked by an attacker to cause a denial of service.

### Solution
The problem has been resolved by code correction. The archives and the support package stack guide can be found on the SAP [Support Portal](https://me.sap.com/notes/952402).

**Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001698252018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002652186?language=en-US&token=8CB4BE6675F00BEF6DD208534EBBB24A)
- [Share by Email](#)
- [Open in New Window](#)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002652186/E/diff)

**Support Package Patches**
- **B2B TOOLKIT 2.0**
  - [SP000 Patch Level 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73555000100200008347&support_package=SP000&patch_level=000000)
- **B2B TOOLKIT 1.0**
  - [SP004 Patch Level 000107](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200017699&support_package=SP004&patch_level=000107)
  - [SP005 Patch Level 000015](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200017699&support_package=SP005&patch_level=000015)
  - [SP006 Patch Level 000000](#)

**Side Effects**
This document is causing side effects:
- [2682573 - TPM: Input help for selecting EDI message type is not working](https://me.sap.com/notes/0002682573)
- [2684494 - EDI Separator Adapter does not generate negative CONTRL in case of validation error for EDIFACT or EANCOM messages](https://me.sap.com/notes/0002684494)

*Credits to [redrays.io](https://redrays.io) for support to provided information.*