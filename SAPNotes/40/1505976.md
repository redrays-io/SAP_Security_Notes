1505976 - Webdocs: Unauthorized Content Modification & Session Handling

## Description

**SAP Note:** 1505976  
**Type:** SAP Security Note  
**Version:** 4  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 14.12.2010  
**Component:** [Cross-Application Components > Document management (CA-DMS)](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'CA-DMS*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

### Symptom

This security note addresses two critical issues:

1. **Cross Site Scripting (XSS):** The HTML files of the BSP Application WebDocuments are vulnerable to XSS. A malicious user can embed HTML into a page that others will open, allowing unauthorized modification of displayed content and potentially stealing authentication information from legitimate users.

2. **Session Handling:** WebDocuments lack a logoff feature and proper session management, which might lead to session hijacking.

### Reason and Prerequisites

- **XSS Vulnerability:** Insufficient encoding of input and output parameters in WebDocuments allows reflected XSS attacks. Attackers can steal user authentication information and impersonate users, potentially compromising the application's security fully if an administrator is targeted.
  
- **Session Management Issues:** Absence of logoff functionality and proper session handling makes the application susceptible to session hijacking.

## Solution

Implement the corrections provided with this note. Before applying the corrections, perform the following manual steps to maintain OTR texts:

1. **Run Transaction `sotr_edit`:**
   
2. **Create a New Alias:**
   - **Alias:** `CVAW/LOGOFF`
   - **Text:** Logoff
   - **Length:** 11
   - **Package:** CVAW
   - **Language:** English
   - **Object Type:** WAPP

3. **Maintain Translations:** Add the "Logoff" text in other required languages.

4. **Save Changes.**

**Recommendation:** Use the application over HTTPS instead of HTTP to enhance security.

### Download Links

- [Download for SNOTE](https://me.sap.com/note/0040000008922272017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001505976?language=en-US&token=1543048F2F4A1F12A4AF60DF6D587D44)

## References

- [Webdocuments: XSRF Protection for BSP Application WebDocuments](https://me.sap.com/notes/1509753)
- [Unauthorized modification of displayed content in Webdocs](https://me.sap.com/notes/1420256)

## Validity

Applicable to the following software component versions:

- EA-APPL 110
- EA-APPL 200
- EA-APPL 500
- EA-APPL 600
- EA-APPL 602
- EA-APPL 603
- EA-APPL 604
- EA-APPL 605

**Support Packages:**

- [EA-APPL 110 - SAPKGPAA32](https://me.sap.com/supportpackage/SAPKGPAA32)
- [EA-APPL 200 - SAPKGPAB21](https://me.sap.com/supportpackage/SAPKGPAB21)
- [EA-APPL 500 - SAPKGPAC24](https://me.sap.com/supportpackage/SAPKGPAC24)
- [EA-APPL 600 - SAPKGPAD19](https://me.sap.com/supportpackage/SAPKGPAD19)
- [EA-APPL 602 - SAPK-60209INEAAPPL](https://me.sap.com/supportpackage/SAPK-60209INEAAPPL)
- [EA-APPL 603 - SAPK-60308INEAAPPL](https://me.sap.com/supportpackage/SAPK-60308INEAAPPL)
- [EA-APPL 604 - SAPK-60409INEAAPPL](https://me.sap.com/supportpackage/SAPK-60409INEAAPPL)
- [EA-APPL 605 - SAPK-60503INEAAPPL](https://me.sap.com/supportpackage/SAPK-60503INEAAPPL)

## Credit

Credits to [redrays.io](https://redrays.io) for support in providing this information.