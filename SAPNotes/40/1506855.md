SAP Security Note 1506855 - Unauthorized usage of functionality in workflow area

```markdown
**SAP Security Note 1506855 - Unauthorized usage of functionality in workflow area**

**Type:** SAP Security Note  
**Status:** Released for Customer  
**Priority:** Correction with high priority  
**Released On:** 25.11.2011  
**Component:** Basis Components > Business Management > Business Workflow > WebFlow Notifications

### **Symptom**
An attacker can trigger functionality in the Business Workflow area without the relevant authentication and authorization.

**Other Terms:** Cross Site Request Forgery, XSRF, SWN_CONFIG, SWNADMIN, WSCB

### **Reason and Prerequisites**
Specified BSP applications execute certain functions by referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the functions are executed in the Business Workflow area with the user's rights. Additionally, an attacker may use a Cross Site Scripting (XSS) attack to trigger the exploit or present a clickable link to the victim.

### **Solution**
To address this vulnerability, follow these steps:

1. **Prerequisite:**  
   Read [Note 1520324](https://me.sap.com/notes/1520324) for additional information and further instructions. The corrections from Note 1520324 are required before implementing this note.

2. **Implement Correction Instructions:**  
   Apply the correction instructions contained in this note. This will create the program `BSP_XSRF_PARAM_BC_BMT_WFM` in your system, among other changes.

3. **Execute the Program:**  
   Run the program `BSP_XSRF_PARAM_BC_BMT_WFM` and select the transport request when prompted. This program will make the necessary entries for the BSP applications adjusted by this note in the database table `BSPTEMPXSRFSTORE`.

### **Affected Software Components**
- **SAP_BASIS:** Versions 620 to 640, 700 to 702, 710 to 730

### **Support Package**
Ensure you have the appropriate support package installed for your system version:
- [SAPKB62070](https://me.sap.com/supportpackage/SAPKB62070) for SAP_BASIS 620
- [SAPKB64028](https://me.sap.com/supportpackage/SAPKB64028) for SAP_BASIS 640
- [SAPKB70024](https://me.sap.com/supportpackage/SAPKB70024) for SAP_BASIS 700
- ... *(additional support packages listed in the note)*

### **References**
- **Prerequisite Note:** [1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)

### **Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008928062017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001506855?language=en-US&token=3ECF13DE7390BF0FFC64233C5760A7FF)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001506855/E/diff)

### **Translations**
Available in multiple languages, including:
- [Deutsch (Origin)](https://me.sap.com/notes/0001506855/D)
- [日本語](https://me.sap.com/notes/0001506855/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001506855/P)
- ... *(additional languages listed in the note)*

**Credits:** Thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.
```