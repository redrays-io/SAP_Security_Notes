1507211 - FI: Potential Directory Traversal

**SAP Note**: 1507211 - FI: Potential Directory Traversal

**Type**: SAP Security Note  
**Version**: 2  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with high priority  
**Status**: Released for Customer  
**Released On**: December 14, 2010  
**Component**: FI-AP-AP-Q1 (Financial Accounting > Accounts Payable > Basic Functions > Withholding Tax (Reporting))

---

### Description

**Symptom**  
Potential Directory Traversal in the following components:
- FQST

**Other Terms**  
1. Path traversal, FI_RFKQSE20_FILE, FI_RFW1099M_FILE, FI_RF0KQST5_FILE, FI_FQST_FILE_PATH

**Reason and Prerequisites**  
1. The programs contained in the correction instructions contain vulnerabilities through which a malicious user can potentially read arbitrary files on the remote server, possibly disclosing confidential information.
2. Some of the programs contained in the correction instructions contain a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

### Solution

Please refer to [SAP Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions. The corrections from this note are a prerequisite for implementing this note.

**Logical File Names Used in this Solution**

The following logical file names have been created to enable the validation of physical file names:

- **FI_RFKQSE20_FILE**: RFKQSE20
- **FI_RFW1099M_FILE**: RFW1099M
- **FI_RF0KQST5_FILE**: RF0KQST5

**Logical File Paths Used in this Solution**  
All logical file names listed above use the logical file path `FI_FQST_FILE_PATH`.

**Parameters used in this context:**  
- `<PARAM_1>`: Program name (SY-CPROG)

**Recommendations for Setup of Logical File Names**  
When setting up physical file paths, use the predefined parameter `<PARAM_1>` in the transaction FILE.

**Examples**  
- Physical path for syntax group UNIX: `/usr/SAP/data/<SYSID>/<CLIENT>/<PARAM_1>/<Y=USER_NAME>/<FILENAME>`
- Physical file name with data format **DIR**.

---

### Affected Software Components

| Software Component | From | To   |
|--------------------|------|------|
| SAP_APPL           | 31I  | 31I  |
| SAP_APPL           | 40B  | 40B  |
| SAP_APPL           | 45B  | 45B  |
| SAP_APPL           | 46B  | 46B  |
| SAP_APPL           | 46C  | 46C  |
| SAP_APPL           | 470  | 470  |
| SAP_APPL           | 500  | 500  |
| SAP_APPL           | 600  | 600  |
| SAP_APPL           | 602  | 602  |
| SAP_APPL           | 603  | 603  |
| SAP_APPL           | 604  | 604  |
| SAP_APPL           | 605  | 605  |

---

### Support Package

| Software Component Version | Support Package | URL                                      |
|----------------------------|-----------------|------------------------------------------|
| SAP_APPL 31I               | SAPKH31IB9      | [Link](https://me.sap.com/supportpackage/SAPKH31IB9) |
| SAP_APPL 40B               | SAPKH40B89      | [Link](https://me.sap.com/supportpackage/SAPKH40B89) |
| SAP_APPL 45B               | SAPKH45B67      | [Link](https://me.sap.com/supportpackage/SAPKH45B67) |
| SAP_APPL 46B               | SAPKH46B62      | [Link](https://me.sap.com/supportpackage/SAPKH46B62) |
| SAP_APPL 46C               | SAPKH46C62      | [Link](https://me.sap.com/supportpackage/SAPKH46C62) |
| SAP_APPL 470               | SAPKH47036      | [Link](https://me.sap.com/supportpackage/SAPKH47036) |
| SAP_APPL 500               | SAPKH50024      | [Link](https://me.sap.com/supportpackage/SAPKH50024) |
| SAP_APPL 600               | SAPKH60019      | [Link](https://me.sap.com/supportpackage/SAPKH60019) |
| SAP_APPL 602               | SAPKH60209      | [Link](https://me.sap.com/supportpackage/SAPKH60209) |
| SAP_APPL 603               | SAPKH60308      | [Link](https://me.sap.com/supportpackage/SAPKH60308) |
| SAP_APPL 604               | SAPKH60409      | [Link](https://me.sap.com/supportpackage/SAPKH60409) |
| SAP_APPL 605               | SAPKH60503      | [Link](https://me.sap.com/supportpackage/SAPKH60503) |

---

### References

- [1515184: Composite SAP Note: Security for FI-AR/FI-AP](https://me.sap.com/notes/1515184)
- [1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003)

---

**Credits**: Thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.