3539465 - [CVE-2025-27435] Information Disclosure Vulnerability in SAP Commerce Cloud

## Symptom

Under specific conditions and prerequisites, an unauthenticated attacker could access customer coupon codes exposed in the URL parameters of the Coupon Campaign URL in SAP Commerce. This could allow the attacker to use the disclosed coupon code, hence posing a low impact on confidentiality and integrity of the application.

## Other Terms

Information disclosure, Information exposure, [CVE-2025-27435](https://www.cve.org/CVERecord?id=CVE-2025-27435)

## Reason and Prerequisites

The Coupon Campaign URL includes a coupon code as a URL parameter in the GET method, which may leak in very specific conditions.

**Example Coupon Campaign URL:**
- `/my-account/coupon/claim/springfestival`

## Solution

SAP Commerce Cloud addresses this vulnerability by introducing a new solution for claiming customer coupons for both the Accelerator storefront and Composable Storefront. The new solution enables customers to claim their coupons by clicking on a provided URL after logging in. The new URL format, based on the above example, is as follows:
```
{your-storefront}/{site}/en/my-account/coupons#springfestival
```

The new solution securely transmits confidential data through request body parameters by calling newly implemented OCC endpoints. SAP Commerce Cloud also deprecates the Coupon Campaign URL used previously and documents this new solution in the Help Portal.

### SAP Commerce Updates

The following patches of SAP Commerce Cloud contain the UI improvements for the Accelerator storefront:
- [SAP Commerce Patch Release 2205.34](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html)
- [SAP Commerce Cloud Update Release 2211.35](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/12be4ac419604b01aabb1adeb2c4c8a2/f9b65161e1e645249542e59f42f64a7b.html)

The [Software Downloads](https://me.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=73555000100800001224&V=MAINT&TA=ACTUAL/SAP%20COMMERCE%20CLOUD%20V2) are available in the SAP Support Portal:

- [Software Downloads for SAP Commerce Cloud in the Public Cloud](https://launchpad.support.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=73555000100800001224&V=MAINT&TA=ACTUAL/SAP%20COMMERCE%20CLOUD%20V2)
- [Software Downloads for SAP Commerce On-Premise](https://launchpad.support.sap.com/#/softwarecenter/template/products/%20_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL&PAGE=SEARCH/SAP%20COMMERCE)

For information about installing patches, see [About Patch Releases](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/8c25978386691014b4abdd61376acd24.html?locale=en-US). After installing a SAP Commerce Cloud patch, customers need to rebuild and redeploy the updated SAP Commerce Cloud version.

### SAP Composable Storefront Updates

The following version of Spartacus contains the UI improvements: **2211.35**

For more information about new versions of Spartacus, see [this page](https://help.sap.com/docs/SAP_COMMERCE_COMPOSABLE_STOREFRONT/6c7b98dbe68f4a508cac17a207182f4c/5ebbd2c8478a4874863a6b217c0aa2ba.html) and [open source tags on GitHub](https://github.com/SAP/spartacus/tags).

For information about installing Spartacus, see [Building the Composable Storefront From Libraries](https://help.sap.com/docs/SAP_COMMERCE_COMPOSABLE_STOREFRONT/cfcf687ce2544bba9799aa6c8314ecd0/5de67850bd8d487181fef9c9ba59a31d.html#loio5de67850bd8d487181fef9c9ba59a31d).

### Manual Remediation Steps

1. **Install or Upgrade SAP Commerce Cloud**: Ensure you are using SAP Commerce Cloud versions that include the new OCC endpoints.
2. **Apply Accelerator Storefront UI Improvements**: If you have customized the `customercouponaddon` and wish to activate the new solution, refer to the [OOTB customercouponaddon code changes](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/53118c4205b242ee9c1755bae1d54a2f.html#customer-coupon-campaign-url-deprecation).
3. **Apply Spartacus UI Improvements**: Upgrade to Spartacus versions that contain the improvements and enable the configuration `enableClaimCustomerCouponWithCodeInRequestBody` by setting its value to `true`.

## CVSS Information

- **CVSS Score**: 4.2
- **Vector**: [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N)
  - **Attack Vector (AV)**: Network (N)
  - **Attack Complexity (AC)**: High (H)
  - **Privileges Required (PR)**: None (N)
  - **User Interaction (UI)**: Required (R)
  - **Scope (S)**: Unchanged (U)
  - **Confidentiality Impact (C)**: Low (L)
  - **Integrity Impact (I)**: Low (L)
  - **Availability Impact (A)**: None (N)

**CVSS Score Interpretation**: This vulnerability has a moderate impact on confidentiality and integrity, requiring network access and user interaction.

---

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*