3542543 - [CVE-2024-54197] Server-Side Request Forgery in SAP NetWeaver Administrator (System Overview)

**Description**

### Symptom

SAP NetWeaver Administrator (System Overview) allows an authenticated attacker to enumerate accessible HTTP endpoints in the internal network by specially crafting HTTP requests. On successful exploitation, this can result in Server-Side Request Forgery (SSRF), which could have a low impact on the integrity and confidentiality of data. It has no impact on the availability of the application.

### Reason and Prerequisites

**Reason** – A legacy vulnerable servlet was present that lacked additional authentication checks and strict verification of user security roles.

**Prerequisites** – No special prerequisites; the vulnerability exists in the application by default.

### Solution

The vulnerable servlet has been removed, eliminating the vulnerable entry point for the attack.

**Action Required:** Implement the Support Packages and Patches mentioned in this [SAP Security Note](https://me.sap.com/sap/support/sfm/notes/print/0003542543?language=en-US&token=0AB635D1B60D95CE62D9B753753FCB87).

### Workaround

Assess the applicability of the workaround for your SAP landscape before implementation. Note that this workaround is a temporary fix and not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note, which can be done instead of the workaround or after implementing the workaround.

**Steps to Apply the Workaround:**

1. Open the **Java System Properties** in the NetWeaver Administrator (NWA).
2. Click on the **"Show advanced properties"** button and navigate to the **"Filters"** tab.
3. Add a new filter with the following settings:
    - **Action:** `disable`
    - **Vendor:** `sap.com`
    - **Component:** `all components`
    - **Name mask:** `tc~monitoring~webservice~app`
4. Save the changes and restart the cluster to apply the changes. This will disable the System Overview application.

**CVSS Score**

- **Score:** 7.2
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N

**Affected Components**

- **Component:** BC-JAS-ADM-MON
- **Path:** Basis Components > NetWeaver Application Server Java > Local Admin Tools > Monitoring

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001388632024)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003542543?language=en-US&token=0AB635D1B60D95CE62D9B753753FCB87)

**Support Package Patches**

- [SP032 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP032&patch_level=000000)
- [SP028 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP028&patch_level=000007)
- [SP029 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP029&patch_level=000006)
- [SP030 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP030&patch_level=000004)
- [SP026 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP026&patch_level=000007)
- [SP027 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP027&patch_level=000007)
- [SP031 Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001230&support_package=SP031&patch_level=000001)

*Credits to [redrays.io](https://redrays.io) for support in providing the information.*