3540273 - [CVE-2024-45216] Multiple vulnerabilities in Apache Solr within SAP Commerce Cloud

**Symptom**
SAP Commerce Cloud is impacted by a vulnerable version of Apache Solr which allows an attacker to access the database if certain conditions are met. This may result in a low impact on confidentiality, integrity, and availability.

**Affected CVEs**
- [CVE-2024-45216](https://www.cve.org/CVERecord/SearchResults?query=CVE-2024-45216)
- [CVE-2024-45217](https://www.cve.org/CVERecord/SearchResults?query=CVE-2024-45217)

**Reason and Prerequisites**
The vulnerabilities are present if:
- Commerce is running Solr versions before 9.7.0 or before 8.11.4.
- Prerequisites mentioned in CVE-2024-45216 or CVE-2024-45217 are met.

**Solution**
Upgrade your Solr to the latest secure version:
- **8.11.4** and beyond
- **9.7.0** and beyond

**Version Support:**
- Solr 9.7.0 is supported by Commerce version 2211.31 and beyond.
- Solr 8.11.4 is supported until including Commerce version 2211.25.

**References:**
- [Fixed issues in 2211](https://me.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/97ef6fdd814245c2b4a173ada72773a5.html)
- [Fixed issues in 2205](https://me.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html)
- [About Patch Releases](https://me.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/8c25978386691014b4abdd61376acd24.html?locale=en-US)
- [Build Instructions for Public Cloud](https://me.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/79763857d2264a189cb577fc90de0fea.html)
- [Deploy Instructions for Public Cloud](https://me.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/72e126a98eb14b668709be9946070e5c.html)
- [Build and Deploy Instructions for On-Premise](https://me.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/LATEST/en-US/8bb0ad2786691014b930c18dd4cd7851.html)
- [Software Downloads for Public Cloud](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=73555000100800001224&V=MAINT&TA=ACTUAL/SAP%20COMMERCE%20CLOUD%20V2)
- [Software Downloads for On-Premise](https://me.sap.com/launchpad.support.sap.com/#/softwarecenter/template/products/%20_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=INST&TA=ACTUAL&PAGE=SEARCH/SAP%20COMMERCE)
- [Hardened Solr Server Setup for 2205](https://me.sap.com/docs/SAP_COMMERCE/d0224eca81e249cb821f2cdf45a82ace/8c60bc2e866910149815ef4312ef454e.html)
- [Hardened Solr Server Setup for 2211](https://me.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/aa417173fe4a4ba5a473c93eb730a417/8c60bc2e866910149815ef4312ef454e.html)
- [Upgrading Solr Versions](https://me.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/1be46286b36a4aa48205be5a96240672/689a5aded2274fcca535fb8534e4a20c.html)
- [Apache Solr Security Issues](https://solr.apache.org/security.html#recent-cve-reports-for-apache-solr)

**CVSS Score**
- **Score:** 5.5
- **Vector:** [CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss)

**Additional Information:**
SAP Commerce is shipped with a built-in Solr server that shouldn't be used in production. SAP recommends using a hardened standalone Solr server on a separate machine.

**Credits**
Thanks to [Redrays.io](https://redrays.io) for support in providing this information.