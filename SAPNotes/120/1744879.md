SAP Security Note 1744879 - Unauthorized modification of stored content in Data Provider

---

## **Title**
**1744879 - Unauthorized modification of stored content in Data Provider**

## **Description**

### **Symptom**
The SAP GUI Data Provider can be abused by an attacker, allowing them to modify application content, persist the modified content without authorization, and potentially obtain authentication information from other legitimate users.

### **Reason and Prerequisites**
SAP GUI Data Provider results in a **stored cross-site scripting (XSS)** issue. This vulnerability allows attackers to permanently modify displayed content on a website, embedding malicious content that is rendered automatically without targeting victims individually. Stored XSS can be exploited to steal users' authentication information, such as session data. If an administrator's credentials are compromised, the entire application's security may be at risk.

**Prerequisites:**  
- [SAP Note 803637](https://me.sap.com/notes/803637)  
- [SAP Note 851789](https://me.sap.com/notes/851789)  
- [SAP Note 1600429](https://me.sap.com/notes/1600429)

## **Solution**
Implement the corrections outlined in this note or import the relevant support package. The SAP GUI Data Provider will scan documents and block all specified MIME types. **Custom applications** that utilize SAP GUI Data Provider functions or function modules directly might be affected, so it's crucial to review the documentation to prevent potential disruptions.

### **Correction Instructions**
1. **Virus Scan Profile Configuration:**
   - Navigate to **SAP NetWeaver > Application Server > System Administration > Virus Scan Interface (Transaction VSCANPROFILE)**.
   - If necessary, switch to change mode.
   - Select the virus scan profile `/SCET/GUI_UPLOAD`.
   - Configure the following parameters:
     - `CUST_CHECK_MIME_TYPE: 1` (Enable MIME type check)
     - `CUST_ACTIVE_CONTENT: 1` (Block files with active content)
     - `CUST_MIME_TYPES_ARE_BLACKLIST: 1` (Block listed MIME types; allow others)
   - Enter the following MIME types to be blocked:
     ```
     application/ecmascript
     application/java-archive
     application/javascript
     application/x-alf
     application/x-alf-descr
     application/x-jar
     application/x-java-jar
     application/x-javascript
     application/x-shockwave-flash
     application/x-silverlight
     application/x-silverlight-2
     application/x-silverlight-app
     application/xhtml+xml
     text/html
     text/javascript
     text/thtml
     ```
   - Save your entries.

2. **Manual Activities:**
   Perform the above configuration separately in each system where the note is transported.

For detailed instructions, refer to the [VSI Documentation](https://me.sap.com/help_nw73ehp1/helpdata/en/e3/aa783f181b0866e100000a114084/frameset.htm).

## **Downloads**
- [Download for SNOTE](https://me.sap.com/notes/0040000010369002017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001744879?language=en-US&token=59E7E4B45C34A58B3F62893CF402C84E)

## **Support Packages**
Applicable to the following SAP_BASIS versions:

| Software Component Version | Support Package | [URL](https://me.sap.com) |
|----------------------------|-----------------|---------------------------|
| SAP_BASIS 620              | SAPKB62073      | [Link](https://me.sap.com/supportpackage/SAPKB62073) |
| SAP_BASIS 640              | SAPKB64031      | [Link](https://me.sap.com/supportpackage/SAPKB64031) |
| SAP_BASIS 700              | SAPKB70028      | [Link](https://me.sap.com/supportpackage/SAPKB70028) |
| SAP_BASIS 701              | SAPKB70113      | [Link](https://me.sap.com/supportpackage/SAPKB70113) |
| SAP_BASIS 702              | SAPKB70213      | [Link](https://me.sap.com/supportpackage/SAPKB70213) |
| SAP_BASIS 710              | SAPKB71016      | [Link](https://me.sap.com/supportpackage/SAPKB71016) |
| SAP_BASIS 711              | SAPKB71111      | [Link](https://me.sap.com/supportpackage/SAPKB71111) |
| SAP_BASIS 720              | SAPKB72008      | [Link](https://me.sap.com/supportpackage/SAPKB72008) |
| SAP_BASIS 730              | SAPKB73009      | [Link](https://me.sap.com/supportpackage/SAPKB73009) |
| SAP_BASIS 731              | SAPKB73106      | [Link](https://me.sap.com/supportpackage/SAPKB73106) |

## **References**
- [SAP Note 1779433 - SAP GUI: Virus scan is enabled during file upload](https://me.sap.com/notes/1779433)
- [SAP Note 1753745 - Virus scan profile: Enhancement for SAP KW](https://me.sap.com/notes/1753745)

## **Credits**
Information provided with support from [Red Rays](https://redrays.io).