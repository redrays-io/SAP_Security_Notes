SAP Security Note 2077260 - Directory Traversal in IM Summarization Reporting

**Overview**

SAP has released Security Note [2077260](https://me.sap.com/notes/2077260) addressing a directory traversal vulnerability in the Investment Management (IM) Summarization Reporting module. This vulnerability allows an attacker to read or write arbitrary files on the remote server, potentially leading to unauthorized data disclosure or system corruption.

**Symptom**

IM Summarization Reporting contains a vulnerability that allows attackers to:

- **Read Arbitrary Files:** Potentially disclosing confidential information by accessing unauthorized files on the remote server.
- **Write Arbitrary Files:** Potentially corrupting data or altering system behavior by writing unauthorized files to the remote server.

**CVSS Information**

- **Base Score:** 3.8 / 10
- **CVSS Vector:** Not provided in detail.
  
  | Metric                  | Value                  |
  |-------------------------|------------------------|
  | **Attack Vector (AV)**  | Adjacent Network (A)   |
  | **Attack Complexity (AC)** | Medium (M)          |
  | **Privileges Required (PR)** | Single (S)       |
  | **Confidentiality Impact (C)** | Partial (P)    |
  | **Integrity Impact (I)** | Partial (P)            |
  | **Availability Impact (A)** | None (N)          |

*Note: SAP provides this CVSS base score as an estimate of the risk posed and does not account for specific system configurations or operational environments.*

**Reason and Prerequisites**

IM Summarization Reporting fails to correctly validate file paths, allowing attackers to reference arbitrary files within the system. This can lead to:

- **Unauthorized File Access:** Disclosing the contents of sensitive files.
- **Data Corruption:** Overwriting critical system files, leading to potential data loss or altered system behavior.

**Solution**

To mitigate this vulnerability, implement the corrections provided in this security note. Additionally, refer to [SAP Note 1497003](https://me.sap.com/notes/1497003) for further information and instructions, as it is a prerequisite for implementing this security note.

**Logical File Names Used in this Solution**

- **IM_SUMMARIZATION_REPORTING**

  The following programs utilize this logical file name:

  - RAICCUS1
  - RAICDAC1
  - RAICDAD1
  - RAICDAR1
  - RAICDAR2
  - RAICDAS2
  - RAICDAS3
  - RAICENR1
  - RAICENR2
  - RAICENS2
  - RAICHIER
  - RAICVALD

**Logical File Paths Used in this Solution**

The logical file name **IM_SUMMARIZATION_REPORTING** uses the logical file path **IM_ROOT**.

**Supported Software Components**

This security note applies to the following software components and versions:

- **SAP_APPL:** 600, 602, 603, 604, 605, 606, 616
- **SAP_FIN:** 617, 700

**Support Packages**

Ensure the relevant support packages are applied:

- **SAP_APPL 600:** [SAPKH60027](https://me.sap.com/supportpackage/SAPKH60027)
- **SAP_APPL 602:** [SAPKH60217](https://me.sap.com/supportpackage/SAPKH60217)
- **SAP_APPL 603:** [SAPKH60316](https://me.sap.com/supportpackage/SAPKH60316)
- **SAP_APPL 604:** [SAPKH60417](https://me.sap.com/supportpackage/SAPKH60417)
- **SAP_APPL 605:** [SAPKH60514](https://me.sap.com/supportpackage/SAPKH60514)
- **SAP_APPL 606:** [SAPKH60614](https://me.sap.com/supportpackage/SAPKH60614)
- **SAP_APPL 616:** [SAPKH61609](https://me.sap.com/supportpackage/SAPKH61609)
- **SAP_FIN 617:** [SAPK-61707INSAPFIN](https://me.sap.com/supportpackage/SAPK-61707INSAPFIN)
- **SAP_FIN 700:** [SAPK-70004INSAPFIN](https://me.sap.com/supportpackage/SAPK-70004INSAPFIN)

**Correction Instructions**

Apply the correction instructions as detailed in this security note:

- **SAP_FIN:** [CorrIn 15841](https://me.sap.com/corrins/0002077260/15841)
- **SAP_APPL:** [CorrIn 1](https://me.sap.com/corrins/0002077260/1)

**Preconditions**

Ensure that [SAP Note 1501874](https://me.sap.com/notes/1501874) is implemented, which addresses a related directory traversal issue in IM-FA-IP.

**Additional Information**

For more details, refer to the full SAP Security Note [2077260](https://me.sap.com/notes/2077260).

**Credits**

Credits to [Red Rays](https://redrays.io) for supporting in providing this information.