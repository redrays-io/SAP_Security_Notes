SAP Note 2088593 - Potential Disclosure of Persisted Data in LO-MD-BP-CM & LO-MD-BP-VM

## Overview

**SAP Note Number:** 2088593  
**Title:** Potential Disclosure of Persisted Data in LO-MD-BP-CM & LO-MD-BP-VM  
**Type:** SAP Security Note  
**Priority:** Correction with medium priority  
**Release Status:** Released for Customer  
**Released On:** 10.07.2017  
**Software Component:** Logistics - General > Logistics Basic Data > Business Partners > Customer Master (LO-MD-BP-CM)  
**Affected Versions:** SAP_APPL 600 to 617

## Description

### Symptom
An attacker can exploit LO-MD-BP-CM & LO-MD-BP-VM by using specially crafted inputs to modify database commands. This can result in the retrieval of additional information persisted by the system. Additionally, this SAP note introduces new switchable authorization checks for RFC function modules in LO-MD-BM-CM & LO-MD-BP-VM.

### Reason and Prerequisites
The vulnerability arises from an SQL injection flaw where the code composes SQL statements with strings that can be manipulated by an attacker. Remote Function Calls (RFC) to certain function modules were previously only protected by the authorization object **S_RFC**, which may not suffice to ensure secure execution. To mitigate this, new switchable authorization checks have been implemented.

**Prerequisite SAP Notes:**
- [2023449](https://me.sap.com/notes/2023449) - Switchable Authorization Checks for RFC in FI, FI-AP-AP, FI-AR-AR, FI-BL-MD-BK
- [2030997](https://me.sap.com/notes/2030997) - Switchable Authorization Checks for RFC in FI-AP-AP
- [2008727](https://me.sap.com/notes/2008727) - Securing Remote Function Calls (RFC)
- [1922712](https://me.sap.com/notes/1922712) - SLDW: FAQ: Supplementary Notes for Whitelist Maintenance

### Solution
To address the vulnerability, implement the attached correction instructions provided in this SAP note. The new authorization checks are inactive by default to maintain compatibility with existing processes and can be activated manually via transaction **SACF**.

**Affected Function Modules:**
- `BAPI_VENDOR_FIND`
- `BAPI_CUSTOMER_FIND`

**Support Packages:**
Ensure that your system is updated with the relevant support packages corresponding to your SAP_APPL version. For example:
- SAP_APPL 600: [SAPKH60027](https://me.sap.com/supportpackage/SAPKH60027)
- SAP_APPL 602: [SAPKH60217](https://me.sap.com/supportpackage/SAPKH60217)
- *(Refer to the full list in the Support Package section of the SAP note.)*

**Correction Instructions:**
Available [here](https://me.sap.com/corrins/0002088593/1).

**Attachments:**
- [Note_2088593_whitelist_definition.TXT](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900001365952014&iv_version=0002&iv_guid=C2AFC778FF222841B41D8DB835A56F7E)

## References
- [2030997 - Switchable Authorization Checks for RFC in FI-AP-AP](https://me.sap.com/notes/2030997)
- [2023449 - Switchable Authorization Checks for RFC in FI, FI-AP-AP, FI-AR-AR, FI-BL-MD-BK](https://me.sap.com/notes/2023449)
- [2078596 - Further Improvements for RFC Security](https://me.sap.com/notes/2078596)
- [2008727 - Securing Remote Function Calls (RFC)](https://me.sap.com/notes/2008727)
- [1922712 - SLDW: FAQ: Supplementary Notes for Whitelist Maintenance](https://me.sap.com/notes/1922712)

## Support Package and Validity
This note is applicable to SAP_APPL versions 600 through 617. Ensure that your system is updated with the appropriate support packages as mentioned above.

## CVSS Score
Not provided.

## Side Effects
No known side effects associated with implementing this SAP note.

---

*Credits to [Redrays.io](https://redrays.io) for support and information.*