2085214 - Untrusted XML input parsing possible in SAP Environmental Compliance 3.0

**SAP Security Note 2085214: Untrusted XML input parsing in SAP Environmental Compliance 3.0**

**Symptom:**

A vulnerability in SAP Environmental Compliance 3.0 allows malicious users to modify XML-based requests to include harmful XML content. This can lead to:

- **Denial of Service (DoS)**
- **Information Disclosure**
- **Unauthorized Access** to network resources

**Cause:**

The issue stems from incorrect usage of an XML parser that, by default, opens external entities within XML inputs. This enables the parsing of malicious content that can reference internal resources, leading to potential exploitation.

**Solution:**

1. **Download the Solution:**
   - Access the solution via the [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017966322017).

2. **Implement the Solution:**
   - Apply the downloaded solution to your SAP system.

3. **Apply Dependent Patches:**
   - Ensure all dependent patches are downloaded and applied as outlined in [SAP Note 1974464](https://me.sap.com/notes/1974464).

   **Important:** Patches for *Env.Compl. Centr. Services 3.0* require a server restart to become fully active.

**Affected Components:**

- TDAG_ECS_SERVICES
- TDAG_ECS_MODULES
- TDAG_XEM_MODULES

**Additional References:**

- [SAP Environmental Compliance 3.0 SP20: Corrections contained](https://me.sap.com/notes/2204313)
- [SAP Environmental Compliance 3.0 SP19: Corrections contained](https://me.sap.com/notes/2122314)
- [SAP Environmental Compliance 3.0 SP18: Contained corrections](https://me.sap.com/notes/2047801)

**Side Effects:**

Implementing this security note may introduce the following side effects:

- [Error when opening reporting dataSource of the type "Business Object"](https://me.sap.com/notes/2272730)
- [The filters in the report wizard are not complete](https://me.sap.com/notes/2289757)

**For more details, visit the [SAP Support Portal](https://me.sap.com/notes/2085214).**

*Credits to [RedRays](https://redrays.io) for support in providing this information.*