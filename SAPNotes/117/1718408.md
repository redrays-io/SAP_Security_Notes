SAP Security Note 1718408 - Directory Traversal in Database Interface

**Description**

A vulnerability exists in SAP Business Warehouse (BW) that allows a malicious user to perform directory traversal through the database interface. This flaw can enable an attacker to write arbitrary files on the remote server, potentially leading to data corruption or alteration of system behavior.

**Affected Systems**

- **Software Component:** SAP_BW
- **Versions:**
  - 700 to 702
  - 710 to 730
  - 731

**Technical Details**

The issue arises because the BW database interface does not correctly validate the path for user-submitted files. Specifically, the system fails to restrict the directories where files can be written, allowing paths like `/usr/sap/put/my_data` to be accepted and potentially overwritten by an attacker.

**Solution**

To address this vulnerability, implement the necessary corrections through the appropriate Support Package for your SAP BW version:

- **SAP NetWeaver BW 7.30:** Import Support Package 8 (SAPKW73008)
- **SAP NetWeaver BW 7.31:** Import Support Package 5 (SAPKW73105)

**Manual Activities Required**

After applying the Support Package, perform the following manual configurations:

1. **Transaction `/NFILE`:**
   - **Logical File Path Definition:**
     - Add a new entry:
       - Logical file path: `BW_RSDR`
       - Name: `BW DataManager`
   - **Assignment of Physical Paths to Logical Path:**
     - Add new entries for `BW_RSDR`:
       - **UNIX:** `/tmp/<FILENAME>`
       - **WINDOWS NT:** `<P=DIR_TEMP>\\<FILENAME>`
   - **Logical File Name Definition, Cross-Client:**
     - Add new entries:
       - Logical file: `BW_RSDR`
       - Name: `BW DataManager`
       - Physical file: *(leave empty)*
       - Data format: `DIR`
       - Application area: `BW`
       - Logical path: `BW_RSDR`

For detailed instructions, refer to [SAP Note 875986](https://me.sap.com/notes/875986) which provides comprehensive information about transaction SNOTE.

**Additional Information**

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000010210922017](https://notesdownloads.sap.com/note/0040000010210922017)
- **PDF Version:** [https://userapps.support.sap.com/sap/support/sfm/notes/print/0001718408?language=en-US&token=95E2FDFE99D5B419556127D8F5BCA2AC](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001718408?language=en-US&token=95E2FDFE99D5B419556127D8F5BCA2AC)

**Preconditions**

Ensure that you have applied all prerequisite notes and support packages listed in the SAP Security Note to maintain system integrity and compatibility.

**Credits**

Information supported by [RedRays](https://redrays.io).