1718922 - Potential false redirection in workflow modeler portal

**Symptom**

The Workflow Modeler Portal can be used for phishing attacks by allowing an attacker to publish a URL purporting to be from the product, which redirects the victim to a URL chosen by the attacker. This enables an attacker to falsely gain the trust of a victim and elicit private data from them (such as authentication information).

**Other Terms**

Cross-domain redirection, swfmod_portal, Workflow Modeler Portal

**Reason and Prerequisites**

Some pages within the Workflow Modeler Portal enable a cross-domain redirection to occur. An attacker can include a URL from a different domain in a URL of the target application, which can then be sent to a user of the target application. The user thinks that the content is from the target application, but when they visit such a page, the content is delivered from the domain chosen by the attacker. The attacker can then mimic pages of the target application (for example, a logon page) to get the victim to disclose information they would not otherwise reveal to the attacker (such as their password). This can be mitigated by restricting redirections to relative or local domains only.

**Solution**

The Workflow Modeler Portal is obsolete and needs to be deactivated. The deactivation is delivered in the following service packs:

- [SAP_BASIS 730 SAPKB73008](https://me.sap.com/supportpackage/SAPKB73008)
- [SAP_BASIS 720 SAPKB72008](https://me.sap.com/supportpackage/SAPKB72008)
- [SAP_BASIS 711 SAPKB71110](https://me.sap.com/supportpackage/SAPKB71110)
- [SAP_BASIS 710 SAPKB71015](https://me.sap.com/supportpackage/SAPKB71015)
- [SAP_BASIS 702 SAPKB70212](https://me.sap.com/supportpackage/SAPKB70212)
- [SAP_BASIS 701 SAPKB70112](https://me.sap.com/supportpackage/SAPKB70112)
- [SAP_BASIS 700 SAPKB70027](https://me.sap.com/supportpackage/SAPKB70027)
- [SAP_BASIS 640 SAPKB64030](https://me.sap.com/supportpackage/SAPKB64030)

For earlier service packs, please follow the instructions as described below.

**Manual Activities**

```
-------------------------------------------------------------------------
|Manual Activity                                                                 |
-------------------------------------------------------------------------
|VALID FOR                                                                                       |
|Software Component       SAP_BASIS                                                           |
| Release 640              Until SAPKB64029                                            |
| Release 700              SAPKB70004 - SAPKB70026                            |
| Release 710              Until SAPKB71014                                            |
| Release 711              SAPKB71101 - SAPKB71109                            |
| Release 701              Until SAPKB70111                                            |
| Release 702              SAPKB70201 - SAPKB70211                            |
| Release 730              SAPKB73001 - SAPKB73007                            |
-------------------------------------------------------------------------
Start transaction se80 and edit the BSP application "swfmod_portal". Go to the "Properties" tab and set the checkbox "XSRF Protection".
```

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010212962017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001718922?language=en-US&token=D4356E31C05D0C9473526B2A051971A1)

For more details, visit the [SAP Security Notes](https://me.sap.com/servicessupport/knowledge).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*