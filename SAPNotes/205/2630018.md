SAP Security Note 2630018 - CVE-2018-2445 Server Side Request Forgery (SSRF) Vulnerability in SAP BusinessObjects BI Platform Servers AdminTools

---

**Symptom**

AdminTools allows an attacker to manipulate the vulnerable application to send crafted requests on behalf of the application, resulting in a Server Side Request Forgery (SSRF) vulnerability.

**Impact**

- Information gathering for further exploits/attacks
- Availability of the system

**CVSS Information**

- **CVSS v3 Base Score:** 6.3/10
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:L

**Solution**

This issue is fixed in the patches listed in the "Support Package Patches" section below.

To prevent SSRF:

1. **Create a Whitelist:**
   - Define valid CMS names or IPs along with their port numbers in the `allowed.cms` property within the `AdminTools.properties` file located at `<BOEInstallDir>\tomcat\webapps\AdminTools\WEB-INF`.
   - For releases with a new location, refer to the [Support Package Patches](https://me.sap.com/notes/2806864).

2. **Edit the `AdminTools.properties` File:**
   - Copy the `AdminTools.properties` file to the `custom` folder from the `default` folder if applicable.
   - Add the CMS names or IPs and port numbers in the following format:
     ```
     allowed.cms = <cms_name_or_IP>:<port_number>, <cms_name_or_IP>:<port_number>
     ```
   - Example:
     ```
     allowed.cms = cms.example.com:8080, 192.168.1.100:8080
     ```

3. **Restart the Web Application Server:**  
   After making changes, restart the server to apply the configuration.

**Support Package Patches**

- [SBOP BI PLATFORM SERVERS 4.2 SP004 Patch 000009](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
- [SBOP BI PLATFORM SERVERS 4.2 SP005 Patch 000400](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
- [SBOP BI PLATFORM SERVERS 4.1 SP009 Patch 000012](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
- [SBOP BI PLATFORM SERVERS 4.1 SP012 Patch 000000](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
- [SBOP BI PLATFORM SERVERS 4.2 SP006 Patch 000000](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
- [SBOP BI PLATFORM SERVERS 4.1 SP011 Patch 000200](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
- [SBOP BI PLATFORM SERVERS 4.1 SP010 Patch 000007](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)

**References**

- [AdminTools.properties file getting updated after Patching](https://me.sap.com/notes/2806864)
- [CVE-2018-2370 Server Side Request Forgery (SSRF) vulnerability in Central Management Console, BI Launchpad and Fiori BI Launchpad](https://me.sap.com/notes/2493727)

**Additional Information**

For a secure login and to prevent SSRF, ensure that only whitelisted CMS names or IPs are allowed. If the port number is omitted in the whitelist, the login will default to the standard port, and any deviations will result in a failed login attempt.

**Credits**

Thanks to [redrays.io](https://redrays.io) for support in providing this information.