SAP Security Note 2626762 - Code Injection Vulnerability in SAP Internet Sales

## Description

SAP Internet Sales is using a vulnerable version of Apache Struts. The MultiPageValidator implementation in Apache Struts 1.1 through 1.3.10 allows under certain conditions a remote attacker to bypass intended access restrictions via a modified page parameter. This vulnerability is identified as [CVE-2015-0899](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0899). An attacker could thereby control the behavior of the application.

## CVSS Information

- **CVSS v3 Base Score:** 7.5 / 10
- **CVSS v3 Base Vector:**

  | Metric                    | Value                |
  |---------------------------|----------------------|
  | Attack Vector (AV)        | Network (L)          |
  | Attack Complexity (AC)    | Low (L)              |
  | Privileges Required (PR)  | None (N)             |
  | User Interaction (UI)     | None (N)             |
  | Scope (S)                 | Unchanged (U)        |
  | Confidentiality Impact (C)| None (N)             |
  | Integrity Impact (I)      | High (H)             |
  | Availability Impact (A)   | None (N)             |

_SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://me.sap.com/securitynotes)._

## Solution

This SAP note contains Java Correction(s) for E-Commerce / Web Channel with additional input validation to prevent this vulnerability.

**Steps to Resolve:**
1. Implement the SP Patch Level attached to this note.
2. For further information about installing Java Patches, consult SAP note [877887](https://me.sap.com/notes/877887).
3. Information about the patch strategy can be found in SAP note [1546959](https://me.sap.com/notes/1546959).

## Side Effects

This document is causing side effects. For more details, refer to SAP Note [2651424](https://me.sap.com/notes/2651424).

## References

- [CVE-2015-0899](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0899)
- [SAP Note 1546959 - Patch strategies for SAP E-Commerce solutions](https://me.sap.com/notes/1546959)
- [SAP Note 877887 - Installing Patches for CRM Java Components and FSCM BD](https://me.sap.com/notes/877887)
- [SAP Note 2651424 - IPC parameter is not allowed in an action form](https://me.sap.com/notes/2651424)

## Supported Software Components

This security note is applicable to the following software components and versions:

- **SAP-CRMJAV:** Versions 730, 731, 732, 733, 754
- **SAP-CRMWEB:** Versions 730, 731, 732, 733, 754
- **SAP-SHRWEB:** Versions 730, 731, 732, 733, 754
- **SAP-SHRJAV:** Versions 730, 731, 732, 733, 754
- **SAP-CRMAPP:** Versions 730, 731, 732, 733, 754
- **SAP-SHRAPP:** Versions 730, 731, 732, 733, 754

Refer to the [Support Package Patches](https://me.sap.com/notes/2626762) section of this note for detailed patch information and download links.

---

*Credits to [Redrays.io](https://redrays.io) for support to provided information.*