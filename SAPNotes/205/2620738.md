2620738 - [CVE-2018-2427] Code Injection vulnerability in SAP CrystalReports

**Symptom**

*CrystalReportsViewer* allows an attacker to inject code that can be executed by the application. An attacker could thereby control the behavior of the application.

Some well-known impacts of Code Injection vulnerability are:
- Unauthorized execution of commands
- Sensitive information disclosure
- Denial of Service

**CVSS Information**

- **CVSS v3 Base Score:** 6.3 / 10
- **CVSS v3 Vector:**
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** Low (L)

**Other Terms**

- Command Injection, OS command injection, [CVE-2018-2427](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-2427)

**Reason and Prerequisites**

The reason is that the old function accepts any code. The prerequisite is that the user needs to be logged on to the system.

**Solution**

The vulnerable function `eval()` has been replaced with a safe one that performs the same functionalities.

This issue is fixed in the patches listed in the [Support Packages & Patches](https://me.sap.com/softwarecenter) section below. The "Support Packages & Patches" section will be populated with the relevant patch levels once they are released.

For Business Intelligence Platform maintenance schedule and strategy, see the Knowledge Base Article [2144559](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT) in the References section.

**Support Package Patches**

- **SBOP BI PLATFORM SERVERS 4.2**
  - SP004 Patch 000008: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
  - SP005 Patch 000300: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
  - SP006 Patch 000000: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)

- **SBOP BI PLATFORM SERVERS 4.1**
  - SP009 Patch 000012: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
  - SP010 Patch 000006: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
  - SP011 Patch 000100: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
  - SP012 Patch 000000: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)

- **CRYSTAL REPORTS FOR VS 2010**
  - SP023 Patch 000000: [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)

**References**

- [Knowledge Base Article 2144559](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001336352018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002620738?language=en-US&token=EA8864FE9796A415BF2782945B48639E)

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*