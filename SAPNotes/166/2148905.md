2148905 - Potential information disclosure relating to passwords in SAP Web Dispatcher trace files

**Symptom**

An attacker can discover information relating to passwords through the SAP Web Dispatcher. This information could be used to allow the attacker to specialize their attacks against SAP HANA Database or SAP HANA Extended Application Services.

The issue affects both the standalone SAP Web Dispatcher and the internal HANA Web Dispatcher.

**CVSS Information**

- **Base Score:** 1.5 / 10
- **Attack Vector (AV):** Local (L)
- **Attack Complexity (AC):** Medium (M)
- **Authentication (Au):** Single (S)
- **Impact to Confidentiality (C):** Partial (P)
- **Impact to Integrity (I):** None (N)
- **Impact to Availability (A):** None (N)

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://support.sap.com/securitynotes](https://support.sap.com/securitynotes).*

**Reason and Prerequisites**

Information is logged to the trace files of the Web Dispatcher if it is configured. If the trace level is set to a higher trace level, this information includes sensitive information such as user passwords. This information may be used by an attacker to further target SAP HANA.

**Solution**

The Web Dispatcher trace function has been improved to suppress all passwords related to SAP HANA Extended Application Services.

- **For the standalone SAP Web Dispatcher**, apply the Kernel patch referenced in this SAP Note. [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018041762017)
- **For the internal HANA Web Dispatcher**, apply SAP HANA SPS 9 Database Revision 97 or higher. [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002148905?language=en-US&token=8AB3D529B08394A97174FF42A72804B0)

**Workaround / Mitigating Measures**

- **Use HTTPS:** HTTPS should be used as much as possible. If HTTPS is used, request bodies are not logged to the Web Dispatcher trace file.
- **Restrict Access to Trace Files:** Trace files can contain sensitive information. It is recommended that access authorizations to trace files are handled carefully.
- **Restrict Trace Level Changes:** Authorizations to increase the trace level should be assigned restrictively. In SPS 8 (and lower), only the operating system user `<sid>adm` can change the Web Dispatcher trace level. In SPS 9 (and higher), the system privilege `INIFILEADMIN` or the role `sap.hana.xs.wdisp.admin::WebDispatcherAdmin` is required.

**Affected Components**

- **SAP HANA > SAP HANA Application Services > SAP HANA Extended Application Services**

**References**

- [Edit Note 2148905](https://i7p.wdf.sap.corp/sap/support/notes/edit/0002148905)
- [Show Changes](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001667&V=MAINT)

For more details and support, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*