2134905 - Missing authorization check in XCListener

### Symptom

A vulnerability has been discovered in certain landscape configurations of SAP Afaria that utilize XcListener for initiating client-to-server communications. XcListener does not properly authorize requests before launching the client.

**CVSS Information**

- **Base Score:** 6.0 / 10
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Medium (M)
- **Authentication (Au):** Single (S)
- **Confidentiality Impact (C):** Partial (P)
- **Integrity Impact (I):** Partial (P)
- **Availability Impact (A):** Partial (P)

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/).

### Reason and Prerequisites

XcListener does not contain proper authorization checks. This can result in undesired behavior.

### Solution

A vulnerability has been discovered in certain landscape configurations of SAP Afaria that utilize XcListener for initiating client-to-server communications. SAP has released security patches for the vulnerable clients, including Windows Mobile, Windows CE, and Windows. Windows Phone is not affected. SAP strongly recommends customers patch their server.

To be vulnerable, XcListener must be an active process. The Windows client enrollment policy allows administrators to enable or disable XcListener with the advanced option “Outbound listener and firewall”. XcListener listens on port 3005. If port 3005 is not exposed externally, then the vulnerability is only accessible locally on the machine.

#### Patch Instructions:

1. **Download hotfix:**
    - [SAP Afaria 7 SP5 Hotfix 8](https://notesdownloads.sap.com/note/0040000018026262017)
    - [SAP Afaria 7 SP4 Hotfix 16](https://notesdownloads.sap.com/note/0040000018026262017)
2. **Apply server hotfix**

The server’s version of XcListener will be patched when the hotfix is applied. The clients will be updated through the Afaria ESD process as they connect to the server.

For more details, refer to the [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002134905?language=en-US&token=89DFD731703A5A6DD3C2FABC373FBE34).

*Credits to [Redrays.io](https://redrays.io) for support to provided information.*