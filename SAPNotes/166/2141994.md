2141994 - Potential modification/disclosure of persisted data in SAP CPQ Solution Sales Configuration

**Title:**  
2141994 - Potential modification/disclosure of persisted data in SAP CPQ Solution Sales Configuration

**Description:**  
An SQL injection vulnerability has been identified in SAP CPQ Solution Sales Configuration. This vulnerability allows attackers to manipulate SQL statements through specially crafted inputs, potentially leading to unauthorized data retrieval or modification.

**Symptom:**  
An attacker can exploit SAP CPQ Solution Sales Configuration to modify database commands, resulting in the retrieval of additional information or modification of data persisted by the system.

**Reason and Prerequisites:**  
The issue arises from an SQL injection vulnerability where user input is not properly sanitized before being included in SQL statements. This flaw enables attackers to alter SQL commands to access or modify database data.

**Solution:**  
To address this vulnerability, follow these steps:

1. **Apply Java Patches:**  
   - **FBS_SOLCONF_IPC 2.0 SP02 Patch 1** (For deployment on SAP AS Java)  
   - **FBS_SOLCONF_SME 2.0 SP02 Patch 1** (For update of Solution Modeling Environment)  
   
   *Note:* These Java patches are backward compatible and will function with or without the ABAP corrections.

2. **Implement ABAP Corrections:**  
   After applying the Java patches, follow the attached manual steps to implement the necessary ABAP code corrections.

**Download and Additional Resources:**  
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000012703352017)  
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002141994?language=en-US&token=92BF531EC578597C6A072479CC312FD5)  
- [Compare Versions](https://me.sap.com/notesLatestChanges/0002141994/E/diff)  
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002141994) *(Not publicly visible)*

**Attachments:**  
- [Manual Instructions for CRM.pdf](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000057302015&iv_version=0003&iv_guid=379954DAEB481746B45111C750BFC67E)  
- [Manual Instructions for ECC.pdf](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000057302015&iv_version=0003&iv_guid=A1DEF59938EFB241AA8FB53FA34688D5)

**References:**  
- [Java Patch level required for note 2141994](https://me.sap.com/notes/0002140814)  

**Support Package Information:**  
Ensure that the following support packages are applied to relevant software components:
- **SLCE 607:** [SAPK-60703INSLCE](https://me.sap.com/supportpackage/SAPK-60703INSLCE)
- **SLCC 703:** [SAPK-70303INSLCC](https://me.sap.com/supportpackage/SAPK-70303INSLCC)

For patch level updates, refer to the specific URLs provided in the attachments section.

**Manual Activities:**  
The implementation requires manual creation of certain DDIC objects and roles as referenced in the automatic correction instructions. Detailed steps are provided in the attached documentation.

*Please ensure to delete these manually created objects when installing the next support package to avoid conflicts.*

**CVSS Score:**  
Currently, the CVSS score is 0. Ensure to review and update based on your assessment.

**Credits:**  
Information supported by [RedRays.io](https://redrays.io).