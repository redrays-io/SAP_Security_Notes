2142551 - Whitelist service for Clickjacking Framing Protection in AS ABAP

# Whitelist Service for Clickjacking Framing Protection in AS ABAP (SAP Note 2142551)

## Overview
SAP Note **2142551** addresses a critical security vulnerability related to Clickjacking in SAP NetWeaver Application Server (AS) ABAP. UI technologies in AS ABAP were previously unprotected against Clickjacking attacks, allowing malicious actors to trick users into unintended actions within the application.

## Vulnerability Details
**Clickjacking** is a UI redressing attack where an attacker overlays transparent frames over legitimate application content, manipulating user interactions without their knowledge. This exploitation leverages standard HTML features without relying on flaws within the application's code.

## Solution Provided
SAP introduces a **whitelist-based framework** to mitigate Clickjacking attacks across NetWeaver technologies. The framework involves configuring trusted parent origins that are allowed to embed SAP applications within frames.

### Implementation Steps:
1. **Create Required Packages:**
   - Use transaction **SE80** to create the following packages:
     - **SUICS** for UI Core Services within both `SAP_BASIS` and `SAP_UI` software components.

2. **Configure ICF Services:**
   - **Service "uics":** Path `/sap/bc/uics`
   - **Service "whitelist":** Path `/sap/bc/uics/whitelist`
     - Assign handler `CL_UICS_WHITELIST_CHECK`
   - **External Alias:** Path `/sap/public/bc/uics/whitelist` pointing to `/sap/bc/uics/whitelist`
     - Configure logon data with a system user having no permissions.

3. **Maintain HTTP_WHITELIST Table Entries:**
   - Set `ENTRY_TYPE` to `30` to activate Clickjacking protection.
   - Define trusted `PROTOCOL`, `HOST`, `PORT`, and set `URL` to `*`.

   Example Entry:
   ```
   ENTRY_TYPE: 30
   SORT_KEY: [Sequence Position]
   PROTOCOL: https
   HOST: *.yourdomain.com
   PORT: [Optional]
   URL: *
   ```

4. **Activate Services:**
   - Ensure all newly created ICF services are activated via transaction **SICF**.

## Affected Components
- **SAP_BASIS**: Versions 700 to 731
- **SAP_UI**: Versions 740, 750

## Correction Instructions
Detailed correction steps are provided within the SAP Note, including the creation of specific ICF services and proper configuration of whitelist entries to ensure comprehensive protection against Clickjacking.

## CVSS Rating
- **Score:** 4.3
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
  - **Attack Vector:** Network
  - **Attack Complexity:** Low
  - **Privileges Required:** None
  - **User Interaction:** Required
  - **Scope:** Unchanged
  - **Confidentiality Impact:** None
  - **Integrity Impact:** Low
  - **Availability Impact:** None

## References
- [SAP Note 2319727 - Clickjacking protection framework in SAP NetWeaver AS ABAP and AS Java](https://me.sap.com/notes/2319727)
- [OWASP Clickjacking](https://www.owasp.org/index.php/Clickjacking)

## Further Information
For comprehensive details, please refer to the full SAP Note [2142551](https://me.sap.com/notes/2142551).

---

*Support provided by [RedRays.io](https://redrays.io).*