2288991 - Directory Traversal Vulnerability in SAP BusinessObjects Platform

**Description**

SAP BusinessObjects systems allow an attacker to exploit insufficient validation of path information provided by users, thus allowing modification of files provided as part of the SAP BusinessObjects installation.

**Impact**

Some well-known impacts of the Directory Traversal vulnerability include:
- **Data Exposure:** An attacker could read the content of arbitrary files on the remote server, exposing sensitive data.
- **Data Manipulation:** An attacker could overwrite, delete, or corrupt arbitrary files on the remote server.

**CVSS Information**

- **CVSS v3 Base Score:** 4.3 / 10
- **CVSS v3 Vector:** 
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** Low (L)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** None (N)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

**Reason and Prerequisites**

For exploitability, the File System destination type must be enabled on one or more Job Servers. By default, this destination type is not enabled.

**Solution**

This issue is fixed in the patches listed in the "Support Packages & Patches" section below. The fix enhances existing solutions to further protect files that are part of the SAP BusinessObjects suite. After applying the fix:
- Some Schedule and Send To operations may produce errors instead of delivering to the desired File System destinations.
- Non-whitelisted paths pointing to locations beneath the installation root for the SAP BusinessObjects suite will be rejected.

**Recommendations for Further Protection:**
1. **Restrict OS User Permissions:** Configure the Server Intelligence Agent so that the process and its child processes run under an OS user with restricted rights. Ensure this user cannot write to folders or file shares where system harm could occur. Additionally, prevent non-administrators from having login rights on systems hosting SAP BusinessObjects deployments.
2. **Use Whitelisting:** Employ the `-whitelist` argument on the command line of each Job Server as described in [SAP Note 1759784](https://me.sap.com/notes/1759784). Note that this may not be feasible if all potential destination directory roots are not known at configuration time.

**Support Packages & Patches**

The issue is addressed in the following support packages and patches:

- **SBOP BI PLATFORM SERVERS 4.2**
  - [SP003 Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)
  - [SP002 Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)

- **SBOP BI PLATFORM SERVERS 4.1**
  - [SP005 Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
  - [SP008 Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
  - [SP007 Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)
  - [SP006 Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019009&V=MAINT)

- **SBOP BI PLATFORM SERVERS 4.0**
  - [SP012 Patch](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200013179&V=MAINT)

**References**

- [SAP Note 1759784 - Fixed Security Risk for Unmanaged Disk Overwrite](https://me.sap.com/notes/1759784)

For more information and to download the necessary patches, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for supporting the provision of this information.*