SAP Security Note 2274560 - Arbitrary Log File Injection Vulnerability in SAP Gateway

**Description**

**Symptom**

SAP Gateway allows an attacker to inject character sequences into the log file. As a result, administrators may analyze incorrect content in log files, leading to potential misinterpretations and oversight of malicious activities.

**CVSS Information**

- **CVSS v3 Base Score:** 4.3 / 10
- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** Low (L)
- **User Interaction:** None (N)
- **Scope:** Unchanged (U)
- **Confidentiality Impact:** None (N)
- **Integrity Impact:** Low (L)
- **Availability Impact:** None (N)

**Impact**

A malicious user can inject arbitrary character sequences by manipulating the TP name in SAP Gateway's log files. This injection can confuse users analyzing the logs, potentially masking malicious activities or leading to incorrect assessments.

**Solution**

Apply the patch mentioned in this SAP Note to validate character sequences for TP names. The correction ensures that any character sequence containing non-contributory characters to a TP name is rejected. After applying the patch, log entries will indicate invalid TP names as follows:

```
S Tue Jan 12 2016 10:55:18:791 REGISTER_TP invalid tpname (tp#name_newline) from [127.0.0.1]
```

**Download and Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018256502017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002274560?language=en-US&token=F53833AE234A7E7B0F0AB2FD6FB62EE2)

For support package patches relevant to your SAP Kernel version, visit the [SAP Support Portal](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE).

**Credits**

Credits to [Redrays.io](https://redrays.io) for support in providing this information.