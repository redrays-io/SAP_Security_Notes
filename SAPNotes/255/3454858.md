3454858 - [CVE-2024-37180] Information Disclosure vulnerability in SAP NetWeaver Application Server for ABAP and ABAP Platform

**Symptom**

Under certain conditions, SAP NetWeaver Application Server for ABAP and ABAP Platform allows an attacker to access a remote-enabled function module without further authorization, which would otherwise be restricted. The function can be used to read non-sensitive information with low impact on the confidentiality of the application.

**Change Log:**

- **v8 (Current version) - UPDATE 08th October 2024:**  
  This note has been re-released with updated Manual Instruction Post-Implementation steps in the 'Solution' section. The transaction code has been changed from SU22 to SU24.
  
- **v5 (Previous version) - UPDATE 13th August 2024:**  
  This note has been re-released with updated 'Solution' information. Extended the manual instructions to the following releases:
  - SAP_BASIS 754 SP00 to SP08
  - SAP_BASIS 755 SP00 to SP06
  - SAP_BASIS 756 SP00 to SP04
  - SAP_BASIS 757 SP00 to SP02

- **v3 (Initial Version)**

**Other Terms**

Information Exposure, Information Leak, [CVE-2024-37180](https://www.cve.org/CVERecord?id=CVE-2024-37180)

**Reason and Prerequisites**

Function `F4_DXFILENAME_TOPRECURSION` does not restrict access to file system information appropriately.

**Solution**

With this SAP Note, while using Function module `F4_DXFILENAME_TOPRECURSION`, users will only have access to the path maintained for Logical File Name `/SAPDMC/LSMW_FILE` (Transaction FILE). This validation restricts users from traversing to any other directory.

If the user wants to provide access to a certain directory, it needs to be maintained in the FILE transaction for:
- Logical File path definition `/SAPDMC/LSMW_FILE_LP`
- Logical Path for `/SAPDMC/LSMW_FILE`

Users should have read authorization to Logical File Name `SAPDMC/LSMW_FILE`.

**Workaround**

No workaround available.

**Manual Activities**

```
-------------------------------------------------------------------------
| Manual Activity                                                       |
-------------------------------------------------------------------------
| VALID FOR                                                             |
| Software Component   SAP_BASIS                                        |
| Release 700          SAPKB70015 - SAPKB70041                         |
| Release 701          Until SAPKB70126                                 |
| Release 702          SAPKB70201 - SAPKB70226                         |
| Release 731          SAPKB73101 - SAPKB73134                         |
| Release 740          Until SAPKB74031                                 |
| Release 750          Until SAPK-75030INSAPBASIS                      |
| Release 751          Until SAPK-75118INSAPBASIS                      |
| Release 752          Until SAPK-75214INSAPBASIS                      |
| Release 753          Until SAPK-75312INSAPBASIS                      |
| Release 754          Until SAPK-75408INSAPBASIS                      |
| Release 755          Until SAPK-75506INSAPBASIS                      |
| Release 756          Until SAPK-75604INSAPBASIS                      |
| Release 757          Until SAPK-75702INSAPBASIS                      |
-------------------------------------------------------------------------
 
**Manual Instruction Post-Implementation:**

Need to add authorization objects for two RFC function Modules:

1. **F4_DXFILENAME:**
   - Execute transaction [SU24](https://me.sap.com/#).
   - From 'Type of Application' dropdown menu select 'RFC function Module'.
   - Provide input `F4_DXFILENAME` for parameter 'Function Module'.
   - Execute.
   - Go to Edit Mode.
   - Under tab 'Authorization Objs', select the menu option 'Object'.
   - Select 'Object' again and choose 'Add authorization object'.
   - Provide `S_DATASET` and click on Enter.
   - Double click on `S_DATASET` and provide values for `ACTVT` and `FILENAME`.
     - Select the pencil icon beside `ACTVT` and mark the checkbox 33.
     - Select the pencil icon beside `FILENAME` and provide the input value as `/SAPDMC/LSMW_FILE`.
   - Save the changes; it will ask for the Transport request to capture the changes.

2. **F4_DXFILENAME_TOPRECURSION:**
   - Follow the same steps as mentioned above for this Function Module as well.

**CVSS**

- **CVSS Score:** 4.1
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:N/A:N)

  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** High (H)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** None (N)
  - **Availability Impact (A):** None (N)

**References**

- [SAP Note 3454858](https://me.sap.com/notes/0003454858)
- [SAP Note 3570889](https://me.sap.com/notes/0003570889)

**Software Components Affected:**

- **SAP_BASIS**
  - Versions: 700 to 702, 731, 740, 750 to 758

**Support Package Information:**

Refer to the [Support Package](https://me.sap.com/supportpackage/SAPKB70042) relevant to your SAP_BASIS version.

**Side Effects:**

This document is causing side effects for [SAP Note 3570889 - Value help for physical file name ends with runtime error DYNPRO_MSG_IN_HELP](https://me.sap.com/notes/0003570889).

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*