3460772 - [CVE-2024-33002] Cross-Site Scripting (XSS) Vulnerability in SAP S/4HANA (Document Service Handler for DPS)

## Symptom

Document Service handler (obsolete) in Data Provisioning Service does not sufficiently encode user-controlled inputs, resulting in Cross-Site Scripting (XSS) vulnerability with low impact on Confidentiality and Integrity of the application.

## Other Terms

XSS, reflected XSS, CSRF, [CVE-2024-33002](https://www.cve.org/CVERecord?id=CVE-2024-33002)

## Reason and Prerequisites

Class CL_ESH_DPS_HTTP_SERVER is obsolete. The associated security correction deactivates the affected code.

## Solution

All affected obsolete code is deactivated with the correction instructions mentioned below:

- **SAP S/4HANA Public Cloud Edition**
  
  The fix is provided automatically via an update.

- **SAP S/4HANA Cloud Private Edition or SAP S/4HANA On-Premise**
  
  Implement the correction instructions provided by [SAP Note 3449741](https://me.sap.com/notes/3449741) or implement the corresponding SAP_BASIS Support Package containing these corrections, as specified in the Support Packages section of [SAP Note 3449741](https://me.sap.com/notes/3449741) for your SAP_BASIS Release.
  
  [SAP Note 3449741](https://me.sap.com/notes/3449741) is attached as reference to this Security Note.

## CVSS

**CVSS Score:** 6.1

**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

## References

- [SAP Note 3449741 - Deactivate obsolete class method](https://me.sap.com/notes/3449741)

## Download and Print

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000549242024)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003460772?language=en-US&token=4DA8C5E19334D1D060A910CA89ED0127)

Credits to [https://redrays.io](https://redrays.io) for support to provided information.