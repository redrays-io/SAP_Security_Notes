3458789 - [CVE-2024-34689] Server-Side Request Forgery in SAP Business Workflow (WebFlow Services)

# Symptom

WebFlow Services of SAP Business Workflow allows an authenticated attacker to enumerate accessible HTTP endpoints in the internal network by specially crafting HTTP requests. On successful exploitation, this can result in information disclosure. It has no impact on the integrity and availability of the application.

# Change Log

**v7 (Current version) - UPDATE 23rd July 2024:** This note has been re-released with updated 'Correction instruction' information.

**v5 (Initial Version)**

# Other Terms

Server-Side Request Forgery, SSRF, Information exposure, [CVE-2024-34689](https://www.cve.org/CVERecord?id=CVE-2024-34689).

# Reason and Prerequisites

You configured and use Web Services/WebFlow Services of SAP Business Workflow as described [here](https://me.sap.com/docs/ABAP_PLATFORM_NEW/a602ff71a47c441bb3000504ec938fea/4f38dd19bd13553fe10000000a421937.html?locale=en-US).

Unchecked allowed URLs enable an authenticated user to enumerate accessible HTTP endpoints by sending crafted requests from vulnerable web applications.

# Solution

Callback-URLs of WebFlow Services can now be checked against an allowlist, so that only explicitly allowed URLs are processed. Therefore, implement the assigned correction instructions or install the corresponding support package. With this, allowlisting is activated by default and needs to be further configured as per the attached manual correction instruction.

**Attention:** If no allowed callback-URLs are maintained or a callback-URL does not match an allowed pattern, those requests are not processed further.

# Correction Instructions

You need to perform the following manual steps:

## Manual Pre-Implement

- **Software Component:** SAP_BASIS
- **Releases and Support Packages:**
  - Release 700: SAPKB70042
  - Release 701: SAPKB70127
  - Release 702: SAPKB70227
  - Release 731: SAPKB73135
  - Release 740: SAPKB74032
  - Release 750: SAPK-75031INSAPBASIS
  - Release 751: SAPK-75119INSAPBASIS
  - Release 752: SAPK-75215INSAPBASIS
  - Release 753: SAPK-75313INSAPBASIS
  - Release 754: SAPK-75411INSAPBASIS
  - Release 755: SAPK-75509INSAPBASIS
  - Release 756: SAPK-75607INSAPBASIS
  - Release 757: SAPK-75705INSAPBASIS
  - Release 758: SAPK-75802INSAPBASIS

You have to perform this manual pre-implementation step manually and separately in each system **before** you import the Note to implement.

Implement SAP Note [3483993](https://me.sap.com/notes/3483993) separately and use SA38 to execute the report `NOTE_3483993`.

## Manual Post-Implement

- **Software Component:** SAP_BASIS
- **Releases and Support Packages:** (Same as above)

You have to perform this manual post-implementation step manually and separately in each system **after** you have imported the Note to implement.

In order to configure the allowlisting, please follow the instructions of [note 3485805](https://me.sap.com/notes/3485805).

# CVSS

- **CVSS Score:** 5.0
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N)

  | Key                      | Value                                         |
  |--------------------------|-----------------------------------------------|
  | Attack Vector (AV)       | Network (N)                                   |
  | Attack Complexity (AC)   | Low (L)                                       |
  | Privileges Required (PR) | Low (L)                                       |
  | User Interaction (UI)    | None (N)                                      |
  | Scope (S)                | Changed (C)                                   |
  | Confidentiality Impact (C)| Low (L)                                      |
  | Integrity Impact (I)     | None (N)                                      |
  | Availability Impact (A)  | None (N)                                      |

# References

- [3485805](https://me.sap.com/notes/3485805) - [CVE-2024-34689] Allowlisting of callback-URLs in SAP Business Workflow (WebFlow Services)
- [3483993](https://me.sap.com/notes/3483993) - [CVE-2024-34689] Prerequisite for Security Note 3458789

# Credits

Credits to [redrays.io](https://redrays.io) for support to provided information.