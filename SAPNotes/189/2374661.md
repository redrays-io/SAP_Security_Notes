2374661 - Cross-Site Scripting (XSS) vulnerability in Unified Rendering / SAP GUI for HTML

**Symptom**

Unified Rendering does not sufficiently encode user-controlled inputs, resulting in a Cross-Site Scripting (XSS) vulnerability.

Some well-known impacts of XSS vulnerabilities include:

- Non-permanently defacing or modifying displayed content from a website
- Stealing authentication information of the user, such as data relating to their current session
- Impersonating the user and accessing all information with the same rights as the target user

**Other Terms**

XSS, stored XSS, reflected XSS, CSS

**Reason and Prerequisites**

This issue occurs only when using SAP GUI for HTML in combination with SAP Screen Personas 3.0. If you do not use SAP Screen Personas, this SAP Note is not relevant.

**Solution**

Please install a new SAP Kernel patch as mentioned below.

**Software Components Affected**

- **KRNL64NUC**: 7.22, 7.42, 7.49, 7.22EXT
- **KRNL64UC**: 7.22, 7.42, 7.49, 7.22EXT
- **AJAX-RUNTIME**: 7.20, 7.30, 7.31, 7.40, 7.50
- **KERNEL**: 7.22, 7.42, 7.45, 7.48, 7.49, 7.50, 7.51
- **FRAMEWORK**: 7.10-7.11, 7.20

**Support Package Patches**

| Software Component Version        | Support Package | Patch Level | URL                                                                                                                                                                                                                                      |
|-----------------------------------|------------------|-------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| JAVA FRAMEWORK OFFLINE 7.20       | SP009            | 000021      | [Download SP009 Patch 000021](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012839&support_package=SP009&patch_level=000021)                                                                           |
| SAP KERNEL 7.50 64-BIT UNICODE    | SP010            | 000010      | [Download SP010 Patch 000010](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004842&V=MAINT)                           |
| JAVA FRAMEWORK OFFLINE 7.11       | SP017            | 000000      | [Download SP017 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006944&support_package=SP017&patch_level=000000)                                                                           |
| JAVA FRAMEWORK OFFLINE 7.10       | SP022            | 000000      | [Download SP022 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200004781&support_package=SP022&patch_level=000000)                                                                           |
| SAP KERNEL 7.49 64-BIT UNICODE    | SP111            | 000111      | [Download SP111 Patch 000111](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004760&V=MAINT)                           |
| SAP KERNEL 7.49 64-BIT             | SP111            | 000111      | [Download SP111 Patch 000111](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200004791&V=MAINT)                           |
| SAP KERNEL 7.22 64-BIT             | SP216            | 000216      | [Download SP216 Patch 000216](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001793&V=MAINT)                           |
| SAP KERNEL 7.22 64-BIT UNICODE    | SP216            | 000216      | [Download SP216 Patch 000216](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001794&V=MAINT)                           |
| SAP KERNEL 7.22 EXT 64-BIT         | SP216            | 000216      | [Download SP216 Patch 000216](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001797&V=MAINT)                           |
| SAP KERNEL 7.22 EXT 64-BIT UC      | SP216            | 000216      | [Download SP216 Patch 000216](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001798&V=MAINT)                           |
| SAP KERNEL 7.45 64-BIT UNICODE    | SP316            | 000316      | [Download SP316 Patch 000316](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200001710&V=MAINT)                           |
| SAP KERNEL 7.45 64-BIT             | SP316            | 000316      | [Download SP316 Patch 000316](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200001751&V=MAINT)                           |
| SAP KERNEL 7.42 64-BIT UNICODE    | SP436            | 000436      | [Download SP436 Patch 000436](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200025031&V=MAINT)                           |
| SAP KERNEL 7.42 64-BIT             | SP436            | 000436      | [Download SP436 Patch 000436](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200025032&V=MAINT)                           |

**References**

This document is referenced by:

- [2407582 - Corrections for unified rendering up to SAP_BASIS 731/19 III](https://me.sap.com/notes/2407582)
- [2393289 - Corrections for unified rendering 730/16 II (ABAP-Renderer)](https://me.sap.com/notes/2393289)
- [2388103 - SAP Screen Personas 3.0 SP03: Cross-Site Scripting (XSS) vulnerability in SAP GUI for HTML](https://me.sap.com/notes/2388103)

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018751382017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002374661?language=en-US&token=A9796AEBA051F86C1DD63911E11B0085)

**Available Translations**

Available in multiple languages (Machine Translation):

- [Deutsch](https://me.sap.com/notes/0002374661/D)
- [日本語](https://me.sap.com/notes/0002374661/J)
- [Português](https://me.sap.com/notes/0002374661/P)
- [Español](https://me.sap.com/notes/0002374661/S)
- [Français](https://me.sap.com/notes/0002374661/F)
- [Italiano](https://me.sap.com/notes/0002374661/I)
- [Русский](https://me.sap.com/notes/0002374661/R)
- [中文](https://me.sap.com/notes/0002374661/1)
- [한국어](https://me.sap.com/notes/0002374661/3)

**Credits**

Thanks to [Redrays.io](https://redrays.io) for support in providing this information.