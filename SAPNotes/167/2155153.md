2155153 - Potential arbitrary code execution using JAVA in SAP ASE

**Description**

An authenticated user can exploit JAVA functions in SAP ASE to execute arbitrary code. This vulnerability may result in escalation of privileges, giving the attacker complete control over the product.

**CVSS Information**

- **Base Score:** 8.5 / 10
- **Attack Vector:** Network (N)
- **Attack Complexity:** Medium (M)
- **Privileges Required:** Single (S)
- **Confidentiality Impact:** Complete (C)
- **Integrity Impact:** Complete (C)
- **Availability Impact:** Complete (C)

**Impact**

Successful exploitation of this vulnerability allows an attacker to execute arbitrary code within the SAP ASE environment. This can lead to complete system compromise, including unauthorized access, data manipulation, and service disruption.

**Affected Versions**

This issue has been addressed in the following SAP ASE versions:

- SAP ASE 16.0 SP01 PL01
- SAP ASE 15.7 SP134
- SAP ASE Cluster Edition 15.7 SP134
- SAP ASE 15.5 ESD#5.5
- SAP ASE Cluster Edition 15.5 ESD#5.5
- SAP ASE 15.0.3 ESD#4.5

**Solution**

1. **Upgrade to a Fixed Version:**
   - Install the appropriate fixed SAP ASE version for your production environment from the list above.

2. **Disable `java.io` Functionality (if applicable):**
   - Log in to ASE as a user with `sa_role`.
   - Configure JRE work and temporary directories and reboot ASE using the following commands:

     ```sql
     % isql -Usa -Pxxxxxx -SMYSERVER
     1> use sybpcidb
     2> go
     1> sp_jreconfig 'disable', 'pca_jvm_work_dir', '/tmp(u+rw)'
     2> go
     1> sp_jreconfig 'update', 'pca_jvm_tmp_dir', '/tmp', '/dev/null'
     2> go
     1> sp_jreconfig 'reload'
     2> go
     1> shutdown
     2> go
     % RUN_MYSERVER &
     ```

   - **Note:** Disabling `java.io` will prevent the use of JAVA functionality within SAP ASE.

**References**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018110012017)
- [Print PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002155153?language=en-US&token=5269FAEA511E42A50BBADF2C9A306EC7)
- [Update 2181340](https://me.sap.com/notes/2181340)

For more detailed information, visit the [SAP Security Notes](https://support.sap.com/securitynotes) page.

**Credits**

Thanks to [redrays.io](https://redrays.io) for their support in providing this information.