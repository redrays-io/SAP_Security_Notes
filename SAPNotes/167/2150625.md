SAP Security Note 2150625: Potential Disclosure of Persisted Data in SAP CPQ Solution Sales Configuration

**Overview**
  
SAP has released Security Note **2150625**, addressing a critical SQL injection vulnerability in the **SAP CPQ Solution Sales Configuration**. This vulnerability allows attackers to manipulate database commands, potentially leading to unauthorized access and disclosure of persisted data.

**Details**

- **Note Number:** 2150625
- **Title:** Potential disclosure of persisted data in SAP CPQ Solution Sales Configuration
- **Type:** SAP Security Note
- **Priority:** Correction with medium priority
- **Release Date:** April 5, 2015
- **Component:** Logistics - General > Solution Configuration (LO-SLC)

**Symptom**

An attacker can exploit the SAP CPQ Solution Sales Configuration by using specially crafted inputs to modify SQL statements. This manipulation can lead to the retrieval of additional information stored in the system's database.

**Cause**

The vulnerability stems from an SQL injection flaw where the application constructs SQL statements with user-controllable input without proper sanitization. This allows attackers to alter the SQL commands executed by the database.

**Solution**

To mitigate this vulnerability, the following steps must be taken:

1. **Apply Java Patches:**
   - **FBS_SOLCONF_IPC 1.0 SP05 Patch 8** (For deployment on SAP AS Java)
   - **FBS_SOLCONF_SME 1.0 SP05 Patch 8** (For update of Solution Modeling Environment)

   *Note:* These Java patches are backward compatible and function correctly with or without the subsequent ABAP corrections.

2. **Implement ABAP Corrections:**
   - After applying the Java patches, follow the manual steps provided in the attached documents.
   - Apply the source code corrections as outlined in the SAP Note.

3. **Update Authorizations:**
   - A new PFCG role is introduced to authorize access to SAP standard tables related to product configuration.
   - If custom tables are in use or any tables are missing from the provided list, add them to the new PFCG role.
   - To verify missing authorizations:
     1. Launch configuration in the CRM/ECC system.
     2. Navigate to Netweaver Administration → Troubleshooting → Log and Traces → Log Viewer → View → Open View → Developer Trace → Filter on error.
     3. Check for any missing authorizations related to the PFCG role.
   - Additionally, use the SU53 transaction to identify any missing authorizations when prompted.

**References**

- [SAP Note 2147989: SAP Solution Sales Configuration 1.0 SP05 Patch 8](https://me.sap.com/notes/2147989)

**Attachments**

- [Manual Instructions for CRM.pdf](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000304642015&iv_version=0003&iv_guid=251571B3904A0B44B1AAA7FFDDA6242D)
- [Manual Instructions for ECC.pdf](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000304642015&iv_version=0003&iv_guid=293884CD46ED16499A09C49D078D30B4)

**Support Packages and Patches**

- Ensure that the relevant support packages and patches are applied as per the [Support Package Details](https://me.sap.com/supportpackage/SAPK-60506INSLCE).

**Credits**

Information provided with support from [Redrays.io](https://redrays.io).