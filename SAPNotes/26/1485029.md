1485029 - Protect read access to key tables

---

**SAP Security Note 1485029 - Protect Read Access to Key Tables**

**Release Date:** October 28, 2010  
**Priority:** HotNews  
**Status:** Released for Customer  
**Component:** Basis Components > Security - Read KBA 2985997 for subcomponents > Secure Store and Forward (BC-SEC-SSF)  

---

### **Symptom**

Insufficient authority checks may allow read access to tables containing cryptographic keys (PSE files).

### **Other Terms**

STRUST, public key, PSE, Personal Security Environment.

### **Solution**

Install the assigned support package. To apply the correction manually, follow these steps:

1. **Create Authorization Group SPSE:**

   - In all clients, execute transaction `SE54`.
   - Select the radio button for "Authorization Groups" and click "Create/Change".
   - Click "New entry" (<F5>) and enter the following values:
     - **AuGr:** SPSE
     - **Description:** PSE files
   - Save the new record (a transport request is required).

2. **Modify Table SSF_PSE_D:**

   - **For NW release 6.40 or newer:**
     - Execute transaction `SE11` and display table `SSF_PSE_D`.
     - Navigate to **Utilities > Assign Authorization Group**.
     - Change the existing value in the "Authorization" column to **SPSE**.
     - If no entry exists, create one and assign the authorization group **SPSE**.
     - Save the changes. If prompted with "Choose the key from the allowed namespace", press Enter to continue.
   
   - **For NW release 6.20 or older:**
     - Execute transaction `SM30` and maintain view `V_DDAT_54`.
     - Insert the following line:
       ```
       SSF_PSE_D  SPSE  PSE-Files
       ```

3. **Restrict Maintenance Access:**

   - Execute `SE11` again for table `SSF_PSE_D`.
   - Go to the "Delivery and Maintenance" tab.
   - Set **Data Browser/Table View Maintenance** to "Display/Maintenance not Allowed".
   - Activate the table after making changes.

4. **Verify Authorization Concept:**

   - Ensure that no user has generic table access to tables with the authorization group **SPSE**.
   - Use report `RSUSR002`:
     - Run the report and enter authorization object `S_TABU_DIS` in the "Selection by values" frame.
     - Add **SPSE** in the search field for the authorization group.
     - Execute the report.
   - Use SUIM reports to identify responsible roles or profiles based on the report results.

---

### **Affected Software Components**

- **SAP_APPL**: 45B  
- **SAP_BASIS**:  
  - 46A to 46D  
  - 610 to 640  
  - 700 to 702  
  - 710 to 720  
  - 72L  

---

### **Support Packages**

Install the following support packages:

| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| SAP_APPL 45B               | SAPKH45B67      | [SAPKH45B67](https://me.sap.com/supportpackage/SAPKH45B67) |
| SAP_BASIS 46B              | SAPKB46B62      | [SAPKB46B62](https://me.sap.com/supportpackage/SAPKB46B62) |
| SAP_BASIS 46C              | SAPKB46C61      | [SAPKB46C61](https://me.sap.com/supportpackage/SAPKB46C61) |
| SAP_BASIS 620              | SAPKB62069      | [SAPKB62069](https://me.sap.com/supportpackage/SAPKB62069) |
| SAP_BASIS 640              | SAPKB64027      | [SAPKB64027](https://me.sap.com/supportpackage/SAPKB64027) |
| SAP_BASIS 700              | SAPKB70023      | [SAPKB70023](https://me.sap.com/supportpackage/SAPKB70023) |
| SAP_BASIS 701              | SAPKB70108      | [SAPKB70108](https://me.sap.com/supportpackage/SAPKB70108) |
| SAP_BASIS 702              | SAPKB70205      | [SAPKB70205](https://me.sap.com/supportpackage/SAPKB70205) |
| SAP_BASIS 710              | SAPKB71011      | [SAPKB71011](https://me.sap.com/supportpackage/SAPKB71011) |
| SAP_BASIS 711              | SAPKB71106      | [SAPKB71106](https://me.sap.com/supportpackage/SAPKB71106) |
| SAP_BASIS 720              | SAPKB72004      | [SAPKB72004](https://me.sap.com/supportpackage/SAPKB72004) |

---

### **References**

- [1504652 - Consulting: Secure Configuration of Application Server ABAP](https://me.sap.com/notes/1504652)
- [1497104 - Protect access to PSE files by additional AUTHORITY-CHECK](https://me.sap.com/notes/1497104)
- [1484692 - Protect read access to password hash value tables](https://me.sap.com/notes/1484692)

---

### **Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008787222017)  
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001485029?language=en-US&token=D71DB7C9210CC735D24D9E3CADFFF5E3)

---

*Credits to [Redrays.io](https://redrays.io) for support to provided information.*