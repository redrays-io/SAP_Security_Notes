1588184 - Unauthorized use of application functions in PA-PD-PM/PA-XF

I wanted to share information about SAP Security Note **1588184**, which addresses a critical vulnerability related to unauthorized access of application functions in the **PA-PD-PM** and **PA-XF** modules.

**Symptom**

An attacker can execute functions in `PA-PD-PM` and `PA-XF` without proper authentication and authorization.

**Other Terms**

- Cross-site request forgery (CSRF/XSRF)
- PA-PD-PM
- PA-XF

**Reason and Prerequisites**

The vulnerability arises because `PA-PD-PM` and `PA-XF` execute certain functions by referencing specific URLs. An attacker can trick an authenticated user's browser into making a request with malicious URLs and parameters, causing the function to execute with the user's privileges. This can be achieved through cross-site scripting (XSS) attacks or by enticing the victim to click on a malicious link.

**Solution**

1. **Prerequisite:**  
   Ensure that you have implemented the corrections from [Note 1520324](https://me.sap.com/notes/0001520324). These corrections are required before applying this security note.

2. **Implement Correction Instructions:**  
   Follow the correction instructions provided in this note. Depending on your SAP release, use the attachments to create the relevant reports as local objects in your system. The attachments include scripts for various software components such as:
   
   - **SAP_ABA 730:** `ZBSP_XSRF_PARAM_HAP_PROF_640`
   - **SAP_ABA 711:** `ZBSP_XSRF_PARAM_HAP_PROF_640`
   - **SAP_ABA 700-702:** `ZBSP_XSRF_PARAM_HAP_PROF_640`
   - **EA-HRGXX 200 & 110:** `ZBSP_XSRF_PARAM_HAP_PROF_200` and `ZBSP_XSRF_PARAM_HAP_PROF_110`
   
   [Attachments](https://me.sap.com/notes/0001588184#attachments)

3. **Execute the Local Report:**  
   Run the created local report and specify the relevant transport request number when prompted. This will populate the `BSPTEMPXSRFSTORE` database table with necessary entries for the adapted BSP applications.

**Impact**

Implementing this security note is crucial to prevent potential CSRF attacks that could allow unauthorized actions within your SAP system, potentially compromising sensitive data and system integrity.

**Download Options**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009427392017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001588184?language=en-US&token=BE29DD87195DFD840544B8EEE14F9A71)

**Support Packages**

Refer to the relevant [Support Package](https://me.sap.com/supportpackage/SAPK-110C6INEAHRGXX) for your software component version to ensure compatibility and proper implementation.

**References**

- This note is a prerequisite for implementing other related security measures. Ensure all referenced notes and components are up to date.

---

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*