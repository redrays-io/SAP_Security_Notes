SAP Security Note 3101406 - Potential XML External Entity Injection Vulnerability in SAP Environmental Compliance

**Symptom**

Functionality *Data Import from Excel Template* in SAP Environmental Compliance 3.0 uses open source software component versions having vulnerabilities [CVE-2020-10683](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10683), BDSA-2017-0180, [CVE-2021-23926](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23926). Consequently, this functionality is potentially at risk of an XML External Entity Injection attack.

**Other Terms**

- [CVE-2020-10683](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10683)
- BDSA-2017-0180
- [CVE-2021-23926](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23926)

**Reason and Prerequisites**

Functionality of SAP Environmental Compliance uses insecure open source software component versions.

**Solution**

Two open source software component versions are replaced by secure versions. Additionally, a new optional API no longer uses the vulnerable open source software component. Refer to SAP Note [3079992](https://me.sap.com/notes/3079992) for details.

**CVSS**

- **Score:** 9.8
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  - **Attack Vector:** Network (N)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** None (N)
  - **User Interaction:** None (N)
  - **Scope:** Unchanged (U)
  - **Confidentiality Impact:** High (H)
  - **Integrity Impact:** High (H)
  - **Availability Impact:** High (H)

**Release Information**

- **Released On:** 12.10.2021
- **Category:** Program error
- **Priority:** HotNews
- **Component:** [Collaborative Cross Applications > Emissions Management (SAP xEM)](https://me.sap.com/servicessupport/knowledge/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'XAP*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)

**Downloads**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001453772021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003101406?language=en-US&token=318DEB3D31836EAD65BA0B5EFFA7F2DA)

**References**

- [SAP Note 3079992 - Improved Data Import from Excel Template](https://me.sap.com/notes/3079992)

Credits to [redrays.io](https://redrays.io) for support in providing this information.