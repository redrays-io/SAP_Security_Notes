3087254 - [CVE-2021-40496] Improper Access Control in SAP NetWeaver AS ABAP and ABAP Platform

### Symptom

SAP Internet Communication Framework (ICM) allows an attacker with logon functionality to exploit the authentication function by using POST and form fields to repeat executions of the initial command via a GET request, thereby exposing sensitive data. This vulnerability is typically exposed over the network, and successful exploitation can lead to the exposure of data such as system details.

### Other Terms

- **Authentication**
- [CVE-2021-40496](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40496)

### Reason and Prerequisites

If authentication uses POST and form fields for user/password authentication, a malicious user may provoke a situation where they can repeat the execution of the initial command or business application function using a GET request.

### Solution

Apply this SAP Security Note and ensure that the login XSRF protection provided by [SAP Security Note 1567128](https://me.sap.com/notes/1567128) is enabled for the system logon page.

Note [3090388](https://me.sap.com/notes/3090388) has been created as a pilot note release.

### CVSS

**CVSS Score:** 4.3  
**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** None (N)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

### Affected Components

- **Component:** BC-MID-ICF-LGN  
  **Description:** Basis Components > Middleware > Internet Communication Framework > ICF System Login

### References

- This document refers to [SAP Note 1567128 - Unauthorized use of application functions in System Login](https://me.sap.com/notes/1567128)

### Validity

**Software Components Affected:**

- SAP_BASIS versions 700 to 702
- 730
- 731
- 804
- 740
- 750 to 756
- 785

### Support Packages

Refer to the specific support package for your SAP_BASIS version:

- [SAPKB70039](https://me.sap.com/supportpackage/SAPKB70039) for SAP_BASIS 700
- [SAPKB70124](https://me.sap.com/supportpackage/SAPKB70124) for SAP_BASIS 701
- [SAPKB70224](https://me.sap.com/supportpackage/SAPKB70224) for SAP_BASIS 702
- [SAPKB73130](https://me.sap.com/supportpackage/SAPKB73130) for SAP_BASIS 731
- [SAPKB74027](https://me.sap.com/supportpackage/SAPKB74027) for SAP_BASIS 740
- [SAPK-75023INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75023INSAPBASIS) for SAP_BASIS 750
- [SAPK-75114INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75114INSAPBASIS) for SAP_BASIS 751
- [SAPK-75210INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75210INSAPBASIS) for SAP_BASIS 752
- [SAPK-75308INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75308INSAPBASIS) for SAP_BASIS 753
- [SAPK-75406INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75406INSAPBASIS) for SAP_BASIS 754
- [SAPK-75503INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75503INSAPBASIS) for SAP_BASIS 755
- [SAPK-75601INSAPBASIS](https://me.sap.com/supportpackage/SAPK-75601INSAPBASIS) for SAP_BASIS 756
- [SAPK-78504INSAPBASIS](https://me.sap.com/supportpackage/SAPK-78504INSAPBASIS) for SAP_BASIS 785
- [SAPK-804J2INSAPBASIS](https://me.sap.com/supportpackage/SAPK-804J2INSAPBASIS) for SAP_BASIS 804

### Correction Instructions

**SAP_BASIS:**

- [Correction Instruction 0003087254/41](https://me.sap.com/corrins/0003087254/41)

### Credits

Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.