3089413 - [CVE-2023-0014] Critical Capture-replay Vulnerability in SAP NetWeaver AS for ABAP and ABAP Platform

**Description**

SAP NetWeaver ABAP Server and ABAP Platform are affected by a capture-replay vulnerability identified as [CVE-2023-0014](https://www.cve.org/CVERecord?id=CVE-2023-0014). The system creates information about its identity in an ambiguous format, which can be exploited by malicious users to gain illegitimate access to the system.

**Impact**

- **CVSS Score:** 9.0 (Critical)
- **Attack Vector:** Network
- **Attack Complexity:** High
- **Privileges Required:** None
- **User Interaction:** None
- **Scope:** Changed
- **Confidentiality Impact:** High
- **Integrity Impact:** High
- **Availability Impact:** High

This vulnerability allows attackers to perform unauthorized actions, potentially leading to full system compromise.

**Solution**

To address this vulnerability, the system identification becomes unique, and it will be used and evaluated correctly in trusted-trusting communication scenarios. The correction involves the following steps:

1. **Update SAP Kernel:**
   - Implement the necessary patch levels for the Kernel as specified in the [Support Package](https://me.sap.com/supportpackage/SAPKB70041).

2. **Update SAP_BASIS:**
   - Apply the highest Support Package or Correction Instructions mentioned in this SAP Security Note.

3. **Migration of Trusted-Trusting Relations:**
   - Perform the migration of trusted-trusting relations as outlined in [SAP Note 3157268](https://me.sap.com/notes/3157268).

4. **Ensure Compliance:**
   - The correction must be implemented in both the trusting and trusted systems to achieve security.

**Prerequisites**

Ensure that the following prerequisites are met before implementing the correction instructions:

- **SAP_BASIS Versions:**
  - Ensure your system is running on supported versions of SAP_BASIS as listed in the [Prerequisites](https://me.sap.com/notes/3224161).

- **System Backup:**
  - Take a full backup of the system before starting the implementation to allow for restoration if necessary.

**References**

- [SAP Note 3281854 - FAQ for Security Note 3089413](https://me.sap.com/notes/3281854)
- [SAP Note 3224161 - Prerequisites for Note 3089413](https://me.sap.com/notes/3224161)
- [SAP Note 3157268 - How-To-Guide: Migration of Trusted/Trusting Relationships](https://me.sap.com/notes/3157268)
- [SAP Note 3127135 - Improved RFC Ticket Handling](https://me.sap.com/notes/3127135)
- [SAP Note 3281854 - FAQ for Security Note 3089413](https://me.sap.com/notes/3281854)

**Side Effects**

Implementing this security note may cause the following side effects:

- **Issues Caused by Implementation:**
  - [SAP Note 3240982](https://me.sap.com/notes/0003240982) - RFC raise error for non-existing destination after applying 3127135.
  - [SAP Note 3219564](https://me.sap.com/notes/0003219564) - Trusted/Trusting Roundtrip done unnecessarily.
  - [SAP Note 3274340](https://me.sap.com/notes/0003274340) - RFC Ticket not working in Non-Unicode System.
  - *...and others as listed in the original document.*

**Credits**

Thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.