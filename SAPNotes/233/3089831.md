3089831 - [CVE-2021-38176] SQL Injection vulnerability in SAP NZDT Mapping Table Framework

## Description

**Symptom**

Due to improper input sanitization, an authenticated user with certain specific privileges can remotely call NZDT function modules to execute manipulated queries or inject ABAP code. Successful exploitation could compromise the confidentiality, integrity, and availability of the system.

**Affected Systems**

This vulnerability affects the following product versions:

- SAP S/4HANA 1511, 1610, 1709, 1809, 1909, 2020, 2021
- SAP LT Replication Server 2.0, 3.0
- SAP LTRS for S/4HANA 1.0
- SAP Test Data Migration Server 4.0
- SAP Landscape Transformation

Additional affected software component versions include:

- S4CORE 100-106
- DMIS 2011, 2018, 2020

**CVSS Score**

- **Score:** 9.9
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H

## Solution

Implement the automatic correction instructions using transaction `SNOTE`. This will deactivate vulnerable function modules to mitigate the risk.

**Workaround**

As a temporary fix, apply runtime checks in Unified Connectivity (UCON) to protect against remote calls of the affected function modules. Follow the detailed steps provided in the security note to assess and implement the workaround.

For more detailed instructions, refer to the [SAP Security Note 3089831](https://me.sap.com/notes/3089831) and the [FAQ Note 3089928](https://me.sap.com/notes/3089928).

## References

- [CVE-2021-38176 Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38176)
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001318572021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003089831?language=en-US&token=2D01DC7F00AAF6C75BB2D7CBDE54EAA6)

## Affected Components

- **Component:** BC-UPG-NZ
- **Other Components:** CA-LT-SLT, CA-TDM, CA-LT-NZD

## Credits

Information supported by [RedRays.io](https://redrays.io).