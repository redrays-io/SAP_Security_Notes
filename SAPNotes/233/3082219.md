3082219 - [CVE-2021-21489] Cross-Site Scripting (XSS) vulnerability in SAP NetWeaver Enterprise Portal

## Description

### Symptom
SAP NetWeaver Enterprise Portal does not sufficiently encode user-related data, resulting in a Stored Cross-Site Scripting (XSS) vulnerability. This allows an attacker with administrative privileges to store a malicious script on the portal. Execution of the script by a victim registered on the portal could compromise the confidentiality and integrity of portal content.

### Other Terms
- XSS
- [CVE-2021-21489](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21489)
- Stored XSS
- CSS

### Reason and Prerequisites
Some stored data displayed as part of the Portal markup are encoded incorrectly.

### Solution
URL parameters are now properly encoded to prevent a successful XSS attack. Implement the Support Packages and Patches referenced by this SAP Note.

## CVSS Details

- **Score**: 4.8
- **Vector**: CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N

### Metrics
- **Attack Vector (AV)**: Network (N)
- **Attack Complexity (AC)**: Low (L)
- **Privileges Required (PR)**: High (H)
- **User Interaction (UI)**: Required (R)
- **Scope (S)**: Changed (C)
- **Confidentiality Impact (C)**: Low (L)
- **Integrity Impact (I)**: Low (L)
- **Availability Impact (A)**: None (N)

## Affected Components
- **Component**: Enterprise Portal > SAP Enterprise Portal (On Premise) > Portal Runtime (EP-PIN-PRT)

## Support Package Patches
- **PORTAL BASIS 7.20**, SP009 Patch 000026: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012946&support_package=SP009&patch_level=000026)
- **EP RUNTIME 7.20**, SP009 Patch 000023: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012953&support_package=SP009&patch_level=000023)
- **PORTAL BASIS 7.50**, SP016 Patch 000022: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001474&support_package=SP016&patch_level=000022)
- **EP RUNTIME 7.50**, SP016 Patch 000015: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP016&patch_level=000015)
- **PORTAL BASIS 7.50**, SP017 Patch 000019: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001474&support_package=SP017&patch_level=000019)
- **EP RUNTIME 7.50**, SP017 Patch 000009: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP017&patch_level=000009)
- **EP RUNTIME 7.50**, SP018 Patch 000009: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP018&patch_level=000009)
- **PORTAL BASIS 7.50**, SP018 Patch 000021: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001474&support_package=SP018&patch_level=000021)
- **EP RUNTIME 7.50**, SP019 Patch 000008: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP019&patch_level=000008)
- **PORTAL BASIS 7.50**, SP019 Patch 000013: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001474&support_package=SP019&patch_level=000013)
- **PORTAL BASIS 7.50**, SP020 Patch 000007: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001474&support_package=SP020&patch_level=000007)
- **EP RUNTIME 7.50**, SP020 Patch 000005: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP020&patch_level=000005)
- **EP RUNTIME 7.11**, SP020 Patch 000003: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006929&support_package=SP020&patch_level=000003)
- **PORTAL BASIS 7.11**, SP020 Patch 000003: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200007005&support_package=SP020&patch_level=000003)
- **PORTAL BASIS 7.50**, SP021 Patch 000002: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001474&support_package=SP021&patch_level=000002)
- **EP RUNTIME 7.50**, SP021 Patch 000004: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP021&patch_level=000004)
- **PORTAL BASIS 7.30**, SP021 Patch 000005: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200014915&support_package=SP021&patch_level=000005)
- **EP RUNTIME 7.30**, SP021 Patch 000003: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015108&support_package=SP021&patch_level=000003)
- **EP RUNTIME 7.50**, SP022 Patch 000000: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP022&patch_level=000000)
- **PORTAL BASIS 7.50**, SP022 Patch 000000: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001474&support_package=SP022&patch_level=000000)
- **EP RUNTIME 7.40**, SP023 Patch 000003: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019788&support_package=SP023&patch_level=000003)
- **PORTAL BASIS 7.40**, SP023 Patch 000004: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019766&support_package=SP023&patch_level=000004)
- **PORTAL BASIS 7.50**, SP023 Patch 000000: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001474&support_package=SP023&patch_level=000000)
- **EP RUNTIME 7.50**, SP023 Patch 000000: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001467&support_package=SP023&patch_level=000000)
- **EP RUNTIME 7.10**, SP025 Patch 000003: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006348&support_package=SP025&patch_level=000003)
- **PORTAL BASIS 7.10**, SP025 Patch 000003: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200005241&support_package=SP025&patch_level=000003)
- **PORTAL BASIS 7.31**, SP028 Patch 000004: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014354&support_package=SP028&patch_level=000004)
- **EP RUNTIME 7.31**, SP028 Patch 000003: [Link](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200014358&support_package=SP028&patch_level=000003)

## References
- **Referenced By**:
  - [3143024 - Central Note: SAP NetWeaver 7.5 SP23 - Enterprise Portal](https://me.sap.com/notes/3143024)

*Credits to [Redrays](https://redrays.io) for support in providing this information.*