SAP Security Note 3084487 - CVE-2021-38163: Unrestricted File Upload Vulnerability in SAP NetWeaver Visual Composer 7.0 RT

### Symptom

SAP NetWeaver Visual Composer allows an attacker authenticated as a non-administrative user to upload a malicious file over a network and trigger its processing, which can execute operating system commands with the privileges of the Java Server process. These commands can be used to read or modify any information on the server or shut the server down, making it unavailable.

### Other Terms

- Upload of untrusted files
- File upload vulnerability
- [CVE-2021-38163](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38163)

### Reason and Prerequisites

Program error

### Solution

**Removal of Vulnerable Component:**
Apply the provided patch to remove the vulnerable component.

**Workaround for Unpatched Versions:**
For versions that do not have a patch available, un-deploy the entire `VC70RUNTIME.SCA` from the system.

For detailed instructions on implementing the workaround, visit:
[Remove Vulnerable Component](https://me.sap.com/help/c591e2679e104fcdb8dc8e77771ff524/7.5.21/en-US/4af03bbb1e4268c5e10000000a421937.html)

*Please assess the applicability of the workaround for your SAP landscape prior to implementation.*

*Note: The workaround is a temporary fix and not a permanent solution. SAP strongly recommends applying the patches outlined in the security note instead of or after implementing the workaround.*

### CVSS

**Score:** 9.9

**Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

### Affected Software Components

- **VC70RUNTIME Versions:**
  - 7.30
  - 7.31
  - 7.40
  - 7.50

### Support Package Patches

The following support package patches are available to address this vulnerability:

| Software Component Version        | Support Package | Patch Level | URL                                                                                                                                               |
|-----------------------------------|------------------|-------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| VISUAL COMPOSER 7.0 RT 7.50        | SP016            | 000001      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001650&support_package=SP016&patch_level=000001)                        |
| VISUAL COMPOSER 7.0 RT 7.50        | SP017            | 000001      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001650&support_package=SP017&patch_level=000001)                        |
| VISUAL COMPOSER 7.0 RT 7.50        | SP018            | 000001      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001650&support_package=SP018&patch_level=000001)                        |
| VISUAL COMPOSER 7.0 RT 7.50        | SP019            | 000001      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001650&support_package=SP019&patch_level=000001)                        |
| VISUAL COMPOSER 7.0 RT 7.50        | SP020            | 000001      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001650&support_package=SP020&patch_level=000001)                        |
| VISUAL COMPOSER 7.0 RT 7.50        | SP021            | 000001      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001650&support_package=SP021&patch_level=000001)                        |
| VISUAL COMPOSER 7.0 RT 7.30        | SP021            | 000001      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200015959&support_package=SP021&patch_level=000001)                        |
| VISUAL COMPOSER 7.0 RT 7.50        | SP022            | 000000      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001650&support_package=SP022&patch_level=000000)                        |
| VISUAL COMPOSER 7.0 RT 7.40        | SP023            | 000001      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=67838200100200019805&support_package=SP023&patch_level=000001)                        |
| VISUAL COMPOSER 7.0 RT 7.50        | SP023            | 000000      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001650&support_package=SP023&patch_level=000000)                        |
| VISUAL COMPOSER 7.0 RT 7.31        | SP028            | 000001      | [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017826&support_package=SP028&patch_level=000001)                        |

For more details on support packages and patches, visit [SAP Support Portal](https://me.sap.com/).

---

Credits to [Redrays.io](https://redrays.io) for support in providing information.