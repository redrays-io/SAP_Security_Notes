3081888 - [CVE-2021-37531] Code Injection vulnerability in SAP NetWeaver Knowledge Management (XMLForms)

---

**SAP Security Note 3081888 - [CVE-2021-37531] Code Injection Vulnerability in SAP NetWeaver Knowledge Management (XMLForms)**

### Symptom
The SAP NetWeaver Portal contains an XSLT vulnerability which allows a non-administrative authenticated attacker to craft a malicious XSL stylesheet file containing a script with OS-level commands, copy it into a location to be accessed by the system, and then create a file which will trigger the XSLT engine to execute the script contained within the malicious XSL file. This can result in a full compromise of the confidentiality, integrity, and availability of the system.

### Other Terms
- Command Injection
- OS command injection
- [CVE-2021-37531](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-37531)

### Reason and Prerequisites
XMLForms uses SAPXMLToolkit as a transformer, which was not properly secured against this form of attack.

### Solution
The vulnerability is fixed with modifications to the XMLToolkit parser. This fix can be applied in the patches listed in the "Support Packages & Patches" section below.

**Workaround**  
A workaround is not possible as it is not possible to separately disable the vulnerable functionality or the XML Parser.

### Support Package Patches
| Software Component Version | Support Package | Patch Level | URL |
|----------------------------|-----------------|-------------|-----|
| ENGINEAPI 7.50 | SP016 | 000020 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP016&patch_level=000020) |
| ENGINEAPI 7.50 | SP017 | 000021 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP017&patch_level=000021) |
| ENGINEAPI 7.50 | SP018 | 000017 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP018&patch_level=000017) |
| ENGINEAPI 7.50 | SP019 | 000012 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP019&patch_level=000012) |
| ENGINEAPI 7.50 | SP020 | 000005 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP020&patch_level=000005) |
| ENGINEAPI 7.11 | SP020 | 000003 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200006917&support_package=SP020&patch_level=000003) |
| ENGINEAPI 7.30 | SP020 | 000011 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014917&support_package=SP020&patch_level=000011) |
| ENGINEAPI 7.30 | SP021 | 000002 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200014917&support_package=SP021&patch_level=000002) |
| ENGINEAPI 7.40 | SP021 | 000014 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019668&support_package=SP021&patch_level=000014) |
| ENGINEAPI 7.50 | SP021 | 000004 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP021&patch_level=000004) |
| ENGINEAPI 7.40 | SP022 | 000004 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019668&support_package=SP022&patch_level=000004) |
| ENGINEAPI 7.50 | SP022 | 000000 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP022&patch_level=000000) |
| ENGINEAPI 7.50 | SP023 | 000000 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001552&support_package=SP023&patch_level=000000) |
| ENGINEAPI 7.10 | SP025 | 000003 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200008195&support_package=SP025&patch_level=000003) |
| ENGINEAPI 7.31 | SP026 | 000014 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014267&support_package=SP026&patch_level=000014) |
| ENGINEAPI 7.31 | SP027 | 000004 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014267&support_package=SP027&patch_level=000004) |
| ENGINEAPI 7.31 | SP028 | 000003 | [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014267&support_package=SP028&patch_level=000003) |

### CVSS
**Score:** 9.9  
**Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

#### Metrics
- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

### References
- [SAP NetWeaver Knowledge Management Notes](https://me.sap.com/notes/3081888)

### Validity
Applicable to ENGINEAPI component versions 7.10 to 7.50.

### Attributes
- **Externally Reported:** Yes
- **Category:** Program error
- **Priority:** HotNews
- **Status:** Released for Customer
- **Released On:** 09/13/2021

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001318522021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003081888?language=en-US&token=8967637094E1F08559E6F4A948982A91)
- Share by Email
- Open in New Window

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*