3100882 - [CVE-2021-40499] Code Injection Vulnerability for SAP NetWeaver Application Server for ABAP (SAP Cloud Print Manager and SAPSprint)

## Description

**Symptom**

Clientsides printing services **SAP Cloud Print Manager** and **SAPSprint** for **SAP NetWeaver Application Server for ABAP** allow an attacker to inject code that can be executed by the application. An attacker could thereby control the behavior of the application.

**Other Terms**

Command Injection, OS command injection, Binary Planting, [CVE-2021-40499](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40499)

## Reason and Prerequisites

**Prerequisite:**  
**SAP Cloud Print Manager** or **SAPSprint** are installed in a non-default directory (not in `C:\Program Files` or `C:\Program Files (x86)`). Only then is there a chance of exploitation.

## Solution

Please install the patch attached to this [SAP Security Note 3100882](https://me.sap.com/notes/0003100882) **even if you are on a lower release**. **SAP Cloud Print Manager** and **SAPSprint** are fully downwards compatible.

## CVSS

- **CVSS Score:** 6.4
- **CVSS Vector:** [CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

  - **Attack Vector (AV):** Local (L)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** High (H)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** High (H)

## Affected Software Components

- **SAPCPRINT** from version **7.70 PI** to **7.70 PI**
- **SAPCPRINT** from version **7.70 BYD** to **7.70 BYD**
- **SAPSPRINT** from version **7.70** to **7.70**

## Support Package Patches

- **SAPSPRINT 7.70**
  - [Support Package SP000 Patch Level 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200013182&support_package=SP000&patch_level=000003)

- **SAP CLOUD PRNT MGR 770 FOR PI**
  - [Support Package SP000 Patch Level 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200013761&support_package=SP000&patch_level=000001)

- **SAP CLOUD PRNT MGR 770 FOR BYD**
  - [Support Package SP000 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200013762&support_package=SP000&patch_level=000002)

## References

- [SAP Security Note 3100882](https://me.sap.com/notes/0003100882)

## Credits

Thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.