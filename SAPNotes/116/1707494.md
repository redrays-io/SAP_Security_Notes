1707494 - Untrusted XML Input Parsing Possible in XI

**Description**

A malicious user can modify an XML-based request to include XML content that is then parsed locally. This vulnerability could allow an attacker to perform a denial of service (DoS) on the parsing system, disclose local data in the response to the malicious request, or access further network-located resources accessible from the parsing system.

**CVSS Information**

- **CVSS Base Score:** 5.0
- **CVSS Vector:** AV:N/AC:L/AU:N/C:P/I:N/A:N

*Note:* The CVSS score provided by SAP is an estimate of the risk posed by this vulnerability and does not account for individual system configurations or environments. It's recommended to conduct your own risk assessments when determining the applicability and priority of this security note. For more information, refer to the [SAP Security Notes FAQ](https://me.sap.com/service.sap.com/securitynotes/).

**Reason and Prerequisites**

The issue is caused by a program error in XI due to the incorrect use of an XML parser. By default, the parser opens external entities referenced within an XML input, which can lead to malicious content being parsed. This malicious content can reference internal resources, such as files, which can be disclosed in the response or used to perform a DoS attack on the parsing system, rendering application content temporarily unavailable.

**Solution**

Apply the appropriate patch as detailed in the [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017422822017) or obtain the [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001707494?language=en-US&token=13DA549469C1E0CA331427D7B35133FC).

**Affected Components**

- **Component:** Basis Components > NetWeaver Process Integration (PI) > Connectivity > SOAP Adapter (BC-XI-CON-SOP)
- **SAP Component Key:** BC-XI-CON-SOP

**References**

This document refers to:
- [SAP EhP2 for Netweaver 7.00 SP12](https://me.sap.com/notes/1740004)
- [SAP EhP1 for XI on Netweaver 7.00 SP12](https://me.sap.com/notes/1730853)
- [NW04s XI Support Package Stack 27](https://me.sap.com/notes/1724106)
- [XI 30 Support Package Stack (SPS) 30](https://me.sap.com/notes/1723780)

**Support Package Patches**

Several support package patches are available for different versions of the XI Adapter Framework. You can access the relevant patches using the following links:
- [XI Adapter Framework 7.02 SP005 Patch 000004](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012533&support_package=SP005&patch_level=000004)
- [XI Adapter Framework 7.01 SP009 Patch 000004](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200007188&support_package=SP009&patch_level=000004)
- *(Additional patches available on the Support Package Patches section of the note.)*

**Translations**

This security note is available in multiple languages:
- [Deutsch](https://me.sap.com/notes/0001707494/D)
- [日本語](https://me.sap.com/notes/0001707494/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001707494/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001707494/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001707494/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001707494/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001707494/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001707494/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001707494/3)

For more detailed information, visit the [SAP Security Notes](https://me.sap.com/notes/1707494).

*Credits: Thanks to [RedRays](https://redrays.io) for support in providing this information.*