3202523 - Cross-Site Scripting (XSS) vulnerability in SAP Commerce

## Description

**Symptom**

SAP Commerce is susceptible to a script execution attack by an unauthenticated attacker due to improper sanitization of user inputs while interacting on the network. This vulnerability arises from the usage of a vulnerable jQuery UI library. On successful exploitation, an attacker can view or modify information, leading to a limited impact on the confidentiality and integrity of the application.

**Other Terms**

- XSS, reflected XSS, CSS, [CVE-2021-41184](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41184)

**Reason and Prerequisites**

The vulnerable jQuery UI library may be present in any installation of SAP Commerce, including:
- **SAP Commerce Cloud in Public Cloud**
- **SAP Commerce Cloud on SAP Infrastructure**
- **SAP Commerce Cloud**

These installations include multiple copies of the vulnerable jQuery UI library within various SAP Commerce extensions:
- `hac` extension (Platform module)
- `testweb` extension (Platform module)
- `solrserver` extension (Search & Navigation module)
- `backoffice` extension (Backoffice Framework module)

Additionally, **SAP Commerce SmartEdit** may fetch a vulnerable jQuery UI library at build-time as a transitive dependency. However, when SmartEdit generates deployment bundles for runtime, it does not include this jQuery UI library, thereby mitigating the risk for SAP Commerce installations with SmartEdit.

**SAP Commerce Accelerator** templates before version 2205.0 ship with a vulnerable jQuery UI library. Customers using these templates must perform manual remediation steps to update the library.

**Solution**

### Upgrade

SAP Commerce addresses this vulnerability by upgrading all jQuery UI libraries to versions that are not susceptible to CVE-2021-41184. The following SAP Commerce patch releases include the necessary upgrades:

- [SAP Commerce Cloud Patch Release 2205.4](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?version=2205&locale=en-US)
- [SAP Commerce Cloud Patch Release 2105.15](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?version=2105&locale=en-US)
- [SAP Commerce Cloud Patch Release 2011.25](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?version=2011&locale=en-US)
- [SAP Commerce Cloud Patch Release 2005.30](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?version=2005&locale=en-US)
- [SAP Commerce Cloud Patch Release 1905.46](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?version=1905&locale=en-US)

These patches can be downloaded from the [Software Downloads](https://launchpad.support.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&HEADER=Y&FUNCTIONBAR=Y&EVENT=TREE&NE=NAVIGATE&ENR=67837800100800007216&V=MAINT&TA=ACTUAL/SAP%20COMMERCE) section of the SAP Support Portal. For installation instructions, refer to [About Patch Releases](https://me.sap.com/viewer/eed845124da0491e875df8139c4e6e8c/LATEST/en-US/8c25978386691014b4abdd61376acd24.html).

After applying a patch, customers must rebuild and redeploy their SAP Commerce environment:

- **SAP Commerce Cloud in Public Cloud:** Follow the [build](https://me.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/79763857d2264a189cb577fc90de0fea.html) and [deploy](https://me.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/72e126a98eb14b668709be9946070e5c.html) instructions.
- **SAP Commerce Cloud on SAP Infrastructure:** Follow the [build instructions](https://me.sap.com/viewer/d0224eca81e249cb821f2cdf45a82ace/2105/en-US/8b6ded0d86691014a6fab18e171c1f91.html) and request a deployment through a support ticket.
- **SAP Commerce On-Premises:** Follow the [build and deploy instructions](https://me.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/LATEST/en-US/8bb0ad2786691014b930c18dd4cd7851.html).

### Manual Remediation Steps

SAP does not provide patches for Accelerators. Customers with Accelerator storefronts generated from templates prior to SAP Commerce version 2205.0 must manually update the jQuery UI library to the [latest version](https://jqueryui.com/download/).

## CVSS Score

**6.1** (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

### CVSS Details

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

## Affected Components

- **Software Component:** HY_COM
- **Versions Affected:** 1905 to 2205

## References

- [CVE-2021-41184](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41184)
- [SAP Commerce Security Notes](https://me.sap.com/notes/0003202523)

*Credits to [redrays.io](https://redrays.io) for support to provided information.*