3197005 - [CVE-2022-31590] Potential privilege escalation in SAP PowerDesigner Proxy 16.7

## Description

**Symptom**

SAP PowerDesigner Proxy allows an attacker with low privileges and local access to bypass systemâ€™s root disk access restrictions. The attacker can write/create a program file on the system disk root path, which could then be executed with elevated privileges of the application during application start-up or reboot. This vulnerability potentially compromises the confidentiality, integrity, and availability of the system.

**Other Terms**

- [CWE-428: Unquoted Search Path or Element](https://cwe.mitre.org/data/definitions/428.html)
- [CVE-2022-31590](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE-2022-31590)

**Reason and Prerequisites**

- **Affected Version:** SAP PowerDesigner Proxy 16.7 SP05 up to including PL2
- **Conditions:** 
  - Default install path: `C:\Program Files\SAP\Repository Proxy 16\pdproxy16.exe`
  - Low privilege user must have write access to either `C:\Program.exe` or `C:\Program Files\SAP\Repository.exe`

On standard, untampered Windows systems, these conditions are not met. An attacker would need administrator assistance to grant write permissions or exploit another vulnerability to bypass restrictions.

## CVSS

- **Score:** 7.8
- **Vector:** [CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H](https://me.sap.com/cvss)

| Key                       | Value          |
|---------------------------|----------------|
| Attack Vector (AV)        | Local (L)      |
| Attack Complexity (AC)    | High (H)       |
| Privileges Required (PR)  | Low (L)        |
| User Interaction (UI)     | None (N)       |
| Scope (S)                 | Changed (C)    |
| Confidentiality Impact (C)| High (H)       |
| Integrity Impact (I)      | High (H)       |
| Availability Impact (A)   | High (H)       |

## Solution

Upgrade to **SAP PowerDesigner Proxy 16.7 SP05 PL03** or higher.

## Workaround

Manually update the service path to enclose it with double quotes:

1. Open **Registry Editor** as Administrator.
2. Navigate to:
   ```
   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Sybase PowerDesigner 16 Proxy
   ```
3. Edit the `ImagePath` value to include double quotes:
   - **Before:** `C:\Program Files\SAP\Repository Proxy 16\pdproxy16.exe`
   - **After:** `"C:\Program Files\SAP\Repository Proxy 16\pdproxy16.exe"`

**Note:** This is a temporary fix. SAP strongly recommends applying the official correction outlined in the security note.

## References

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000770562022)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003197005?language=en-US&token=546867E26E6C0FCF18FB3FF9B41361C3)

For more details, visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for support in providing this information.*