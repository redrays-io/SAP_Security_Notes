1487217 - Potential false redirection of web site content in B2B 0CI

**Symptom**

One Step Business Scenario (SRM) can be used to aid in phishing attacks by allowing a malicious user to publish a URL purporting to be from the product, only to redirect the user to a URL of their own choosing. This can enable a malicious user to falsely gain the trust of a victim to elicit private data from that user, such as authentication information.

**Other Terms**

Internet sales, B2B, security, OCI One Step Business; cross domain redirection

**Reason and Prerequisites**

Some pages within the One Step Business Scenario of the Web Channel B2B application enable a cross domain redirection to occur. A malicious user can include a URL from a different domain to the target application into a URL which can then be sent to users of the target application. The user believes the content to be delivered from the target application (the B2B or the SRM application), however, when such a page is visited, content is delivered from the domain of the malicious userâ€™s own choosing.

**Solution**

This note contains Java corrections for E-Commerce and CRM Web Channel.

- **Software components:** SAP-SHRJAV, SAP-SHRWEB
- **Development components:** crm/isa/isacore, crm/tc/web/core
- **Changed files:** OciLinesSendAction.java, general-security-config-data.xml, xcmadmin-security-config.xml

**Configuration**

In addition, maintain the allowed callback URLs of the calling application, for example, the SAP Enterprise Buyer Professional (EBP) application in Extended Configuration Management (XCM) of the B2B application.

1. Go to [General Application Settings - Customer - application_security](https://me.sap.com/servicessupport/knowledge).
2. Choose `application_security_config`.
3. Maintain the callback URL (HOOK URL) in the field `oci.core.url.list`.
   
   Add a list of all possible callback URLs separated by a comma (for example, `http://server1-name:port`, `http://server2-name:port`) that use the B2B Web shop as an external catalog.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017062532017)
- [PDF Version](https://me.sap.com/userapps/support/sap/support/sfm/notes/print/0001487217?language=en-US&token=02450B3F93270217D7F6BEA91970B116)

**Supported Software Components**

| Software Component       | From | To  |
|--------------------------|------|-----|
| SAP-CRMJAV               | 5.0  | 5.0 |
| SAP-CRMJAV               | 5.2  | 5.2 |
| SAP-CRMJAV               | 6.0  | 6.0 |
| ...                      | ...  | ... |
| SAP-SHRAPP               | 701  | 701 |

*(Complete list available in the original SAP note)*

**Support Package Patches**

- [SAP SHARED WEB COMPONENTS 5.2 SP009 Patch 000015](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200009131&support_package=SP009&patch_level=000015)
- [SAP SHARED JAVA COMPONENTS 5.2 SP009 Patch 000015](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200009132&support_package=SP009&patch_level=000015)
- ...
  
*(Complete list available in the original SAP note)*

**CVSS Score**

- **CVSS Score:** 0
- **CVSS Vector:** Not Provided

**Rating**

- **Rated Helpful:** 0 people
- **Quality Rating:** 0.0/5
- **Quality Votes:** 0

**Side Effects**

This document does not reference any side effects.

**Attachments**

No attachments are available for this note.

For more details, visit the [official SAP note](https://me.sap.com/notes/0001487217).

Credits to [RedRays](https://redrays.io) for support in providing this information.