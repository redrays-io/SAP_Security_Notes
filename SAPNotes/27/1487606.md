SAP Security Note 1487606 - IDoc Inbound Processing via HTTP/SOAP Vulnerability

**Overview**

SAP Security Note **1487606** addresses a critical security vulnerability related to IDoc inbound processing via HTTP or SOAP. If certain ICF services are incorrectly activated and IDoc authorizations are not sufficiently restrictive, unauthorized IDoc processing can occur, posing a significant security risk.

**Symptom**

IDoc inbound processing via HTTP or SOAP that is not required takes place if the relevant ICF services are incorrectly activated and the IDoc authorization granted is not restrictive enough.

**Reason and Prerequisites**

- Activation of services `"/sap/bc/IDoc_XML"` (Release 6.20+) or `"/sap/bc/srt/IDoc"` (Release 6.40+) in transaction SICF allows sending and processing IDocs if the user has relevant authorizations.
- This setup can lead to security risks, especially in internet or intranet scenarios.
- Refer to SAP Note [40689](https://me.sap.com/notes/40689) for information on standard passwords.

**Solution**

1. **Deactivate Unused Services**
   - If the activated services are not used in your landscape, deactivate `"/sap/bc/IDoc_XML"` or `"/sap/bc/srt/IDoc"` in transaction SICF.
   
2. **Verify Service Usage**
   - Analyze the ICMan server log via transaction `SMICM` → `Goto` → `HTTP Log` to determine if these services are in use.
   - Documentation for ICMan server log can be found on the SAP Help Portal:
     - [German](http://help.sap.com/saphelp_webas620/helpdata/de/73/b5f99d019f11d5991400508b6b8b11/content.htm)
     - [English](http://help.sap.com/saphelp_webas620/helpdata/en/73/b5f99d019f11d5991400508b6b8b11/content.htm)

3. **Restrict Authorizations**
   - Ensure that the authorization object `B_ALE_RECV` with field `EDI_MES` is properly configured to allow only desired message types.
   - Refer to SAP Note [1487928](https://me.sap.com/notes/1487928) for more details on HTTP IDoc inbound processing authorization checks.

4. **Suppress Unauthorized Processing**
   - Ensure no partner profiles exist or set existing partner profiles to "Processing in background" mode in transaction `WE20`, allowing only internal user processing.

5. **Use Web Service Framework**
   - For systems running SAP NetWeaver 2004 (Web Application Server 640+) and above, migrate to the Web Service Framework. Refer to the [SOAP Migration Guide 6.20 to 6.40](https://service.sap.com/connectors/SOAP%20Processor/Media%20Library/PDF%20document/SOAP%20Migration%20Guide%206.20%20to%206.40) for detailed migration steps.

**Additional Information**

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000017063152017](https://notesdownloads.sap.com/note/0040000017063152017)
- **PDF Version:** [https://me.sap.com/sap/support/sfm/notes/print/0001487606?language=en-US&token=54681DC0608F06BCA1FDE918DEBC96E8](https://me.sap.com/sap/support/sfm/notes/print/0001487606?language=en-US&token=54681DC0608F06BCA1FDE918DEBC96E8)

**References**

- [SAP Note 93254 - RFC short dump RFC_NO_AUTHORITY](https://me.sap.com/notes/93254)
- [SAP Note 626073 - Unreleased Internet Communication Framework services](https://me.sap.com/notes/626073)
- [SAP Note 40689 - New reports for the User Information System](https://me.sap.com/notes/40689)
- [SAP Note 1487928 - Authorization check in HTTP IDoc inbound processing](https://me.sap.com/notes/1487928)
- [SAP Note 1394100 - Security note: Access to RFC-enabled modules via SOAP](https://me.sap.com/notes/1394100)
- [SAP Note 1394093 - Collective Security Note](https://me.sap.com/notes/1394093)
- [SAP Note 1504652 - Consulting: Secure Configuration of Application Server ABAP](https://me.sap.com/notes/1504652)
- [SAP Note 2344552 - Important SAP Basis notes for integrating between a SAP on-premise system and Cloud for Customer](https://me.sap.com/notes/2344552)

Credits to [RedRays](https://redrays.io) for support in providing this information.