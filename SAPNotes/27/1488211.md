1488211 - Potential disclosure and modification of persisted data

---

**Description**

**Symptom**

A malicious user can exploit some RFC-enabled function modules in package WRB and use specially crafted inputs to execute arbitrary database commands to retrieve, modify, or remove data persisted by the system. Depending on the input, the user can induce aborts (short dumps) in the system.

**Other Terms**

SQL injection, database.

**Reason and Prerequisites**

The problem is caused by an SQL injection vulnerability. The code composes an SQL statement including strings that can be altered by a malicious user. The manipulated SQL statement can then be used to retrieve additional information from the database or to potentially modify it. Due to insufficient data validation checks, the erroneous input data can cause a short dump and abort the execution. This can influence the system stability if a flood of short dumps gets induced.

**Solution**

Based on additional input data validation checks, the system avoids short dumps in case of erroneous input data and instead sets a return code appropriately. To achieve this, please apply the correction instructions of this note or implement the corresponding Support Package.

---

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008807022017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001488211?language=en-US&token=7DE0BE0EAF01B1258A7DDD75CA7B6FF0)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001488211)

**Support Packages**

- [SAPKH60019](https://me.sap.com/supportpackage/SAPKH60019) for SAP_APPL 600
- [SAPKH60209](https://me.sap.com/supportpackage/SAPKH60209) for SAP_APPL 602
- [SAPKH60308](https://me.sap.com/supportpackage/SAPKH60308) for SAP_APPL 603
- [SAPKH60409](https://me.sap.com/supportpackage/SAPKH60409) for SAP_APPL 604
- [SAPKH60502](https://me.sap.com/supportpackage/SAPKH60502) for SAP_APPL 605

---

*Credits: Information provided with support from [Redrays.io](https://redrays.io).*