SAP Security Note 3485805: [CVE-2024-34689] Allowlisting of callback-URLs in SAP Business Workflow (WebFlow Services)

## Description

**Symptom**

Callback-URLs of WebFlow Services are checked against an allowlist. Allowlisting is activated by default and needs to be configured if you have implemented Security Note [3458789](https://me.sap.com/notes/3458789) via SNOTE or have at least a support package as listed in Security Note [3458789](https://me.sap.com/notes/3458789).

**Attention:** If allowlisting is active and allowed callback-URLs are not maintained or a callback-URL does not match an allowed pattern, those requests are not processed further.

**Other Terms**

SWF_HTTP 075, Web Services, WebFlow Services, [CVE-2024-34689](https://www.cve.org/CVERecord?id=CVE-2024-34689).

**Reason and Prerequisites**

You have configured and use Web Services/WebFlow Services of SAP Business Workflow as described [here](https://help.sap.com/docs/ABAP_PLATFORM_NEW/a602ff71a47c441bb3000504ec938fea/4f38dd19bd13553fe10000000a421937.html?locale=en-US).

## Solution

Follow the manual correction instructions attached to this note to configure the allowlisting.

### Manual Activities

1. **Optionally Activate a Trace for Allowed/Disallowed Callback-URLs**

   - As an administrator, you may temporarily activate a trace for package `SWF_URL` in transaction `SWF_TRC` to evaluate allowlisting.
   - Open transaction `SWF_TRC`, choose "Create Trace for Package" from the toolbar, and create a trace for package `SWF_URL`.
   - Adjust the activation time as needed.
   - If prompted to activate the trace component `BC-BMT-WFM`, do so via the menu.
   - Traced entries will include ALLOWLISTING and Code Reference URL_CHECK for each validated callback-URL.

2. **Configure Allowlisting in Transaction SWPA**

   - Open transaction `SWPA`, go to "Further Settings...", and choose "New Entries" from the toolbar.
   - Create a new entry with the following values:
     - **Category:** WORKFLOW
     - **Parameter:** SWF_HTTP
     - **Subparameter:** ENABLE_CALLBACK_URL_ALLOWLIST
   - Set the current value:
     - **Enable Allowlisting:** Set to `X`
     - **Disable Allowlisting:** Leave empty
   - Refer to the transaction `SWPA` documentation for more details.

3. **Maintaining Allowed Callback-URLs**

   - Use table maintenance via transaction `SM30` for view `V_SWFWSALLOW`.
   - Choose "New Entries" and specify the URL patterns to allow.
   - Enable the active-flag for each entry to be evaluated.
   - **Important:** If no allowed patterns are maintained, all requests are blocked.

## CVSS

- **Score:** 5.0
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

| Metric                       | Value         |
|------------------------------|---------------|
| **Attack Vector (AV)**       | Network (N)   |
| **Attack Complexity (AC)**   | Low (L)       |
| **Privileges Required (PR)** | Low (L)       |
| **User Interaction (UI)**    | None (N)      |
| **Scope (S)**                | Changed (C)   |
| **Confidentiality (C)**      | Low (L)        |
| **Integrity (I)**            | None (N)      |
| **Availability (A)**         | None (N)      |

## Additional Information

- **Type:** SAP Security Note
- **Version:** 9
- **Recency:** New
- **Category:** Upgrade information
- **Priority:** Correction with medium priority
- **Status:** Released for Customer
- **Released On:** 09.07.2024
- **Component:** Basis Components > Business Management > Business Workflow
- **References:** 
  - [3458789](https://me.sap.com/notes/3458789) - [CVE-2024-34689] Server-Side Request Forgery in SAP Business Workflow (WebFlow Services)

For more details, visit the [SAP Security Notes](https://me.sap.com/notes/3485805).

*Credits to [redrays.io](https://redrays.io) for support to provided information.*