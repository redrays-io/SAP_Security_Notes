SAP Security Note 3487537 - CVE-2024-41737: SSRF in SAP CRM ABAP (Insights Management)

**SAP Note/KBA**: 3487537  
**Type**: SAP Security Note  
**Version**: 8  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with medium priority  
**Status**: Released for Customer  
**Released On**: 13.08.2024  
**Component**: CRM-MKT (Customer Relationship Management > Marketing)

### Title
**3487537 - [CVE-2024-41737] Server-Side Request Forgery (SSRF) in SAP CRM ABAP (Insights Management)**

### Description
**Symptom**  
SAP CRM ABAP (Insights Management) allows an authenticated attacker to enumerate HTTP endpoints in the internal network by specially crafting HTTP requests. On successful exploitation, this can result in information disclosure. It has no impact on the integrity and availability of the application.

**Other Terms**  
Server-Side Request Forgery, SSRF, Information exposure, [CVE-2024-41737](https://www.cve.org/CVERecord?id=CVE-2024-41737).

**Reason and Prerequisites**  
Input Validation is missing, which leads to SSRF.

### Solution
Implement the [Correction Instructions](https://me.sap.com/corrins/0003487537/63) or the referenced Support Packages in this Security Note.  
**Note:** The defunct application Insights Management is deactivated.

### Workaround
Please assess the workaround applicability for your SAP landscape prior to implementation.  
**Caution:** This workaround is a temporary fix and not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note, which can be done in lieu of the workaround or after the workaround is implemented.

**Steps for Workaround:**  
1. Launch the transaction Define Services (transaction code SICF).  
2. Populate the filters with the following values:
   - **Hierarchy Type**: SERVICE
   - **Service Name**: CRM_MKTISM_TEST  
3. Press [Execute](https://me.sap.com/servicessupport/define-services).  
4. Locate the service "crm_mktism_test" with the description "auxiliary BSP application for testing purposes."  
5. Right-click on the service name and select "Deactivate service" from the context menu.  
6. Confirm the deactivation when prompted.

### Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000919882024)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003487537?language=en-US&token=2F5C94B64A441FD9B3E13879B6C93BEA)

### Support Packages
- **BBPCRM 700**: [SAPKU70027](https://me.sap.com/supportpackage/SAPKU70027)
- **BBPCRM 701**: [SAPKU70124](https://me.sap.com/supportpackage/SAPKU70124)
- **BBPCRM 702**: [SAPKU70230](https://me.sap.com/supportpackage/SAPKU70230)
- **BBPCRM 713**: [SAPKU71325](https://me.sap.com/supportpackage/SAPKU71325)
- **BBPCRM 714**: [SAPK-71423INBBPCRM](https://me.sap.com/supportpackage/SAPK-71423INBBPCRM)

### CVSS
**Score**: 5.0  
**Vector**: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N

- **Attack Vector (AV)**: Network (N)
- **Attack Complexity (AC)**: Low (L)
- **Privileges Required (PR)**: Low (L)
- **User Interaction (UI)**: None (N)
- **Scope (S)**: Changed (C)
- **Confidentiality Impact (C)**: Low (L)
- **Integrity Impact (I)**: None (N)
- **Availability Impact (A)**: None (N)

### Manual Activities
**Caution:** Perform this manual activity separately in each system where you transport the Note for implementation.

**Steps:**  
1. Launch the transaction Define Services (transaction code SICF).  
2. Populate the filters with:
   - **Hierarchy Type**: SERVICE
   - **Service Name**: CRM_MKTISM_TEST  
3. Press [Execute](https://me.sap.com/servicessupport/define-services).  
4. Locate the service "crm_mktism_test" with the description "auxiliary BSP application for testing purposes."  
5. Right-click on the service name and select "Deactivate service."  
6. Confirm the deactivation when prompted.

### Credits
Credits to [redrays.io](https://redrays.io) for support in providing this information.