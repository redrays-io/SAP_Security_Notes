SAP Security Note 2006974 - Code Injection Vulnerability in PP-PI-CFB

**Title:** 2006974 - Code Injection Vulnerability in PP-PI-CFB

**Description:**
PP-PI-CFB contains code that permits the execution of arbitrary program code of the user's choice. An attacker can control the system's behavior or potentially escalate privileges by executing malicious code without having legitimate credentials.

**Affected Components:**
- **Software Component:** SAP_APPL
- **Versions:** 606, 616, 617
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** June 10, 2014

**Solution:**
Implement the attached correction instructions. Additionally, review the BAdI documentation and implement the BAdI to allow the usage of your own reports for the overview form printing.

**Manual Activities:**
1. **Pre-Implementation:**
   - Maintain the following messages for the message class CFB in transaction SE91:
     ```
     454 You have no authorization for report &1
     ```
   - Save and activate your entry.

2. **Post-Implementation:**
   - Perform the manual post-implementation steps in each system after importing the Note.
   - Maintain the documentation for the BAdI `CFB_BADI_PRINT_WL` in transaction SE18:
     - Define a whitelist for executable reports of Process Order Overview Print to meet customer requirements.
     - Use the `GET_WHITELIST` method with the changing parameter `CV_WHITELIST` (Table of allowed values).
     - Ensure the PP, Food and Beverage Industry business function (LOG_PP_CFB) is activated.
     - Add documentation `BADI_ENH_IMPLEMENTATION`.
     - Save and activate your entry.

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011847392017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002006974?language=en-US&token=DC90640304EBA36D064268725F043884)

For more details, visit the [SAP Support Portal](https://me.sap.com/notes/2006974).

**Credits:** Thanks to [RedRays](https://redrays.io) for supporting and providing the information.