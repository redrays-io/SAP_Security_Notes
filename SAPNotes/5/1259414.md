1259414 - Cross Site Scripting: PCUI Stored JavaScript Vulnerability

**Symptom**  
Any PCUI application offering document management functionality allowing attachment of a link or an URL (such as a link to a company website or a link to a product description) to a created business transaction does not perform adequate input validation. This field inappropriately allows JavaScript to be injected into the CRM content server that may be executed in any user's browser accessing sensitive content server data.

**Other Terms**  
Cross Site Scripting, XSS Support, PCUI, F4 Help

**Reason and Prerequisites**  
The PCUI Framework does not perform adequate input validation with BSP application that allows a URL to be added as an attachment.

**Solution**  
Appropriate encoding mechanisms have been added to prevent such attacks. Please implement the corrections attached.

**Actions**  
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000007363872017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001259414?language=en-US&token=9838EBC7A5FABBD37DC346EEAEC0D8DF)
- [Share by Email](https://me.sap.com/share/0001259414)
- [Open in New Window](https://me.sap.com/opennewwindow/0001259414)

**References**  
- [890525 - Cross-Side Scripting occurs in PCUI](https://me.sap.com/notes/890525)
- [888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)
- [822881 - XSS Support for BSP-Extensions HTMLB, XHTMLB and PHTMLB](https://me.sap.com/notes/822881)

**Validity**  
- **SAP_ABA:** From 700 to 700  
- **BBPCRM:** From 400 to 400

**Support Package**  
- **BBPCRM 400:** [SAPKU40017](https://me.sap.com/supportpackage/SAPKU40017)
- **SAP_ABA 700:** [SAPKA70019](https://me.sap.com/supportpackage/SAPKA70019)

**Correction Instructions**  
- **SAP_ABA:** [Correction Instruction 44](https://me.sap.com/corrins/0001259414/44)  
- **BBPCRM:** [Correction Instruction 63](https://me.sap.com/corrins/0001259414/63)

**Preconditions**  
- **SAP_ABA:** Valid from 700 to 700  
  [880178 - Basis-relevant PCUI changes](https://me.sap.com/notes/880178)

For more details, visit the [SAP Support Portal](https://me.sap.com/notes/0001259414).

*Credits to [RedRays.io](https://redrays.io) for supporting the provided information.*