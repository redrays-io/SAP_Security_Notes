1235367 - Missing authority check in APO transaction.

# Description

### Symptom
For maintenance of planning-relevant characteristic combinations, only display and change rights can be checked (object `C_APO_FUN`, function `S_CHARC` and `C_CHARC`). There is no possibility to limit user rights for deletion.

### Other Terms
Maintain CVCs, `C_APO_FUN`

### Reason and Prerequisites
It might be useful to limit user rights for deletion of CVCs.

### Solution
A new authorization object `C_APO_CVC` is created with fields `ACTVT` and `APO_PSTRU`. The following activities can be set:
- Create CVCs
- Display CVCs
- Delete CVCs

This authorization object is added to the objects checked by function module `/SAPAPO/MCP_PERMISSION_CHECK2`.

The behavior of characteristic combination maintenance won't change if the new object `C_APO_CVC` is not assigned to any user, since the original object `C_APO_FUN` with function `S_CHARC/C_CHARC` is still checked. Additionally, the new object `C_APO_CVC` is also checked.

*Note 1262016* has been created to check `C_APO_CVC` at other points where users might be able to maintain CVCs.

If the system doesn't allow creating the new authorization object (SAP namespace), you can import the attached files (`102842.zip` contains `K102842.A3P` and `R102842.A3P`) that contain the authorization object. The procedure is described in [Note 13719](https://me.sap.com/notes/13719).

**Manual activities:**
1. Start transaction `SU21`, select object class 'APO', and from the context menu, select 'Create Authorization Object'.
2. Enter:
   - **Object**: `C_APO_CVC`
   - **Text**: APO Authorization Object: CVC Maintenance
3. Choose fields:
   - `ACTVT` Activity
   - `APO_PSTRU` Planning Object Structure ID
4. Maintain 'Permitted Activities', marking the following entries:
   - `01` Create or generate
   - `03` Display
   - `06` Delete
5. Maintain 'Authorization Object Documentation':
   - **Definition**: You can use the authorization object `C_APO_CVC` to specify whether a user can maintain characteristic value combinations of a planning object structure in Demand Planning.
   - **Defined fields**:
     - **ACTVT**: 
       - `01` (Create): Create CVCs
       - `03` (Display): Display CVCs
       - `06` (Delete): Delete CVCs
     - **APO_PSTRU**: Defines the planning object structure for which the user is allowed to execute the activities maintained in `ACTVT`.

# Software Components

| Software Component | From | To |
|--------------------|------|----|
| SCM                | 410  | 410|
| SCM                | 500  | 500|
| SCM                | 510  | 510|
| SCM                | 700  | 700|

# Support Packages

| Software Component Version | Support Package | URL                                                                                      |
|----------------------------|-----------------|------------------------------------------------------------------------------------------|
| SCM 410                    | SAPKY41019      | [Link](https://me.sap.com/supportpackage/SAPKY41019)                                     |
| SCM 500                    | SAPKY50015      | [Link](https://me.sap.com/supportpackage/SAPKY50015)                                     |
| SCM 500                    | SAPKY50014      | [Link](https://me.sap.com/supportpackage/SAPKY50014)                                     |
| SCM 510                    | SAPKY51008      | [Link](https://me.sap.com/supportpackage/SAPKY51008)                                     |
| SCM 700                    | SAPKY70001      | [Link](https://me.sap.com/supportpackage/SAPKY70001)                                     |

# Attachments

| File Name | File Size | Mime Type                     | Url                                                                                                                                                                      |
|-----------|-----------|-------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 102842.zip| 3 MB      | application/x-zip-compressed  | [Download](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000325002008&iv_version=0007&iv_guid=AC640ADD1E9A93479D96F93C37C79D08) |

# References

### This document refers to
- [1306604 - /SAPAPO/MC62 authorization for creating CVCs](https://me.sap.com/notes/1306604)
- [1262016 - Missing authority check in APO transaction.](https://me.sap.com/notes/1262016)
- [888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)
- [13719 - Preliminary transports to customers (note for customers)](https://me.sap.com/notes/13719)

### This document is referenced by
- [888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

# Preconditions

| Software Component | From | To | Number  | URL                                                                                   | Title                                                          | Component           |
|--------------------|------|----|---------|---------------------------------------------------------------------------------------|----------------------------------------------------------------|---------------------|
| SCM                | 410  | 410| 824909  | [Link](https://me.sap.com/notes/824909)                                                | Auth. check during display of characteristics combinations     | SCM-APO-FCS-BF      |

# CVSS

**CVSS Score:** 0

# Correction Instructions

| Software Component | Number of Correction Instructions | URL                                         |
|--------------------|-----------------------------------|---------------------------------------------|
| SCM                | 4                                 | [Link](https://me.sap.com/corrins/0001235367/418) |

# Support

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000007218052017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001235367?language=en-US&token=2DBC16B18645638AF74DAE2CD4C5F669)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001235367)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001235367/E/diff)

# Credits
Special thanks to [Redrays.io](https://redrays.io) for supporting the information provided.