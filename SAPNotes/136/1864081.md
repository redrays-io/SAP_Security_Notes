SAP Security Note 1864081 - Missing Authorization Check in TRM Transaction Management

## Symptom

An authenticated user can use functions of FIN-FSCM-TRM-TM to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**

- **CVSS Base Score:** 2.1
- **CVSS Base Vector:** AV:N/AC:H/AU:S/C:N/I:P/A:N

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/).

## Other Terms

Authorization, authorization check, FIN-FSCM-TRM-TM

## Reason and Prerequisites

Fin-FSCM-TRM-TM does not contain authorization checks for verifying an authenticated user's authorization to access some of its functions. This may result in undesired system behavior.

## Solution

Follow the correction instructions provided below.

### Correction Instructions

1. **Create Message Number 12 for Message Class FTR1**
   - Use transaction `SE91`.
   - Enter the short text: `No authorization: CCode &1, PType &2, activity &3`.
   - Set the "Self-explanatory" indicator.
   - Save your changes.

2. **Create Message Number 13 for Message Class FTR1**
   - Use transaction `SE91`.
   - Enter the short text: `Deal creator is not allowed to release the deal`.
   - Set the "Self-explanatory" indicator.
   - Save your changes.

3. **Update Workflow Template WS20000138**
   - Open the Workflow Builder using transaction `SWDD`.
   - Open Workflow Template `WS20000138`.
   - For each Approval activity, perform the following:
     - Go to the 'Program Exits' tab.
     - Enter `cl_swf_tr_workitem_exit` as the Program Exit class.
     - Save your changes.
   - Note: There are six approval activities - 000311, 000312, 00313, 000362, 000364, 000398.
   - Activate Workflow `WS20000138`.

## Attributes

- **Externally Reported:** Yes

## Validity

This note is valid for the following software components:

| Software Component | From | To |
|--------------------|------|----|
| EA-FINSERV         | 600  | 600|
| EA-FINSERV         | 603  | 603|
| EA-FINSERV         | 604  | 604|
| EA-FINSERV         | 605  | 605|
| EA-FINSERV         | 606  | 606|
| EA-FINSERV         | 616  | 616|
| EA-FINSERV         | 617  | 617|

## Support Packages

| Software Component Version | Support Package                         | URL                                                                                     |
|----------------------------|----------------------------------------|-----------------------------------------------------------------------------------------|
| EA-FINSERV 600             | SAPKGPFD25                             | [Link](https://me.sap.com/supportpackage/SAPKGPFD25)                                   |
| EA-FINSERV 603             | SAPK-60314INEAFINSRV                   | [Link](https://me.sap.com/supportpackage/SAPK-60314INEAFINSRV)                         |
| EA-FINSERV 604             | SAPK-60415INEAFINSRV                   | [Link](https://me.sap.com/supportpackage/SAPK-60415INEAFINSRV)                         |
| EA-FINSERV 605             | SAPK-60512INEAFINSRV                   | [Link](https://me.sap.com/supportpackage/SAPK-60512INEAFINSRV)                         |
| EA-FINSERV 606             | SAPK-60608INEAFINSRV                   | [Link](https://me.sap.com/supportpackage/SAPK-60608INEAFINSRV)                         |
| EA-FINSERV 616             | SAPK-61603INEAFINSRV                   | [Link](https://me.sap.com/supportpackage/SAPK-61603INEAFINSRV)                         |
| EA-FINSERV 617             | SAPK-61702INEAFINSRV                   | [Link](https://me.sap.com/supportpackage/SAPK-61702INEAFINSRV)                         |

## Correction Instructions Details

| Software Component | Number of Correction Instructions | URL                                                                  |
|--------------------|-----------------------------------|----------------------------------------------------------------------|
| EA-FINSERV         | 2                                 | [Link](https://me.sap.com/corrins/0001864081/201)                    |

## Manual Activities

```plaintext
1. Please use transaction SE91 to create message number 12 for the message class FTR1.
   - Enter the following short text: No authorization: CCode &1, PType &2, activity &3
   - Set the "Self-explanatory" indicator.
   - Save your changes.

2. Use transaction SE91 to create message number 13 for the message class FTR1.
   - Enter the following short text: Deal creator is not allowed to release the deal
   - Set the "Self-explanatory" indicator.
   - Save your changes.

3. Open the Workflow Builder (Transaction swdd).
   - Open Workflow Template WS20000138.
   - For each Approval activity, please repeat the following:
     - Go to tab 'Program Exits'.
     - Enter as Program Exit class 'cl_swf_tr_workitem_exit'.
     - Save your changes.
   - Note that there are six approval activities - 000311, 000312, 00313, 000362, 000364, 000398.
   - Activate Workflow WS20000138.
```

## Available Languages

- [日本語](https://me.sap.com/notes/0001864081/J) (Machine Translation)
- [Deutsch](https://me.sap.com/notes/0001864081/D) (Machine Translation)
- [Português](https://me.sap.com/notes/0001864081/P) (Machine Translation)
- [Español](https://me.sap.com/notes/0001864081/S) (Machine Translation)
- [Français](https://me.sap.com/notes/0001864081/F) (Machine Translation)
- [Italiano](https://me.sap.com/notes/0001864081/I) (Machine Translation)
- [Русский](https://me.sap.com/notes/0001864081/R) (Machine Translation)
- [中文](https://me.sap.com/notes/0001864081/1) (Machine Translation)
- [한국어](https://me.sap.com/notes/0001864081/3) (Machine Translation)

## References

This document does not refer to or is referenced by any other SAP notes or KBAs.

## Credits

Credits to [https://redrays.io](https://redrays.io) for support in providing this information.