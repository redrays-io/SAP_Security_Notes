1586410 - Potential remote code execution in RFC

# Description

An attacker can remotely exploit RFC (Remote Function Call) to enable them to take complete control of the product, including viewing, changing, or deleting data.

**CVSS Information**

- **CVSS Base Score:** 7.5
- **CVSS Base Vector:** AV:N/AC:M/AU:S/C:P/I:P/A:C

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://service.sap.com/securitynotes/).

**Other Terms**

Buffer overflow, RCE, remote code execution, RFC (Remote Function Call)

## Reason and Prerequisites

A buffer overflow vulnerability exists in SAP Message Server. This enables an attacker to inject code into the working memory that is subsequently executed by the application. It can also be used to cause a general fault in the product, causing the product to terminate.

## Solution

Apply the kernel patch provided in this note.

## Validity

Supported software components and versions affected by this security note include:

- **KRNL32NUC**
  - From: 4.6DEXT To: 4.6DEX2
  - From: 6.40 To: 6.40EX2
  - From: 7.00 To: 7.01
  - From: 7.10 To: 7.20
  - From: 7.20EXT To: 7.20EXT
- **KRNL32UC**
  - From: 6.40 To: 6.40EX2
  - From: 7.00 To: 7.01
  - From: 7.10 To: 7.20
  - From: 7.20EXT To: 7.20EXT
- **KRNL64NUC**
  - From: 4.6DEXT To: 4.6DEX2
  - From: 6.40 To: 6.40EX2
  - From: 7.00 To: 7.01
  - From: 7.10 To: 7.20
  - From: 7.20EXT To: 7.20EXT
- **KRNL64UC**
  - From: 6.40 To: 6.40EX2
  - From: 7.00 To: 7.01
  - From: 7.10 To: 7.20
  - From: 7.20EXT To: 7.20EXT
  - Versions: 8.00, 8.02
- **KERNEL**
  - From: 4.6D To: 4.6D
  - From: 6.40 To: 6.40
  - From: 7.00 To: 7.01
  - From: 7.10 To: 7.11
  - From: 7.20 To: 7.20
  - From: 8.00 To: 8.02

## Support Package Patches

Available support package patches can be found for various software component versions:

- [SAP KERNEL 8.02 64-BIT UNICODE SP005 Patch 000005](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200015012&V=MAINT)
- [SAP KERNEL 8.00 64-BIT UNICODE SP029 Patch 000029](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200017704&V=MAINT)
- [SAP KERNEL 7.00 32-BIT SP323 Patch 000323](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004059&V=MAINT)
- [SAP KERNEL 7.00 32-BIT UNICODE SP323 Patch 000323](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004835&V=MAINT)
- [SAP KERNEL 7.00 64-BIT SP323 Patch 000323](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004836&V=MAINT)
- [SAP KERNEL 7.00 64-BIT UNICODE SP323 Patch 000323](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004837&V=MAINT)
- [SAP KERNEL 7.10 32-BIT SP259 Patch 000259](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004834&V=MAINT)
- [SAP KERNEL 7.10 32-BIT UNICODE SP259 Patch 000259](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004840&V=MAINT)
- [SAP KERNEL 7.10 64-BIT UNICODE SP259 Patch 000259](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004838&V=MAINT)
- [SAP KERNEL 7.10 64-BIT SP259 Patch 000259](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200004839&V=MAINT)
- [SAP KERNEL 7.20 32-BIT SP108 Patch 000108](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200013053&V=MAINT)
- [SAP KERNEL 7.20 32-BIT UNICODE SP108 Patch 000108](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200013054&V=MAINT)
- [SAP KERNEL 7.20 64-BIT SP108 Patch 000108](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200013055&V=MAINT)
- [SAP KERNEL 7.20 64-BIT UNICODE SP108 Patch 000108](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200013056&V=MAINT)
- [SAP KERNEL 7.11 32-BIT UNICODE SP146 Patch 000146](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200011150&V=MAINT)
- [SAP KERNEL 7.11 32-BIT SP146 Patch 000146](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200011149&V=MAINT)
- [SAP KERNEL 7.11 64-BIT SP146 Patch 000146](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200011151&V=MAINT)
- [SAP KERNEL 7.11 64-BIT UNICODE SP146 Patch 000146](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200011152&V=MAINT)
- [SAP KERNEL 6.40 EX2 32-BIT SP388 Patch 000388](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200009586&V=MAINT)
- [SAP KERNEL 6.40 EX2 64-BIT SP388 Patch 000388](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200009590&V=MAINT)
- [SAP KERNEL 6.40 EX2 64-BIT UC SP388 Patch 000388](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200009591&V=MAINT)
- [SAP KERNEL 6.40 EX2 32-BIT UC SP388 Patch 000388](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200009588&V=MAINT)
- [SAP KERNEL 4.6D EX2 32-BIT SP2605 Patch 002605](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200009585&V=MAINT)
- [SAP KERNEL 4.6D EX2 64-BIT SP2605 Patch 002605](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200009589&V=MAINT)

For a complete list of supported versions and patches, please refer to the [Support Package Patches](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200314690200015012&V=MAINT) section of the security note.

## References

- [1685084 - Update #1 to Security Note 1586410](https://me.sap.com/notes/1685084)
- [888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

Credits to [Redrays.io](https://redrays.io) for support provided.