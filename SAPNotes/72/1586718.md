1586718 - Unauthorized Use of Application Functions in Codepage Fct.

---

**SAP Security Note 1586718 Overview**

**Type:** SAP Security Note  
**Version:** 2  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** August 9, 2011  
**Component:** Basis Components > Internationalization (I18N) (BC-I18)

### **Symptom**
A malicious user can execute functions in codepage functionality without proper authentication and authorization.

### **Other Terms**
- Cross-Site Request Forgery (XSRF)
- Codepage functionality
- Codepage converter

### **Reason and Prerequisites**
The vulnerability arises because certain codepage functions are executed by referencing specific URLs. An attacker can trick an authenticated user's browser into making a request with these URLs and parameters, causing the function to execute with the user's privileges. This can be exploited via cross-site scripting (XSS) attacks or by simply presenting a malicious link to the victim.

### **Solution**
1. **Apply the Relevant Support Package:**
   - Ensure that you have applied the support package mentioned in this note or follow the respective manual correction instructions.

2. **Manual Correction Instructions:**
   - **Prerequisite:** Implement SAP Note [1520324](https://me.sap.com/notes/1520324) before proceeding with these manual steps.
   - **Affected BSP Applications:**
     - `DOCX_TEST_FORMS` in package `S_OOXML_DOCX_FORM`
     - `XSLFO_MIME` in package `S_XSLFO_SUPPLEMENTARY`
     - `SCPBSPCONVERTUC` in package `SCP`
   - **Steps for All Affected BSP Applications:**
     1. Go to transaction `SE80`.
     2. Open the relevant package.
     3. Expand **BSP Library**.
     4. Expand **BSP Applications**.
     5. Double-click the specific application object.
     6. Navigate to the **Properties** tab.
     7. Switch to **Write** mode.
     8. Enable **XSRF Protection**.
     9. Save and activate the changes.
   
   - **Additional Steps for `SCPBSPCONVERTUC`:**
     10. After completing the above steps, expand `SCPBSPCONVERTUC`.
     11. Expand **Pages with Flow Logic**.
     12. Double-click `default.htm`.
     13. Go to the **Properties** tab.
     14. Switch to **Write** mode.
     15. Enable **Start BSP**.
     16. Save and activate the changes.

   - **Note:** If any of the above BSP applications are missing in your system, no action is required.

### **Support Package Information**
- **SAP_BASIS 700:** [SAPKB70025](https://me.sap.com/supportpackage/SAPKB70025)
- **SAP_BASIS 701:** [SAPKB70110](https://me.sap.com/supportpackage/SAPKB70110)
- **SAP_BASIS 702:** [SAPKB70209](https://me.sap.com/supportpackage/SAPKB70209)
- **SAP_BASIS 710:** [SAPKB71013](https://me.sap.com/supportpackage/SAPKB71013)
- **SAP_BASIS 711:** [SAPKB71108](https://me.sap.com/supportpackage/SAPKB71108)
- **SAP_BASIS 720:** [SAPKB72006](https://me.sap.com/supportpackage/SAPKB72006)
- **SAP_BASIS 730:** [SAPKB73004](https://me.sap.com/supportpackage/SAPKB73004)

### **References**
- **Related Note:** [1520324 - Advance creation of XSRF information](https://me.sap.com/notes/1520324)

### **Ratings & Feedback**
If you found this information helpful, please consider rating this document. Your feedback helps improve the quality of SAP Security resources.

---

*Credits to [RedRays](https://redrays.io) for supporting the provision of this information.*