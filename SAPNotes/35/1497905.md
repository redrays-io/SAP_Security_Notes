1497905 - Stored data may be changed or disclosed

**SAP Security Note 1497905**

**Type:** SAP Security Note  
**Version:** 4  
**Recency:** New  
**Language:** English  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 14.12.2010  
**Component:** [Financial Services > Value Adjustment (FS-RBD)](https://me.sap.com/mynotes?tab=Search&sortBy=Relevance&filters=themk%25253Aeq~'FS-RBD*'%25252BreleaseStatus%25253Aeq~'CustomerRelease'%25252BsecurityPatchDay%25253Aeq~'NotRestricted'%25252BfuzzyThreshold%25253Aeq~'0.9'&flag=mynotes)  
**Support Packages:**
- [EA-FINSERV 500 - SAPKGPFC24](https://me.sap.com/supportpackage/SAPKGPFC24)
- [EA-FINSERV 600 - SAPKGPFD19](https://me.sap.com/supportpackage/SAPKGPFD19)
- [EA-FINSERV 603 - SAPK-60307INEAFINSRV](https://me.sap.com/supportpackage/SAPK-60307INEAFINSRV)
- [EA-FINSERV 604 - SAPK-60408INEAFINSRV](https://me.sap.com/supportpackage/SAPK-60408INEAFINSRV)
- [EA-FINSERV 605 - SAPK-60502INEAFINSRV](https://me.sap.com/supportpackage/SAPK-60502INEAFINSRV)

**Description:**

### Symptom
An attacker can change stored data by making specific entries in the report `/IBS/MRB_CUST_DUPLICATE`.

### Other Terms
SQL injection, database, RBD, value adjustment, `/IBS/MRB_CUST_DUPLICATE`

### Reason and Prerequisites
The problem is caused by an SQL injection vulnerability. In the source code, an SQL statement is composed out of strings. An attacker can gain control over the content of a substring. As a result, the attacker can manipulate the resulting complete statement and can modify database contents.  
Therefore, the report must be deactivated.

### Solution
After you implement this note, check whether the whole source code has been turned into a comment.

Implement the attached source code corrections.

**Actions:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000008866642017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001497905?language=en-US&token=C409C31D3F2FBE1227B39791480D4940)
- Share by Email
- Open in New Window

**Corrections Information:**
- **Number of Correction Instructions:** 5

For more details, visit the [official SAP Note](https://me.sap.com/notes/0001497905).

*Credits to [Redrays](https://redrays.io) for support to provided information.*