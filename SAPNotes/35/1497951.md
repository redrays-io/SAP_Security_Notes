SAP Security Note 1497951 - Unauthorized Modification of Stored Content in Interaction Center

**Description**

This security note addresses a vulnerability in the ERMS E-mail Workbench and the Agent Inbox E-Mail Editor within the Interaction Center. A malicious user could exploit this vulnerability to modify application content without authorization, persist the modified content, and potentially obtain authentication information from other legitimate users.

**Impact**

- **Stored Cross Site Scripting (XSS):** Allows attackers to permanently alter website content, embed malicious scripts, and steal user authentication data.
- **Authentication Theft:** Can be used to impersonate users, potentially leading to unauthorized access to sensitive information.
- **Administrative Compromise:** If an administrator's account is targeted, it may result in a full compromise of the application's security.

**Solution**

To mitigate this vulnerability, apply the following corrective measures:

1. **Sanitize HTML Content:**
   - Ensure that your e-mail infrastructure can secure/sanitize HTML emails with active content (e.g., JavaScript) before they are sent to the Interaction Center.
   - Activate filtering on the e-mail server to sanitize incoming HTML content.

2. **Deactivate HTML Email Display:**
   - If sanitization is not feasible, deactivate the display of HTML emails in the Interaction Center by following the manual correction instructions provided in the note.

3. **Configure ERMS Rules:**
   - Set up an ERMS rule to handle (e.g., delete) incoming HTML emails.
   - Inform senders automatically that HTML mails cannot be viewed.
   - Recognize HTML mails by the E-Mail Document Type 'HTM' in the ERMS rule modeler and apply the necessary customizations.

For detailed instructions, refer to the [Correction Instructions](https://me.sap.com/notes/1497951#corrins), including the manual steps for different software component releases.

**Affected Software Components**

- **BBPCRM:** Versions 500, 520, 600, 700, 701
- **WEBCUIF:** Version 701
- **CRMIS:** Version 400

**Support Packages**

Ensure that you apply the relevant support packages for your software components as listed in the [Support Package](https://me.sap.com/notes/1497951#supportpackage) section of the security note.

**References**

- [SAP Note 1653065 - Update #1 to Security Note 1497951](https://me.sap.com/notes/1653065)
- [SAP Note 1617266 - Unauthorized Modification of Content in Interaction Center](https://me.sap.com/notes/1617266)

**Download and Print**

- [Download for SNOTE](https://me.sap.com/notes/1497951#download)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001497951?language=en-US&token=B40EDBA23EE2C6E417A07D612B2FA679)

**Credits**

Information supported by [Redrays.io](https://redrays.io) for providing comprehensive SAP security insights.