2841874 - [CVE-2020-6204] Missing Authorization Check in SAP Treasury and Risk Management (Transaction Management)

## Description

### Symptom
SAP Treasury and Risk Management (Transaction Management) allows an attacker with basic authorization to access product type information they would otherwise not have access to. The vulnerable selection query returns more records than it should, thus leading to an information disclosure. However, if an attacker tries to directly access details of an individual contract, the correct authorization will be checked and granted/denied accordingly.

### Other Terms
Access control, Authorization error, Authorization profile, Transaction Management, T_DEAL_PD, [CVE-2020-6204](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6204)

### Reason and Prerequisites
Transaction Management does not contain checks for an authenticated user's authorization to access some of its functions. This may result in undesired system behavior.

### Solution
Apply the preliminary correction via the [Correction Instructions](https://me.sap.com/corrins/0002841874/19773) or implement the corresponding Support Package. After this note, authorization object `T_DEAL_PD` will be checked. If you have properly set up the authorization according to the proposal, you won't be affected.

## CVSS Score
**4.3**  
**Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://nvd.nist.gov/vuln-metrics/cvss)

## Affected Components
- **S4CORE**
- **EA-FINSERV**

## Support Packages
- [SAPK-10108INS4CORE](https://me.sap.com/supportpackage/SAPK-10108INS4CORE) for S4CORE 101
- [SAPK-10206INS4CORE](https://me.sap.com/supportpackage/SAPK-10206INS4CORE) for S4CORE 102
- [SAPK-60322INEAFINSRV](https://me.sap.com/supportpackage/SAPK-60322INEAFINSRV) for EA-FINSERV 603
- *(Additional support packages available [here](https://me.sap.com/supportpackage/SAPK-80010INEAFINSRV))*

## Download Links
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000377022020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002841874?language=en-US&token=6307F33B13A1CE688B72E92A1FC80998)

## References
- [CVE-2020-6204](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6204)

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*