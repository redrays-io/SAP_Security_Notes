2835226 - [CVE-2019-0391] Information Disclosure in SAP NetWeaver Application Server Java(eCATT service)

**Symptom**

Under certain conditions, *SAP NW AS Java* allows an attacker to access information which would otherwise be restricted.

Some well-known impacts of Information Disclosure are:
- Loss of information and system configuration confidentiality
- Information gathering for further exploits and attacks

**Other Terms**

Information Exposure, Information Leak, [CVE-2019-0391](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0391)

**Reason and Prerequisites**

Missing implementation of authorization checks for a service.

**Solution**

In corrected systems, the vulnerable service can now only be used from a logon with a user with dedicated authorizations.

Please note that if you want to use the ECATT framework for automation of applications built with Web Dynpro Java, you need to introduce authorizations and UME roles for the respective system to allow access to the service `/ecatt/ecattping`.

SAP recommends using this service only in test systems.

The authorization has to be implemented with the application role `ecattadmin`, which will appear as "action" in the user management of the SAP NW AS Java.

To be able to call the ecattping-service, user authentication is required with a user who has the action `ecattadmin` assigned by UME-role:
1. On the start page of [SAP NetWeaver Application Server Java](https://me.sap.com/sap/support/ui/index.html), open "User Management" > "Identity Management".
2. Add a new UME-role on the Java AS.
3. Assign a UME-action with the parameters: service="tc~ecattping~enterpriseap", name="ecattadmin" to that UME-role.
4. Create or change the user who should access `/ecatt/ecattping` and assign the new UME-role to the user.

**CVSS**

- **Score:** 4.3
- **Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://nvd.nist.gov/vuln-metrics/cvss)

  | Key                     | Value        |
  |-------------------------|--------------|
  | Attack Vector (AV)      | Network (N)  |
  | Attack Complexity (AC)  | Low (L)      |
  | Privileges Required (PR)| Low (L)      |
  | User Interaction (UI)   | None (N)     |
  | Scope (S)               | Unchanged (U)|
  | Confidentiality Impact (C)| Low (L)    |
  | Integrity Impact (I)    | None (N)     |
  | Availability Impact (A) | None (N)     |

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000002022512019)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002835226?language=en-US&token=5ECC5D0689B9A7D7099A75E5D5F00E3E)

**References**

This document is referenced by:
- [2924750 - Central note for SAP NetWeaver 7.31 SP27 Application Server Java](https://me.sap.com/notes/2924750)
- [2842655 - Central note for SAP NetWeaver 7.31 SP26 Application Server Java](https://me.sap.com/notes/2842655)

**Valid Software Components**

- **FRAMEWORK**
  - From: 7.10 To: 7.11
  - From: 7.20 To: 7.20
  - From: 7.30 To: 7.30
  - From: 7.31 To: 7.31
  - From: 7.40 To: 7.40
  - From: 7.50 To: 7.50

**Support Package Patches**

- [JAVA FRAMEWORK OFFLINE 7.20 SP009 Patch Level 000030](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200012839&support_package=SP009&patch_level=000030)
- [JAVA FRAMEWORK OFFLINE 7.50 SP013 Patch Level 000004](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001591&support_package=SP013&patch_level=000004)
- [JAVA FRAMEWORK OFFLINE 7.50 SP014 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001591&support_package=SP014&patch_level=000002)
- [JAVA FRAMEWORK OFFLINE 7.50 SP015 Patch Level 000003](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001591&support_package=SP015&patch_level=000003)
- [JAVA FRAMEWORK OFFLINE 7.50 SP016 Patch Level 000001](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001591&support_package=SP016&patch_level=000001)
- [JAVA FRAMEWORK OFFLINE 7.50 SP017 Patch Level 000000](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001591&support_package=SP017&patch_level=000000)
- [JAVA FRAMEWORK OFFLINE 7.11 SP019 Patch Level 000002](https://me.sap.com/sap/support/swdc/notes?cvnr=01200314690200006944&support_package=SP019&patch_level=000002)
- ... *(additional patches can be listed similarly)*

For the complete list of support package patches, please visit the [Support Package Patches Section](https://me.sap.com/sap/support/swdc/notes).

*Credits: [RedRays.io](https://redrays.io) for support and information provided.*