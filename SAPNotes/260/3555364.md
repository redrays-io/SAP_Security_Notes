SAP Security Note 3555364: SameSite Defense in Depth not applied for some cookies in SAP Commerce

---

**SAP Security Note 3555364 - [CVE-2025-24875] SameSite Defense in Depth not applied for some cookies in SAP Commerce**

**Description**

**Symptom**
SAP Commerce, by default, sets certain cookies with the `SameSite` attribute configured to `None` (`SameSite=None`). This includes authentication cookies utilized in SAP Commerce Backoffice. Applying this setting reduces defense in depth against CSRF attacks and may lead to future compatibility issues.

**Reason and Prerequisites**
The `SameSite` attribute restricts the browser from sending cookies in certain cross-site requests, providing additional defense in depth. However, the default setting of `SameSite=None` in SAP Commerce diminishes this protection. It’s important to evaluate the impact of changing this attribute to ensure it doesn’t adversely affect storefront pages or custom cookies.

For more information on `SameSite` attributes and their implications, refer to the [Mozilla SameSite Documentation](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#samesitesamesite-value).

**CVSS Score**
- **Score:** 6.8
- **Vector:** CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N

**Solution**
To enhance security, it's recommended to adjust the `SameSite` attribute for session cookies that contain sensitive information. Depending on your specific requirements, you can set the attribute to either `Strict` or `Lax`:

- **Strict:** Provides maximum protection but may reduce usability.
- **Lax:** Offers a balance between security and usability, allowing cookies to be sent on cross-site navigation.

**Configuration Steps:**

1. **Enable SameSite Settings:**
   ```properties
   cookies.SameSite.enabled=true
   ```
2. **Set SameSite Attribute for Backoffice Cookies:**
   ```properties
   cookies.null./backoffice.SameSite=Lax
   ```

**Example:**
To set the `SameSite` attribute to `Lax` for all cookies in Backoffice, apply the above configurations. Adjust the `SameSite` values as per your security requirements and consult the [SAP Commerce 2205 Documentation](https://me.sap.com/docs/SAP_COMMERCE/d0224eca81e249cb821f2cdf45a82ace/bde41b6a42c541a08eb2a3b1993fb097.html) or the [SAP Commerce 2211 Documentation](https://me.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/e1391e5265574bfbb56ca4c0573ba1dc/bde41b6a42c541a08eb2a3b1993fb097.html) for detailed instructions.

**References**
- [CVE-2025-24875 Details](https://www.cve.org/CVERecord/SearchResults?query=CVE-2025-24875)
- [SAP Notes Download](https://notesdownloads.sap.com/note/0040000000136642025)
- [PDF Version of the Note](https://me.sap.com/sap/support/sfm/notes/print/0003555364?language=en-US&token=34ABC9AEF7B73CAFDEBFF7B3591B04DE)

**Credits**
Information supported by [RedRays.io](https://redrays.io).