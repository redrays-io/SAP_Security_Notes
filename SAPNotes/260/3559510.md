3559510 - [CVE-2025-24874] Missing Defense in Depth Against Clickjacking in SAP Commerce (Backoffice)

**Symptom**

SAP Commerce (Backoffice) uses the deprecated `X-FRAME-OPTIONS` header to protect against clickjacking. While this protection remains effective now, it may not be the case in the future as browsers might discontinue support for this header in favor of the `frame-ancestors` CSP directive. Hence, clickjacking could become possible, leading to exposure and modification of sensitive information.

**Other Terms**

`X-Frame-Options`, `Content-Security-Policy` (CSP), `frame-ancestors`, Clickjacking, [CVE-2025-24874](https://www.cve.org/CVERecord/SearchResults?query=CVE-2025-24874)

**Reason and Prerequisites**

To learn more about the `frame-ancestors` CSP directive, visit the Mozilla [documentation](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors).

SAP Commerce Backoffice depends on the **X-Frame-Options** header to prevent unwanted content framing and clickjacking. While the **X-Frame-Options** header is supported by major browsers, it has been obsoleted in favor of the **frame-ancestors** directive from the Content Security Policy (CSP) Level 2 specification. Therefore, while SAP Commerce is protected in current browser versions, that may not be the case in future browser versions.

**Solution**

- **X-Frame-Options** is retained for backward compatibility.
- **frame-ancestors 'self'** has been appended to the default value of the `backoffice.response.header.Content-Security-Policy` configuration item. See the [documentation](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/9b5366ff6eb34df5be29881ff55f97d2/f7bc40281c2c43479fcd1562b02e63e5.html#loiod0774212b4ae4b8bb3dcf39908ab5832) for more details.

**Patches to Apply:**

1. [SAP Commerce Cloud Patch Release 2205.34](https://help.sap.com/docs/SAP_COMMERCE/eed845124da0491e875df8139c4e6e8c/f9b65161e1e645249542e59f42f64a7b.html?locale=en-US&version=2205)
2. [SAP Commerce Cloud Update Release 2211.35](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/75d4c3895cb346008545900bffe851ce/f9b65161e1e645249542e59f42f64a7b.html?version=v2211)

**Software Downloads:**

Access the necessary patches via the [SAP Support Portal](https://me.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=NEXT&_HEADER=Y&_FUNCTIONBAR=Y&_EVENT=TREE&_NE=NAVIGATE&_ENR=73555000100800001224&_V=MAINT&_TA=ACTUAL/SAP%20COMMERCE%20CLOUD%20V2) for SAP Commerce Cloud in the Public Cloud or [SAP Commerce OnPrem](https://me.sap.com/#/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&_HEADER=Y&_FUNCTIONBAR=N&_EVENT=TREE&_NE=NAVIGATE&_ENR=67837800100800007216&_V=INST&_TA=ACTUAL&_PAGE=SEARCH/SAP%20COMMERCE) for on-premise installations.

**Installation Instructions:**

- **SAP Commerce Cloud in Public Cloud:** Follow the [build](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/79763857d2264a189cb577fc90de0fea.html) and [deploy](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/LATEST/en-US/72e126a98eb14b668709be9946070e5c.html) instructions.
- **SAP Commerce OnPrem:** Refer to the [build and deploy instructions](https://help.sap.com/viewer/a74589c3a81a4a95bf51d87258c0ab15/LATEST/en-US/8bb0ad2786691014b930c18dd4cd7851.html).

**Workaround**

Assess the applicability of the workaround for your SAP landscape prior to implementation. Note that this workaround is a temporary fix and not a permanent solution. SAP strongly recommends applying the corrections outlined in the security note, either instead of the workaround or after implementing it.

Follow [Backoffice Framework Security](https://help.sap.com/docs/SAP_COMMERCE_CLOUD_PUBLIC_CLOUD/9b5366ff6eb34df5be29881ff55f97d2/f7bc40281c2c43479fcd1562b02e63e5.html#loiod0774212b4ae4b8bb3dcf39908ab5832) to manually add **frame-ancestors** with a desired value into the CSP.

**CVSS Score**

- **Score:** 6.8
- **Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N)

**Attributes**

- **Externally Reported:** Yes

*Credits: [redrays.io](https://redrays.io) for supporting the information provided.*