SAP Security Note 1964201 - Directory Traversal Vulnerability in INTRASTAT: File Creation for Receipt/Dispatch - Estonia

**Symptom**

INTRASTAT: File Creation for Receipt/Dispatch - Estonia contains a vulnerability that allows an attacker to potentially read arbitrary files on the remote server, possibly disclosing confidential information.

**Other Terms**

- Directory traversal
- Transaction codes: `/CEECV/BED`

**Reason and Prerequisites**

The transaction `/CEECV/BED` fails to correctly validate the path used to reference a file read from the remote server. This flaw enables an attacker to direct the program to an arbitrary file in the system, leading to unauthorized disclosure of its contents.

**Solution**

Upgrade to the relevant Support Package by following these steps:

1. **Apply Manual Corrections**
   - Download and apply the manual corrections provided in the attachment: [Guide - Logical File Path, Name_1964201.docx](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000067092014&iv_version=0002&iv_guid=B70DDB5AA7C55645B48B23D1E6E93E0F).

2. **Apply Code Correction Instructions**
   - Use transaction SNOTE to apply the code corrections from this note.

For additional information and instructions, refer to [Note 1497003](https://me.sap.com/notes/1497003). The corrections from Note 1497003 are a prerequisite for implementing this note.

**Logical File Names Used in This Solution**

A logical file name `/CEECV/EE` has been created to enable the validation of physical file names.

**Recommendations for Setting Up Logical File Names**

- To minimize the number of logical file names, some programs share the same logical name. 
- Ensure secure separation of data by creating a directory structure that reflects user names and/or program names. This practice helps maintain security and reduces dependencies among programs.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011593592017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001964201?language=en-US&token=870C8850F81587E2B47860CBDACD733E)

**Support Packages**

- **C-CEE 110_600:** [SAPK-11038INCCEE](https://me.sap.com/supportpackage/SAPK-11038INCCEE)
- **C-CEE 110_602:** [SAPK-60224INCCEE](https://me.sap.com/supportpackage/SAPK-60224INCCEE)
- **C-CEE 110_603:** [SAPK-60324INCCEE](https://me.sap.com/supportpackage/SAPK-60324INCCEE)
- **C-CEE 110_604:** [SAPK-60422INCCEE](https://me.sap.com/supportpackage/SAPK-60422INCCEE)
- **C-CEE 110_700:** [SAPK-70002INCCEE](https://me.sap.com/supportpackage/SAPK-70002INCCEE)

For further assistance, please visit the [SAP Support Portal](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for support in providing this information.*