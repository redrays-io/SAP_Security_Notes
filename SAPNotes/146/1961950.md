SAP Security Note 1961950 - Directory Traversal Vulnerability in /CCEE/SAPCE_TABLES_MIGRATION

### Description

#### Symptom

`/CCEE/SAPCE_TABLES_MIGRATION` contains a vulnerability through which an attacker can potentially read arbitrary files on the remote server, possibly disclosing confidential information.

`/CCEE/SAPCE_TABLES_MIGRATION` contains a vulnerability through which an attacker can potentially write arbitrary files to the remote server, possibly corrupting data or altering system behavior.

#### Other Terms

Directory traversal, `/CCEE/SAPCE_TABLES_MIGRATION`

#### Reason and Prerequisites

`/CCEE/SAPCE_TABLES_MIGRATION` fails to correctly validate the path that is used to reference a file that is read from the remote server. As a result, an attacker can potentially direct the program to an arbitrary other file in the system, disclosing its contents.

`/CCEE/SAPCE_TABLES_MIGRATION` fails to correctly validate the path to which a user-submitted file is written. As a result, an attacker can potentially overwrite data in the remote system.

### Solution

As a general rule, SAP recommends that you install a solution by applying a **Support Package**. However, if you need to install a solution earlier, use the **Note Assistant** and follow the instructions below:

1. Apply manual corrections as given in the attachment.
2. Apply code correction instructions from the note using transaction SNOTE.
3. For additional information and instructions see [Note 1497003](https://me.sap.com/notes/1497003). The corrections from Note 1497003 are a prerequisite for implementing this note.

The following logical file name has been created to enable the validation of physical file names: **/CCEE/SIFI**

**Recommendations for setting up logical file names:**

To avoid maintaining a high number of logical file names, some of the programs share the same logical file name. Using the same logical file name for various programs creates dependencies among these programs. To securely separate data created by different users and different programs, try to create a directory structure that reflects the user name and/or program name and use this information when setting up the physical path and file names for the logical file paths and file names.

You can find more information about the Note Assistant in SAP Service Marketplace, under [service.sap.com/note-assistant](https://me.sap.com/note-assistant).

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011579752017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001961950?language=en-US&token=7E2F4F2BF8AE02AF5A79DEB4B704E135)
- [Share by Email](https://me.sap.com/notes/0001961950/share)
- [Open in New Window](https://me.sap.com/notes/0001961950)

### Attachments

- [Guide - Logical File Path, Name (SIFI).docx](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000025582014&iv_version=0001&iv_guid=3CCE88F1EA7ADA468110528AEE8D8584) (51 KB)

### Support Packages

| Software Component Version | Support Package         | URL                                          |
|----------------------------|-------------------------|----------------------------------------------|
| C-CEE 110_600              | SAPK-11038INCCEE        | [SAPK-11038INCCEE](https://me.sap.com/supportpackage/SAPK-11038INCCEE) |
| C-CEE 110_602              | SAPK-60224INCCEE        | [SAPK-60224INCCEE](https://me.sap.com/supportpackage/SAPK-60224INCCEE) |
| C-CEE 110_603              | SAPK-60324INCCEE        | [SAPK-60324INCCEE](https://me.sap.com/supportpackage/SAPK-60324INCCEE) |
| C-CEE 110_604              | SAPK-60422INCCEE        | [SAPK-60422INCCEE](https://me.sap.com/supportpackage/SAPK-60422INCCEE) |

### Correction Instructions

- [Correction Instruction 369](https://me.sap.com/corrins/0001961950/369)

### Manual Activities

Apply manual corrections as given in the attachment "Guide - Logical File Path, Name (SIFI).docx".

### Validity

This note is valid for the following software components:

- **C-CEE** from 110_600 to 110_600
- **C-CEE** from 110_602 to 110_602
- **C-CEE** from 110_603 to 110_603
- **C-CEE** from 110_604 to 110_604

### Credits

Information provided with support from [RedRays.io](https://redrays.io).