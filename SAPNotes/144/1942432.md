1942432 - Missing authorization check in FI-LA

**Description**

An authenticated user can use functions of FI-LA to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**

- **CVSS Base Score:** 6.5
- **CVSS Vector:** AV:N/AC:L/AU:S/C:P/I:P/A:P

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes FAQ](https://service.sap.com/securitynotes/).*

**Affected Software Components**

- **Component:** FI-LA (Financial Accounting > Lease Accounting Engine)
- **Valid Releases:** 600 to 617

**Solution**

Execute the manual activities and implement the attached correction as described in the SAP Note.

**Manual Activities**

1. **Create New Domain `FILA_AUTH_ACTIVITY`**
   - Call transaction `SE11`.
   - Enter domain `FILA_AUTH_ACTIVITY`.
   - Choose create and enter package `FI_LA_GF`.
   - Maintain a CHAR 2 domain with short description: Activities for Authorization Validation (OTP).
   - Activate the domain.

2. **Create New Data Element `FILA_AUTH_ACTIVITY`**
   - Call transaction `SE11`.
   - Enter data element `FILA_AUTH_ACTIVITY`.
   - Choose create and enter description: Activities for Authorization Validation (OTP).
   - In the Attributes tab, set Package to `FI_LA_GF`.
   - In the Data Type tab, set Elementary Type and Domain to `FILA_AUTH_ACTIVITY`.
   - Activate the element.

3. **Create New Messages in Message Class `FILAE`**
   - Call transaction `SE91`.
   - Enter Message class `FILAE`.
   - Choose change and create the following messages:
     - **Message 408**
       - German: Keine Berechtigung z. Ändern der Kontenfindungsdef. für Einmalbuchungen
       - English: No authorization for changing acc. determination def. for One-Time post.
       - Set flag Self-Explanatory
     - **Message 409**
       - German: Keine Berechtigung z. Anzeigen der Kontenfindungsdef. für Einmalbuchungen
       - English: No authorization for display acc. determination def. for One-Time post.
       - Set flag Self-Explanatory
     - **Message 410**
       - German: Keine Berechtigung zum Ändern der Kontenfindung für Einmalbuchungen
       - English: No authorization for changing account determination for One-time-post.
       - Set flag Self-Explanatory
     - **Message 411**
       - German: Keine Berechtigung zum Anzeigen der Kontenfindung für Einmalbuchungen
       - English: No authorization for display account determination for One-time-post.
       - Set flag Self_Explanatory
   - Save the created messages.

**Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000011474612017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001942432?language=en-US&token=BFFEE1D30AD0518A9461E2C4AD906B97)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001942432/E/diff)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001942432)

**References**

- **Follow-up Correction:** [1957453 - Follow-up correction for note 1942432](https://me.sap.com/notes/1957453)

**Validity**

Applicable to the following software component versions:

- EA-APPL 600 to 617

**Support Packages**

Relevant support packages can be found [here](https://me.sap.com/supportpackage/SAPKGPAD25) for EA-APPL 600, and similarly for other versions as listed in the SAP Note.

**Preconditions**

- **Prerequisite Note:** [1096026 - FILA: Write down report](https://me.sap.com/notes/1096026)

*You have to perform this manual activity separately in each system into which you transport the Note for implementation.*

*Credits to [Redrays](https://redrays.io) for support to provided information.*