1946009 - Front-End Malware can Potentially Harm SAP Installations

### Symptom

There have been media reports that we would like to bring to your attention. Certain malware variants are now specializing at stealing SAP-relevant information from Front-End systems such as Windows workstations. There can be information-stealing trojans that check if SAP software is installed on infected computers. In some cases the attackers are using the execution of known SAP Front-End executables to trigger a recording of user activity and various environmental information. This can include the command-line arguments passed into it, captured keystrokes combined with a series of screenshots all of which are transmitted to command-and-control (C&C) servers.

It is suggested that information is sent to the C&C server using VNC components that are a part of the malware and include critical information such as:

- **Keylogs:**
  - SAP password and sometimes the user name.

- **Screenshots:**
  - SAP user name, server name, some confidential data, and more.

- **Command-line arguments:**
  - Unlikely to contain sensitive information based on initial analysis of the `saplogon.exe` binary.

Additionally, the VNC connection can potentially be used by the attacker to remotely control the workstation, and potentially perform a targeted attack at a SAP server within the same network. This however is not an exploit in SAP software, rather a malware that affects executables running on certain popular operating systems (OS). Therefore, we recommend reading this advisory from Microsoft:

[Carberp-based Trojan Attacking SAP](http://blogs.technet.com/b/mmpc/archive/2013/11/20/carberp-based-trojan-attacking-sap.aspx)

### Other Terms

TrojanSpy:Win32/Gamker.A, Win32/Carberp, saplogon.exe, C&C server, banking trojan, Trojan horse PSW.Agent.BDPV(AVG), W32/Dofoil.QTZ!tr(Fortinet), Win32/Spy.Shiz.NCM trojan(NOD32), Trojan.Win32.Dofoil.sd (v)(Sunbelt), TR/Spy.Shiz.NCM(Antivir)

### Solution

- **Keep your front-end anti-malware, IPS, and anti-virus software regularly updated.**
- **Allow users to run with minimal authorizations.** Limit user privileges on the computer. Ensure that programs and users of the computer use the lowest level of privileges to complete work.
- **Using SSO software can help,** because users no longer have to enter passwords (which means the keylogger will not be able to steal passwords – at least not so easily); if SSO is not available or suitable, the use of password depots reduces the risk of password keylogging, too.
- **Enable a firewall and/or Host-IPS on your computer.**
- **Get the latest computer updates for all your installed software.**
- **Turn off AutoRun** to prevent auto-execution of malware on removable drives.
- **Ensure you have regular current successful data-backup of your files.**
- **Use strong complex passwords.** Do not reuse the same password on multiple websites, accounts, or computers.
- **Security education.** Schedule training courses for all employees. A security-smart employee may be able to avoid infection in the first place.

Further analysis: [Bkdr_Shiz Responsible for SAP Attacks and More](http://blog.trendmicro.com/trendlabs-security-intelligence/bkdr_shiz-responsible-for-sap-attacks-and-more/)

### Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017766932017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001946009?language=en-US&token=C37C63C35ED043ABB2A1CB7E7EE06432)
- [Compare Versions](https://me.sap.com/notesLatestChanges/0001946009/E/diff)

*Credits: [redrays.io](https://redrays.io)*