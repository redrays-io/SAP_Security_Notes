1943208 - Unauthorized modification of stored content in KM Content Management

**Symptom**

KM Content Management can be abused by an attacker, allowing them to modify application content, persist the modified content without authorization, and to potentially obtain authentication information from other legitimate users.

**CVSS Information**  
CVSS Base Score:Â 3.5  
CVSS Base Vector: AV:N/AC:M/AU:S/C:N/I:P/A:N

SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/).

**Reason and Prerequisites**

KM Content Management results in a stored cross-site scripting issue.

It can be used to permanently modify displayed content from a Web site, allowing the attacker to embed content that is rendered automatically, without the attacker having to target victims individually.

Stored cross-site scripting can also be used to steal another user's authentication information, such as data relating to their current session.

An attacker who gains access to this data may use it to impersonate the user and access all information with the same rights as the target user. If an administrator is impersonated, the security of the application may be fully compromised.

**Solution**

A.) For more information about the affected releases, see the "SP Patch Level" section of this SAP note.  
For more information about the SP Stack schedule and updates, see [SP Stacks maintenance schedule](http://service.sap.com/sp-stacks).

B.) Possible workaround before the release of mentioned deliveries:  
There is no workaround possible.

**Support Package Patches**

- **KMC CONTENT MANAGEMENT 7.40**
  - [SP004 Patch 000003](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP004&patch_level=000003)
  - [SP003 Patch 000006](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP003&patch_level=000006)
  - [SP005 Patch 000003](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP005&patch_level=000003)
  - [SP002 Patch 000004](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP002&patch_level=000004)
  - [SP006 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP006&patch_level=000001)
  - [SP007 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019802&support_package=SP007&patch_level=000000)

- **KMC CONTENT MANAGEMENT 7.31**
  - [SP005 Patch 000013](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP005&patch_level=000013)
  - [SP009 Patch 000004](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP009&patch_level=000004)
  - [SP008 Patch 000007](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP008&patch_level=000007)
  - [SP012 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP012&patch_level=000000)
  - [SP006 Patch 000010](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP006&patch_level=000010)
  - [SP011 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP011&patch_level=000001)
  - [SP010 Patch 000003](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014363&support_package=SP010&patch_level=000003)

- **KMC CONTENT MANAGEMENT 7.30**
  - [SP005 Patch 000025](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP005&patch_level=000025)
  - [SP009 Patch 000009](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP009&patch_level=000009)
  - [SP008 Patch 000016](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP008&patch_level=000016)
  - [SP012 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP012&patch_level=000000)
  - [SP007 Patch 000023](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP007&patch_level=000023)
  - [SP010 Patch 000004](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP010&patch_level=000004)
  - [SP011 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200015120&support_package=SP011&patch_level=000001)

- **KMC CONTENT MANAGEMENT 7.02**
  - [SP012 Patch 000011](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP012&patch_level=000011)
  - [SP013 Patch 000007](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP013&patch_level=000007)
  - [SP014 Patch 000004](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP014&patch_level=000004)
  - [SP015 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP015&patch_level=000001)
  - [SP016 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200012504&support_package=SP016&patch_level=000000)

- **KMC CONTENT MANAGEMENT 7.01**
  - [SP013 Patch 000004](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP013&patch_level=000004)
  - [SP014 Patch 000003](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP014&patch_level=000003)
  - [SP015 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP015&patch_level=000001)
  - [SP016 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200010809&support_package=SP016&patch_level=000000)

- **KMC CONTENT MANAGEMENT 7.00**
  - [SP028 Patch 000005](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP028&patch_level=000005)
  - [SP029 Patch 000002](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP029&patch_level=000002)
  - [SP030 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP030&patch_level=000001)
  - [SP031 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200007913&support_package=SP031&patch_level=000000)

**Side Effects**

This document is causing side effects:

- [Executing 'Start Folder' command results in a System Error message](https://me.sap.com/notes/0002004497)

**References**

This document is referenced by:

- [1943041 - Central Note for KMC in the NW 7.31 SP12](https://me.sap.com/notes/1943041)
- [1926347 - Central Note for KM&COLL for NW 701 SP16](https://me.sap.com/notes/1926347)
- [1926344 - Central Note for KM&COLL for NW 700 SP31](https://me.sap.com/notes/1926344)
- [1966982 - Central Note for KMC in the NW 7.31 SP12](https://me.sap.com/notes/1966982)

For more details, visit the [SAP Security Notes](https://me.sap.com/notes/1943208).

*Credits to [RedRays.io](https://redrays.io) for support and information.*