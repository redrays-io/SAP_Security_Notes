SAP Security Note 2597543 - Directory Traversal Vulnerability in SAPCAR

---

**SAP Note Number:** 2597543  
**Type:** SAP Security Note  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** March 13, 2018  
**Component:** BC-INS-TLS  
**Version:** 2

### Symptom

SAPCAR contains a vulnerability through which an attacker can potentially write files to arbitrary directories on the server, possibly corrupting data or altering system behavior.

### Other Terms

- Path traversal
- Backtracking
- Directory climbing
- Absolute path

### Reason and Prerequisites

During archive creation, it is possible to specify absolute paths for individual files or for all files via the option `-P` for SAPCAR to append the current work directory to filenames with relative paths. Although this option is made available for archive creation, it is not recommended to use absolute paths due to security risks during archive extraction. For security reasons, SAP always uses relative paths for files in archives that are released to customers.

During archive extraction, SAPCAR fails to validate file paths that may point to locations outside the intended target directory.

### Solution

Please apply at least the patch level as indicated in the section "Support Packages & Patches".

With this SAP Note, as the default behavior, SAPCAR performs the necessary validation on file paths in an archive during extraction, for example, by removing the drive letter, stripping leading slashes, and normalizing directory traversal commands like `../`, in order to prevent files in question from being extracted to a directory outside the intended target directory.

For backward compatibility, an option, `-xnopvalid`, is provided to switch back to the old behavior so that file path validation is not performed during the extraction process. This option should be used with caution due to security risks.

### Affected Software Components

- **SAP_CAR:** 7.21

### Download

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000474992018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002597543?language=en-US&token=1FD71D1EB45E9C1CF4390E6B9E784BBA)

### Additional Information

For more details, visit the [SAP Support Notes](https://me.sap.com/notes/2597543).

**Credits:** [redrays.io](https://redrays.io) for support to provided information.