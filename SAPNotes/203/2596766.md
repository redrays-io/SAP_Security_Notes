2596766 - [CVE-2018-2401] XML External Entity vulnerability in SAP BPA BY REDWOOD

**Symptom**

SAP Business Process Automation (BPA) BY REDWOOD does not sufficiently validate an XML document accepted from an untrusted source, resulting in an XML External Entity (XXE) vulnerability.

Some well-known impacts of missing XML validation are:
- Arbitrary file retrieval from the server
- Denial-of-service conditions in successful exploits

**CVSS Information**

- **CVSS v3 Base Score:** 5.4 / 10
- **CVSS v3 Vector:** AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L

*SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://support.sap.com/securitynotes).*

**Other Terms**

XXE, XML input parsing, [CVE-2018-2401](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-2401)

**Reason and Prerequisites**

An attacker can send a malicious XML in the request body, and it will be parsed with External Entity support, making the service unavailable.

**Solution**

The external entity parsing is restricted by the correction.

The solution is available in **SAP BPA BY REDWOOD version 9.0.23 and higher**.

The issue has also been fixed in **SAP BPA BY REDWOOD version 9.0.22, patch level 9.0.22.6 and higher**.

Please implement the version and patch level mentioned in this SAP Note.

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000474982018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002596766?language=en-US&token=83BB9D48264E55DFA068E91F89EC2385)

**Credits**

Thanks to [Red Rays](https://redrays.io) for support in providing this information.