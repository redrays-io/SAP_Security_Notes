SAP Security Note 2590705 - [CVE-2018-2451] Unsecure xs CLI Session Timeout Handling in SAP HANA Extended Application Services, advanced

**Overview**

SAP has released Security Note [2590705](https://me.sap.com/notes/2590705) addressing a critical vulnerability identified as [CVE-2018-2451](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2451). This vulnerability pertains to the unsecure handling of session timeouts in the xs CLI of SAP HANA Extended Application Services, advanced. An attacker exploiting this flaw could maintain access to Controller resources even after user authorizations have been revoked or the user account has been deactivated, potentially leading to unauthorized access and misuse of session tokens.

**Vulnerability Details**

- **CVE:** [CVE-2018-2451](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2451)
- **CVSS v3 Base Score:** 6.6 / 10
  - **Attack Vector:** Network (N)
  - **Attack Complexity:** High (H)
  - **Privileges Required:** High (H)
  - **User Interaction:** None (N)
  - **Scope:** Unchanged (U)
  - **Confidentiality Impact:** High (H)
  - **Integrity Impact:** High (H)
  - **Availability Impact:** High (H)

**Affected Components**

- **Component:** BC-XS-SEC
- **Description:** Basis Components > HANA XS Advanced > UAA and Security for HANA XSA engine

**Solution**

To mitigate this vulnerability, upgrade to SAP HANA Extended Application Services, advanced model version **1.0.87** or later. Applying this update ensures that session tokens are properly invalidated upon logout or when user authorizations are revoked.

Additionally, update your local xs CLI installations as outlined in the [SAP HANA Administration Guide](https://me.sap.com/servicessupport/knowledge/notes/2590705/SAP%20HANA%20Administration%20Guide). This update enhances the logout functionality by ensuring that revoked session tokens are promptly invalidated, reducing the risk of unauthorized access. Be aware that the default token cache timeout is set to 30 minutes for performance reasons, but this can be adjusted in the `xscontroller.ini` configuration file if needed.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001608282018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002590705?language=en-US&token=774049D7664006AEFA96EB9893B80F6E)

**Available Translations**

- [Deutsch](https://me.sap.com/notes/0002590705/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002590705/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002590705/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002590705/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002590705/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002590705/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002590705/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002590705/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002590705/3)

**Credits**

Credits to [RedRays](https://redrays.io) for support in providing this information.