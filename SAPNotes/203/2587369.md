2587369 - [CVE-2018-2402] Potential information disclosure in SAP HANA capture & replay trace file

**Title:** 2587369 - [CVE-2018-2402] Potential information disclosure in SAP HANA capture & replay trace file

**Description:**
In systems utilizing the optional capture & replay functionality of SAP HANA, there is a vulnerability where user credentials may be stored in clear text within the indexserver trace files of the control system. An attacker with the necessary authorizations on the control system could access these credentials, leading to unauthorized data access in both the captured and target systems.

**CVSS Information:**
- **CVSS v3 Base Score:** 7.6/10
- **Vector:** AV:N/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:H

**Impact:**
- **Confidentiality:** High
- **Integrity:** High
- **Availability:** High

**Prerequisites:**
- Use of the optional capture & replay functionality in SAP HANA.
- Trace level set to minimum `info` in `global.ini->trace->workloadreplaycmd` or `wlreplayer.ini->trace->workloadreplayerservice`.
- Not utilizing the password reset feature for capture and replay.
- Replay Admin manually enters passwords for replay configuration.
- Attacker has `TRACE_ADMIN` or `CATALOG READ` privileges to access trace files.

**Affected Versions:**
- SAP HANA 1 SP12: 122.15 and before
- SAP HANA 2 SP01: 12.03 and before
- SAP HANA 2 SP02: 23 and before

**Workaround:**
1. **Adjust Trace Levels:**
   - Set `global.ini->trace->workloadreplaycmd` on the control system side and `wlreplayer.ini->trace->workloadreplayerservice` on the replayer side to `error`.
2. **Use Password Reset Feature:**
   - Implement the password reset feature in SAP HANA Cockpit (version 2.4.11 or later) to reset captured user passwords, ensuring that only chosen passwords appear in the trace files.

**Solution:**
The issue has been resolved in the following revisions. Update to these versions or later:
- SAP HANA 1 SP12: 122.15
- SAP HANA 2 SP01: 12.03
- SAP HANA 2 SP02: 23

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000474902018)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002587369?language=en-US&token=329AC3215EA413397A2DF3F25CD3EE80)

**Additional Information:**
For more details and support, visit [SAP Support](https://me.sap.com/).

*Credits to [RedRays](https://redrays.io) for support in providing this information.*