2522510 - [CVE-2017-16680] Potential audit log injection vulnerability in SAP HANA XS Advanced

**Title:** 2522510 - [CVE-2017-16680] Potential audit log injection vulnerability in SAP HANA XS Advanced

**Description:**

### Symptom
Two potential audit log injections have been identified in SAP HANA Extended Application Services, advanced model:

1. **Controller Service Vulnerability:** Certain HTTP/REST endpoints of the controller service lack proper user input validation, allowing unprivileged attackers to forge audit log lines. This can hinder or misdirect the interpretation of audit log files.
   
2. **UAA Log Escaping Issue:** The User Account and Authentication (UAA) service writes audit logs to both syslog and a log file. The entries in the log file miss proper escaping, potentially hindering or misdirecting the interpretation of audit log files, while entries in syslog remain correct.

**CVSS Information:**

- **Base Score:** 5.3 / 10
- **Vector:** AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N

**Solution:**

The vulnerability has been addressed in SAP HANA Extended Application Services, advanced model (XS Advanced) version **1.0.63**. It is recommended to apply this or a later version to mitigate the risks.

**Workaround:**  
As an interim measure, customers should configure the XSA Controller to write audit log lines exclusively to syslog, thereby avoiding the vulnerable file system logs. This can be achieved by setting the property `syslog` to `true` in the `[audit]` section of the `xscontroller.ini` file. Note that UAA continues to write audit log entries to syslog (which is not vulnerable) and the file system.

**References:**

- [CVE-2017-16680](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-16680)
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000020417422017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002522510?language=en-US&token=87EDFD076603B80CB3736BF002C85112)

**Release Information:**

- **SAP Note Number:** 2522510
- **Type:** SAP Security Note
- **Version:** 9
- **Released On:** December 12, 2017
- **Component:** Basis Components > HANA XS Advanced > XS Advanced Runtime / XS Controller

**Credits:**  
Special thanks to [RedRays](https://redrays.io) for supporting the provision of this information.