2520064 - Missing Authentication Check in SAP Point of Sale (POS) Retail Xpress Server

**Description**

**UPDATE 6th September 2017**: This note has been re-released with updated “solution text”, “Validity” and “Attachments” information.

SAP POS Xpress Server does not perform any authentication checks for functionalities that require user identity.

Some well-known impacts of Missing Authentication check are:
- Read, modify, or delete sensitive information
- Access administrative or other privileged functionalities

**CVSS Information**

- **CVSS v3 Base Score:** 8.1 / 10
- **CVSS v3 Base Vector:**
  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Unchanged (U)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** High (H)

SAP provides this CVSS v3 base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://me.sap.com/securitynotes](https://me.sap.com/securitynotes).

**Reason and Prerequisites**

System is only vulnerable if it is exposed to the Internet. Attacker needs a network connection to POS Xpress server.

**Solution**

Missing encryption and authentication were added to the SAP Point of Sale (POS) Xpress Server communication channel.

This ensures that the communication is secured against eavesdropping or unauthorized access.

Patch files for the latest SPs for SAP POS Xpress Server v2.2 and v2.3 have been attached to this note. The zip file that contains the patch files is broken into multiple zip files due to the 2MB file size limit.

These patch files also include the fix for the security vulnerability addressed by SAP Note [2476601](https://me.sap.com/notes/2476601).

For v2.2, the patch files are the ones beginning with **SAPPOS22**. For v2.3, the patch files are the ones beginning with **SAPPOS23**.

**Important:** Registers and server must be patched at the same time. Any registers not patched will be unable to communicate with a patched server or vice versa.

**Instructions to Apply Patch**

_For each POS register:_
1. Ensure that the Point of Sale application is not running
2. Extract contents of the zip file
3. Copy files from the extracted `PointOfSale` directory to the directory where Point of Sale is installed (e.g., `C:\Program Files (x86)\SAP\Retail Systems\Point of Sale`)
4. Copy files from the extracted `SAPShared_RetailSystems` directory to `C:\Program Files (x86)\Common Files\SAP Shared\Retails Systems`

_For Xpress Server and Backup Server:_
1. Ensure all SAP POS applications are closed and the Xpress Server has been stopped
2. Extract contents of the zip file
3. Copy files from the extracted `XpressServer` directory to the directory where Xpress Server is installed (e.g., `C:\Program Files (x86)\SAP\Retail Systems\Xpress Server`)
4. Copy files from the extracted `SAPShared_RetailSystems` directory to `C:\Program Files (x86)\Common Files\SAP Shared\Retails Systems`

_Remaining Instructions for DBTools for SAP POS v2.3 ONLY:_
1. Copy files from the extracted `DBTools` directory to the directory where DBTools is installed (e.g., `C:\Program Files (x86)\SAP\Retail Systems\DBTools`)
2. Start DBTools
3. Select "BackoffMS" or "BackoffSY" database
4. Enter Login and Password for the database
5. Select menu item Tools → Upgrade Database
6. Choose whether to backup the database before upgrade
7. Click Start
8. Once finished, select Close and exit DBTools

_If Store Manager is installed on a different system than the Xpress Server, copy the `SAPShared_RetailSystems` directory to the same directory mentioned in the Xpress Server instructions._

**Note:** The file paths provided are for 64-bit Windows. If you are using 32-bit Windows, substitute "Program Files (x86)" with "Program Files".

You can verify that the patch files have been applied correctly by checking the version and build number:
- For v2.3: `V10.3.0SP11Build11772017-8-17`
- For v2.2: `V10.2.0Build11532017-9-1`

_For POS registers, run Manager Code 999._
_For Server, right-click on `xps.exe` located in the Xpress Server directory, select the "Version" tab, then select "Product Version" from the list._

**Attachments**

- [SAPPOS23SP11_Build1177_SecurityPatch.zip](https://me.sap.com/notes/0002520064/SAPPOS23SP11_Build1177_SecurityPatch.zip) (1.531 MB)
- [SAPPOS23SP11_Build1177_SecurityPatch.z01](https://me.sap.com/notes/0002520064/SAPPOS23SP11_Build1177_SecurityPatch.z01) (2.048 MB)
- [SAPPOS23SP11_Build1177_SecurityPatch.z02](https://me.sap.com/notes/0002520064/SAPPOS23SP11_Build1177_SecurityPatch.z02) (2.048 MB)
- [SAPPOS23SP11_Build1177_SecurityPatch.z03](https://me.sap.com/notes/0002520064/SAPPOS23SP11_Build1177_SecurityPatch.z03) (2.048 MB)
- [SAPPOS22_Build1153_SecurityPatch.zip](https://me.sap.com/notes/0002520064/SAPPOS22_Build1153_SecurityPatch.zip) (1.272 MB)
- [SAPPOS22_Build1153_SecurityPatch.z01](https://me.sap.com/notes/0002520064/SAPPOS22_Build1153_SecurityPatch.z01) (2.048 MB)

**References**

- [SAP Note 2476601 - Missing Authentication Checks in SAP Point of Sale (POS) Retail Xpress Server](https://me.sap.com/notes/2476601)

Credits to [https://redrays.io](https://redrays.io) for support to provided information.