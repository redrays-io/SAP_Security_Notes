SAP Security Note 2525222 - [CVE-2018-2395] Security vulnerabilities in SAP Internet Graphics Server (IGS)

**Overview**

SAP has released Security Note **2525222** addressing multiple security vulnerabilities in the **SAP Internet Graphics Server (IGS)**. These vulnerabilities pose significant risks, including unauthorized file access, denial of service (DoS), cross-site scripting (XSS), log injection, and information disclosure.

**Affected Components:**
- **Component:** BC-FES-IGS (Basis Components > Frontend Services > Internet Graphics Server)
- **Versions:** 7.20, 7.20EXT, 7.45, 7.49, 7.53

**Vulnerabilities Addressed:**

1. **Unrestricted File Upload**
   - **CVE-2018-2395**
   - **Description:** Allows malicious users to retrieve system information, overwrite existing images, or corrupt files.
   - **CVSS v3 Base Score:** 8.3/10

2. **Denial of Service (DoS)**
   - **CVE-2018-2394**
     - **CVSS Score:** 7.5
   - **CVE-2018-2396, CVE-2018-2391, CVE-2018-2390, CVE-2018-2386, CVE-2018-2385, CVE-2018-2384**
     - **CVSS Scores:** 5.3 each
   - **Description:** Various vulnerabilities that can prevent legitimate users from accessing IGS services.

3. **Missing XML Validation**
   - **CVE-2018-2393**
     - **CVSS Score:** 6.5
   - **CVE-2018-2392**
     - **CVSS Score:** 5.3
   - **Description:** Failures in XML input validation leading to IGS unavailability.

4. **Cross-Site Scripting (XSS)**
   - **CVE-2018-2388**
     - **CVSS Score:** 6.1
   - **CVE-2018-2383**
     - **CVSS Score:** 6.1
   - **Description:** Stored and reflected XSS vulnerabilities allowing script injection.

5. **Log Injection**
   - **CVE-2018-2389**
     - **CVSS Score:** 5.3
   - **Description:** Enables injection of misleading log entries.

6. **Information Disclosure**
   - **CVE-2018-2382**
     - **CVSS Score:** 5.3
   - **CVE-2018-2387**
     - **CVSS Score:** 4.3
   - **Description:** Allows unauthorized access to system information and port details.

**Solution:**

To mitigate these vulnerabilities, apply the latest patches provided by SAP for your IGS version. Ensure you follow the **manual activities** outlined in the security note to enhance security configurations.

**Download Patches:**
- **SAP IGS 7.45 SP004 Patch 000004:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200005314&V=MAINT)
- **SAP IGS 7.53 SP002 Patch 000002:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200007401&V=MAINT)
- **SAP IGS 7.49 SP002 Patch 000002:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200006992&V=MAINT)
- **SAP IGS 7.20 SP015 Patch 000015:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200014908&V=MAINT)
- **SAP IGS 7.20_EXT SP015 Patch 000015:** [Download](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200018925&V=MAINT)
- **SAP IGS HELPER SP015 Patch 000015:** [Download](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200018926&support_package=SP015&patch_level=000015)

**Manual Activities:**
- **Restrict Image Uploads:** Modify the `imgconv.tpl` configuration file to set `ALLOW_PUT_URL=0` to prevent unrestricted image uploads. Detailed instructions are provided in the security note under the **Correction Instructions** section.
  
  Example configuration:
  ```ini
  [GENERAL]
  ALLOW_PUT_URL=0
  ```

  After editing, remove the `.tpl` extension and restart the SAP IGS.

**Additional Information:**
- **Release Date:** 13.02.2018
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Externally Reported:** Yes
- **Category:** Program error

**References:**
- [SAP Note 2657203](https://me.sap.com/notes/2657203) - ALV export: Export as spreadsheet in OpenOffice format terminates with error message

**Download the Full SAP Security Note:** [2525222](https://me.sap.com/notes/0002525222)

**Credits:** Thanks to [Redrays.io](https://redrays.io) for supporting the provision of this information.