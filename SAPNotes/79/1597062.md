SAP Security Note 1597062: Potential Directory Traversal in FI module for Spain

---

**SAP Security Note 1597062: FI: Potential Directory Traversal-Spain**

- **Type:** SAP Security Note
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 08.11.2011
- **Component:** Financial Accounting > General Ledger Accounting > Basic Functions > Deferred Tax (Country Specific) (FI-GL-GL-F1)

### Description

#### Symptom
Potential Directory Traversal for RFIDESM340.

#### Other Terms
- Path traversal, FI_M340_FILE_PATH

#### Reason and Prerequisites
- The programs contained in the correction instructions contain vulnerabilities through which a malicious user can potentially read arbitrary files on the remote server, possibly disclosing confidential information.
- Some of the programs contained in the correction instructions contain a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

#### Solution
Please refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions.

The corrections from Note 1497003 are a prerequisite for implementation of this note.

**Logical File Name Used in this Solution**

The following logical file names have been created to enable the validation of physical file names: `FI_RFIDESM340_FILE`

- **Program Using this Logical Filename:** RFIDESM340

**Logical File Path Used in this Solution**

`FI_M340_FILE_PATH`

The application RFIDESM340 is passing an additional parameter `parameter_1 (sy-cprog)` to the Function Module `FILE_VALIDATE_NAME`. This allows customers to insert the parameter while configuring the physical paths for the Logical File Name `FI_RFIDESM340_FILE`.

### Attachments
- [VAT_Report_Modelo_340.pdf](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000245162011&iv_version=0001&iv_guid=39789958E56EC048B0657E4833D40DE0) (272 KB)

### References
This document refers to [Note 1497003](https://me.sap.com/notes/1497003) - Potential directory traversals in applications

### Support Packages
- [SAPKH46B62](https://me.sap.com/supportpackage/SAPKH46B62) for SAP_APPL 46B
- [SAPKH46C63](https://me.sap.com/supportpackage/SAPKH46C63) for SAP_APPL 46C
- [SAPKH47037](https://me.sap.com/supportpackage/SAPKH47037) for SAP_APPL 470
- [SAPKH50026](https://me.sap.com/supportpackage/SAPKH50026) for SAP_APPL 500
- [SAPKH60021](https://me.sap.com/supportpackage/SAPKH60021) for SAP_APPL 600
- [SAPKH60211](https://me.sap.com/supportpackage/SAPKH60211) for SAP_APPL 602
- [SAPKH60310](https://me.sap.com/supportpackage/SAPKH60310) for SAP_APPL 603
- [SAPKH60411](https://me.sap.com/supportpackage/SAPKH60411) for SAP_APPL 604
- [SAPKH60506](https://me.sap.com/supportpackage/SAPKH60506) for SAP_APPL 605

### Credits
Information supported by [redrays.io](https://redrays.io).