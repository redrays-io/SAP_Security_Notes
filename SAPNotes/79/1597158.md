SAP Security Note 1597158: FI - Potential Directory Traversal in Venezuela

---

**SAP Note Number:** 1597158  
**Type:** SAP Security Note  
**Version:** 1  
**Recency:** New  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Released On:** 08.11.2011  
**Component:** Financial Accounting > General Ledger Accounting > Basic Functions > Deferred Tax (Country Specific)

### Description

**Symptom:**  
Potential Directory Traversal for RFVEPBOOK.

**Other Terms:**  
1. Path traversal, FI_RFVEPBOOK_FILE_PATH

**Reason and Prerequisites:**  
- The programs contained in the correction instructions contain vulnerabilities that allow a malicious user to potentially read arbitrary files on the remote server, possibly disclosing confidential information.
- Some programs may allow a malicious user to write arbitrary files on the remote server, potentially corrupting data or altering system behavior.

### Solution

Please refer to [Note 1497003](https://me.sap.com/notes/1497003) for additional information and instructions.  
The corrections from Note 1497003 are a prerequisite for the implementation of this note.

**Logical File Name Used in this Solution:**  
FI_RFVEPBOOK_FILE  
**Program Using this Logical Filename:**  
RFVEPBOOK

**Logical File Path Used in this Solution:**  
FI_RFVEPBOOK_FILE_PATH.  
The application RFVEPBOOK passes an additional parameter `parameter_1 (sy-cprog)` to the Function Module `FILE_VALIDATE_NAME`. This allows customers to configure physical paths for the Logical File Name **FI_RFVEPBOOK_FILE**.

### Attachments

- [Purchase_Ledger_Venezuela.pdf](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000245922011&iv_version=0001&iv_guid=7DB3023EC5BAE44B8331FF5DF0CFEB76) (411 KB)

### References

**This document refers to:**  
- [1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003)

**This document is referenced by:**  
- [2469424: Venezuela Reporting Troubleshooting Guide](https://me.sap.com/notes/2469424)

### Validity

**Software Components:**  
- SAP_APPL 46C  
- SAP_APPL 470  
- SAP_APPL 500  
- SAP_APPL 600  
- SAP_APPL 602  
- SAP_APPL 603  
- SAP_APPL 604  
- SAP_APPL 605

### Support Packages

- [SAPKH46C63](https://me.sap.com/supportpackage/SAPKH46C63) for SAP_APPL 46C
- [SAPKH47037](https://me.sap.com/supportpackage/SAPKH47037) for SAP_APPL 470
- [SAPKH50026](https://me.sap.com/supportpackage/SAPKH50026) for SAP_APPL 500
- [SAPKH60021](https://me.sap.com/supportpackage/SAPKH60021) for SAP_APPL 600
- [SAPKH60211](https://me.sap.com/supportpackage/SAPKH60211) for SAP_APPL 602
- [SAPKH60310](https://me.sap.com/supportpackage/SAPKH60310) for SAP_APPL 603
- [SAPKH60411](https://me.sap.com/supportpackage/SAPKH60411) for SAP_APPL 604
- [SAPKH60507](https://me.sap.com/supportpackage/SAPKH60507) for SAP_APPL 605

### Correction Instructions

- [Correction Instructions 1](https://me.sap.com/corrins/0001597158/1)

### Preconditions

- [1134024: Magnetic o/p incoming invoices Venezuela New Legal Requirements](https://me.sap.com/notes/1134024) for various SAP_APPL components.
- [1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003) for SAP_BASIS components 46C, 620, 640, 700, 701, 702 to 710.

---

*Credits to [redrays.io](https://redrays.io) for support to provided information.*