SAP Security Note 1597146 - FI: Potential Directory Traversal - Italy (RFIDITBLIST)

**Summary**

This SAP Security Note addresses a potential directory traversal vulnerability in the RFIDITBLIST application for the Italy region. The vulnerability allows malicious users to read or write arbitrary files on the remote server, potentially leading to the disclosure of confidential information or corruption of data.

**Details**

- **SAP Note Number:** 1597146
- **Type:** SAP Security Note
- **Version:** 1
- **Released On:** 08.11.2011
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Component:** Financial Accounting > General Ledger Accounting > Basic Functions > Deferred Tax (Country Specific) [FI-GL-GL-F1]

**Symptom**

A potential directory traversal vulnerability exists in the RFIDITBLIST program, allowing attackers to access arbitrary files on the server.

**Reason and Prerequisites**

The programs in the correction instructions contain vulnerabilities that could allow malicious users to:
- **Read** arbitrary files, potentially disclosing confidential information.
- **Write** arbitrary files, possibly corrupting data or altering system behavior.

**Solution**

1. **Refer to SAP Note 1497003** for additional information and instructions. Implementing corrections from Note 1497003 is a prerequisite for applying this note.
2. **Logical File Names and Paths:**
   - **Logical File Name:** FI_RFIDITBLIST_FILE
   - **Program Using Logical Filename:** RFIDITBLIST
   - **Logical File Path:** FI_IBLIST_FILE_PATH
3. The RFIDITBLIST application now passes an additional parameter (`parameter_1` as `sy-cprog`) to the `FILE_VALIDATE_NAME` function module. This allows customers to configure physical paths for the logical file name FI_RFIDITBLIST_FILE.

**Download Links**

- [Download for SNOTE](https://me.sap.com/notes/0001597146/SNOTE)
- [PDF Version](https://me.sap.com/notes/0001597146/PDF)

**References**

- [SAP Note 1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)
- [SAP Note 1478905 - Model for Countries with privileged tax system (Black list)](https://me.sap.com/notes/1478905)

**Attachments**

- [RFIDITBLIST.pdf](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000245632011&iv_version=0001&iv_guid=2F05A5E1158F7748881C6E992C815503) (19 KB)

**Software Component Versions**

Applicable to the following versions of SAP_APPL:
- 46B, 46C, 470, 500, 600, 602, 603, 604, 605

**Support Packages**

Ensure the relevant support packages are applied as listed in the note.

**Preconditions**

Multiple SAP Notes must be implemented prior to applying this security note, including but not limited to:
- [SAP Note 1523915 - RFIDITBLIST: Italy Black List Declaration for release 4.6B](https://me.sap.com/notes/1523915)
- [SAP Note 1517201 - RFIDITBLIST: Italy Black List Declaration Legal Change 2010](https://me.sap.com/notes/1517201)
- *(Refer to the full list within the note for all prerequisites)*

**CVSS**

- **Score:** 0
- **Vector:** Not available

**Rating**

- **Helpfulness:** 0 people found this helpful.
- **Quality Rating:** 0.0/5 based on 0 votes.

**Side Effects**

This document does not list any side effects caused or solved by this note.

---

*Credits to [Redrays.io](https://redrays.io) for supporting the provision of this information.*