SAP Security Note 1597066 - MDX: SOAP/XMLA Interface and Document Type Definitions

---

**Description**

**Symptom**

An attacker can attempt to generate a "denial of service" situation or start an "SMB relay attack" using Document Type Definitions (DTD) via the SOAP/XMLA interface.

**CVSS Information**

- **CVSS Base Score:** 4.0
- **CVSS Base Vector:** AV:N/AC:L/AU:S/C:N/I:N/A:P

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this SAP Note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://service.sap.com/securitynotes/) at SAP.*

**Other Terms**

XMLA interface, MDX, Business Warehouse, BW

**Reason and Prerequisites**

There is a program error. Document Type Definitions must not occur in SOAP requests.

**Solution**

This correction prevents the use of Document Type Definitions when you use the SOAP/XMLA interface.

- **BW 3.0B and BW 3.10 Content**
  - Implement the attached correction instructions. For SAP BW Releases 3.0B and 3.10, no additional Support Packages will be delivered until further notice.

- **BW 3.50**
  - Import [Support Package 30 for 3.5 (SAPKW35030)](https://me.sap.com/supportpackage/SAPKW35030) into your BW system. The Support Package is available when [SAP Note 1513396](https://me.sap.com/notes/1513396) "SAPBWNews BW SP30 NW'04 Stack 30" is released for customers.

- **SAP NetWeaver BW 7.00**
  - Import [Support Package 29 for SAP NetWeaver BW 7.00 (SAPKW70029)](https://me.sap.com/supportpackage/SAPKW70029) into your BW system. The Support Package is available when [SAP Note 1658505](https://me.sap.com/notes/1658505) "SAPBWNews NW 7.00 BW ABAP SP29" is released for customers.

- **SAP NetWeaver BW 7.01 (SAP NW BW 7.0 Enhancement Package 1)**
  - Import [Support Package 12 for SAP NetWeaver BW 7.01 (SAPKW70112)](https://me.sap.com/supportpackage/SAPKW70112) into your BW system. The Support Package is available when [SAP Note 1665768](https://me.sap.com/notes/1665768) "SAPBWNews NW 7.01 BW ABAP SP12" is released for customers.

- **SAP NetWeaver BW 7.02 (SAP NW BW 7.0 Enhancement Package 2)**
  - Import [Support Package 11 for SAP NetWeaver BW 7.02 (SAPKW70211)](https://me.sap.com/supportpackage/SAPKW70211) into your BW system. The Support Package is available when [SAP Note 1641364](https://me.sap.com/notes/1641364) "SAPBWNews NW 7.02 BW ABAP SP11" is released for customers.

- **SAP NetWeaver BW 7.11**
  - Import [Support Package 10 for SAP NetWeaver BW 7.11 (SAPKW71110)](https://me.sap.com/supportpackage/SAPKW71110) into your BW system. The Support Package is available when [SAP Note 1665770](https://me.sap.com/notes/1665770) "SAPBWNews NW BW 7.11 ABAP SP10" is released for customers.

- **SAP NetWeaver BW 7.30**
  - Import [Support Package 07 for SAP NetWeaver BW 7.30 (SAPKW73007)](https://me.sap.com/supportpackage/SAPKW73007) into your BW system. The Support Package is available when [SAP Note 1652579](https://me.sap.com/notes/1652579) "SAPBWNews NW 7.30 BW ABAP SP07" is released for customers.

- **SAP NetWeaver BW 7.31 (SAP NW BW 7.0 Enhancement Package 3)**
  - Import [Support Package 3 for SAP NetWeaver BW 7.31 (SAPKW73103)](https://me.sap.com/supportpackage/SAPKW73103) into your BW system. The Support Package is available when [SAP Note 1652580](https://me.sap.com/notes/1652580) "SAPBWNews NW BW 7.31/7.03 ABAP SP3" is released for customers.

In urgent cases, you can implement the correction instructions as an advance correction.

**Caution:** You must perform this manual pre-implementation step manually and separately in each system **before** you import the Note to implement. For BW Releases BW 3.0B, BW 3.1 Content, and BW 3.50, you must apply the patch level specified in [SAP Note 1594475](https://me.sap.com/notes/1594475). Only then can you prevent the use of Document Type Definitions.

**Affected Components**

- **SAP Business Warehouse > Business Explorer > OLAP Technology > MDX, OLAP-BAPI, OLE DB for OLAP**

**References**

- [SAP Note 1889488 - Briefing at Black Hat conference on July 31st, 2013](https://me.sap.com/notes/1889488)
- [SAP Note 1881391 - MDX: XML for Analysis - known security holes](https://me.sap.com/notes/1881391)
- [SAP Note 1665770 - SAPBWNews NW BW 7.11 ABAP SP10](https://me.sap.com/notes/1665770)
- [SAP Note 1665768 - SAPBWNews BW 7.01 ABAP SP12](https://me.sap.com/notes/1665768)
- [SAP Note 1658505 - SAPBWNews BW 7.00 ABAP SP29](https://me.sap.com/notes/1658505)
- [SAP Note 1652580 - SAPBWNews NW BW 7.31 ABAP SP03](https://me.sap.com/notes/1652580)
- [SAP Note 1652579 - SAPBWNews NW 7.30 BW ABAP SP07](https://me.sap.com/notes/1652579)
- [SAP Note 1641364 - SAPBWNews NW 7.02 BW ABAP SP11](https://me.sap.com/notes/1641364)

**Support Packages**

- [SAP_BW 30B](https://me.sap.com/supportpackage/SAPKW30B34)
- [SAP_BW 310](https://me.sap.com/supportpackage/SAPKW31028)
- [SAP_BW 350](https://me.sap.com/supportpackage/SAPKW35030)
- [SAP_BW 700](https://me.sap.com/supportpackage/SAPKW70029)
- [SAP_BW 701](https://me.sap.com/supportpackage/SAPKW70112)
- [SAP_BW 702](https://me.sap.com/supportpackage/SAPKW70212)
- [SAP_BW 711](https://me.sap.com/supportpackage/SAPKW71110)
- [SAP_BW 730](https://me.sap.com/supportpackage/SAPKW73008)
- [SAP_BW 731](https://me.sap.com/supportpackage/SAPKW73103)

**Correction Instructions**

- [Correction for SAP_BW_VIRTUAL_COMP](https://me.sap.com/corrins/0001597066/654)
- [Corrections for SAP_BW](https://me.sap.com/corrins/0001597066/30)

**Manual Activities**

You must perform the manual pre-implementation step as specified in the correction instructions before importing the Note.

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*