Security Patch for Unauthorized Content Modification in SAP CRM-ISA (Note 1601155)

**SAP Note:** [1601155](https://me.sap.com/notes/0001601155)  
**Title:** Unauthorized modification of displayed content in CRM-ISA  
**Type:** SAP Security Note  
**Version:** 1  
**Released On:** 11.10.2011  
**Component:** Customer Relationship Management > Internet Sales > Shop Management

### **Symptom**
The Web Channel E-Commerce Shop Management (ShopAdmin) application is vulnerable to abuse by authenticated malicious users. This vulnerability allows unauthorized modification of displayed application content and may enable the theft of authentication information from other legitimate users through reflected cross-site scripting (XSS).

### **Reason and Prerequisites**
The vulnerability arises because the ShopAdmin component does not sufficiently encode OUTPUT parameters. This insufficient encoding leads to a reflected XSS issue, which can be exploited to:
- Non-permanently deface or modify website content.
- Steal users' authentication data, such as session information.
- Impersonate users, potentially compromising application security entirely if an administrator is targeted.

### **Solution**
This security note provides Java corrections for the E-Commerce and Web Channel components to address the XSS vulnerability.

**Steps to Resolve:**
1. **Apply the Support Package Patch:**
   - Download the patch from the [Download for SNOTE](https://me.sap.com/notes/0040000017261552017).
   - Follow the instructions in SAP Note [877887](https://me.sap.com/notes/00877887) for applying Java patches.
   - Refer to SAP Note [1546959](https://me.sap.com/notes/01546959) for detailed patch strategies.

2. **Affected Software Components:**
   - Ensure the following components are updated to the specified support package levels:
     - SAP-SHRWEB
     - SAP-CRMWEB
     - SAP-CRMJAV
     - SAP-CRMAPP
     - SAP-SHRAPP

**Support Package Patches:**
Several support package patches are available for different versions of the software components. For example:
- **CRM JAVA COMPONENTS 7.01:** [SP004 Patch 000003](https://me.sap.com/notes/01200615320200014673)
- **CRM JAVA COMPONENTS 7.0:** [SP009 Patch 000010](https://me.sap.com/notes/01200615320200010451)
- **SAP SHARED WEB COMPONENTS 6.0:** [SP008 Patch 000012](https://me.sap.com/notes/01200314690200005024)

Please refer to the full list of patches in the original SAP Note for your specific component versions.

### **References**
- [Unauthorized modification of displayed content in ISA-AUC (1603081)](https://me.sap.com/notes/0001603081)
- [Unauthorized modification of displayed content in ISA B2B (1583300)](https://me.sap.com/notes/0001583300)
- [Patch strategies for SAP E-Commerce solutions (1546959)](https://me.sap.com/notes/0001546959)
- [Unauthorized modification of displayed content (1509342)](https://me.sap.com/notes/0001509342)
- [Installing Patches for CRM Java Components and FSCM BD (877887)](https://me.sap.com/notes/000877887)

### **CVSS**
- **Score:** 0
- **Vector:** Not Available

### **Side Effects**
This security update addresses the specified vulnerability without introducing known side effects. However, it's recommended to test the patch in a controlled environment before deploying it to production systems.

---

*Credits to [RedRays.io](https://redrays.io) for support in providing this information.*