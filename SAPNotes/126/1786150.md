1786150 - Potential disclosure of persisted data in [crm-md-bp]

**Description**

**Symptom**
An attacker can exploit `crm-md-bp` and use specially crafted inputs to modify database commands, resulting in the retrieval of additional information persisted by the system.

**Other Terms**
SQL injection, database, crm-md-bp

**Reason and Prerequisites**
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by an attacker. The manipulated SQL statement can then be used to retrieve data from the database.

**Solution**
Implement the attached correction provided in SAP Note [1786150](https://me.sap.com/notes/0001786150).

**Actions**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010554182017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001786150?language=en-US&token=C27956829976513E378346D7A9A0057E)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001786150/E/diff)

**Software Components Affected**

- **BBPCRM** versions 600, 700, 701, 702, 712

**Support Packages Available**

- [SAPKU60013](https://me.sap.com/supportpackage/SAPKU60013) for BBPCRM 600
- [SAPKU70013](https://me.sap.com/supportpackage/SAPKU70013) for BBPCRM 700
- [SAPKU70110](https://me.sap.com/supportpackage/SAPKU70110) for BBPCRM 701
- [SAPKU70206](https://me.sap.com/supportpackage/SAPKU70206) for BBPCRM 702
- [SAPKU71201](https://me.sap.com/supportpackage/SAPKU71201) for BBPCRM 712

**Preconditions**
Ensure that all prerequisite SAP Notes are implemented before applying this correction. A full list of prerequisites can be found in the **Prerequisites** section of the SAP Note.

**CVSS**
No CVSS score is provided for this security note.

**References**

- [SAP Note 1135818](https://me.sap.com/notes/1135818) - Performance: Search accounts or contact person by address
- [SAP Note 1170510](https://me.sap.com/notes/1170510) - Account search: performance improvement for some searches
- [SAP Note 1591908](https://me.sap.com/notes/1591908) - City2 field is missing in the Account Search structure
- [SAP Note 1619052](https://me.sap.com/notes/1619052) - CITY2 in structure CRMT_BUPA_IL_SEARCH_ADDR occurs twice
- [SAP Note 1628358](https://me.sap.com/notes/1628358) - Account search is slow after clearing the cache in IE
- [SAP Note 1722194](https://me.sap.com/notes/1722194) - Search by CITY2 (District) does not work

For more details, visit the [SAP Security Notes](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*