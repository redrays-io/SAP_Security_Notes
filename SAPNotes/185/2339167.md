SAP Security Note 2339167: Whitelist-based Clickjacking Framing Protection in FSCM Biller Direct

---

**Title:** 2339167 - Whitelist-based Clickjacking Framing Protection in FSCM Biller Direct

**Type:** SAP Security Note  
**Version:** 2  
**Released On:** July 12, 2016  
**Component:** Financials > Financial Supply Chain Management > Biller Direct  
**Priority:** Correction with medium priority  
**Status:** Released for Customer

### Symptom
FSCM Biller Direct running on JSP technology is not protected against Clickjacking attacks.

### Other Terms
UI redressing attack, Clickjacking, Framing Protection, IFrame, X-FRAME-OPTIONS, AS JAVA, JSP, Biller Direct

### Reason and Prerequisites
Clickjacking is an UI-redressing attack where an attacker tricks a user into clicking on something different from what the user perceives. It leverages standard HTML capabilities without exploiting application code weaknesses.

More details can be found at [OWASP Clickjacking](https://www.owasp.org/index.php/Clickjacking).

**Prerequisites:**
1. [SAP Note 2170590](https://me.sap.com/notes/2170590) - Enable and configure ClickJacking solution in SAP NetWeaver Java Server
2. [SAP Note 2263656](https://me.sap.com/notes/2263656) - Enable the ClickJacking protection in HTMLB Java

### Solution
Standard protection measures against Clickjacking (X-FRAME-OPTIONS header) are not suitable for common NetWeaver integration scenarios.

SAP provides a whitelist-based framework for NetWeaver technologies, detailed in [SAP Note 2319727](https://me.sap.com/notes/2319727).

This SAP Note provides the solution for FSCM Biller Direct.

**For custom applications based on JSP running on SAP NW JAVA:**

Refer to the attached document: [How_to_Adopt_SAP_Clickjacking_Protection_for_Java_Server_Pages_(JSPs).pdf](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000853062016&iv_version=0002&iv_guid=6CAE8B3EAD2B1ED69184559CC93E60C0) (860 KB)

**Activating Clickjacking Protection:**
1. Open XCM using the URL `https://your_server:your_server_port/bd/admin/xcm/init.do`
2. Navigate to **General Application Settings > Customer > Application Security > application_security_config**
3. Configure the following Clickjacking settings:
    - `clickjacking.active`: Main switch to activate/deactivate clickjacking protection.
    - `clickjacking.whiteList`: Comma-separated list of trusted hostnames. Use `$AUTO` to include the host where the application runs. An empty value will prompt configuration in the Clickjacking Whitelist Configuration of SAP NetWeaver Administrator.
4. Save the configuration.
5. Use the XCM Clickjacking protection test to verify prerequisites. Protection is available only if the test is successful.

### Attachments
- [How_to_Adopt_SAP_Clickjacking_Protection_for_Java_Server_Pages_(JSPs).pdf](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000853062016&iv_version=0002&iv_guid=6CAE8B3EAD2B1ED69184559CC93E60C0) (860 KB)

**References:**
- [SAP Note 2327541](https://me.sap.com/notes/2327541) - Configuring Clickjacking protection in Web Channel / E-Commerce applications
- [SAP Note 2263656](https://me.sap.com/notes/2263656) - Whitelist based Clickjacking Framing Protection in HTMLB Java
- [SAP Note 2170590](https://me.sap.com/notes/2170590) - Whitelist service for Clickjacking Framing Protection in AS JAVA

### Validity
Applicable to FSCM Biller Direct versions 600, 602, 604, 605, 635.

### Support Package Patches
- FSCM-BILLER DIRECT 6.35 SP003 Patch 000001
- FSCM-BILLER DIRECT 6.04 SP011 Patch 000001
- FSCM-BILLER DIRECT 6.05 SP010 Patch 000001
- FSCM-BILLER DIRECT 6.02 SP013 Patch 000001
- FSCM-BILLER DIRECT 6.0 SP023 Patch 000001

For more details, visit [SAP Support Notes](https://me.sap.com/sap/support/swdc/notes).

---

*Credits to [Redrays](https://redrays.io) for support in providing this information.*