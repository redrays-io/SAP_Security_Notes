2335427 - Cross-Site Request Forgery (CSRF) vulnerability in SAP BOBJ BI Platform

**Symptom**

The presence of the `crossdomain.xml` file allows Flash files (`.swf`) running in Adobe Flash Player from other domains to access resources on your application server. An overly permissive `crossdomain.xml` file enables an attacker to trick an authenticated user into sending unintended requests to the web server. This vulnerability is due to insufficient CSRF protection.

**Impact of CSRF Vulnerability:**
- Attackers can perform actions on behalf of authenticated users.
- Loss of non-repudiation.

**CVSS Information**

- **CVSS v3 Base Score:** 6.1 / 10
- **CVSS v3 Vector:**
  - **Attack Vector:** Network (N)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** None (N)
  - **User Interaction:** Required (R)
  - **Scope:** Changed (C)
  - **Confidentiality Impact:** Low (L)
  - **Integrity Impact:** Low (L)
  - **Availability Impact:** None (N)

**Reason and Prerequisites**

The `crossdomain.xml` file shipped with SAP BOBJ BI Platform is overly permissive, allowing attackers to obtain access to sensitive information that should be restricted.

**Solution**

1. **Apply Support Packages and Patches:**
   - Implement the Support Packages and Patches referenced by this SAP Note. This will install the `crossdomain.sap.template.xml` file to Tomcat's ROOT web application folder (default path: `C:\Program Files (x86)\SAP BusinessObjects\tomcat\webapps\ROOT` on Windows).
   
2. **Review and Secure `crossdomain.xml`:**
   - Check if `crossdomain.xml` exists in your application server's ROOT web application folder.
   - If it exists, open it using a text editor and adjust the permissions if it is overly permissive. Refer to the `crossdomain.sap.template.xml` file or the [Adobe Flash Player Security White Paper](https://me.sap.com/notes/0002335427/F) for guidance.
   
3. **Remove Unnecessary `crossdomain.xml`:**
   - If you do not require Flash files from other domains to access resources on your application server, you can remove the `crossdomain.xml` file entirely.

**Additional Resources**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018355352017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002335427?language=en-US&token=FBBA7DD05BADC630B355EC6344EAE62C)
- [Share by Email](https://me.sap.com/notes/0002335427/S)
- [Open in New Window](https://me.sap.com/notes/0002335427/O)

**Attachments**
- No attachments available.

**References**
- This document does not reference other SAP Notes or KBAs.

**Software Components Affected**
- **ENTERPRISE:** Versions 410 to 420
- **SBOP BI PLATFORM SERVERS 4.1 and 4.2:** Various Support Package patches available [here](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200001041&V=MAINT)

For more information, visit the [SAP Security Notes](https://me.sap.com/).

*Credits to [Redrays.io](https://redrays.io/) for support in providing this information.*