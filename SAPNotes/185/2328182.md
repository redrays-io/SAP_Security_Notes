Security Note 2328182 - Directory Traversal Vulnerability in MDG Data Export

---

## Overview

SAP has released **Security Note [2328182](https://me.sap.com/notes/2328182)** addressing a **Directory Traversal** vulnerability in **MDG Data Export**. This vulnerability allows attackers to access and manipulate arbitrary files on the server, potentially leading to the exposure of sensitive data or corruption of critical files.

## Symptom

The **MDG Data Export** feature insufficiently validates path information provided by users. Specifically, characters that represent directory traversal (e.g., `../`) are passed through to the file APIs, enabling attackers to navigate to parent directories on the server.

**Potential Impacts:**
- **Data Exposure:** Attackers can read the contents of arbitrary files on the remote server, exposing sensitive information.
- **Data Integrity:** Attackers can overwrite, delete, or corrupt arbitrary files on the remote server.

## Solution

To mitigate this vulnerability, the application now performs proper validation of user-submitted paths and disallows arbitrary file reads by introducing the **Logical File Name** `MDG_EXPORT_IMPORT`. This logical file name should specify the directory path designated for data exports.

### Steps to Implement the Solution:

1. **Apply Support Packages and Patches:**
   - Implement the Support Packages and Patches referenced in this SAP Note.
   - For detailed instructions, refer to [SAP Note 1497003](https://me.sap.com/notes/1497003).

2. **Configure Logical File Paths:**
   - Navigate to the transaction **FILE**.
   - Create new table entries for logical file paths and file names:
     ```plaintext
     Logical file path: MDG_EXPORT_IMPORT
     Description: MDG Export/Import logical file
     ```
   - Save your changes.

3. **Define Logical File Name:**
   - In the dialog structure, double-click on **"Logical File Name Definition, Cross-Client"**.
   - Create a new entry with the following details:
     ```plaintext
     Logical file: MDG_EXPORT_IMPORT
     Description: MDG Export/Import logical file
     Physical file: "<please maintain your customer-specific path here>"
     Data format: DIR
     Application Area: CA
     Logical path: MDG_EXPORT_IMPORT
     ```
   - Save your changes.

## Affected Software Components

| Software Component | From | To |
|--------------------|------|----|
| S4CORE             | 100  | 100|
| SAP_BS_FND         | 731  | 731|
| SAP_BS_FND         | 746  | 746|
| SAP_BS_FND         | 747  | 747|
| SAP_BS_FND         | 748  | 748|

## References

- [SAP Note 1497003: Potential directory traversals in applications](https://me.sap.com/notes/1497003)
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000020067642017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002328182?language=en-US&token=ADC77435730D1849597889C5EA1DA9AC)

## CVSS Score

The CVSS score for this vulnerability is **0**, indicating that it may not have been fully assessed or the information is not available.

## Credits

Credits to [Redrays.io](https://redrays.io) for support in providing this information.