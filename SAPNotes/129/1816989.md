SAP Security Note 1816989 - Potential information disclosure relating to EPCM data bag

---

**SAP Note/KBA**: 1816989  
**Type**: SAP Security Note  
**Version**: 3  
**Recency**: New  
**Language**: English  
**Category**: Program error  
**Priority**: Correction with medium priority  
**Status**: Released for Customer  
**Released On**: 11.06.2013  
**Component**: Enterprise Portal > SAP Enterprise Portal (On Premise) > Client Services

### Description

An attacker can discover information relating to "SAPPORTALSDB0" that is used in the portal EPCM client data bag. This information could be used to allow the attacker to specialize their attacks against the component that has used this client data bag cookie.

**CVSS Information**

- **Base Score**: 5.0  
- **Base Vector**: AV:N/AC:L/AU:N/C:P/I:N/A:N  

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [https://service.sap.com/securitynotes/](https://service.sap.com/securitynotes/).*

### Reason and Prerequisites

Information that is stored by any application that is using this EPCM client data bag can be passed on a non-secure connection. This information may be used by an attacker to further target the application that is using this framework in the portal.

### Solution

Please refer to the SP Patch level link to view the versions including the fix.

**To enforce secure data bag (SAPPORTALSDB0) cookie:**

1. Navigate to **System Administration** â†’ **Service Configuration**  
   *For NW: use SAP NetWeaver Administrator.*
2. Access the following portal application and service:  
   **Application**: `com.sap.portal.epcf.loader`  
   **Service**: `epcfloader`
3. Set the `com.sap.portal.epcf.databag.enforce_secure_cookie` property value to `true`.  
   This ensures that the client browser sends the cookie only when an SSL connection to the J2EE Engine or the reverse proxy is established. The default value is `false`.
4. Save your changes and restart the service.

### References

**This document refers to:**

- [SAP Note 1834475 - Central Note for NetWeaver 7.40 SP02 EP / EPC](https://me.sap.com/notes/1834475)
- [SAP Note 1783714 - Central Note for Portal Platform in SAP NW7.0 EhP2 SP14](https://me.sap.com/notes/1783714)
- [SAP Note 1781406 - Central Note for Portal Platform in SAP NW7.1 EhP1 SP12](https://me.sap.com/notes/1781406)
- [SAP Note 1779149 - Central Note for Portal Platform in SAP NW7.0 EhP1 SP14](https://me.sap.com/notes/1779149)
- [SAP Note 1776248 - SAP NetWeaver CE Portal Platform NW7.10 SP17](https://me.sap.com/notes/1776248)
- [SAP Note 1767711 - Central Note for Portal Platform in SAP NW7.0 SP29](https://me.sap.com/notes/1767711)
- [SAP Note 1743951 - Central Note for Portal Platform in SAP NW7.2 SP9](https://me.sap.com/notes/1743951)

**This document is referenced by:**

- [SAP Note 1776248 - SAP NetWeaver CE Portal Platform NW7.10 SP17](https://me.sap.com/notes/1776248)
- [SAP Note 1767711 - Central Note for Portal Platform in SAP NW7.0 SP29](https://me.sap.com/notes/1767711)
- [SAP Note 1779149 - Central Note for Portal Platform in SAP NW7.0 EhP1 SP14](https://me.sap.com/notes/1779149)
- [SAP Note 1781406 - Central Note for Portal Platform in SAP NW7.1 EhP1 SP12](https://me.sap.com/notes/1781406)
- [SAP Note 1743951 - Central Note for Portal Platform in SAP NW7.2 SP9](https://me.sap.com/notes/1743951)
- [SAP Note 1834475 - Central Note for NetWeaver 7.40 SP02 EP / EPC](https://me.sap.com/notes/1834475)
- [SAP Note 1783714 - Central Note for Portal Platform in SAP NW7.0 EhP2 SP14](https://me.sap.com/notes/1783714)

### Support Package Patches

- [EP RUNTIME 7.40 SP003 Patch Level 000000](https://me.sap.com/swdc/notes?cvnr=67838200100200019788&support_package=SP003&patch_level=000000)
- [EP RUNTIME 7.20 SP009 Patch Level 000002](https://me.sap.com/swdc/notes?cvnr=01200615320200012953&support_package=SP009&patch_level=000002)
- [EP RUNTIME 7.31 SP008 Patch Level 000000](https://me.sap.com/swdc/notes?cvnr=01200314690200014358&support_package=SP008&patch_level=000000)
- [EP RUNTIME 7.11 SP012 Patch Level 000000](https://me.sap.com/swdc/notes?cvnr=01200314690200006929&support_package=SP012&patch_level=000000)
- [EP RUNTIME 7.30 SP010 Patch Level 000000](https://me.sap.com/swdc/notes?cvnr=01200615320200015108&support_package=SP010&patch_level=000000)
- [PORTAL 7.01 SP014 Patch Level 000000](https://me.sap.com/swdc/notes?cvnr=01200615320200010804&support_package=SP014&patch_level=000000)
- [PORTAL 7.02 SP014 Patch Level 000000](https://me.sap.com/swdc/notes?cvnr=01200615320200012489&support_package=SP014&patch_level=000000)
- [EP RUNTIME 7.10 SP017 Patch Level 000000](https://me.sap.com/swdc/notes?cvnr=01200314690200006348&support_package=SP017&patch_level=000000)
- [PORTAL 7.00 SP029 Patch Level 000000](https://me.sap.com/swdc/notes?cvnr=01200615320200007801&support_package=SP029&patch_level=000000)

---

Credits to [redrays.io](https://redrays.io) for support in providing this information.