SAP Security Note 1813155 - Possible change/disclosure of persisted data in EH&S

---

## Description

**Symptom:**
An attacker can exploit the Environment, Health, and Safety (EH&S) module by using specially crafted inputs to modify database commands. This can result in the unauthorized modification or disclosure of data persisted by the system.

**Reason and Prerequisites:**
The issue arises from an SQL injection vulnerability. The affected code constructs SQL statements by incorporating strings that can be manipulated by an attacker. This manipulation allows the attacker to execute arbitrary SQL commands, potentially leading to unauthorized data access or modification.

## Impact
Exploiting this vulnerability could allow attackers to:
- Modify existing data in the database.
- Retrieve sensitive information from the database.
- Potentially escalate privileges within the system.

## Solution

### Apply Relevant Support Packages
Ensure that the following Support Packages are applied to address this vulnerability:

- **EA-APPL 110:** [SAPKGPAA36](https://me.sap.com/supportpackage/SAPKGPAA36)
- **EA-APPL 200:** [SAPKGPAB25](https://me.sap.com/supportpackage/SAPKGPAB25)
- **EA-APPL 500:** [SAPKGPAC29](https://me.sap.com/supportpackage/SAPKGPAC29)
- **EA-APPL 600:** [SAPKGPAD24](https://me.sap.com/supportpackage/SAPKGPAD24)
- **EA-APPL 602:** [SAPK-60214INEAAPPL](https://me.sap.com/supportpackage/SAPK-60214INEAAPPL)
- **EA-APPL 603:** [SAPK-60313INEAAPPL](https://me.sap.com/supportpackage/SAPK-60313INEAAPPL)
- **EA-APPL 604:** [SAPK-60414INEAAPPL](https://me.sap.com/supportpackage/SAPK-60414INEAAPPL)
- **EA-APPL 605:** [SAPK-60511INEAAPPL](https://me.sap.com/supportpackage/SAPK-60511INEAAPPL)
- **EA-APPL 606:** [SAPK-60607INEAAPPL](https://me.sap.com/supportpackage/SAPK-60607INEAAPPL)
- **EA-APPL 616:** [SAPK-61602INEAAPPL](https://me.sap.com/supportpackage/SAPK-61602INEAAPPL)

### Correction Instructions
Alternatively, you can implement the attached correction instructions:

- [Correction Instructions for EA-APPL](https://me.sap.com/corrins/0001813155/229)

### Download Resources
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010714322017)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0001813155?language=en-US&token=E7DD18A6302746F05963392405C52B1C)

## Prerequisites
Before applying this security note, ensure that the following prerequisite notes are implemented:

1. [1122425 - Filling: Filtering specifications](https://me.sap.com/notes/1122425)
2. [1597660 - Potential modification/disclosure of persisted data in EH&S](https://me.sap.com/notes/1597660)

## Credits
Information provided with support from [redrays.io](https://redrays.io).