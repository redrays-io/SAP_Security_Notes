1819139 - Missing authorization check in SAP Kernel

**SAP Note Number:** 1819139  
**Type:** SAP Security Note  
**Version:** 1  
**Released On:** December 10, 2013  
**Category:** Program error  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Component:** Basis Components > Client/Server Technology > Low Level Layers

### Title
**Missing authorization check in SAP Kernel**

### Description

#### Symptom
An authenticated ABAP Developer can use functions of the SAP Kernel to which access should be restricted. This may result in an escalation of privileges.

**CVSS Information**  
- **CVSS Base Score:** 4.9  
- **CVSS Base Vector:** AV:N/AC:H/AU:S/C:N/I:N/A:C  

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the FAQ section at [SAP Security Notes](https://service.sap.com/securitynotes/).*

#### Reason and Prerequisites
SAP Kernel does not contain authorization checks for verifying an authenticated user's authorization to access some of its functions. This may result in undesired system behavior.

#### Solution
Apply the patch level mentioned in this note.  
Some kernel call interfaces for handling files or directories were designed to support specific administration functions and should not be used for other purposes. Now, they reject calls if:
- The user does not have the same authorization as the one used for the administrative transactions.
- The call comes from an unknown program.
- The file or directory name contains suspicious characters.

In such cases, the call is rejected, and `SY-SUBRC` is set to 5 or 6. The kernel modifications do not affect the official administrative transactions.

### CVSS
- **CVSS Score:** 4.9
- **CVSS Vector:** AV:N/AC:H/AU:S/C:N/I:N/A:C

### Validity
This note is applicable to the following software components and versions:

- **SAP KERNEL 7.00** to **7.01**
- **SAP KERNEL 7.10** to **7.20**
- **SAP KERNEL 7.20EXT** to **7.20EXT**
- **SAP KERNEL 7.21** and **7.21EXT**
- **SAP KERNEL 7.38**
- **SAP KERNEL 7.40**
- **SAP KERNEL 7.41**
- **SAP KERNEL 6.40**
- **SAP KERNEL 7.2L**

### Support Package Patches
Apply the following support package patches based on your SAP Kernel version:

- **SAP KERNEL 7.21 64-BIT:**  
  [SP137 Patch 000137](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200021237&V=MAINT)

- **SAP KERNEL 7.21 64-BIT UNICODE:**  
  [SP137 Patch 000137](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67837800100200021238&V=MAINT)

- **SAP KERNEL 7.38 64-BIT UNICODE:**  
  [SP041 Patch 000041](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019649&V=MAINT)

- **SAP KERNEL 7.40 64-BIT UNICODE:**  
  [SP038 Patch 000038](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=67838200100200019652&V=MAINT)

- **SAP KERNEL 7.20 64-BIT:**  
  [SP513 Patch 000513](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200013055&V=MAINT)

- **SAP KERNEL 7.20 64-BIT UNICODE:**  
  [SP513 Patch 000513](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=01200615320200013056&V=MAINT)

### Side Effects
This document is causing side effects for:

- **SAP Note 1929613:** [ST11 and AL11 do not display many attributes - Unicode?](https://me.sap.com/notes/0001929613)

### Available Translations
Translations are available in the following languages:

- [Deutsch](https://me.sap.com/notes/0001819139/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0001819139/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0001819139/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0001819139/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0001819139/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0001819139/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0001819139/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0001819139/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0001819139/3)

### Additional Resources
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017598582017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001819139?language=en-US&token=B667792C1D56C272CA81358D41A18E92)
- [Compare Versions](https://me.sap.com/notesLatestChanges/0001819139/E/diff)

*Please note that some links may require appropriate SAP support access.*

---

*Credits to [RedRays.io](https://redrays.io) for supporting the provision of this information.*