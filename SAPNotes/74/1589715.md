1589715 - Directory traversal in card application component

## SAP Security Note Details

**SAP Note/KBA:** 1589715  
**Type:** SAP Security Note  
**Version:** 1  
**Recency:** New  
**Language:** English  
**Master Language:** German  
**Category:** Program error  
**Priority:** Correction with high priority  
**Release Status:** Released for Customer  
**Released On:** 13.09.2011  
**Component:** FS-AM-CM-CA (Financial Services > Account Management > Contract Management > Card)

## Description

The card application component contains a vulnerability through which a malicious user can potentially write arbitrary files on the remote server, possibly corrupting data or altering system behavior.

**Other Terms:** Directory traversal, card, card contract, Card Management

**Reason and Prerequisites:**  
The card application component fails to correctly validate the path to which a user-submitted file is written. As a result, a malicious user can potentially overwrite data in the remote system.

## Solution

Import the relevant Support Package for your release.

For more information and instructions, see [Note 1497003](https://me.sap.com/notes/1497003).  
Before you can implement this note, you must have implemented the corrections from  
Note 1497003.

### Logical File Names Used in This Solution:

The following logical file names have been created to enable the validation of physical file names:

| Logical file               | Logical file |
|----------------------------|--------------|
| CARD_CONSISTENCY_CHECK     | BCA_CARD_TEST_FILE |
| CARD_TRANSFER_FILE         | BCA_CARD_TEST_FILE |
| CCPP_CONSISTENCY_CHECK     | BCA_CARD_ORDER_TEST_FILE |

### Logical File Paths Used in This Solution:

The logical file names listed above use the following logical file path:

| Logical path               | Logical file            |
|----------------------------|-------------------------|
| BCA_AM_CONSISTENT_PATH     | BCA_CARD_TEST_FILE      |
| BCA_AM_CONSISTENT_PATH     | BCA_CARD_ORDER_TEST_FILE |

## Actions

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009436522017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001589715?language=en-US&token=4EBD17A7C43FA3DD26D8AB3AD279B92C)
- [Share by Email](https://me.sap.com/notes/0001589715/share)
- [Open in New Window](https://me.sap.com/notes/0001589715)
  
## Support Package

| Software Component Version | Support Package                   | URL                                        |
|----------------------------|-----------------------------------|--------------------------------------------|
| FSAPPL 100                 | SAPKISC216                        | [Link](https://me.sap.com/supportpackage/SAPKISC216) |
| FSAPPL 200                 | SAPKISC316                        | [Link](https://me.sap.com/supportpackage/SAPKISC316) |
| FSAPPL 300                 | SAPK-30009INFSAPPL                 | [Link](https://me.sap.com/supportpackage/SAPK-30009INFSAPPL) |
| BANK-TRBK 40               | SAPKISC110                        | [Link](https://me.sap.com/supportpackage/SAPKISC110) |

## Correction Instructions

| Software Component | Number of Correction Instructions | URL                                           |
|--------------------|-----------------------------------|-----------------------------------------------|
| FSAPPL             | 2                                 | [Link](https://me.sap.com/corrins/0001589715/1534) |
| BANK-TRBK          | 1                                 | [Link](https://me.sap.com/corrins/0001589715/62)  |

## References

**This document refers to:**  
- [1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

## Translations

Available in multiple languages including Japanese, Deutsch, Portuguese, Español, Français, Italiano, Русский, 中文, and 한국어. Access translations [here](https://me.sap.com/notes/0001589715).

## Credits

Credits to [Redrays.io](https://redrays.io) for support to provided information.