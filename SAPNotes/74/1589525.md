1589525 - Verb Tampering Issues in CTC

**Symptom**
This security note has been updated. For more detailed information, see [Security Note 1624450](https://me.sap.com/notes/1624450).

Problems with authorization and authentication checks in conjunction with the use of unusual HTTP methods exist in CTC.

**CVSS Information**
- **CVSS Base Score:** 7.5
- **CVSS Vector:** AV:N/AC:L/AU:N/C:P/I:P/A:P

*SAP provides this CVSS base score as an estimate of the risk posed by the issue reported in this note. This estimate does not take into account your own system configuration or operational environment. It is not intended to replace any risk assessments you are advised to conduct when deciding on the applicability or priority of this SAP security note. For more information, see the [FAQ section](https://me.sap.com/securitynotes/) on the SAP Service Marketplace.*

**Reason and Prerequisites**
The CTC/Configuration Wizard application (also known as the Template Installer) contains verb tampering vulnerabilities. This means there is a risk of information disclosure if the application is accessed with HTTP requests containing unexpected HTTP methods. Verb tampering issues can be exploited from arbitrary network locations.

**Prerequisites:**
1. `SAP_ungranted_role` shall **never** be granted to any user.
2. Ensure [SAP Note 1445998](https://me.sap.com/notes/1445998) is applied to disable invokerservlet (Not required for NW 7.20 SP03 and above).

**Solution**
AS Java ships with numerous Web applications configured through their deployment descriptors (`web.xml`). To protect against this vulnerability, all HTTP method restrictions from the `security-constraint` section in the `web.xml` associated with the CTC Servlets must be removed.

**Steps:**
1. **Apply Official Patch:**
   - Download and apply the official patch for your respective release from the [SAP Service Marketplace](https://me.sap.com/notes/0040000017243752017).
   
   *If a patch is unavailable, consider the manual implementation or the provided workarounds below.*

2. **Manual Implementation (If Patch Unavailable):**
   - **Modify `web.xml`:**
     - Locate and extract the relevant `web.xml` files from your SAP NetWeaver installation.
     - Remove all `<http-method>` elements within the `<security-constraint>` sections.
     - Save and redeploy the modified `web.xml` files as per your NetWeaver version requirements.
   
   *Detailed steps are available within the full SAP Note.*

**Workarounds:**
1. **Disable Application Aliases:**
   - Access the Visual Administrator or SAP NetWeaver Administrator.
   - Disable the CTC-related application aliases to block access to vulnerable components.
   
   *Note: Do not use this workaround if CTC functionality is actively used.*

2. **Prevent Remote Connections:**
   - Configure your firewall or IDS to block specific URL patterns associated with CTC components, preventing remote exploit attempts.

**Affected Software Components:**
- **LM-TOOLS:** Versions 6.40 to 7.31
- **LMCTC:** Versions 7.10 to 7.31

**References:**
- [Security Note 1624450](https://me.sap.com/notes/1624450)
- [Briefing at Black Hat conference on July 31st, 2013](https://me.sap.com/notes/1889488)
- [Briefing at Black Hat conference on August 4th, 2011](https://me.sap.com/notes/1616259)

For more detailed information and updates, visit the [SAP Service Marketplace](https://me.sap.com/notes/0001589525).

*Credits to [Redrays.io](https://redrays.io) for support in providing this information.*