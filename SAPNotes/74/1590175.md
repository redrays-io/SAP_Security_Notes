SAP Security Note 1590175: Unauthorized Use of Application Functions in CRM-MKT-DAM

**SAP Note Number:** [1590175](https://me.sap.com/notes/0001590175)

**Title:** Unauthorized use of application functions in CRM-MKT-DAM

**Type:** SAP Security Note

**Version:** 4  
**Recency:** New  
**Release Status:** Released for Customer  
**Released On:** 11.09.2012  
**Component:** [Customer Relationship Management > Marketing > Digital Asset Management](https://me.sap.com/servicessupport/knowledge/mynotes?tab=Search&sortBy=Relevance&filters=...)

### Symptom
A malicious user can trigger functionality in the following BSP applications without authentication and authorization: `CRM_DAM_MUPL`, `CRM_DAM_DELETE`, `CRM_DAM_AS_ADM` (applicable for Releases CRM 5.0, CRM 5.2, CRM 6.0 (CRM2007), CRM 7.0, CRM 7.01, and CRM 7.02).

### Other Terms
- Cross-Site Request Forgery (XSRF)

### Reason and Prerequisites
The mentioned BSP applications execute certain functions through specific URLs. An attacker can trick an authenticated user's browser into making a request with specific URLs and parameters, executing functions with the user's privileges. This can be achieved through Cross Site Scripting (XSS) attacks or by presenting malicious links to the victim.

### Solution

#### Prerequisites and Post Actions:

1. **Refer to Notes [1520324](https://me.sap.com/notes/0001520324) and [1551982](https://me.sap.com/notes/0001551982):** These notes provide additional information and instructions. Implementing the corrections from these notes is a prerequisite for this note.

2. **Applicable Releases:** CRM 5.0, CRM 5.2, CRM 6.0 (CRM2007), CRM 7.0, CRM 7.01, and CRM 7.02.

   2.1 **Implement the Correction Instructions:** This will create the report `CRM_BSP_XSRF_PARAM_DAM_BSP_2` in your system. The report is valid for the specified releases. Note that the report differs for CRM 7.01 and CRM 7.02 due to the unavailability of one BSP.

   2.2 **Execute the Report `CRM_BSP_XSRF_PARAM_DAM_BSP_2`:** Specify the requested transport request number when prompted. This report will populate the database table `BSPTEMPXSRFSTORE` with entries for the adapted BSP applications.

### Support Packages
- **BBPCRM 500:** [SAPKU50020](https://me.sap.com/supportpackage/SAPKU50020)
- **BBPCRM 600:** [SAPKU60011](https://me.sap.com/supportpackage/SAPKU60011)
- **BBPCRM 700:** [SAPKU70011](https://me.sap.com/supportpackage/SAPKU70011)
- **BBPCRM 701:** [SAPKU70107](https://me.sap.com/supportpackage/SAPKU70107)
- **BBPCRM 702:** [SAPKU70202](https://me.sap.com/supportpackage/SAPKU70202)

### Correction Instructions
- **Software Component:** BBPCRM
- **Number of Correction Instructions:** 5
- **URL:** [Correction Instructions](https://me.sap.com/corrins/0001590175/63)

### Manual Activities
You must perform this manual activity separately in each system where you transport the Note for implementation:

1. **Execute the Report `BSP_XSRF_PARAM_CRM_DAM_BSP_2`:** Specify the requested transport request number when prompted. This will populate the `BSPTEMPXSRFSTORE` table with relevant entries for the BSP applications.

**Caution:** Perform this manual post-implementation step in each system after importing the Note.

### References
- **This document refers to:**
  - [1551982](https://me.sap.com/notes/0001551982) - Cross-site request forgery protection for stateless
  - [1520324](https://me.sap.com/notes/0001520324) - Advance creation of XSRF information

### Available Languages
- **Deutsch:** [Deutsch Translation](https://me.sap.com/notes/0001590175/D)
- **Japanese:** [日本語 Translation](https://me.sap.com/notes/0001590175/J)
- **Português (Machine Translation):** [Português](https://me.sap.com/notes/0001590175/P)
- **Español (Machine Translation):** [Español](https://me.sap.com/notes/0001590175/S)
- **Français (Machine Translation):** [Français](https://me.sap.com/notes/0001590175/F)
- **Italiano (Machine Translation):** [Italiano](https://me.sap.com/notes/0001590175/I)
- **Русский (Machine Translation):** [Русский](https://me.sap.com/notes/0001590175/R)
- **中文 (Machine Translation):** [中文](https://me.sap.com/notes/0001590175/1)
- **한국어 (Machine Translation):** [한국어](https://me.sap.com/notes/0001590175/3)

For more details, visit the [official SAP Note page](https://me.sap.com/notes/0001590175) on SAP Support Portal.

*Credits to [redrays.io](https://redrays.io) for supporting the provision of this information.*