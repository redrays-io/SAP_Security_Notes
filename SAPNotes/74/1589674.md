1589674 - Unauthorized use of application functionality in CA-GTF-PCF

**Symptom**

A malicious user can trigger functionality in CA-GTF-PCF without authentication and authorization.

**Other Terms**

Cross-site request forgery, XSRF, CA-GTF-PCF.

**Reason and Prerequisites**

CA-GTF-PCF executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The malicious user may use a cross-site scripting attack to do this, or they may present a link to the victim.

**Solution**

For the stateless BSP applications:

- CRM_BSP_FACE, CRM_ML_PREVIEW, CRM_PREVIEW, CRM_BSP_FRAME, crm_xml_test, crm_bsp_bab_fra, CRM_BSP_BAB_PAN, CRM_BSP_XBAB_FR, CRM_BSP_XBAB_PA, CRM_BSP_F1_HELP, CRM_BSP_F4_HELP, CRM_BSP_LISTPER, crm_bsp_bab_dis, CRM_BSP_BAB_DSS, CRM_PRT_URL_DIS, CRM_BSP_LST_PRT

1. Refer to [Note 1520324](https://me.sap.com/corrins/0001520324) and [Note 1551982](https://me.sap.com/corrins/0001551982) for additional information and instructions. The corrections from these notes are prerequisites for the implementation of this note.
2. Implement the correction instructions of this note. This will create the report `BSP_XSRF_PARAM_CA_GTF_PCF` in your system.
3. Execute the report `BSP_XSRF_PARAM_CA_GTF_PCF` and specify a corresponding transport request number when prompted. The report will activate the XSRF protection for the BSP applications adapted by this note.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009436732017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001589674?language=en-US&token=E479B07EA2382C381F3C98181647FAB2)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001589674/E/diff)

**Additional Information**

- **Type:** SAP Security Note
- **Version:** 3
- **Recency:** Updated
- **Language:** English
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 11.11.2011
- **Component:** Cross-Application Components > General Application Functions > People Centric UI Framework

**Credits**

Thanks to [Redrays](https://redrays.io) for supporting the provision of this information.