1589611 - SEC-207_3 XSRF Adaption for NW BSP Stateless Apps (IMS)

**SAP Security Note 1589611 Overview**

**Symptom**
A malicious user can trigger functionality in BC-SRV-KPR without proper authentication and authorization.

**Other Terms**
Cross Site Request Forgery (XSRF), BC-SRV-KPRO, XSRF

**Reason and Prerequisites**
BC-SRV-KPR executes certain functions by referencing specific URLs and parameters. An attacker can trick an authenticated user's browser into making a request with a crafted URL and parameters, causing the function to execute with the user's privileges. Techniques such as Cross Site Scripting (XSS) can be used to exploit this vulnerability, or by presenting a malicious link for the victim to click.

**Solution**
1. **Refer to Prerequisite Notes**: Ensure that notes [1520324](https://me.sap.com/corrins/0001520324) and [1551982](https://me.sap.com/corrins/0001551982) are implemented, as they are prerequisites for this correction.
2. **Implement Correction Instructions**: Follow the correction instructions provided in this note to create the report `BSP_XSRF_PARAM_BC_SRV_KPR` in your system.
3. **Execute the Report**: Run the report `BSP_XSRF_PARAM_BC_SRV_KPR` and provide the requested transport request number when prompted. This will activate XSRF protection for the BSP applications affected by this note.

**Affected Components**
- **SAP_BASIS** versions 620 to 731

**Support Packages**
Ensure that the appropriate Support Package for your SAP_BASIS version is applied. For example:
- SAP_BASIS 620: [SAPKB62071](https://me.sap.com/supportpackage/SAPKB62071)
- SAP_BASIS 640: [SAPKB64029](https://me.sap.com/supportpackage/SAPKB64029)
- *(Refer to the Security Note for a complete list of supported versions and corresponding packages.)*

**Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009436062017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001589611?language=en-US&token=6684D0E59308AA8ACA73696A630917F0)
- [Correction Instructions](https://me.sap.com/corrins/0001589611/41)

**Credits**
Information supported by [Redrays.io](https://redrays.io).