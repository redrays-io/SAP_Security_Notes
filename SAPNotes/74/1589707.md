SAP Security Note 1589707 - Unauthorized execution of functions in agency collections

**Symptom**
A malicious user can execute Italian FS-CD agency collection functions without the required authentication and authorization.

**Important:** This note is only relevant for customers who use FS-CD (software component INSURANCE) and the Italian agency collections (BSP application ITAGCY, activated using transaction ITAGCYCUST → "Basic Settings → Basic settings for agency collections"). Other customers are not affected and do not have to implement this note.

**Other Terms**
Cross site request forgery, XSRF, business server pages, BSP, ITAGCY, agency

**Reason and Prerequisites**
The BSP application for the Italian agency collections executes functions by calling certain URLs with parameters. If a malicious user succeeds in executing requests through the browser of a logged-in user, the malicious user can call functions with the rights of the user.

To achieve this, a malicious user can exploit a potential vulnerability in cross-site scripting or send the user a specially crafted link, for example via email.

**Solution**
Implement the attached program corrections. For releases lower than INSURANCE 6.05, follow the instructions below.

The described solution will not resolve the issue if you are using BSP design DESIGN2002. You can use the user parameter ID ITAGCY_DESIGN to set up the design for the Italian agency collections individually for each user. Alternatively, you can use the BSP application ITAGCY_USERDATA, where the user can manually change the design.

Also see [Note 1509885](https://me.sap.com/notes/1509885) for BSP design DESIGN2008.

**For releases INSURANCE below 6.05:**

1. For further information and instructions, refer to [Notes 1520324](https://me.sap.com/notes/1520324) and [1551982](https://me.sap.com/notes/1551982). Before implementing this note, you must first apply the corrections from Notes 1520324 and 1551982.

2. Implement the correction instructions relevant to your release as detailed in this note. This will create or modify the report BSP_XSRF_PARAM_FSCD in your system.

3. Execute the report BSP_XSRF_PARAM_FSCD and, when prompted, specify a relevant transport request number. The report updates the policy configurations of the BSP applications for agency collections.

**Download Links:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009436472017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001589707?language=en-US&token=5F24C29DF797C02552F9B62422A89F46)

**References**
- **This document refers to:**  
  [Note 1624291](https://me.sap.com/notes/1624291) - Syntax error when implementing a security note (FI-CA)

- **This document is referenced by:**  
  [Note 1624291](https://me.sap.com/notes/1624291) - Syntax error when implementing a security note (FI-CA)

**Validity**
Applicable Software Component: INSURANCE  
Applicable Versions: 472, 600, 602, 603, 604, 605, 606, 616

**Support Packages:**
- INSURANCE 472: [SAPKIPIN22](https://me.sap.com/supportpackage/SAPKIPIN22)
- INSURANCE 600: [SAPK-60021ININSURANC](https://me.sap.com/supportpackage/SAPK-60021ININSURANC)
- INSURANCE 602: [SAPK-60211ININSURANC](https://me.sap.com/supportpackage/SAPK-60211ININSURANC)
- INSURANCE 603: [SAPK-60310ININSURANC](https://me.sap.com/supportpackage/SAPK-60310ININSURANC)
- INSURANCE 604: [SAPK-60411ININSURANC](https://me.sap.com/supportpackage/SAPK-60411ININSURANC)
- INSURANCE 605: [SAPK-60507ININSURANC](https://me.sap.com/supportpackage/SAPK-60507ININSURANC)
- INSURANCE 606: [SAPK-60602ININSURANC](https://me.sap.com/supportpackage/SAPK-60602ININSURANC)

**Credits**
Thanks to [redrays.io](https://redrays.io) for supporting the provision of this information.