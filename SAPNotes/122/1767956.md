1767956 - Directory traversal in BC-SRV-KPR-CS

**SAP Security Note 1767956: Directory Traversal Vulnerability in BC-SRV-KPR-CS**

**Release Date:** May 23, 2014  
**Type:** SAP Security Note  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Component:** Basis Components > Basis Services/Communication Interfaces > Knowledge Provider > SAP Content Server

### **Symptom**
A vulnerability exists in BC-SRV-KPR-CS that allows a malicious user to perform directory traversal. This can enable unauthorized reading of arbitrary files on the remote server, potentially disclosing confidential information, and writing arbitrary files, which may corrupt data or alter system behavior.

**CVSS Information:**  
- **Base Score:** 6.5  
- **Vector:** AV:N/AC:L/AU:S/C:P/I:P/A:P  
*Note: The CVSS score is an estimate of the risk and does not account for specific system configurations.*

### **Reason and Prerequisites**
The issue arises because BC-SRV-KPR-CS does not properly validate the file path used to access files on the remote server. This lack of validation allows attackers to manipulate the path to access or overwrite arbitrary files within the system.

### **Solution**
To mitigate this vulnerability, disable directory browsing in your web servers as follows:

**For IIS 7:**
1. Open IIS Manager and navigate to the desired level.
2. In Features View, double-click **Directory Browsing**.
3. In the Actions pane, click **Disable**.

**For IIS 5.1 or IIS6:**
1. Open IIS Manager.
2. Right-click your SAP Content Server website (e.g., SAP_Content_Server) and select **Properties**.
3. Click the **Home Directory** tab and uncheck **Directory Browsing**.
4. Click **Apply** and **OK**.
5. Restart IIS to apply changes.

**For Apache:**
1. Locate and open the `httpd.conf` file.
2. Find the `<Directory "/u01/app/apache/htdocs">` section.
3. Change `Options Indexes FollowSymLinks` to `Options -Indexes FollowSymLinks`.
4. Save the file and restart Apache to apply changes.

For more details, refer to the [SAP Security Note 1767956](https://me.sap.com/notes/1767956) on the SAP Support Portal.

### **Additional Actions**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017509042017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001767956?language=en-US&token=260576B7ED414E869299D1BCDAD2B31E)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001767956/E/diff)

**Credits:**  
Information supported by [Redrays](https://redrays.io).