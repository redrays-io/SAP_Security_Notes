SAP Security Note 3421453 - Multiple CVEs: XSS Vulnerabilities in SAP Business Connector

### **Symptom**

This SAP Security Note addresses several vulnerabilities identified in SAP Business Connector. The details of these vulnerabilities are as follows:

1. **Cross-Site Scripting (Reflected)**
   - **CVE-2024-30214**
   - **CVSS Score:** 4.8
   - **Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
   - **Description:** The application allows a high privilege attacker to append a malicious GET query parameter to service invocations, which are reflected in the server response. If the parameter contains JavaScript, the script could be executed on the client side under certain circumstances.

2. **Cross-Site Scripting (Stored)**
   - **CVE-2024-30215**
   - **CVSS Score:** 4.8
   - **Vector:** CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
   - **Description:** The Resource Settings page allows a high privilege attacker to load an exploitable payload that is stored and reflected whenever a user visits the page. In a successful attack, some information could be obtained or modified. However, the attacker does not have control over the information obtained, and the impact is limited.

### **Reason and Prerequisites**

1. Incoming GET request query parameters were only partially sanitized when inserted into the HTML response, allowing potential execution of unencoded scripts.
2. Input parameters on the Resource Settings page were written to the page body by JavaScript without proper encoding, bypassing automatic XSS protection.

### **Solution**

- **Apply CoreFix 3 for Business Connector 4.8.1** as described in [SAP Note 3448291](https://me.sap.com/notes/3448291).

This update ensures that:
1. URL parameters are properly encoded to prevent XSS attacks.
2. Input values on the Resource Settings page are properly encoded before being written to the configuration file and inserted into the page.

### **Additional Information**

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000000405822024](https://notesdownloads.sap.com/note/0040000000405822024)
- **PDF Version:** [https://me.sap.com/sap/support/sfm/notes/print/0003421453?language=en-US&token=3B7E1FF8A84C5A425B105D9A73C63A10](https://me.sap.com/sap/support/sfm/notes/print/0003421453?language=en-US&token=3B7E1FF8A84C5A425B105D9A73C63A10)
- **Edit Note:** [https://me.sap.com/sap/support/notes/edit/0003421453](https://me.sap.com/sap/support/notes/edit/0003421453)

For more details and other available languages, visit the [SAP Notes](https://me.sap.com/notes/0003421453).

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*