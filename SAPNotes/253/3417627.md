SAP Security Note 3417627 - [CVE-2024-22126] Cross Site Scripting vulnerability in NetWeaver AS Java (User Admin Application)

**Description**

The User Admin application of SAP NetWeaver AS for Java insufficiently validates and improperly encodes the incoming URL parameters before including them into the redirect URL. This results in a Cross-Site Scripting (XSS) vulnerability, leading to a high impact on confidentiality and mild impact on integrity and availability.

**Change Log**

- **v10 (Updated on 11th February 2025):** The solution provided in this security note is obsolete. For the complete fix, please implement the SAP security note [3557138](https://me.sap.com/notes/3557138) - Update 1 to Security Note 3417627.

**Reason and Prerequisites**

You have applied SAP Note [3251396](https://me.sap.com/notes/3251396). The fix introduced with this note allows AS Java to include all the original URL parameters into the redirect URL. However, it does not properly validate and encode them. Thus, a maliciously crafted parameter can be reflected back to the browser, resulting in an XSS vulnerability.

**Solution**

Apply the correction according to the "Validity" and "Support Packages & Patches" sections of this note. To avoid incompatibilities on the system, check SAP Note [1974464](https://me.sap.com/notes/1974464) - Information on SCA Dependency Analysis for Java download objects.

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000163612024)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003417627?language=en-US&token=F0155299788BC0CD7123A4CCC050F92E)
- [Show Changes](https://me.sap.com/notesLatestChanges/0003417627/E/diff)

**CVSS**

- **Score:** 8.8
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:L

**Categories**

- **Type:** SAP Security Note
- **Category:** Program error
- **Priority:** Correction with high priority
- **Status:** Released for Customer
- **Released On:** 11.02.2025
- **Component:** Basis Components > NetWeaver Application Server Java > Security, User Management > User Management Engine

**Supported Software Components**

- **J2EE-APPS:** 7.50

**Support Package Patches**

- **J2EE ENGINE APPLICATIONS 7.50**
  - SP026 Patch Level 000005: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP026&patch_level=000005)
  - SP027 Patch Level 000003: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP027&patch_level=000003)
  - SP028 Patch Level 000003: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP028&patch_level=000003)
  - SP029 Patch Level 000000: [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001504&support_package=SP029&patch_level=000000)

**Available Languages**

- [Deutsch](https://me.sap.com/notes/0003417627/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0003417627/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003417627/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003417627/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003417627/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003417627/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003417627/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003417627/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003417627/3)

**References**

- [Disabling SAML2 via URL parameter for SAP User Management Application (3251396)](https://me.sap.com/notes/3251396)
- [Information on SCA Dependency Analysis for Java download objects (1974464)](https://me.sap.com/notes/1974464)

**Credits**

Credits to [redrays.io](https://redrays.io) for support to provided information.