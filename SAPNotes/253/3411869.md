3411869 - [CVE-2024-21737] Code Injection Vulnerability in SAP Application Interface Framework (File Adapter)

**Symptom**

In SAP Application Interface Framework File Adapter, a high privilege user can use a function module to traverse through various layers and execute OS commands directly. By this, such a user can control the behavior of the application. This leads to considerable impact on confidentiality, integrity, and availability.

**Other Terms**

- Command Injection
- OS Command Injection
- Injection Vulnerability
- [CVE-2024-21737](https://www.cve.org/CVERecord?id=CVE-2024-21737)

**Reason and Prerequisites**

The feature to create a new path was enabled and has this vulnerability. Within this note, the feature is disabled.

**Solution**

Implement the attached correction instruction or apply the corresponding [Support Package](https://me.sap.com/corrins/0003411869/10695).

This issue only affects lower versions of Application Interface Framework 3.0. All higher versions do not have this vulnerability. Please upgrade to version 4.0 or higher.

**CVSS**

- **Score:** 8.4
- **Vector:** [CVSS:3.0/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H](https://me.sap.com/notes/0003411869)

**Affected Software Components**

- **Software Component:** AIF
- **From:** 702
- **To:** 702

**Support Package**

- **Software Component Version:** AIF 702
- **Support Package:** [SAPK-70210INAIF](https://me.sap.com/supportpackage/SAPK-70210INAIF)

**Correction Instructions**

- **Software Component:** AIF
- **Number of Correction Instructions:** 1
- **URL:** [Correction Instruction 10695](https://me.sap.com/corrins/0003411869/10695)

**References**

_No references available._

**Prerequisites**

1. [Enhancements of AIF Fileadapter](https://me.sap.com/notes/2179487) (Component: CA-GTF-AIF)
2. [Missing error handling in report /AIF/CHECK_AND_SEND_FILES](https://me.sap.com/notes/2287499) (Component: CA-GTF-AIF)
3. [Code Inspector fixes for excel upload in fileadapter, no functional changes.](https://me.sap.com/notes/2305511) (Component: CA-GTF-AIF)
4. [File Adapter: error if physical file path length exceeds 55 characters](https://me.sap.com/notes/2567486) (Component: CA-GTF-AIF)
5. [File Adapter: Application server file not closed](https://me.sap.com/notes/3149837) (Component: BC-SRV-AIF)

**Available Languages**

- [Deutsch](https://me.sap.com/notes/0003411869/D)
- [日本語](https://me.sap.com/notes/0003411869/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003411869/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003411869/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003411869/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003411869/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003411869/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003411869/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003411869/3)

*Credits to [Redrays](https://redrays.io) for support in providing this information.*