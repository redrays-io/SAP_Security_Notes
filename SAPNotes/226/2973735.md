2973735 - [CVE-2020-26808] Code Injection in SAP AS ABAP and S/4 HANA (DMIS)

## Symptom

**UPDATE 17th November 2020**: This note has been re-released with updated ‘Support Packages & Patches’ information. For the release S4CORE 104, we added the support package SP00.

SAP AS ABAP and SAP S/4 HANA allows an authenticated attacker to inject arbitrary code in the application and change the course of execution. Due to lack of input validation, an attacker who has been granted access (S_RFC) to execute the function module can inject malicious ABAP code, which will be saved persistently in a report in the ABAP repository.

This report can then be executed by using the remote function module without additional authorization checks. The successful exploitation of the identified vulnerability can allow the attacker to take complete control of the affected system.

## Solution

The affected function module is used for checking the syntax for a table selection query. The solution for the issue is to introduce an authorization check (object S_DMIS, level 'Package', and activity value '01' - create and generate) in the affected function module, and to remove/delete the generated coding from the ABAP repository. The generated report still exists but without any coding, thereby removing the possibility to exploit the identified vulnerability.

In systems where the affected function module is not used, the complete coding of the function module is commented out.

**Actions to take:**
- Implement the correction note [2973735](https://me.sap.com/notes/2973735) or
- Upgrade to the corresponding Support Packages referenced by this SAP Security Note.

## Affected Software Components

- **DMIS**
  - 2011_1_620
  - 2011_1_640
  - 2011_1_700
  - 2011_1_710
  - 2011_1_730
  - 2011_1_731
  - 2018_1_752
  - 2020

- **S4CORE**
  - 100
  - 101
  - 102
  - 103
  - 104
  - 105

## CVSS Score

**9.1**  
[CVSS Vector](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** High (H)
- **User Interaction:** None (N)
- **Scope:** Changed (C)
- **Confidentiality Impact:** High (H)
- **Integrity Impact:** High (H)
- **Availability Impact:** High (H)

## References

- [FAQ for SAP Note 2973735 - Code Injection vulnerability in S/4 HANA](https://me.sap.com/notes/2985806)

## Support Packages

For S4CORE:
- [SAPK-10110INS4CORE](https://me.sap.com/supportpackage/SAPK-10110INS4CORE)
- [SAPK-10208INS4CORE](https://me.sap.com/supportpackage/SAPK-10208INS4CORE)
- [SAPK-10306INS4CORE](https://me.sap.com/supportpackage/SAPK-10306INS4CORE)
- [SAPK-10404INS4CORE](https://me.sap.com/supportpackage/SAPK-10404INS4CORE)
- [SAPK-10501INS4CORE](https://me.sap.com/supportpackage/SAPK-10501INS4CORE)

For DMIS:
- [SAPK-11120INDMIS](https://me.sap.com/supportpackage/SAPK-11120INDMIS)
- [SAPK-11220INDMIS](https://me.sap.com/supportpackage/SAPK-11220INDMIS)
- [SAPK-11320INDMIS](https://me.sap.com/supportpackage/SAPK-11320INDMIS)
- [SAPK-11420INDMIS](https://me.sap.com/supportpackage/SAPK-11420INDMIS)
- [SAPK-11520INDMIS](https://me.sap.com/supportpackage/SAPK-11520INDMIS)
- [SAPK-11620INDMIS](https://me.sap.com/supportpackage/SAPK-11620INDMIS)
- [SAPK-20105INDMIS](https://me.sap.com/supportpackage/SAPK-20105INDMIS)
- [SAPK-20201INDMIS](https://me.sap.com/supportpackage/SAPK-20201INDMIS)

## Rating

This document has not been rated yet. Your feedback is valuable!

## Credits

Thanks to [RedRays](https://redrays.io) for supporting with the provided information.