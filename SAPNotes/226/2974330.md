2974330 - [CVE-2020-26826] Unrestricted File Upload vulnerability in SAP NetWeaver Application Server for Java (Process Integration Monitoring)

## Description

Process Integration Monitoring of SAP NetWeaver Application Server for Java allows an attacker with access to the PIMON application, which is available to basic users, to upload any file (including script files) without proper file format validation. The file is transported as an attachment through the system and stored in an uncritical format in the database table. Processing a very large file could render the affected resource completely unavailable.

## CVE Information

- **CVE**: [CVE-2020-26826](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26826)
- **CVSS Score**: 6.5
- **Vector**: `CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H`

## Affected Components

- **Component**: BC-NWA-XPI  
  *(Basis Components > NetWeaver Administrator Tool (NWA) > Process Integration (PI) Monitoring)*

## Solution

The vulnerability is prevented by implementing an allowlist approach and limiting the file size.

- **File Size Limit**: `sndTestMessage.monitor.payload.filesize.limit` [MB]
- **File Extensions**: `sndTestMessage.monitor.payload.file.extensions`

Apply the Support Packages and Patches referenced by this SAP Security Note. To maintain the properties, log on to SAP NetWeaver Administrator and navigate to **Configuration** → **Infrastructure** → **Java System Properties**. Select the **Applications** tab and filter for the application name: `tc~lm~itsam~co~ui~nwacompmon~wd`.

## Support Package Patches

| Software Component Version | Support Package | Patch Level | [URL](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001638&support_package=SP015&patch_level=000006) |
|----------------------------|-----------------|-------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SOA MONITORS 7.50          | SP015           | 000006      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001638&support_package=SP015&patch_level=000006)                                                                        |
| SOA MONITORS 7.50          | SP016           | 000012      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001638&support_package=SP016&patch_level=000012)                                                                        |
| SOA MONITORS 7.50          | SP017           | 000010      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001638&support_package=SP017&patch_level=000010)                                                                        |
| SOA MONITORS 7.50          | SP018           | 000006      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001638&support_package=SP018&patch_level=000006)                                                                        |
| SOA MONITORS 7.40          | SP018           | 000008      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019743&support_package=SP018&patch_level=000008)                                                                        |
| SOA MONITORS 7.50          | SP019           | 000003      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001638&support_package=SP019&patch_level=000003)                                                                        |
| SOA MONITORS 7.40          | SP019           | 000007      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019743&support_package=SP019&patch_level=000007)                                                                        |
| SOA MONITORS 7.40          | SP020           | 000005      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019743&support_package=SP020&patch_level=000005)                                                                        |
| SOA MONITORS 7.50          | SP020           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001638&support_package=SP020&patch_level=000000)                                                                        |
| SOA MONITORS 7.40          | SP021           | 000006      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019743&support_package=SP021&patch_level=000006)                                                                        |
| SOA MONITORS 7.40          | SP022           | 000003      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019743&support_package=SP022&patch_level=000003)                                                                        |
| SOA MONITORS 7.31          | SP023           | 000008      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014376&support_package=SP023&patch_level=000008)                                                                        |
| SOA MONITORS 7.40          | SP023           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019743&support_package=SP023&patch_level=000000)                                                                        |
| SOA MONITORS 7.31          | SP024           | 000007      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014376&support_package=SP024&patch_level=000007)                                                                        |
| SOA MONITORS 7.31          | SP025           | 000005      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014376&support_package=SP025&patch_level=000005)                                                                        |
| SOA MONITORS 7.31          | SP026           | 000005      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014376&support_package=SP026&patch_level=000005)                                                                        |
| SOA MONITORS 7.31          | SP027           | 000003      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014376&support_package=SP027&patch_level=000003)                                                                        |
| SOA MONITORS 7.31          | SP028           | 000000      | [Link](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014376&support_package=SP028&patch_level=000000)                                                                        |

## References

This document is referenced by:

- [3042936 - Could not perform this operation error in Send Test Message functionality](https://me.sap.com/notes/3042936)
- [2993478 - Collective note: SAP NETWEAVER 7.5 SP20 - Process Orchestration (PI)](https://me.sap.com/notes/2993478)
- [2968087 - Collective note: SAP NETWEAVER 7.31 SP28 - Process Orchestration (PI)](https://me.sap.com/notes/2968087)

## Additional Information

- **Category**: Program error
- **Priority**: Correction with medium priority
- **Status**: Released for Customer
- **Released On**: 08.12.2020
- **Recency**: New
- **Language**: English
- **Externally Reported**: Yes

*Credits to [redrays.io](https://redrays.io) for support to provided information.*