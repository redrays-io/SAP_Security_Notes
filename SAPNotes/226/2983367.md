2983367 - [CVE-2020-26838] Code Injection vulnerability in SAP Business Warehouse (Master Data Management) and SAP BW4HANA

**Symptom**

**UPDATE 12th January 2021**: This note has been re-released with updated 'validity', and ‘Support Packages & Patches’ information. We enhanced the validity for all covered codelines to the lowest possible SP-level.

SAP BW Master Data Management and SAP BW4HANA allows an attacker with high privileges ability to submit a crafted request to generate and execute code without requiring any user interaction. These malicious requests could result in the execution of operating system commands that may completely compromise the confidentiality, integrity, and availability of the server and any data or other applications running on it.

**Other Terms**

Command Injection, OS command injection, [CVE-2020-26838](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26838)

**Reason and Prerequisites**

Misuse of a delivered function with the intention to execute arbitrary reports in the system

**Solution**

To resolve the issue, please implement the attached correction instruction or the equivalent support package:

- For release 7.30, the affected function module has been equipped with a hard-coded report name which is used by the only legitimated caller.
- Starting with release 7.40 in SAP BW/4HANA, the function should not be used anymore and thus has been disabled, meaning the code was removed.

**CVSS**

- **CVSS Score**: 9.1
- **CVSS Vector**: [CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/v3-0/specification-document)
  - Attack Vector (AV): Network (N)
  - Attack Complexity (AC): Low (L)
  - Privileges Required (PR): High (H)
  - User Interaction (UI): None (N)
  - Scope (S): Changed (C)
  - Confidentiality Impact (C): High (H)
  - Integrity Impact (I): High (H)
  - Availability Impact (A): High (H)

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000002070312020)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002983367?language=en-US&token=4B347EC58676394CFADC0BF3A4D829CE)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002983367/E/diff)

*Credits to [redrays.io](https://redrays.io) for support to provided information.*