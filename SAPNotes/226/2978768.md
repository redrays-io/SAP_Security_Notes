SAP Security Note 2978768 - [CVE-2020-26834] Improper authentication in SAP HANA database

## Description

### Symptom
The SAP HANA database does not correctly validate the user name when performing SAML bearer token-based user authentication. It is possible to manipulate a valid existing SAML bearer token to authenticate as a user whose name is identical to the truncated user name for whom the SAML bearer token was issued.

### Other Terms
Broken Authentication, [CVE-2020-26834](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26834)

### Reason and Prerequisites
To exploit this vulnerability, an attacker must have access to a valid SAML bearer token and the SAP HANA database must be configured to accept this token. Furthermore, there must also be a valid user in the system whose user name is identical to the beginning of the user name in the SAML bearer token. These users must also be enabled for SAML authentication.

### Solution
The issue is fixed with the following revisions:
- Revision 122.33 for SAP HANA 1.0 SPS 12
- Revision 48.03 for SAP HANA 2.0 SPS 04
- Revision 53 for SAP HANA 2.0 SPS 05

Update to these or later versions.

**Workaround:** Disable SAML authentication for affected users.

## Affected Components
- **Component:** SAP HANA Security & User Management (HAN-DB-SEC)
- **Release Status:** Released for Customer
- **Released On:** 08.12.2020

## Download & Resources
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000002070472020)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0002978768?language=en-US&token=39D991963C450085F46A1ADC913E719F)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0002978768)

## CVSS Score
**4.2**

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** High (H)
- **Privileges Required (PR):** Low (L)
- **User Interaction (UI):** None (N)
- **Scope (S):** Unchanged (U)
- **Confidentiality Impact (C):** Low (L)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

## Support Package Patches
- **SAP HANA DATABASE 1.00**
  - Support Package: SP122
  - Patch Level: 000033
  - [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=01200615320200017790&support_package=SP122&patch_level=000033)
  
- **SAP HANA DATABASE 2.0**
  - Support Package: SP048
  - Patch Level: 000003
  - [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200005327&support_package=SP048&patch_level=000003)
  
  - Support Package: SP053
  - Patch Level: 000000
  - [Apply Patch](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200005327&support_package=SP053&patch_level=000000)

## Credit
Special thanks to [RedRays.io](https://redrays.io) for supporting the information provided.