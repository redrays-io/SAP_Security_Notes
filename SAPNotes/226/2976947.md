2976947 - [CVE-2021-21491] Reverse TabNabbing vulnerability in SAP NetWeaver Application Server Java (Applications based on Web Dynpro Java)

---

**SAP Note Number:** 2976947  
**Type:** SAP Security Note  
**Version:** 10  
**Priority:** Correction with medium priority  
**Release Status:** Released for Customer  
**Released On:** 11.05.2021  
**Component:** Basis Components > Web Dynpro > WebDynpro Java

### Title
2976947 - [CVE-2021-21491] Reverse TabNabbing vulnerability in SAP NetWeaver Application Server Java (Applications based on Web Dynpro Java)

### Description

#### Symptom
**UPDATE 11th May 2021:** This note has been re-released with updated ‘Support Packages & Patches’ information. We added the correction for SP016 for release 7.50  
**UPDATE 13th April 2021:** This note has been re-released with updated ‘Support Packages & Patches’ information  

Applications based on SAP WebDynpro Java allow an attacker to redirect users to a malicious site due to Reverse Tabnabbing vulnerabilities.

Some impacts of Reverse Tabnabbing vulnerability include:
- Phishing attacks
- Redirecting users to untrusted webpages containing malware or similar malicious exploits

#### Other Terms
[CVE-2021-21491](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21491), Reverse TabNabbing, Web Dynpro Java, Opener Browsing Context, Opener Allowlist, security, link, hyperlink, noopener, noreferrer

#### Reason and Prerequisites
The Web Dynpro Java Framework is used. Browsers are vulnerable to reverse tabnabbing attacks.

#### Solution
By implementing this SAP Security Note, a default out-of-the-box protection is applied for all Web Dynpro Java applications.

**Implementing Procedure:**
Web Dynpro Java has introduced two properties in NWA to provide protection against reverse tabnabbing:

1. `RemoveOpenerBrowsingContext`
2. `OpenerAllowList`

These properties can be configured via NWA under **Application Modules > [web module] > Web Dynpro Properties > Select default > Check in WD Property Sheet Details**. They are also available as application properties in NWDS.

- **RemoveOpenerBrowsingContext**: Set to `true` by default to protect all applications against reverse tabnabbing. Setting it to `false` will unprotect all applications.
- **OpenerAllowList**: To unprotect specific applications, provide complete URLs (separated by commas). Accepted values are `*` and specific URLs.

Refer to [SAP Knowledge Base Article 3014875](https://me.sap.com/notes/3014875) for an overview of the corrections regarding Reverse Tabnabbing in SAP's UI Frameworks.

### CVSS

**CVSS Score:** 4.7  
**CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N](https://www.first.org/cvss/v3-0/specification-document)

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** Required (R)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** None (N)
- **Integrity Impact (I):** Low (L)
- **Availability Impact (A):** None (N)

### References

- [3014875 - Reverse Tabnabbing attack in SAP Netweaver AS ABAP and SAP UI5 applications on multiple platforms](https://me.sap.com/notes/3014875)

### Side Effects

This document is causing side effects:

- [3066613 - 500 internal server error when testing WSDL in Web Service Navigator and unable to use application specific RTN properties](https://me.sap.com/notes/0003066613)
- [3067569 - View not rendering in Webdynpro Perspective in NWDS](https://me.sap.com/notes/0003067569)

---

*Credits to [redrays.io](https://redrays.io) for support in providing this information.*