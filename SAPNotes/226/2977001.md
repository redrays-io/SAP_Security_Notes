2977001 - Reverse TabNabbing Vulnerability in SAP NetWeaver Application Server Java (Applications based on HTMLB for Java)

**Description**

### Symptom
Applications in *SAP NetWeaver Application Server Java*, which are based on *SAP HTMLB*, allow an attacker to redirect users to a malicious site due to Reverse Tabnabbing vulnerabilities.

Some well-known impacts of Reverse Tabnabbing vulnerability are:
- Phishing attacks
- Redirecting users to untrusted webpages containing malware or similar malicious exploits.

### Other Terms
Reverse Tabnabbing, Reverse Tab Nabbing, HTMLB, security, link, hyperlink, noopener, noreferrer

### Reason and Prerequisites
- HTMLB framework is used.
- Browsers are vulnerable to reverse tabnabbing attacks.

### Solution
By implementing this SAP Security Note, a default out-of-the-box protection is applied for all HTMLB applications.

**Implementing Procedure:**

*For NW 7.30, NW 7.31, NW 7.40, and NW 7.50:*
1. Log in to the NWA application.
2. Navigate to the **Configuration** tab.
3. Click on the **Infrastructure** tab.
4. Select **Java System Properties**.
5. Go to the **Application** tab in the second section.
6. Search for `tc~lm~itsam~htmlb~app` in the **Name** column filter and select the row.
7. Set the properties `removeOpenerbrowsingcontext` and `openerallowlist`.
8. Save the configuration and restart the J2EE engine.

*For NW 7.10 and NW 7.11:*
1. Log in to the Config Tool application by navigating to the path: `\\usr\\sap\\<SID>\\<System Number>\\j2ee\\configtool\\configtool.bat`
2. Navigate to **cluster-data** → **applications** → **sap.com**.
3. Search for an application named `tc~lm~itsam~htmlb~app` under sap.com.
4. Modify the properties `removeOpenerbrowsingcontext` and `openerallowlist` by entering the values in the custom value field.
5. Save the configuration and restart the J2EE server to apply the changes.

SAP Knowledge Base Article [3014875](https://me.sap.com/notes/3014875) contains an overview of the corrections regarding Reverse Tabnabbing in SAP's UI Frameworks.

**Attributes**
- **Externally Reported:** No

**CVSS**
- **Score:** 4.7
- **Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N
    - **Attack Vector (AV):** Network (N)
    - **Attack Complexity (AC):** Low (L)
    - **Privileges Required (PR):** None (N)
    - **User Interaction (UI):** Required (R)
    - **Scope (S):** Changed (C)
    - **Confidentiality Impact (C):** None (N)
    - **Integrity Impact (I):** Low (L)
    - **Availability Impact (A):** None (N)

**References**
- This document refers to [3014875 - Reverse Tabnabbing attack in SAP Netweaver AS ABAP and SAP UI5 applications on multiple platforms](https://me.sap.com/notes/3014875).

**Validity**
- **EP-BASIS:** Versions 7.10 to 7.11, 7.30, 7.31, 7.40, 7.50
- **LMNWAUIFRMRK:** Versions 7.10 to 7.11, 7.30, 7.31, 7.40, 7.50
- **FRAMEWORK-EXT:** Versions 7.30, 7.31, 7.40, 7.50
- **FRAMEWORK:** Versions 7.10 to 7.11

**Support Package Patches**
- **FRAMEWORK EXTENSIONS 7.50:**
    - [SP017 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001569&support_package=SP017&patch_level=000001)
    - [SP018 Patch 000002](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001569&support_package=SP018&patch_level=000002)
    - [SP019 Patch 000003](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001569&support_package=SP019&patch_level=000003)
    - [SP020 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001569&support_package=SP020&patch_level=000001)
    - [SP021 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001569&support_package=SP021&patch_level=000001)
    - [SP022 Patch 000000](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73554900100200001569&support_package=SP022&patch_level=000000)
    - [SP023 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=67838200100200019695&support_package=SP023&patch_level=000001)
    - [SP025 Patch 000004](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200004781&support_package=SP025&patch_level=000004)
    - [SP028 Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200014260&support_package=SP028&patch_level=000001)

**Credits**
*Supported by [Redrays](https://redrays.io).*