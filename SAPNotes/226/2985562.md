2985562 - [CVE-2021-33666] Cross-Site Scripting (XSS) in SAP Commerce Cloud

**Symptom**
-------------
When SAP Commerce Cloud hosts a JavaScript storefront, it is vulnerable to MIME sniffing, which could be used to facilitate an XSS attack or malware proliferation.

**Relevant Terms**
-------------------
MIME sniffing, X-Content-Type-Options, nosniff, HTTP header, [CVE-2021-33666](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33666)

**Reason and Prerequisites**
------------------------------
This MIME sniffing vulnerability only affects SAP Commerce Cloud environments that include a JavaScript storefront (in particular Spartacus).

Other web applications running in SAP Commerce Cloud are not affected, as they send appropriate `X-Content-Type-Options` headers at the application level. However, SAP Commerce Cloud operators must ensure not to override this header with an insecure value.

**Solution**
-------------
SAP Commerce Cloud addresses this vulnerability by sending an `X-Content-Type-Options` HTTP response header with the value `nosniff` for all requested resources of the JavaScript Storefront.

This remediation has been in place since version [2010](https://help.sap.com/viewer/329b2a5ce90d4554bdc86641331b1049/v2005/en-US/f7255e1ab64e46d0b83d9b906eaaea14.html#loio555c0045c15e4ebabfa211202f822820), released on October 17th, 2020.

**Manual Remediation Steps**
------------------------------
To ensure the remediation is effective, customers must [build](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/v2005/en-US/79763857d2264a189cb577fc90de0fea.html) and [deploy](https://help.sap.com/viewer/0fa6bcf4736c46f78c248512391eb467/v2005/en-US/72e126a98eb14b668709be9946070e5c.html) their SAP Commerce, including the JavaScript storefront. This process must be performed for each SAP Commerce Cloud environment individually.

For environments built and deployed since October 17th, 2020, no additional manual steps are required.

**CVSS**
---------
- **Score:** 4.7
- **Vector:** CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N

  - **Attack Vector (AV):** Network (N)
  - **Attack Complexity (AC):** High (H)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** Required (R)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** Low (L)
  - **Integrity Impact (I):** Low (L)
  - **Availability Impact (A):** None (N)

**Attributes**
---------------
- **Externally Reported:** Yes

**Download**
--------------
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000000819042021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002985562?language=en-US&token=E22730A0E51D61F9737A1A558980B14A)

*Credits to [redrays.io](https://redrays.io) for support to provided information.*