SAP Security Note 1611670 - Unauthorized changes to contents displayed in SEM_UPWB

**Description**
A vulnerability has been identified in the SAP Business Warehouse (BW) Planning and Simulation (BPS) module that allows a malicious user to manipulate the data displayed to other users without authorization. This is achieved through reflected cross-site scripting (XSS), potentially enabling attackers to steal authentication data and impersonate users, including those with administrative privileges.

**Symptom**
A malicious user can alter the data displayed for another user by manipulating BPS planning. This exploitation could grant access to sensitive authentication information, allowing the attacker to impersonate the victim and potentially compromise all data within the application if the victim has administrative rights.

**Reason and Prerequisites**
The vulnerability arises because the BPS planning module lacks adequate source code for securely outputting data via a web page, making it susceptible to reflected cross-site scripting. When a manipulated link is accessed, it can trigger the XSS, allowing the attacker to manipulate web page contents and steal session information.

**Solution**
1. **Ensure Basis Support Package Level**: Verify that your Basis Support Package level matches that of [Note 1582870](https://me.sap.com/notes/1582870). If not, implement the corrections from that note.
2. **Implement Note 1611670**: Apply this security note or import the relevant Support Package for your SAP BW version.

   **Support Package Details:**
   - **SAP NetWeaver BW 7.00**
     - Import Support Package 28 ([SAPKW70028](https://me.sap.com/supportpackage/SAPKW70028))
   - **SAP NetWeaver BW 7.01**
     - Import Support Package 11 ([SAPKW70111](https://me.sap.com/supportpackage/SAPKW70111))
   - **SAP NetWeaver BW 7.02**
     - Import Support Package 10 ([SAPKW70210](https://me.sap.com/supportpackage/SAPKW70210))
   - **SAP NetWeaver BW 7.11**
     - Import Support Package 8 ([SAPKW71108](https://me.sap.com/supportpackage/SAPKW71108))
   - **SAP NetWeaver BW 7.30**
     - Import Support Package 05 ([SAPKW73005](https://me.sap.com/supportpackage/SAPKW73005))

**Manual Actions**
After implementing the note, perform the following manual post-implementation steps for each system:

1. **Download Attachment Files**:
   - [000_CL_UPWC_APPLICATION_EXIT.txt](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000394792011&iv_version=0005&iv_guid=ADC8661EF64FD24E86D0C3EE9B260789)
   - [000_CL_UPWC_APPLICATION_MAINFRAME.txt](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000394792011&iv_version=0005&iv_guid=F1ECA0355D59B742AAB720DAE8CEDF74)

2. **Update Templates**:
   - In transaction SE38, execute the report `UPWB_TEMPLATE_EDITOR` with the parameters:
     - HTML Version: `000000`
     - Class/Interface: `CL_UPWC_APPLICATION`
     - Template Name: `EXIT`
   - Load the `000_CL_UPWC_APPLICATION_EXIT.txt` file.
   - Repeat the process for the `MAINFRAME` template using the corresponding file.

3. **Regenerate Web Interfaces**.

**References**
- [SAP Note 1582870 - ABAP XSS Escaping Support](https://me.sap.com/notes/1582870)

**Attachments**
- [000_CL_UPWC_APPLICATION_MAINFRAME.txt](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000394792011&iv_version=0005&iv_guid=9FC2E3DAFC18BB4C982B04B432920016)
- [000_CL_UPWC_APPLICATION_EXIT.txt](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000394792011&iv_version=0005&iv_guid=ADC8661EF64FD24E86D0C3EE9B260789)
- [300_CL_UPWC_APPLICATION_MAINFRAME.txt](https://me.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012006153200000394792011&iv_version=0005&iv_guid=F1ECA0355D59B742AAB720DAE8CEDF74)

**Support Package Information**
For detailed Support Package information and links, visit [SAP Support Portal](https://me.sap.com/supportpackage/).

**Credits**
Thanks to [Redrays](https://redrays.io) for supporting the information provided.