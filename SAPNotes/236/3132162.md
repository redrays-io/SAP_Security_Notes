3132162 - [CVE-2021-44228] Remote Code Execution vulnerability associated with Apache Log4j 2 component used in SAP BTP API Management (Tenant Cloning Tool)

**Title:** 3132162 - [CVE-2021-44228] Remote Code Execution Vulnerability Associated with Apache Log4j 2 in SAP BTP API Management (Tenant Cloning Tool)

**Type:** SAP Security Note  
**Priority:** HotNews  
**Status:** Released for Customer  
**Released On:** December 24, 2021  
**Component:** Occasional Platform User > SAP API Management > On Demand > Designtime

### Description

**Symptom**  
Log4j is a widely used open-source component for logging and tracing application events. SAP BTP API Management (Tenant Cloning Tool) uses a version of the open-source component Apache Log4j 2 which is vulnerable to remote code execution [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228), [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046), and [CVE-2021-45105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105).

**Reason and Prerequisites**  
SAP BTP API Management does not natively use the open-source library log4j2. However, if you are in the process of migrating your Neo tenant to the Cloud Foundry environment, you might be interacting with the on-premise component Tenant Cloning Tool, which references log4j version 2.13.3.

### Solution

A patch has been released for the Tenant Cloning Tool to eliminate the dependency on log4j 2.13.3.

- **Update Requirement:** If you are using a version of the Tenant Cloning Tool prior to **1.5.2**, you must update to the latest version **1.5.2**. This update addresses the critical vulnerabilities **CVE-2021-44228**, **CVE-2021-45046**, and **CVE-2021-45105** detected in the log4j2 library.

- **Log4j Update:** The Tenant Cloning Tool has been updated to use log4j version **2.17** in the latest Tenant Cloning Tool version **1.5.2**.

**Download Links:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001856862021)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003132162?language=en-US&token=B7E9DBA8005BAFCFE9CBF46F30829666)

**Additional Information:**  
Details about the Tenant Cloning Tool can be found in the [SAP Help Portal](https://help.sap.com/viewer/66d066d903c2473f81ec33acfe2ccdb4/Cloud/en-US/7abd887d54604e699543ef57c618c8d7.html). Customers can download the latest version of the patch using the link provided in the SAP Note.

### CVSS Details

**CVSS Score:** 10.0  
**CVSS Vector:** `CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H`

- **Attack Vector (AV):** Network (N)
- **Attack Complexity (AC):** Low (L)
- **Privileges Required (PR):** None (N)
- **User Interaction (UI):** None (N)
- **Scope (S):** Changed (C)
- **Confidentiality Impact (C):** High (H)
- **Integrity Impact (I):** High (H)
- **Availability Impact (A):** High (H)

### Recommendations

- **Immediate Action:** Update the Tenant Cloning Tool to version **1.5.2** to mitigate the vulnerabilities.
- **Verification:** Ensure that log4j has been updated to version **2.17**.
- **Monitoring:** Regularly check for new updates or patches related to SAP BTP API Management and associated components.

**Credits:** Thanks to [redrays.io](https://redrays.io) for support in providing this information.