3132204 - Update 1 to Security Note 3130521: [CVE-2021-44228] Remote Code Execution vulnerability associated with Apache Log4j 2 component used in Java Web Service Adapter of SAP NetWeaver Process Integration

## Description

**Symptom**

**UPDATE 11th January 2022**: The SAP security note [3135581](https://me.sap.com/notes/3135581) includes the corrections provided in this security note as well as [3130521](https://me.sap.com/notes/3130521) and [3133005](https://me.sap.com/notes/3133005).

**UPDATE 03rd January 2022**: This note has been re-released with updated CVSS information.

Java Web Service Adapter of SAP NetWeaver Process Integration uses a version of the Open Source component Apache Log4j which is vulnerable to [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046).

### Other Terms

Uncontrolled Resource consumption, Resource Exhaustion, [Apache Log4j Security Vulnerabilities](https://logging.apache.org/log4j/2.x/security.html), [CVE-2021-45046](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)

### Reason and Prerequisites

You are only affected by this vulnerability if you are running Java Web Service Adapter of Process Integration / Process Orchestration Release 7.50 SP20, SP21, or SP22. Or if you have installed partner code or use your own implementations that make use of Log4j. See KBA [3129883](https://me.sap.com/notes/3129883) on how to determine such usage. For an exploit, an attacker requires credentials to the Web Service endpoints.

## Solution

Deploy the Support Packages and Patches referenced by this SAP Security Note. This patch deploys version 2.16.0 of Apache Log4j to your system, fixing the Log4j remote code execution vulnerability reported in SAP Security Note [3130521](https://me.sap.com/notes/3130521). Workarounds are explained in this SAP Security Note as well. For actual information about Log4j vulnerabilities, refer to FAQ Note [3131436](https://me.sap.com/notes/3131436).

## Affected Components

- **Software Component**: BC-XI-CON-JWS
- **Component Path**: Basis Components > NetWeaver Process Integration (PI) > Connectivity > Java Web Service Adapter

## CVSS

**Score**: 8.5  
**Vector**: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/cvss-v3-0)

- **Attack Vector**: Network (N)
- **Attack Complexity**: High (H)
- **Privileges Required**: Low (L)
- **User Interaction**: None (N)
- **Scope**: Changed (C)
- **Confidentiality Impact**: High (H)
- **Integrity Impact**: High (H)
- **Availability Impact**: High (H)

## Support Packages and Patches

- **XI ADAPTER FRAMEWORK 7.50 SP020 Patch 000039**: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP020&patch_level=000039)
- **XI ADAPTER FRAMEWORK 7.50 SP021 Patch 000029**: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP021&patch_level=000029)
- **XI ADAPTER FRAMEWORK 7.50 SP022 Patch 000011**: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP022&patch_level=000011)
- **XI ADAPTER FRAMEWORK 7.50 SP023 Patch 000000**: [Download](https://me.sap.com/sap/support/swdc/notes?cvnr=73554900100200001663&support_package=SP023&patch_level=000000)

## References

- [SAP Security Note 3135581](https://me.sap.com/notes/3135581)
- [SAP Security Note 3130521](https://me.sap.com/notes/3130521)
- [SAP Security Note 3133005](https://me.sap.com/notes/3133005)
- [FAQ Apache Log4j vulnerability in Web Service Adapter of SAP NetWeaver Process Integration](https://me.sap.com/notes/3131436)

---

*Credits to [RedRays.io](https://redrays.io) for supporting the provision of this information.*