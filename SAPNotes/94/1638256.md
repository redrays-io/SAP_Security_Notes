1638256 - Unauth. usage of functions in SAF compilation application

### Symptom
A malicious user can trigger functionality in SAF BSP compilation applications without authentication and authorization.

### Other Terms
Cross-Site Request Forgery, XSRF, CSRF, CRM_EI_CMP_ADMN

### Reason and Prerequisites
SAF BSP application executes certain functions through referencing specific URLs. When an attacker tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the user. If present, the attacker may use a Cross Site Request Forgery attack to trigger the exploit, or use an approach in which a link to click is presented to the victim.

### Solution
1. **Refer to [Note 1520324](https://me.sap.com/notes/1520324) and [Note 1551982](https://me.sap.com/notes/1551982)** for additional information and instructions. The corrections from these notes are prerequisites for implementing this note.
2. **Implement the correction instructions of this note.** This will create the report `BSP_XSRF_PARAM_CRM_EI` (for CRM 5.0 and higher) or `BSP_XSRF_PARAM_CRM_EI_2` (for CRM 4.0) in your system. Please note that there is a manual pre-installation instruction for CRM 4.0 that needs to be executed.
3. **Execute the report** `BSP_XSRF_PARAM_CRM_EI` or `BSP_XSRF_PARAM_CRM_EI_2` and specify a corresponding transport request number when prompted. The report will activate the XSRF protection for the BSP applications adapted by this note.

### Actions
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009726082017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001638256?language=en-US&token=12364EAE11129856749DB7836E449346)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001638256)

### Validity
This note is applicable to the following software components and versions:
- **SAP_ABA**: 700
- **BBPCRM**: 400
- **WEBCUIF**: 700, 701, 730, 731, 746

### Support Package
Ensure you have the latest support packages installed for your software components:
- [BBPCRM 400 - SAPKU40018](https://me.sap.com/supportpackage/SAPKU40018)
- [WEBCUIF 700 - SAPK-70011INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70011INWEBCUIF)
- [SAP_ABA 700 - SAPKA70026](https://me.sap.com/supportpackage/SAPKA70026)
- [WEBCUIF 701 - SAPK-70107INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70107INWEBCUIF)
- [WEBCUIF 730 - SAPK-73003INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73003INWEBCUIF)
- [WEBCUIF 731 - SAPK-73102INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73102INWEBCUIF)

### Correction Instructions
Manual instructions are required for implementing changes, especially for CRM 4.0. Follow the detailed steps provided in the note to ensure proper implementation and activation of XSRF protection.

For more detailed information and step-by-step guidance, refer to the [full SAP Note 1638256](https://me.sap.com/notes/1638256).

*Credits to [RedRays](https://redrays.io) for support and provided information.*