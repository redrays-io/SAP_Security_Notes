SAP Security Note 1637384 - Potential Disclosure of Persisted Data in IS-R-FW

**Description**

**Symptom**
An attacker can exploit IS-R-FW and use specially crafted inputs to modify database commands, resulting in the retrieval of additional information persisted by the system.

**Other Terms**
- SQL injection
- Database
- IS-R-FW

**Reason and Prerequisites**
The problem is caused by an SQL injection vulnerability. The code composes an SQL statement that contains strings that can be altered by an attacker. The manipulated SQL statement can then be used to retrieve data from the database.

*Builds prior to v3.5.0 Build 803 will experience this problem.*

**Solution**
- **Fixed:** v3.5.0 Build 803

**Patch files required:**
- ASP pages under `web\virtual_dir`
- `Fraudwatch.jar`
- `cdl.jar`
- `CreateFraudwatchDBLogin.bat`

**Configuration changes required:**
- `cdl.properties`
- `Fraudwatch.properties`

**Resolution:**
Update to the build with the fix. All related ASP pages have been modified to validate URL parameters to block possible attacks. Database server error messages and unhandled runtime error messages have been removed.

**Download Links**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000017318272017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001637384?language=en-US&token=00D06897998F5D7BEA3F8E63CB7A3092)

For more details and to access additional resources, visit [SAP Support](https://me.sap.com/servicessupport/knowledge).

*Credits to [Redrays.io](https://redrays.io) for supporting the information provided.*