3355658 - [CVE-2023-31403] Improper Access Control vulnerability in SAP Business One product installation

**Symptom**
  
SAP Business One installation does not perform proper authentication and authorization checks for SMB shared folder. As a result, any malicious user can read and write to the SMB shared folder. Additionally, the files in the folder can be executed or used by the installation process, leading to considerable impact on confidentiality, integrity, and availability.

**Other Terms**

Broken Authentication, Missing Authentication, Improper Authentication Controls, Missing Access Controls, [CVE-2023-31403](https://www.cve.org/CVERecord?id=CVE-2023-31403)

**Reason and Prerequisites**

SAP Business One installation process allows anonymous users read and write-access to SMB shared folders. The impacted components are Crystal Report (CR) shared folder, Traditional Mobile app (attachment path), RSP (log folder logic), Job Service, and BAS (file upload folder).

**Solution**

We have modified the SMB shared folder permissions to only grant read and write access to authenticated and authorized users. Code changes have been made to accompany the permission changes. Furthermore, we have enforced strict access controls to maintain auditability and traceability of activities in the shared folder and also in the installation process in SAP Business One 10.0 SP2308 Security Hotfix1.

The fix will be applied automatically after you upgrade your current version to the latest version of SAP Business One 10.0 SP2308 Security Hotfix1. The patches can be found on the [SAP ONE Support Launchpad](https://launchpad.support.sap.com/#/softwarecenter).

For more details, please visit the FAQ section [here](https://me.sap.com/notes/3400236).

**CVSS**

- **CVSS Score:** 9.6
- **CVSS Vector:** CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  - **Attack Vector (AV):** Adjacent (A)
  - **Attack Complexity (AC):** Low (L)
  - **Privileges Required (PR):** None (N)
  - **User Interaction (UI):** None (N)
  - **Scope (S):** Changed (C)
  - **Confidentiality Impact (C):** High (H)
  - **Integrity Impact (I):** High (H)
  - **Availability Impact (A):** High (H)

**Affected Software Components**

- **Software Component:** B1_ON_HANA
  - **From:** 10.0
  - **To:** 10.0

**Support Package Patches**

- **Software Component Version:** SAP BUSINESS ONE 10.0
  - **Support Package:** SP000
  - **Patch Level:** 000000
  - **URL:** [Support Package Patch](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=73555000100200010200&support_package=SP000&patch_level=000000)

*Credits: Information supported by [RedRays.io](https://redrays.io).*