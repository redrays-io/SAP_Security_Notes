3371873 - Update 1 to Security Note 3324732: [CVE-2023-31405] Log Injection vulnerability in SAP NetWeaver AS for Java (Log Viewer)

# Description

### Symptom
This security note is an update to the security note [3324732](https://me.sap.com/notes/3324732). The fix provided in [3324732](https://me.sap.com/notes/3324732) was incomplete for the component ENGINEAPI 7.50.

- **Customers who have already implemented [3324732](https://me.sap.com/notes/3324732)** should also implement this security note for the correction provided in ENGINEAPI 7.50.
- **Customers who have not implemented any security notes** should implement both security notes to cover all three software components together.

**Issue:** Authentication with TOTPLoginModule is failing even when the correct passcode is entered. Traces show an exception with the login module stating: "Re-triggering second step of authentication due to missing passcode."

### Other Terms
- TOTPLoginModule
- OTP (One Time Password)
- Authentication
- AS Java
- [CVE-2023-31405](https://www.cve.org/CVERecord?id=CVE-2023-31405)

### Reason and Prerequisites
SAP Note [3324732](https://me.sap.com/notes/3324732) introduced issues in some scenarios with TOTPLoginModule.

# Solution
SAP Note [3324732](https://me.sap.com/notes/3324732) fixed the Log Injection vulnerability. The current SAP Security Note (3371873) addresses a regression with the TOTPLoginModule.

**Steps to Resolve:**
1. **Update AS Java** to a release or Support Package (SP) where the problem is fixed.
2. **Check the "Validity" and "Support Packages & Patches"** sections of this SAP Note for details and available patches.
3. **Avoid incompatibilities** by reviewing SAP Note [1974464](https://me.sap.com/notes/1974464) - Information on SCA Dependency Analysis for Java download objects.

# CVSS

**CVSS Score:** 5.3  
**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N

- **Attack Vector:** Network (N)
- **Attack Complexity:** Low (L)
- **Privileges Required:** None (N)
- **User Interaction:** None (N)
- **Scope:** Unchanged (U)
- **Confidentiality Impact:** None (N)
- **Integrity Impact:** Low (L)
- **Availability Impact:** None (N)

# Download Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001213882023)
- [PDF Version](https://me.sap.com/sap/support/sfm/notes/print/0003371873?language=en-US&token=080B0BCCD5B37C8E12A8048BA51E51FE)

# Additional Information

- **Released On:** 10.10.2023
- **Component:** ENGINEAPI 7.50
- **Priority:** Correction with medium priority
- **Recency:** New
- **Language:** English

# Credits
Credits to [redrays.io](https://redrays.io) for support to provided information.