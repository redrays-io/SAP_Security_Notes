[CVE-2023-49058] Directory Traversal vulnerability in SAP Master Data Governance

**Symptom**

The SAP Master Data Governance (MDG) File Upload application allows an attacker to exploit insufficient validation of path information provided by users. Characters representing traversal to the parent directory are passed through to the file APIs, resulting in a low impact on confidentiality.

**Other Terms**

- Path traversal
- USMD_FILE_UPLOAD
- Back-End report USMD_DATA_TRANSFER_BACKEND
- Directory climbing
- [CVE-2023-49058](https://me.sap.com/notes/3363690)

**Solution**

1. **Apply Support Packages and Patches**
   - Implement the Support Packages and Patches referenced in [SAP Note 3363690](https://me.sap.com/notes/3363690).

2. **Configure Logical File Paths**
   - Create physical directory paths in the file system.
   - Use the `FILE` transaction to map physical directories to logical names.
   - Maintain the Logical File Names in the File Upload view as the source for files to be imported.
   - Ensure file names in the application follow the format: `<logical file path>\<filename>`.

3. **Update Back-End Reports**
   - Apply the same logical file path configurations to Back-End report `USMD_DATA_TRANSFER_BACKEND`.

4. **Restrict File Upload Options**
   - Disable the option to upload data via File Path in the File Upload application.
   - Require users to enter logical file names instead.

**Manual Activities**

Execute the following manual steps in each system where the note is applied:

1. **Create Table USMD_FILEPATH**
   - Enter transaction code `SE11`.
   - Create table `USMD_FILEPATH` with the specified fields and configurations.
   - Activate the table.

2. **Create View V_USMD_FILEPATH**
   - Enter transaction code `SE11`.
   - Create view `V_USMD_FILEPATH` based on the `USMD_FILEPATH` table.
   - Configure the necessary relationships and activate the view.

3. **Create Message USMD6592**
   - Use transaction `SE91` to create message `USMD6592` with the text 'Directory &1 is not valid'.

4. **Document Data Element USMD_FNAME**
   - Enter transaction code `SE11`.
   - Document the data element `USMD_FNAME` with appropriate usage instructions.

5. **Configure Table Maintenance Generator**
   - In transaction `SE11`, navigate to the view `V_USMD_FILEPATH`.
   - Use Utilities > Table Maintenance Generator to set up maintenance parameters.
   - Enter Authorization Group `&NC&` and Function Group `USMD6_VIEW`.
   - Activate the generator.

**CVSS Score**

- **Score:** 3.5
- **Vector:** CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N

**Affected Software Components**

- **MDG_FND** (Releases 731 to 808)
- **SAP_BS_FND** (Release 702)

**References**

- [SAP Note 3363690 - Directory Traversal vulnerability in SAP Master Data Governance](https://me.sap.com/notes/3363690)

**Credits**

Credits to [https://redrays.io](https://redrays.io) for support in providing this information.