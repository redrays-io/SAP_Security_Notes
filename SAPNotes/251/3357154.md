3357154 - [CVE-2023-40310] Missing XML Validation vulnerability in SAP PowerDesigner Client (BPMN2 import)

## Description

SAP PowerDesigner Client does not sufficiently validate BPMN2 XML documents imported from an untrusted source. As a result, URLs of external entities in BPMN2 files, although not used, would be accessed during import. A successful attack could impact the availability of SAP PowerDesigner Client.

**CVE-2023-40310**

## Severity

- **CVSS Score:** 6.5
- **CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H

## Solution

Upgrade to SAP PowerDesigner Client and Proxy version 16.7 SP07, which includes:

- **XML Pre-processor Fix:** Securely configured by default to disallow external entities in BPMN2 input documents.
- **BPMN2 Import DTD Processing Configurations:** Includes white-listing of known trusted sources. Refer to the default `bpmn2config.xml` configuration file.

**Workaround:**

As a temporary fix, edit untrusted BPMN2 files to remove external entity markups before importing. This workaround should be assessed for applicability within your SAP landscape. SAP strongly recommends applying the corrections outlined in the security note as a permanent solution.

## Affected Components

- **Component:** BC-SYB-PD (Basis Components > Sybase Products > PowerDesigner)

## References

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001213842023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003357154?language=en-US&token=46E7B6D3EE085943A6DBE403CA0942F8)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0003357154)

## Additional Information

- **Released On:** 10.10.2023
- **Priority:** Correction with medium priority
- **Status:** Released for Customer

## Available Languages

- [Deutsch](https://me.sap.com/notes/0003357154/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0003357154/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003357154/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003357154/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003357154/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003357154/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003357154/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003357154/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003357154/3)

## Side Effects

No side effects reported for this security note.

## Credits

Credits to [redrays.io](https://redrays.io) for support to provided information.