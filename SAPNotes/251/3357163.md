3357163 - [CVE-2023-40621] Code Injection vulnerability in SAP PowerDesigner Client

---

### **Symptom**

SAP PowerDesigner Client allows an unauthenticated attacker to inject VBScript code into a document. If an unsuspecting user opens the malicious document, the injected script is executed by the application on behalf of the user. Although the application has security options to disable or prompt users before executing untrusted scripts, these settings are not enabled by default.

### **Reason and Prerequisites**

- **Security Level Not Set:** The PowerDesigner user has not configured the "Security Level" to a secure setting like "Prompt to Run" or "Block".
- **Untrusted Document:** The user loads a model document obtained from an untrusted source.
- **Malicious VBScript:** The model contains malicious VBScript code.

### **Solution**

Upgrade to **SAP PowerDesigner Client version 16.7 SP07** to address this vulnerability. This update includes:

- **Enhanced Security:** The default security level is raised to "Prompt To Run".

### **Workaround**

**Note:** Before applying the workaround, assess its applicability to your SAP landscape. This is a temporary fix and should be replaced with the recommended solution as soon as possible.

1. **Manual Configuration:**
   - Each user should manually set the security level to "Prompt to Run" or "Block".

2. **Enforce via Registry:**
   - Apply the following registry settings to enforce the default security level for all users on a machine:

   ```registry
   Windows Registry Editor Version 5.00

   [HKEY_LOCAL_MACHINE\SOFTWARE\Sybase\PowerDesigner 16\General]
   "ScriptTrustabilityCheckLevel"="Prompt"
   ```

### **CVSS Details**

- **CVSS Score:** 6.3
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L](https://www.cve.org/CVERecord?id=CVE-2023-40621)

| Metric                  | Value         |
|-------------------------|---------------|
| **Attack Vector (AV)**  | Network (N)   |
| **Attack Complexity (AC)** | Low (L)     |
| **Privileges Required (PR)** | None (N) |
| **User Interaction (UI)** | Required (R) |
| **Scope (S)**           | Unchanged (U) |
| **Confidentiality Impact (C)** | Low (L) |
| **Integrity Impact (I)** | Low (L)       |
| **Availability Impact (A)** | Low (L)     |

### **Additional Information**

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000001089072023](https://notesdownloads.sap.com/note/0040000001089072023)
- **PDF Version:** [https://userapps.support.sap.com/sap/support/sfm/notes/print/0003357163?language=en-US&token=C716981A8BD5F0CE3A04B8617C14C47D](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003357163?language=en-US&token=C716981A8BD5F0CE3A04B8617C14C47D)
- **Edit Note:** [https://me.sap.com/sap/support/notes/edit/0003357163](https://me.sap.com/sap/support/notes/edit/0003357163)

---

_Thanks to [redrays.io](https://redrays.io) for supporting the information provided._