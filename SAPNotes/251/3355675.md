3355675 - [CVE-2023-41368] Insecure Direct Object Reference (IDOR) vulnerability in SAP S/4HANA (Manage checkbook apps)

## Description

### Symptom
The OData service in the Manage Checkbooks application of SAP S/4HANA allows an attacker with high privileges to change the checkbook name by simulating an update OData call, causing partial impact on the integrity.

### Other Terms
- Manage Checkbooks
- F1577
- [CVE-2023-41368](https://www.cve.org/CVERecord?id=CVE-2023-41368)

## Impact
An attacker with high privileges can modify non-editable fields in the Manage Checkbooks application, potentially compromising the integrity of checkbook data.

## Solution
Validation has been added to ensure that users cannot change non-editable fields. To address this vulnerability, apply the corresponding support package or implement the correction instructions provided in this note.

## CVSS Details
- **Score:** 2.7
- **Vector:** `CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N`

  | Metric               | Value               |
  |----------------------|---------------------|
  | **Attack Vector (AV)**        | Network (N)          |
  | **Attack Complexity (AC)**    | Low (L)              |
  | **Privileges Required (PR)**  | High (H)             |
  | **User Interaction (UI)**     | None (N)             |
  | **Scope (S)**                 | Unchanged (U)        |
  | **Confidentiality (C)**       | None (N)             |
  | **Integrity (I)**             | Low (L)              |
  | **Availability (A)**          | None (N)             |

## Affected Software Components
- **S4CORE** versions 102 to 107

## Support Packages
- [S4CORE 102 - SAPK-10213INS4CORE](https://me.sap.com/supportpackage/SAPK-10213INS4CORE)
- [S4CORE 103 - SAPK-10311INS4CORE](https://me.sap.com/supportpackage/SAPK-10311INS4CORE)
- [S4CORE 104 - SAPK-10409INS4CORE](https://me.sap.com/supportpackage/SAPK-10409INS4CORE)
- [S4CORE 105 - SAPK-10507INS4CORE](https://me.sap.com/supportpackage/SAPK-10507INS4CORE)
- [S4CORE 106 - SAPK-10605INS4CORE](https://me.sap.com/supportpackage/SAPK-10605INS4CORE)
- [S4CORE 107 - SAPK-10703INS4CORE](https://me.sap.com/supportpackage/SAPK-10703INS4CORE)

## Correction Instructions
Implement the correction instructions available [here](https://me.sap.com/corrins/0003355675/19773).

## Prerequisites
Ensure the following SAP Notes are applied:

1. [2807257](https://me.sap.com/notes/2807257) - F1577 - Manage Checkbooks - 13 length check number and checkbook split checks
2. [3216161](https://me.sap.com/notes/3216161) - [CVE-2022-32248] Missing Input Validation in Manage Checkbooks component of SAP S/4HANA

## References
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000001089062023)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0003355675?language=en-US&token=8F50347A77034E5CA07106288EF117C0)

---

*Credits to [Redrays](https://redrays.io) for support and providing the information.*