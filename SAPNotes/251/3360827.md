3360827 - [CVE-2024-24740] Information Disclosure vulnerability in SAP NetWeaver Application Server ABAP (SAP Kernel)

## Symptom

SAP NetWeaver Application Server (ABAP) under certain conditions allows an attacker to access information which could otherwise be restricted, resulting in low impact on confidentiality of the application and no impact on integrity and availability of the application.

## Other Terms

Information Exposure, Information Leak, [CVE-2024-24740](https://www.cve.org/CVERecord?id=CVE-2024-24740)

## Solution

The vulnerable HTTP endpoints, which leaked information, were removed.

**Important:** If there is no entry in the section Support Package Patches with the patch number for the desired kernel release yet, please re-check this SAP note at a later point in time. In this case, the patch is not yet available for download and still in production or validation. The patch number will be added automatically once the corresponding patch is available on the [SAP Support Portal](https://me.sap.com/). You can subscribe to a SAP note to get informed when it is updated.

To resolve this issue please do the following:

1. **Determine the patch number** of the SAPEXE SAR package with the highest patch number for your kernel version on the [SAP Support Portal](https://me.sap.com/). If the SAPEXE patch number is higher than or equal to the highest patch level number you see in the section Support Package Patches of this SAP note for your SAP Kernel version, you should download and install the SAPEXE SAR package.

2. **Otherwise you have the following options:**
   
   - If the system runs with the latest 789, 785, 777, 754, or 753 stack kernel, the recommended method is to apply the [SAPWEBGUI.SAR](https://me.sap.com/notes/2412840) package without updating the full SAP Kernel. For details about SAPWEBGUI.SAR, please read [SAP note 2412840](https://me.sap.com/notes/2412840).
   
   - If the system does not run with the latest 789, 785, 777, 754, or 753 stack kernel or runs with SAP Kernel 722, download and install the most recent DW.SAR archive.

Once the section Support Package Patches below in this note contains the SAP Kernel patch level of the release you are interested in, you can find up-to-date information about the status of the patch delivery in the following SAP notes:

- **SAP Kernel 789 (S/4HANA 2022, 2021, and 2020):** [3211073](https://me.sap.com/notes/3211073)
- **SAP Kernel 785 (S/4HANA 2021 and 2020):** [3065813](https://me.sap.com/notes/3065813)
- **SAP Kernel 777 (S/4HANA 1809 and 1909):** [2791294](https://me.sap.com/notes/2791294)
- **SAP Kernel 754 (S/4HANA 1709 and 1610):** [3292397](https://me.sap.com/notes/3292397)
- **SAP Kernel 753 (S/4HANA 1709 and 1610):** [2474329](https://me.sap.com/notes/2474329)
- **SAP Kernel 722:** [2198998](https://me.sap.com/notes/2198998)

### FAQ:

**Expected delivery dates of SAP Kernel patches**

- SAP Kernel patches are usually delivered weekly or bi-weekly on Friday depending on the release. From the patch level of the latest delivered patch, you can roughly conclude when the patch you need will become available.

**Downloading SAP Kernel patches**

- All patches are available in the [Software Downloads](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019167&V=MAINT) section on the SAP Support Portal. Detailed information on the exact location of the patches can be found in [SAP note 563161](https://me.sap.com/notes/563161). [SAP Note 330793](https://me.sap.com/notes/330793) explains how to download patches from the SAP Support Portal.

**Installation of SAP Kernel patches**

- [SAP note 19466](https://me.sap.com/notes/19466) explains how to install SAP Kernel patches.

**SAP Kernel deployment strategy**

- [Update Strategy for the Kernel of the Application Server ABAP in On Premise Landscapes](https://me.sap.com/deployment-strategies-kernel-abap.pdf)

## CVSS

**CVSS Score:** 5.3

**CVSS Vector:** `CVSS:/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`

| Key                       | Value             |
|---------------------------|-------------------|
| Attack Vector (AV)        | Network (N)       |
| Attack Complexity (AC)    | Low (L)           |
| Privileges Required (PR)  | None (N)          |
| User Interaction (UI)     | None (N)          |
| Scope (S)                 | Unchanged (U)     |
| Confidentiality Impact (C)| Low (L)           |
| Integrity Impact (I)      | None (N)          |
| Availability Impact (A)   | None (N)          |

## Attributes

| Key                  | Value                                                                                          |
|----------------------|------------------------------------------------------------------------------------------------|
| Other Components     | Basis Components > Frontend Services (SAP Note 1322184) > SAP GUI for HTML (BC-FES-WGU)        |
| Externally Reported  | Yes                                                                                            |

## Validity

| Software Component        | From | To   |
|---------------------------|------|------|
| KRNL64UC                  | 7.53 | 7.53 |
| KERNEL                    | 7.53 | 7.53 |
| KERNEL                    | 7.77 | 7.77 |
| KERNEL                    | 7.85 | 7.85 |
| KERNEL                    | 7.89 | 7.89 |
| KERNEL                    | 7.54 | 7.54 |
| KERNEL                    | 7.93 | 7.93 |
| KERNEL                    | 7.94 | 7.94 |

## Support Package Patches

| Software Component Version     | Support Package | Patch Level | URL                                                                                                                                                                           |
|--------------------------------|-----------------|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SAP KERNEL 7.54 64-BIT         | SP218           | 000218      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019167&V=MAINT) |
| SAP KERNEL 7.54 64-BIT UNICODE | SP218           | 000218      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200019168&V=MAINT) |
| SAP KERNEL 7.77 64-BIT UNICODE | SP613           | 000613      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200010526&V=MAINT) |
| SAP KERNEL 7.53 64-BIT UNICODE | SP1222          | 001222      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200005858&V=MAINT) |
| SAP KERNEL 7.53 64-BIT         | SP1222          | 001222      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200006207&V=MAINT) |
| SAP KERNEL 7.94 64-BIT UNICODE | SP002           | 000002      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200019774&V=MAINT) |
| SAP KERNEL 7.85 64-BIT UNICODE | SP311           | 000311      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73554900100200013971&V=MAINT) |
| SAP KERNEL 7.93 64-BIT UNICODE | SP014           | 000014      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200018813&V=MAINT) |
| SAP KERNEL 7.89 64-BIT UNICODE | SP210           | 000210      | [Link](https://me.sap.com/softwarecenter/template/products/_APP=00200682500000001943&_EVENT=DISPHIER&HEADER=Y&FUNCTIONBAR=N&EVENT=TREE&NE=NAVIGATE&ENR=73555000100200015809&V=MAINT) |

Credits to [https://redrays.io](https://redrays.io) for support to provided information.