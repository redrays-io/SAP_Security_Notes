3369680 - [CVE-2023-41369] External Entity Loop vulnerability in SAP S/4HANA (Create Single Payment application)

### Header Data
- **SAP Note/KBA:** 3369680
- **Type:** SAP Security Note
- **Version:** 8
- **Recency:** New
- **Language:** English
- **Master Language:** English
- **Category:** Program error
- **Priority:** Correction with low priority
- **Status:** Released for Customer
- **Released On:** 12.09.2023
- **Component:** FI-FIO-AP
- **Component Text:** Financial Accounting > Fiori UI for Financial Accounting > Fiori UI for Accounts Payable

### Symptom
The Create Single Payment application of SAP S/4HANA allows an authenticated attacker to upload the XML file as an attachment. When clicked on the XML file in the attachment section, the file gets opened in the browser to cause the entity loops to slow down the browser.

### Other Terms
XXE, XML input parsing, F0743, Create Single Payment, [CVE-2023-41369](https://www.cve.org/CVERecord?id=CVE-2023-41369)

### Reason and Prerequisites
Unrestricted XML file upload in the attachment section.

### Solution
This SAP Security Note implements that the file is downloaded to the local file system instead of getting opened in the browser when clicking the file in the attachment section.

Apply the Correction Instructions or upgrade to the corresponding [Support Packages](https://me.sap.com/supportpackage/SAPK-10213INS4CORE) referenced in this Security Note.

### Support Package
| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| S4CORE 102                 | SAPK-10213INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10213INS4CORE) |
| S4CORE 103                 | SAPK-10311INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10311INS4CORE) |
| S4CORE 104                 | SAPK-10409INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10409INS4CORE) |
| S4CORE 105                 | SAPK-10507INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10507INS4CORE) |
| S4CORE 106                 | SAPK-10605INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10605INS4CORE) |
| S4CORE 107                 | SAPK-10703INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10703INS4CORE) |
| S4CORE 108                 | SAPK-10801INS4CORE | [Link](https://me.sap.com/supportpackage/SAPK-10801INS4CORE) |

### CVSS
- **CVSS Score:** 3.5
- **CVSS Vector:** [CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:L)
  - **Attack Vector:** Network (N)
  - **Attack Complexity:** Low (L)
  - **Privileges Required:** Low (L)
  - **User Interaction:** Required (R)
  - **Scope:** Unchanged (U)
  - **Confidentiality Impact:** None (N)
  - **Integrity Impact:** None (N)
  - **Availability Impact:** Low (L)

### Available Languages
- [Deutsch](https://me.sap.com/notes/0003369680/D)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0003369680/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0003369680/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0003369680/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0003369680/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0003369680/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0003369680/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0003369680/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0003369680/3)

### References
- **Prerequisites:**
  - [3112928](https://me.sap.com/notes/3112928) - [CVE-2022-22531] Multiple vulnerabilities in F0743 Create Single Payment application of SAP S/4HANA (Component: FI-FIO-AP)
  
### Correction Instructions
Apply the following [Correction Instructions](https://me.sap.com/corrins/0003369680/19773) for the S4CORE component.

---

*Credits to [Red Rays](https://redrays.io) for supporting the provision of this information.*