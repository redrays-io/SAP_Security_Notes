SAP Security Note 1422273 - Unauthorized modification of displayed content in BSP

## Description

**Symptom**  
The execution of a BSP application can be misused by a malicious user to obtain authentication information of other legitimate users.

**Other Terms**  
Security update, cross-site scripting, cross-domain attack, BSP, Business Server Pages, XSS, CSS

**Reason and Prerequisites**  
The vulnerability is due to the missing encoding of the input parameters. This results in possibilities of attack by cross-site scripting or by cross-domain redirection.

- **Cross-site scripting** can be used to steal authentication or session information, allowing an attacker to impersonate another user.
- **Cross-domain redirection** enables a malicious user to redirect to a page of their choice while appearing as a legitimate BSP application.
  
The relevant ICF service was deleted and cannot be removed via correction instructions. As a result, the services are no longer available from the specified Support Packages.

## Solution

Import the relevant Support Package or perform the following manual steps:

1. **Delete the class CL_BSP_ICF**
   - Use transaction SE80.
   - Select "Class / Interface" and enter `CL_BSP_ICF`.
   - Enter edit mode by selecting `Class → Display ↔ Edit`.
   - Deactivate the Modification Assistant via `Edit → Modification Operations → Switch Off Assistant` if not already deactivated.
   - Delete the class from the context menu.

2. **Delete the BSP application ICF**
   - Use transaction SE80.
   - Select "BSP Application" and enter `ICF`.
   - Delete the object `ICF` from the context menu and confirm.

3. **Delete the BSP application BSP_VERI**
   - Use transaction SE80.
   - Select "BSP Application" and enter `BSP_VERI`.
   - Delete the object `BSP_VERI` from the context menu and confirm.

4. **Delete the ICF services**
   - Use transaction SICF.
   - Delete the services `/sap/bc/bsp/sap/bsp_veri` and `/sap/bc/bsp/sap/icf`.

For more detailed instructions, refer to the [Solution](https://me.sap.com/notes/0001422273/Solution).

## Affected Components

- **Component**: [Internet Communication Framework](https://me.sap.com/servicessupport/knowledge)

## Support Packages

- [SAP_BASIS 640 - SAPKB64026](https://me.sap.com/supportpackage/SAPKB64026)
- [SAP_BASIS 700 - SAPKB70022](https://me.sap.com/supportpackage/SAPKB70022)
- [SAP_BASIS 701 - SAPKB70107](https://me.sap.com/supportpackage/SAPKB70107)
- [SAP_BASIS 702 - SAPKB70203](https://me.sap.com/supportpackage/SAPKB70203)
- [SAP_BASIS 710 - SAPKB71010](https://me.sap.com/supportpackage/SAPKB71010)
- [SAP_BASIS 711 - SAPKB71105](https://me.sap.com/supportpackage/SAPKB71105)
- [SAP_BASIS 720 - SAPKB72003](https://me.sap.com/supportpackage/SAPKB72003)

## References

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016950592017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001422273?language=en-US&token=D2A99029DF302E6A2043B3D2B401D600)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001422273/E/diff)

---

Credits: Information supported by [redrays.io](https://redrays.io)