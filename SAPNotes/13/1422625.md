1422625 - Possible disclosure of saved destination data

**Description**

An attacker can make specific entries to ensure a report outputs data for any destination (for example, internal destinations) and not only for the destinations of type 3 that are intended in the report (ABAP connections) and T (TCP/IP connections).

**Other Terms**

- SQL injection
- Database
- Destination

**Reason and Prerequisites**

The cause of the problem is an SQL injection vulnerability. In the source code, an SQL statement is composed of strings. In this case, an attacker can obtain control of the contents of a substring. Therefore, the attacker can manipulate the resulting entire SQL statement and execute it with the rights of the database user who is logged on.

In this case, the attacker can display the data of all destinations, but not the passwords of the logon users that are entered in the connection data. The attacker cannot create new destinations or change or delete existing destinations. The reading of destinations still always requires (including those read without permission) the authorization `S_RFC_ADM`.

**Solution**

Import the relevant Support Package. In the corrected source code, the dynamic WHERE clause has been removed and replaced with a case distinction for the SQL statement that is used. This prevents the SQL injection.

**Affected Components**

- **Component:** Basis Components > Middleware > RFC (BC-MID-RFC)
- **Software Versions:**
  - SAP_BASIS 620 to 640
  - SAP_BASIS 700 to 702
  - SAP_BASIS 710 to 720

**Support Package Fixes**

- [SAPKB62068](https://me.sap.com/supportpackage/SAPKB62068) for SAP_BASIS 620
- [SAPKB64026](https://me.sap.com/supportpackage/SAPKB64026) for SAP_BASIS 640
- [SAPKB70022](https://me.sap.com/supportpackage/SAPKB70022) for SAP_BASIS 700
- [SAPKB70107](https://me.sap.com/supportpackage/SAPKB70107) for SAP_BASIS 701
- [SAPKB70203](https://me.sap.com/supportpackage/SAPKB70203) for SAP_BASIS 702
- [SAPKB71010](https://me.sap.com/supportpackage/SAPKB71010) for SAP_BASIS 710
- [SAPKB71105](https://me.sap.com/supportpackage/SAPKB71105) for SAP_BASIS 711
- [SAPKB72003](https://me.sap.com/supportpackage/SAPKB72003) for SAP_BASIS 720

**Downloads**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000016951142017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001422625?language=en-US&token=EE1DED5818E0453C18E922A0A5227F91)

**Related Links**

- [Show Changes](https://me.sap.com/notesLatestChanges/0001422625/E/diff)

**Credits**

Information supported by [redrays.io](https://redrays.io).