1519463 - Unauthorized usage of application functionality in WCL

**Overview**

- **SAP Note Number:** 1519463
- **Type:** SAP Security Note
- **Version:** 3
- **Release Status:** Released for Customer
- **Released On:** 20.10.2011
- **Component:** Supply Chain Management > Event Management > Event Manager > Information System and Queries (SCM-EM-MGR-ISQ)
- **Category:** Program error
- **Priority:** Correction with high priority
- **Language:** English

**Description**

**Symptom**

This security note has been updated.  For more detailed information, see [Security Note 1640676](https://me.sap.com/notes/1640676).

An unauthorized user can trigger functionality in the Web Communication Layer for Event Management (WCL) on behalf of an unsuspecting authorized user.

**Other Terms**

Cross-Site Request Forgery, XSRF, CSRF, xsrfid, security, WCL

**Reason and Prerequisites**

WCL (which contains Servlets/JSP pages) executes state-changing functionality via referencing URLs. In certain scenarios, it is possible for an unauthorized and unauthenticated third party to trigger this functionality on behalf of an authorized authenticated user without the latter's knowledge and/or consent.

**Solution**

XSRF attacks have to be addressed inside web applications. These applications must ensure that for state-changing operations they are not relying only on credentials or tokens that are automatically submitted by browsers. A common approach is including a special token in each request, which is associated with the user session and is valid only for the session lifetime.

The SAP NetWeaver Application Server Java (AS Java) has been enhanced with the XSRF Protection Framework. You can secure your web application with the token-based approach by adopting the framework. This note contains the adoption of the XSRF Protection Framework for WCL.

SAP's XSRF Protection Framework is available for specific versions of SAP NetWeaver.  Please refer to [Note 1450166](https://me.sap.com/notes/1450166) for details regarding availability. In order to enable XSRF protection for WCL, please apply the above-mentioned Note prior to undertaking the steps highlighted in this Note. Furthermore, please refer to the SAP XSRF Protection Guide in [Note 1450166](https://me.sap.com/notes/1450166) to gain an overall understanding of the XSRF protection procedure.

Once you have reviewed the above-mentioned document, please proceed with the detailed steps specific to WCL.

**HOW TO ADAPT WCL IN A STANDARD SCENARIO:**

The solution is implemented in the support package patch levels listed below.

1. Download the relevant SP/patch for your release from the SAP Service Marketplace and deploy it on your AS Java.

**Reminder:** Additionally, you will need to implement NetWeaver patches. You can find the specifics in [Note 1450166](https://me.sap.com/notes/1450166). Please note that those NetWeaver patches are a prerequisite to implementing the aforementioned WCL support packages.

**Affected Components**

- Supply Chain Management > Event Management > Event Manager (SCM-EM-MGR)

**Support Package Patches**

- **SAP EM-WCL 7.0**
  - [SP006](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200009614&support_package=SP006&patch_level=000000)
- **SAP EM-WCL 5.1**
  - [SP016](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200314690200005257&support_package=SP016&patch_level=000000)
- **SAP SCM WCL 5.0**
  - [SP018, Patch 000001](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200007437&support_package=SP018&patch_level=000001)
- **SAP SCM WCL 4.1**
  - [SP021](https://userapps.support.sap.com/sap/support/swdc/notes?cvnr=01200615320200006735&support_package=SP021&patch_level=000000)

**References**

This document refers to:
- [1640676 - Update no. 1 for security note 1519463](https://me.sap.com/notes/1640676)
- [1634996 - SAP EM WCL 7.0: Web Communication Layer Support Package 06](https://me.sap.com/notes/1634996)
- [1606382 - SCM 4.1 Web communication layer Support Package 21](https://me.sap.com/notes/1606382)
- [1450166 - Unauthorized usage of application functionality](https://me.sap.com/notes/1450166)

This document is referenced by:
- [1634996 - SAP EM WCL 7.0: Web Communication Layer Support Package 06](https://me.sap.com/notes/1634996)
- [1606382 - SCM 4.1 Web communication layer Support Package 21](https://me.sap.com/notes/1606382)

**Download for SNOTE**

[Download for SNOTE](https://notesdownloads.sap.com/note/0040000017113482017)

**PDF Version**

[PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001519463?language=en-US&token=FD2CDA392EAC02E70AA3399F2C7894AC)

Credits to [redrays.io](https://redrays.io) for support to provided information.