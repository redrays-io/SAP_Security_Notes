SAP Security Note 1520462 - Unauthorized call of operating system command

**SAP Security Note 1520462 - Unauthorized call of operating system command**

### Symptom

A malicious user can execute an operating system command with a parameter string by calling a certain ABAP function because the function does not perform any authorization checks.

In SAP terminology, these calls are referred to as 'external programs' or 'external commands' (See [Note 677435](https://me.sap.com/notes/677435)).

### Other Terms

External programs, external commands

### Reason and Prerequisites

This is caused by a design error.

A malicious user who is very familiar with SAP source code may recognize this security hole.

### Solution

Import the Support Package or implement the correction instructions.

For technical reasons, you cannot extend the start of the validity of the correction instructions to older Support Packages. However, the problem described in this note exists from the outset in all releases.

When you implement these corrections, the authorization check that must be performed for external commands and external programs is now also performed in the aforementioned function.

(For more information about the authorizations that are checked, see [Note 859104](https://me.sap.com/notes/859104) and [Note 854060](https://me.sap.com/notes/854060)).

You will not notice any changes to the system behavior, apart from the following very unlikely exception:

Now, when you start an external program as a step of a background job, the system also checks whether the step user has system administrator authorization. Therefore, it checks the authorization **S_RZL_ADM** (field **ACTVT** = 01).

If the step user does not have this authorization, the job terminates with a relevant message in the job log and the external program is not executed.

For security reasons, the new authorization check is imperative.

The new check will probably have no effect for your existing batch jobs because the step user is always the job scheduler by default, and an external program can only be scheduled as a job step if the job scheduler has system administrator authorization.

However, if there are batch jobs in your system with the following properties:

- the job has an external program as the job step  
**AND**  
- the step user of this step is not the job scheduler  
**AND**  
- this step user has no system administrator authorization

these jobs will terminate after you implement these correction instructions.

To identify these jobs, the program **Z_FIND_JOBS_WITH_EXTPROG** is attached to this note.

Execute this program. If the program detects jobs with the properties mentioned above, change the step user for these jobs, or assign system administrator authorization to the step user.

After you have implemented the corrections, you can no longer create background jobs with the aforementioned properties.

### Attachments

- [Z_FIND_JOBS_WITH_EXTPROG.txt](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000493412010&iv_version=0005&iv_guid=D4FEFE6953E489438293A056C54ABE6B)

### References

**This document refers to:**

- [Note 888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

**This document is referenced by:**

- [Note 888889 - Automatic checks for security notes using RSECNOTE (outdated)](https://me.sap.com/notes/888889)

### Validity

**Software Components:**

| Software Component | From | To  |
|--------------------|------|-----|
| SAP_APPL           | 40B  | 40B |
| SAP_APPL           | 45B  | 45B |
| SAP_BASIS          | 46B  | 46D |
| SAP_BASIS          | 610  | 640 |
| SAP_BASIS          | 700  | 702 |
| SAP_BASIS          | 710  | 730 |

### Support Package

| Software Component Version | Support Package | URL |
|----------------------------|-----------------|-----|
| SAP_APPL 40B               | SAPKH40B89      | [Link](https://me.sap.com/supportpackage/SAPKH40B89) |
| SAP_APPL 45B               | SAPKH45B67      | [Link](https://me.sap.com/supportpackage/SAPKH45B67) |
| SAP_BASIS 46B              | SAPKB46B62      | [Link](https://me.sap.com/supportpackage/SAPKB46B62) |
| SAP_BASIS 46C              | SAPKB46C62      | [Link](https://me.sap.com/supportpackage/SAPKB46C62) |
| SAP_BASIS 620              | SAPKB62070      | [Link](https://me.sap.com/supportpackage/SAPKB62070) |
| SAP_BASIS 640              | SAPKB64028      | [Link](https://me.sap.com/supportpackage/SAPKB64028) |
| SAP_BASIS 700              | SAPKB70024      | [Link](https://me.sap.com/supportpackage/SAPKB70024) |
| SAP_BASIS 701              | SAPKB70108      | [Link](https://me.sap.com/supportpackage/SAPKB70108) |
| SAP_BASIS 702              | SAPKB70207      | [Link](https://me.sap.com/supportpackage/SAPKB70207) |
| SAP_BASIS 710              | SAPKB71012      | [Link](https://me.sap.com/supportpackage/SAPKB71012) |
| SAP_BASIS 711              | SAPKB71107      | [Link](https://me.sap.com/supportpackage/SAPKB71107) |
| SAP_BASIS 720              | SAPKB72005      | [Link](https://me.sap.com/supportpackage/SAPKB72005) |
| SAP_BASIS 730              | SAPKB73002      | [Link](https://me.sap.com/supportpackage/SAPKB73002) |

### Correction Instructions

**SAP_BASIS**

- Number of Correction Instructions: 13  
  [View Instructions](https://me.sap.com/corrins/0001520462/41)

**SAP_APPL**

- Number of Correction Instructions: 2  
  [View Instructions](https://me.sap.com/corrins/0001520462/1)

### Preconditions

**Prerequisites:**

- [Note 854060 - Authorizations for external commands](https://me.sap.com/notes/854060)  
  Software Component: SAP_BASIS  
  Valid From: 46C  
  Valid To: 46C  

- [Note 854060 - Authorizations for external commands](https://me.sap.com/notes/854060)  
  Software Component: SAP_BASIS  
  Valid From: 620  
  Valid To: 620  

### CVSS

**CVSS Score:** 0  
**CVSS Vector:** Not Available

### Rating

**Rate this document:**  
Rated Helpful: 0 people  
Quality Rating Average: 0.0 (0 votes)

### Side Effects

**This document solves side effects:**

None.

**This document is causing side effects:**

None.

---

Credits: [https://redrays.io](https://redrays.io) for support in providing this information.