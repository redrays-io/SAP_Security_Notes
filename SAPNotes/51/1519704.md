1519704 - Unauthorized usage of application functionality in CNW1/CNW4

**Summary**

A critical vulnerability has been identified in the CNW1 and CNW4 services of the SAP Project System (PS) component. This issue allows malicious users to execute certain functionalities without proper authentication and authorization, potentially leading to unauthorized actions within the system.

**Impact**

An attacker can exploit this vulnerability by tricking an authenticated user's browser into making a request with specific URLs and parameters. This results in the execution of functions with the user's privileges. Additionally, if present, an attacker may leverage Cross Site Scripting (XSS) to facilitate the exploit or use deceptive links to trick victims into executing the malicious requests.

**Solution**

For customers using the EHP5 release, follow these manual steps to mitigate the vulnerability:

1. **Access Transaction SICF:**
   - Enter transaction code `SICF` in the SAP GUI.

2. **Process Services CNW1 and CNW4:**
   - For each service (CNW1 and CNW4):
     - Enter the service name in SICF (typically found under `/sap/bc/gui/sap/its/<service>`).
     - Execute the service to display its settings.
     - Double-click on the service name in the service tree to switch to change mode.
     - Select the **GUI Configuration**.
     - Add the parameter `~XSRFCHECK` with the value `1`.
     - Save the changes.

3. **Apply Additional Corrections:**
   - Refer to [SAP Note 1481392](https://me.sap.com/notes/1481392) for comprehensive information and further instructions. Implementing corrections from this note is a prerequisite for applying the current note.
   - Execute the report `ITS_XSRF_PARAM_PS` created by this note. When prompted, provide the appropriate transport request number. This report will add necessary service parameters for the adapted ITS services.

**References**

- [SAP Note 1481392 - Cross Site Request Forgery Protection for ITS](https://me.sap.com/notes/1481392)

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009010862017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001519704?language=en-US&token=9E8518014E33847BCB1502622153972F)

**Credits**

Information provided with support from [redrays.io](https://redrays.io).