SAP Security Note 1520324: Advance Creation of XSRF Information

**Overview**

**SAP Note/KBA:** 1520324  
**Type:** SAP Security Note  
**Version:** 16  
**Released On:** 30.01.2013  
**Category:** Advance Development  
**Priority:** Correction with high priority  
**Status:** Released for Customer  
**Component:** BC-BSP (Basis Components > Business Server Pages)  
**Language:** English (Master Language: German)

**Symptom**

This security note has been updated. For details, see security notes 1566128, 1645355, and 1650039.

To protect applications from cross-site request forgery (XSRF) attacks, XSRF protection must be activated for each application. Implement the corrections described in this note to ensure this is possible in customer systems where a transport with XSRF protection development was implemented instead of importing the required Support Package.

**Solution**

This note establishes prerequisites for reports that create XSRF entries.

**Important:**  
Before implementing this note, ensure that the changes in [Note 1458171](https://me.sap.com/notes/1458171) or [Note 1532403](https://me.sap.com/notes/1532403) have already been implemented in your system.

**Manual Activities**

1. **Create the Table BSPTEMPXSRFSTORE in Development Class SBSP_RUNTIME:**
   - **Delivery Class:** A
   - **Technical Settings:**
     - Data class: APPL1
     - Size category: 0
     - Buffering: Buffering switched on
     - Buffering type: Generic Area Buffered
     - No. of key fields: 1
   - **Enhancement Category for Structure:** Cannot Be Enhanced
   - **Data Fields:**
     - APPLNAME (data element O2APPLNAME) – Key Field
     - STARTPAGE (data element O2PAGE) – Key Field

2. **Maintain Foreign Key Dependencies:**
   - **For APPLNAME:**
     - Check table: O2APPL
     - Check table field: APPLNAME
   - **For STARTPAGE:**
     - Check table: O2PAGDIR
     - Check table field: PAGEKEY

**Prerequisites**

- Ensure implementation of [Note 1458171](https://me.sap.com/notes/1458171) or [Note 1532403](https://me.sap.com/notes/1532403).
- Applicable to SAP_BASIS releases 620, 640, 700, 701, 702, 710, 711, 720, and 730.

**References**

- [Unauthorized execution of application funcs. in BW-PLA-BPS-WIB](https://me.sap.com/notes/1694226)
- [cFolders: Composite SAP Note - Security](https://me.sap.com/notes/1666244)
- [Update #3 to Security Note 1520324](https://me.sap.com/notes/1650039)
- [Update #2 to Security Note 1520324](https://me.sap.com/notes/1645355)
- [Unauthorized use of application functions in WS-Browser](https://me.sap.com/notes/1637050)
- ... *(additional references omitted for brevity)*

**Download Links**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009014762017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001520324?language=en-US&token=A6766F6956077C5BA2E04B44BD42089E)
- [Show Changes](https://me.sap.com/notesLatestChanges/0001520324/E/diff)

**Support Package Information**

Applicable Support Packages for SAP_BASIS:
- 620: [SAPKB62070](https://me.sap.com/supportpackage/SAPKB62070)
- 640: [SAPKB64028](https://me.sap.com/supportpackage/SAPKB64028)
- 700: [SAPKB70024](https://me.sap.com/supportpackage/SAPKB70024)
- 701: [SAPKB70109](https://me.sap.com/supportpackage/SAPKB70109)
- 702: [SAPKB70207](https://me.sap.com/supportpackage/SAPKB70207)
- 710: [SAPKB71012](https://me.sap.com/supportpackage/SAPKB71012)
- 711: [SAPKB71107](https://me.sap.com/supportpackage/SAPKB71107)
- 720: [SAPKB72005](https://me.sap.com/supportpackage/SAPKB72005)
- 730: [SAPKB73003](https://me.sap.com/supportpackage/SAPKB73003)

**Side Effects**

This document is causing side effects related to [Error with report for creating XSRF information](https://me.sap.com/notes/1584453).

For more detailed information and support, visit [SAP Support](https://me.sap.com/).

*Credits to [redrays.io](https://redrays.io) for supporting the information provided.*