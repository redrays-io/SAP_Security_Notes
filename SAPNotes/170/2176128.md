2176128 - Potential information disclosure relating to server information

## SAP Security Note 2176128 Overview

**Type:** SAP Security Note  
**Version:** 7  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 11.08.2015  
**Component:** SAP HANA Extended Application Services (HAN-AS-XS)  
**Category:** Program error  
**Recency:** New  
**Language:** English  
**Master Language:** English

### Symptom
An attacker can discover server-related information of SAP HANA and SAP HANA Extended Application Services. This information could be used to allow the attacker to specialize their attacks against SAP HANA and SAP HANA Extended Application Services.

**CVSS Information**  
- **Base Score:** 5.0 / 10  
- **Attack Vector (AV):** Network (N)  
- **Access Complexity (AC):** Low (L)  
- **Authentication (Au):** None (N)  
- **Confidentiality Impact (C):** Partial (P)  
- **Integrity Impact (I):** None (N)  
- **Availability Impact (A):** None (N)

*Note:* SAP provides this CVSS base score as an estimate of the risk. It does not account for your specific system configuration or operational environment. Conduct your own risk assessments when determining the applicability or priority of this security note. More details can be found in the [SAP Security Notes FAQ](https://me.sap.com/support/securitynotes).

### Reason and Prerequisites
Information such as landscape configuration data can be discovered using SAP HANA Extended Application Services. This information may be used by an attacker to further target SAP HANA and SAP HANA Extended Application Services.

### Solution
The issue has been fixed with **SAP HANA SPS 09 Database Revision 95**. Apply this or later revisions.

Alternatively, perform the following workaround for **SAP HANA SPS 09 Database Revision 90 - 94**:

1. **Create a configuration file** (e.g., in `/usr/sap/<SID>/<host>/wdisp`) with the following content:
    ```
    RegIForbiddenUrl ^/sap/hana/xs/internal/(.*) -
    ```
2. **Update `webdispatcher.ini`:**
    Add the following line to the `[profile]` section:
    ```
    icm/HTTP/mod_15 = PREFIX=/sap/hana/xs/internal/, FILE=<path and name of the created file>
    ```
3. **Restart the Web Dispatcher process:**
    ```
    webdispatcher / hdbwebdispatcher
    ```

For **SAP HANA SPS 08 and lower**, follow these steps:

1. **Create a configuration file** (e.g., in `/usr/sap/<SID>/<host>/wdisp`) with the following content:
    ```
    RegIForbiddenUrl ^/sap/hana/xs/internal/(.*) -
    ```
2. **Update `sapwebdisp.pfl`:**
    Add the following line to `/usr/sap/<SID>/<host>/wdisp/sapwebdisp.pfl`:
    ```
    icm/HTTP/mod_15 = PREFIX=/sap/hana/xs/internal/, FILE=<path and name of the created file>
    ```
3. **Restart the SAP Web Dispatcher process:**
    ```
    sapwebdisp_hdb
    ```
    *Note:* The process cannot be restarted via the SAP HANA Studio. It must be stopped directly from the operating system.

*This solution affects the SAP Web Dispatcher if it is used as an HTTP load balancer. Refer to [SAP Note 2146931](https://me.sap.com/notes/2146931) for more details.*

### References
- [SAP Note 2146931 - Web Dispatcher - XSSRV - Initialization fails because access to topology information is forbidden](https://me.sap.com/notes/2146931)

### Download and Additional Resources
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018081002017)
- [PDF Version](https://me.sap.com/support/sfm/notes/print/0002176128?language=en-US&token=9EDF89771671D6A1DC5A1CA8E5FA0574)
- [Edit SAP Note 2176128](https://me.sap.com/support/notes/edit/0002176128)
- [Share by Email](mailto:?subject=SAP%20Security%20Note%202176128&body=Check%20out%20this%20SAP%20Security%20Note%3A%20https://me.sap.com/notes/2176128)
- [Open in New Window](https://me.sap.com/notes/2176128)

### Available Translations
- [Deutsch](https://me.sap.com/notes/0002176128/D) (Human Translation)
- [日本語 (Machine Translation)](https://me.sap.com/notes/0002176128/J)
- [Português (Machine Translation)](https://me.sap.com/notes/0002176128/P)
- [Español (Machine Translation)](https://me.sap.com/notes/0002176128/S)
- [Français (Machine Translation)](https://me.sap.com/notes/0002176128/F)
- [Italiano (Machine Translation)](https://me.sap.com/notes/0002176128/I)
- [Русский (Machine Translation)](https://me.sap.com/notes/0002176128/R)
- [中文 (Machine Translation)](https://me.sap.com/notes/0002176128/1)
- [한국어 (Machine Translation)](https://me.sap.com/notes/0002176128/3)

---

*Credits to [RedRays](https://redrays.io) for support and information provision.*