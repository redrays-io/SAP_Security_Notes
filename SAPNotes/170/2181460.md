SAP Security Note 2181460 - Unauthorized usage of application functionality in SAP Exchange Infrastructure

---

**SAP Note/KBA:** 2181460  
**Type:** SAP Security Note  
**Version:** 4  
**Release Status:** Released for Customer  
**Released On:** 13.09.2016  
**Component:** Basis Components > NetWeaver Process Integration (PI) > Integration Builder - Configuration  
**Priority:** Correction with medium priority  
**Category:** Program error  
**Language:** English

### Symptom
An attacker can remotely exploit **Integration Builder Directory**, potentially consuming resources used to serve **PI**. Additionally, a security fix may cause cache refresh issues, resulting in the following error in `sxi_cache`:
> "Error 'HTTP status code 403 Forbidden' while executing HTTP request (calling method 'get_status')"

### Reason and Prerequisites
- **Usage:** The system uses **SAP Exchange Infrastructure** as the central **Integration Server** or as the local **Integration Engine** in an application system.
- **Issue:** The ABAP client accesses the **Integration Builder Directory** to perform cache refresh. The error occurs due to **XSRF** protection being enabled.

### Solution
Implement the correction instructions by following the manual steps outlined in **Manual Activities** or by importing the relevant support package. After applying the fix, the ABAP consumer system will retrieve the updated content successfully.

### Correction Instructions
- **Number of Correction Instructions:** 10
- **Steps:**
  1. Call transaction `SE91`, enter `SAI_CACHE` into the "Message class" field, and choose "Change" (F6).
  2. Create the following messages:
     - **860:** XSRF token was read
     - **861:** XSRF token is not used
     - **862:** XSRF token is used
     - **863:** XSRF token is not found and Parameter &1 is 'TRUE'
  3. Save the changes and exit the transaction.

### Preconditions
Ensure the following SAP Notes are applied based on your software component version:
- **SAP_BASIS 700:**
  - [Insufficient monitoring for SXI_CACHE](https://me.sap.com/notes/1342064)
  - [XI Runtime: Timestamp in XI Cache application log](https://me.sap.com/notes/1527823)
  - [XI Runtime: Delete secure storage entries](https://me.sap.com/notes/1658151)
  - [XI runtime: Cache logging of invalid XML](https://me.sap.com/notes/1933454)
  - [Reading the ExchangeProfile parameters in PI ABAP stack](https://me.sap.com/notes/2284166)
- **SAP_BASIS 701:**
  - Similar notes as above applicable to version 701
- **SAP_BASIS 702, 710, 711, 730, 731, 740:**
  - Refer to the respective notes listed in the preconditions section above.

### Download and Documentation
- **Download for SNOTE:** [https://me.sap.com/notes/0040000012925102017](https://notesdownloads.sap.com/note/0040000012925102017)
- **PDF Version:** [https://me.sap.com/sap/support/sfm/notes/print/0002181460?language=en-US&token=67D977697E7B00962EAEA91AD0E5E109](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002181460?language=en-US&token=67D977697E7B00962EAEA91AD0E5E109)
- **Comparison of Versions:** [https://me.sap.com/notesLatestChanges/0002181460/E/diff](https://me.sap.com/notesLatestChanges/0002181460/E/diff)

### Available Translations
- **Deutsch:** [https://me.sap.com/notes/0002181460/D](https://me.sap.com/notes/0002181460/D)
- **Japanese (Machine Translation):** [https://me.sap.com/notes/0002181460/J](https://me.sap.com/notes/0002181460/J)
- **Português (Machine Translation):** [https://me.sap.com/notes/0002181460/P](https://me.sap.com/notes/0002181460/P)
- **Español (Machine Translation):** [https://me.sap.com/notes/0002181460/S](https://me.sap.com/notes/0002181460/S)
- **Français (Machine Translation):** [https://me.sap.com/notes/0002181460/F](https://me.sap.com/notes/0002181460/F)
- **Italiano (Machine Translation):** [https://me.sap.com/notes/0002181460/I](https://me.sap.com/notes/0002181460/I)
- **Русский (Machine Translation):** [https://me.sap.com/notes/0002181460/R](https://me.sap.com/notes/0002181460/R)
- **中文 (Machine Translation):** [https://me.sap.com/notes/0002181460/1](https://me.sap.com/notes/0002181460/1)
- **한국어 (Machine Translation):** [https://me.sap.com/notes/0002181460/3](https://me.sap.com/notes/0002181460/3)

For more details and support, visit [SAP Support](https://me.sap.com/).

*Credits to [Redrays](https://redrays.io) for support in providing this information.*