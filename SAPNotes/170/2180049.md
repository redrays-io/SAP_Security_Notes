SAP Security Note 2180049 - Missing authentication check in SAP ASE XPServer

**Symptom**

An unauthenticated user can use functions of SAP ASE XPServer to execute arbitrary commands on the SAP ASE host machine.

**CVSS Information**
- **Base Score:** 9.3 / 10
- **Vector:** Network (N) | Medium (M) | None (N) | Complete Confidentiality (C) | Complete Integrity (C) | Complete Availability (C)

**Affected Versions**
- SAP ASE 15.7 SP135
- SAP ASE Cluster Edition 15.7 SP135
- SAP ASE 16.0 SP01 PL02

**Reason and Prerequisites**

Sites that configure XPServer in their SAP ASE landscape allow unauthenticated users to execute arbitrary commands on the machine hosting SAP ASE. This may potentially give the attacker complete control over SAP ASE and on the machine on which SAP ASE is hosted.

**Solution**

1. **Apply the Fixed Versions:**
   Install the fixed SAP ASE versions most appropriate for your production environments:
   - SAP ASE 15.7 SP135
   - SAP ASE Cluster Edition 15.7 SP135
   - SAP ASE 16.0 SP01 PL02

2. **Mitigate the Vulnerability by Disabling XPServer:**
   - Login as 'sa' and execute the following commands. Replace `<sa_password>` with the password for the 'sa' login and `<SERVERNAME>` with the ASE server name for your installation.
     ```sh
     isql -Usa -P<sa_password> -S <SERVERNAME>
     1> shutdown <SERVERNAME>_XP
     2> go
     1> sp_dropserver <SERVERNAME>_XP
     2> go
     ```

**Download and Resources**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000018087352017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0002180049?language=en-US&token=69C3734E50396B4C06A20910E83C3AA0)
- [Show Changes](https://me.sap.com/notesLatestChanges/0002180049/E/diff)

**Additional Information**

As normal practice, all releases subsequent to the published fixed releases will inherit the fixes described in this security note.

For more details, visit the [SAP Security Notes](https://me.sap.com/securitynotes).

*Credits to [Redrays](https://redrays.io) for support in providing this information.*