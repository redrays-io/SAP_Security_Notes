SAP Security Note 1593743 - Unauthorized use of application functions in CRM-CHM

**Description:**

A malicious user can execute functions in CRM-CHM without authentication and authorization.

**Other Terms:**

Cross-site request forgery (CSRF, XSRF), CRM-CHM

**Reason and Prerequisites:**

CRM-CHM executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. The malicious user may use a cross-site scripting attack to do this, or they may present a link to the victim.

**Solution:**

1. Refer to [note 1520324](https://me.sap.com/notes/1520324) and [note 1551982](https://me.sap.com/notes/1551982) for additional information and instructions. The corrections from these notes are a prerequisite for implementation of this note.
2. Implement the correction instructions of this note. This will also create the report BSP_XSRF_PARAM_CRM_CHM in your system.
3. Execute the report BSP_XSRF_PARAM_CRM_CHM and specify, when requested, a corresponding transport request number. The report will activate the XSRF protection for the BSP applications adapted by this note.

**Affected Components:**

Customer Relationship Management > Channel Management (CRM-CHM)

**Support Packages:**

- BBPCRM 600: [SAPKU60011](https://me.sap.com/supportpackage/SAPKU60011)
- BBPCRM 700: [SAPKU70011](https://me.sap.com/supportpackage/SAPKU70011)
- BBPCRM 701: [SAPKU70107](https://me.sap.com/supportpackage/SAPKU70107)

**Download Links:**

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000009461872017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001593743?language=en-US&token=597183BFB52962A0A8CCF67D9F7AE13F)

**Credits:**

Credits to [redrays.io](https://redrays.io) for support to provided information.