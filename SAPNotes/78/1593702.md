1593702 - Unauthorized use of application functions in CRM-IPS-BTX-APL

**Description**

A malicious user can execute functions in CRM-IPS-BTX-APL without authentication and authorization.

**Other Terms**

- Cross-site request forgery (XSRF)
- CRM-IPS-BTX-APL

**Reason and Prerequisites**

CRM-IPS-BTX-APL executes certain functions by referencing specific URLs. When a malicious user tricks an authenticated user's browser into making a request containing a certain URL and specific parameters, the function is executed with the rights of the authenticated user. This can be achieved through a cross-site scripting attack or by presenting a crafted link to the victim.

**Solution**

1. **Refer to SAP Notes 1520324 and 1551982:** These notes contain additional information and instructions. The corrections from these notes are prerequisites for implementing this note.

2. **Implement the Correction Instructions of This Note:** This will create the report `BSP_XSRF_PARAM_CRM_IPS_BTX` in your system.

3. **Execute the Report `BSP_XSRF_PARAM_CRM_IPS_BTX`:** When prompted, specify a corresponding transport request number. This report will activate the XSRF protection for the BSP applications adapted by this note.

**Additional Information**

- **Download for SNOTE:** [https://notesdownloads.sap.com/note/0040000009461532017](https://notesdownloads.sap.com/note/0040000009461532017)
- **PDF Version:** [https://me.sap.com/sap/support/sfm/notes/print/0001593702?language=en-US&token=481D666327C404355DB149B29163A25E](https://me.sap.com/sap/support/sfm/notes/print/0001593702?language=en-US&token=481D666327C404355DB149B29163A25E)

**Supported Software Components**

- BBPCRM versions 500, 520, 600, 700, 701, 702, 712

**Support Packages**

- BBPCRM 500: [SAPKU50020](https://me.sap.com/supportpackage/SAPKU50020)
- BBPCRM 520: [SAPKU52011](https://me.sap.com/supportpackage/SAPKU52011)
- BBPCRM 600: [SAPKU60011](https://me.sap.com/supportpackage/SAPKU60011)
- BBPCRM 700: [SAPKU70011](https://me.sap.com/supportpackage/SAPKU70011)
- BBPCRM 701: [SAPKU70107](https://me.sap.com/supportpackage/SAPKU70107)
- BBPCRM 702: [SAPKU70202](https://me.sap.com/supportpackage/SAPKU70202)

For detailed correction instructions, visit: [https://me.sap.com/corrins/0001593702/63](https://me.sap.com/corrins/0001593702/63)

**Credits**

Information provided with support from [Redrays.io](https://redrays.io).