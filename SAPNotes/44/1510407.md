1510407 - IS-H: Directory Traversal Vulnerability in IS-H

**Description**

IS-H contains a vulnerability that allows a malicious user to read or write arbitrary files on the remote server. This can lead to data corruption or alteration of system behavior.

**Symptom**

IS-H fails to correctly validate the path where a user-submitted file is written. An attacker can exploit this to overwrite data on the remote system.

**Solution**

1. **Implement Support Package 04 for EHP5.**
2. **Refer to [Note 1497003](https://me.sap.com/notes/1497003)** for additional information and instructions. The corrections from this note are a prerequisite for implementing Note 1510407.
3. **Manual Activities:**
   - Call transaction `FILE`.
   - Navigate to 'Logical File Name Definition, Cross-Client'.
   - Add new entries for each specified report name with the following data:
     - **Logical file:** `<REPORTNAME>`
     - **Name:** `Validation for <REPORTNAME>`
     - **Data format:** `DIR`
     - **Application area:** `IS`
   - Save your changes.
   
**Support Packages**

Ensure the following support packages are applied based on your IS-H version:

- **IS-H 463B:** [SAPKIPHD56](https://me.sap.com/supportpackage/SAPKIPHD56)
- **IS-H 472:** [SAPKIPHF40](https://me.sap.com/supportpackage/SAPKIPHF40), [SAPKIPHF41](https://me.sap.com/supportpackage/SAPKIPHF41)
- **IS-H 600:** [SAPK-60025INISH](https://me.sap.com/supportpackage/SAPK-60025INISH)
- **IS-H 602:** [SAPK-60214INISH](https://me.sap.com/supportpackage/SAPK-60214INISH)
- **IS-H 603:** [SAPK-60314INISH](https://me.sap.com/supportpackage/SAPK-60314INISH)
- **IS-H 604:** [SAPK-60415INISH](https://me.sap.com/supportpackage/SAPK-60415INISH)
- **IS-H 605:** [SAPK-60504INISH](https://me.sap.com/supportpackage/SAPK-60504INISH), [SAPK-60505INISH](https://me.sap.com/supportpackage/SAPK-60505INISH)

**References**

- [Note 1637247](https://me.sap.com/notes/1637247): More correction instructions for older patches
- [Note 1608454](https://me.sap.com/notes/1608454): Directory traversal in IS-H-BD
- [Note 1607749](https://me.sap.com/notes/1607749): Directory traversal in IS-H, central program part
- [Note 1526102](https://me.sap.com/notes/1526102): IS-H: Directory Traversal Vulnerability in IS-H
- [Note 1519061](https://me.sap.com/notes/1519061): IS-H AT: Directory Traversal in various reports
- [Note 1497003](https://me.sap.com/notes/1497003): Potential directory traversals in applications

**Side Effects**

This document may cause side effects related to [Note 1607749](https://me.sap.com/notes/1607749): Directory traversal in IS-H, central program part.

For more detailed information, refer to the full SAP Note [1510407](https://me.sap.com/notes/1510407).

---

*Credits to [Redrays.io](https://redrays.io) for support and provided information.*