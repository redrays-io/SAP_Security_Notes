1510642 - Directory Traversal in foreign trade

## Overview

SAP Note **1510642** addresses a critical security vulnerability involving directory traversal in the following components:

- **SD-FT-GOV**
- **MM-FT-GOV**
- **SD-FT-CON**

This weakness allows malicious users to potentially read or store arbitrary files on the remote server, leading to possible disclosure of confidential information or corruption of data.

## Affected Components

- **SD-FT-GOV**
- **MM-FT-GOV**
- **SD-FT-CON**

## Details

### Symptom

Possible directory traversal in the aforementioned components could allow unauthorized access to files.

### Reason and Prerequisites

1. Vulnerabilities in the programs could allow reading of arbitrary files on the server.
2. Vulnerabilities could allow storing of arbitrary files, potentially corrupting data and impacting system behavior.

### Solution

The solution involves applying corrections from [Note 1497003](https://me.sap.com/notes/1497003). These corrections are necessary to implement the fix provided in this note.

### Logical File Names Used

- **FT_DECLARATION_FILENAME**
- **FT_BAFA_FILENAME**

### File Path

Logical file paths **FT_ROOT_DECLARATIONS** and **FT_ROOT_BAFA** are used to validate physical file names.

## How to Access the Note

- **Download for SNOTE**: [Download](https://notesdownloads.sap.com/note/0040000008951702017)
- **PDF Version**: [PDF](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001510642?language=en-US&token=38590C78F6D9529A66B4DB4109B9407D)
- **Show Changes**: [Compare Versions](https://me.sap.com/notesLatestChanges/0001510642/E/diff)

## Support Package Information

The note is valid for the following software component versions:

- **SAP_APPL 470**
- **SAP_APPL 500**
- **SAP_APPL 600**
- **SAP_APPL 602**
- **SAP_APPL 603**
- **SAP_APPL 604**
- **SAP_APPL 605**

Corresponding support packages:

- [SAPKH47036](https://me.sap.com/supportpackage/SAPKH47036)
- [SAPKH50024](https://me.sap.com/supportpackage/SAPKH50024)
- [SAPKH60019](https://me.sap.com/supportpackage/SAPKH60019)
- [SAPKH60209](https://me.sap.com/supportpackage/SAPKH60209)
- [SAPKH60308](https://me.sap.com/supportpackage/SAPKH60308)
- [SAPKH60409](https://me.sap.com/supportpackage/SAPKH60409)
- [SAPKH60503](https://me.sap.com/supportpackage/SAPKH60503)

## Side Effects

Applying this note may cause side effects referenced in [Note 1526997 - Subsequent corr.: Directory Traversal in foreign trade](https://me.sap.com/notes/0001526997).

## References

- [Note 1497003 - Potential directory traversals in applications](https://me.sap.com/notes/1497003)

## Credits

Credits to [RedRays](https://redrays.io) for supporting information.