SAP Security Note 1699357 - Connection to Virus Scan Interface in CA-GTF-IC-CHA

## Overview

**SAP Note Number:** 1699357  
**Type:** SAP Security Note  
**Priority:** Correction with medium priority  
**Status:** Released for Customer  
**Released On:** 13.08.2013  
**Component:** CA-GTF-IC-CHA  
**Category:** Program error  
**Recency:** New  
**Language:** English

## Description

In the Integrated Communication Interface Mail Channel, the connection to the Virus Scan Interface is missing. This deficiency can allow malicious users to upload harmful content to the server, potentially tricking legitimate users into downloading and executing malicious files.

**Other Terms:** Virus Scan Profile, Virus Scan, Virus Scan Interface

## Reason and Prerequisites

This security note introduces a new functional enhancement aimed at improving the secure storage of files on the SAP share system (e.g., on an application server). The enhancement ensures that the content and the reported type of a stored file are verified, allowing storage only for trusted application file types.

**Prerequisite:** Before implementing this note, ensure that [SAP Note 1640285](https://me.sap.com/notes/1640285) is fully implemented.

## Solution

### Implementation Steps

1. **Implement Prerequisite:**
   - Apply [SAP Note 1640285](https://me.sap.com/notes/1640285).

2. **Manual Pre-Implementation Steps:**
   - **Create Message Classes:**
     - **IC_CCS_MCM** in Package **IC_CCS_MCM** with the following messages:
       - **Message 100:** "E-mail contained malicious content; content has been deleted" *(Self-explanatory: Yes)*
       - **Message 101:** "There is a problem with the virus scanner; contact your administrator" *(Self-explanatory: Yes)*
       - **Message 102:** "E-mail contained a blocked file or MIME type; content has been deleted" *(Self-explanatory: Yes)*
   - **Create Virus Scan Profile:**
     - **Path:** `SAP NetWeaver -> Application Server -> System Administration -> Virus Scan Interface -> Define Virus Scan Profiles`
     - **Profile Name:** `/IC_CCS_MCM/ICI_MAIL`
     - **Profile Text:** "Viren Scan Profil for e-mail via Integrated Communication Interface"
     - **Configuration Parameters:**
       - `CUST_ACTIVE_CONTENT = 1`
       - `CUST_CHECK_MIME_TYPE = 1`
       - `CUST_MIME_TYPES_ARE_BLACKLIST = 1`
     - **MIME-Types to Block:**
       - `application/ecmascript`
       - `application/java-archive`
       - `application/javascript`
       - `application/x-jar`
       - `application/x-java-jar`
       - `application/x-javascript`
       - `application/x-shockwave-flash`
       - `application/x-silverlight`
       - `application/x-silverlight-2`
       - `application/x-silverlight-app`
       - `text/javascript`
   - **Adjust SEOSUBCO Table Entries:**
     - Search for entries with:
       - `CLSNAME: CL_CRM_MCM_MAIL_MESSAGE`
       - `CMPNAME: CREATE_BY_BCB_MESSAGE`
     - If there are already 5 entries, delete the existing entry to prevent issues during implementation.

3. **Implement Correction Instructions:**
   - Follow the detailed correction instructions provided in the note for components **WEBCUIF**, **SAP_ABA**, **CRMUIF**, and **CRMIS**.
   - Ensure all manual activities are performed accurately to avoid errors during the correction process.

4. **Manual Post-Implementation Steps:**
   - **Activate Virus Scan Profile:**
     - Go to transaction **SE38**.
     - Enter the program name: `RSVSCANCUST_PROFILE`.
     - Execute the program (**F8**).
     - Switch to change mode.
     - Select the entry related to `ICI_MAIL` from the right-hand frame.
     - Click on the **Details** button.
     - Check the **ACTIVE** box and save your changes.

## Action Links

- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010098032017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001699357?language=en-US&token=15360FCC31F44AE21BE6811890320A94)
- [Edit Note](https://me.sap.com/sap/support/notes/edit/0001699357)
- [Show Changes](https://me.sap.com/notes/1699357/compareversions)

## Support Packages

Ensure the following support packages are applied to the respective software components:

- **CRMIS 400**
  - [SAPK-40013INCRMIS](https://me.sap.com/supportpackage/SAPK-40013INCRMIS)
- **CRMUIF 520**
  - [SAPK-52013INCRMUIF](https://me.sap.com/supportpackage/SAPK-52013INCRMUIF)
- **CRMUIF 600**
  - [SAPK-60016INCRMUIF](https://me.sap.com/supportpackage/SAPK-60016INCRMUIF)
- **WEBCUIF 700**
  - [SAPK-70013INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70013INWEBCUIF)
- **WEBCUIF 701**
  - [SAPK-70110INWEBCUIF](https://me.sap.com/supportpackage/SAPK-70110INWEBCUIF)
- **WEBCUIF 730**
  - [SAPK-73005INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73005INWEBCUIF)
- **WEBCUIF 731**
  - [SAPK-73104INWEBCUIF](https://me.sap.com/supportpackage/SAPK-73104INWEBCUIF)
- **SAP_ABA 700**
  - [SAPKA70028](https://me.sap.com/supportpackage/SAPKA70028)
  - [SAPKA70029](https://me.sap.com/supportpackage/SAPKA70029)
- **BBPCRM 702**
  - [SAPKU70204](https://me.sap.com/supportpackage/SAPKU70204)
- **BBPCRM 712**
  - *(No specific link provided)*

## Attachments

- [ZAP_DEL_SEOSUBCO.zip](https://userapps.support.sap.com/sap/support/sapnotes/public/services/attachment.htm?iv_key=012003146900000072192012&iv_version=0001&iv_guid=7E2DCE8B548D294E9AC789B51FB6CD30)

## Prerequisites

Before implementing this note, ensure the following prerequisites are met:

- **Software Components:**
  - **CRMIS 400**
  - **CRMUIF 600**
  - **SAP_ABA 700**
  - **WEBCUIF 731**

## Corrections Information

- **Number of Correction Instructions:** 8
- **Manual Activities Required:** 8
- **Prerequisites:** 1

## CVSS Information

- **CVSS Score:** 0
- **CVSS Vector:** Not Provided

## Side Effects

- **This document solves side effects:** None
- **This document is causing side effects:** None

---

*Thanks to [Redrays](https://redrays.io) for supporting and providing the information.*