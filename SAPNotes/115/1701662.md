1701662 - Unauthorized modification of displayed content in Web Request

**SAP Security Note: 1701662 â€“ Unauthorized Modification of Displayed Content in Web Request**

**Summary:**
This security note addresses a vulnerability in SAP CRM Web Request pages that allows attackers to modify displayed application content without authorization and potentially obtain authentication information from legitimate users through reflected cross-site scripting (XSS).

**Actions:**
- [Download for SNOTE](https://notesdownloads.sap.com/note/0040000010111992017)
- [PDF Version](https://userapps.support.sap.com/sap/support/sfm/notes/print/0001701662?language=en-US&token=111FB88A734F866D4821737998885C0E)

**Details:**

- **Symptom:**
  Web Request pages can be abused by an attacker, enabling unauthorized modification of displayed content and possible theft of authentication information from legitimate users.

- **Other Terms:**
  - Reflected Cross-Site Scripting (XSS)
  - Web Request

- **Reason and Prerequisites:**
  The issue arises because CRM Web Request pages and applications do not sufficiently encode input/output parameters, resulting in a reflected XSS vulnerability. An attacker can exploit this to deface or modify website content temporarily or steal authentication data, potentially leading to user impersonation and full application compromise, especially if an administrator is targeted.

**Solution:**

1. **Apply the SAP Note:**
   Ensure that SAP Note 1701662 is implemented in your system.

2. **Manual Pre-Implementation Steps for Release 640:**
   
   **Caution:** 
   You must perform this manual pre-implementation step in each system **before** importing the note.

   ```plaintext
   a. Go to transaction SE24 and open class CL_UWS_FORM_RUNTIME_BSP_SCR
   b. Press the "Change" button for the class
   c. Create a new method named GETU with the following properties:
      - Level: Instance method
      - Visibility: Public
   d. Define the method parameters:
      - ID_PATH (Importing, Type: UXS_XPATH_EXPRESSION)
      - RD_VALUE (Returning, Optional, Type: String)
   e. Save and activate the class after making the changes.
   ```

**Prerequisites:**

- This note is a prerequisite for SAP Note [1659560](https://me.sap.com/notes/1659560).

**Validity:**

Applicable to the following SAP_ABA software component versions:
- 640 to 640
- 700 to 702
- 710 to 711
- 730 to 730
- 731 to 731

**Support Packages:**

Refer to the respective support packages for your SAP_ABA component version:

- SAP_ABA 640: [SAPKA64030](https://me.sap.com/supportpackage/SAPKA64030)
- SAP_ABA 700: [SAPKA70027](https://me.sap.com/supportpackage/SAPKA70027)
- SAP_ABA 701: [SAPKA70112](https://me.sap.com/supportpackage/SAPKA70112)
- SAP_ABA 702: [SAPKA70211](https://me.sap.com/supportpackage/SAPKA70211), [SAPKA70212](https://me.sap.com/supportpackage/SAPKA70212)
- SAP_ABA 710: [SAPKA71015](https://me.sap.com/supportpackage/SAPKA71015)
- SAP_ABA 711: [SAPKA71110](https://me.sap.com/supportpackage/SAPKA71110)
- SAP_ABA 730: [SAPKA73008](https://me.sap.com/supportpackage/SAPKA73008)
- SAP_ABA 731: [SAPKA73103](https://me.sap.com/supportpackage/SAPKA73103)

**References:**

- [1665004](https://me.sap.com/notes/1665004): Unauthorized modification of BSPs in CRM Grantor Management
- [1659560](https://me.sap.com/notes/1659560): Unauthorized Modification of Displayed Content in CRM-ISE-WBF

**Attachments:**
None

**CVSS:**
The CVSS score is not specified in this note.

**Rating:**
Currently, there are no ratings or votes for this document.

**Credits:**
Credits to [redrays.io](https://redrays.io) for support and provided information.